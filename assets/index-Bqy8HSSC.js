function l3(i,e){for(var t=0;t<e.length;t++){const n=e[t];if(typeof n!="string"&&!Array.isArray(n)){for(const s in n)if(s!=="default"&&!(s in i)){const a=Object.getOwnPropertyDescriptor(n,s);a&&Object.defineProperty(i,s,a.get?a:{enumerable:!0,get:()=>n[s]})}}}return Object.freeze(Object.defineProperty(i,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const a of s)if(a.type==="childList")for(const l of a.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&n(l)}).observe(document,{childList:!0,subtree:!0});function t(s){const a={};return s.integrity&&(a.integrity=s.integrity),s.referrerPolicy&&(a.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?a.credentials="include":s.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function n(s){if(s.ep)return;s.ep=!0;const a=t(s);fetch(s.href,a)}})();var c3=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Bc(i){return i&&i.__esModule&&Object.prototype.hasOwnProperty.call(i,"default")?i.default:i}function u3(i){if(Object.prototype.hasOwnProperty.call(i,"__esModule"))return i;var e=i.default;if(typeof e=="function"){var t=function n(){var s=!1;try{s=this instanceof n}catch{}return s?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};t.prototype=e.prototype}else t={};return Object.defineProperty(t,"__esModule",{value:!0}),Object.keys(i).forEach(function(n){var s=Object.getOwnPropertyDescriptor(i,n);Object.defineProperty(t,n,s.get?s:{enumerable:!0,get:function(){return i[n]}})}),t}var xg={exports:{}},Cu={};var Y1;function f3(){if(Y1)return Cu;Y1=1;var i=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function t(n,s,a){var l=null;if(a!==void 0&&(l=""+a),s.key!==void 0&&(l=""+s.key),"key"in s){a={};for(var u in s)u!=="key"&&(a[u]=s[u])}else a=s;return s=a.ref,{$$typeof:i,type:n,key:l,ref:s!==void 0?s:null,props:a}}return Cu.Fragment=e,Cu.jsx=t,Cu.jsxs=t,Cu}var W1;function h3(){return W1||(W1=1,xg.exports=f3()),xg.exports}var P=h3(),_g={exports:{}},Nn={};var Q1;function d3(){if(Q1)return Nn;Q1=1;var i=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),n=Symbol.for("react.strict_mode"),s=Symbol.for("react.profiler"),a=Symbol.for("react.consumer"),l=Symbol.for("react.context"),u=Symbol.for("react.forward_ref"),c=Symbol.for("react.suspense"),f=Symbol.for("react.memo"),d=Symbol.for("react.lazy"),p=Symbol.for("react.activity"),m=Symbol.iterator;function v(V){return V===null||typeof V!="object"?null:(V=m&&V[m]||V["@@iterator"],typeof V=="function"?V:null)}var b={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},y=Object.assign,w={};function C(V,Z,ae){this.props=V,this.context=Z,this.refs=w,this.updater=ae||b}C.prototype.isReactComponent={},C.prototype.setState=function(V,Z){if(typeof V!="object"&&typeof V!="function"&&V!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,V,Z,"setState")},C.prototype.forceUpdate=function(V){this.updater.enqueueForceUpdate(this,V,"forceUpdate")};function S(){}S.prototype=C.prototype;function x(V,Z,ae){this.props=V,this.context=Z,this.refs=w,this.updater=ae||b}var k=x.prototype=new S;k.constructor=x,y(k,C.prototype),k.isPureReactComponent=!0;var A=Array.isArray;function R(){}var I={H:null,A:null,T:null,S:null},U=Object.prototype.hasOwnProperty;function te(V,Z,ae){var Ae=ae.ref;return{$$typeof:i,type:V,key:Z,ref:Ae!==void 0?Ae:null,props:ae}}function G(V,Z){return te(V.type,Z,V.props)}function Y(V){return typeof V=="object"&&V!==null&&V.$$typeof===i}function O(V){var Z={"=":"=0",":":"=2"};return"$"+V.replace(/[=:]/g,function(ae){return Z[ae]})}var N=/\/+/g;function Q(V,Z){return typeof V=="object"&&V!==null&&V.key!=null?O(""+V.key):Z.toString(36)}function q(V){switch(V.status){case"fulfilled":return V.value;case"rejected":throw V.reason;default:switch(typeof V.status=="string"?V.then(R,R):(V.status="pending",V.then(function(Z){V.status==="pending"&&(V.status="fulfilled",V.value=Z)},function(Z){V.status==="pending"&&(V.status="rejected",V.reason=Z)})),V.status){case"fulfilled":return V.value;case"rejected":throw V.reason}}throw V}function ee(V,Z,ae,Ae,be){var Ge=typeof V;(Ge==="undefined"||Ge==="boolean")&&(V=null);var Te=!1;if(V===null)Te=!0;else switch(Ge){case"bigint":case"string":case"number":Te=!0;break;case"object":switch(V.$$typeof){case i:case e:Te=!0;break;case d:return Te=V._init,ee(Te(V._payload),Z,ae,Ae,be)}}if(Te)return be=be(V),Te=Ae===""?"."+Q(V,0):Ae,A(be)?(ae="",Te!=null&&(ae=Te.replace(N,"$&/")+"/"),ee(be,Z,ae,"",function(Me){return Me})):be!=null&&(Y(be)&&(be=G(be,ae+(be.key==null||V&&V.key===be.key?"":(""+be.key).replace(N,"$&/")+"/")+Te)),Z.push(be)),1;Te=0;var ve=Ae===""?".":Ae+":";if(A(V))for(var ke=0;ke<V.length;ke++)Ae=V[ke],Ge=ve+Q(Ae,ke),Te+=ee(Ae,Z,ae,Ge,be);else if(ke=v(V),typeof ke=="function")for(V=ke.call(V),ke=0;!(Ae=V.next()).done;)Ae=Ae.value,Ge=ve+Q(Ae,ke++),Te+=ee(Ae,Z,ae,Ge,be);else if(Ge==="object"){if(typeof V.then=="function")return ee(q(V),Z,ae,Ae,be);throw Z=String(V),Error("Objects are not valid as a React child (found: "+(Z==="[object Object]"?"object with keys {"+Object.keys(V).join(", ")+"}":Z)+"). If you meant to render a collection of children, use an array instead.")}return Te}function ne(V,Z,ae){if(V==null)return V;var Ae=[],be=0;return ee(V,Ae,"","",function(Ge){return Z.call(ae,Ge,be++)}),Ae}function B(V){if(V._status===-1){var Z=V._result;Z=Z(),Z.then(function(ae){(V._status===0||V._status===-1)&&(V._status=1,V._result=ae)},function(ae){(V._status===0||V._status===-1)&&(V._status=2,V._result=ae)}),V._status===-1&&(V._status=0,V._result=Z)}if(V._status===1)return V._result.default;throw V._result}var z=typeof reportError=="function"?reportError:function(V){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var Z=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof V=="object"&&V!==null&&typeof V.message=="string"?String(V.message):String(V),error:V});if(!window.dispatchEvent(Z))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",V);return}console.error(V)},$={map:ne,forEach:function(V,Z,ae){ne(V,function(){Z.apply(this,arguments)},ae)},count:function(V){var Z=0;return ne(V,function(){Z++}),Z},toArray:function(V){return ne(V,function(Z){return Z})||[]},only:function(V){if(!Y(V))throw Error("React.Children.only expected to receive a single React element child.");return V}};return Nn.Activity=p,Nn.Children=$,Nn.Component=C,Nn.Fragment=t,Nn.Profiler=s,Nn.PureComponent=x,Nn.StrictMode=n,Nn.Suspense=c,Nn.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=I,Nn.__COMPILER_RUNTIME={__proto__:null,c:function(V){return I.H.useMemoCache(V)}},Nn.cache=function(V){return function(){return V.apply(null,arguments)}},Nn.cacheSignal=function(){return null},Nn.cloneElement=function(V,Z,ae){if(V==null)throw Error("The argument must be a React element, but you passed "+V+".");var Ae=y({},V.props),be=V.key;if(Z!=null)for(Ge in Z.key!==void 0&&(be=""+Z.key),Z)!U.call(Z,Ge)||Ge==="key"||Ge==="__self"||Ge==="__source"||Ge==="ref"&&Z.ref===void 0||(Ae[Ge]=Z[Ge]);var Ge=arguments.length-2;if(Ge===1)Ae.children=ae;else if(1<Ge){for(var Te=Array(Ge),ve=0;ve<Ge;ve++)Te[ve]=arguments[ve+2];Ae.children=Te}return te(V.type,be,Ae)},Nn.createContext=function(V){return V={$$typeof:l,_currentValue:V,_currentValue2:V,_threadCount:0,Provider:null,Consumer:null},V.Provider=V,V.Consumer={$$typeof:a,_context:V},V},Nn.createElement=function(V,Z,ae){var Ae,be={},Ge=null;if(Z!=null)for(Ae in Z.key!==void 0&&(Ge=""+Z.key),Z)U.call(Z,Ae)&&Ae!=="key"&&Ae!=="__self"&&Ae!=="__source"&&(be[Ae]=Z[Ae]);var Te=arguments.length-2;if(Te===1)be.children=ae;else if(1<Te){for(var ve=Array(Te),ke=0;ke<Te;ke++)ve[ke]=arguments[ke+2];be.children=ve}if(V&&V.defaultProps)for(Ae in Te=V.defaultProps,Te)be[Ae]===void 0&&(be[Ae]=Te[Ae]);return te(V,Ge,be)},Nn.createRef=function(){return{current:null}},Nn.forwardRef=function(V){return{$$typeof:u,render:V}},Nn.isValidElement=Y,Nn.lazy=function(V){return{$$typeof:d,_payload:{_status:-1,_result:V},_init:B}},Nn.memo=function(V,Z){return{$$typeof:f,type:V,compare:Z===void 0?null:Z}},Nn.startTransition=function(V){var Z=I.T,ae={};I.T=ae;try{var Ae=V(),be=I.S;be!==null&&be(ae,Ae),typeof Ae=="object"&&Ae!==null&&typeof Ae.then=="function"&&Ae.then(R,z)}catch(Ge){z(Ge)}finally{Z!==null&&ae.types!==null&&(Z.types=ae.types),I.T=Z}},Nn.unstable_useCacheRefresh=function(){return I.H.useCacheRefresh()},Nn.use=function(V){return I.H.use(V)},Nn.useActionState=function(V,Z,ae){return I.H.useActionState(V,Z,ae)},Nn.useCallback=function(V,Z){return I.H.useCallback(V,Z)},Nn.useContext=function(V){return I.H.useContext(V)},Nn.useDebugValue=function(){},Nn.useDeferredValue=function(V,Z){return I.H.useDeferredValue(V,Z)},Nn.useEffect=function(V,Z){return I.H.useEffect(V,Z)},Nn.useEffectEvent=function(V){return I.H.useEffectEvent(V)},Nn.useId=function(){return I.H.useId()},Nn.useImperativeHandle=function(V,Z,ae){return I.H.useImperativeHandle(V,Z,ae)},Nn.useInsertionEffect=function(V,Z){return I.H.useInsertionEffect(V,Z)},Nn.useLayoutEffect=function(V,Z){return I.H.useLayoutEffect(V,Z)},Nn.useMemo=function(V,Z){return I.H.useMemo(V,Z)},Nn.useOptimistic=function(V,Z){return I.H.useOptimistic(V,Z)},Nn.useReducer=function(V,Z,ae){return I.H.useReducer(V,Z,ae)},Nn.useRef=function(V){return I.H.useRef(V)},Nn.useState=function(V){return I.H.useState(V)},Nn.useSyncExternalStore=function(V,Z,ae){return I.H.useSyncExternalStore(V,Z,ae)},Nn.useTransition=function(){return I.H.useTransition()},Nn.version="19.2.0",Nn}var J1;function Yy(){return J1||(J1=1,_g.exports=d3()),_g.exports}var jt=Yy();const Or=Bc(jt);var Sg={exports:{}},Au={},Eg={exports:{}},Cg={};var Z1;function p3(){return Z1||(Z1=1,(function(i){function e(ee,ne){var B=ee.length;ee.push(ne);e:for(;0<B;){var z=B-1>>>1,$=ee[z];if(0<s($,ne))ee[z]=ne,ee[B]=$,B=z;else break e}}function t(ee){return ee.length===0?null:ee[0]}function n(ee){if(ee.length===0)return null;var ne=ee[0],B=ee.pop();if(B!==ne){ee[0]=B;e:for(var z=0,$=ee.length,V=$>>>1;z<V;){var Z=2*(z+1)-1,ae=ee[Z],Ae=Z+1,be=ee[Ae];if(0>s(ae,B))Ae<$&&0>s(be,ae)?(ee[z]=be,ee[Ae]=B,z=Ae):(ee[z]=ae,ee[Z]=B,z=Z);else if(Ae<$&&0>s(be,B))ee[z]=be,ee[Ae]=B,z=Ae;else break e}}return ne}function s(ee,ne){var B=ee.sortIndex-ne.sortIndex;return B!==0?B:ee.id-ne.id}if(i.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var a=performance;i.unstable_now=function(){return a.now()}}else{var l=Date,u=l.now();i.unstable_now=function(){return l.now()-u}}var c=[],f=[],d=1,p=null,m=3,v=!1,b=!1,y=!1,w=!1,C=typeof setTimeout=="function"?setTimeout:null,S=typeof clearTimeout=="function"?clearTimeout:null,x=typeof setImmediate<"u"?setImmediate:null;function k(ee){for(var ne=t(f);ne!==null;){if(ne.callback===null)n(f);else if(ne.startTime<=ee)n(f),ne.sortIndex=ne.expirationTime,e(c,ne);else break;ne=t(f)}}function A(ee){if(y=!1,k(ee),!b)if(t(c)!==null)b=!0,R||(R=!0,O());else{var ne=t(f);ne!==null&&q(A,ne.startTime-ee)}}var R=!1,I=-1,U=5,te=-1;function G(){return w?!0:!(i.unstable_now()-te<U)}function Y(){if(w=!1,R){var ee=i.unstable_now();te=ee;var ne=!0;try{e:{b=!1,y&&(y=!1,S(I),I=-1),v=!0;var B=m;try{t:{for(k(ee),p=t(c);p!==null&&!(p.expirationTime>ee&&G());){var z=p.callback;if(typeof z=="function"){p.callback=null,m=p.priorityLevel;var $=z(p.expirationTime<=ee);if(ee=i.unstable_now(),typeof $=="function"){p.callback=$,k(ee),ne=!0;break t}p===t(c)&&n(c),k(ee)}else n(c);p=t(c)}if(p!==null)ne=!0;else{var V=t(f);V!==null&&q(A,V.startTime-ee),ne=!1}}break e}finally{p=null,m=B,v=!1}ne=void 0}}finally{ne?O():R=!1}}}var O;if(typeof x=="function")O=function(){x(Y)};else if(typeof MessageChannel<"u"){var N=new MessageChannel,Q=N.port2;N.port1.onmessage=Y,O=function(){Q.postMessage(null)}}else O=function(){C(Y,0)};function q(ee,ne){I=C(function(){ee(i.unstable_now())},ne)}i.unstable_IdlePriority=5,i.unstable_ImmediatePriority=1,i.unstable_LowPriority=4,i.unstable_NormalPriority=3,i.unstable_Profiling=null,i.unstable_UserBlockingPriority=2,i.unstable_cancelCallback=function(ee){ee.callback=null},i.unstable_forceFrameRate=function(ee){0>ee||125<ee?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):U=0<ee?Math.floor(1e3/ee):5},i.unstable_getCurrentPriorityLevel=function(){return m},i.unstable_next=function(ee){switch(m){case 1:case 2:case 3:var ne=3;break;default:ne=m}var B=m;m=ne;try{return ee()}finally{m=B}},i.unstable_requestPaint=function(){w=!0},i.unstable_runWithPriority=function(ee,ne){switch(ee){case 1:case 2:case 3:case 4:case 5:break;default:ee=3}var B=m;m=ee;try{return ne()}finally{m=B}},i.unstable_scheduleCallback=function(ee,ne,B){var z=i.unstable_now();switch(typeof B=="object"&&B!==null?(B=B.delay,B=typeof B=="number"&&0<B?z+B:z):B=z,ee){case 1:var $=-1;break;case 2:$=250;break;case 5:$=1073741823;break;case 4:$=1e4;break;default:$=5e3}return $=B+$,ee={id:d++,callback:ne,priorityLevel:ee,startTime:B,expirationTime:$,sortIndex:-1},B>z?(ee.sortIndex=B,e(f,ee),t(c)===null&&ee===t(f)&&(y?(S(I),I=-1):y=!0,q(A,B-z))):(ee.sortIndex=$,e(c,ee),b||v||(b=!0,R||(R=!0,O()))),ee},i.unstable_shouldYield=G,i.unstable_wrapCallback=function(ee){var ne=m;return function(){var B=m;m=ne;try{return ee.apply(this,arguments)}finally{m=B}}}})(Cg)),Cg}var X1;function g3(){return X1||(X1=1,Eg.exports=p3()),Eg.exports}var Ag={exports:{}},hi={};var ex;function m3(){if(ex)return hi;ex=1;var i=Yy();function e(c){var f="https://react.dev/errors/"+c;if(1<arguments.length){f+="?args[]="+encodeURIComponent(arguments[1]);for(var d=2;d<arguments.length;d++)f+="&args[]="+encodeURIComponent(arguments[d])}return"Minified React error #"+c+"; visit "+f+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function t(){}var n={d:{f:t,r:function(){throw Error(e(522))},D:t,C:t,L:t,m:t,X:t,S:t,M:t},p:0,findDOMNode:null},s=Symbol.for("react.portal");function a(c,f,d){var p=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:s,key:p==null?null:""+p,children:c,containerInfo:f,implementation:d}}var l=i.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function u(c,f){if(c==="font")return"";if(typeof f=="string")return f==="use-credentials"?f:""}return hi.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=n,hi.createPortal=function(c,f){var d=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!f||f.nodeType!==1&&f.nodeType!==9&&f.nodeType!==11)throw Error(e(299));return a(c,f,null,d)},hi.flushSync=function(c){var f=l.T,d=n.p;try{if(l.T=null,n.p=2,c)return c()}finally{l.T=f,n.p=d,n.d.f()}},hi.preconnect=function(c,f){typeof c=="string"&&(f?(f=f.crossOrigin,f=typeof f=="string"?f==="use-credentials"?f:"":void 0):f=null,n.d.C(c,f))},hi.prefetchDNS=function(c){typeof c=="string"&&n.d.D(c)},hi.preinit=function(c,f){if(typeof c=="string"&&f&&typeof f.as=="string"){var d=f.as,p=u(d,f.crossOrigin),m=typeof f.integrity=="string"?f.integrity:void 0,v=typeof f.fetchPriority=="string"?f.fetchPriority:void 0;d==="style"?n.d.S(c,typeof f.precedence=="string"?f.precedence:void 0,{crossOrigin:p,integrity:m,fetchPriority:v}):d==="script"&&n.d.X(c,{crossOrigin:p,integrity:m,fetchPriority:v,nonce:typeof f.nonce=="string"?f.nonce:void 0})}},hi.preinitModule=function(c,f){if(typeof c=="string")if(typeof f=="object"&&f!==null){if(f.as==null||f.as==="script"){var d=u(f.as,f.crossOrigin);n.d.M(c,{crossOrigin:d,integrity:typeof f.integrity=="string"?f.integrity:void 0,nonce:typeof f.nonce=="string"?f.nonce:void 0})}}else f==null&&n.d.M(c)},hi.preload=function(c,f){if(typeof c=="string"&&typeof f=="object"&&f!==null&&typeof f.as=="string"){var d=f.as,p=u(d,f.crossOrigin);n.d.L(c,d,{crossOrigin:p,integrity:typeof f.integrity=="string"?f.integrity:void 0,nonce:typeof f.nonce=="string"?f.nonce:void 0,type:typeof f.type=="string"?f.type:void 0,fetchPriority:typeof f.fetchPriority=="string"?f.fetchPriority:void 0,referrerPolicy:typeof f.referrerPolicy=="string"?f.referrerPolicy:void 0,imageSrcSet:typeof f.imageSrcSet=="string"?f.imageSrcSet:void 0,imageSizes:typeof f.imageSizes=="string"?f.imageSizes:void 0,media:typeof f.media=="string"?f.media:void 0})}},hi.preloadModule=function(c,f){if(typeof c=="string")if(f){var d=u(f.as,f.crossOrigin);n.d.m(c,{as:typeof f.as=="string"&&f.as!=="script"?f.as:void 0,crossOrigin:d,integrity:typeof f.integrity=="string"?f.integrity:void 0})}else n.d.m(c)},hi.requestFormReset=function(c){n.d.r(c)},hi.unstable_batchedUpdates=function(c,f){return c(f)},hi.useFormState=function(c,f,d){return l.H.useFormState(c,f,d)},hi.useFormStatus=function(){return l.H.useHostTransitionStatus()},hi.version="19.2.0",hi}var tx;function y3(){if(tx)return Ag.exports;tx=1;function i(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(i)}catch(e){console.error(e)}}return i(),Ag.exports=m3(),Ag.exports}var nx;function b3(){if(nx)return Au;nx=1;var i=g3(),e=Yy(),t=y3();function n(r){var o="https://react.dev/errors/"+r;if(1<arguments.length){o+="?args[]="+encodeURIComponent(arguments[1]);for(var h=2;h<arguments.length;h++)o+="&args[]="+encodeURIComponent(arguments[h])}return"Minified React error #"+r+"; visit "+o+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function s(r){return!(!r||r.nodeType!==1&&r.nodeType!==9&&r.nodeType!==11)}function a(r){var o=r,h=r;if(r.alternate)for(;o.return;)o=o.return;else{r=o;do o=r,(o.flags&4098)!==0&&(h=o.return),r=o.return;while(r)}return o.tag===3?h:null}function l(r){if(r.tag===13){var o=r.memoizedState;if(o===null&&(r=r.alternate,r!==null&&(o=r.memoizedState)),o!==null)return o.dehydrated}return null}function u(r){if(r.tag===31){var o=r.memoizedState;if(o===null&&(r=r.alternate,r!==null&&(o=r.memoizedState)),o!==null)return o.dehydrated}return null}function c(r){if(a(r)!==r)throw Error(n(188))}function f(r){var o=r.alternate;if(!o){if(o=a(r),o===null)throw Error(n(188));return o!==r?null:r}for(var h=r,g=o;;){var E=h.return;if(E===null)break;var M=E.alternate;if(M===null){if(g=E.return,g!==null){h=g;continue}break}if(E.child===M.child){for(M=E.child;M;){if(M===h)return c(E),r;if(M===g)return c(E),o;M=M.sibling}throw Error(n(188))}if(h.return!==g.return)h=E,g=M;else{for(var X=!1,ue=E.child;ue;){if(ue===h){X=!0,h=E,g=M;break}if(ue===g){X=!0,g=E,h=M;break}ue=ue.sibling}if(!X){for(ue=M.child;ue;){if(ue===h){X=!0,h=M,g=E;break}if(ue===g){X=!0,g=M,h=E;break}ue=ue.sibling}if(!X)throw Error(n(189))}}if(h.alternate!==g)throw Error(n(190))}if(h.tag!==3)throw Error(n(188));return h.stateNode.current===h?r:o}function d(r){var o=r.tag;if(o===5||o===26||o===27||o===6)return r;for(r=r.child;r!==null;){if(o=d(r),o!==null)return o;r=r.sibling}return null}var p=Object.assign,m=Symbol.for("react.element"),v=Symbol.for("react.transitional.element"),b=Symbol.for("react.portal"),y=Symbol.for("react.fragment"),w=Symbol.for("react.strict_mode"),C=Symbol.for("react.profiler"),S=Symbol.for("react.consumer"),x=Symbol.for("react.context"),k=Symbol.for("react.forward_ref"),A=Symbol.for("react.suspense"),R=Symbol.for("react.suspense_list"),I=Symbol.for("react.memo"),U=Symbol.for("react.lazy"),te=Symbol.for("react.activity"),G=Symbol.for("react.memo_cache_sentinel"),Y=Symbol.iterator;function O(r){return r===null||typeof r!="object"?null:(r=Y&&r[Y]||r["@@iterator"],typeof r=="function"?r:null)}var N=Symbol.for("react.client.reference");function Q(r){if(r==null)return null;if(typeof r=="function")return r.$$typeof===N?null:r.displayName||r.name||null;if(typeof r=="string")return r;switch(r){case y:return"Fragment";case C:return"Profiler";case w:return"StrictMode";case A:return"Suspense";case R:return"SuspenseList";case te:return"Activity"}if(typeof r=="object")switch(r.$$typeof){case b:return"Portal";case x:return r.displayName||"Context";case S:return(r._context.displayName||"Context")+".Consumer";case k:var o=r.render;return r=r.displayName,r||(r=o.displayName||o.name||"",r=r!==""?"ForwardRef("+r+")":"ForwardRef"),r;case I:return o=r.displayName||null,o!==null?o:Q(r.type)||"Memo";case U:o=r._payload,r=r._init;try{return Q(r(o))}catch{}}return null}var q=Array.isArray,ee=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,ne=t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,B={pending:!1,data:null,method:null,action:null},z=[],$=-1;function V(r){return{current:r}}function Z(r){0>$||(r.current=z[$],z[$]=null,$--)}function ae(r,o){$++,z[$]=r.current,r.current=o}var Ae=V(null),be=V(null),Ge=V(null),Te=V(null);function ve(r,o){switch(ae(Ge,o),ae(be,r),ae(Ae,null),o.nodeType){case 9:case 11:r=(r=o.documentElement)&&(r=r.namespaceURI)?y1(r):0;break;default:if(r=o.tagName,o=o.namespaceURI)o=y1(o),r=b1(o,r);else switch(r){case"svg":r=1;break;case"math":r=2;break;default:r=0}}Z(Ae),ae(Ae,r)}function ke(){Z(Ae),Z(be),Z(Ge)}function Me(r){r.memoizedState!==null&&ae(Te,r);var o=Ae.current,h=b1(o,r.type);o!==h&&(ae(be,r),ae(Ae,h))}function Ie(r){be.current===r&&(Z(Ae),Z(be)),Te.current===r&&(Z(Te),xu._currentValue=B)}var Ce,ot;function et(r){if(Ce===void 0)try{throw Error()}catch(h){var o=h.stack.trim().match(/\n( *(at )?)/);Ce=o&&o[1]||"",ot=-1<h.stack.indexOf(`
    at`)?" (<anonymous>)":-1<h.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Ce+r+ot}var me=!1;function de(r,o){if(!r||me)return"";me=!0;var h=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var g={DetermineComponentFrameRoot:function(){try{if(o){var Lt=function(){throw Error()};if(Object.defineProperty(Lt.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(Lt,[])}catch(wt){var dt=wt}Reflect.construct(r,[],Lt)}else{try{Lt.call()}catch(wt){dt=wt}r.call(Lt.prototype)}}else{try{throw Error()}catch(wt){dt=wt}(Lt=r())&&typeof Lt.catch=="function"&&Lt.catch(function(){})}}catch(wt){if(wt&&dt&&typeof wt.stack=="string")return[wt.stack,dt.stack]}return[null,null]}};g.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var E=Object.getOwnPropertyDescriptor(g.DetermineComponentFrameRoot,"name");E&&E.configurable&&Object.defineProperty(g.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var M=g.DetermineComponentFrameRoot(),X=M[0],ue=M[1];if(X&&ue){var De=X.split(`
`),ut=ue.split(`
`);for(E=g=0;g<De.length&&!De[g].includes("DetermineComponentFrameRoot");)g++;for(;E<ut.length&&!ut[E].includes("DetermineComponentFrameRoot");)E++;if(g===De.length||E===ut.length)for(g=De.length-1,E=ut.length-1;1<=g&&0<=E&&De[g]!==ut[E];)E--;for(;1<=g&&0<=E;g--,E--)if(De[g]!==ut[E]){if(g!==1||E!==1)do if(g--,E--,0>E||De[g]!==ut[E]){var Tt=`
`+De[g].replace(" at new "," at ");return r.displayName&&Tt.includes("<anonymous>")&&(Tt=Tt.replace("<anonymous>",r.displayName)),Tt}while(1<=g&&0<=E);break}}}finally{me=!1,Error.prepareStackTrace=h}return(h=r?r.displayName||r.name:"")?et(h):""}function Be(r,o){switch(r.tag){case 26:case 27:case 5:return et(r.type);case 16:return et("Lazy");case 13:return r.child!==o&&o!==null?et("Suspense Fallback"):et("Suspense");case 19:return et("SuspenseList");case 0:case 15:return de(r.type,!1);case 11:return de(r.type.render,!1);case 1:return de(r.type,!0);case 31:return et("Activity");default:return""}}function Je(r){try{var o="",h=null;do o+=Be(r,h),h=r,r=r.return;while(r);return o}catch(g){return`
Error generating stack: `+g.message+`
`+g.stack}}var rt=Object.prototype.hasOwnProperty,at=i.unstable_scheduleCallback,ye=i.unstable_cancelCallback,it=i.unstable_shouldYield,Mt=i.unstable_requestPaint,nt=i.unstable_now,Zt=i.unstable_getCurrentPriorityLevel,j=i.unstable_ImmediatePriority,W=i.unstable_UserBlockingPriority,se=i.unstable_NormalPriority,Oe=i.unstable_LowPriority,Ke=i.unstable_IdlePriority,gt=i.log,Ut=i.unstable_setDisableYieldValue,Le=null,Xe=null;function zt(r){if(typeof gt=="function"&&Ut(r),Xe&&typeof Xe.setStrictMode=="function")try{Xe.setStrictMode(Le,r)}catch{}}var mt=Math.clz32?Math.clz32:pr,an=Math.log,hn=Math.LN2;function pr(r){return r>>>=0,r===0?32:31-(an(r)/hn|0)|0}var Ft=256,Bn=262144,xr=4194304;function _r(r){var o=r&42;if(o!==0)return o;switch(r&-r){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return r&261888;case 262144:case 524288:case 1048576:case 2097152:return r&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return r&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return r}}function Zn(r,o,h){var g=r.pendingLanes;if(g===0)return 0;var E=0,M=r.suspendedLanes,X=r.pingedLanes;r=r.warmLanes;var ue=g&134217727;return ue!==0?(g=ue&~M,g!==0?E=_r(g):(X&=ue,X!==0?E=_r(X):h||(h=ue&~r,h!==0&&(E=_r(h))))):(ue=g&~M,ue!==0?E=_r(ue):X!==0?E=_r(X):h||(h=g&~r,h!==0&&(E=_r(h)))),E===0?0:o!==0&&o!==E&&(o&M)===0&&(M=E&-E,h=o&-o,M>=h||M===32&&(h&4194048)!==0)?o:E}function Ht(r,o){return(r.pendingLanes&~(r.suspendedLanes&~r.pingedLanes)&o)===0}function pe(r,o){switch(r){case 1:case 2:case 4:case 8:case 64:return o+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return o+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Ot(){var r=xr;return xr<<=1,(xr&62914560)===0&&(xr=4194304),r}function qt(r){for(var o=[],h=0;31>h;h++)o.push(r);return o}function fe(r,o){r.pendingLanes|=o,o!==268435456&&(r.suspendedLanes=0,r.pingedLanes=0,r.warmLanes=0)}function we(r,o,h,g,E,M){var X=r.pendingLanes;r.pendingLanes=h,r.suspendedLanes=0,r.pingedLanes=0,r.warmLanes=0,r.expiredLanes&=h,r.entangledLanes&=h,r.errorRecoveryDisabledLanes&=h,r.shellSuspendCounter=0;var ue=r.entanglements,De=r.expirationTimes,ut=r.hiddenUpdates;for(h=X&~h;0<h;){var Tt=31-mt(h),Lt=1<<Tt;ue[Tt]=0,De[Tt]=-1;var dt=ut[Tt];if(dt!==null)for(ut[Tt]=null,Tt=0;Tt<dt.length;Tt++){var wt=dt[Tt];wt!==null&&(wt.lane&=-536870913)}h&=~Lt}g!==0&&pt(r,g,0),M!==0&&E===0&&r.tag!==0&&(r.suspendedLanes|=M&~(X&~o))}function pt(r,o,h){r.pendingLanes|=o,r.suspendedLanes&=~o;var g=31-mt(o);r.entangledLanes|=o,r.entanglements[g]=r.entanglements[g]|1073741824|h&261930}function At(r,o){var h=r.entangledLanes|=o;for(r=r.entanglements;h;){var g=31-mt(h),E=1<<g;E&o|r[g]&o&&(r[g]|=o),h&=~E}}function K(r,o){var h=o&-o;return h=(h&42)!==0?1:oe(h),(h&(r.suspendedLanes|o))!==0?0:h}function oe(r){switch(r){case 2:r=1;break;case 8:r=4;break;case 32:r=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:r=128;break;case 268435456:r=134217728;break;default:r=0}return r}function ce(r){return r&=-r,2<r?8<r?(r&134217727)!==0?32:268435456:8:2}function D(){var r=ne.p;return r!==0?r:(r=window.event,r===void 0?32:F1(r.type))}function ge(r,o){var h=ne.p;try{return ne.p=r,o()}finally{ne.p=h}}var $e=Math.random().toString(36).slice(2),ze="__reactFiber$"+$e,vt="__reactProps$"+$e,Nt="__reactContainer$"+$e,Yt="__reactEvents$"+$e,Kt="__reactListeners$"+$e,vn="__reactHandles$"+$e,$t="__reactResources$"+$e,sn="__reactMarker$"+$e;function wn(r){delete r[ze],delete r[vt],delete r[Yt],delete r[Kt],delete r[vn]}function xn(r){var o=r[ze];if(o)return o;for(var h=r.parentNode;h;){if(o=h[Nt]||h[ze]){if(h=o.alternate,o.child!==null||h!==null&&h.child!==null)for(r=C1(r);r!==null;){if(h=r[ze])return h;r=C1(r)}return o}r=h,h=r.parentNode}return null}function tn(r){if(r=r[ze]||r[Nt]){var o=r.tag;if(o===5||o===6||o===13||o===31||o===26||o===27||o===3)return r}return null}function dn(r){var o=r.tag;if(o===5||o===26||o===27||o===6)return r.stateNode;throw Error(n(33))}function cn(r){var o=r[$t];return o||(o=r[$t]={hoistableStyles:new Map,hoistableScripts:new Map}),o}function on(r){r[sn]=!0}var Xt=new Set,ln={};function Wt(r,o){en(r,o),en(r+"Capture",o)}function en(r,o){for(ln[r]=o,r=0;r<o.length;r++)Xt.add(o[r])}var nn=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Jt={},ht={};function yt(r){return rt.call(ht,r)?!0:rt.call(Jt,r)?!1:nn.test(r)?ht[r]=!0:(Jt[r]=!0,!1)}function bt(r,o,h){if(yt(o))if(h===null)r.removeAttribute(o);else{switch(typeof h){case"undefined":case"function":case"symbol":r.removeAttribute(o);return;case"boolean":var g=o.toLowerCase().slice(0,5);if(g!=="data-"&&g!=="aria-"){r.removeAttribute(o);return}}r.setAttribute(o,""+h)}}function kt(r,o,h){if(h===null)r.removeAttribute(o);else{switch(typeof h){case"undefined":case"function":case"symbol":case"boolean":r.removeAttribute(o);return}r.setAttribute(o,""+h)}}function Ct(r,o,h,g){if(g===null)r.removeAttribute(h);else{switch(typeof g){case"undefined":case"function":case"symbol":case"boolean":r.removeAttribute(h);return}r.setAttributeNS(o,h,""+g)}}function Pt(r){switch(typeof r){case"bigint":case"boolean":case"number":case"string":case"undefined":return r;case"object":return r;default:return""}}function pn(r){var o=r.type;return(r=r.nodeName)&&r.toLowerCase()==="input"&&(o==="checkbox"||o==="radio")}function Qt(r,o,h){var g=Object.getOwnPropertyDescriptor(r.constructor.prototype,o);if(!r.hasOwnProperty(o)&&typeof g<"u"&&typeof g.get=="function"&&typeof g.set=="function"){var E=g.get,M=g.set;return Object.defineProperty(r,o,{configurable:!0,get:function(){return E.call(this)},set:function(X){h=""+X,M.call(this,X)}}),Object.defineProperty(r,o,{enumerable:g.enumerable}),{getValue:function(){return h},setValue:function(X){h=""+X},stopTracking:function(){r._valueTracker=null,delete r[o]}}}}function An(r){if(!r._valueTracker){var o=pn(r)?"checked":"value";r._valueTracker=Qt(r,o,""+r[o])}}function kn(r){if(!r)return!1;var o=r._valueTracker;if(!o)return!0;var h=o.getValue(),g="";return r&&(g=pn(r)?r.checked?"true":"false":r.value),r=g,r!==h?(o.setValue(r),!0):!1}function Ee(r){if(r=r||(typeof document<"u"?document:void 0),typeof r>"u")return null;try{return r.activeElement||r.body}catch{return r.body}}var Tn=/[\n"\\]/g;function _n(r){return r.replace(Tn,function(o){return"\\"+o.charCodeAt(0).toString(16)+" "})}function Mn(r,o,h,g,E,M,X,ue){r.name="",X!=null&&typeof X!="function"&&typeof X!="symbol"&&typeof X!="boolean"?r.type=X:r.removeAttribute("type"),o!=null?X==="number"?(o===0&&r.value===""||r.value!=o)&&(r.value=""+Pt(o)):r.value!==""+Pt(o)&&(r.value=""+Pt(o)):X!=="submit"&&X!=="reset"||r.removeAttribute("value"),o!=null?On(r,X,Pt(o)):h!=null?On(r,X,Pt(h)):g!=null&&r.removeAttribute("value"),E==null&&M!=null&&(r.defaultChecked=!!M),E!=null&&(r.checked=E&&typeof E!="function"&&typeof E!="symbol"),ue!=null&&typeof ue!="function"&&typeof ue!="symbol"&&typeof ue!="boolean"?r.name=""+Pt(ue):r.removeAttribute("name")}function In(r,o,h,g,E,M,X,ue){if(M!=null&&typeof M!="function"&&typeof M!="symbol"&&typeof M!="boolean"&&(r.type=M),o!=null||h!=null){if(!(M!=="submit"&&M!=="reset"||o!=null)){An(r);return}h=h!=null?""+Pt(h):"",o=o!=null?""+Pt(o):h,ue||o===r.value||(r.value=o),r.defaultValue=o}g=g??E,g=typeof g!="function"&&typeof g!="symbol"&&!!g,r.checked=ue?r.checked:!!g,r.defaultChecked=!!g,X!=null&&typeof X!="function"&&typeof X!="symbol"&&typeof X!="boolean"&&(r.name=X),An(r)}function On(r,o,h){o==="number"&&Ee(r.ownerDocument)===r||r.defaultValue===""+h||(r.defaultValue=""+h)}function Rn(r,o,h,g){if(r=r.options,o){o={};for(var E=0;E<h.length;E++)o["$"+h[E]]=!0;for(h=0;h<r.length;h++)E=o.hasOwnProperty("$"+r[h].value),r[h].selected!==E&&(r[h].selected=E),E&&g&&(r[h].defaultSelected=!0)}else{for(h=""+Pt(h),o=null,E=0;E<r.length;E++){if(r[E].value===h){r[E].selected=!0,g&&(r[E].defaultSelected=!0);return}o!==null||r[E].disabled||(o=r[E])}o!==null&&(o.selected=!0)}}function rr(r,o,h){if(o!=null&&(o=""+Pt(o),o!==r.value&&(r.value=o),h==null)){r.defaultValue!==o&&(r.defaultValue=o);return}r.defaultValue=h!=null?""+Pt(h):""}function qn(r,o,h,g){if(o==null){if(g!=null){if(h!=null)throw Error(n(92));if(q(g)){if(1<g.length)throw Error(n(93));g=g[0]}h=g}h==null&&(h=""),o=h}h=Pt(o),r.defaultValue=h,g=r.textContent,g===h&&g!==""&&g!==null&&(r.value=g),An(r)}function Vn(r,o){if(o){var h=r.firstChild;if(h&&h===r.lastChild&&h.nodeType===3){h.nodeValue=o;return}}r.textContent=o}var cr=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function mn(r,o,h){var g=o.indexOf("--")===0;h==null||typeof h=="boolean"||h===""?g?r.setProperty(o,""):o==="float"?r.cssFloat="":r[o]="":g?r.setProperty(o,h):typeof h!="number"||h===0||cr.has(o)?o==="float"?r.cssFloat=h:r[o]=(""+h).trim():r[o]=h+"px"}function Jn(r,o,h){if(o!=null&&typeof o!="object")throw Error(n(62));if(r=r.style,h!=null){for(var g in h)!h.hasOwnProperty(g)||o!=null&&o.hasOwnProperty(g)||(g.indexOf("--")===0?r.setProperty(g,""):g==="float"?r.cssFloat="":r[g]="");for(var E in o)g=o[E],o.hasOwnProperty(E)&&h[E]!==g&&mn(r,E,g)}else for(var M in o)o.hasOwnProperty(M)&&mn(r,M,o[M])}function br(r){if(r.indexOf("-")===-1)return!1;switch(r){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var sr=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),$n=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Fi(r){return $n.test(""+r)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":r}function fi(){}var Mi=null;function qo(r){return r=r.target||r.srcElement||window,r.correspondingUseElement&&(r=r.correspondingUseElement),r.nodeType===3?r.parentNode:r}var as=null,gr=null;function _i(r){var o=tn(r);if(o&&(r=o.stateNode)){var h=r[vt]||null;e:switch(r=o.stateNode,o.type){case"input":if(Mn(r,h.value,h.defaultValue,h.defaultValue,h.checked,h.defaultChecked,h.type,h.name),o=h.name,h.type==="radio"&&o!=null){for(h=r;h.parentNode;)h=h.parentNode;for(h=h.querySelectorAll('input[name="'+_n(""+o)+'"][type="radio"]'),o=0;o<h.length;o++){var g=h[o];if(g!==r&&g.form===r.form){var E=g[vt]||null;if(!E)throw Error(n(90));Mn(g,E.value,E.defaultValue,E.defaultValue,E.checked,E.defaultChecked,E.type,E.name)}}for(o=0;o<h.length;o++)g=h[o],g.form===r.form&&kn(g)}break e;case"textarea":rr(r,h.value,h.defaultValue);break e;case"select":o=h.value,o!=null&&Rn(r,!!h.multiple,o,!1)}}}var ls=!1;function Cs(r,o,h){if(ls)return r(o,h);ls=!0;try{var g=r(o);return g}finally{if(ls=!1,(as!==null||gr!==null)&&(If(),as&&(o=as,r=gr,gr=as=null,_i(o),r)))for(o=0;o<r.length;o++)_i(r[o])}}function cs(r,o){var h=r.stateNode;if(h===null)return null;var g=h[vt]||null;if(g===null)return null;h=g[o];e:switch(o){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(g=!g.disabled)||(r=r.type,g=!(r==="button"||r==="input"||r==="select"||r==="textarea")),r=!g;break e;default:r=!1}if(r)return null;if(h&&typeof h!="function")throw Error(n(231,o,typeof h));return h}var Sr=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Fo=!1;if(Sr)try{var Wr={};Object.defineProperty(Wr,"passive",{get:function(){Fo=!0}}),window.addEventListener("test",Wr,Wr),window.removeEventListener("test",Wr,Wr)}catch{Fo=!1}var Si=null,Ho=null,As=null;function us(){if(As)return As;var r,o=Ho,h=o.length,g,E="value"in Si?Si.value:Si.textContent,M=E.length;for(r=0;r<h&&o[r]===E[r];r++);var X=h-r;for(g=1;g<=X&&o[h-g]===E[M-g];g++);return As=E.slice(r,1<g?1-g:void 0)}function ks(r){var o=r.keyCode;return"charCode"in r?(r=r.charCode,r===0&&o===13&&(r=13)):r=o,r===10&&(r=13),32<=r||r===13?r:0}function $s(){return!0}function Pl(){return!1}function Br(r){function o(h,g,E,M,X){this._reactName=h,this._targetInst=E,this.type=g,this.nativeEvent=M,this.target=X,this.currentTarget=null;for(var ue in r)r.hasOwnProperty(ue)&&(h=r[ue],this[ue]=h?h(M):M[ue]);return this.isDefaultPrevented=(M.defaultPrevented!=null?M.defaultPrevented:M.returnValue===!1)?$s:Pl,this.isPropagationStopped=Pl,this}return p(o.prototype,{preventDefault:function(){this.defaultPrevented=!0;var h=this.nativeEvent;h&&(h.preventDefault?h.preventDefault():typeof h.returnValue!="unknown"&&(h.returnValue=!1),this.isDefaultPrevented=$s)},stopPropagation:function(){var h=this.nativeEvent;h&&(h.stopPropagation?h.stopPropagation():typeof h.cancelBubble!="unknown"&&(h.cancelBubble=!0),this.isPropagationStopped=$s)},persist:function(){},isPersistent:$s}),o}var fs={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(r){return r.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},zo=Br(fs),$i=p({},fs,{view:0,detail:0}),Go=Br($i),Ys,za,hs,Ko=p({},$i,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:ds,button:0,buttons:0,relatedTarget:function(r){return r.relatedTarget===void 0?r.fromElement===r.srcElement?r.toElement:r.fromElement:r.relatedTarget},movementX:function(r){return"movementX"in r?r.movementX:(r!==hs&&(hs&&r.type==="mousemove"?(Ys=r.screenX-hs.screenX,za=r.screenY-hs.screenY):za=Ys=0,hs=r),Ys)},movementY:function(r){return"movementY"in r?r.movementY:za}}),Vo=Br(Ko),Ga=p({},Ko,{dataTransfer:0}),Ka=Br(Ga),$o=p({},$i,{relatedTarget:0}),Ts=Br($o),Ws=p({},fs,{animationName:0,elapsedTime:0,pseudoElement:0}),Ll=Br(Ws),Fc=p({},fs,{clipboardData:function(r){return"clipboardData"in r?r.clipboardData:window.clipboardData}}),Ms=Br(Fc),Va=p({},fs,{data:0}),Yo=Br(Va),$a={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Ya={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},zr={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Qs(r){var o=this.nativeEvent;return o.getModifierState?o.getModifierState(r):(r=zr[r])?!!o[r]:!1}function ds(){return Qs}var Ul=p({},$i,{key:function(r){if(r.key){var o=$a[r.key]||r.key;if(o!=="Unidentified")return o}return r.type==="keypress"?(r=ks(r),r===13?"Enter":String.fromCharCode(r)):r.type==="keydown"||r.type==="keyup"?Ya[r.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:ds,charCode:function(r){return r.type==="keypress"?ks(r):0},keyCode:function(r){return r.type==="keydown"||r.type==="keyup"?r.keyCode:0},which:function(r){return r.type==="keypress"?ks(r):r.type==="keydown"||r.type==="keyup"?r.keyCode:0}}),Wo=Br(Ul),Qo=p({},Ko,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Wa=Br(Qo),Yi=p({},$i,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:ds}),Qa=Br(Yi),ps=p({},fs,{propertyName:0,elapsedTime:0,pseudoElement:0}),Ja=Br(ps),Za=p({},Ko,{deltaX:function(r){return"deltaX"in r?r.deltaX:"wheelDeltaX"in r?-r.wheelDeltaX:0},deltaY:function(r){return"deltaY"in r?r.deltaY:"wheelDeltaY"in r?-r.wheelDeltaY:"wheelDelta"in r?-r.wheelDelta:0},deltaZ:0,deltaMode:0}),Jo=Br(Za),Xa=p({},fs,{newState:0,oldState:0}),ql=Br(Xa),Hc=[9,13,27,32],Js=Sr&&"CompositionEvent"in window,Yn=null;Sr&&"documentMode"in document&&(Yn=document.documentMode);var zc=Sr&&"TextEvent"in window&&!Yn,Ii=Sr&&(!Js||Yn&&8<Yn&&11>=Yn),Zs=" ",Fl=!1;function jn(r,o){switch(r){case"keyup":return Hc.indexOf(o.keyCode)!==-1;case"keydown":return o.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Hl(r){return r=r.detail,typeof r=="object"&&"data"in r?r.data:null}var gs=!1;function zl(r,o){switch(r){case"compositionend":return Hl(o);case"keypress":return o.which!==32?null:(Fl=!0,Zs);case"textInput":return r=o.data,r===Zs&&Fl?null:r;default:return null}}function Gc(r,o){if(gs)return r==="compositionend"||!Js&&jn(r,o)?(r=us(),As=Ho=Si=null,gs=!1,r):null;switch(r){case"paste":return null;case"keypress":if(!(o.ctrlKey||o.altKey||o.metaKey)||o.ctrlKey&&o.altKey){if(o.char&&1<o.char.length)return o.char;if(o.which)return String.fromCharCode(o.which)}return null;case"compositionend":return Ii&&o.locale!=="ko"?null:o.data;default:return null}}var Gl={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Zo(r){var o=r&&r.nodeName&&r.nodeName.toLowerCase();return o==="input"?!!Gl[r.type]:o==="textarea"}function el(r,o,h,g){as?gr?gr.push(g):gr=[g]:as=g,o=Pf(o,"onChange"),0<o.length&&(h=new zo("onChange","change",null,h,g),r.push({event:h,listeners:o}))}var Is=null,Xs=null;function Kc(r){f1(r,0)}function Xo(r){var o=dn(r);if(kn(o))return r}function eo(r,o){if(r==="change")return o}var Ri=!1;if(Sr){var mr;if(Sr){var Rs="oninput"in document;if(!Rs){var ri=document.createElement("div");ri.setAttribute("oninput","return;"),Rs=typeof ri.oninput=="function"}mr=Rs}else mr=!1;Ri=mr&&(!document.documentMode||9<document.documentMode)}function Kl(){Is&&(Is.detachEvent("onpropertychange",ea),Xs=Is=null)}function ea(r){if(r.propertyName==="value"&&Xo(Xs)){var o=[];el(o,Xs,r,qo(r)),Cs(Kc,o)}}function Vl(r,o,h){r==="focusin"?(Kl(),Is=o,Xs=h,Is.attachEvent("onpropertychange",ea)):r==="focusout"&&Kl()}function ms(r){if(r==="selectionchange"||r==="keyup"||r==="keydown")return Xo(Xs)}function tl(r,o){if(r==="click")return Xo(o)}function Os(r,o){if(r==="input"||r==="change")return Xo(o)}function Wi(r,o){return r===o&&(r!==0||1/r===1/o)||r!==r&&o!==o}var Jr=typeof Object.is=="function"?Object.is:Wi;function _(r,o){if(Jr(r,o))return!0;if(typeof r!="object"||r===null||typeof o!="object"||o===null)return!1;var h=Object.keys(r),g=Object.keys(o);if(h.length!==g.length)return!1;for(g=0;g<h.length;g++){var E=h[g];if(!rt.call(o,E)||!Jr(r[E],o[E]))return!1}return!0}function T(r){for(;r&&r.firstChild;)r=r.firstChild;return r}function L(r,o){var h=T(r);r=0;for(var g;h;){if(h.nodeType===3){if(g=r+h.textContent.length,r<=o&&g>=o)return{node:h,offset:o-r};r=g}e:{for(;h;){if(h.nextSibling){h=h.nextSibling;break e}h=h.parentNode}h=void 0}h=T(h)}}function J(r,o){return r&&o?r===o?!0:r&&r.nodeType===3?!1:o&&o.nodeType===3?J(r,o.parentNode):"contains"in r?r.contains(o):r.compareDocumentPosition?!!(r.compareDocumentPosition(o)&16):!1:!1}function re(r){r=r!=null&&r.ownerDocument!=null&&r.ownerDocument.defaultView!=null?r.ownerDocument.defaultView:window;for(var o=Ee(r.document);o instanceof r.HTMLIFrameElement;){try{var h=typeof o.contentWindow.location.href=="string"}catch{h=!1}if(h)r=o.contentWindow;else break;o=Ee(r.document)}return o}function le(r){var o=r&&r.nodeName&&r.nodeName.toLowerCase();return o&&(o==="input"&&(r.type==="text"||r.type==="search"||r.type==="tel"||r.type==="url"||r.type==="password")||o==="textarea"||r.contentEditable==="true")}var _e=Sr&&"documentMode"in document&&11>=document.documentMode,Re=null,Ue=null,qe=null,We=!1;function je(r,o,h){var g=h.window===h?h.document:h.nodeType===9?h:h.ownerDocument;We||Re==null||Re!==Ee(g)||(g=Re,"selectionStart"in g&&le(g)?g={start:g.selectionStart,end:g.selectionEnd}:(g=(g.ownerDocument&&g.ownerDocument.defaultView||window).getSelection(),g={anchorNode:g.anchorNode,anchorOffset:g.anchorOffset,focusNode:g.focusNode,focusOffset:g.focusOffset}),qe&&_(qe,g)||(qe=g,g=Pf(Ue,"onSelect"),0<g.length&&(o=new zo("onSelect","select",null,o,h),r.push({event:o,listeners:g}),o.target=Re)))}function Ze(r,o){var h={};return h[r.toLowerCase()]=o.toLowerCase(),h["Webkit"+r]="webkit"+o,h["Moz"+r]="moz"+o,h}var Fe={animationend:Ze("Animation","AnimationEnd"),animationiteration:Ze("Animation","AnimationIteration"),animationstart:Ze("Animation","AnimationStart"),transitionrun:Ze("Transition","TransitionRun"),transitionstart:Ze("Transition","TransitionStart"),transitioncancel:Ze("Transition","TransitionCancel"),transitionend:Ze("Transition","TransitionEnd")},Ve={},Ye={};Sr&&(Ye=document.createElement("div").style,"AnimationEvent"in window||(delete Fe.animationend.animation,delete Fe.animationiteration.animation,delete Fe.animationstart.animation),"TransitionEvent"in window||delete Fe.transitionend.transition);function Qe(r){if(Ve[r])return Ve[r];if(!Fe[r])return r;var o=Fe[r],h;for(h in o)if(o.hasOwnProperty(h)&&h in Ye)return Ve[r]=o[h];return r}var st=Qe("animationend"),ft=Qe("animationiteration"),xt=Qe("animationstart"),Dt=Qe("transitionrun"),H=Qe("transitionstart"),F=Qe("transitioncancel"),ie=Qe("transitionend"),he=new Map,xe="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");xe.push("scrollEnd");function Se(r,o){he.set(r,o),Wt(o,[r])}var Ne=typeof reportError=="function"?reportError:function(r){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var o=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof r=="object"&&r!==null&&typeof r.message=="string"?String(r.message):String(r),error:r});if(!window.dispatchEvent(o))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",r);return}console.error(r)},Pe=[],lt=0,It=0;function Vt(){for(var r=lt,o=It=lt=0;o<r;){var h=Pe[o];Pe[o++]=null;var g=Pe[o];Pe[o++]=null;var E=Pe[o];Pe[o++]=null;var M=Pe[o];if(Pe[o++]=null,g!==null&&E!==null){var X=g.pending;X===null?E.next=E:(E.next=X.next,X.next=E),g.pending=E}M!==0&&Xn(h,E,M)}}function Gt(r,o,h,g){Pe[lt++]=r,Pe[lt++]=o,Pe[lt++]=h,Pe[lt++]=g,It|=g,r.lanes|=g,r=r.alternate,r!==null&&(r.lanes|=g)}function En(r,o,h,g){return Gt(r,o,h,g),Un(r)}function bn(r,o){return Gt(r,null,null,o),Un(r)}function Xn(r,o,h){r.lanes|=h;var g=r.alternate;g!==null&&(g.lanes|=h);for(var E=!1,M=r.return;M!==null;)M.childLanes|=h,g=M.alternate,g!==null&&(g.childLanes|=h),M.tag===22&&(r=M.stateNode,r===null||r._visibility&1||(E=!0)),r=M,M=M.return;return r.tag===3?(M=r.stateNode,E&&o!==null&&(E=31-mt(h),r=M.hiddenUpdates,g=r[E],g===null?r[E]=[o]:g.push(o),o.lane=h|536870912),M):null}function Un(r){if(50<pu)throw pu=0,Kp=null,Error(n(185));for(var o=r.return;o!==null;)r=o,o=r.return;return r.tag===3?r.stateNode:null}var Wn={};function kr(r,o,h,g){this.tag=r,this.key=h,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=o,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=g,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Rr(r,o,h,g){return new kr(r,o,h,g)}function Zr(r){return r=r.prototype,!(!r||!r.isReactComponent)}function jr(r,o){var h=r.alternate;return h===null?(h=Rr(r.tag,o,r.key,r.mode),h.elementType=r.elementType,h.type=r.type,h.stateNode=r.stateNode,h.alternate=r,r.alternate=h):(h.pendingProps=o,h.type=r.type,h.flags=0,h.subtreeFlags=0,h.deletions=null),h.flags=r.flags&65011712,h.childLanes=r.childLanes,h.lanes=r.lanes,h.child=r.child,h.memoizedProps=r.memoizedProps,h.memoizedState=r.memoizedState,h.updateQueue=r.updateQueue,o=r.dependencies,h.dependencies=o===null?null:{lanes:o.lanes,firstContext:o.firstContext},h.sibling=r.sibling,h.index=r.index,h.ref=r.ref,h.refCleanup=r.refCleanup,h}function nl(r,o){r.flags&=65011714;var h=r.alternate;return h===null?(r.childLanes=0,r.lanes=o,r.child=null,r.subtreeFlags=0,r.memoizedProps=null,r.memoizedState=null,r.updateQueue=null,r.dependencies=null,r.stateNode=null):(r.childLanes=h.childLanes,r.lanes=h.lanes,r.child=h.child,r.subtreeFlags=0,r.deletions=null,r.memoizedProps=h.memoizedProps,r.memoizedState=h.memoizedState,r.updateQueue=h.updateQueue,r.type=h.type,o=h.dependencies,r.dependencies=o===null?null:{lanes:o.lanes,firstContext:o.firstContext}),r}function $l(r,o,h,g,E,M){var X=0;if(g=r,typeof r=="function")Zr(r)&&(X=1);else if(typeof r=="string")X=QT(r,h,Ae.current)?26:r==="html"||r==="head"||r==="body"?27:5;else e:switch(r){case te:return r=Rr(31,h,o,E),r.elementType=te,r.lanes=M,r;case y:return Ns(h.children,E,M,o);case w:X=8,E|=24;break;case C:return r=Rr(12,h,o,E|2),r.elementType=C,r.lanes=M,r;case A:return r=Rr(13,h,o,E),r.elementType=A,r.lanes=M,r;case R:return r=Rr(19,h,o,E),r.elementType=R,r.lanes=M,r;default:if(typeof r=="object"&&r!==null)switch(r.$$typeof){case x:X=10;break e;case S:X=9;break e;case k:X=11;break e;case I:X=14;break e;case U:X=16,g=null;break e}X=29,h=Error(n(130,r===null?"null":typeof r,"")),g=null}return o=Rr(X,h,o,E),o.elementType=r,o.type=g,o.lanes=M,o}function Ns(r,o,h,g){return r=Rr(7,r,g,o),r.lanes=h,r}function Yl(r,o,h){return r=Rr(6,r,null,o),r.lanes=h,r}function Vc(r){var o=Rr(18,null,null,0);return o.stateNode=r,o}function ta(r,o,h){return o=Rr(4,r.children!==null?r.children:[],r.key,o),o.lanes=h,o.stateNode={containerInfo:r.containerInfo,pendingChildren:null,implementation:r.implementation},o}var rl=new WeakMap;function Ei(r,o){if(typeof r=="object"&&r!==null){var h=rl.get(r);return h!==void 0?h:(o={value:r,source:o,stack:Je(o)},rl.set(r,o),o)}return{value:r,source:o,stack:Je(o)}}var Wl=[],Ql=0,ef=null,$c=0,Qi=[],Ji=0,na=null,Bs=1,js="";function to(r,o){Wl[Ql++]=$c,Wl[Ql++]=ef,ef=r,$c=o}function Qb(r,o,h){Qi[Ji++]=Bs,Qi[Ji++]=js,Qi[Ji++]=na,na=r;var g=Bs;r=js;var E=32-mt(g)-1;g&=~(1<<E),h+=1;var M=32-mt(o)+E;if(30<M){var X=E-E%5;M=(g&(1<<X)-1).toString(32),g>>=X,E-=X,Bs=1<<32-mt(o)+E|h<<E|g,js=M+r}else Bs=1<<M|h<<E|g,js=r}function qd(r){r.return!==null&&(to(r,1),Qb(r,1,0))}function Fd(r){for(;r===ef;)ef=Wl[--Ql],Wl[Ql]=null,$c=Wl[--Ql],Wl[Ql]=null;for(;r===na;)na=Qi[--Ji],Qi[Ji]=null,js=Qi[--Ji],Qi[Ji]=null,Bs=Qi[--Ji],Qi[Ji]=null}function Jb(r,o){Qi[Ji++]=Bs,Qi[Ji++]=js,Qi[Ji++]=na,Bs=o.id,js=o.overflow,na=r}var ii=null,Er=null,Qn=!1,ra=null,Zi=!1,Hd=Error(n(519));function ia(r){var o=Error(n(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw Yc(Ei(o,r)),Hd}function Zb(r){var o=r.stateNode,h=r.type,g=r.memoizedProps;switch(o[ze]=r,o[vt]=g,h){case"dialog":Hn("cancel",o),Hn("close",o);break;case"iframe":case"object":case"embed":Hn("load",o);break;case"video":case"audio":for(h=0;h<mu.length;h++)Hn(mu[h],o);break;case"source":Hn("error",o);break;case"img":case"image":case"link":Hn("error",o),Hn("load",o);break;case"details":Hn("toggle",o);break;case"input":Hn("invalid",o),In(o,g.value,g.defaultValue,g.checked,g.defaultChecked,g.type,g.name,!0);break;case"select":Hn("invalid",o);break;case"textarea":Hn("invalid",o),qn(o,g.value,g.defaultValue,g.children)}h=g.children,typeof h!="string"&&typeof h!="number"&&typeof h!="bigint"||o.textContent===""+h||g.suppressHydrationWarning===!0||g1(o.textContent,h)?(g.popover!=null&&(Hn("beforetoggle",o),Hn("toggle",o)),g.onScroll!=null&&Hn("scroll",o),g.onScrollEnd!=null&&Hn("scrollend",o),g.onClick!=null&&(o.onclick=fi),o=!0):o=!1,o||ia(r,!0)}function Xb(r){for(ii=r.return;ii;)switch(ii.tag){case 5:case 31:case 13:Zi=!1;return;case 27:case 3:Zi=!0;return;default:ii=ii.return}}function Jl(r){if(r!==ii)return!1;if(!Qn)return Xb(r),Qn=!0,!1;var o=r.tag,h;if((h=o!==3&&o!==27)&&((h=o===5)&&(h=r.type,h=!(h!=="form"&&h!=="button")||og(r.type,r.memoizedProps)),h=!h),h&&Er&&ia(r),Xb(r),o===13){if(r=r.memoizedState,r=r!==null?r.dehydrated:null,!r)throw Error(n(317));Er=E1(r)}else if(o===31){if(r=r.memoizedState,r=r!==null?r.dehydrated:null,!r)throw Error(n(317));Er=E1(r)}else o===27?(o=Er,ba(r.type)?(r=fg,fg=null,Er=r):Er=o):Er=ii?es(r.stateNode.nextSibling):null;return!0}function il(){Er=ii=null,Qn=!1}function zd(){var r=ra;return r!==null&&(ji===null?ji=r:ji.push.apply(ji,r),ra=null),r}function Yc(r){ra===null?ra=[r]:ra.push(r)}var Gd=V(null),sl=null,no=null;function sa(r,o,h){ae(Gd,o._currentValue),o._currentValue=h}function ro(r){r._currentValue=Gd.current,Z(Gd)}function Kd(r,o,h){for(;r!==null;){var g=r.alternate;if((r.childLanes&o)!==o?(r.childLanes|=o,g!==null&&(g.childLanes|=o)):g!==null&&(g.childLanes&o)!==o&&(g.childLanes|=o),r===h)break;r=r.return}}function Vd(r,o,h,g){var E=r.child;for(E!==null&&(E.return=r);E!==null;){var M=E.dependencies;if(M!==null){var X=E.child;M=M.firstContext;e:for(;M!==null;){var ue=M;M=E;for(var De=0;De<o.length;De++)if(ue.context===o[De]){M.lanes|=h,ue=M.alternate,ue!==null&&(ue.lanes|=h),Kd(M.return,h,r),g||(X=null);break e}M=ue.next}}else if(E.tag===18){if(X=E.return,X===null)throw Error(n(341));X.lanes|=h,M=X.alternate,M!==null&&(M.lanes|=h),Kd(X,h,r),X=null}else X=E.child;if(X!==null)X.return=E;else for(X=E;X!==null;){if(X===r){X=null;break}if(E=X.sibling,E!==null){E.return=X.return,X=E;break}X=X.return}E=X}}function Zl(r,o,h,g){r=null;for(var E=o,M=!1;E!==null;){if(!M){if((E.flags&524288)!==0)M=!0;else if((E.flags&262144)!==0)break}if(E.tag===10){var X=E.alternate;if(X===null)throw Error(n(387));if(X=X.memoizedProps,X!==null){var ue=E.type;Jr(E.pendingProps.value,X.value)||(r!==null?r.push(ue):r=[ue])}}else if(E===Te.current){if(X=E.alternate,X===null)throw Error(n(387));X.memoizedState.memoizedState!==E.memoizedState.memoizedState&&(r!==null?r.push(xu):r=[xu])}E=E.return}r!==null&&Vd(o,r,h,g),o.flags|=262144}function tf(r){for(r=r.firstContext;r!==null;){if(!Jr(r.context._currentValue,r.memoizedValue))return!0;r=r.next}return!1}function ol(r){sl=r,no=null,r=r.dependencies,r!==null&&(r.firstContext=null)}function si(r){return ev(sl,r)}function nf(r,o){return sl===null&&ol(r),ev(r,o)}function ev(r,o){var h=o._currentValue;if(o={context:o,memoizedValue:h,next:null},no===null){if(r===null)throw Error(n(308));no=o,r.dependencies={lanes:0,firstContext:o},r.flags|=524288}else no=no.next=o;return h}var Vk=typeof AbortController<"u"?AbortController:function(){var r=[],o=this.signal={aborted:!1,addEventListener:function(h,g){r.push(g)}};this.abort=function(){o.aborted=!0,r.forEach(function(h){return h()})}},$k=i.unstable_scheduleCallback,Yk=i.unstable_NormalPriority,Gr={$$typeof:x,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function $d(){return{controller:new Vk,data:new Map,refCount:0}}function Wc(r){r.refCount--,r.refCount===0&&$k(Yk,function(){r.controller.abort()})}var Qc=null,Yd=0,Xl=0,ec=null;function Wk(r,o){if(Qc===null){var h=Qc=[];Yd=0,Xl=Jp(),ec={status:"pending",value:void 0,then:function(g){h.push(g)}}}return Yd++,o.then(tv,tv),o}function tv(){if(--Yd===0&&Qc!==null){ec!==null&&(ec.status="fulfilled");var r=Qc;Qc=null,Xl=0,ec=null;for(var o=0;o<r.length;o++)(0,r[o])()}}function Qk(r,o){var h=[],g={status:"pending",value:null,reason:null,then:function(E){h.push(E)}};return r.then(function(){g.status="fulfilled",g.value=o;for(var E=0;E<h.length;E++)(0,h[E])(o)},function(E){for(g.status="rejected",g.reason=E,E=0;E<h.length;E++)(0,h[E])(void 0)}),g}var nv=ee.S;ee.S=function(r,o){Uw=nt(),typeof o=="object"&&o!==null&&typeof o.then=="function"&&Wk(r,o),nv!==null&&nv(r,o)};var al=V(null);function Wd(){var r=al.current;return r!==null?r:yr.pooledCache}function rf(r,o){o===null?ae(al,al.current):ae(al,o.pool)}function rv(){var r=Wd();return r===null?null:{parent:Gr._currentValue,pool:r}}var tc=Error(n(460)),Qd=Error(n(474)),sf=Error(n(542)),of={then:function(){}};function iv(r){return r=r.status,r==="fulfilled"||r==="rejected"}function sv(r,o,h){switch(h=r[h],h===void 0?r.push(o):h!==o&&(o.then(fi,fi),o=h),o.status){case"fulfilled":return o.value;case"rejected":throw r=o.reason,av(r),r;default:if(typeof o.status=="string")o.then(fi,fi);else{if(r=yr,r!==null&&100<r.shellSuspendCounter)throw Error(n(482));r=o,r.status="pending",r.then(function(g){if(o.status==="pending"){var E=o;E.status="fulfilled",E.value=g}},function(g){if(o.status==="pending"){var E=o;E.status="rejected",E.reason=g}})}switch(o.status){case"fulfilled":return o.value;case"rejected":throw r=o.reason,av(r),r}throw cl=o,tc}}function ll(r){try{var o=r._init;return o(r._payload)}catch(h){throw h!==null&&typeof h=="object"&&typeof h.then=="function"?(cl=h,tc):h}}var cl=null;function ov(){if(cl===null)throw Error(n(459));var r=cl;return cl=null,r}function av(r){if(r===tc||r===sf)throw Error(n(483))}var nc=null,Jc=0;function af(r){var o=Jc;return Jc+=1,nc===null&&(nc=[]),sv(nc,r,o)}function Zc(r,o){o=o.props.ref,r.ref=o!==void 0?o:null}function lf(r,o){throw o.$$typeof===m?Error(n(525)):(r=Object.prototype.toString.call(o),Error(n(31,r==="[object Object]"?"object with keys {"+Object.keys(o).join(", ")+"}":r)))}function lv(r){function o(tt,He){if(r){var ct=tt.deletions;ct===null?(tt.deletions=[He],tt.flags|=16):ct.push(He)}}function h(tt,He){if(!r)return null;for(;He!==null;)o(tt,He),He=He.sibling;return null}function g(tt){for(var He=new Map;tt!==null;)tt.key!==null?He.set(tt.key,tt):He.set(tt.index,tt),tt=tt.sibling;return He}function E(tt,He){return tt=jr(tt,He),tt.index=0,tt.sibling=null,tt}function M(tt,He,ct){return tt.index=ct,r?(ct=tt.alternate,ct!==null?(ct=ct.index,ct<He?(tt.flags|=67108866,He):ct):(tt.flags|=67108866,He)):(tt.flags|=1048576,He)}function X(tt){return r&&tt.alternate===null&&(tt.flags|=67108866),tt}function ue(tt,He,ct,Bt){return He===null||He.tag!==6?(He=Yl(ct,tt.mode,Bt),He.return=tt,He):(He=E(He,ct),He.return=tt,He)}function De(tt,He,ct,Bt){var Sn=ct.type;return Sn===y?Tt(tt,He,ct.props.children,Bt,ct.key):He!==null&&(He.elementType===Sn||typeof Sn=="object"&&Sn!==null&&Sn.$$typeof===U&&ll(Sn)===He.type)?(He=E(He,ct.props),Zc(He,ct),He.return=tt,He):(He=$l(ct.type,ct.key,ct.props,null,tt.mode,Bt),Zc(He,ct),He.return=tt,He)}function ut(tt,He,ct,Bt){return He===null||He.tag!==4||He.stateNode.containerInfo!==ct.containerInfo||He.stateNode.implementation!==ct.implementation?(He=ta(ct,tt.mode,Bt),He.return=tt,He):(He=E(He,ct.children||[]),He.return=tt,He)}function Tt(tt,He,ct,Bt,Sn){return He===null||He.tag!==7?(He=Ns(ct,tt.mode,Bt,Sn),He.return=tt,He):(He=E(He,ct),He.return=tt,He)}function Lt(tt,He,ct){if(typeof He=="string"&&He!==""||typeof He=="number"||typeof He=="bigint")return He=Yl(""+He,tt.mode,ct),He.return=tt,He;if(typeof He=="object"&&He!==null){switch(He.$$typeof){case v:return ct=$l(He.type,He.key,He.props,null,tt.mode,ct),Zc(ct,He),ct.return=tt,ct;case b:return He=ta(He,tt.mode,ct),He.return=tt,He;case U:return He=ll(He),Lt(tt,He,ct)}if(q(He)||O(He))return He=Ns(He,tt.mode,ct,null),He.return=tt,He;if(typeof He.then=="function")return Lt(tt,af(He),ct);if(He.$$typeof===x)return Lt(tt,nf(tt,He),ct);lf(tt,He)}return null}function dt(tt,He,ct,Bt){var Sn=He!==null?He.key:null;if(typeof ct=="string"&&ct!==""||typeof ct=="number"||typeof ct=="bigint")return Sn!==null?null:ue(tt,He,""+ct,Bt);if(typeof ct=="object"&&ct!==null){switch(ct.$$typeof){case v:return ct.key===Sn?De(tt,He,ct,Bt):null;case b:return ct.key===Sn?ut(tt,He,ct,Bt):null;case U:return ct=ll(ct),dt(tt,He,ct,Bt)}if(q(ct)||O(ct))return Sn!==null?null:Tt(tt,He,ct,Bt,null);if(typeof ct.then=="function")return dt(tt,He,af(ct),Bt);if(ct.$$typeof===x)return dt(tt,He,nf(tt,ct),Bt);lf(tt,ct)}return null}function wt(tt,He,ct,Bt,Sn){if(typeof Bt=="string"&&Bt!==""||typeof Bt=="number"||typeof Bt=="bigint")return tt=tt.get(ct)||null,ue(He,tt,""+Bt,Sn);if(typeof Bt=="object"&&Bt!==null){switch(Bt.$$typeof){case v:return tt=tt.get(Bt.key===null?ct:Bt.key)||null,De(He,tt,Bt,Sn);case b:return tt=tt.get(Bt.key===null?ct:Bt.key)||null,ut(He,tt,Bt,Sn);case U:return Bt=ll(Bt),wt(tt,He,ct,Bt,Sn)}if(q(Bt)||O(Bt))return tt=tt.get(ct)||null,Tt(He,tt,Bt,Sn,null);if(typeof Bt.then=="function")return wt(tt,He,ct,af(Bt),Sn);if(Bt.$$typeof===x)return wt(tt,He,ct,nf(He,Bt),Sn);lf(He,Bt)}return null}function un(tt,He,ct,Bt){for(var Sn=null,er=null,yn=He,Ln=He=0,Kn=null;yn!==null&&Ln<ct.length;Ln++){yn.index>Ln?(Kn=yn,yn=null):Kn=yn.sibling;var tr=dt(tt,yn,ct[Ln],Bt);if(tr===null){yn===null&&(yn=Kn);break}r&&yn&&tr.alternate===null&&o(tt,yn),He=M(tr,He,Ln),er===null?Sn=tr:er.sibling=tr,er=tr,yn=Kn}if(Ln===ct.length)return h(tt,yn),Qn&&to(tt,Ln),Sn;if(yn===null){for(;Ln<ct.length;Ln++)yn=Lt(tt,ct[Ln],Bt),yn!==null&&(He=M(yn,He,Ln),er===null?Sn=yn:er.sibling=yn,er=yn);return Qn&&to(tt,Ln),Sn}for(yn=g(yn);Ln<ct.length;Ln++)Kn=wt(yn,tt,Ln,ct[Ln],Bt),Kn!==null&&(r&&Kn.alternate!==null&&yn.delete(Kn.key===null?Ln:Kn.key),He=M(Kn,He,Ln),er===null?Sn=Kn:er.sibling=Kn,er=Kn);return r&&yn.forEach(function(Sa){return o(tt,Sa)}),Qn&&to(tt,Ln),Sn}function Cn(tt,He,ct,Bt){if(ct==null)throw Error(n(151));for(var Sn=null,er=null,yn=He,Ln=He=0,Kn=null,tr=ct.next();yn!==null&&!tr.done;Ln++,tr=ct.next()){yn.index>Ln?(Kn=yn,yn=null):Kn=yn.sibling;var Sa=dt(tt,yn,tr.value,Bt);if(Sa===null){yn===null&&(yn=Kn);break}r&&yn&&Sa.alternate===null&&o(tt,yn),He=M(Sa,He,Ln),er===null?Sn=Sa:er.sibling=Sa,er=Sa,yn=Kn}if(tr.done)return h(tt,yn),Qn&&to(tt,Ln),Sn;if(yn===null){for(;!tr.done;Ln++,tr=ct.next())tr=Lt(tt,tr.value,Bt),tr!==null&&(He=M(tr,He,Ln),er===null?Sn=tr:er.sibling=tr,er=tr);return Qn&&to(tt,Ln),Sn}for(yn=g(yn);!tr.done;Ln++,tr=ct.next())tr=wt(yn,tt,Ln,tr.value,Bt),tr!==null&&(r&&tr.alternate!==null&&yn.delete(tr.key===null?Ln:tr.key),He=M(tr,He,Ln),er===null?Sn=tr:er.sibling=tr,er=tr);return r&&yn.forEach(function(a3){return o(tt,a3)}),Qn&&to(tt,Ln),Sn}function hr(tt,He,ct,Bt){if(typeof ct=="object"&&ct!==null&&ct.type===y&&ct.key===null&&(ct=ct.props.children),typeof ct=="object"&&ct!==null){switch(ct.$$typeof){case v:e:{for(var Sn=ct.key;He!==null;){if(He.key===Sn){if(Sn=ct.type,Sn===y){if(He.tag===7){h(tt,He.sibling),Bt=E(He,ct.props.children),Bt.return=tt,tt=Bt;break e}}else if(He.elementType===Sn||typeof Sn=="object"&&Sn!==null&&Sn.$$typeof===U&&ll(Sn)===He.type){h(tt,He.sibling),Bt=E(He,ct.props),Zc(Bt,ct),Bt.return=tt,tt=Bt;break e}h(tt,He);break}else o(tt,He);He=He.sibling}ct.type===y?(Bt=Ns(ct.props.children,tt.mode,Bt,ct.key),Bt.return=tt,tt=Bt):(Bt=$l(ct.type,ct.key,ct.props,null,tt.mode,Bt),Zc(Bt,ct),Bt.return=tt,tt=Bt)}return X(tt);case b:e:{for(Sn=ct.key;He!==null;){if(He.key===Sn)if(He.tag===4&&He.stateNode.containerInfo===ct.containerInfo&&He.stateNode.implementation===ct.implementation){h(tt,He.sibling),Bt=E(He,ct.children||[]),Bt.return=tt,tt=Bt;break e}else{h(tt,He);break}else o(tt,He);He=He.sibling}Bt=ta(ct,tt.mode,Bt),Bt.return=tt,tt=Bt}return X(tt);case U:return ct=ll(ct),hr(tt,He,ct,Bt)}if(q(ct))return un(tt,He,ct,Bt);if(O(ct)){if(Sn=O(ct),typeof Sn!="function")throw Error(n(150));return ct=Sn.call(ct),Cn(tt,He,ct,Bt)}if(typeof ct.then=="function")return hr(tt,He,af(ct),Bt);if(ct.$$typeof===x)return hr(tt,He,nf(tt,ct),Bt);lf(tt,ct)}return typeof ct=="string"&&ct!==""||typeof ct=="number"||typeof ct=="bigint"?(ct=""+ct,He!==null&&He.tag===6?(h(tt,He.sibling),Bt=E(He,ct),Bt.return=tt,tt=Bt):(h(tt,He),Bt=Yl(ct,tt.mode,Bt),Bt.return=tt,tt=Bt),X(tt)):h(tt,He)}return function(tt,He,ct,Bt){try{Jc=0;var Sn=hr(tt,He,ct,Bt);return nc=null,Sn}catch(yn){if(yn===tc||yn===sf)throw yn;var er=Rr(29,yn,null,tt.mode);return er.lanes=Bt,er.return=tt,er}finally{}}}var ul=lv(!0),cv=lv(!1),oa=!1;function Jd(r){r.updateQueue={baseState:r.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Zd(r,o){r=r.updateQueue,o.updateQueue===r&&(o.updateQueue={baseState:r.baseState,firstBaseUpdate:r.firstBaseUpdate,lastBaseUpdate:r.lastBaseUpdate,shared:r.shared,callbacks:null})}function aa(r){return{lane:r,tag:0,payload:null,callback:null,next:null}}function la(r,o,h){var g=r.updateQueue;if(g===null)return null;if(g=g.shared,(ir&2)!==0){var E=g.pending;return E===null?o.next=o:(o.next=E.next,E.next=o),g.pending=o,o=Un(r),Xn(r,null,h),o}return Gt(r,g,o,h),Un(r)}function Xc(r,o,h){if(o=o.updateQueue,o!==null&&(o=o.shared,(h&4194048)!==0)){var g=o.lanes;g&=r.pendingLanes,h|=g,o.lanes=h,At(r,h)}}function Xd(r,o){var h=r.updateQueue,g=r.alternate;if(g!==null&&(g=g.updateQueue,h===g)){var E=null,M=null;if(h=h.firstBaseUpdate,h!==null){do{var X={lane:h.lane,tag:h.tag,payload:h.payload,callback:null,next:null};M===null?E=M=X:M=M.next=X,h=h.next}while(h!==null);M===null?E=M=o:M=M.next=o}else E=M=o;h={baseState:g.baseState,firstBaseUpdate:E,lastBaseUpdate:M,shared:g.shared,callbacks:g.callbacks},r.updateQueue=h;return}r=h.lastBaseUpdate,r===null?h.firstBaseUpdate=o:r.next=o,h.lastBaseUpdate=o}var ep=!1;function eu(){if(ep){var r=ec;if(r!==null)throw r}}function tu(r,o,h,g){ep=!1;var E=r.updateQueue;oa=!1;var M=E.firstBaseUpdate,X=E.lastBaseUpdate,ue=E.shared.pending;if(ue!==null){E.shared.pending=null;var De=ue,ut=De.next;De.next=null,X===null?M=ut:X.next=ut,X=De;var Tt=r.alternate;Tt!==null&&(Tt=Tt.updateQueue,ue=Tt.lastBaseUpdate,ue!==X&&(ue===null?Tt.firstBaseUpdate=ut:ue.next=ut,Tt.lastBaseUpdate=De))}if(M!==null){var Lt=E.baseState;X=0,Tt=ut=De=null,ue=M;do{var dt=ue.lane&-536870913,wt=dt!==ue.lane;if(wt?(Gn&dt)===dt:(g&dt)===dt){dt!==0&&dt===Xl&&(ep=!0),Tt!==null&&(Tt=Tt.next={lane:0,tag:ue.tag,payload:ue.payload,callback:null,next:null});e:{var un=r,Cn=ue;dt=o;var hr=h;switch(Cn.tag){case 1:if(un=Cn.payload,typeof un=="function"){Lt=un.call(hr,Lt,dt);break e}Lt=un;break e;case 3:un.flags=un.flags&-65537|128;case 0:if(un=Cn.payload,dt=typeof un=="function"?un.call(hr,Lt,dt):un,dt==null)break e;Lt=p({},Lt,dt);break e;case 2:oa=!0}}dt=ue.callback,dt!==null&&(r.flags|=64,wt&&(r.flags|=8192),wt=E.callbacks,wt===null?E.callbacks=[dt]:wt.push(dt))}else wt={lane:dt,tag:ue.tag,payload:ue.payload,callback:ue.callback,next:null},Tt===null?(ut=Tt=wt,De=Lt):Tt=Tt.next=wt,X|=dt;if(ue=ue.next,ue===null){if(ue=E.shared.pending,ue===null)break;wt=ue,ue=wt.next,wt.next=null,E.lastBaseUpdate=wt,E.shared.pending=null}}while(!0);Tt===null&&(De=Lt),E.baseState=De,E.firstBaseUpdate=ut,E.lastBaseUpdate=Tt,M===null&&(E.shared.lanes=0),da|=X,r.lanes=X,r.memoizedState=Lt}}function uv(r,o){if(typeof r!="function")throw Error(n(191,r));r.call(o)}function fv(r,o){var h=r.callbacks;if(h!==null)for(r.callbacks=null,r=0;r<h.length;r++)uv(h[r],o)}var rc=V(null),cf=V(0);function hv(r,o){r=ho,ae(cf,r),ae(rc,o),ho=r|o.baseLanes}function tp(){ae(cf,ho),ae(rc,rc.current)}function np(){ho=cf.current,Z(rc),Z(cf)}var Hi=V(null),Xi=null;function ca(r){var o=r.alternate;ae(qr,qr.current&1),ae(Hi,r),Xi===null&&(o===null||rc.current!==null||o.memoizedState!==null)&&(Xi=r)}function rp(r){ae(qr,qr.current),ae(Hi,r),Xi===null&&(Xi=r)}function dv(r){r.tag===22?(ae(qr,qr.current),ae(Hi,r),Xi===null&&(Xi=r)):ua()}function ua(){ae(qr,qr.current),ae(Hi,Hi.current)}function zi(r){Z(Hi),Xi===r&&(Xi=null),Z(qr)}var qr=V(0);function uf(r){for(var o=r;o!==null;){if(o.tag===13){var h=o.memoizedState;if(h!==null&&(h=h.dehydrated,h===null||cg(h)||ug(h)))return o}else if(o.tag===19&&(o.memoizedProps.revealOrder==="forwards"||o.memoizedProps.revealOrder==="backwards"||o.memoizedProps.revealOrder==="unstable_legacy-backwards"||o.memoizedProps.revealOrder==="together")){if((o.flags&128)!==0)return o}else if(o.child!==null){o.child.return=o,o=o.child;continue}if(o===r)break;for(;o.sibling===null;){if(o.return===null||o.return===r)return null;o=o.return}o.sibling.return=o.return,o=o.sibling}return null}var io=0,Dn=null,ur=null,Kr=null,ff=!1,ic=!1,fl=!1,hf=0,nu=0,sc=null,Jk=0;function Dr(){throw Error(n(321))}function ip(r,o){if(o===null)return!1;for(var h=0;h<o.length&&h<r.length;h++)if(!Jr(r[h],o[h]))return!1;return!0}function sp(r,o,h,g,E,M){return io=M,Dn=o,o.memoizedState=null,o.updateQueue=null,o.lanes=0,ee.H=r===null||r.memoizedState===null?Qv:wp,fl=!1,M=h(g,E),fl=!1,ic&&(M=gv(o,h,g,E)),pv(r),M}function pv(r){ee.H=su;var o=ur!==null&&ur.next!==null;if(io=0,Kr=ur=Dn=null,ff=!1,nu=0,sc=null,o)throw Error(n(300));r===null||Vr||(r=r.dependencies,r!==null&&tf(r)&&(Vr=!0))}function gv(r,o,h,g){Dn=r;var E=0;do{if(ic&&(sc=null),nu=0,ic=!1,25<=E)throw Error(n(301));if(E+=1,Kr=ur=null,r.updateQueue!=null){var M=r.updateQueue;M.lastEffect=null,M.events=null,M.stores=null,M.memoCache!=null&&(M.memoCache.index=0)}ee.H=Jv,M=o(h,g)}while(ic);return M}function Zk(){var r=ee.H,o=r.useState()[0];return o=typeof o.then=="function"?ru(o):o,r=r.useState()[0],(ur!==null?ur.memoizedState:null)!==r&&(Dn.flags|=1024),o}function op(){var r=hf!==0;return hf=0,r}function ap(r,o,h){o.updateQueue=r.updateQueue,o.flags&=-2053,r.lanes&=~h}function lp(r){if(ff){for(r=r.memoizedState;r!==null;){var o=r.queue;o!==null&&(o.pending=null),r=r.next}ff=!1}io=0,Kr=ur=Dn=null,ic=!1,nu=hf=0,sc=null}function Ci(){var r={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Kr===null?Dn.memoizedState=Kr=r:Kr=Kr.next=r,Kr}function Fr(){if(ur===null){var r=Dn.alternate;r=r!==null?r.memoizedState:null}else r=ur.next;var o=Kr===null?Dn.memoizedState:Kr.next;if(o!==null)Kr=o,ur=r;else{if(r===null)throw Dn.alternate===null?Error(n(467)):Error(n(310));ur=r,r={memoizedState:ur.memoizedState,baseState:ur.baseState,baseQueue:ur.baseQueue,queue:ur.queue,next:null},Kr===null?Dn.memoizedState=Kr=r:Kr=Kr.next=r}return Kr}function df(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function ru(r){var o=nu;return nu+=1,sc===null&&(sc=[]),r=sv(sc,r,o),o=Dn,(Kr===null?o.memoizedState:Kr.next)===null&&(o=o.alternate,ee.H=o===null||o.memoizedState===null?Qv:wp),r}function pf(r){if(r!==null&&typeof r=="object"){if(typeof r.then=="function")return ru(r);if(r.$$typeof===x)return si(r)}throw Error(n(438,String(r)))}function cp(r){var o=null,h=Dn.updateQueue;if(h!==null&&(o=h.memoCache),o==null){var g=Dn.alternate;g!==null&&(g=g.updateQueue,g!==null&&(g=g.memoCache,g!=null&&(o={data:g.data.map(function(E){return E.slice()}),index:0})))}if(o==null&&(o={data:[],index:0}),h===null&&(h=df(),Dn.updateQueue=h),h.memoCache=o,h=o.data[o.index],h===void 0)for(h=o.data[o.index]=Array(r),g=0;g<r;g++)h[g]=G;return o.index++,h}function so(r,o){return typeof o=="function"?o(r):o}function gf(r){var o=Fr();return up(o,ur,r)}function up(r,o,h){var g=r.queue;if(g===null)throw Error(n(311));g.lastRenderedReducer=h;var E=r.baseQueue,M=g.pending;if(M!==null){if(E!==null){var X=E.next;E.next=M.next,M.next=X}o.baseQueue=E=M,g.pending=null}if(M=r.baseState,E===null)r.memoizedState=M;else{o=E.next;var ue=X=null,De=null,ut=o,Tt=!1;do{var Lt=ut.lane&-536870913;if(Lt!==ut.lane?(Gn&Lt)===Lt:(io&Lt)===Lt){var dt=ut.revertLane;if(dt===0)De!==null&&(De=De.next={lane:0,revertLane:0,gesture:null,action:ut.action,hasEagerState:ut.hasEagerState,eagerState:ut.eagerState,next:null}),Lt===Xl&&(Tt=!0);else if((io&dt)===dt){ut=ut.next,dt===Xl&&(Tt=!0);continue}else Lt={lane:0,revertLane:ut.revertLane,gesture:null,action:ut.action,hasEagerState:ut.hasEagerState,eagerState:ut.eagerState,next:null},De===null?(ue=De=Lt,X=M):De=De.next=Lt,Dn.lanes|=dt,da|=dt;Lt=ut.action,fl&&h(M,Lt),M=ut.hasEagerState?ut.eagerState:h(M,Lt)}else dt={lane:Lt,revertLane:ut.revertLane,gesture:ut.gesture,action:ut.action,hasEagerState:ut.hasEagerState,eagerState:ut.eagerState,next:null},De===null?(ue=De=dt,X=M):De=De.next=dt,Dn.lanes|=Lt,da|=Lt;ut=ut.next}while(ut!==null&&ut!==o);if(De===null?X=M:De.next=ue,!Jr(M,r.memoizedState)&&(Vr=!0,Tt&&(h=ec,h!==null)))throw h;r.memoizedState=M,r.baseState=X,r.baseQueue=De,g.lastRenderedState=M}return E===null&&(g.lanes=0),[r.memoizedState,g.dispatch]}function fp(r){var o=Fr(),h=o.queue;if(h===null)throw Error(n(311));h.lastRenderedReducer=r;var g=h.dispatch,E=h.pending,M=o.memoizedState;if(E!==null){h.pending=null;var X=E=E.next;do M=r(M,X.action),X=X.next;while(X!==E);Jr(M,o.memoizedState)||(Vr=!0),o.memoizedState=M,o.baseQueue===null&&(o.baseState=M),h.lastRenderedState=M}return[M,g]}function mv(r,o,h){var g=Dn,E=Fr(),M=Qn;if(M){if(h===void 0)throw Error(n(407));h=h()}else h=o();var X=!Jr((ur||E).memoizedState,h);if(X&&(E.memoizedState=h,Vr=!0),E=E.queue,pp(vv.bind(null,g,E,r),[r]),E.getSnapshot!==o||X||Kr!==null&&Kr.memoizedState.tag&1){if(g.flags|=2048,oc(9,{destroy:void 0},bv.bind(null,g,E,h,o),null),yr===null)throw Error(n(349));M||(io&127)!==0||yv(g,o,h)}return h}function yv(r,o,h){r.flags|=16384,r={getSnapshot:o,value:h},o=Dn.updateQueue,o===null?(o=df(),Dn.updateQueue=o,o.stores=[r]):(h=o.stores,h===null?o.stores=[r]:h.push(r))}function bv(r,o,h,g){o.value=h,o.getSnapshot=g,wv(o)&&xv(r)}function vv(r,o,h){return h(function(){wv(o)&&xv(r)})}function wv(r){var o=r.getSnapshot;r=r.value;try{var h=o();return!Jr(r,h)}catch{return!0}}function xv(r){var o=bn(r,2);o!==null&&Di(o,r,2)}function hp(r){var o=Ci();if(typeof r=="function"){var h=r;if(r=h(),fl){zt(!0);try{h()}finally{zt(!1)}}}return o.memoizedState=o.baseState=r,o.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:so,lastRenderedState:r},o}function _v(r,o,h,g){return r.baseState=h,up(r,ur,typeof g=="function"?g:so)}function Xk(r,o,h,g,E){if(bf(r))throw Error(n(485));if(r=o.action,r!==null){var M={payload:E,action:r,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(X){M.listeners.push(X)}};ee.T!==null?h(!0):M.isTransition=!1,g(M),h=o.pending,h===null?(M.next=o.pending=M,Sv(o,M)):(M.next=h.next,o.pending=h.next=M)}}function Sv(r,o){var h=o.action,g=o.payload,E=r.state;if(o.isTransition){var M=ee.T,X={};ee.T=X;try{var ue=h(E,g),De=ee.S;De!==null&&De(X,ue),Ev(r,o,ue)}catch(ut){dp(r,o,ut)}finally{M!==null&&X.types!==null&&(M.types=X.types),ee.T=M}}else try{M=h(E,g),Ev(r,o,M)}catch(ut){dp(r,o,ut)}}function Ev(r,o,h){h!==null&&typeof h=="object"&&typeof h.then=="function"?h.then(function(g){Cv(r,o,g)},function(g){return dp(r,o,g)}):Cv(r,o,h)}function Cv(r,o,h){o.status="fulfilled",o.value=h,Av(o),r.state=h,o=r.pending,o!==null&&(h=o.next,h===o?r.pending=null:(h=h.next,o.next=h,Sv(r,h)))}function dp(r,o,h){var g=r.pending;if(r.pending=null,g!==null){g=g.next;do o.status="rejected",o.reason=h,Av(o),o=o.next;while(o!==g)}r.action=null}function Av(r){r=r.listeners;for(var o=0;o<r.length;o++)(0,r[o])()}function kv(r,o){return o}function Tv(r,o){if(Qn){var h=yr.formState;if(h!==null){e:{var g=Dn;if(Qn){if(Er){t:{for(var E=Er,M=Zi;E.nodeType!==8;){if(!M){E=null;break t}if(E=es(E.nextSibling),E===null){E=null;break t}}M=E.data,E=M==="F!"||M==="F"?E:null}if(E){Er=es(E.nextSibling),g=E.data==="F!";break e}}ia(g)}g=!1}g&&(o=h[0])}}return h=Ci(),h.memoizedState=h.baseState=o,g={pending:null,lanes:0,dispatch:null,lastRenderedReducer:kv,lastRenderedState:o},h.queue=g,h=$v.bind(null,Dn,g),g.dispatch=h,g=hp(!1),M=vp.bind(null,Dn,!1,g.queue),g=Ci(),E={state:o,dispatch:null,action:r,pending:null},g.queue=E,h=Xk.bind(null,Dn,E,M,h),E.dispatch=h,g.memoizedState=r,[o,h,!1]}function Mv(r){var o=Fr();return Iv(o,ur,r)}function Iv(r,o,h){if(o=up(r,o,kv)[0],r=gf(so)[0],typeof o=="object"&&o!==null&&typeof o.then=="function")try{var g=ru(o)}catch(X){throw X===tc?sf:X}else g=o;o=Fr();var E=o.queue,M=E.dispatch;return h!==o.memoizedState&&(Dn.flags|=2048,oc(9,{destroy:void 0},eT.bind(null,E,h),null)),[g,M,r]}function eT(r,o){r.action=o}function Rv(r){var o=Fr(),h=ur;if(h!==null)return Iv(o,h,r);Fr(),o=o.memoizedState,h=Fr();var g=h.queue.dispatch;return h.memoizedState=r,[o,g,!1]}function oc(r,o,h,g){return r={tag:r,create:h,deps:g,inst:o,next:null},o=Dn.updateQueue,o===null&&(o=df(),Dn.updateQueue=o),h=o.lastEffect,h===null?o.lastEffect=r.next=r:(g=h.next,h.next=r,r.next=g,o.lastEffect=r),r}function Ov(){return Fr().memoizedState}function mf(r,o,h,g){var E=Ci();Dn.flags|=r,E.memoizedState=oc(1|o,{destroy:void 0},h,g===void 0?null:g)}function yf(r,o,h,g){var E=Fr();g=g===void 0?null:g;var M=E.memoizedState.inst;ur!==null&&g!==null&&ip(g,ur.memoizedState.deps)?E.memoizedState=oc(o,M,h,g):(Dn.flags|=r,E.memoizedState=oc(1|o,M,h,g))}function Nv(r,o){mf(8390656,8,r,o)}function pp(r,o){yf(2048,8,r,o)}function tT(r){Dn.flags|=4;var o=Dn.updateQueue;if(o===null)o=df(),Dn.updateQueue=o,o.events=[r];else{var h=o.events;h===null?o.events=[r]:h.push(r)}}function Bv(r){var o=Fr().memoizedState;return tT({ref:o,nextImpl:r}),function(){if((ir&2)!==0)throw Error(n(440));return o.impl.apply(void 0,arguments)}}function jv(r,o){return yf(4,2,r,o)}function Dv(r,o){return yf(4,4,r,o)}function Pv(r,o){if(typeof o=="function"){r=r();var h=o(r);return function(){typeof h=="function"?h():o(null)}}if(o!=null)return r=r(),o.current=r,function(){o.current=null}}function Lv(r,o,h){h=h!=null?h.concat([r]):null,yf(4,4,Pv.bind(null,o,r),h)}function gp(){}function Uv(r,o){var h=Fr();o=o===void 0?null:o;var g=h.memoizedState;return o!==null&&ip(o,g[1])?g[0]:(h.memoizedState=[r,o],r)}function qv(r,o){var h=Fr();o=o===void 0?null:o;var g=h.memoizedState;if(o!==null&&ip(o,g[1]))return g[0];if(g=r(),fl){zt(!0);try{r()}finally{zt(!1)}}return h.memoizedState=[g,o],g}function mp(r,o,h){return h===void 0||(io&1073741824)!==0&&(Gn&261930)===0?r.memoizedState=o:(r.memoizedState=h,r=Fw(),Dn.lanes|=r,da|=r,h)}function Fv(r,o,h,g){return Jr(h,o)?h:rc.current!==null?(r=mp(r,h,g),Jr(r,o)||(Vr=!0),r):(io&42)===0||(io&1073741824)!==0&&(Gn&261930)===0?(Vr=!0,r.memoizedState=h):(r=Fw(),Dn.lanes|=r,da|=r,o)}function Hv(r,o,h,g,E){var M=ne.p;ne.p=M!==0&&8>M?M:8;var X=ee.T,ue={};ee.T=ue,vp(r,!1,o,h);try{var De=E(),ut=ee.S;if(ut!==null&&ut(ue,De),De!==null&&typeof De=="object"&&typeof De.then=="function"){var Tt=Qk(De,g);iu(r,o,Tt,Vi(r))}else iu(r,o,g,Vi(r))}catch(Lt){iu(r,o,{then:function(){},status:"rejected",reason:Lt},Vi())}finally{ne.p=M,X!==null&&ue.types!==null&&(X.types=ue.types),ee.T=X}}function nT(){}function yp(r,o,h,g){if(r.tag!==5)throw Error(n(476));var E=zv(r).queue;Hv(r,E,o,B,h===null?nT:function(){return Gv(r),h(g)})}function zv(r){var o=r.memoizedState;if(o!==null)return o;o={memoizedState:B,baseState:B,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:so,lastRenderedState:B},next:null};var h={};return o.next={memoizedState:h,baseState:h,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:so,lastRenderedState:h},next:null},r.memoizedState=o,r=r.alternate,r!==null&&(r.memoizedState=o),o}function Gv(r){var o=zv(r);o.next===null&&(o=r.alternate.memoizedState),iu(r,o.next.queue,{},Vi())}function bp(){return si(xu)}function Kv(){return Fr().memoizedState}function Vv(){return Fr().memoizedState}function rT(r){for(var o=r.return;o!==null;){switch(o.tag){case 24:case 3:var h=Vi();r=aa(h);var g=la(o,r,h);g!==null&&(Di(g,o,h),Xc(g,o,h)),o={cache:$d()},r.payload=o;return}o=o.return}}function iT(r,o,h){var g=Vi();h={lane:g,revertLane:0,gesture:null,action:h,hasEagerState:!1,eagerState:null,next:null},bf(r)?Yv(o,h):(h=En(r,o,h,g),h!==null&&(Di(h,r,g),Wv(h,o,g)))}function $v(r,o,h){var g=Vi();iu(r,o,h,g)}function iu(r,o,h,g){var E={lane:g,revertLane:0,gesture:null,action:h,hasEagerState:!1,eagerState:null,next:null};if(bf(r))Yv(o,E);else{var M=r.alternate;if(r.lanes===0&&(M===null||M.lanes===0)&&(M=o.lastRenderedReducer,M!==null))try{var X=o.lastRenderedState,ue=M(X,h);if(E.hasEagerState=!0,E.eagerState=ue,Jr(ue,X))return Gt(r,o,E,0),yr===null&&Vt(),!1}catch{}finally{}if(h=En(r,o,E,g),h!==null)return Di(h,r,g),Wv(h,o,g),!0}return!1}function vp(r,o,h,g){if(g={lane:2,revertLane:Jp(),gesture:null,action:g,hasEagerState:!1,eagerState:null,next:null},bf(r)){if(o)throw Error(n(479))}else o=En(r,h,g,2),o!==null&&Di(o,r,2)}function bf(r){var o=r.alternate;return r===Dn||o!==null&&o===Dn}function Yv(r,o){ic=ff=!0;var h=r.pending;h===null?o.next=o:(o.next=h.next,h.next=o),r.pending=o}function Wv(r,o,h){if((h&4194048)!==0){var g=o.lanes;g&=r.pendingLanes,h|=g,o.lanes=h,At(r,h)}}var su={readContext:si,use:pf,useCallback:Dr,useContext:Dr,useEffect:Dr,useImperativeHandle:Dr,useLayoutEffect:Dr,useInsertionEffect:Dr,useMemo:Dr,useReducer:Dr,useRef:Dr,useState:Dr,useDebugValue:Dr,useDeferredValue:Dr,useTransition:Dr,useSyncExternalStore:Dr,useId:Dr,useHostTransitionStatus:Dr,useFormState:Dr,useActionState:Dr,useOptimistic:Dr,useMemoCache:Dr,useCacheRefresh:Dr};su.useEffectEvent=Dr;var Qv={readContext:si,use:pf,useCallback:function(r,o){return Ci().memoizedState=[r,o===void 0?null:o],r},useContext:si,useEffect:Nv,useImperativeHandle:function(r,o,h){h=h!=null?h.concat([r]):null,mf(4194308,4,Pv.bind(null,o,r),h)},useLayoutEffect:function(r,o){return mf(4194308,4,r,o)},useInsertionEffect:function(r,o){mf(4,2,r,o)},useMemo:function(r,o){var h=Ci();o=o===void 0?null:o;var g=r();if(fl){zt(!0);try{r()}finally{zt(!1)}}return h.memoizedState=[g,o],g},useReducer:function(r,o,h){var g=Ci();if(h!==void 0){var E=h(o);if(fl){zt(!0);try{h(o)}finally{zt(!1)}}}else E=o;return g.memoizedState=g.baseState=E,r={pending:null,lanes:0,dispatch:null,lastRenderedReducer:r,lastRenderedState:E},g.queue=r,r=r.dispatch=iT.bind(null,Dn,r),[g.memoizedState,r]},useRef:function(r){var o=Ci();return r={current:r},o.memoizedState=r},useState:function(r){r=hp(r);var o=r.queue,h=$v.bind(null,Dn,o);return o.dispatch=h,[r.memoizedState,h]},useDebugValue:gp,useDeferredValue:function(r,o){var h=Ci();return mp(h,r,o)},useTransition:function(){var r=hp(!1);return r=Hv.bind(null,Dn,r.queue,!0,!1),Ci().memoizedState=r,[!1,r]},useSyncExternalStore:function(r,o,h){var g=Dn,E=Ci();if(Qn){if(h===void 0)throw Error(n(407));h=h()}else{if(h=o(),yr===null)throw Error(n(349));(Gn&127)!==0||yv(g,o,h)}E.memoizedState=h;var M={value:h,getSnapshot:o};return E.queue=M,Nv(vv.bind(null,g,M,r),[r]),g.flags|=2048,oc(9,{destroy:void 0},bv.bind(null,g,M,h,o),null),h},useId:function(){var r=Ci(),o=yr.identifierPrefix;if(Qn){var h=js,g=Bs;h=(g&~(1<<32-mt(g)-1)).toString(32)+h,o="_"+o+"R_"+h,h=hf++,0<h&&(o+="H"+h.toString(32)),o+="_"}else h=Jk++,o="_"+o+"r_"+h.toString(32)+"_";return r.memoizedState=o},useHostTransitionStatus:bp,useFormState:Tv,useActionState:Tv,useOptimistic:function(r){var o=Ci();o.memoizedState=o.baseState=r;var h={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return o.queue=h,o=vp.bind(null,Dn,!0,h),h.dispatch=o,[r,o]},useMemoCache:cp,useCacheRefresh:function(){return Ci().memoizedState=rT.bind(null,Dn)},useEffectEvent:function(r){var o=Ci(),h={impl:r};return o.memoizedState=h,function(){if((ir&2)!==0)throw Error(n(440));return h.impl.apply(void 0,arguments)}}},wp={readContext:si,use:pf,useCallback:Uv,useContext:si,useEffect:pp,useImperativeHandle:Lv,useInsertionEffect:jv,useLayoutEffect:Dv,useMemo:qv,useReducer:gf,useRef:Ov,useState:function(){return gf(so)},useDebugValue:gp,useDeferredValue:function(r,o){var h=Fr();return Fv(h,ur.memoizedState,r,o)},useTransition:function(){var r=gf(so)[0],o=Fr().memoizedState;return[typeof r=="boolean"?r:ru(r),o]},useSyncExternalStore:mv,useId:Kv,useHostTransitionStatus:bp,useFormState:Mv,useActionState:Mv,useOptimistic:function(r,o){var h=Fr();return _v(h,ur,r,o)},useMemoCache:cp,useCacheRefresh:Vv};wp.useEffectEvent=Bv;var Jv={readContext:si,use:pf,useCallback:Uv,useContext:si,useEffect:pp,useImperativeHandle:Lv,useInsertionEffect:jv,useLayoutEffect:Dv,useMemo:qv,useReducer:fp,useRef:Ov,useState:function(){return fp(so)},useDebugValue:gp,useDeferredValue:function(r,o){var h=Fr();return ur===null?mp(h,r,o):Fv(h,ur.memoizedState,r,o)},useTransition:function(){var r=fp(so)[0],o=Fr().memoizedState;return[typeof r=="boolean"?r:ru(r),o]},useSyncExternalStore:mv,useId:Kv,useHostTransitionStatus:bp,useFormState:Rv,useActionState:Rv,useOptimistic:function(r,o){var h=Fr();return ur!==null?_v(h,ur,r,o):(h.baseState=r,[r,h.queue.dispatch])},useMemoCache:cp,useCacheRefresh:Vv};Jv.useEffectEvent=Bv;function xp(r,o,h,g){o=r.memoizedState,h=h(g,o),h=h==null?o:p({},o,h),r.memoizedState=h,r.lanes===0&&(r.updateQueue.baseState=h)}var _p={enqueueSetState:function(r,o,h){r=r._reactInternals;var g=Vi(),E=aa(g);E.payload=o,h!=null&&(E.callback=h),o=la(r,E,g),o!==null&&(Di(o,r,g),Xc(o,r,g))},enqueueReplaceState:function(r,o,h){r=r._reactInternals;var g=Vi(),E=aa(g);E.tag=1,E.payload=o,h!=null&&(E.callback=h),o=la(r,E,g),o!==null&&(Di(o,r,g),Xc(o,r,g))},enqueueForceUpdate:function(r,o){r=r._reactInternals;var h=Vi(),g=aa(h);g.tag=2,o!=null&&(g.callback=o),o=la(r,g,h),o!==null&&(Di(o,r,h),Xc(o,r,h))}};function Zv(r,o,h,g,E,M,X){return r=r.stateNode,typeof r.shouldComponentUpdate=="function"?r.shouldComponentUpdate(g,M,X):o.prototype&&o.prototype.isPureReactComponent?!_(h,g)||!_(E,M):!0}function Xv(r,o,h,g){r=o.state,typeof o.componentWillReceiveProps=="function"&&o.componentWillReceiveProps(h,g),typeof o.UNSAFE_componentWillReceiveProps=="function"&&o.UNSAFE_componentWillReceiveProps(h,g),o.state!==r&&_p.enqueueReplaceState(o,o.state,null)}function hl(r,o){var h=o;if("ref"in o){h={};for(var g in o)g!=="ref"&&(h[g]=o[g])}if(r=r.defaultProps){h===o&&(h=p({},h));for(var E in r)h[E]===void 0&&(h[E]=r[E])}return h}function ew(r){Ne(r)}function tw(r){console.error(r)}function nw(r){Ne(r)}function vf(r,o){try{var h=r.onUncaughtError;h(o.value,{componentStack:o.stack})}catch(g){setTimeout(function(){throw g})}}function rw(r,o,h){try{var g=r.onCaughtError;g(h.value,{componentStack:h.stack,errorBoundary:o.tag===1?o.stateNode:null})}catch(E){setTimeout(function(){throw E})}}function Sp(r,o,h){return h=aa(h),h.tag=3,h.payload={element:null},h.callback=function(){vf(r,o)},h}function iw(r){return r=aa(r),r.tag=3,r}function sw(r,o,h,g){var E=h.type.getDerivedStateFromError;if(typeof E=="function"){var M=g.value;r.payload=function(){return E(M)},r.callback=function(){rw(o,h,g)}}var X=h.stateNode;X!==null&&typeof X.componentDidCatch=="function"&&(r.callback=function(){rw(o,h,g),typeof E!="function"&&(pa===null?pa=new Set([this]):pa.add(this));var ue=g.stack;this.componentDidCatch(g.value,{componentStack:ue!==null?ue:""})})}function sT(r,o,h,g,E){if(h.flags|=32768,g!==null&&typeof g=="object"&&typeof g.then=="function"){if(o=h.alternate,o!==null&&Zl(o,h,E,!0),h=Hi.current,h!==null){switch(h.tag){case 31:case 13:return Xi===null?Rf():h.alternate===null&&Pr===0&&(Pr=3),h.flags&=-257,h.flags|=65536,h.lanes=E,g===of?h.flags|=16384:(o=h.updateQueue,o===null?h.updateQueue=new Set([g]):o.add(g),Yp(r,g,E)),!1;case 22:return h.flags|=65536,g===of?h.flags|=16384:(o=h.updateQueue,o===null?(o={transitions:null,markerInstances:null,retryQueue:new Set([g])},h.updateQueue=o):(h=o.retryQueue,h===null?o.retryQueue=new Set([g]):h.add(g)),Yp(r,g,E)),!1}throw Error(n(435,h.tag))}return Yp(r,g,E),Rf(),!1}if(Qn)return o=Hi.current,o!==null?((o.flags&65536)===0&&(o.flags|=256),o.flags|=65536,o.lanes=E,g!==Hd&&(r=Error(n(422),{cause:g}),Yc(Ei(r,h)))):(g!==Hd&&(o=Error(n(423),{cause:g}),Yc(Ei(o,h))),r=r.current.alternate,r.flags|=65536,E&=-E,r.lanes|=E,g=Ei(g,h),E=Sp(r.stateNode,g,E),Xd(r,E),Pr!==4&&(Pr=2)),!1;var M=Error(n(520),{cause:g});if(M=Ei(M,h),du===null?du=[M]:du.push(M),Pr!==4&&(Pr=2),o===null)return!0;g=Ei(g,h),h=o;do{switch(h.tag){case 3:return h.flags|=65536,r=E&-E,h.lanes|=r,r=Sp(h.stateNode,g,r),Xd(h,r),!1;case 1:if(o=h.type,M=h.stateNode,(h.flags&128)===0&&(typeof o.getDerivedStateFromError=="function"||M!==null&&typeof M.componentDidCatch=="function"&&(pa===null||!pa.has(M))))return h.flags|=65536,E&=-E,h.lanes|=E,E=iw(E),sw(E,r,h,g),Xd(h,E),!1}h=h.return}while(h!==null);return!1}var Ep=Error(n(461)),Vr=!1;function oi(r,o,h,g){o.child=r===null?cv(o,null,h,g):ul(o,r.child,h,g)}function ow(r,o,h,g,E){h=h.render;var M=o.ref;if("ref"in g){var X={};for(var ue in g)ue!=="ref"&&(X[ue]=g[ue])}else X=g;return ol(o),g=sp(r,o,h,X,M,E),ue=op(),r!==null&&!Vr?(ap(r,o,E),oo(r,o,E)):(Qn&&ue&&qd(o),o.flags|=1,oi(r,o,g,E),o.child)}function aw(r,o,h,g,E){if(r===null){var M=h.type;return typeof M=="function"&&!Zr(M)&&M.defaultProps===void 0&&h.compare===null?(o.tag=15,o.type=M,lw(r,o,M,g,E)):(r=$l(h.type,null,g,o,o.mode,E),r.ref=o.ref,r.return=o,o.child=r)}if(M=r.child,!Op(r,E)){var X=M.memoizedProps;if(h=h.compare,h=h!==null?h:_,h(X,g)&&r.ref===o.ref)return oo(r,o,E)}return o.flags|=1,r=jr(M,g),r.ref=o.ref,r.return=o,o.child=r}function lw(r,o,h,g,E){if(r!==null){var M=r.memoizedProps;if(_(M,g)&&r.ref===o.ref)if(Vr=!1,o.pendingProps=g=M,Op(r,E))(r.flags&131072)!==0&&(Vr=!0);else return o.lanes=r.lanes,oo(r,o,E)}return Cp(r,o,h,g,E)}function cw(r,o,h,g){var E=g.children,M=r!==null?r.memoizedState:null;if(r===null&&o.stateNode===null&&(o.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),g.mode==="hidden"){if((o.flags&128)!==0){if(M=M!==null?M.baseLanes|h:h,r!==null){for(g=o.child=r.child,E=0;g!==null;)E=E|g.lanes|g.childLanes,g=g.sibling;g=E&~M}else g=0,o.child=null;return uw(r,o,M,h,g)}if((h&536870912)!==0)o.memoizedState={baseLanes:0,cachePool:null},r!==null&&rf(o,M!==null?M.cachePool:null),M!==null?hv(o,M):tp(),dv(o);else return g=o.lanes=536870912,uw(r,o,M!==null?M.baseLanes|h:h,h,g)}else M!==null?(rf(o,M.cachePool),hv(o,M),ua(),o.memoizedState=null):(r!==null&&rf(o,null),tp(),ua());return oi(r,o,E,h),o.child}function ou(r,o){return r!==null&&r.tag===22||o.stateNode!==null||(o.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),o.sibling}function uw(r,o,h,g,E){var M=Wd();return M=M===null?null:{parent:Gr._currentValue,pool:M},o.memoizedState={baseLanes:h,cachePool:M},r!==null&&rf(o,null),tp(),dv(o),r!==null&&Zl(r,o,g,!0),o.childLanes=E,null}function wf(r,o){return o=_f({mode:o.mode,children:o.children},r.mode),o.ref=r.ref,r.child=o,o.return=r,o}function fw(r,o,h){return ul(o,r.child,null,h),r=wf(o,o.pendingProps),r.flags|=2,zi(o),o.memoizedState=null,r}function oT(r,o,h){var g=o.pendingProps,E=(o.flags&128)!==0;if(o.flags&=-129,r===null){if(Qn){if(g.mode==="hidden")return r=wf(o,g),o.lanes=536870912,ou(null,r);if(rp(o),(r=Er)?(r=S1(r,Zi),r=r!==null&&r.data==="&"?r:null,r!==null&&(o.memoizedState={dehydrated:r,treeContext:na!==null?{id:Bs,overflow:js}:null,retryLane:536870912,hydrationErrors:null},h=Vc(r),h.return=o,o.child=h,ii=o,Er=null)):r=null,r===null)throw ia(o);return o.lanes=536870912,null}return wf(o,g)}var M=r.memoizedState;if(M!==null){var X=M.dehydrated;if(rp(o),E)if(o.flags&256)o.flags&=-257,o=fw(r,o,h);else if(o.memoizedState!==null)o.child=r.child,o.flags|=128,o=null;else throw Error(n(558));else if(Vr||Zl(r,o,h,!1),E=(h&r.childLanes)!==0,Vr||E){if(g=yr,g!==null&&(X=K(g,h),X!==0&&X!==M.retryLane))throw M.retryLane=X,bn(r,X),Di(g,r,X),Ep;Rf(),o=fw(r,o,h)}else r=M.treeContext,Er=es(X.nextSibling),ii=o,Qn=!0,ra=null,Zi=!1,r!==null&&Jb(o,r),o=wf(o,g),o.flags|=4096;return o}return r=jr(r.child,{mode:g.mode,children:g.children}),r.ref=o.ref,o.child=r,r.return=o,r}function xf(r,o){var h=o.ref;if(h===null)r!==null&&r.ref!==null&&(o.flags|=4194816);else{if(typeof h!="function"&&typeof h!="object")throw Error(n(284));(r===null||r.ref!==h)&&(o.flags|=4194816)}}function Cp(r,o,h,g,E){return ol(o),h=sp(r,o,h,g,void 0,E),g=op(),r!==null&&!Vr?(ap(r,o,E),oo(r,o,E)):(Qn&&g&&qd(o),o.flags|=1,oi(r,o,h,E),o.child)}function hw(r,o,h,g,E,M){return ol(o),o.updateQueue=null,h=gv(o,g,h,E),pv(r),g=op(),r!==null&&!Vr?(ap(r,o,M),oo(r,o,M)):(Qn&&g&&qd(o),o.flags|=1,oi(r,o,h,M),o.child)}function dw(r,o,h,g,E){if(ol(o),o.stateNode===null){var M=Wn,X=h.contextType;typeof X=="object"&&X!==null&&(M=si(X)),M=new h(g,M),o.memoizedState=M.state!==null&&M.state!==void 0?M.state:null,M.updater=_p,o.stateNode=M,M._reactInternals=o,M=o.stateNode,M.props=g,M.state=o.memoizedState,M.refs={},Jd(o),X=h.contextType,M.context=typeof X=="object"&&X!==null?si(X):Wn,M.state=o.memoizedState,X=h.getDerivedStateFromProps,typeof X=="function"&&(xp(o,h,X,g),M.state=o.memoizedState),typeof h.getDerivedStateFromProps=="function"||typeof M.getSnapshotBeforeUpdate=="function"||typeof M.UNSAFE_componentWillMount!="function"&&typeof M.componentWillMount!="function"||(X=M.state,typeof M.componentWillMount=="function"&&M.componentWillMount(),typeof M.UNSAFE_componentWillMount=="function"&&M.UNSAFE_componentWillMount(),X!==M.state&&_p.enqueueReplaceState(M,M.state,null),tu(o,g,M,E),eu(),M.state=o.memoizedState),typeof M.componentDidMount=="function"&&(o.flags|=4194308),g=!0}else if(r===null){M=o.stateNode;var ue=o.memoizedProps,De=hl(h,ue);M.props=De;var ut=M.context,Tt=h.contextType;X=Wn,typeof Tt=="object"&&Tt!==null&&(X=si(Tt));var Lt=h.getDerivedStateFromProps;Tt=typeof Lt=="function"||typeof M.getSnapshotBeforeUpdate=="function",ue=o.pendingProps!==ue,Tt||typeof M.UNSAFE_componentWillReceiveProps!="function"&&typeof M.componentWillReceiveProps!="function"||(ue||ut!==X)&&Xv(o,M,g,X),oa=!1;var dt=o.memoizedState;M.state=dt,tu(o,g,M,E),eu(),ut=o.memoizedState,ue||dt!==ut||oa?(typeof Lt=="function"&&(xp(o,h,Lt,g),ut=o.memoizedState),(De=oa||Zv(o,h,De,g,dt,ut,X))?(Tt||typeof M.UNSAFE_componentWillMount!="function"&&typeof M.componentWillMount!="function"||(typeof M.componentWillMount=="function"&&M.componentWillMount(),typeof M.UNSAFE_componentWillMount=="function"&&M.UNSAFE_componentWillMount()),typeof M.componentDidMount=="function"&&(o.flags|=4194308)):(typeof M.componentDidMount=="function"&&(o.flags|=4194308),o.memoizedProps=g,o.memoizedState=ut),M.props=g,M.state=ut,M.context=X,g=De):(typeof M.componentDidMount=="function"&&(o.flags|=4194308),g=!1)}else{M=o.stateNode,Zd(r,o),X=o.memoizedProps,Tt=hl(h,X),M.props=Tt,Lt=o.pendingProps,dt=M.context,ut=h.contextType,De=Wn,typeof ut=="object"&&ut!==null&&(De=si(ut)),ue=h.getDerivedStateFromProps,(ut=typeof ue=="function"||typeof M.getSnapshotBeforeUpdate=="function")||typeof M.UNSAFE_componentWillReceiveProps!="function"&&typeof M.componentWillReceiveProps!="function"||(X!==Lt||dt!==De)&&Xv(o,M,g,De),oa=!1,dt=o.memoizedState,M.state=dt,tu(o,g,M,E),eu();var wt=o.memoizedState;X!==Lt||dt!==wt||oa||r!==null&&r.dependencies!==null&&tf(r.dependencies)?(typeof ue=="function"&&(xp(o,h,ue,g),wt=o.memoizedState),(Tt=oa||Zv(o,h,Tt,g,dt,wt,De)||r!==null&&r.dependencies!==null&&tf(r.dependencies))?(ut||typeof M.UNSAFE_componentWillUpdate!="function"&&typeof M.componentWillUpdate!="function"||(typeof M.componentWillUpdate=="function"&&M.componentWillUpdate(g,wt,De),typeof M.UNSAFE_componentWillUpdate=="function"&&M.UNSAFE_componentWillUpdate(g,wt,De)),typeof M.componentDidUpdate=="function"&&(o.flags|=4),typeof M.getSnapshotBeforeUpdate=="function"&&(o.flags|=1024)):(typeof M.componentDidUpdate!="function"||X===r.memoizedProps&&dt===r.memoizedState||(o.flags|=4),typeof M.getSnapshotBeforeUpdate!="function"||X===r.memoizedProps&&dt===r.memoizedState||(o.flags|=1024),o.memoizedProps=g,o.memoizedState=wt),M.props=g,M.state=wt,M.context=De,g=Tt):(typeof M.componentDidUpdate!="function"||X===r.memoizedProps&&dt===r.memoizedState||(o.flags|=4),typeof M.getSnapshotBeforeUpdate!="function"||X===r.memoizedProps&&dt===r.memoizedState||(o.flags|=1024),g=!1)}return M=g,xf(r,o),g=(o.flags&128)!==0,M||g?(M=o.stateNode,h=g&&typeof h.getDerivedStateFromError!="function"?null:M.render(),o.flags|=1,r!==null&&g?(o.child=ul(o,r.child,null,E),o.child=ul(o,null,h,E)):oi(r,o,h,E),o.memoizedState=M.state,r=o.child):r=oo(r,o,E),r}function pw(r,o,h,g){return il(),o.flags|=256,oi(r,o,h,g),o.child}var Ap={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function kp(r){return{baseLanes:r,cachePool:rv()}}function Tp(r,o,h){return r=r!==null?r.childLanes&~h:0,o&&(r|=Ki),r}function gw(r,o,h){var g=o.pendingProps,E=!1,M=(o.flags&128)!==0,X;if((X=M)||(X=r!==null&&r.memoizedState===null?!1:(qr.current&2)!==0),X&&(E=!0,o.flags&=-129),X=(o.flags&32)!==0,o.flags&=-33,r===null){if(Qn){if(E?ca(o):ua(),(r=Er)?(r=S1(r,Zi),r=r!==null&&r.data!=="&"?r:null,r!==null&&(o.memoizedState={dehydrated:r,treeContext:na!==null?{id:Bs,overflow:js}:null,retryLane:536870912,hydrationErrors:null},h=Vc(r),h.return=o,o.child=h,ii=o,Er=null)):r=null,r===null)throw ia(o);return ug(r)?o.lanes=32:o.lanes=536870912,null}var ue=g.children;return g=g.fallback,E?(ua(),E=o.mode,ue=_f({mode:"hidden",children:ue},E),g=Ns(g,E,h,null),ue.return=o,g.return=o,ue.sibling=g,o.child=ue,g=o.child,g.memoizedState=kp(h),g.childLanes=Tp(r,X,h),o.memoizedState=Ap,ou(null,g)):(ca(o),Mp(o,ue))}var De=r.memoizedState;if(De!==null&&(ue=De.dehydrated,ue!==null)){if(M)o.flags&256?(ca(o),o.flags&=-257,o=Ip(r,o,h)):o.memoizedState!==null?(ua(),o.child=r.child,o.flags|=128,o=null):(ua(),ue=g.fallback,E=o.mode,g=_f({mode:"visible",children:g.children},E),ue=Ns(ue,E,h,null),ue.flags|=2,g.return=o,ue.return=o,g.sibling=ue,o.child=g,ul(o,r.child,null,h),g=o.child,g.memoizedState=kp(h),g.childLanes=Tp(r,X,h),o.memoizedState=Ap,o=ou(null,g));else if(ca(o),ug(ue)){if(X=ue.nextSibling&&ue.nextSibling.dataset,X)var ut=X.dgst;X=ut,g=Error(n(419)),g.stack="",g.digest=X,Yc({value:g,source:null,stack:null}),o=Ip(r,o,h)}else if(Vr||Zl(r,o,h,!1),X=(h&r.childLanes)!==0,Vr||X){if(X=yr,X!==null&&(g=K(X,h),g!==0&&g!==De.retryLane))throw De.retryLane=g,bn(r,g),Di(X,r,g),Ep;cg(ue)||Rf(),o=Ip(r,o,h)}else cg(ue)?(o.flags|=192,o.child=r.child,o=null):(r=De.treeContext,Er=es(ue.nextSibling),ii=o,Qn=!0,ra=null,Zi=!1,r!==null&&Jb(o,r),o=Mp(o,g.children),o.flags|=4096);return o}return E?(ua(),ue=g.fallback,E=o.mode,De=r.child,ut=De.sibling,g=jr(De,{mode:"hidden",children:g.children}),g.subtreeFlags=De.subtreeFlags&65011712,ut!==null?ue=jr(ut,ue):(ue=Ns(ue,E,h,null),ue.flags|=2),ue.return=o,g.return=o,g.sibling=ue,o.child=g,ou(null,g),g=o.child,ue=r.child.memoizedState,ue===null?ue=kp(h):(E=ue.cachePool,E!==null?(De=Gr._currentValue,E=E.parent!==De?{parent:De,pool:De}:E):E=rv(),ue={baseLanes:ue.baseLanes|h,cachePool:E}),g.memoizedState=ue,g.childLanes=Tp(r,X,h),o.memoizedState=Ap,ou(r.child,g)):(ca(o),h=r.child,r=h.sibling,h=jr(h,{mode:"visible",children:g.children}),h.return=o,h.sibling=null,r!==null&&(X=o.deletions,X===null?(o.deletions=[r],o.flags|=16):X.push(r)),o.child=h,o.memoizedState=null,h)}function Mp(r,o){return o=_f({mode:"visible",children:o},r.mode),o.return=r,r.child=o}function _f(r,o){return r=Rr(22,r,null,o),r.lanes=0,r}function Ip(r,o,h){return ul(o,r.child,null,h),r=Mp(o,o.pendingProps.children),r.flags|=2,o.memoizedState=null,r}function mw(r,o,h){r.lanes|=o;var g=r.alternate;g!==null&&(g.lanes|=o),Kd(r.return,o,h)}function Rp(r,o,h,g,E,M){var X=r.memoizedState;X===null?r.memoizedState={isBackwards:o,rendering:null,renderingStartTime:0,last:g,tail:h,tailMode:E,treeForkCount:M}:(X.isBackwards=o,X.rendering=null,X.renderingStartTime=0,X.last=g,X.tail=h,X.tailMode=E,X.treeForkCount=M)}function yw(r,o,h){var g=o.pendingProps,E=g.revealOrder,M=g.tail;g=g.children;var X=qr.current,ue=(X&2)!==0;if(ue?(X=X&1|2,o.flags|=128):X&=1,ae(qr,X),oi(r,o,g,h),g=Qn?$c:0,!ue&&r!==null&&(r.flags&128)!==0)e:for(r=o.child;r!==null;){if(r.tag===13)r.memoizedState!==null&&mw(r,h,o);else if(r.tag===19)mw(r,h,o);else if(r.child!==null){r.child.return=r,r=r.child;continue}if(r===o)break e;for(;r.sibling===null;){if(r.return===null||r.return===o)break e;r=r.return}r.sibling.return=r.return,r=r.sibling}switch(E){case"forwards":for(h=o.child,E=null;h!==null;)r=h.alternate,r!==null&&uf(r)===null&&(E=h),h=h.sibling;h=E,h===null?(E=o.child,o.child=null):(E=h.sibling,h.sibling=null),Rp(o,!1,E,h,M,g);break;case"backwards":case"unstable_legacy-backwards":for(h=null,E=o.child,o.child=null;E!==null;){if(r=E.alternate,r!==null&&uf(r)===null){o.child=E;break}r=E.sibling,E.sibling=h,h=E,E=r}Rp(o,!0,h,null,M,g);break;case"together":Rp(o,!1,null,null,void 0,g);break;default:o.memoizedState=null}return o.child}function oo(r,o,h){if(r!==null&&(o.dependencies=r.dependencies),da|=o.lanes,(h&o.childLanes)===0)if(r!==null){if(Zl(r,o,h,!1),(h&o.childLanes)===0)return null}else return null;if(r!==null&&o.child!==r.child)throw Error(n(153));if(o.child!==null){for(r=o.child,h=jr(r,r.pendingProps),o.child=h,h.return=o;r.sibling!==null;)r=r.sibling,h=h.sibling=jr(r,r.pendingProps),h.return=o;h.sibling=null}return o.child}function Op(r,o){return(r.lanes&o)!==0?!0:(r=r.dependencies,!!(r!==null&&tf(r)))}function aT(r,o,h){switch(o.tag){case 3:ve(o,o.stateNode.containerInfo),sa(o,Gr,r.memoizedState.cache),il();break;case 27:case 5:Me(o);break;case 4:ve(o,o.stateNode.containerInfo);break;case 10:sa(o,o.type,o.memoizedProps.value);break;case 31:if(o.memoizedState!==null)return o.flags|=128,rp(o),null;break;case 13:var g=o.memoizedState;if(g!==null)return g.dehydrated!==null?(ca(o),o.flags|=128,null):(h&o.child.childLanes)!==0?gw(r,o,h):(ca(o),r=oo(r,o,h),r!==null?r.sibling:null);ca(o);break;case 19:var E=(r.flags&128)!==0;if(g=(h&o.childLanes)!==0,g||(Zl(r,o,h,!1),g=(h&o.childLanes)!==0),E){if(g)return yw(r,o,h);o.flags|=128}if(E=o.memoizedState,E!==null&&(E.rendering=null,E.tail=null,E.lastEffect=null),ae(qr,qr.current),g)break;return null;case 22:return o.lanes=0,cw(r,o,h,o.pendingProps);case 24:sa(o,Gr,r.memoizedState.cache)}return oo(r,o,h)}function bw(r,o,h){if(r!==null)if(r.memoizedProps!==o.pendingProps)Vr=!0;else{if(!Op(r,h)&&(o.flags&128)===0)return Vr=!1,aT(r,o,h);Vr=(r.flags&131072)!==0}else Vr=!1,Qn&&(o.flags&1048576)!==0&&Qb(o,$c,o.index);switch(o.lanes=0,o.tag){case 16:e:{var g=o.pendingProps;if(r=ll(o.elementType),o.type=r,typeof r=="function")Zr(r)?(g=hl(r,g),o.tag=1,o=dw(null,o,r,g,h)):(o.tag=0,o=Cp(null,o,r,g,h));else{if(r!=null){var E=r.$$typeof;if(E===k){o.tag=11,o=ow(null,o,r,g,h);break e}else if(E===I){o.tag=14,o=aw(null,o,r,g,h);break e}}throw o=Q(r)||r,Error(n(306,o,""))}}return o;case 0:return Cp(r,o,o.type,o.pendingProps,h);case 1:return g=o.type,E=hl(g,o.pendingProps),dw(r,o,g,E,h);case 3:e:{if(ve(o,o.stateNode.containerInfo),r===null)throw Error(n(387));g=o.pendingProps;var M=o.memoizedState;E=M.element,Zd(r,o),tu(o,g,null,h);var X=o.memoizedState;if(g=X.cache,sa(o,Gr,g),g!==M.cache&&Vd(o,[Gr],h,!0),eu(),g=X.element,M.isDehydrated)if(M={element:g,isDehydrated:!1,cache:X.cache},o.updateQueue.baseState=M,o.memoizedState=M,o.flags&256){o=pw(r,o,g,h);break e}else if(g!==E){E=Ei(Error(n(424)),o),Yc(E),o=pw(r,o,g,h);break e}else{switch(r=o.stateNode.containerInfo,r.nodeType){case 9:r=r.body;break;default:r=r.nodeName==="HTML"?r.ownerDocument.body:r}for(Er=es(r.firstChild),ii=o,Qn=!0,ra=null,Zi=!0,h=cv(o,null,g,h),o.child=h;h;)h.flags=h.flags&-3|4096,h=h.sibling}else{if(il(),g===E){o=oo(r,o,h);break e}oi(r,o,g,h)}o=o.child}return o;case 26:return xf(r,o),r===null?(h=M1(o.type,null,o.pendingProps,null))?o.memoizedState=h:Qn||(h=o.type,r=o.pendingProps,g=Lf(Ge.current).createElement(h),g[ze]=o,g[vt]=r,ai(g,h,r),on(g),o.stateNode=g):o.memoizedState=M1(o.type,r.memoizedProps,o.pendingProps,r.memoizedState),null;case 27:return Me(o),r===null&&Qn&&(g=o.stateNode=A1(o.type,o.pendingProps,Ge.current),ii=o,Zi=!0,E=Er,ba(o.type)?(fg=E,Er=es(g.firstChild)):Er=E),oi(r,o,o.pendingProps.children,h),xf(r,o),r===null&&(o.flags|=4194304),o.child;case 5:return r===null&&Qn&&((E=g=Er)&&(g=PT(g,o.type,o.pendingProps,Zi),g!==null?(o.stateNode=g,ii=o,Er=es(g.firstChild),Zi=!1,E=!0):E=!1),E||ia(o)),Me(o),E=o.type,M=o.pendingProps,X=r!==null?r.memoizedProps:null,g=M.children,og(E,M)?g=null:X!==null&&og(E,X)&&(o.flags|=32),o.memoizedState!==null&&(E=sp(r,o,Zk,null,null,h),xu._currentValue=E),xf(r,o),oi(r,o,g,h),o.child;case 6:return r===null&&Qn&&((r=h=Er)&&(h=LT(h,o.pendingProps,Zi),h!==null?(o.stateNode=h,ii=o,Er=null,r=!0):r=!1),r||ia(o)),null;case 13:return gw(r,o,h);case 4:return ve(o,o.stateNode.containerInfo),g=o.pendingProps,r===null?o.child=ul(o,null,g,h):oi(r,o,g,h),o.child;case 11:return ow(r,o,o.type,o.pendingProps,h);case 7:return oi(r,o,o.pendingProps,h),o.child;case 8:return oi(r,o,o.pendingProps.children,h),o.child;case 12:return oi(r,o,o.pendingProps.children,h),o.child;case 10:return g=o.pendingProps,sa(o,o.type,g.value),oi(r,o,g.children,h),o.child;case 9:return E=o.type._context,g=o.pendingProps.children,ol(o),E=si(E),g=g(E),o.flags|=1,oi(r,o,g,h),o.child;case 14:return aw(r,o,o.type,o.pendingProps,h);case 15:return lw(r,o,o.type,o.pendingProps,h);case 19:return yw(r,o,h);case 31:return oT(r,o,h);case 22:return cw(r,o,h,o.pendingProps);case 24:return ol(o),g=si(Gr),r===null?(E=Wd(),E===null&&(E=yr,M=$d(),E.pooledCache=M,M.refCount++,M!==null&&(E.pooledCacheLanes|=h),E=M),o.memoizedState={parent:g,cache:E},Jd(o),sa(o,Gr,E)):((r.lanes&h)!==0&&(Zd(r,o),tu(o,null,null,h),eu()),E=r.memoizedState,M=o.memoizedState,E.parent!==g?(E={parent:g,cache:g},o.memoizedState=E,o.lanes===0&&(o.memoizedState=o.updateQueue.baseState=E),sa(o,Gr,g)):(g=M.cache,sa(o,Gr,g),g!==E.cache&&Vd(o,[Gr],h,!0))),oi(r,o,o.pendingProps.children,h),o.child;case 29:throw o.pendingProps}throw Error(n(156,o.tag))}function ao(r){r.flags|=4}function Np(r,o,h,g,E){if((o=(r.mode&32)!==0)&&(o=!1),o){if(r.flags|=16777216,(E&335544128)===E)if(r.stateNode.complete)r.flags|=8192;else if(Kw())r.flags|=8192;else throw cl=of,Qd}else r.flags&=-16777217}function vw(r,o){if(o.type!=="stylesheet"||(o.state.loading&4)!==0)r.flags&=-16777217;else if(r.flags|=16777216,!B1(o))if(Kw())r.flags|=8192;else throw cl=of,Qd}function Sf(r,o){o!==null&&(r.flags|=4),r.flags&16384&&(o=r.tag!==22?Ot():536870912,r.lanes|=o,uc|=o)}function au(r,o){if(!Qn)switch(r.tailMode){case"hidden":o=r.tail;for(var h=null;o!==null;)o.alternate!==null&&(h=o),o=o.sibling;h===null?r.tail=null:h.sibling=null;break;case"collapsed":h=r.tail;for(var g=null;h!==null;)h.alternate!==null&&(g=h),h=h.sibling;g===null?o||r.tail===null?r.tail=null:r.tail.sibling=null:g.sibling=null}}function Cr(r){var o=r.alternate!==null&&r.alternate.child===r.child,h=0,g=0;if(o)for(var E=r.child;E!==null;)h|=E.lanes|E.childLanes,g|=E.subtreeFlags&65011712,g|=E.flags&65011712,E.return=r,E=E.sibling;else for(E=r.child;E!==null;)h|=E.lanes|E.childLanes,g|=E.subtreeFlags,g|=E.flags,E.return=r,E=E.sibling;return r.subtreeFlags|=g,r.childLanes=h,o}function lT(r,o,h){var g=o.pendingProps;switch(Fd(o),o.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Cr(o),null;case 1:return Cr(o),null;case 3:return h=o.stateNode,g=null,r!==null&&(g=r.memoizedState.cache),o.memoizedState.cache!==g&&(o.flags|=2048),ro(Gr),ke(),h.pendingContext&&(h.context=h.pendingContext,h.pendingContext=null),(r===null||r.child===null)&&(Jl(o)?ao(o):r===null||r.memoizedState.isDehydrated&&(o.flags&256)===0||(o.flags|=1024,zd())),Cr(o),null;case 26:var E=o.type,M=o.memoizedState;return r===null?(ao(o),M!==null?(Cr(o),vw(o,M)):(Cr(o),Np(o,E,null,g,h))):M?M!==r.memoizedState?(ao(o),Cr(o),vw(o,M)):(Cr(o),o.flags&=-16777217):(r=r.memoizedProps,r!==g&&ao(o),Cr(o),Np(o,E,r,g,h)),null;case 27:if(Ie(o),h=Ge.current,E=o.type,r!==null&&o.stateNode!=null)r.memoizedProps!==g&&ao(o);else{if(!g){if(o.stateNode===null)throw Error(n(166));return Cr(o),null}r=Ae.current,Jl(o)?Zb(o):(r=A1(E,g,h),o.stateNode=r,ao(o))}return Cr(o),null;case 5:if(Ie(o),E=o.type,r!==null&&o.stateNode!=null)r.memoizedProps!==g&&ao(o);else{if(!g){if(o.stateNode===null)throw Error(n(166));return Cr(o),null}if(M=Ae.current,Jl(o))Zb(o);else{var X=Lf(Ge.current);switch(M){case 1:M=X.createElementNS("http://www.w3.org/2000/svg",E);break;case 2:M=X.createElementNS("http://www.w3.org/1998/Math/MathML",E);break;default:switch(E){case"svg":M=X.createElementNS("http://www.w3.org/2000/svg",E);break;case"math":M=X.createElementNS("http://www.w3.org/1998/Math/MathML",E);break;case"script":M=X.createElement("div"),M.innerHTML="<script><\/script>",M=M.removeChild(M.firstChild);break;case"select":M=typeof g.is=="string"?X.createElement("select",{is:g.is}):X.createElement("select"),g.multiple?M.multiple=!0:g.size&&(M.size=g.size);break;default:M=typeof g.is=="string"?X.createElement(E,{is:g.is}):X.createElement(E)}}M[ze]=o,M[vt]=g;e:for(X=o.child;X!==null;){if(X.tag===5||X.tag===6)M.appendChild(X.stateNode);else if(X.tag!==4&&X.tag!==27&&X.child!==null){X.child.return=X,X=X.child;continue}if(X===o)break e;for(;X.sibling===null;){if(X.return===null||X.return===o)break e;X=X.return}X.sibling.return=X.return,X=X.sibling}o.stateNode=M;e:switch(ai(M,E,g),E){case"button":case"input":case"select":case"textarea":g=!!g.autoFocus;break e;case"img":g=!0;break e;default:g=!1}g&&ao(o)}}return Cr(o),Np(o,o.type,r===null?null:r.memoizedProps,o.pendingProps,h),null;case 6:if(r&&o.stateNode!=null)r.memoizedProps!==g&&ao(o);else{if(typeof g!="string"&&o.stateNode===null)throw Error(n(166));if(r=Ge.current,Jl(o)){if(r=o.stateNode,h=o.memoizedProps,g=null,E=ii,E!==null)switch(E.tag){case 27:case 5:g=E.memoizedProps}r[ze]=o,r=!!(r.nodeValue===h||g!==null&&g.suppressHydrationWarning===!0||g1(r.nodeValue,h)),r||ia(o,!0)}else r=Lf(r).createTextNode(g),r[ze]=o,o.stateNode=r}return Cr(o),null;case 31:if(h=o.memoizedState,r===null||r.memoizedState!==null){if(g=Jl(o),h!==null){if(r===null){if(!g)throw Error(n(318));if(r=o.memoizedState,r=r!==null?r.dehydrated:null,!r)throw Error(n(557));r[ze]=o}else il(),(o.flags&128)===0&&(o.memoizedState=null),o.flags|=4;Cr(o),r=!1}else h=zd(),r!==null&&r.memoizedState!==null&&(r.memoizedState.hydrationErrors=h),r=!0;if(!r)return o.flags&256?(zi(o),o):(zi(o),null);if((o.flags&128)!==0)throw Error(n(558))}return Cr(o),null;case 13:if(g=o.memoizedState,r===null||r.memoizedState!==null&&r.memoizedState.dehydrated!==null){if(E=Jl(o),g!==null&&g.dehydrated!==null){if(r===null){if(!E)throw Error(n(318));if(E=o.memoizedState,E=E!==null?E.dehydrated:null,!E)throw Error(n(317));E[ze]=o}else il(),(o.flags&128)===0&&(o.memoizedState=null),o.flags|=4;Cr(o),E=!1}else E=zd(),r!==null&&r.memoizedState!==null&&(r.memoizedState.hydrationErrors=E),E=!0;if(!E)return o.flags&256?(zi(o),o):(zi(o),null)}return zi(o),(o.flags&128)!==0?(o.lanes=h,o):(h=g!==null,r=r!==null&&r.memoizedState!==null,h&&(g=o.child,E=null,g.alternate!==null&&g.alternate.memoizedState!==null&&g.alternate.memoizedState.cachePool!==null&&(E=g.alternate.memoizedState.cachePool.pool),M=null,g.memoizedState!==null&&g.memoizedState.cachePool!==null&&(M=g.memoizedState.cachePool.pool),M!==E&&(g.flags|=2048)),h!==r&&h&&(o.child.flags|=8192),Sf(o,o.updateQueue),Cr(o),null);case 4:return ke(),r===null&&tg(o.stateNode.containerInfo),Cr(o),null;case 10:return ro(o.type),Cr(o),null;case 19:if(Z(qr),g=o.memoizedState,g===null)return Cr(o),null;if(E=(o.flags&128)!==0,M=g.rendering,M===null)if(E)au(g,!1);else{if(Pr!==0||r!==null&&(r.flags&128)!==0)for(r=o.child;r!==null;){if(M=uf(r),M!==null){for(o.flags|=128,au(g,!1),r=M.updateQueue,o.updateQueue=r,Sf(o,r),o.subtreeFlags=0,r=h,h=o.child;h!==null;)nl(h,r),h=h.sibling;return ae(qr,qr.current&1|2),Qn&&to(o,g.treeForkCount),o.child}r=r.sibling}g.tail!==null&&nt()>Tf&&(o.flags|=128,E=!0,au(g,!1),o.lanes=4194304)}else{if(!E)if(r=uf(M),r!==null){if(o.flags|=128,E=!0,r=r.updateQueue,o.updateQueue=r,Sf(o,r),au(g,!0),g.tail===null&&g.tailMode==="hidden"&&!M.alternate&&!Qn)return Cr(o),null}else 2*nt()-g.renderingStartTime>Tf&&h!==536870912&&(o.flags|=128,E=!0,au(g,!1),o.lanes=4194304);g.isBackwards?(M.sibling=o.child,o.child=M):(r=g.last,r!==null?r.sibling=M:o.child=M,g.last=M)}return g.tail!==null?(r=g.tail,g.rendering=r,g.tail=r.sibling,g.renderingStartTime=nt(),r.sibling=null,h=qr.current,ae(qr,E?h&1|2:h&1),Qn&&to(o,g.treeForkCount),r):(Cr(o),null);case 22:case 23:return zi(o),np(),g=o.memoizedState!==null,r!==null?r.memoizedState!==null!==g&&(o.flags|=8192):g&&(o.flags|=8192),g?(h&536870912)!==0&&(o.flags&128)===0&&(Cr(o),o.subtreeFlags&6&&(o.flags|=8192)):Cr(o),h=o.updateQueue,h!==null&&Sf(o,h.retryQueue),h=null,r!==null&&r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(h=r.memoizedState.cachePool.pool),g=null,o.memoizedState!==null&&o.memoizedState.cachePool!==null&&(g=o.memoizedState.cachePool.pool),g!==h&&(o.flags|=2048),r!==null&&Z(al),null;case 24:return h=null,r!==null&&(h=r.memoizedState.cache),o.memoizedState.cache!==h&&(o.flags|=2048),ro(Gr),Cr(o),null;case 25:return null;case 30:return null}throw Error(n(156,o.tag))}function cT(r,o){switch(Fd(o),o.tag){case 1:return r=o.flags,r&65536?(o.flags=r&-65537|128,o):null;case 3:return ro(Gr),ke(),r=o.flags,(r&65536)!==0&&(r&128)===0?(o.flags=r&-65537|128,o):null;case 26:case 27:case 5:return Ie(o),null;case 31:if(o.memoizedState!==null){if(zi(o),o.alternate===null)throw Error(n(340));il()}return r=o.flags,r&65536?(o.flags=r&-65537|128,o):null;case 13:if(zi(o),r=o.memoizedState,r!==null&&r.dehydrated!==null){if(o.alternate===null)throw Error(n(340));il()}return r=o.flags,r&65536?(o.flags=r&-65537|128,o):null;case 19:return Z(qr),null;case 4:return ke(),null;case 10:return ro(o.type),null;case 22:case 23:return zi(o),np(),r!==null&&Z(al),r=o.flags,r&65536?(o.flags=r&-65537|128,o):null;case 24:return ro(Gr),null;case 25:return null;default:return null}}function ww(r,o){switch(Fd(o),o.tag){case 3:ro(Gr),ke();break;case 26:case 27:case 5:Ie(o);break;case 4:ke();break;case 31:o.memoizedState!==null&&zi(o);break;case 13:zi(o);break;case 19:Z(qr);break;case 10:ro(o.type);break;case 22:case 23:zi(o),np(),r!==null&&Z(al);break;case 24:ro(Gr)}}function lu(r,o){try{var h=o.updateQueue,g=h!==null?h.lastEffect:null;if(g!==null){var E=g.next;h=E;do{if((h.tag&r)===r){g=void 0;var M=h.create,X=h.inst;g=M(),X.destroy=g}h=h.next}while(h!==E)}}catch(ue){lr(o,o.return,ue)}}function fa(r,o,h){try{var g=o.updateQueue,E=g!==null?g.lastEffect:null;if(E!==null){var M=E.next;g=M;do{if((g.tag&r)===r){var X=g.inst,ue=X.destroy;if(ue!==void 0){X.destroy=void 0,E=o;var De=h,ut=ue;try{ut()}catch(Tt){lr(E,De,Tt)}}}g=g.next}while(g!==M)}}catch(Tt){lr(o,o.return,Tt)}}function xw(r){var o=r.updateQueue;if(o!==null){var h=r.stateNode;try{fv(o,h)}catch(g){lr(r,r.return,g)}}}function _w(r,o,h){h.props=hl(r.type,r.memoizedProps),h.state=r.memoizedState;try{h.componentWillUnmount()}catch(g){lr(r,o,g)}}function cu(r,o){try{var h=r.ref;if(h!==null){switch(r.tag){case 26:case 27:case 5:var g=r.stateNode;break;case 30:g=r.stateNode;break;default:g=r.stateNode}typeof h=="function"?r.refCleanup=h(g):h.current=g}}catch(E){lr(r,o,E)}}function Ds(r,o){var h=r.ref,g=r.refCleanup;if(h!==null)if(typeof g=="function")try{g()}catch(E){lr(r,o,E)}finally{r.refCleanup=null,r=r.alternate,r!=null&&(r.refCleanup=null)}else if(typeof h=="function")try{h(null)}catch(E){lr(r,o,E)}else h.current=null}function Sw(r){var o=r.type,h=r.memoizedProps,g=r.stateNode;try{e:switch(o){case"button":case"input":case"select":case"textarea":h.autoFocus&&g.focus();break e;case"img":h.src?g.src=h.src:h.srcSet&&(g.srcset=h.srcSet)}}catch(E){lr(r,r.return,E)}}function Bp(r,o,h){try{var g=r.stateNode;RT(g,r.type,h,o),g[vt]=o}catch(E){lr(r,r.return,E)}}function Ew(r){return r.tag===5||r.tag===3||r.tag===26||r.tag===27&&ba(r.type)||r.tag===4}function jp(r){e:for(;;){for(;r.sibling===null;){if(r.return===null||Ew(r.return))return null;r=r.return}for(r.sibling.return=r.return,r=r.sibling;r.tag!==5&&r.tag!==6&&r.tag!==18;){if(r.tag===27&&ba(r.type)||r.flags&2||r.child===null||r.tag===4)continue e;r.child.return=r,r=r.child}if(!(r.flags&2))return r.stateNode}}function Dp(r,o,h){var g=r.tag;if(g===5||g===6)r=r.stateNode,o?(h.nodeType===9?h.body:h.nodeName==="HTML"?h.ownerDocument.body:h).insertBefore(r,o):(o=h.nodeType===9?h.body:h.nodeName==="HTML"?h.ownerDocument.body:h,o.appendChild(r),h=h._reactRootContainer,h!=null||o.onclick!==null||(o.onclick=fi));else if(g!==4&&(g===27&&ba(r.type)&&(h=r.stateNode,o=null),r=r.child,r!==null))for(Dp(r,o,h),r=r.sibling;r!==null;)Dp(r,o,h),r=r.sibling}function Ef(r,o,h){var g=r.tag;if(g===5||g===6)r=r.stateNode,o?h.insertBefore(r,o):h.appendChild(r);else if(g!==4&&(g===27&&ba(r.type)&&(h=r.stateNode),r=r.child,r!==null))for(Ef(r,o,h),r=r.sibling;r!==null;)Ef(r,o,h),r=r.sibling}function Cw(r){var o=r.stateNode,h=r.memoizedProps;try{for(var g=r.type,E=o.attributes;E.length;)o.removeAttributeNode(E[0]);ai(o,g,h),o[ze]=r,o[vt]=h}catch(M){lr(r,r.return,M)}}var lo=!1,$r=!1,Pp=!1,Aw=typeof WeakSet=="function"?WeakSet:Set,Xr=null;function uT(r,o){if(r=r.containerInfo,ig=Kf,r=re(r),le(r)){if("selectionStart"in r)var h={start:r.selectionStart,end:r.selectionEnd};else e:{h=(h=r.ownerDocument)&&h.defaultView||window;var g=h.getSelection&&h.getSelection();if(g&&g.rangeCount!==0){h=g.anchorNode;var E=g.anchorOffset,M=g.focusNode;g=g.focusOffset;try{h.nodeType,M.nodeType}catch{h=null;break e}var X=0,ue=-1,De=-1,ut=0,Tt=0,Lt=r,dt=null;t:for(;;){for(var wt;Lt!==h||E!==0&&Lt.nodeType!==3||(ue=X+E),Lt!==M||g!==0&&Lt.nodeType!==3||(De=X+g),Lt.nodeType===3&&(X+=Lt.nodeValue.length),(wt=Lt.firstChild)!==null;)dt=Lt,Lt=wt;for(;;){if(Lt===r)break t;if(dt===h&&++ut===E&&(ue=X),dt===M&&++Tt===g&&(De=X),(wt=Lt.nextSibling)!==null)break;Lt=dt,dt=Lt.parentNode}Lt=wt}h=ue===-1||De===-1?null:{start:ue,end:De}}else h=null}h=h||{start:0,end:0}}else h=null;for(sg={focusedElem:r,selectionRange:h},Kf=!1,Xr=o;Xr!==null;)if(o=Xr,r=o.child,(o.subtreeFlags&1028)!==0&&r!==null)r.return=o,Xr=r;else for(;Xr!==null;){switch(o=Xr,M=o.alternate,r=o.flags,o.tag){case 0:if((r&4)!==0&&(r=o.updateQueue,r=r!==null?r.events:null,r!==null))for(h=0;h<r.length;h++)E=r[h],E.ref.impl=E.nextImpl;break;case 11:case 15:break;case 1:if((r&1024)!==0&&M!==null){r=void 0,h=o,E=M.memoizedProps,M=M.memoizedState,g=h.stateNode;try{var un=hl(h.type,E);r=g.getSnapshotBeforeUpdate(un,M),g.__reactInternalSnapshotBeforeUpdate=r}catch(Cn){lr(h,h.return,Cn)}}break;case 3:if((r&1024)!==0){if(r=o.stateNode.containerInfo,h=r.nodeType,h===9)lg(r);else if(h===1)switch(r.nodeName){case"HEAD":case"HTML":case"BODY":lg(r);break;default:r.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((r&1024)!==0)throw Error(n(163))}if(r=o.sibling,r!==null){r.return=o.return,Xr=r;break}Xr=o.return}}function kw(r,o,h){var g=h.flags;switch(h.tag){case 0:case 11:case 15:uo(r,h),g&4&&lu(5,h);break;case 1:if(uo(r,h),g&4)if(r=h.stateNode,o===null)try{r.componentDidMount()}catch(X){lr(h,h.return,X)}else{var E=hl(h.type,o.memoizedProps);o=o.memoizedState;try{r.componentDidUpdate(E,o,r.__reactInternalSnapshotBeforeUpdate)}catch(X){lr(h,h.return,X)}}g&64&&xw(h),g&512&&cu(h,h.return);break;case 3:if(uo(r,h),g&64&&(r=h.updateQueue,r!==null)){if(o=null,h.child!==null)switch(h.child.tag){case 27:case 5:o=h.child.stateNode;break;case 1:o=h.child.stateNode}try{fv(r,o)}catch(X){lr(h,h.return,X)}}break;case 27:o===null&&g&4&&Cw(h);case 26:case 5:uo(r,h),o===null&&g&4&&Sw(h),g&512&&cu(h,h.return);break;case 12:uo(r,h);break;case 31:uo(r,h),g&4&&Iw(r,h);break;case 13:uo(r,h),g&4&&Rw(r,h),g&64&&(r=h.memoizedState,r!==null&&(r=r.dehydrated,r!==null&&(h=vT.bind(null,h),UT(r,h))));break;case 22:if(g=h.memoizedState!==null||lo,!g){o=o!==null&&o.memoizedState!==null||$r,E=lo;var M=$r;lo=g,($r=o)&&!M?fo(r,h,(h.subtreeFlags&8772)!==0):uo(r,h),lo=E,$r=M}break;case 30:break;default:uo(r,h)}}function Tw(r){var o=r.alternate;o!==null&&(r.alternate=null,Tw(o)),r.child=null,r.deletions=null,r.sibling=null,r.tag===5&&(o=r.stateNode,o!==null&&wn(o)),r.stateNode=null,r.return=null,r.dependencies=null,r.memoizedProps=null,r.memoizedState=null,r.pendingProps=null,r.stateNode=null,r.updateQueue=null}var Tr=null,Oi=!1;function co(r,o,h){for(h=h.child;h!==null;)Mw(r,o,h),h=h.sibling}function Mw(r,o,h){if(Xe&&typeof Xe.onCommitFiberUnmount=="function")try{Xe.onCommitFiberUnmount(Le,h)}catch{}switch(h.tag){case 26:$r||Ds(h,o),co(r,o,h),h.memoizedState?h.memoizedState.count--:h.stateNode&&(h=h.stateNode,h.parentNode.removeChild(h));break;case 27:$r||Ds(h,o);var g=Tr,E=Oi;ba(h.type)&&(Tr=h.stateNode,Oi=!1),co(r,o,h),bu(h.stateNode),Tr=g,Oi=E;break;case 5:$r||Ds(h,o);case 6:if(g=Tr,E=Oi,Tr=null,co(r,o,h),Tr=g,Oi=E,Tr!==null)if(Oi)try{(Tr.nodeType===9?Tr.body:Tr.nodeName==="HTML"?Tr.ownerDocument.body:Tr).removeChild(h.stateNode)}catch(M){lr(h,o,M)}else try{Tr.removeChild(h.stateNode)}catch(M){lr(h,o,M)}break;case 18:Tr!==null&&(Oi?(r=Tr,x1(r.nodeType===9?r.body:r.nodeName==="HTML"?r.ownerDocument.body:r,h.stateNode),bc(r)):x1(Tr,h.stateNode));break;case 4:g=Tr,E=Oi,Tr=h.stateNode.containerInfo,Oi=!0,co(r,o,h),Tr=g,Oi=E;break;case 0:case 11:case 14:case 15:fa(2,h,o),$r||fa(4,h,o),co(r,o,h);break;case 1:$r||(Ds(h,o),g=h.stateNode,typeof g.componentWillUnmount=="function"&&_w(h,o,g)),co(r,o,h);break;case 21:co(r,o,h);break;case 22:$r=(g=$r)||h.memoizedState!==null,co(r,o,h),$r=g;break;default:co(r,o,h)}}function Iw(r,o){if(o.memoizedState===null&&(r=o.alternate,r!==null&&(r=r.memoizedState,r!==null))){r=r.dehydrated;try{bc(r)}catch(h){lr(o,o.return,h)}}}function Rw(r,o){if(o.memoizedState===null&&(r=o.alternate,r!==null&&(r=r.memoizedState,r!==null&&(r=r.dehydrated,r!==null))))try{bc(r)}catch(h){lr(o,o.return,h)}}function fT(r){switch(r.tag){case 31:case 13:case 19:var o=r.stateNode;return o===null&&(o=r.stateNode=new Aw),o;case 22:return r=r.stateNode,o=r._retryCache,o===null&&(o=r._retryCache=new Aw),o;default:throw Error(n(435,r.tag))}}function Cf(r,o){var h=fT(r);o.forEach(function(g){if(!h.has(g)){h.add(g);var E=wT.bind(null,r,g);g.then(E,E)}})}function Ni(r,o){var h=o.deletions;if(h!==null)for(var g=0;g<h.length;g++){var E=h[g],M=r,X=o,ue=X;e:for(;ue!==null;){switch(ue.tag){case 27:if(ba(ue.type)){Tr=ue.stateNode,Oi=!1;break e}break;case 5:Tr=ue.stateNode,Oi=!1;break e;case 3:case 4:Tr=ue.stateNode.containerInfo,Oi=!0;break e}ue=ue.return}if(Tr===null)throw Error(n(160));Mw(M,X,E),Tr=null,Oi=!1,M=E.alternate,M!==null&&(M.return=null),E.return=null}if(o.subtreeFlags&13886)for(o=o.child;o!==null;)Ow(o,r),o=o.sibling}var ys=null;function Ow(r,o){var h=r.alternate,g=r.flags;switch(r.tag){case 0:case 11:case 14:case 15:Ni(o,r),Bi(r),g&4&&(fa(3,r,r.return),lu(3,r),fa(5,r,r.return));break;case 1:Ni(o,r),Bi(r),g&512&&($r||h===null||Ds(h,h.return)),g&64&&lo&&(r=r.updateQueue,r!==null&&(g=r.callbacks,g!==null&&(h=r.shared.hiddenCallbacks,r.shared.hiddenCallbacks=h===null?g:h.concat(g))));break;case 26:var E=ys;if(Ni(o,r),Bi(r),g&512&&($r||h===null||Ds(h,h.return)),g&4){var M=h!==null?h.memoizedState:null;if(g=r.memoizedState,h===null)if(g===null)if(r.stateNode===null){e:{g=r.type,h=r.memoizedProps,E=E.ownerDocument||E;t:switch(g){case"title":M=E.getElementsByTagName("title")[0],(!M||M[sn]||M[ze]||M.namespaceURI==="http://www.w3.org/2000/svg"||M.hasAttribute("itemprop"))&&(M=E.createElement(g),E.head.insertBefore(M,E.querySelector("head > title"))),ai(M,g,h),M[ze]=r,on(M),g=M;break e;case"link":var X=O1("link","href",E).get(g+(h.href||""));if(X){for(var ue=0;ue<X.length;ue++)if(M=X[ue],M.getAttribute("href")===(h.href==null||h.href===""?null:h.href)&&M.getAttribute("rel")===(h.rel==null?null:h.rel)&&M.getAttribute("title")===(h.title==null?null:h.title)&&M.getAttribute("crossorigin")===(h.crossOrigin==null?null:h.crossOrigin)){X.splice(ue,1);break t}}M=E.createElement(g),ai(M,g,h),E.head.appendChild(M);break;case"meta":if(X=O1("meta","content",E).get(g+(h.content||""))){for(ue=0;ue<X.length;ue++)if(M=X[ue],M.getAttribute("content")===(h.content==null?null:""+h.content)&&M.getAttribute("name")===(h.name==null?null:h.name)&&M.getAttribute("property")===(h.property==null?null:h.property)&&M.getAttribute("http-equiv")===(h.httpEquiv==null?null:h.httpEquiv)&&M.getAttribute("charset")===(h.charSet==null?null:h.charSet)){X.splice(ue,1);break t}}M=E.createElement(g),ai(M,g,h),E.head.appendChild(M);break;default:throw Error(n(468,g))}M[ze]=r,on(M),g=M}r.stateNode=g}else N1(E,r.type,r.stateNode);else r.stateNode=R1(E,g,r.memoizedProps);else M!==g?(M===null?h.stateNode!==null&&(h=h.stateNode,h.parentNode.removeChild(h)):M.count--,g===null?N1(E,r.type,r.stateNode):R1(E,g,r.memoizedProps)):g===null&&r.stateNode!==null&&Bp(r,r.memoizedProps,h.memoizedProps)}break;case 27:Ni(o,r),Bi(r),g&512&&($r||h===null||Ds(h,h.return)),h!==null&&g&4&&Bp(r,r.memoizedProps,h.memoizedProps);break;case 5:if(Ni(o,r),Bi(r),g&512&&($r||h===null||Ds(h,h.return)),r.flags&32){E=r.stateNode;try{Vn(E,"")}catch(un){lr(r,r.return,un)}}g&4&&r.stateNode!=null&&(E=r.memoizedProps,Bp(r,E,h!==null?h.memoizedProps:E)),g&1024&&(Pp=!0);break;case 6:if(Ni(o,r),Bi(r),g&4){if(r.stateNode===null)throw Error(n(162));g=r.memoizedProps,h=r.stateNode;try{h.nodeValue=g}catch(un){lr(r,r.return,un)}}break;case 3:if(Ff=null,E=ys,ys=Uf(o.containerInfo),Ni(o,r),ys=E,Bi(r),g&4&&h!==null&&h.memoizedState.isDehydrated)try{bc(o.containerInfo)}catch(un){lr(r,r.return,un)}Pp&&(Pp=!1,Nw(r));break;case 4:g=ys,ys=Uf(r.stateNode.containerInfo),Ni(o,r),Bi(r),ys=g;break;case 12:Ni(o,r),Bi(r);break;case 31:Ni(o,r),Bi(r),g&4&&(g=r.updateQueue,g!==null&&(r.updateQueue=null,Cf(r,g)));break;case 13:Ni(o,r),Bi(r),r.child.flags&8192&&r.memoizedState!==null!=(h!==null&&h.memoizedState!==null)&&(kf=nt()),g&4&&(g=r.updateQueue,g!==null&&(r.updateQueue=null,Cf(r,g)));break;case 22:E=r.memoizedState!==null;var De=h!==null&&h.memoizedState!==null,ut=lo,Tt=$r;if(lo=ut||E,$r=Tt||De,Ni(o,r),$r=Tt,lo=ut,Bi(r),g&8192)e:for(o=r.stateNode,o._visibility=E?o._visibility&-2:o._visibility|1,E&&(h===null||De||lo||$r||dl(r)),h=null,o=r;;){if(o.tag===5||o.tag===26){if(h===null){De=h=o;try{if(M=De.stateNode,E)X=M.style,typeof X.setProperty=="function"?X.setProperty("display","none","important"):X.display="none";else{ue=De.stateNode;var Lt=De.memoizedProps.style,dt=Lt!=null&&Lt.hasOwnProperty("display")?Lt.display:null;ue.style.display=dt==null||typeof dt=="boolean"?"":(""+dt).trim()}}catch(un){lr(De,De.return,un)}}}else if(o.tag===6){if(h===null){De=o;try{De.stateNode.nodeValue=E?"":De.memoizedProps}catch(un){lr(De,De.return,un)}}}else if(o.tag===18){if(h===null){De=o;try{var wt=De.stateNode;E?_1(wt,!0):_1(De.stateNode,!1)}catch(un){lr(De,De.return,un)}}}else if((o.tag!==22&&o.tag!==23||o.memoizedState===null||o===r)&&o.child!==null){o.child.return=o,o=o.child;continue}if(o===r)break e;for(;o.sibling===null;){if(o.return===null||o.return===r)break e;h===o&&(h=null),o=o.return}h===o&&(h=null),o.sibling.return=o.return,o=o.sibling}g&4&&(g=r.updateQueue,g!==null&&(h=g.retryQueue,h!==null&&(g.retryQueue=null,Cf(r,h))));break;case 19:Ni(o,r),Bi(r),g&4&&(g=r.updateQueue,g!==null&&(r.updateQueue=null,Cf(r,g)));break;case 30:break;case 21:break;default:Ni(o,r),Bi(r)}}function Bi(r){var o=r.flags;if(o&2){try{for(var h,g=r.return;g!==null;){if(Ew(g)){h=g;break}g=g.return}if(h==null)throw Error(n(160));switch(h.tag){case 27:var E=h.stateNode,M=jp(r);Ef(r,M,E);break;case 5:var X=h.stateNode;h.flags&32&&(Vn(X,""),h.flags&=-33);var ue=jp(r);Ef(r,ue,X);break;case 3:case 4:var De=h.stateNode.containerInfo,ut=jp(r);Dp(r,ut,De);break;default:throw Error(n(161))}}catch(Tt){lr(r,r.return,Tt)}r.flags&=-3}o&4096&&(r.flags&=-4097)}function Nw(r){if(r.subtreeFlags&1024)for(r=r.child;r!==null;){var o=r;Nw(o),o.tag===5&&o.flags&1024&&o.stateNode.reset(),r=r.sibling}}function uo(r,o){if(o.subtreeFlags&8772)for(o=o.child;o!==null;)kw(r,o.alternate,o),o=o.sibling}function dl(r){for(r=r.child;r!==null;){var o=r;switch(o.tag){case 0:case 11:case 14:case 15:fa(4,o,o.return),dl(o);break;case 1:Ds(o,o.return);var h=o.stateNode;typeof h.componentWillUnmount=="function"&&_w(o,o.return,h),dl(o);break;case 27:bu(o.stateNode);case 26:case 5:Ds(o,o.return),dl(o);break;case 22:o.memoizedState===null&&dl(o);break;case 30:dl(o);break;default:dl(o)}r=r.sibling}}function fo(r,o,h){for(h=h&&(o.subtreeFlags&8772)!==0,o=o.child;o!==null;){var g=o.alternate,E=r,M=o,X=M.flags;switch(M.tag){case 0:case 11:case 15:fo(E,M,h),lu(4,M);break;case 1:if(fo(E,M,h),g=M,E=g.stateNode,typeof E.componentDidMount=="function")try{E.componentDidMount()}catch(ut){lr(g,g.return,ut)}if(g=M,E=g.updateQueue,E!==null){var ue=g.stateNode;try{var De=E.shared.hiddenCallbacks;if(De!==null)for(E.shared.hiddenCallbacks=null,E=0;E<De.length;E++)uv(De[E],ue)}catch(ut){lr(g,g.return,ut)}}h&&X&64&&xw(M),cu(M,M.return);break;case 27:Cw(M);case 26:case 5:fo(E,M,h),h&&g===null&&X&4&&Sw(M),cu(M,M.return);break;case 12:fo(E,M,h);break;case 31:fo(E,M,h),h&&X&4&&Iw(E,M);break;case 13:fo(E,M,h),h&&X&4&&Rw(E,M);break;case 22:M.memoizedState===null&&fo(E,M,h),cu(M,M.return);break;case 30:break;default:fo(E,M,h)}o=o.sibling}}function Lp(r,o){var h=null;r!==null&&r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(h=r.memoizedState.cachePool.pool),r=null,o.memoizedState!==null&&o.memoizedState.cachePool!==null&&(r=o.memoizedState.cachePool.pool),r!==h&&(r!=null&&r.refCount++,h!=null&&Wc(h))}function Up(r,o){r=null,o.alternate!==null&&(r=o.alternate.memoizedState.cache),o=o.memoizedState.cache,o!==r&&(o.refCount++,r!=null&&Wc(r))}function bs(r,o,h,g){if(o.subtreeFlags&10256)for(o=o.child;o!==null;)Bw(r,o,h,g),o=o.sibling}function Bw(r,o,h,g){var E=o.flags;switch(o.tag){case 0:case 11:case 15:bs(r,o,h,g),E&2048&&lu(9,o);break;case 1:bs(r,o,h,g);break;case 3:bs(r,o,h,g),E&2048&&(r=null,o.alternate!==null&&(r=o.alternate.memoizedState.cache),o=o.memoizedState.cache,o!==r&&(o.refCount++,r!=null&&Wc(r)));break;case 12:if(E&2048){bs(r,o,h,g),r=o.stateNode;try{var M=o.memoizedProps,X=M.id,ue=M.onPostCommit;typeof ue=="function"&&ue(X,o.alternate===null?"mount":"update",r.passiveEffectDuration,-0)}catch(De){lr(o,o.return,De)}}else bs(r,o,h,g);break;case 31:bs(r,o,h,g);break;case 13:bs(r,o,h,g);break;case 23:break;case 22:M=o.stateNode,X=o.alternate,o.memoizedState!==null?M._visibility&2?bs(r,o,h,g):uu(r,o):M._visibility&2?bs(r,o,h,g):(M._visibility|=2,ac(r,o,h,g,(o.subtreeFlags&10256)!==0||!1)),E&2048&&Lp(X,o);break;case 24:bs(r,o,h,g),E&2048&&Up(o.alternate,o);break;default:bs(r,o,h,g)}}function ac(r,o,h,g,E){for(E=E&&((o.subtreeFlags&10256)!==0||!1),o=o.child;o!==null;){var M=r,X=o,ue=h,De=g,ut=X.flags;switch(X.tag){case 0:case 11:case 15:ac(M,X,ue,De,E),lu(8,X);break;case 23:break;case 22:var Tt=X.stateNode;X.memoizedState!==null?Tt._visibility&2?ac(M,X,ue,De,E):uu(M,X):(Tt._visibility|=2,ac(M,X,ue,De,E)),E&&ut&2048&&Lp(X.alternate,X);break;case 24:ac(M,X,ue,De,E),E&&ut&2048&&Up(X.alternate,X);break;default:ac(M,X,ue,De,E)}o=o.sibling}}function uu(r,o){if(o.subtreeFlags&10256)for(o=o.child;o!==null;){var h=r,g=o,E=g.flags;switch(g.tag){case 22:uu(h,g),E&2048&&Lp(g.alternate,g);break;case 24:uu(h,g),E&2048&&Up(g.alternate,g);break;default:uu(h,g)}o=o.sibling}}var fu=8192;function lc(r,o,h){if(r.subtreeFlags&fu)for(r=r.child;r!==null;)jw(r,o,h),r=r.sibling}function jw(r,o,h){switch(r.tag){case 26:lc(r,o,h),r.flags&fu&&r.memoizedState!==null&&JT(h,ys,r.memoizedState,r.memoizedProps);break;case 5:lc(r,o,h);break;case 3:case 4:var g=ys;ys=Uf(r.stateNode.containerInfo),lc(r,o,h),ys=g;break;case 22:r.memoizedState===null&&(g=r.alternate,g!==null&&g.memoizedState!==null?(g=fu,fu=16777216,lc(r,o,h),fu=g):lc(r,o,h));break;default:lc(r,o,h)}}function Dw(r){var o=r.alternate;if(o!==null&&(r=o.child,r!==null)){o.child=null;do o=r.sibling,r.sibling=null,r=o;while(r!==null)}}function hu(r){var o=r.deletions;if((r.flags&16)!==0){if(o!==null)for(var h=0;h<o.length;h++){var g=o[h];Xr=g,Lw(g,r)}Dw(r)}if(r.subtreeFlags&10256)for(r=r.child;r!==null;)Pw(r),r=r.sibling}function Pw(r){switch(r.tag){case 0:case 11:case 15:hu(r),r.flags&2048&&fa(9,r,r.return);break;case 3:hu(r);break;case 12:hu(r);break;case 22:var o=r.stateNode;r.memoizedState!==null&&o._visibility&2&&(r.return===null||r.return.tag!==13)?(o._visibility&=-3,Af(r)):hu(r);break;default:hu(r)}}function Af(r){var o=r.deletions;if((r.flags&16)!==0){if(o!==null)for(var h=0;h<o.length;h++){var g=o[h];Xr=g,Lw(g,r)}Dw(r)}for(r=r.child;r!==null;){switch(o=r,o.tag){case 0:case 11:case 15:fa(8,o,o.return),Af(o);break;case 22:h=o.stateNode,h._visibility&2&&(h._visibility&=-3,Af(o));break;default:Af(o)}r=r.sibling}}function Lw(r,o){for(;Xr!==null;){var h=Xr;switch(h.tag){case 0:case 11:case 15:fa(8,h,o);break;case 23:case 22:if(h.memoizedState!==null&&h.memoizedState.cachePool!==null){var g=h.memoizedState.cachePool.pool;g!=null&&g.refCount++}break;case 24:Wc(h.memoizedState.cache)}if(g=h.child,g!==null)g.return=h,Xr=g;else e:for(h=r;Xr!==null;){g=Xr;var E=g.sibling,M=g.return;if(Tw(g),g===h){Xr=null;break e}if(E!==null){E.return=M,Xr=E;break e}Xr=M}}}var hT={getCacheForType:function(r){var o=si(Gr),h=o.data.get(r);return h===void 0&&(h=r(),o.data.set(r,h)),h},cacheSignal:function(){return si(Gr).controller.signal}},dT=typeof WeakMap=="function"?WeakMap:Map,ir=0,yr=null,Fn=null,Gn=0,ar=0,Gi=null,ha=!1,cc=!1,qp=!1,ho=0,Pr=0,da=0,pl=0,Fp=0,Ki=0,uc=0,du=null,ji=null,Hp=!1,kf=0,Uw=0,Tf=1/0,Mf=null,pa=null,Qr=0,ga=null,fc=null,po=0,zp=0,Gp=null,qw=null,pu=0,Kp=null;function Vi(){return(ir&2)!==0&&Gn!==0?Gn&-Gn:ee.T!==null?Jp():D()}function Fw(){if(Ki===0)if((Gn&536870912)===0||Qn){var r=Bn;Bn<<=1,(Bn&3932160)===0&&(Bn=262144),Ki=r}else Ki=536870912;return r=Hi.current,r!==null&&(r.flags|=32),Ki}function Di(r,o,h){(r===yr&&(ar===2||ar===9)||r.cancelPendingCommit!==null)&&(hc(r,0),ma(r,Gn,Ki,!1)),fe(r,h),((ir&2)===0||r!==yr)&&(r===yr&&((ir&2)===0&&(pl|=h),Pr===4&&ma(r,Gn,Ki,!1)),Ps(r))}function Hw(r,o,h){if((ir&6)!==0)throw Error(n(327));var g=!h&&(o&127)===0&&(o&r.expiredLanes)===0||Ht(r,o),E=g?mT(r,o):$p(r,o,!0),M=g;do{if(E===0){cc&&!g&&ma(r,o,0,!1);break}else{if(h=r.current.alternate,M&&!pT(h)){E=$p(r,o,!1),M=!1;continue}if(E===2){if(M=o,r.errorRecoveryDisabledLanes&M)var X=0;else X=r.pendingLanes&-536870913,X=X!==0?X:X&536870912?536870912:0;if(X!==0){o=X;e:{var ue=r;E=du;var De=ue.current.memoizedState.isDehydrated;if(De&&(hc(ue,X).flags|=256),X=$p(ue,X,!1),X!==2){if(qp&&!De){ue.errorRecoveryDisabledLanes|=M,pl|=M,E=4;break e}M=ji,ji=E,M!==null&&(ji===null?ji=M:ji.push.apply(ji,M))}E=X}if(M=!1,E!==2)continue}}if(E===1){hc(r,0),ma(r,o,0,!0);break}e:{switch(g=r,M=E,M){case 0:case 1:throw Error(n(345));case 4:if((o&4194048)!==o)break;case 6:ma(g,o,Ki,!ha);break e;case 2:ji=null;break;case 3:case 5:break;default:throw Error(n(329))}if((o&62914560)===o&&(E=kf+300-nt(),10<E)){if(ma(g,o,Ki,!ha),Zn(g,0,!0)!==0)break e;po=o,g.timeoutHandle=v1(zw.bind(null,g,h,ji,Mf,Hp,o,Ki,pl,uc,ha,M,"Throttled",-0,0),E);break e}zw(g,h,ji,Mf,Hp,o,Ki,pl,uc,ha,M,null,-0,0)}}break}while(!0);Ps(r)}function zw(r,o,h,g,E,M,X,ue,De,ut,Tt,Lt,dt,wt){if(r.timeoutHandle=-1,Lt=o.subtreeFlags,Lt&8192||(Lt&16785408)===16785408){Lt={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:fi},jw(o,M,Lt);var un=(M&62914560)===M?kf-nt():(M&4194048)===M?Uw-nt():0;if(un=ZT(Lt,un),un!==null){po=M,r.cancelPendingCommit=un(Jw.bind(null,r,o,M,h,g,E,X,ue,De,Tt,Lt,null,dt,wt)),ma(r,M,X,!ut);return}}Jw(r,o,M,h,g,E,X,ue,De)}function pT(r){for(var o=r;;){var h=o.tag;if((h===0||h===11||h===15)&&o.flags&16384&&(h=o.updateQueue,h!==null&&(h=h.stores,h!==null)))for(var g=0;g<h.length;g++){var E=h[g],M=E.getSnapshot;E=E.value;try{if(!Jr(M(),E))return!1}catch{return!1}}if(h=o.child,o.subtreeFlags&16384&&h!==null)h.return=o,o=h;else{if(o===r)break;for(;o.sibling===null;){if(o.return===null||o.return===r)return!0;o=o.return}o.sibling.return=o.return,o=o.sibling}}return!0}function ma(r,o,h,g){o&=~Fp,o&=~pl,r.suspendedLanes|=o,r.pingedLanes&=~o,g&&(r.warmLanes|=o),g=r.expirationTimes;for(var E=o;0<E;){var M=31-mt(E),X=1<<M;g[M]=-1,E&=~X}h!==0&&pt(r,h,o)}function If(){return(ir&6)===0?(gu(0),!1):!0}function Vp(){if(Fn!==null){if(ar===0)var r=Fn.return;else r=Fn,no=sl=null,lp(r),nc=null,Jc=0,r=Fn;for(;r!==null;)ww(r.alternate,r),r=r.return;Fn=null}}function hc(r,o){var h=r.timeoutHandle;h!==-1&&(r.timeoutHandle=-1,BT(h)),h=r.cancelPendingCommit,h!==null&&(r.cancelPendingCommit=null,h()),po=0,Vp(),yr=r,Fn=h=jr(r.current,null),Gn=o,ar=0,Gi=null,ha=!1,cc=Ht(r,o),qp=!1,uc=Ki=Fp=pl=da=Pr=0,ji=du=null,Hp=!1,(o&8)!==0&&(o|=o&32);var g=r.entangledLanes;if(g!==0)for(r=r.entanglements,g&=o;0<g;){var E=31-mt(g),M=1<<E;o|=r[E],g&=~M}return ho=o,Vt(),h}function Gw(r,o){Dn=null,ee.H=su,o===tc||o===sf?(o=ov(),ar=3):o===Qd?(o=ov(),ar=4):ar=o===Ep?8:o!==null&&typeof o=="object"&&typeof o.then=="function"?6:1,Gi=o,Fn===null&&(Pr=1,vf(r,Ei(o,r.current)))}function Kw(){var r=Hi.current;return r===null?!0:(Gn&4194048)===Gn?Xi===null:(Gn&62914560)===Gn||(Gn&536870912)!==0?r===Xi:!1}function Vw(){var r=ee.H;return ee.H=su,r===null?su:r}function $w(){var r=ee.A;return ee.A=hT,r}function Rf(){Pr=4,ha||(Gn&4194048)!==Gn&&Hi.current!==null||(cc=!0),(da&134217727)===0&&(pl&134217727)===0||yr===null||ma(yr,Gn,Ki,!1)}function $p(r,o,h){var g=ir;ir|=2;var E=Vw(),M=$w();(yr!==r||Gn!==o)&&(Mf=null,hc(r,o)),o=!1;var X=Pr;e:do try{if(ar!==0&&Fn!==null){var ue=Fn,De=Gi;switch(ar){case 8:Vp(),X=6;break e;case 3:case 2:case 9:case 6:Hi.current===null&&(o=!0);var ut=ar;if(ar=0,Gi=null,dc(r,ue,De,ut),h&&cc){X=0;break e}break;default:ut=ar,ar=0,Gi=null,dc(r,ue,De,ut)}}gT(),X=Pr;break}catch(Tt){Gw(r,Tt)}while(!0);return o&&r.shellSuspendCounter++,no=sl=null,ir=g,ee.H=E,ee.A=M,Fn===null&&(yr=null,Gn=0,Vt()),X}function gT(){for(;Fn!==null;)Yw(Fn)}function mT(r,o){var h=ir;ir|=2;var g=Vw(),E=$w();yr!==r||Gn!==o?(Mf=null,Tf=nt()+500,hc(r,o)):cc=Ht(r,o);e:do try{if(ar!==0&&Fn!==null){o=Fn;var M=Gi;t:switch(ar){case 1:ar=0,Gi=null,dc(r,o,M,1);break;case 2:case 9:if(iv(M)){ar=0,Gi=null,Ww(o);break}o=function(){ar!==2&&ar!==9||yr!==r||(ar=7),Ps(r)},M.then(o,o);break e;case 3:ar=7;break e;case 4:ar=5;break e;case 7:iv(M)?(ar=0,Gi=null,Ww(o)):(ar=0,Gi=null,dc(r,o,M,7));break;case 5:var X=null;switch(Fn.tag){case 26:X=Fn.memoizedState;case 5:case 27:var ue=Fn;if(X?B1(X):ue.stateNode.complete){ar=0,Gi=null;var De=ue.sibling;if(De!==null)Fn=De;else{var ut=ue.return;ut!==null?(Fn=ut,Of(ut)):Fn=null}break t}}ar=0,Gi=null,dc(r,o,M,5);break;case 6:ar=0,Gi=null,dc(r,o,M,6);break;case 8:Vp(),Pr=6;break e;default:throw Error(n(462))}}yT();break}catch(Tt){Gw(r,Tt)}while(!0);return no=sl=null,ee.H=g,ee.A=E,ir=h,Fn!==null?0:(yr=null,Gn=0,Vt(),Pr)}function yT(){for(;Fn!==null&&!it();)Yw(Fn)}function Yw(r){var o=bw(r.alternate,r,ho);r.memoizedProps=r.pendingProps,o===null?Of(r):Fn=o}function Ww(r){var o=r,h=o.alternate;switch(o.tag){case 15:case 0:o=hw(h,o,o.pendingProps,o.type,void 0,Gn);break;case 11:o=hw(h,o,o.pendingProps,o.type.render,o.ref,Gn);break;case 5:lp(o);default:ww(h,o),o=Fn=nl(o,ho),o=bw(h,o,ho)}r.memoizedProps=r.pendingProps,o===null?Of(r):Fn=o}function dc(r,o,h,g){no=sl=null,lp(o),nc=null,Jc=0;var E=o.return;try{if(sT(r,E,o,h,Gn)){Pr=1,vf(r,Ei(h,r.current)),Fn=null;return}}catch(M){if(E!==null)throw Fn=E,M;Pr=1,vf(r,Ei(h,r.current)),Fn=null;return}o.flags&32768?(Qn||g===1?r=!0:cc||(Gn&536870912)!==0?r=!1:(ha=r=!0,(g===2||g===9||g===3||g===6)&&(g=Hi.current,g!==null&&g.tag===13&&(g.flags|=16384))),Qw(o,r)):Of(o)}function Of(r){var o=r;do{if((o.flags&32768)!==0){Qw(o,ha);return}r=o.return;var h=lT(o.alternate,o,ho);if(h!==null){Fn=h;return}if(o=o.sibling,o!==null){Fn=o;return}Fn=o=r}while(o!==null);Pr===0&&(Pr=5)}function Qw(r,o){do{var h=cT(r.alternate,r);if(h!==null){h.flags&=32767,Fn=h;return}if(h=r.return,h!==null&&(h.flags|=32768,h.subtreeFlags=0,h.deletions=null),!o&&(r=r.sibling,r!==null)){Fn=r;return}Fn=r=h}while(r!==null);Pr=6,Fn=null}function Jw(r,o,h,g,E,M,X,ue,De){r.cancelPendingCommit=null;do Nf();while(Qr!==0);if((ir&6)!==0)throw Error(n(327));if(o!==null){if(o===r.current)throw Error(n(177));if(M=o.lanes|o.childLanes,M|=It,we(r,h,M,X,ue,De),r===yr&&(Fn=yr=null,Gn=0),fc=o,ga=r,po=h,zp=M,Gp=E,qw=g,(o.subtreeFlags&10256)!==0||(o.flags&10256)!==0?(r.callbackNode=null,r.callbackPriority=0,xT(se,function(){return n1(),null})):(r.callbackNode=null,r.callbackPriority=0),g=(o.flags&13878)!==0,(o.subtreeFlags&13878)!==0||g){g=ee.T,ee.T=null,E=ne.p,ne.p=2,X=ir,ir|=4;try{uT(r,o,h)}finally{ir=X,ne.p=E,ee.T=g}}Qr=1,Zw(),Xw(),e1()}}function Zw(){if(Qr===1){Qr=0;var r=ga,o=fc,h=(o.flags&13878)!==0;if((o.subtreeFlags&13878)!==0||h){h=ee.T,ee.T=null;var g=ne.p;ne.p=2;var E=ir;ir|=4;try{Ow(o,r);var M=sg,X=re(r.containerInfo),ue=M.focusedElem,De=M.selectionRange;if(X!==ue&&ue&&ue.ownerDocument&&J(ue.ownerDocument.documentElement,ue)){if(De!==null&&le(ue)){var ut=De.start,Tt=De.end;if(Tt===void 0&&(Tt=ut),"selectionStart"in ue)ue.selectionStart=ut,ue.selectionEnd=Math.min(Tt,ue.value.length);else{var Lt=ue.ownerDocument||document,dt=Lt&&Lt.defaultView||window;if(dt.getSelection){var wt=dt.getSelection(),un=ue.textContent.length,Cn=Math.min(De.start,un),hr=De.end===void 0?Cn:Math.min(De.end,un);!wt.extend&&Cn>hr&&(X=hr,hr=Cn,Cn=X);var tt=L(ue,Cn),He=L(ue,hr);if(tt&&He&&(wt.rangeCount!==1||wt.anchorNode!==tt.node||wt.anchorOffset!==tt.offset||wt.focusNode!==He.node||wt.focusOffset!==He.offset)){var ct=Lt.createRange();ct.setStart(tt.node,tt.offset),wt.removeAllRanges(),Cn>hr?(wt.addRange(ct),wt.extend(He.node,He.offset)):(ct.setEnd(He.node,He.offset),wt.addRange(ct))}}}}for(Lt=[],wt=ue;wt=wt.parentNode;)wt.nodeType===1&&Lt.push({element:wt,left:wt.scrollLeft,top:wt.scrollTop});for(typeof ue.focus=="function"&&ue.focus(),ue=0;ue<Lt.length;ue++){var Bt=Lt[ue];Bt.element.scrollLeft=Bt.left,Bt.element.scrollTop=Bt.top}}Kf=!!ig,sg=ig=null}finally{ir=E,ne.p=g,ee.T=h}}r.current=o,Qr=2}}function Xw(){if(Qr===2){Qr=0;var r=ga,o=fc,h=(o.flags&8772)!==0;if((o.subtreeFlags&8772)!==0||h){h=ee.T,ee.T=null;var g=ne.p;ne.p=2;var E=ir;ir|=4;try{kw(r,o.alternate,o)}finally{ir=E,ne.p=g,ee.T=h}}Qr=3}}function e1(){if(Qr===4||Qr===3){Qr=0,Mt();var r=ga,o=fc,h=po,g=qw;(o.subtreeFlags&10256)!==0||(o.flags&10256)!==0?Qr=5:(Qr=0,fc=ga=null,t1(r,r.pendingLanes));var E=r.pendingLanes;if(E===0&&(pa=null),ce(h),o=o.stateNode,Xe&&typeof Xe.onCommitFiberRoot=="function")try{Xe.onCommitFiberRoot(Le,o,void 0,(o.current.flags&128)===128)}catch{}if(g!==null){o=ee.T,E=ne.p,ne.p=2,ee.T=null;try{for(var M=r.onRecoverableError,X=0;X<g.length;X++){var ue=g[X];M(ue.value,{componentStack:ue.stack})}}finally{ee.T=o,ne.p=E}}(po&3)!==0&&Nf(),Ps(r),E=r.pendingLanes,(h&261930)!==0&&(E&42)!==0?r===Kp?pu++:(pu=0,Kp=r):pu=0,gu(0)}}function t1(r,o){(r.pooledCacheLanes&=o)===0&&(o=r.pooledCache,o!=null&&(r.pooledCache=null,Wc(o)))}function Nf(){return Zw(),Xw(),e1(),n1()}function n1(){if(Qr!==5)return!1;var r=ga,o=zp;zp=0;var h=ce(po),g=ee.T,E=ne.p;try{ne.p=32>h?32:h,ee.T=null,h=Gp,Gp=null;var M=ga,X=po;if(Qr=0,fc=ga=null,po=0,(ir&6)!==0)throw Error(n(331));var ue=ir;if(ir|=4,Pw(M.current),Bw(M,M.current,X,h),ir=ue,gu(0,!1),Xe&&typeof Xe.onPostCommitFiberRoot=="function")try{Xe.onPostCommitFiberRoot(Le,M)}catch{}return!0}finally{ne.p=E,ee.T=g,t1(r,o)}}function r1(r,o,h){o=Ei(h,o),o=Sp(r.stateNode,o,2),r=la(r,o,2),r!==null&&(fe(r,2),Ps(r))}function lr(r,o,h){if(r.tag===3)r1(r,r,h);else for(;o!==null;){if(o.tag===3){r1(o,r,h);break}else if(o.tag===1){var g=o.stateNode;if(typeof o.type.getDerivedStateFromError=="function"||typeof g.componentDidCatch=="function"&&(pa===null||!pa.has(g))){r=Ei(h,r),h=iw(2),g=la(o,h,2),g!==null&&(sw(h,g,o,r),fe(g,2),Ps(g));break}}o=o.return}}function Yp(r,o,h){var g=r.pingCache;if(g===null){g=r.pingCache=new dT;var E=new Set;g.set(o,E)}else E=g.get(o),E===void 0&&(E=new Set,g.set(o,E));E.has(h)||(qp=!0,E.add(h),r=bT.bind(null,r,o,h),o.then(r,r))}function bT(r,o,h){var g=r.pingCache;g!==null&&g.delete(o),r.pingedLanes|=r.suspendedLanes&h,r.warmLanes&=~h,yr===r&&(Gn&h)===h&&(Pr===4||Pr===3&&(Gn&62914560)===Gn&&300>nt()-kf?(ir&2)===0&&hc(r,0):Fp|=h,uc===Gn&&(uc=0)),Ps(r)}function i1(r,o){o===0&&(o=Ot()),r=bn(r,o),r!==null&&(fe(r,o),Ps(r))}function vT(r){var o=r.memoizedState,h=0;o!==null&&(h=o.retryLane),i1(r,h)}function wT(r,o){var h=0;switch(r.tag){case 31:case 13:var g=r.stateNode,E=r.memoizedState;E!==null&&(h=E.retryLane);break;case 19:g=r.stateNode;break;case 22:g=r.stateNode._retryCache;break;default:throw Error(n(314))}g!==null&&g.delete(o),i1(r,h)}function xT(r,o){return at(r,o)}var Bf=null,pc=null,Wp=!1,jf=!1,Qp=!1,ya=0;function Ps(r){r!==pc&&r.next===null&&(pc===null?Bf=pc=r:pc=pc.next=r),jf=!0,Wp||(Wp=!0,ST())}function gu(r,o){if(!Qp&&jf){Qp=!0;do for(var h=!1,g=Bf;g!==null;){if(r!==0){var E=g.pendingLanes;if(E===0)var M=0;else{var X=g.suspendedLanes,ue=g.pingedLanes;M=(1<<31-mt(42|r)+1)-1,M&=E&~(X&~ue),M=M&201326741?M&201326741|1:M?M|2:0}M!==0&&(h=!0,l1(g,M))}else M=Gn,M=Zn(g,g===yr?M:0,g.cancelPendingCommit!==null||g.timeoutHandle!==-1),(M&3)===0||Ht(g,M)||(h=!0,l1(g,M));g=g.next}while(h);Qp=!1}}function _T(){s1()}function s1(){jf=Wp=!1;var r=0;ya!==0&&NT()&&(r=ya);for(var o=nt(),h=null,g=Bf;g!==null;){var E=g.next,M=o1(g,o);M===0?(g.next=null,h===null?Bf=E:h.next=E,E===null&&(pc=h)):(h=g,(r!==0||(M&3)!==0)&&(jf=!0)),g=E}Qr!==0&&Qr!==5||gu(r),ya!==0&&(ya=0)}function o1(r,o){for(var h=r.suspendedLanes,g=r.pingedLanes,E=r.expirationTimes,M=r.pendingLanes&-62914561;0<M;){var X=31-mt(M),ue=1<<X,De=E[X];De===-1?((ue&h)===0||(ue&g)!==0)&&(E[X]=pe(ue,o)):De<=o&&(r.expiredLanes|=ue),M&=~ue}if(o=yr,h=Gn,h=Zn(r,r===o?h:0,r.cancelPendingCommit!==null||r.timeoutHandle!==-1),g=r.callbackNode,h===0||r===o&&(ar===2||ar===9)||r.cancelPendingCommit!==null)return g!==null&&g!==null&&ye(g),r.callbackNode=null,r.callbackPriority=0;if((h&3)===0||Ht(r,h)){if(o=h&-h,o===r.callbackPriority)return o;switch(g!==null&&ye(g),ce(h)){case 2:case 8:h=W;break;case 32:h=se;break;case 268435456:h=Ke;break;default:h=se}return g=a1.bind(null,r),h=at(h,g),r.callbackPriority=o,r.callbackNode=h,o}return g!==null&&g!==null&&ye(g),r.callbackPriority=2,r.callbackNode=null,2}function a1(r,o){if(Qr!==0&&Qr!==5)return r.callbackNode=null,r.callbackPriority=0,null;var h=r.callbackNode;if(Nf()&&r.callbackNode!==h)return null;var g=Gn;return g=Zn(r,r===yr?g:0,r.cancelPendingCommit!==null||r.timeoutHandle!==-1),g===0?null:(Hw(r,g,o),o1(r,nt()),r.callbackNode!=null&&r.callbackNode===h?a1.bind(null,r):null)}function l1(r,o){if(Nf())return null;Hw(r,o,!0)}function ST(){jT(function(){(ir&6)!==0?at(j,_T):s1()})}function Jp(){if(ya===0){var r=Xl;r===0&&(r=Ft,Ft<<=1,(Ft&261888)===0&&(Ft=256)),ya=r}return ya}function c1(r){return r==null||typeof r=="symbol"||typeof r=="boolean"?null:typeof r=="function"?r:Fi(""+r)}function u1(r,o){var h=o.ownerDocument.createElement("input");return h.name=o.name,h.value=o.value,r.id&&h.setAttribute("form",r.id),o.parentNode.insertBefore(h,o),r=new FormData(r),h.parentNode.removeChild(h),r}function ET(r,o,h,g,E){if(o==="submit"&&h&&h.stateNode===E){var M=c1((E[vt]||null).action),X=g.submitter;X&&(o=(o=X[vt]||null)?c1(o.formAction):X.getAttribute("formAction"),o!==null&&(M=o,X=null));var ue=new zo("action","action",null,g,E);r.push({event:ue,listeners:[{instance:null,listener:function(){if(g.defaultPrevented){if(ya!==0){var De=X?u1(E,X):new FormData(E);yp(h,{pending:!0,data:De,method:E.method,action:M},null,De)}}else typeof M=="function"&&(ue.preventDefault(),De=X?u1(E,X):new FormData(E),yp(h,{pending:!0,data:De,method:E.method,action:M},M,De))},currentTarget:E}]})}}for(var Zp=0;Zp<xe.length;Zp++){var Xp=xe[Zp],CT=Xp.toLowerCase(),AT=Xp[0].toUpperCase()+Xp.slice(1);Se(CT,"on"+AT)}Se(st,"onAnimationEnd"),Se(ft,"onAnimationIteration"),Se(xt,"onAnimationStart"),Se("dblclick","onDoubleClick"),Se("focusin","onFocus"),Se("focusout","onBlur"),Se(Dt,"onTransitionRun"),Se(H,"onTransitionStart"),Se(F,"onTransitionCancel"),Se(ie,"onTransitionEnd"),en("onMouseEnter",["mouseout","mouseover"]),en("onMouseLeave",["mouseout","mouseover"]),en("onPointerEnter",["pointerout","pointerover"]),en("onPointerLeave",["pointerout","pointerover"]),Wt("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Wt("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Wt("onBeforeInput",["compositionend","keypress","textInput","paste"]),Wt("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Wt("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Wt("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var mu="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),kT=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(mu));function f1(r,o){o=(o&4)!==0;for(var h=0;h<r.length;h++){var g=r[h],E=g.event;g=g.listeners;e:{var M=void 0;if(o)for(var X=g.length-1;0<=X;X--){var ue=g[X],De=ue.instance,ut=ue.currentTarget;if(ue=ue.listener,De!==M&&E.isPropagationStopped())break e;M=ue,E.currentTarget=ut;try{M(E)}catch(Tt){Ne(Tt)}E.currentTarget=null,M=De}else for(X=0;X<g.length;X++){if(ue=g[X],De=ue.instance,ut=ue.currentTarget,ue=ue.listener,De!==M&&E.isPropagationStopped())break e;M=ue,E.currentTarget=ut;try{M(E)}catch(Tt){Ne(Tt)}E.currentTarget=null,M=De}}}}function Hn(r,o){var h=o[Yt];h===void 0&&(h=o[Yt]=new Set);var g=r+"__bubble";h.has(g)||(h1(o,r,2,!1),h.add(g))}function eg(r,o,h){var g=0;o&&(g|=4),h1(h,r,g,o)}var Df="_reactListening"+Math.random().toString(36).slice(2);function tg(r){if(!r[Df]){r[Df]=!0,Xt.forEach(function(h){h!=="selectionchange"&&(kT.has(h)||eg(h,!1,r),eg(h,!0,r))});var o=r.nodeType===9?r:r.ownerDocument;o===null||o[Df]||(o[Df]=!0,eg("selectionchange",!1,o))}}function h1(r,o,h,g){switch(F1(o)){case 2:var E=t3;break;case 8:E=n3;break;default:E=mg}h=E.bind(null,o,h,r),E=void 0,!Fo||o!=="touchstart"&&o!=="touchmove"&&o!=="wheel"||(E=!0),g?E!==void 0?r.addEventListener(o,h,{capture:!0,passive:E}):r.addEventListener(o,h,!0):E!==void 0?r.addEventListener(o,h,{passive:E}):r.addEventListener(o,h,!1)}function ng(r,o,h,g,E){var M=g;if((o&1)===0&&(o&2)===0&&g!==null)e:for(;;){if(g===null)return;var X=g.tag;if(X===3||X===4){var ue=g.stateNode.containerInfo;if(ue===E)break;if(X===4)for(X=g.return;X!==null;){var De=X.tag;if((De===3||De===4)&&X.stateNode.containerInfo===E)return;X=X.return}for(;ue!==null;){if(X=xn(ue),X===null)return;if(De=X.tag,De===5||De===6||De===26||De===27){g=M=X;continue e}ue=ue.parentNode}}g=g.return}Cs(function(){var ut=M,Tt=qo(h),Lt=[];e:{var dt=he.get(r);if(dt!==void 0){var wt=zo,un=r;switch(r){case"keypress":if(ks(h)===0)break e;case"keydown":case"keyup":wt=Wo;break;case"focusin":un="focus",wt=Ts;break;case"focusout":un="blur",wt=Ts;break;case"beforeblur":case"afterblur":wt=Ts;break;case"click":if(h.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":wt=Vo;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":wt=Ka;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":wt=Qa;break;case st:case ft:case xt:wt=Ll;break;case ie:wt=Ja;break;case"scroll":case"scrollend":wt=Go;break;case"wheel":wt=Jo;break;case"copy":case"cut":case"paste":wt=Ms;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":wt=Wa;break;case"toggle":case"beforetoggle":wt=ql}var Cn=(o&4)!==0,hr=!Cn&&(r==="scroll"||r==="scrollend"),tt=Cn?dt!==null?dt+"Capture":null:dt;Cn=[];for(var He=ut,ct;He!==null;){var Bt=He;if(ct=Bt.stateNode,Bt=Bt.tag,Bt!==5&&Bt!==26&&Bt!==27||ct===null||tt===null||(Bt=cs(He,tt),Bt!=null&&Cn.push(yu(He,Bt,ct))),hr)break;He=He.return}0<Cn.length&&(dt=new wt(dt,un,null,h,Tt),Lt.push({event:dt,listeners:Cn}))}}if((o&7)===0){e:{if(dt=r==="mouseover"||r==="pointerover",wt=r==="mouseout"||r==="pointerout",dt&&h!==Mi&&(un=h.relatedTarget||h.fromElement)&&(xn(un)||un[Nt]))break e;if((wt||dt)&&(dt=Tt.window===Tt?Tt:(dt=Tt.ownerDocument)?dt.defaultView||dt.parentWindow:window,wt?(un=h.relatedTarget||h.toElement,wt=ut,un=un?xn(un):null,un!==null&&(hr=a(un),Cn=un.tag,un!==hr||Cn!==5&&Cn!==27&&Cn!==6)&&(un=null)):(wt=null,un=ut),wt!==un)){if(Cn=Vo,Bt="onMouseLeave",tt="onMouseEnter",He="mouse",(r==="pointerout"||r==="pointerover")&&(Cn=Wa,Bt="onPointerLeave",tt="onPointerEnter",He="pointer"),hr=wt==null?dt:dn(wt),ct=un==null?dt:dn(un),dt=new Cn(Bt,He+"leave",wt,h,Tt),dt.target=hr,dt.relatedTarget=ct,Bt=null,xn(Tt)===ut&&(Cn=new Cn(tt,He+"enter",un,h,Tt),Cn.target=ct,Cn.relatedTarget=hr,Bt=Cn),hr=Bt,wt&&un)t:{for(Cn=TT,tt=wt,He=un,ct=0,Bt=tt;Bt;Bt=Cn(Bt))ct++;Bt=0;for(var Sn=He;Sn;Sn=Cn(Sn))Bt++;for(;0<ct-Bt;)tt=Cn(tt),ct--;for(;0<Bt-ct;)He=Cn(He),Bt--;for(;ct--;){if(tt===He||He!==null&&tt===He.alternate){Cn=tt;break t}tt=Cn(tt),He=Cn(He)}Cn=null}else Cn=null;wt!==null&&d1(Lt,dt,wt,Cn,!1),un!==null&&hr!==null&&d1(Lt,hr,un,Cn,!0)}}e:{if(dt=ut?dn(ut):window,wt=dt.nodeName&&dt.nodeName.toLowerCase(),wt==="select"||wt==="input"&&dt.type==="file")var er=eo;else if(Zo(dt))if(Ri)er=Os;else{er=ms;var yn=Vl}else wt=dt.nodeName,!wt||wt.toLowerCase()!=="input"||dt.type!=="checkbox"&&dt.type!=="radio"?ut&&br(ut.elementType)&&(er=eo):er=tl;if(er&&(er=er(r,ut))){el(Lt,er,h,Tt);break e}yn&&yn(r,dt,ut),r==="focusout"&&ut&&dt.type==="number"&&ut.memoizedProps.value!=null&&On(dt,"number",dt.value)}switch(yn=ut?dn(ut):window,r){case"focusin":(Zo(yn)||yn.contentEditable==="true")&&(Re=yn,Ue=ut,qe=null);break;case"focusout":qe=Ue=Re=null;break;case"mousedown":We=!0;break;case"contextmenu":case"mouseup":case"dragend":We=!1,je(Lt,h,Tt);break;case"selectionchange":if(_e)break;case"keydown":case"keyup":je(Lt,h,Tt)}var Ln;if(Js)e:{switch(r){case"compositionstart":var Kn="onCompositionStart";break e;case"compositionend":Kn="onCompositionEnd";break e;case"compositionupdate":Kn="onCompositionUpdate";break e}Kn=void 0}else gs?jn(r,h)&&(Kn="onCompositionEnd"):r==="keydown"&&h.keyCode===229&&(Kn="onCompositionStart");Kn&&(Ii&&h.locale!=="ko"&&(gs||Kn!=="onCompositionStart"?Kn==="onCompositionEnd"&&gs&&(Ln=us()):(Si=Tt,Ho="value"in Si?Si.value:Si.textContent,gs=!0)),yn=Pf(ut,Kn),0<yn.length&&(Kn=new Yo(Kn,r,null,h,Tt),Lt.push({event:Kn,listeners:yn}),Ln?Kn.data=Ln:(Ln=Hl(h),Ln!==null&&(Kn.data=Ln)))),(Ln=zc?zl(r,h):Gc(r,h))&&(Kn=Pf(ut,"onBeforeInput"),0<Kn.length&&(yn=new Yo("onBeforeInput","beforeinput",null,h,Tt),Lt.push({event:yn,listeners:Kn}),yn.data=Ln)),ET(Lt,r,ut,h,Tt)}f1(Lt,o)})}function yu(r,o,h){return{instance:r,listener:o,currentTarget:h}}function Pf(r,o){for(var h=o+"Capture",g=[];r!==null;){var E=r,M=E.stateNode;if(E=E.tag,E!==5&&E!==26&&E!==27||M===null||(E=cs(r,h),E!=null&&g.unshift(yu(r,E,M)),E=cs(r,o),E!=null&&g.push(yu(r,E,M))),r.tag===3)return g;r=r.return}return[]}function TT(r){if(r===null)return null;do r=r.return;while(r&&r.tag!==5&&r.tag!==27);return r||null}function d1(r,o,h,g,E){for(var M=o._reactName,X=[];h!==null&&h!==g;){var ue=h,De=ue.alternate,ut=ue.stateNode;if(ue=ue.tag,De!==null&&De===g)break;ue!==5&&ue!==26&&ue!==27||ut===null||(De=ut,E?(ut=cs(h,M),ut!=null&&X.unshift(yu(h,ut,De))):E||(ut=cs(h,M),ut!=null&&X.push(yu(h,ut,De)))),h=h.return}X.length!==0&&r.push({event:o,listeners:X})}var MT=/\r\n?/g,IT=/\u0000|\uFFFD/g;function p1(r){return(typeof r=="string"?r:""+r).replace(MT,`
`).replace(IT,"")}function g1(r,o){return o=p1(o),p1(r)===o}function fr(r,o,h,g,E,M){switch(h){case"children":typeof g=="string"?o==="body"||o==="textarea"&&g===""||Vn(r,g):(typeof g=="number"||typeof g=="bigint")&&o!=="body"&&Vn(r,""+g);break;case"className":kt(r,"class",g);break;case"tabIndex":kt(r,"tabindex",g);break;case"dir":case"role":case"viewBox":case"width":case"height":kt(r,h,g);break;case"style":Jn(r,g,M);break;case"data":if(o!=="object"){kt(r,"data",g);break}case"src":case"href":if(g===""&&(o!=="a"||h!=="href")){r.removeAttribute(h);break}if(g==null||typeof g=="function"||typeof g=="symbol"||typeof g=="boolean"){r.removeAttribute(h);break}g=Fi(""+g),r.setAttribute(h,g);break;case"action":case"formAction":if(typeof g=="function"){r.setAttribute(h,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof M=="function"&&(h==="formAction"?(o!=="input"&&fr(r,o,"name",E.name,E,null),fr(r,o,"formEncType",E.formEncType,E,null),fr(r,o,"formMethod",E.formMethod,E,null),fr(r,o,"formTarget",E.formTarget,E,null)):(fr(r,o,"encType",E.encType,E,null),fr(r,o,"method",E.method,E,null),fr(r,o,"target",E.target,E,null)));if(g==null||typeof g=="symbol"||typeof g=="boolean"){r.removeAttribute(h);break}g=Fi(""+g),r.setAttribute(h,g);break;case"onClick":g!=null&&(r.onclick=fi);break;case"onScroll":g!=null&&Hn("scroll",r);break;case"onScrollEnd":g!=null&&Hn("scrollend",r);break;case"dangerouslySetInnerHTML":if(g!=null){if(typeof g!="object"||!("__html"in g))throw Error(n(61));if(h=g.__html,h!=null){if(E.children!=null)throw Error(n(60));r.innerHTML=h}}break;case"multiple":r.multiple=g&&typeof g!="function"&&typeof g!="symbol";break;case"muted":r.muted=g&&typeof g!="function"&&typeof g!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(g==null||typeof g=="function"||typeof g=="boolean"||typeof g=="symbol"){r.removeAttribute("xlink:href");break}h=Fi(""+g),r.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",h);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":g!=null&&typeof g!="function"&&typeof g!="symbol"?r.setAttribute(h,""+g):r.removeAttribute(h);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":g&&typeof g!="function"&&typeof g!="symbol"?r.setAttribute(h,""):r.removeAttribute(h);break;case"capture":case"download":g===!0?r.setAttribute(h,""):g!==!1&&g!=null&&typeof g!="function"&&typeof g!="symbol"?r.setAttribute(h,g):r.removeAttribute(h);break;case"cols":case"rows":case"size":case"span":g!=null&&typeof g!="function"&&typeof g!="symbol"&&!isNaN(g)&&1<=g?r.setAttribute(h,g):r.removeAttribute(h);break;case"rowSpan":case"start":g==null||typeof g=="function"||typeof g=="symbol"||isNaN(g)?r.removeAttribute(h):r.setAttribute(h,g);break;case"popover":Hn("beforetoggle",r),Hn("toggle",r),bt(r,"popover",g);break;case"xlinkActuate":Ct(r,"http://www.w3.org/1999/xlink","xlink:actuate",g);break;case"xlinkArcrole":Ct(r,"http://www.w3.org/1999/xlink","xlink:arcrole",g);break;case"xlinkRole":Ct(r,"http://www.w3.org/1999/xlink","xlink:role",g);break;case"xlinkShow":Ct(r,"http://www.w3.org/1999/xlink","xlink:show",g);break;case"xlinkTitle":Ct(r,"http://www.w3.org/1999/xlink","xlink:title",g);break;case"xlinkType":Ct(r,"http://www.w3.org/1999/xlink","xlink:type",g);break;case"xmlBase":Ct(r,"http://www.w3.org/XML/1998/namespace","xml:base",g);break;case"xmlLang":Ct(r,"http://www.w3.org/XML/1998/namespace","xml:lang",g);break;case"xmlSpace":Ct(r,"http://www.w3.org/XML/1998/namespace","xml:space",g);break;case"is":bt(r,"is",g);break;case"innerText":case"textContent":break;default:(!(2<h.length)||h[0]!=="o"&&h[0]!=="O"||h[1]!=="n"&&h[1]!=="N")&&(h=sr.get(h)||h,bt(r,h,g))}}function rg(r,o,h,g,E,M){switch(h){case"style":Jn(r,g,M);break;case"dangerouslySetInnerHTML":if(g!=null){if(typeof g!="object"||!("__html"in g))throw Error(n(61));if(h=g.__html,h!=null){if(E.children!=null)throw Error(n(60));r.innerHTML=h}}break;case"children":typeof g=="string"?Vn(r,g):(typeof g=="number"||typeof g=="bigint")&&Vn(r,""+g);break;case"onScroll":g!=null&&Hn("scroll",r);break;case"onScrollEnd":g!=null&&Hn("scrollend",r);break;case"onClick":g!=null&&(r.onclick=fi);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!ln.hasOwnProperty(h))e:{if(h[0]==="o"&&h[1]==="n"&&(E=h.endsWith("Capture"),o=h.slice(2,E?h.length-7:void 0),M=r[vt]||null,M=M!=null?M[h]:null,typeof M=="function"&&r.removeEventListener(o,M,E),typeof g=="function")){typeof M!="function"&&M!==null&&(h in r?r[h]=null:r.hasAttribute(h)&&r.removeAttribute(h)),r.addEventListener(o,g,E);break e}h in r?r[h]=g:g===!0?r.setAttribute(h,""):bt(r,h,g)}}}function ai(r,o,h){switch(o){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Hn("error",r),Hn("load",r);var g=!1,E=!1,M;for(M in h)if(h.hasOwnProperty(M)){var X=h[M];if(X!=null)switch(M){case"src":g=!0;break;case"srcSet":E=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(n(137,o));default:fr(r,o,M,X,h,null)}}E&&fr(r,o,"srcSet",h.srcSet,h,null),g&&fr(r,o,"src",h.src,h,null);return;case"input":Hn("invalid",r);var ue=M=X=E=null,De=null,ut=null;for(g in h)if(h.hasOwnProperty(g)){var Tt=h[g];if(Tt!=null)switch(g){case"name":E=Tt;break;case"type":X=Tt;break;case"checked":De=Tt;break;case"defaultChecked":ut=Tt;break;case"value":M=Tt;break;case"defaultValue":ue=Tt;break;case"children":case"dangerouslySetInnerHTML":if(Tt!=null)throw Error(n(137,o));break;default:fr(r,o,g,Tt,h,null)}}In(r,M,ue,De,ut,X,E,!1);return;case"select":Hn("invalid",r),g=X=M=null;for(E in h)if(h.hasOwnProperty(E)&&(ue=h[E],ue!=null))switch(E){case"value":M=ue;break;case"defaultValue":X=ue;break;case"multiple":g=ue;default:fr(r,o,E,ue,h,null)}o=M,h=X,r.multiple=!!g,o!=null?Rn(r,!!g,o,!1):h!=null&&Rn(r,!!g,h,!0);return;case"textarea":Hn("invalid",r),M=E=g=null;for(X in h)if(h.hasOwnProperty(X)&&(ue=h[X],ue!=null))switch(X){case"value":g=ue;break;case"defaultValue":E=ue;break;case"children":M=ue;break;case"dangerouslySetInnerHTML":if(ue!=null)throw Error(n(91));break;default:fr(r,o,X,ue,h,null)}qn(r,g,E,M);return;case"option":for(De in h)if(h.hasOwnProperty(De)&&(g=h[De],g!=null))switch(De){case"selected":r.selected=g&&typeof g!="function"&&typeof g!="symbol";break;default:fr(r,o,De,g,h,null)}return;case"dialog":Hn("beforetoggle",r),Hn("toggle",r),Hn("cancel",r),Hn("close",r);break;case"iframe":case"object":Hn("load",r);break;case"video":case"audio":for(g=0;g<mu.length;g++)Hn(mu[g],r);break;case"image":Hn("error",r),Hn("load",r);break;case"details":Hn("toggle",r);break;case"embed":case"source":case"link":Hn("error",r),Hn("load",r);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(ut in h)if(h.hasOwnProperty(ut)&&(g=h[ut],g!=null))switch(ut){case"children":case"dangerouslySetInnerHTML":throw Error(n(137,o));default:fr(r,o,ut,g,h,null)}return;default:if(br(o)){for(Tt in h)h.hasOwnProperty(Tt)&&(g=h[Tt],g!==void 0&&rg(r,o,Tt,g,h,void 0));return}}for(ue in h)h.hasOwnProperty(ue)&&(g=h[ue],g!=null&&fr(r,o,ue,g,h,null))}function RT(r,o,h,g){switch(o){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var E=null,M=null,X=null,ue=null,De=null,ut=null,Tt=null;for(wt in h){var Lt=h[wt];if(h.hasOwnProperty(wt)&&Lt!=null)switch(wt){case"checked":break;case"value":break;case"defaultValue":De=Lt;default:g.hasOwnProperty(wt)||fr(r,o,wt,null,g,Lt)}}for(var dt in g){var wt=g[dt];if(Lt=h[dt],g.hasOwnProperty(dt)&&(wt!=null||Lt!=null))switch(dt){case"type":M=wt;break;case"name":E=wt;break;case"checked":ut=wt;break;case"defaultChecked":Tt=wt;break;case"value":X=wt;break;case"defaultValue":ue=wt;break;case"children":case"dangerouslySetInnerHTML":if(wt!=null)throw Error(n(137,o));break;default:wt!==Lt&&fr(r,o,dt,wt,g,Lt)}}Mn(r,X,ue,De,ut,Tt,M,E);return;case"select":wt=X=ue=dt=null;for(M in h)if(De=h[M],h.hasOwnProperty(M)&&De!=null)switch(M){case"value":break;case"multiple":wt=De;default:g.hasOwnProperty(M)||fr(r,o,M,null,g,De)}for(E in g)if(M=g[E],De=h[E],g.hasOwnProperty(E)&&(M!=null||De!=null))switch(E){case"value":dt=M;break;case"defaultValue":ue=M;break;case"multiple":X=M;default:M!==De&&fr(r,o,E,M,g,De)}o=ue,h=X,g=wt,dt!=null?Rn(r,!!h,dt,!1):!!g!=!!h&&(o!=null?Rn(r,!!h,o,!0):Rn(r,!!h,h?[]:"",!1));return;case"textarea":wt=dt=null;for(ue in h)if(E=h[ue],h.hasOwnProperty(ue)&&E!=null&&!g.hasOwnProperty(ue))switch(ue){case"value":break;case"children":break;default:fr(r,o,ue,null,g,E)}for(X in g)if(E=g[X],M=h[X],g.hasOwnProperty(X)&&(E!=null||M!=null))switch(X){case"value":dt=E;break;case"defaultValue":wt=E;break;case"children":break;case"dangerouslySetInnerHTML":if(E!=null)throw Error(n(91));break;default:E!==M&&fr(r,o,X,E,g,M)}rr(r,dt,wt);return;case"option":for(var un in h)if(dt=h[un],h.hasOwnProperty(un)&&dt!=null&&!g.hasOwnProperty(un))switch(un){case"selected":r.selected=!1;break;default:fr(r,o,un,null,g,dt)}for(De in g)if(dt=g[De],wt=h[De],g.hasOwnProperty(De)&&dt!==wt&&(dt!=null||wt!=null))switch(De){case"selected":r.selected=dt&&typeof dt!="function"&&typeof dt!="symbol";break;default:fr(r,o,De,dt,g,wt)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Cn in h)dt=h[Cn],h.hasOwnProperty(Cn)&&dt!=null&&!g.hasOwnProperty(Cn)&&fr(r,o,Cn,null,g,dt);for(ut in g)if(dt=g[ut],wt=h[ut],g.hasOwnProperty(ut)&&dt!==wt&&(dt!=null||wt!=null))switch(ut){case"children":case"dangerouslySetInnerHTML":if(dt!=null)throw Error(n(137,o));break;default:fr(r,o,ut,dt,g,wt)}return;default:if(br(o)){for(var hr in h)dt=h[hr],h.hasOwnProperty(hr)&&dt!==void 0&&!g.hasOwnProperty(hr)&&rg(r,o,hr,void 0,g,dt);for(Tt in g)dt=g[Tt],wt=h[Tt],!g.hasOwnProperty(Tt)||dt===wt||dt===void 0&&wt===void 0||rg(r,o,Tt,dt,g,wt);return}}for(var tt in h)dt=h[tt],h.hasOwnProperty(tt)&&dt!=null&&!g.hasOwnProperty(tt)&&fr(r,o,tt,null,g,dt);for(Lt in g)dt=g[Lt],wt=h[Lt],!g.hasOwnProperty(Lt)||dt===wt||dt==null&&wt==null||fr(r,o,Lt,dt,g,wt)}function m1(r){switch(r){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function OT(){if(typeof performance.getEntriesByType=="function"){for(var r=0,o=0,h=performance.getEntriesByType("resource"),g=0;g<h.length;g++){var E=h[g],M=E.transferSize,X=E.initiatorType,ue=E.duration;if(M&&ue&&m1(X)){for(X=0,ue=E.responseEnd,g+=1;g<h.length;g++){var De=h[g],ut=De.startTime;if(ut>ue)break;var Tt=De.transferSize,Lt=De.initiatorType;Tt&&m1(Lt)&&(De=De.responseEnd,X+=Tt*(De<ue?1:(ue-ut)/(De-ut)))}if(--g,o+=8*(M+X)/(E.duration/1e3),r++,10<r)break}}if(0<r)return o/r/1e6}return navigator.connection&&(r=navigator.connection.downlink,typeof r=="number")?r:5}var ig=null,sg=null;function Lf(r){return r.nodeType===9?r:r.ownerDocument}function y1(r){switch(r){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function b1(r,o){if(r===0)switch(o){case"svg":return 1;case"math":return 2;default:return 0}return r===1&&o==="foreignObject"?0:r}function og(r,o){return r==="textarea"||r==="noscript"||typeof o.children=="string"||typeof o.children=="number"||typeof o.children=="bigint"||typeof o.dangerouslySetInnerHTML=="object"&&o.dangerouslySetInnerHTML!==null&&o.dangerouslySetInnerHTML.__html!=null}var ag=null;function NT(){var r=window.event;return r&&r.type==="popstate"?r===ag?!1:(ag=r,!0):(ag=null,!1)}var v1=typeof setTimeout=="function"?setTimeout:void 0,BT=typeof clearTimeout=="function"?clearTimeout:void 0,w1=typeof Promise=="function"?Promise:void 0,jT=typeof queueMicrotask=="function"?queueMicrotask:typeof w1<"u"?function(r){return w1.resolve(null).then(r).catch(DT)}:v1;function DT(r){setTimeout(function(){throw r})}function ba(r){return r==="head"}function x1(r,o){var h=o,g=0;do{var E=h.nextSibling;if(r.removeChild(h),E&&E.nodeType===8)if(h=E.data,h==="/$"||h==="/&"){if(g===0){r.removeChild(E),bc(o);return}g--}else if(h==="$"||h==="$?"||h==="$~"||h==="$!"||h==="&")g++;else if(h==="html")bu(r.ownerDocument.documentElement);else if(h==="head"){h=r.ownerDocument.head,bu(h);for(var M=h.firstChild;M;){var X=M.nextSibling,ue=M.nodeName;M[sn]||ue==="SCRIPT"||ue==="STYLE"||ue==="LINK"&&M.rel.toLowerCase()==="stylesheet"||h.removeChild(M),M=X}}else h==="body"&&bu(r.ownerDocument.body);h=E}while(h);bc(o)}function _1(r,o){var h=r;r=0;do{var g=h.nextSibling;if(h.nodeType===1?o?(h._stashedDisplay=h.style.display,h.style.display="none"):(h.style.display=h._stashedDisplay||"",h.getAttribute("style")===""&&h.removeAttribute("style")):h.nodeType===3&&(o?(h._stashedText=h.nodeValue,h.nodeValue=""):h.nodeValue=h._stashedText||""),g&&g.nodeType===8)if(h=g.data,h==="/$"){if(r===0)break;r--}else h!=="$"&&h!=="$?"&&h!=="$~"&&h!=="$!"||r++;h=g}while(h)}function lg(r){var o=r.firstChild;for(o&&o.nodeType===10&&(o=o.nextSibling);o;){var h=o;switch(o=o.nextSibling,h.nodeName){case"HTML":case"HEAD":case"BODY":lg(h),wn(h);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(h.rel.toLowerCase()==="stylesheet")continue}r.removeChild(h)}}function PT(r,o,h,g){for(;r.nodeType===1;){var E=h;if(r.nodeName.toLowerCase()!==o.toLowerCase()){if(!g&&(r.nodeName!=="INPUT"||r.type!=="hidden"))break}else if(g){if(!r[sn])switch(o){case"meta":if(!r.hasAttribute("itemprop"))break;return r;case"link":if(M=r.getAttribute("rel"),M==="stylesheet"&&r.hasAttribute("data-precedence"))break;if(M!==E.rel||r.getAttribute("href")!==(E.href==null||E.href===""?null:E.href)||r.getAttribute("crossorigin")!==(E.crossOrigin==null?null:E.crossOrigin)||r.getAttribute("title")!==(E.title==null?null:E.title))break;return r;case"style":if(r.hasAttribute("data-precedence"))break;return r;case"script":if(M=r.getAttribute("src"),(M!==(E.src==null?null:E.src)||r.getAttribute("type")!==(E.type==null?null:E.type)||r.getAttribute("crossorigin")!==(E.crossOrigin==null?null:E.crossOrigin))&&M&&r.hasAttribute("async")&&!r.hasAttribute("itemprop"))break;return r;default:return r}}else if(o==="input"&&r.type==="hidden"){var M=E.name==null?null:""+E.name;if(E.type==="hidden"&&r.getAttribute("name")===M)return r}else return r;if(r=es(r.nextSibling),r===null)break}return null}function LT(r,o,h){if(o==="")return null;for(;r.nodeType!==3;)if((r.nodeType!==1||r.nodeName!=="INPUT"||r.type!=="hidden")&&!h||(r=es(r.nextSibling),r===null))return null;return r}function S1(r,o){for(;r.nodeType!==8;)if((r.nodeType!==1||r.nodeName!=="INPUT"||r.type!=="hidden")&&!o||(r=es(r.nextSibling),r===null))return null;return r}function cg(r){return r.data==="$?"||r.data==="$~"}function ug(r){return r.data==="$!"||r.data==="$?"&&r.ownerDocument.readyState!=="loading"}function UT(r,o){var h=r.ownerDocument;if(r.data==="$~")r._reactRetry=o;else if(r.data!=="$?"||h.readyState!=="loading")o();else{var g=function(){o(),h.removeEventListener("DOMContentLoaded",g)};h.addEventListener("DOMContentLoaded",g),r._reactRetry=g}}function es(r){for(;r!=null;r=r.nextSibling){var o=r.nodeType;if(o===1||o===3)break;if(o===8){if(o=r.data,o==="$"||o==="$!"||o==="$?"||o==="$~"||o==="&"||o==="F!"||o==="F")break;if(o==="/$"||o==="/&")return null}}return r}var fg=null;function E1(r){r=r.nextSibling;for(var o=0;r;){if(r.nodeType===8){var h=r.data;if(h==="/$"||h==="/&"){if(o===0)return es(r.nextSibling);o--}else h!=="$"&&h!=="$!"&&h!=="$?"&&h!=="$~"&&h!=="&"||o++}r=r.nextSibling}return null}function C1(r){r=r.previousSibling;for(var o=0;r;){if(r.nodeType===8){var h=r.data;if(h==="$"||h==="$!"||h==="$?"||h==="$~"||h==="&"){if(o===0)return r;o--}else h!=="/$"&&h!=="/&"||o++}r=r.previousSibling}return null}function A1(r,o,h){switch(o=Lf(h),r){case"html":if(r=o.documentElement,!r)throw Error(n(452));return r;case"head":if(r=o.head,!r)throw Error(n(453));return r;case"body":if(r=o.body,!r)throw Error(n(454));return r;default:throw Error(n(451))}}function bu(r){for(var o=r.attributes;o.length;)r.removeAttributeNode(o[0]);wn(r)}var ts=new Map,k1=new Set;function Uf(r){return typeof r.getRootNode=="function"?r.getRootNode():r.nodeType===9?r:r.ownerDocument}var go=ne.d;ne.d={f:qT,r:FT,D:HT,C:zT,L:GT,m:KT,X:$T,S:VT,M:YT};function qT(){var r=go.f(),o=If();return r||o}function FT(r){var o=tn(r);o!==null&&o.tag===5&&o.type==="form"?Gv(o):go.r(r)}var gc=typeof document>"u"?null:document;function T1(r,o,h){var g=gc;if(g&&typeof o=="string"&&o){var E=_n(o);E='link[rel="'+r+'"][href="'+E+'"]',typeof h=="string"&&(E+='[crossorigin="'+h+'"]'),k1.has(E)||(k1.add(E),r={rel:r,crossOrigin:h,href:o},g.querySelector(E)===null&&(o=g.createElement("link"),ai(o,"link",r),on(o),g.head.appendChild(o)))}}function HT(r){go.D(r),T1("dns-prefetch",r,null)}function zT(r,o){go.C(r,o),T1("preconnect",r,o)}function GT(r,o,h){go.L(r,o,h);var g=gc;if(g&&r&&o){var E='link[rel="preload"][as="'+_n(o)+'"]';o==="image"&&h&&h.imageSrcSet?(E+='[imagesrcset="'+_n(h.imageSrcSet)+'"]',typeof h.imageSizes=="string"&&(E+='[imagesizes="'+_n(h.imageSizes)+'"]')):E+='[href="'+_n(r)+'"]';var M=E;switch(o){case"style":M=mc(r);break;case"script":M=yc(r)}ts.has(M)||(r=p({rel:"preload",href:o==="image"&&h&&h.imageSrcSet?void 0:r,as:o},h),ts.set(M,r),g.querySelector(E)!==null||o==="style"&&g.querySelector(vu(M))||o==="script"&&g.querySelector(wu(M))||(o=g.createElement("link"),ai(o,"link",r),on(o),g.head.appendChild(o)))}}function KT(r,o){go.m(r,o);var h=gc;if(h&&r){var g=o&&typeof o.as=="string"?o.as:"script",E='link[rel="modulepreload"][as="'+_n(g)+'"][href="'+_n(r)+'"]',M=E;switch(g){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":M=yc(r)}if(!ts.has(M)&&(r=p({rel:"modulepreload",href:r},o),ts.set(M,r),h.querySelector(E)===null)){switch(g){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(h.querySelector(wu(M)))return}g=h.createElement("link"),ai(g,"link",r),on(g),h.head.appendChild(g)}}}function VT(r,o,h){go.S(r,o,h);var g=gc;if(g&&r){var E=cn(g).hoistableStyles,M=mc(r);o=o||"default";var X=E.get(M);if(!X){var ue={loading:0,preload:null};if(X=g.querySelector(vu(M)))ue.loading=5;else{r=p({rel:"stylesheet",href:r,"data-precedence":o},h),(h=ts.get(M))&&hg(r,h);var De=X=g.createElement("link");on(De),ai(De,"link",r),De._p=new Promise(function(ut,Tt){De.onload=ut,De.onerror=Tt}),De.addEventListener("load",function(){ue.loading|=1}),De.addEventListener("error",function(){ue.loading|=2}),ue.loading|=4,qf(X,o,g)}X={type:"stylesheet",instance:X,count:1,state:ue},E.set(M,X)}}}function $T(r,o){go.X(r,o);var h=gc;if(h&&r){var g=cn(h).hoistableScripts,E=yc(r),M=g.get(E);M||(M=h.querySelector(wu(E)),M||(r=p({src:r,async:!0},o),(o=ts.get(E))&&dg(r,o),M=h.createElement("script"),on(M),ai(M,"link",r),h.head.appendChild(M)),M={type:"script",instance:M,count:1,state:null},g.set(E,M))}}function YT(r,o){go.M(r,o);var h=gc;if(h&&r){var g=cn(h).hoistableScripts,E=yc(r),M=g.get(E);M||(M=h.querySelector(wu(E)),M||(r=p({src:r,async:!0,type:"module"},o),(o=ts.get(E))&&dg(r,o),M=h.createElement("script"),on(M),ai(M,"link",r),h.head.appendChild(M)),M={type:"script",instance:M,count:1,state:null},g.set(E,M))}}function M1(r,o,h,g){var E=(E=Ge.current)?Uf(E):null;if(!E)throw Error(n(446));switch(r){case"meta":case"title":return null;case"style":return typeof h.precedence=="string"&&typeof h.href=="string"?(o=mc(h.href),h=cn(E).hoistableStyles,g=h.get(o),g||(g={type:"style",instance:null,count:0,state:null},h.set(o,g)),g):{type:"void",instance:null,count:0,state:null};case"link":if(h.rel==="stylesheet"&&typeof h.href=="string"&&typeof h.precedence=="string"){r=mc(h.href);var M=cn(E).hoistableStyles,X=M.get(r);if(X||(E=E.ownerDocument||E,X={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},M.set(r,X),(M=E.querySelector(vu(r)))&&!M._p&&(X.instance=M,X.state.loading=5),ts.has(r)||(h={rel:"preload",as:"style",href:h.href,crossOrigin:h.crossOrigin,integrity:h.integrity,media:h.media,hrefLang:h.hrefLang,referrerPolicy:h.referrerPolicy},ts.set(r,h),M||WT(E,r,h,X.state))),o&&g===null)throw Error(n(528,""));return X}if(o&&g!==null)throw Error(n(529,""));return null;case"script":return o=h.async,h=h.src,typeof h=="string"&&o&&typeof o!="function"&&typeof o!="symbol"?(o=yc(h),h=cn(E).hoistableScripts,g=h.get(o),g||(g={type:"script",instance:null,count:0,state:null},h.set(o,g)),g):{type:"void",instance:null,count:0,state:null};default:throw Error(n(444,r))}}function mc(r){return'href="'+_n(r)+'"'}function vu(r){return'link[rel="stylesheet"]['+r+"]"}function I1(r){return p({},r,{"data-precedence":r.precedence,precedence:null})}function WT(r,o,h,g){r.querySelector('link[rel="preload"][as="style"]['+o+"]")?g.loading=1:(o=r.createElement("link"),g.preload=o,o.addEventListener("load",function(){return g.loading|=1}),o.addEventListener("error",function(){return g.loading|=2}),ai(o,"link",h),on(o),r.head.appendChild(o))}function yc(r){return'[src="'+_n(r)+'"]'}function wu(r){return"script[async]"+r}function R1(r,o,h){if(o.count++,o.instance===null)switch(o.type){case"style":var g=r.querySelector('style[data-href~="'+_n(h.href)+'"]');if(g)return o.instance=g,on(g),g;var E=p({},h,{"data-href":h.href,"data-precedence":h.precedence,href:null,precedence:null});return g=(r.ownerDocument||r).createElement("style"),on(g),ai(g,"style",E),qf(g,h.precedence,r),o.instance=g;case"stylesheet":E=mc(h.href);var M=r.querySelector(vu(E));if(M)return o.state.loading|=4,o.instance=M,on(M),M;g=I1(h),(E=ts.get(E))&&hg(g,E),M=(r.ownerDocument||r).createElement("link"),on(M);var X=M;return X._p=new Promise(function(ue,De){X.onload=ue,X.onerror=De}),ai(M,"link",g),o.state.loading|=4,qf(M,h.precedence,r),o.instance=M;case"script":return M=yc(h.src),(E=r.querySelector(wu(M)))?(o.instance=E,on(E),E):(g=h,(E=ts.get(M))&&(g=p({},h),dg(g,E)),r=r.ownerDocument||r,E=r.createElement("script"),on(E),ai(E,"link",g),r.head.appendChild(E),o.instance=E);case"void":return null;default:throw Error(n(443,o.type))}else o.type==="stylesheet"&&(o.state.loading&4)===0&&(g=o.instance,o.state.loading|=4,qf(g,h.precedence,r));return o.instance}function qf(r,o,h){for(var g=h.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),E=g.length?g[g.length-1]:null,M=E,X=0;X<g.length;X++){var ue=g[X];if(ue.dataset.precedence===o)M=ue;else if(M!==E)break}M?M.parentNode.insertBefore(r,M.nextSibling):(o=h.nodeType===9?h.head:h,o.insertBefore(r,o.firstChild))}function hg(r,o){r.crossOrigin==null&&(r.crossOrigin=o.crossOrigin),r.referrerPolicy==null&&(r.referrerPolicy=o.referrerPolicy),r.title==null&&(r.title=o.title)}function dg(r,o){r.crossOrigin==null&&(r.crossOrigin=o.crossOrigin),r.referrerPolicy==null&&(r.referrerPolicy=o.referrerPolicy),r.integrity==null&&(r.integrity=o.integrity)}var Ff=null;function O1(r,o,h){if(Ff===null){var g=new Map,E=Ff=new Map;E.set(h,g)}else E=Ff,g=E.get(h),g||(g=new Map,E.set(h,g));if(g.has(r))return g;for(g.set(r,null),h=h.getElementsByTagName(r),E=0;E<h.length;E++){var M=h[E];if(!(M[sn]||M[ze]||r==="link"&&M.getAttribute("rel")==="stylesheet")&&M.namespaceURI!=="http://www.w3.org/2000/svg"){var X=M.getAttribute(o)||"";X=r+X;var ue=g.get(X);ue?ue.push(M):g.set(X,[M])}}return g}function N1(r,o,h){r=r.ownerDocument||r,r.head.insertBefore(h,o==="title"?r.querySelector("head > title"):null)}function QT(r,o,h){if(h===1||o.itemProp!=null)return!1;switch(r){case"meta":case"title":return!0;case"style":if(typeof o.precedence!="string"||typeof o.href!="string"||o.href==="")break;return!0;case"link":if(typeof o.rel!="string"||typeof o.href!="string"||o.href===""||o.onLoad||o.onError)break;switch(o.rel){case"stylesheet":return r=o.disabled,typeof o.precedence=="string"&&r==null;default:return!0}case"script":if(o.async&&typeof o.async!="function"&&typeof o.async!="symbol"&&!o.onLoad&&!o.onError&&o.src&&typeof o.src=="string")return!0}return!1}function B1(r){return!(r.type==="stylesheet"&&(r.state.loading&3)===0)}function JT(r,o,h,g){if(h.type==="stylesheet"&&(typeof g.media!="string"||matchMedia(g.media).matches!==!1)&&(h.state.loading&4)===0){if(h.instance===null){var E=mc(g.href),M=o.querySelector(vu(E));if(M){o=M._p,o!==null&&typeof o=="object"&&typeof o.then=="function"&&(r.count++,r=Hf.bind(r),o.then(r,r)),h.state.loading|=4,h.instance=M,on(M);return}M=o.ownerDocument||o,g=I1(g),(E=ts.get(E))&&hg(g,E),M=M.createElement("link"),on(M);var X=M;X._p=new Promise(function(ue,De){X.onload=ue,X.onerror=De}),ai(M,"link",g),h.instance=M}r.stylesheets===null&&(r.stylesheets=new Map),r.stylesheets.set(h,o),(o=h.state.preload)&&(h.state.loading&3)===0&&(r.count++,h=Hf.bind(r),o.addEventListener("load",h),o.addEventListener("error",h))}}var pg=0;function ZT(r,o){return r.stylesheets&&r.count===0&&Gf(r,r.stylesheets),0<r.count||0<r.imgCount?function(h){var g=setTimeout(function(){if(r.stylesheets&&Gf(r,r.stylesheets),r.unsuspend){var M=r.unsuspend;r.unsuspend=null,M()}},6e4+o);0<r.imgBytes&&pg===0&&(pg=62500*OT());var E=setTimeout(function(){if(r.waitingForImages=!1,r.count===0&&(r.stylesheets&&Gf(r,r.stylesheets),r.unsuspend)){var M=r.unsuspend;r.unsuspend=null,M()}},(r.imgBytes>pg?50:800)+o);return r.unsuspend=h,function(){r.unsuspend=null,clearTimeout(g),clearTimeout(E)}}:null}function Hf(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)Gf(this,this.stylesheets);else if(this.unsuspend){var r=this.unsuspend;this.unsuspend=null,r()}}}var zf=null;function Gf(r,o){r.stylesheets=null,r.unsuspend!==null&&(r.count++,zf=new Map,o.forEach(XT,r),zf=null,Hf.call(r))}function XT(r,o){if(!(o.state.loading&4)){var h=zf.get(r);if(h)var g=h.get(null);else{h=new Map,zf.set(r,h);for(var E=r.querySelectorAll("link[data-precedence],style[data-precedence]"),M=0;M<E.length;M++){var X=E[M];(X.nodeName==="LINK"||X.getAttribute("media")!=="not all")&&(h.set(X.dataset.precedence,X),g=X)}g&&h.set(null,g)}E=o.instance,X=E.getAttribute("data-precedence"),M=h.get(X)||g,M===g&&h.set(null,E),h.set(X,E),this.count++,g=Hf.bind(this),E.addEventListener("load",g),E.addEventListener("error",g),M?M.parentNode.insertBefore(E,M.nextSibling):(r=r.nodeType===9?r.head:r,r.insertBefore(E,r.firstChild)),o.state.loading|=4}}var xu={$$typeof:x,Provider:null,Consumer:null,_currentValue:B,_currentValue2:B,_threadCount:0};function e3(r,o,h,g,E,M,X,ue,De){this.tag=1,this.containerInfo=r,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=qt(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=qt(0),this.hiddenUpdates=qt(null),this.identifierPrefix=g,this.onUncaughtError=E,this.onCaughtError=M,this.onRecoverableError=X,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=De,this.incompleteTransitions=new Map}function j1(r,o,h,g,E,M,X,ue,De,ut,Tt,Lt){return r=new e3(r,o,h,X,De,ut,Tt,Lt,ue),o=1,M===!0&&(o|=24),M=Rr(3,null,null,o),r.current=M,M.stateNode=r,o=$d(),o.refCount++,r.pooledCache=o,o.refCount++,M.memoizedState={element:g,isDehydrated:h,cache:o},Jd(M),r}function D1(r){return r?(r=Wn,r):Wn}function P1(r,o,h,g,E,M){E=D1(E),g.context===null?g.context=E:g.pendingContext=E,g=aa(o),g.payload={element:h},M=M===void 0?null:M,M!==null&&(g.callback=M),h=la(r,g,o),h!==null&&(Di(h,r,o),Xc(h,r,o))}function L1(r,o){if(r=r.memoizedState,r!==null&&r.dehydrated!==null){var h=r.retryLane;r.retryLane=h!==0&&h<o?h:o}}function gg(r,o){L1(r,o),(r=r.alternate)&&L1(r,o)}function U1(r){if(r.tag===13||r.tag===31){var o=bn(r,67108864);o!==null&&Di(o,r,67108864),gg(r,67108864)}}function q1(r){if(r.tag===13||r.tag===31){var o=Vi();o=oe(o);var h=bn(r,o);h!==null&&Di(h,r,o),gg(r,o)}}var Kf=!0;function t3(r,o,h,g){var E=ee.T;ee.T=null;var M=ne.p;try{ne.p=2,mg(r,o,h,g)}finally{ne.p=M,ee.T=E}}function n3(r,o,h,g){var E=ee.T;ee.T=null;var M=ne.p;try{ne.p=8,mg(r,o,h,g)}finally{ne.p=M,ee.T=E}}function mg(r,o,h,g){if(Kf){var E=yg(g);if(E===null)ng(r,o,g,Vf,h),H1(r,g);else if(i3(E,r,o,h,g))g.stopPropagation();else if(H1(r,g),o&4&&-1<r3.indexOf(r)){for(;E!==null;){var M=tn(E);if(M!==null)switch(M.tag){case 3:if(M=M.stateNode,M.current.memoizedState.isDehydrated){var X=_r(M.pendingLanes);if(X!==0){var ue=M;for(ue.pendingLanes|=2,ue.entangledLanes|=2;X;){var De=1<<31-mt(X);ue.entanglements[1]|=De,X&=~De}Ps(M),(ir&6)===0&&(Tf=nt()+500,gu(0))}}break;case 31:case 13:ue=bn(M,2),ue!==null&&Di(ue,M,2),If(),gg(M,2)}if(M=yg(g),M===null&&ng(r,o,g,Vf,h),M===E)break;E=M}E!==null&&g.stopPropagation()}else ng(r,o,g,null,h)}}function yg(r){return r=qo(r),bg(r)}var Vf=null;function bg(r){if(Vf=null,r=xn(r),r!==null){var o=a(r);if(o===null)r=null;else{var h=o.tag;if(h===13){if(r=l(o),r!==null)return r;r=null}else if(h===31){if(r=u(o),r!==null)return r;r=null}else if(h===3){if(o.stateNode.current.memoizedState.isDehydrated)return o.tag===3?o.stateNode.containerInfo:null;r=null}else o!==r&&(r=null)}}return Vf=r,null}function F1(r){switch(r){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(Zt()){case j:return 2;case W:return 8;case se:case Oe:return 32;case Ke:return 268435456;default:return 32}default:return 32}}var vg=!1,va=null,wa=null,xa=null,_u=new Map,Su=new Map,_a=[],r3="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function H1(r,o){switch(r){case"focusin":case"focusout":va=null;break;case"dragenter":case"dragleave":wa=null;break;case"mouseover":case"mouseout":xa=null;break;case"pointerover":case"pointerout":_u.delete(o.pointerId);break;case"gotpointercapture":case"lostpointercapture":Su.delete(o.pointerId)}}function Eu(r,o,h,g,E,M){return r===null||r.nativeEvent!==M?(r={blockedOn:o,domEventName:h,eventSystemFlags:g,nativeEvent:M,targetContainers:[E]},o!==null&&(o=tn(o),o!==null&&U1(o)),r):(r.eventSystemFlags|=g,o=r.targetContainers,E!==null&&o.indexOf(E)===-1&&o.push(E),r)}function i3(r,o,h,g,E){switch(o){case"focusin":return va=Eu(va,r,o,h,g,E),!0;case"dragenter":return wa=Eu(wa,r,o,h,g,E),!0;case"mouseover":return xa=Eu(xa,r,o,h,g,E),!0;case"pointerover":var M=E.pointerId;return _u.set(M,Eu(_u.get(M)||null,r,o,h,g,E)),!0;case"gotpointercapture":return M=E.pointerId,Su.set(M,Eu(Su.get(M)||null,r,o,h,g,E)),!0}return!1}function z1(r){var o=xn(r.target);if(o!==null){var h=a(o);if(h!==null){if(o=h.tag,o===13){if(o=l(h),o!==null){r.blockedOn=o,ge(r.priority,function(){q1(h)});return}}else if(o===31){if(o=u(h),o!==null){r.blockedOn=o,ge(r.priority,function(){q1(h)});return}}else if(o===3&&h.stateNode.current.memoizedState.isDehydrated){r.blockedOn=h.tag===3?h.stateNode.containerInfo:null;return}}}r.blockedOn=null}function $f(r){if(r.blockedOn!==null)return!1;for(var o=r.targetContainers;0<o.length;){var h=yg(r.nativeEvent);if(h===null){h=r.nativeEvent;var g=new h.constructor(h.type,h);Mi=g,h.target.dispatchEvent(g),Mi=null}else return o=tn(h),o!==null&&U1(o),r.blockedOn=h,!1;o.shift()}return!0}function G1(r,o,h){$f(r)&&h.delete(o)}function s3(){vg=!1,va!==null&&$f(va)&&(va=null),wa!==null&&$f(wa)&&(wa=null),xa!==null&&$f(xa)&&(xa=null),_u.forEach(G1),Su.forEach(G1)}function Yf(r,o){r.blockedOn===o&&(r.blockedOn=null,vg||(vg=!0,i.unstable_scheduleCallback(i.unstable_NormalPriority,s3)))}var Wf=null;function K1(r){Wf!==r&&(Wf=r,i.unstable_scheduleCallback(i.unstable_NormalPriority,function(){Wf===r&&(Wf=null);for(var o=0;o<r.length;o+=3){var h=r[o],g=r[o+1],E=r[o+2];if(typeof g!="function"){if(bg(g||h)===null)continue;break}var M=tn(h);M!==null&&(r.splice(o,3),o-=3,yp(M,{pending:!0,data:E,method:h.method,action:g},g,E))}}))}function bc(r){function o(De){return Yf(De,r)}va!==null&&Yf(va,r),wa!==null&&Yf(wa,r),xa!==null&&Yf(xa,r),_u.forEach(o),Su.forEach(o);for(var h=0;h<_a.length;h++){var g=_a[h];g.blockedOn===r&&(g.blockedOn=null)}for(;0<_a.length&&(h=_a[0],h.blockedOn===null);)z1(h),h.blockedOn===null&&_a.shift();if(h=(r.ownerDocument||r).$$reactFormReplay,h!=null)for(g=0;g<h.length;g+=3){var E=h[g],M=h[g+1],X=E[vt]||null;if(typeof M=="function")X||K1(h);else if(X){var ue=null;if(M&&M.hasAttribute("formAction")){if(E=M,X=M[vt]||null)ue=X.formAction;else if(bg(E)!==null)continue}else ue=X.action;typeof ue=="function"?h[g+1]=ue:(h.splice(g,3),g-=3),K1(h)}}}function V1(){function r(M){M.canIntercept&&M.info==="react-transition"&&M.intercept({handler:function(){return new Promise(function(X){return E=X})},focusReset:"manual",scroll:"manual"})}function o(){E!==null&&(E(),E=null),g||setTimeout(h,20)}function h(){if(!g&&!navigation.transition){var M=navigation.currentEntry;M&&M.url!=null&&navigation.navigate(M.url,{state:M.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var g=!1,E=null;return navigation.addEventListener("navigate",r),navigation.addEventListener("navigatesuccess",o),navigation.addEventListener("navigateerror",o),setTimeout(h,100),function(){g=!0,navigation.removeEventListener("navigate",r),navigation.removeEventListener("navigatesuccess",o),navigation.removeEventListener("navigateerror",o),E!==null&&(E(),E=null)}}}function wg(r){this._internalRoot=r}Qf.prototype.render=wg.prototype.render=function(r){var o=this._internalRoot;if(o===null)throw Error(n(409));var h=o.current,g=Vi();P1(h,g,r,o,null,null)},Qf.prototype.unmount=wg.prototype.unmount=function(){var r=this._internalRoot;if(r!==null){this._internalRoot=null;var o=r.containerInfo;P1(r.current,2,null,r,null,null),If(),o[Nt]=null}};function Qf(r){this._internalRoot=r}Qf.prototype.unstable_scheduleHydration=function(r){if(r){var o=D();r={blockedOn:null,target:r,priority:o};for(var h=0;h<_a.length&&o!==0&&o<_a[h].priority;h++);_a.splice(h,0,r),h===0&&z1(r)}};var $1=e.version;if($1!=="19.2.0")throw Error(n(527,$1,"19.2.0"));ne.findDOMNode=function(r){var o=r._reactInternals;if(o===void 0)throw typeof r.render=="function"?Error(n(188)):(r=Object.keys(r).join(","),Error(n(268,r)));return r=f(o),r=r!==null?d(r):null,r=r===null?null:r.stateNode,r};var o3={bundleType:0,version:"19.2.0",rendererPackageName:"react-dom",currentDispatcherRef:ee,reconcilerVersion:"19.2.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Jf=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Jf.isDisabled&&Jf.supportsFiber)try{Le=Jf.inject(o3),Xe=Jf}catch{}}return Au.createRoot=function(r,o){if(!s(r))throw Error(n(299));var h=!1,g="",E=ew,M=tw,X=nw;return o!=null&&(o.unstable_strictMode===!0&&(h=!0),o.identifierPrefix!==void 0&&(g=o.identifierPrefix),o.onUncaughtError!==void 0&&(E=o.onUncaughtError),o.onCaughtError!==void 0&&(M=o.onCaughtError),o.onRecoverableError!==void 0&&(X=o.onRecoverableError)),o=j1(r,1,!1,null,null,h,g,null,E,M,X,V1),r[Nt]=o.current,tg(r),new wg(o)},Au.hydrateRoot=function(r,o,h){if(!s(r))throw Error(n(299));var g=!1,E="",M=ew,X=tw,ue=nw,De=null;return h!=null&&(h.unstable_strictMode===!0&&(g=!0),h.identifierPrefix!==void 0&&(E=h.identifierPrefix),h.onUncaughtError!==void 0&&(M=h.onUncaughtError),h.onCaughtError!==void 0&&(X=h.onCaughtError),h.onRecoverableError!==void 0&&(ue=h.onRecoverableError),h.formState!==void 0&&(De=h.formState)),o=j1(r,1,!0,o,h??null,g,E,De,M,X,ue,V1),o.context=D1(null),h=o.current,g=Vi(),g=oe(g),E=aa(g),E.callback=null,la(h,E,g),h=g,o.current.lanes=h,fe(o,h),Ps(o),r[Nt]=o.current,tg(r),new Qf(o)},Au.version="19.2.0",Au}var rx;function v3(){if(rx)return Sg.exports;rx=1;function i(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(i)}catch(e){console.error(e)}}return i(),Sg.exports=b3(),Sg.exports}var w3=v3();const x3="modulepreload",_3=function(i){return"/"+i},ix={},kg=function(e,t,n){let s=Promise.resolve();if(t&&t.length>0){let f=function(d){return Promise.all(d.map(p=>Promise.resolve(p).then(m=>({status:"fulfilled",value:m}),m=>({status:"rejected",reason:m}))))};var l=f;document.getElementsByTagName("link");const u=document.querySelector("meta[property=csp-nonce]"),c=u?.nonce||u?.getAttribute("nonce");s=f(t.map(d=>{if(d=_3(d),d in ix)return;ix[d]=!0;const p=d.endsWith(".css"),m=p?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${d}"]${m}`))return;const v=document.createElement("link");if(v.rel=p?"stylesheet":x3,p||(v.as="script"),v.crossOrigin="",v.href=d,c&&v.setAttribute("nonce",c),document.head.appendChild(v),p)return new Promise((b,y)=>{v.addEventListener("load",b),v.addEventListener("error",()=>y(new Error(`Unable to preload CSS for ${d}`)))})}))}function a(u){const c=new Event("vite:preloadError",{cancelable:!0});if(c.payload=u,window.dispatchEvent(c),!c.defaultPrevented)throw u}return s.then(u=>{for(const c of u||[])c.status==="rejected"&&a(c.reason);return e().catch(a)})},sx=i=>{let e;const t=new Set,n=(f,d)=>{const p=typeof f=="function"?f(e):f;if(!Object.is(p,e)){const m=e;e=d??(typeof p!="object"||p===null)?p:Object.assign({},e,p),t.forEach(v=>v(e,m))}},s=()=>e,u={setState:n,getState:s,getInitialState:()=>c,subscribe:f=>(t.add(f),()=>t.delete(f))},c=e=i(n,s,u);return u},S3=(i=>i?sx(i):sx),E3=i=>i;function C3(i,e=E3){const t=Or.useSyncExternalStore(i.subscribe,Or.useCallback(()=>e(i.getState()),[i,e]),Or.useCallback(()=>e(i.getInitialState()),[i,e]));return Or.useDebugValue(t),t}const ox=i=>{const e=S3(i),t=n=>C3(e,n);return Object.assign(t,e),t},Wy=(i=>i?ox(i):ox);function A3(i,e){let t;try{t=i()}catch{return}return{getItem:s=>{var a;const l=c=>c===null?null:JSON.parse(c,void 0),u=(a=t.getItem(s))!=null?a:null;return u instanceof Promise?u.then(l):l(u)},setItem:(s,a)=>t.setItem(s,JSON.stringify(a,void 0)),removeItem:s=>t.removeItem(s)}}const u0=i=>e=>{try{const t=i(e);return t instanceof Promise?t:{then(n){return u0(n)(t)},catch(n){return this}}}catch(t){return{then(n){return this},catch(n){return u0(n)(t)}}}},k3=(i,e)=>(t,n,s)=>{let a={storage:A3(()=>localStorage),partialize:y=>y,version:0,merge:(y,w)=>({...w,...y}),...e},l=!1;const u=new Set,c=new Set;let f=a.storage;if(!f)return i((...y)=>{console.warn(`[zustand persist middleware] Unable to update item '${a.name}', the given storage is currently unavailable.`),t(...y)},n,s);const d=()=>{const y=a.partialize({...n()});return f.setItem(a.name,{state:y,version:a.version})},p=s.setState;s.setState=(y,w)=>(p(y,w),d());const m=i((...y)=>(t(...y),d()),n,s);s.getInitialState=()=>m;let v;const b=()=>{var y,w;if(!f)return;l=!1,u.forEach(S=>{var x;return S((x=n())!=null?x:m)});const C=((w=a.onRehydrateStorage)==null?void 0:w.call(a,(y=n())!=null?y:m))||void 0;return u0(f.getItem.bind(f))(a.name).then(S=>{if(S)if(typeof S.version=="number"&&S.version!==a.version){if(a.migrate){const x=a.migrate(S.state,S.version);return x instanceof Promise?x.then(k=>[!0,k]):[!0,x]}console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return[!1,S.state];return[!1,void 0]}).then(S=>{var x;const[k,A]=S;if(v=a.merge(A,(x=n())!=null?x:m),t(v,!0),k)return d()}).then(()=>{C?.(v,void 0),v=n(),l=!0,c.forEach(S=>S(v))}).catch(S=>{C?.(void 0,S)})};return s.persist={setOptions:y=>{a={...a,...y},y.storage&&(f=y.storage)},clearStorage:()=>{f?.removeItem(a.name)},getOptions:()=>a,rehydrate:()=>b(),hasHydrated:()=>l,onHydrate:y=>(u.add(y),()=>{u.delete(y)}),onFinishHydration:y=>(c.add(y),()=>{c.delete(y)})},a.skipHydration||b(),v||m},T3=k3,ui={PeerJS:"peerjs",WebTorrent:"webtorrent",Nostr:"nostr",Gun:"gun",MQTT:"mqtt"};function M3(i){throw new Error(`Unexpected provider: ${i}`)}const lh={[ui.PeerJS]:{name:"PeerJS",description:"WebRTC signaling server",color:"indigo",serverLabel:"Servers",order:0},[ui.WebTorrent]:{name:"WebTorrent",description:"BitTorrent tracker signaling",color:"orange",serverLabel:"Trackers",stripPrefix:["wss://"],order:1},[ui.Nostr]:{name:"Nostr",description:"Decentralized relay network",color:"purple",serverLabel:"Relays",stripPrefix:["wss://"],order:2},[ui.Gun]:{name:"Gun.js",description:"Decentralized database relay",color:"emerald",serverLabel:"Relays",warning:"Unreliable public servers",maxDisplayServers:3,stripPrefix:["https://","/gun"],order:3},[ui.MQTT]:{name:"MQTT",description:"Pub/sub messaging broker",color:"cyan",serverLabel:"Brokers",warning:"Both peers must use the same broker to connect",stripPrefix:["wss://"],order:4}};function I3(){return Object.keys(lh).sort((i,e)=>lh[i].order-lh[e].order)}function R3(i,e){const t=e;switch(i){case ui.PeerJS:return{enabled:t?.enabled??!0,servers:t?.servers??["0.peerjs.com"]};case ui.WebTorrent:return{enabled:t?.enabled??!0,servers:t?.servers??["wss://tracker.openwebtorrent.com","wss://tracker.btorrent.xyz"]};case ui.Nostr:return{enabled:t?.enabled??!0,servers:t?.servers??["wss://relay.damus.io","wss://nos.lol","wss://relay.nostr.band"]};case ui.Gun:return{enabled:t?.enabled??!1,servers:t?.servers??["https://gun-manhattan.herokuapp.com/gun","https://peer.wallie.io/gun","https://gunjs.herokuapp.com/gun"]};case ui.MQTT:return{enabled:t?.enabled??!1,servers:t?.servers??["wss://broker.emqx.io:8084/mqtt","wss://broker.hivemq.com:8884/mqtt"]};default:return M3(i)}}function Wu(i={}){const e=i,t={};for(const n of Object.values(ui))t[n]=R3(n,e[n]);return t}const O3=Wu({}),os=Wy()(T3(i=>({identity:null,isInitialized:!1,activeView:"setup",activeContactId:null,firebaseEnabled:!1,firebaseConfigured:!1,miniChatVisibility:"never",signalingSettings:Wu(),setIdentity:e=>i({identity:e,isInitialized:!0}),setInitialized:e=>i({isInitialized:e}),setActiveView:e=>i({activeView:e}),setActiveContact:e=>i({activeContactId:e}),setFirebaseEnabled:e=>i({firebaseEnabled:e}),setFirebaseConfigured:e=>i({firebaseConfigured:e}),setMiniChatVisibility:e=>i({miniChatVisibility:e}),setSignalingSettings:e=>i({signalingSettings:e}),updateSignalingService:(e,t)=>i(n=>({signalingSettings:{...n.signalingSettings,[e]:{...n.signalingSettings[e],...t}}})),clearIdentity:()=>i({identity:null,isInitialized:!1,activeView:"setup",activeContactId:null}),updateProfile:e=>i(t=>({identity:t.identity?{...t.identity,profile:e}:null}))}),{name:"chat-app-storage",partialize:i=>({identity:i.identity,isInitialized:i.isInitialized,firebaseEnabled:i.firebaseEnabled,firebaseConfigured:i.firebaseConfigured,miniChatVisibility:i.miniChatVisibility,signalingSettings:i.signalingSettings})})),Zf="chat-identity";class El{static save(e){try{const t=JSON.stringify(e);localStorage.setItem(Zf,t)}catch(t){throw console.error("Failed to save identity:",t),new Error("Failed to save identity to storage")}}static load(){try{const e=localStorage.getItem(Zf);if(!e)return null;const t=JSON.parse(e),n=t.secretKey||t.privateKey;return!t.userId||!t.publicKey||!n?(console.error("Invalid identity in storage"),null):{userId:t.userId,publicKey:t.publicKey,secretKey:n,profile:t.profile??{}}}catch(e){return console.error("Failed to load identity:",e),null}}static exists(){return localStorage.getItem(Zf)!==null}static delete(){localStorage.removeItem(Zf)}static exportToJSON(e){return JSON.stringify(e,null,2)}static importFromJSON(e){try{let t=JSON.parse(e);t.version&&t.data&&(t=JSON.parse(t.data));const n=t.secretKey||t.privateKey;if(!t.userId||!t.publicKey||!n)throw new Error("Invalid identity format");return{userId:t.userId,publicKey:t.publicKey,secretKey:n,profile:t.profile??{}}}catch(t){throw console.error("Failed to import identity:",t),new Error("Invalid identity JSON")}}}class N3{constructor(){this.encoder=new TextEncoder,this._pieces=[],this._parts=[]}append_buffer(e){this.flush(),this._parts.push(e)}append(e){this._pieces.push(e)}flush(){if(this._pieces.length>0){const e=new Uint8Array(this._pieces);this._parts.push(e),this._pieces=[]}}toArrayBuffer(){const e=[];for(const t of this._parts)e.push(t);return B3(e).buffer}}function B3(i){let e=0;for(const s of i)e+=s.byteLength;const t=new Uint8Array(e);let n=0;for(const s of i){const a=new Uint8Array(s.buffer,s.byteOffset,s.byteLength);t.set(a,n),n+=s.byteLength}return t}function K2(i){return new j3(i).unpack()}function V2(i){const e=new D3,t=e.pack(i);return t instanceof Promise?t.then(()=>e.getBuffer()):e.getBuffer()}class j3{constructor(e){this.index=0,this.dataBuffer=e,this.dataView=new Uint8Array(this.dataBuffer),this.length=this.dataBuffer.byteLength}unpack(){const e=this.unpack_uint8();if(e<128)return e;if((e^224)<32)return(e^224)-32;let t;if((t=e^160)<=15)return this.unpack_raw(t);if((t=e^176)<=15)return this.unpack_string(t);if((t=e^144)<=15)return this.unpack_array(t);if((t=e^128)<=15)return this.unpack_map(t);switch(e){case 192:return null;case 193:return;case 194:return!1;case 195:return!0;case 202:return this.unpack_float();case 203:return this.unpack_double();case 204:return this.unpack_uint8();case 205:return this.unpack_uint16();case 206:return this.unpack_uint32();case 207:return this.unpack_uint64();case 208:return this.unpack_int8();case 209:return this.unpack_int16();case 210:return this.unpack_int32();case 211:return this.unpack_int64();case 212:return;case 213:return;case 214:return;case 215:return;case 216:return t=this.unpack_uint16(),this.unpack_string(t);case 217:return t=this.unpack_uint32(),this.unpack_string(t);case 218:return t=this.unpack_uint16(),this.unpack_raw(t);case 219:return t=this.unpack_uint32(),this.unpack_raw(t);case 220:return t=this.unpack_uint16(),this.unpack_array(t);case 221:return t=this.unpack_uint32(),this.unpack_array(t);case 222:return t=this.unpack_uint16(),this.unpack_map(t);case 223:return t=this.unpack_uint32(),this.unpack_map(t)}}unpack_uint8(){const e=this.dataView[this.index]&255;return this.index++,e}unpack_uint16(){const e=this.read(2),t=(e[0]&255)*256+(e[1]&255);return this.index+=2,t}unpack_uint32(){const e=this.read(4),t=((e[0]*256+e[1])*256+e[2])*256+e[3];return this.index+=4,t}unpack_uint64(){const e=this.read(8),t=((((((e[0]*256+e[1])*256+e[2])*256+e[3])*256+e[4])*256+e[5])*256+e[6])*256+e[7];return this.index+=8,t}unpack_int8(){const e=this.unpack_uint8();return e<128?e:e-256}unpack_int16(){const e=this.unpack_uint16();return e<32768?e:e-65536}unpack_int32(){const e=this.unpack_uint32();return e<2**31?e:e-2**32}unpack_int64(){const e=this.unpack_uint64();return e<2**63?e:e-2**64}unpack_raw(e){if(this.length<this.index+e)throw new Error(`BinaryPackFailure: index is out of range ${this.index} ${e} ${this.length}`);const t=this.dataBuffer.slice(this.index,this.index+e);return this.index+=e,t}unpack_string(e){const t=this.read(e);let n=0,s="",a,l;for(;n<e;)a=t[n],a<160?(l=a,n++):(a^192)<32?(l=(a&31)<<6|t[n+1]&63,n+=2):(a^224)<16?(l=(a&15)<<12|(t[n+1]&63)<<6|t[n+2]&63,n+=3):(l=(a&7)<<18|(t[n+1]&63)<<12|(t[n+2]&63)<<6|t[n+3]&63,n+=4),s+=String.fromCodePoint(l);return this.index+=e,s}unpack_array(e){const t=new Array(e);for(let n=0;n<e;n++)t[n]=this.unpack();return t}unpack_map(e){const t={};for(let n=0;n<e;n++){const s=this.unpack();t[s]=this.unpack()}return t}unpack_float(){const e=this.unpack_uint32(),t=e>>31,n=(e>>23&255)-127,s=e&8388607|8388608;return(t===0?1:-1)*s*2**(n-23)}unpack_double(){const e=this.unpack_uint32(),t=this.unpack_uint32(),n=e>>31,s=(e>>20&2047)-1023,l=(e&1048575|1048576)*2**(s-20)+t*2**(s-52);return(n===0?1:-1)*l}read(e){const t=this.index;if(t+e<=this.length)return this.dataView.subarray(t,t+e);throw new Error("BinaryPackFailure: read index out of range")}}class D3{getBuffer(){return this._bufferBuilder.toArrayBuffer()}pack(e){if(typeof e=="string")this.pack_string(e);else if(typeof e=="number")Math.floor(e)===e?this.pack_integer(e):this.pack_double(e);else if(typeof e=="boolean")e===!0?this._bufferBuilder.append(195):e===!1&&this._bufferBuilder.append(194);else if(e===void 0)this._bufferBuilder.append(192);else if(typeof e=="object")if(e===null)this._bufferBuilder.append(192);else{const t=e.constructor;if(e instanceof Array){const n=this.pack_array(e);if(n instanceof Promise)return n.then(()=>this._bufferBuilder.flush())}else if(e instanceof ArrayBuffer)this.pack_bin(new Uint8Array(e));else if("BYTES_PER_ELEMENT"in e){const n=e;this.pack_bin(new Uint8Array(n.buffer,n.byteOffset,n.byteLength))}else if(e instanceof Date)this.pack_string(e.toString());else{if(e instanceof Blob)return e.arrayBuffer().then(n=>{this.pack_bin(new Uint8Array(n)),this._bufferBuilder.flush()});if(t==Object||t.toString().startsWith("class")){const n=this.pack_object(e);if(n instanceof Promise)return n.then(()=>this._bufferBuilder.flush())}else throw new Error(`Type "${t.toString()}" not yet supported`)}}else throw new Error(`Type "${typeof e}" not yet supported`);this._bufferBuilder.flush()}pack_bin(e){const t=e.length;if(t<=15)this.pack_uint8(160+t);else if(t<=65535)this._bufferBuilder.append(218),this.pack_uint16(t);else if(t<=4294967295)this._bufferBuilder.append(219),this.pack_uint32(t);else throw new Error("Invalid length");this._bufferBuilder.append_buffer(e)}pack_string(e){const t=this._textEncoder.encode(e),n=t.length;if(n<=15)this.pack_uint8(176+n);else if(n<=65535)this._bufferBuilder.append(216),this.pack_uint16(n);else if(n<=4294967295)this._bufferBuilder.append(217),this.pack_uint32(n);else throw new Error("Invalid length");this._bufferBuilder.append_buffer(t)}pack_array(e){const t=e.length;if(t<=15)this.pack_uint8(144+t);else if(t<=65535)this._bufferBuilder.append(220),this.pack_uint16(t);else if(t<=4294967295)this._bufferBuilder.append(221),this.pack_uint32(t);else throw new Error("Invalid length");const n=s=>{if(s<t){const a=this.pack(e[s]);return a instanceof Promise?a.then(()=>n(s+1)):n(s+1)}};return n(0)}pack_integer(e){if(e>=-32&&e<=127)this._bufferBuilder.append(e&255);else if(e>=0&&e<=255)this._bufferBuilder.append(204),this.pack_uint8(e);else if(e>=-128&&e<=127)this._bufferBuilder.append(208),this.pack_int8(e);else if(e>=0&&e<=65535)this._bufferBuilder.append(205),this.pack_uint16(e);else if(e>=-32768&&e<=32767)this._bufferBuilder.append(209),this.pack_int16(e);else if(e>=0&&e<=4294967295)this._bufferBuilder.append(206),this.pack_uint32(e);else if(e>=-2147483648&&e<=2147483647)this._bufferBuilder.append(210),this.pack_int32(e);else if(e>=-9223372036854776e3&&e<=9223372036854776e3)this._bufferBuilder.append(211),this.pack_int64(e);else if(e>=0&&e<=18446744073709552e3)this._bufferBuilder.append(207),this.pack_uint64(e);else throw new Error("Invalid integer")}pack_double(e){let t=0;e<0&&(t=1,e=-e);const n=Math.floor(Math.log(e)/Math.LN2),s=e/2**n-1,a=Math.floor(s*2**52),l=2**32,u=t<<31|n+1023<<20|a/l&1048575,c=a%l;this._bufferBuilder.append(203),this.pack_int32(u),this.pack_int32(c)}pack_object(e){const t=Object.keys(e),n=t.length;if(n<=15)this.pack_uint8(128+n);else if(n<=65535)this._bufferBuilder.append(222),this.pack_uint16(n);else if(n<=4294967295)this._bufferBuilder.append(223),this.pack_uint32(n);else throw new Error("Invalid length");const s=a=>{if(a<t.length){const l=t[a];if(e.hasOwnProperty(l)){this.pack(l);const u=this.pack(e[l]);if(u instanceof Promise)return u.then(()=>s(a+1))}return s(a+1)}};return s(0)}pack_uint8(e){this._bufferBuilder.append(e)}pack_uint16(e){this._bufferBuilder.append(e>>8),this._bufferBuilder.append(e&255)}pack_uint32(e){const t=e&4294967295;this._bufferBuilder.append((t&4278190080)>>>24),this._bufferBuilder.append((t&16711680)>>>16),this._bufferBuilder.append((t&65280)>>>8),this._bufferBuilder.append(t&255)}pack_uint64(e){const t=e/4294967296,n=e%2**32;this._bufferBuilder.append((t&4278190080)>>>24),this._bufferBuilder.append((t&16711680)>>>16),this._bufferBuilder.append((t&65280)>>>8),this._bufferBuilder.append(t&255),this._bufferBuilder.append((n&4278190080)>>>24),this._bufferBuilder.append((n&16711680)>>>16),this._bufferBuilder.append((n&65280)>>>8),this._bufferBuilder.append(n&255)}pack_int8(e){this._bufferBuilder.append(e&255)}pack_int16(e){this._bufferBuilder.append((e&65280)>>8),this._bufferBuilder.append(e&255)}pack_int32(e){this._bufferBuilder.append(e>>>24&255),this._bufferBuilder.append((e&16711680)>>>16),this._bufferBuilder.append((e&65280)>>>8),this._bufferBuilder.append(e&255)}pack_int64(e){const t=Math.floor(e/4294967296),n=e%2**32;this._bufferBuilder.append((t&4278190080)>>>24),this._bufferBuilder.append((t&16711680)>>>16),this._bufferBuilder.append((t&65280)>>>8),this._bufferBuilder.append(t&255),this._bufferBuilder.append((n&4278190080)>>>24),this._bufferBuilder.append((n&16711680)>>>16),this._bufferBuilder.append((n&65280)>>>8),this._bufferBuilder.append(n&255)}constructor(){this._bufferBuilder=new N3,this._textEncoder=new TextEncoder}}let $2=!0,Y2=!0;function Bu(i,e,t){const n=i.match(e);return n&&n.length>=t&&parseFloat(n[t],10)}function Il(i,e,t){if(!i.RTCPeerConnection)return;const n=i.RTCPeerConnection.prototype,s=n.addEventListener;n.addEventListener=function(l,u){if(l!==e)return s.apply(this,arguments);const c=f=>{const d=t(f);d&&(u.handleEvent?u.handleEvent(d):u(d))};return this._eventMap=this._eventMap||{},this._eventMap[e]||(this._eventMap[e]=new Map),this._eventMap[e].set(u,c),s.apply(this,[l,c])};const a=n.removeEventListener;n.removeEventListener=function(l,u){if(l!==e||!this._eventMap||!this._eventMap[e])return a.apply(this,arguments);if(!this._eventMap[e].has(u))return a.apply(this,arguments);const c=this._eventMap[e].get(u);return this._eventMap[e].delete(u),this._eventMap[e].size===0&&delete this._eventMap[e],Object.keys(this._eventMap).length===0&&delete this._eventMap,a.apply(this,[l,c])},Object.defineProperty(n,"on"+e,{get(){return this["_on"+e]},set(l){this["_on"+e]&&(this.removeEventListener(e,this["_on"+e]),delete this["_on"+e]),l&&this.addEventListener(e,this["_on"+e]=l)},enumerable:!0,configurable:!0})}function P3(i){return typeof i!="boolean"?new Error("Argument type: "+typeof i+". Please use a boolean."):($2=i,i?"adapter.js logging disabled":"adapter.js logging enabled")}function L3(i){return typeof i!="boolean"?new Error("Argument type: "+typeof i+". Please use a boolean."):(Y2=!i,"adapter.js deprecation warnings "+(i?"disabled":"enabled"))}function W2(){if(typeof window=="object"){if($2)return;typeof console<"u"&&typeof console.log=="function"&&console.log.apply(console,arguments)}}function Qy(i,e){Y2&&console.warn(i+" is deprecated, please use "+e+" instead.")}function U3(i){const e={browser:null,version:null};if(typeof i>"u"||!i.navigator||!i.navigator.userAgent)return e.browser="Not a browser.",e;const{navigator:t}=i;if(t.userAgentData&&t.userAgentData.brands){const n=t.userAgentData.brands.find(s=>s.brand==="Chromium");if(n)return{browser:"chrome",version:parseInt(n.version,10)}}if(t.mozGetUserMedia)e.browser="firefox",e.version=parseInt(Bu(t.userAgent,/Firefox\/(\d+)\./,1));else if(t.webkitGetUserMedia||i.isSecureContext===!1&&i.webkitRTCPeerConnection)e.browser="chrome",e.version=parseInt(Bu(t.userAgent,/Chrom(e|ium)\/(\d+)\./,2));else if(i.RTCPeerConnection&&t.userAgent.match(/AppleWebKit\/(\d+)\./))e.browser="safari",e.version=parseInt(Bu(t.userAgent,/AppleWebKit\/(\d+)\./,1)),e.supportsUnifiedPlan=i.RTCRtpTransceiver&&"currentDirection"in i.RTCRtpTransceiver.prototype,e._safariVersion=Bu(t.userAgent,/Version\/(\d+(\.?\d+))/,1);else return e.browser="Not a supported browser.",e;return e}function ax(i){return Object.prototype.toString.call(i)==="[object Object]"}function Q2(i){return ax(i)?Object.keys(i).reduce(function(e,t){const n=ax(i[t]),s=n?Q2(i[t]):i[t],a=n&&!Object.keys(s).length;return s===void 0||a?e:Object.assign(e,{[t]:s})},{}):i}function f0(i,e,t){!e||t.has(e.id)||(t.set(e.id,e),Object.keys(e).forEach(n=>{n.endsWith("Id")?f0(i,i.get(e[n]),t):n.endsWith("Ids")&&e[n].forEach(s=>{f0(i,i.get(s),t)})}))}function lx(i,e,t){const n=t?"outbound-rtp":"inbound-rtp",s=new Map;if(e===null)return s;const a=[];return i.forEach(l=>{l.type==="track"&&l.trackIdentifier===e.id&&a.push(l)}),a.forEach(l=>{i.forEach(u=>{u.type===n&&u.trackId===l.id&&f0(i,u,s)})}),s}const cx=W2;function J2(i,e){const t=i&&i.navigator;if(!t.mediaDevices)return;const n=function(u){if(typeof u!="object"||u.mandatory||u.optional)return u;const c={};return Object.keys(u).forEach(f=>{if(f==="require"||f==="advanced"||f==="mediaSource")return;const d=typeof u[f]=="object"?u[f]:{ideal:u[f]};d.exact!==void 0&&typeof d.exact=="number"&&(d.min=d.max=d.exact);const p=function(m,v){return m?m+v.charAt(0).toUpperCase()+v.slice(1):v==="deviceId"?"sourceId":v};if(d.ideal!==void 0){c.optional=c.optional||[];let m={};typeof d.ideal=="number"?(m[p("min",f)]=d.ideal,c.optional.push(m),m={},m[p("max",f)]=d.ideal,c.optional.push(m)):(m[p("",f)]=d.ideal,c.optional.push(m))}d.exact!==void 0&&typeof d.exact!="number"?(c.mandatory=c.mandatory||{},c.mandatory[p("",f)]=d.exact):["min","max"].forEach(m=>{d[m]!==void 0&&(c.mandatory=c.mandatory||{},c.mandatory[p(m,f)]=d[m])})}),u.advanced&&(c.optional=(c.optional||[]).concat(u.advanced)),c},s=function(u,c){if(e.version>=61)return c(u);if(u=JSON.parse(JSON.stringify(u)),u&&typeof u.audio=="object"){const f=function(d,p,m){p in d&&!(m in d)&&(d[m]=d[p],delete d[p])};u=JSON.parse(JSON.stringify(u)),f(u.audio,"autoGainControl","googAutoGainControl"),f(u.audio,"noiseSuppression","googNoiseSuppression"),u.audio=n(u.audio)}if(u&&typeof u.video=="object"){let f=u.video.facingMode;f=f&&(typeof f=="object"?f:{ideal:f});const d=e.version<66;if(f&&(f.exact==="user"||f.exact==="environment"||f.ideal==="user"||f.ideal==="environment")&&!(t.mediaDevices.getSupportedConstraints&&t.mediaDevices.getSupportedConstraints().facingMode&&!d)){delete u.video.facingMode;let p;if(f.exact==="environment"||f.ideal==="environment"?p=["back","rear"]:(f.exact==="user"||f.ideal==="user")&&(p=["front"]),p)return t.mediaDevices.enumerateDevices().then(m=>{m=m.filter(b=>b.kind==="videoinput");let v=m.find(b=>p.some(y=>b.label.toLowerCase().includes(y)));return!v&&m.length&&p.includes("back")&&(v=m[m.length-1]),v&&(u.video.deviceId=f.exact?{exact:v.deviceId}:{ideal:v.deviceId}),u.video=n(u.video),cx("chrome: "+JSON.stringify(u)),c(u)})}u.video=n(u.video)}return cx("chrome: "+JSON.stringify(u)),c(u)},a=function(u){return e.version>=64?u:{name:{PermissionDeniedError:"NotAllowedError",PermissionDismissedError:"NotAllowedError",InvalidStateError:"NotAllowedError",DevicesNotFoundError:"NotFoundError",ConstraintNotSatisfiedError:"OverconstrainedError",TrackStartError:"NotReadableError",MediaDeviceFailedDueToShutdown:"NotAllowedError",MediaDeviceKillSwitchOn:"NotAllowedError",TabCaptureError:"AbortError",ScreenCaptureError:"AbortError",DeviceCaptureError:"AbortError"}[u.name]||u.name,message:u.message,constraint:u.constraint||u.constraintName,toString(){return this.name+(this.message&&": ")+this.message}}},l=function(u,c,f){s(u,d=>{t.webkitGetUserMedia(d,c,p=>{f&&f(a(p))})})};if(t.getUserMedia=l.bind(t),t.mediaDevices.getUserMedia){const u=t.mediaDevices.getUserMedia.bind(t.mediaDevices);t.mediaDevices.getUserMedia=function(c){return s(c,f=>u(f).then(d=>{if(f.audio&&!d.getAudioTracks().length||f.video&&!d.getVideoTracks().length)throw d.getTracks().forEach(p=>{p.stop()}),new DOMException("","NotFoundError");return d},d=>Promise.reject(a(d))))}}}function Z2(i){i.MediaStream=i.MediaStream||i.webkitMediaStream}function X2(i){if(typeof i=="object"&&i.RTCPeerConnection&&!("ontrack"in i.RTCPeerConnection.prototype)){Object.defineProperty(i.RTCPeerConnection.prototype,"ontrack",{get(){return this._ontrack},set(t){this._ontrack&&this.removeEventListener("track",this._ontrack),this.addEventListener("track",this._ontrack=t)},enumerable:!0,configurable:!0});const e=i.RTCPeerConnection.prototype.setRemoteDescription;i.RTCPeerConnection.prototype.setRemoteDescription=function(){return this._ontrackpoly||(this._ontrackpoly=n=>{n.stream.addEventListener("addtrack",s=>{let a;i.RTCPeerConnection.prototype.getReceivers?a=this.getReceivers().find(u=>u.track&&u.track.id===s.track.id):a={track:s.track};const l=new Event("track");l.track=s.track,l.receiver=a,l.transceiver={receiver:a},l.streams=[n.stream],this.dispatchEvent(l)}),n.stream.getTracks().forEach(s=>{let a;i.RTCPeerConnection.prototype.getReceivers?a=this.getReceivers().find(u=>u.track&&u.track.id===s.id):a={track:s};const l=new Event("track");l.track=s,l.receiver=a,l.transceiver={receiver:a},l.streams=[n.stream],this.dispatchEvent(l)})},this.addEventListener("addstream",this._ontrackpoly)),e.apply(this,arguments)}}else Il(i,"track",e=>(e.transceiver||Object.defineProperty(e,"transceiver",{value:{receiver:e.receiver}}),e))}function eS(i){if(typeof i=="object"&&i.RTCPeerConnection&&!("getSenders"in i.RTCPeerConnection.prototype)&&"createDTMFSender"in i.RTCPeerConnection.prototype){const e=function(s,a){return{track:a,get dtmf(){return this._dtmf===void 0&&(a.kind==="audio"?this._dtmf=s.createDTMFSender(a):this._dtmf=null),this._dtmf},_pc:s}};if(!i.RTCPeerConnection.prototype.getSenders){i.RTCPeerConnection.prototype.getSenders=function(){return this._senders=this._senders||[],this._senders.slice()};const s=i.RTCPeerConnection.prototype.addTrack;i.RTCPeerConnection.prototype.addTrack=function(u,c){let f=s.apply(this,arguments);return f||(f=e(this,u),this._senders.push(f)),f};const a=i.RTCPeerConnection.prototype.removeTrack;i.RTCPeerConnection.prototype.removeTrack=function(u){a.apply(this,arguments);const c=this._senders.indexOf(u);c!==-1&&this._senders.splice(c,1)}}const t=i.RTCPeerConnection.prototype.addStream;i.RTCPeerConnection.prototype.addStream=function(a){this._senders=this._senders||[],t.apply(this,[a]),a.getTracks().forEach(l=>{this._senders.push(e(this,l))})};const n=i.RTCPeerConnection.prototype.removeStream;i.RTCPeerConnection.prototype.removeStream=function(a){this._senders=this._senders||[],n.apply(this,[a]),a.getTracks().forEach(l=>{const u=this._senders.find(c=>c.track===l);u&&this._senders.splice(this._senders.indexOf(u),1)})}}else if(typeof i=="object"&&i.RTCPeerConnection&&"getSenders"in i.RTCPeerConnection.prototype&&"createDTMFSender"in i.RTCPeerConnection.prototype&&i.RTCRtpSender&&!("dtmf"in i.RTCRtpSender.prototype)){const e=i.RTCPeerConnection.prototype.getSenders;i.RTCPeerConnection.prototype.getSenders=function(){const n=e.apply(this,[]);return n.forEach(s=>s._pc=this),n},Object.defineProperty(i.RTCRtpSender.prototype,"dtmf",{get(){return this._dtmf===void 0&&(this.track.kind==="audio"?this._dtmf=this._pc.createDTMFSender(this.track):this._dtmf=null),this._dtmf}})}}function tS(i){if(!(typeof i=="object"&&i.RTCPeerConnection&&i.RTCRtpSender&&i.RTCRtpReceiver))return;if(!("getStats"in i.RTCRtpSender.prototype)){const t=i.RTCPeerConnection.prototype.getSenders;t&&(i.RTCPeerConnection.prototype.getSenders=function(){const a=t.apply(this,[]);return a.forEach(l=>l._pc=this),a});const n=i.RTCPeerConnection.prototype.addTrack;n&&(i.RTCPeerConnection.prototype.addTrack=function(){const a=n.apply(this,arguments);return a._pc=this,a}),i.RTCRtpSender.prototype.getStats=function(){const a=this;return this._pc.getStats().then(l=>lx(l,a.track,!0))}}if(!("getStats"in i.RTCRtpReceiver.prototype)){const t=i.RTCPeerConnection.prototype.getReceivers;t&&(i.RTCPeerConnection.prototype.getReceivers=function(){const s=t.apply(this,[]);return s.forEach(a=>a._pc=this),s}),Il(i,"track",n=>(n.receiver._pc=n.srcElement,n)),i.RTCRtpReceiver.prototype.getStats=function(){const s=this;return this._pc.getStats().then(a=>lx(a,s.track,!1))}}if(!("getStats"in i.RTCRtpSender.prototype&&"getStats"in i.RTCRtpReceiver.prototype))return;const e=i.RTCPeerConnection.prototype.getStats;i.RTCPeerConnection.prototype.getStats=function(){if(arguments.length>0&&arguments[0]instanceof i.MediaStreamTrack){const n=arguments[0];let s,a,l;return this.getSenders().forEach(u=>{u.track===n&&(s?l=!0:s=u)}),this.getReceivers().forEach(u=>(u.track===n&&(a?l=!0:a=u),u.track===n)),l||s&&a?Promise.reject(new DOMException("There are more than one sender or receiver for the track.","InvalidAccessError")):s?s.getStats():a?a.getStats():Promise.reject(new DOMException("There is no sender or receiver for the track.","InvalidAccessError"))}return e.apply(this,arguments)}}function nS(i){i.RTCPeerConnection.prototype.getLocalStreams=function(){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},Object.keys(this._shimmedLocalStreams).map(l=>this._shimmedLocalStreams[l][0])};const e=i.RTCPeerConnection.prototype.addTrack;i.RTCPeerConnection.prototype.addTrack=function(l,u){if(!u)return e.apply(this,arguments);this._shimmedLocalStreams=this._shimmedLocalStreams||{};const c=e.apply(this,arguments);return this._shimmedLocalStreams[u.id]?this._shimmedLocalStreams[u.id].indexOf(c)===-1&&this._shimmedLocalStreams[u.id].push(c):this._shimmedLocalStreams[u.id]=[u,c],c};const t=i.RTCPeerConnection.prototype.addStream;i.RTCPeerConnection.prototype.addStream=function(l){this._shimmedLocalStreams=this._shimmedLocalStreams||{},l.getTracks().forEach(f=>{if(this.getSenders().find(p=>p.track===f))throw new DOMException("Track already exists.","InvalidAccessError")});const u=this.getSenders();t.apply(this,arguments);const c=this.getSenders().filter(f=>u.indexOf(f)===-1);this._shimmedLocalStreams[l.id]=[l].concat(c)};const n=i.RTCPeerConnection.prototype.removeStream;i.RTCPeerConnection.prototype.removeStream=function(l){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},delete this._shimmedLocalStreams[l.id],n.apply(this,arguments)};const s=i.RTCPeerConnection.prototype.removeTrack;i.RTCPeerConnection.prototype.removeTrack=function(l){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},l&&Object.keys(this._shimmedLocalStreams).forEach(u=>{const c=this._shimmedLocalStreams[u].indexOf(l);c!==-1&&this._shimmedLocalStreams[u].splice(c,1),this._shimmedLocalStreams[u].length===1&&delete this._shimmedLocalStreams[u]}),s.apply(this,arguments)}}function rS(i,e){if(!i.RTCPeerConnection)return;if(i.RTCPeerConnection.prototype.addTrack&&e.version>=65)return nS(i);const t=i.RTCPeerConnection.prototype.getLocalStreams;i.RTCPeerConnection.prototype.getLocalStreams=function(){const d=t.apply(this);return this._reverseStreams=this._reverseStreams||{},d.map(p=>this._reverseStreams[p.id])};const n=i.RTCPeerConnection.prototype.addStream;i.RTCPeerConnection.prototype.addStream=function(d){if(this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},d.getTracks().forEach(p=>{if(this.getSenders().find(v=>v.track===p))throw new DOMException("Track already exists.","InvalidAccessError")}),!this._reverseStreams[d.id]){const p=new i.MediaStream(d.getTracks());this._streams[d.id]=p,this._reverseStreams[p.id]=d,d=p}n.apply(this,[d])};const s=i.RTCPeerConnection.prototype.removeStream;i.RTCPeerConnection.prototype.removeStream=function(d){this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},s.apply(this,[this._streams[d.id]||d]),delete this._reverseStreams[this._streams[d.id]?this._streams[d.id].id:d.id],delete this._streams[d.id]},i.RTCPeerConnection.prototype.addTrack=function(d,p){if(this.signalingState==="closed")throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");const m=[].slice.call(arguments,1);if(m.length!==1||!m[0].getTracks().find(y=>y===d))throw new DOMException("The adapter.js addTrack polyfill only supports a single  stream which is associated with the specified track.","NotSupportedError");if(this.getSenders().find(y=>y.track===d))throw new DOMException("Track already exists.","InvalidAccessError");this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{};const b=this._streams[p.id];if(b)b.addTrack(d),Promise.resolve().then(()=>{this.dispatchEvent(new Event("negotiationneeded"))});else{const y=new i.MediaStream([d]);this._streams[p.id]=y,this._reverseStreams[y.id]=p,this.addStream(y)}return this.getSenders().find(y=>y.track===d)};function a(f,d){let p=d.sdp;return Object.keys(f._reverseStreams||[]).forEach(m=>{const v=f._reverseStreams[m],b=f._streams[v.id];p=p.replace(new RegExp(b.id,"g"),v.id)}),new RTCSessionDescription({type:d.type,sdp:p})}function l(f,d){let p=d.sdp;return Object.keys(f._reverseStreams||[]).forEach(m=>{const v=f._reverseStreams[m],b=f._streams[v.id];p=p.replace(new RegExp(v.id,"g"),b.id)}),new RTCSessionDescription({type:d.type,sdp:p})}["createOffer","createAnswer"].forEach(function(f){const d=i.RTCPeerConnection.prototype[f],p={[f](){const m=arguments;return arguments.length&&typeof arguments[0]=="function"?d.apply(this,[b=>{const y=a(this,b);m[0].apply(null,[y])},b=>{m[1]&&m[1].apply(null,b)},arguments[2]]):d.apply(this,arguments).then(b=>a(this,b))}};i.RTCPeerConnection.prototype[f]=p[f]});const u=i.RTCPeerConnection.prototype.setLocalDescription;i.RTCPeerConnection.prototype.setLocalDescription=function(){return!arguments.length||!arguments[0].type?u.apply(this,arguments):(arguments[0]=l(this,arguments[0]),u.apply(this,arguments))};const c=Object.getOwnPropertyDescriptor(i.RTCPeerConnection.prototype,"localDescription");Object.defineProperty(i.RTCPeerConnection.prototype,"localDescription",{get(){const f=c.get.apply(this);return f.type===""?f:a(this,f)}}),i.RTCPeerConnection.prototype.removeTrack=function(d){if(this.signalingState==="closed")throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");if(!d._pc)throw new DOMException("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.","TypeError");if(!(d._pc===this))throw new DOMException("Sender was not created by this connection.","InvalidAccessError");this._streams=this._streams||{};let m;Object.keys(this._streams).forEach(v=>{this._streams[v].getTracks().find(y=>d.track===y)&&(m=this._streams[v])}),m&&(m.getTracks().length===1?this.removeStream(this._reverseStreams[m.id]):m.removeTrack(d.track),this.dispatchEvent(new Event("negotiationneeded")))}}function h0(i,e){!i.RTCPeerConnection&&i.webkitRTCPeerConnection&&(i.RTCPeerConnection=i.webkitRTCPeerConnection),i.RTCPeerConnection&&e.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(t){const n=i.RTCPeerConnection.prototype[t],s={[t](){return arguments[0]=new(t==="addIceCandidate"?i.RTCIceCandidate:i.RTCSessionDescription)(arguments[0]),n.apply(this,arguments)}};i.RTCPeerConnection.prototype[t]=s[t]})}function iS(i,e){Il(i,"negotiationneeded",t=>{const n=t.target;if(!((e.version<72||n.getConfiguration&&n.getConfiguration().sdpSemantics==="plan-b")&&n.signalingState!=="stable"))return t})}const ux=Object.freeze(Object.defineProperty({__proto__:null,fixNegotiationNeeded:iS,shimAddTrackRemoveTrack:rS,shimAddTrackRemoveTrackWithNative:nS,shimGetSendersWithDtmf:eS,shimGetUserMedia:J2,shimMediaStream:Z2,shimOnTrack:X2,shimPeerConnection:h0,shimSenderReceiverGetStats:tS},Symbol.toStringTag,{value:"Module"}));function sS(i,e){const t=i&&i.navigator,n=i&&i.MediaStreamTrack;if(t.getUserMedia=function(s,a,l){Qy("navigator.getUserMedia","navigator.mediaDevices.getUserMedia"),t.mediaDevices.getUserMedia(s).then(a,l)},!(e.version>55&&"autoGainControl"in t.mediaDevices.getSupportedConstraints())){const s=function(l,u,c){u in l&&!(c in l)&&(l[c]=l[u],delete l[u])},a=t.mediaDevices.getUserMedia.bind(t.mediaDevices);if(t.mediaDevices.getUserMedia=function(l){return typeof l=="object"&&typeof l.audio=="object"&&(l=JSON.parse(JSON.stringify(l)),s(l.audio,"autoGainControl","mozAutoGainControl"),s(l.audio,"noiseSuppression","mozNoiseSuppression")),a(l)},n&&n.prototype.getSettings){const l=n.prototype.getSettings;n.prototype.getSettings=function(){const u=l.apply(this,arguments);return s(u,"mozAutoGainControl","autoGainControl"),s(u,"mozNoiseSuppression","noiseSuppression"),u}}if(n&&n.prototype.applyConstraints){const l=n.prototype.applyConstraints;n.prototype.applyConstraints=function(u){return this.kind==="audio"&&typeof u=="object"&&(u=JSON.parse(JSON.stringify(u)),s(u,"autoGainControl","mozAutoGainControl"),s(u,"noiseSuppression","mozNoiseSuppression")),l.apply(this,[u])}}}}function q3(i,e){i.navigator.mediaDevices&&"getDisplayMedia"in i.navigator.mediaDevices||i.navigator.mediaDevices&&(i.navigator.mediaDevices.getDisplayMedia=function(n){if(!(n&&n.video)){const s=new DOMException("getDisplayMedia without video constraints is undefined");return s.name="NotFoundError",s.code=8,Promise.reject(s)}return n.video===!0?n.video={mediaSource:e}:n.video.mediaSource=e,i.navigator.mediaDevices.getUserMedia(n)})}function oS(i){typeof i=="object"&&i.RTCTrackEvent&&"receiver"in i.RTCTrackEvent.prototype&&!("transceiver"in i.RTCTrackEvent.prototype)&&Object.defineProperty(i.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function d0(i,e){if(typeof i!="object"||!(i.RTCPeerConnection||i.mozRTCPeerConnection))return;!i.RTCPeerConnection&&i.mozRTCPeerConnection&&(i.RTCPeerConnection=i.mozRTCPeerConnection),e.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(s){const a=i.RTCPeerConnection.prototype[s],l={[s](){return arguments[0]=new(s==="addIceCandidate"?i.RTCIceCandidate:i.RTCSessionDescription)(arguments[0]),a.apply(this,arguments)}};i.RTCPeerConnection.prototype[s]=l[s]});const t={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"},n=i.RTCPeerConnection.prototype.getStats;i.RTCPeerConnection.prototype.getStats=function(){const[a,l,u]=arguments;return n.apply(this,[a||null]).then(c=>{if(e.version<53&&!l)try{c.forEach(f=>{f.type=t[f.type]||f.type})}catch(f){if(f.name!=="TypeError")throw f;c.forEach((d,p)=>{c.set(p,Object.assign({},d,{type:t[d.type]||d.type}))})}return c}).then(l,u)}}function aS(i){if(!(typeof i=="object"&&i.RTCPeerConnection&&i.RTCRtpSender)||i.RTCRtpSender&&"getStats"in i.RTCRtpSender.prototype)return;const e=i.RTCPeerConnection.prototype.getSenders;e&&(i.RTCPeerConnection.prototype.getSenders=function(){const s=e.apply(this,[]);return s.forEach(a=>a._pc=this),s});const t=i.RTCPeerConnection.prototype.addTrack;t&&(i.RTCPeerConnection.prototype.addTrack=function(){const s=t.apply(this,arguments);return s._pc=this,s}),i.RTCRtpSender.prototype.getStats=function(){return this.track?this._pc.getStats(this.track):Promise.resolve(new Map)}}function lS(i){if(!(typeof i=="object"&&i.RTCPeerConnection&&i.RTCRtpSender)||i.RTCRtpSender&&"getStats"in i.RTCRtpReceiver.prototype)return;const e=i.RTCPeerConnection.prototype.getReceivers;e&&(i.RTCPeerConnection.prototype.getReceivers=function(){const n=e.apply(this,[]);return n.forEach(s=>s._pc=this),n}),Il(i,"track",t=>(t.receiver._pc=t.srcElement,t)),i.RTCRtpReceiver.prototype.getStats=function(){return this._pc.getStats(this.track)}}function cS(i){!i.RTCPeerConnection||"removeStream"in i.RTCPeerConnection.prototype||(i.RTCPeerConnection.prototype.removeStream=function(t){Qy("removeStream","removeTrack"),this.getSenders().forEach(n=>{n.track&&t.getTracks().includes(n.track)&&this.removeTrack(n)})})}function uS(i){i.DataChannel&&!i.RTCDataChannel&&(i.RTCDataChannel=i.DataChannel)}function fS(i){if(!(typeof i=="object"&&i.RTCPeerConnection))return;const e=i.RTCPeerConnection.prototype.addTransceiver;e&&(i.RTCPeerConnection.prototype.addTransceiver=function(){this.setParametersPromises=[];let n=arguments[1]&&arguments[1].sendEncodings;n===void 0&&(n=[]),n=[...n];const s=n.length>0;s&&n.forEach(l=>{if("rid"in l&&!/^[a-z0-9]{0,16}$/i.test(l.rid))throw new TypeError("Invalid RID value provided.");if("scaleResolutionDownBy"in l&&!(parseFloat(l.scaleResolutionDownBy)>=1))throw new RangeError("scale_resolution_down_by must be >= 1.0");if("maxFramerate"in l&&!(parseFloat(l.maxFramerate)>=0))throw new RangeError("max_framerate must be >= 0.0")});const a=e.apply(this,arguments);if(s){const{sender:l}=a,u=l.getParameters();(!("encodings"in u)||u.encodings.length===1&&Object.keys(u.encodings[0]).length===0)&&(u.encodings=n,l.sendEncodings=n,this.setParametersPromises.push(l.setParameters(u).then(()=>{delete l.sendEncodings}).catch(()=>{delete l.sendEncodings})))}return a})}function hS(i){if(!(typeof i=="object"&&i.RTCRtpSender))return;const e=i.RTCRtpSender.prototype.getParameters;e&&(i.RTCRtpSender.prototype.getParameters=function(){const n=e.apply(this,arguments);return"encodings"in n||(n.encodings=[].concat(this.sendEncodings||[{}])),n})}function dS(i){if(!(typeof i=="object"&&i.RTCPeerConnection))return;const e=i.RTCPeerConnection.prototype.createOffer;i.RTCPeerConnection.prototype.createOffer=function(){return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then(()=>e.apply(this,arguments)).finally(()=>{this.setParametersPromises=[]}):e.apply(this,arguments)}}function pS(i){if(!(typeof i=="object"&&i.RTCPeerConnection))return;const e=i.RTCPeerConnection.prototype.createAnswer;i.RTCPeerConnection.prototype.createAnswer=function(){return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then(()=>e.apply(this,arguments)).finally(()=>{this.setParametersPromises=[]}):e.apply(this,arguments)}}const fx=Object.freeze(Object.defineProperty({__proto__:null,shimAddTransceiver:fS,shimCreateAnswer:pS,shimCreateOffer:dS,shimGetDisplayMedia:q3,shimGetParameters:hS,shimGetUserMedia:sS,shimOnTrack:oS,shimPeerConnection:d0,shimRTCDataChannel:uS,shimReceiverGetStats:lS,shimRemoveStream:cS,shimSenderGetStats:aS},Symbol.toStringTag,{value:"Module"}));function gS(i){if(!(typeof i!="object"||!i.RTCPeerConnection)){if("getLocalStreams"in i.RTCPeerConnection.prototype||(i.RTCPeerConnection.prototype.getLocalStreams=function(){return this._localStreams||(this._localStreams=[]),this._localStreams}),!("addStream"in i.RTCPeerConnection.prototype)){const e=i.RTCPeerConnection.prototype.addTrack;i.RTCPeerConnection.prototype.addStream=function(n){this._localStreams||(this._localStreams=[]),this._localStreams.includes(n)||this._localStreams.push(n),n.getAudioTracks().forEach(s=>e.call(this,s,n)),n.getVideoTracks().forEach(s=>e.call(this,s,n))},i.RTCPeerConnection.prototype.addTrack=function(n,...s){return s&&s.forEach(a=>{this._localStreams?this._localStreams.includes(a)||this._localStreams.push(a):this._localStreams=[a]}),e.apply(this,arguments)}}"removeStream"in i.RTCPeerConnection.prototype||(i.RTCPeerConnection.prototype.removeStream=function(t){this._localStreams||(this._localStreams=[]);const n=this._localStreams.indexOf(t);if(n===-1)return;this._localStreams.splice(n,1);const s=t.getTracks();this.getSenders().forEach(a=>{s.includes(a.track)&&this.removeTrack(a)})})}}function mS(i){if(!(typeof i!="object"||!i.RTCPeerConnection)&&("getRemoteStreams"in i.RTCPeerConnection.prototype||(i.RTCPeerConnection.prototype.getRemoteStreams=function(){return this._remoteStreams?this._remoteStreams:[]}),!("onaddstream"in i.RTCPeerConnection.prototype))){Object.defineProperty(i.RTCPeerConnection.prototype,"onaddstream",{get(){return this._onaddstream},set(t){this._onaddstream&&(this.removeEventListener("addstream",this._onaddstream),this.removeEventListener("track",this._onaddstreampoly)),this.addEventListener("addstream",this._onaddstream=t),this.addEventListener("track",this._onaddstreampoly=n=>{n.streams.forEach(s=>{if(this._remoteStreams||(this._remoteStreams=[]),this._remoteStreams.includes(s))return;this._remoteStreams.push(s);const a=new Event("addstream");a.stream=s,this.dispatchEvent(a)})})}});const e=i.RTCPeerConnection.prototype.setRemoteDescription;i.RTCPeerConnection.prototype.setRemoteDescription=function(){const n=this;return this._onaddstreampoly||this.addEventListener("track",this._onaddstreampoly=function(s){s.streams.forEach(a=>{if(n._remoteStreams||(n._remoteStreams=[]),n._remoteStreams.indexOf(a)>=0)return;n._remoteStreams.push(a);const l=new Event("addstream");l.stream=a,n.dispatchEvent(l)})}),e.apply(n,arguments)}}}function yS(i){if(typeof i!="object"||!i.RTCPeerConnection)return;const e=i.RTCPeerConnection.prototype,t=e.createOffer,n=e.createAnswer,s=e.setLocalDescription,a=e.setRemoteDescription,l=e.addIceCandidate;e.createOffer=function(f,d){const p=arguments.length>=2?arguments[2]:arguments[0],m=t.apply(this,[p]);return d?(m.then(f,d),Promise.resolve()):m},e.createAnswer=function(f,d){const p=arguments.length>=2?arguments[2]:arguments[0],m=n.apply(this,[p]);return d?(m.then(f,d),Promise.resolve()):m};let u=function(c,f,d){const p=s.apply(this,[c]);return d?(p.then(f,d),Promise.resolve()):p};e.setLocalDescription=u,u=function(c,f,d){const p=a.apply(this,[c]);return d?(p.then(f,d),Promise.resolve()):p},e.setRemoteDescription=u,u=function(c,f,d){const p=l.apply(this,[c]);return d?(p.then(f,d),Promise.resolve()):p},e.addIceCandidate=u}function bS(i){const e=i&&i.navigator;if(e.mediaDevices&&e.mediaDevices.getUserMedia){const t=e.mediaDevices,n=t.getUserMedia.bind(t);e.mediaDevices.getUserMedia=s=>n(vS(s))}!e.getUserMedia&&e.mediaDevices&&e.mediaDevices.getUserMedia&&(e.getUserMedia=(function(n,s,a){e.mediaDevices.getUserMedia(n).then(s,a)}).bind(e))}function vS(i){return i&&i.video!==void 0?Object.assign({},i,{video:Q2(i.video)}):i}function wS(i){if(!i.RTCPeerConnection)return;const e=i.RTCPeerConnection;i.RTCPeerConnection=function(n,s){if(n&&n.iceServers){const a=[];for(let l=0;l<n.iceServers.length;l++){let u=n.iceServers[l];u.urls===void 0&&u.url?(Qy("RTCIceServer.url","RTCIceServer.urls"),u=JSON.parse(JSON.stringify(u)),u.urls=u.url,delete u.url,a.push(u)):a.push(n.iceServers[l])}n.iceServers=a}return new e(n,s)},i.RTCPeerConnection.prototype=e.prototype,"generateCertificate"in e&&Object.defineProperty(i.RTCPeerConnection,"generateCertificate",{get(){return e.generateCertificate}})}function xS(i){typeof i=="object"&&i.RTCTrackEvent&&"receiver"in i.RTCTrackEvent.prototype&&!("transceiver"in i.RTCTrackEvent.prototype)&&Object.defineProperty(i.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function _S(i){const e=i.RTCPeerConnection.prototype.createOffer;i.RTCPeerConnection.prototype.createOffer=function(n){if(n){typeof n.offerToReceiveAudio<"u"&&(n.offerToReceiveAudio=!!n.offerToReceiveAudio);const s=this.getTransceivers().find(l=>l.receiver.track.kind==="audio");n.offerToReceiveAudio===!1&&s?s.direction==="sendrecv"?s.setDirection?s.setDirection("sendonly"):s.direction="sendonly":s.direction==="recvonly"&&(s.setDirection?s.setDirection("inactive"):s.direction="inactive"):n.offerToReceiveAudio===!0&&!s&&this.addTransceiver("audio",{direction:"recvonly"}),typeof n.offerToReceiveVideo<"u"&&(n.offerToReceiveVideo=!!n.offerToReceiveVideo);const a=this.getTransceivers().find(l=>l.receiver.track.kind==="video");n.offerToReceiveVideo===!1&&a?a.direction==="sendrecv"?a.setDirection?a.setDirection("sendonly"):a.direction="sendonly":a.direction==="recvonly"&&(a.setDirection?a.setDirection("inactive"):a.direction="inactive"):n.offerToReceiveVideo===!0&&!a&&this.addTransceiver("video",{direction:"recvonly"})}return e.apply(this,arguments)}}function SS(i){typeof i!="object"||i.AudioContext||(i.AudioContext=i.webkitAudioContext)}const hx=Object.freeze(Object.defineProperty({__proto__:null,shimAudioContext:SS,shimCallbacksAPI:yS,shimConstraints:vS,shimCreateOfferLegacy:_S,shimGetUserMedia:bS,shimLocalStreamsAPI:gS,shimRTCIceServerUrls:wS,shimRemoteStreamsAPI:mS,shimTrackEventTransceiver:xS},Symbol.toStringTag,{value:"Module"}));var Tg={exports:{}},dx;function F3(){return dx||(dx=1,(function(i){const e={};e.generateIdentifier=function(){return Math.random().toString(36).substring(2,12)},e.localCName=e.generateIdentifier(),e.splitLines=function(t){return t.trim().split(`
`).map(n=>n.trim())},e.splitSections=function(t){return t.split(`
m=`).map((s,a)=>(a>0?"m="+s:s).trim()+`\r
`)},e.getDescription=function(t){const n=e.splitSections(t);return n&&n[0]},e.getMediaSections=function(t){const n=e.splitSections(t);return n.shift(),n},e.matchPrefix=function(t,n){return e.splitLines(t).filter(s=>s.indexOf(n)===0)},e.parseCandidate=function(t){let n;t.indexOf("a=candidate:")===0?n=t.substring(12).split(" "):n=t.substring(10).split(" ");const s={foundation:n[0],component:{1:"rtp",2:"rtcp"}[n[1]]||n[1],protocol:n[2].toLowerCase(),priority:parseInt(n[3],10),ip:n[4],address:n[4],port:parseInt(n[5],10),type:n[7]};for(let a=8;a<n.length;a+=2)switch(n[a]){case"raddr":s.relatedAddress=n[a+1];break;case"rport":s.relatedPort=parseInt(n[a+1],10);break;case"tcptype":s.tcpType=n[a+1];break;case"ufrag":s.ufrag=n[a+1],s.usernameFragment=n[a+1];break;default:s[n[a]]===void 0&&(s[n[a]]=n[a+1]);break}return s},e.writeCandidate=function(t){const n=[];n.push(t.foundation);const s=t.component;s==="rtp"?n.push(1):s==="rtcp"?n.push(2):n.push(s),n.push(t.protocol.toUpperCase()),n.push(t.priority),n.push(t.address||t.ip),n.push(t.port);const a=t.type;return n.push("typ"),n.push(a),a!=="host"&&t.relatedAddress&&t.relatedPort&&(n.push("raddr"),n.push(t.relatedAddress),n.push("rport"),n.push(t.relatedPort)),t.tcpType&&t.protocol.toLowerCase()==="tcp"&&(n.push("tcptype"),n.push(t.tcpType)),(t.usernameFragment||t.ufrag)&&(n.push("ufrag"),n.push(t.usernameFragment||t.ufrag)),"candidate:"+n.join(" ")},e.parseIceOptions=function(t){return t.substring(14).split(" ")},e.parseRtpMap=function(t){let n=t.substring(9).split(" ");const s={payloadType:parseInt(n.shift(),10)};return n=n[0].split("/"),s.name=n[0],s.clockRate=parseInt(n[1],10),s.channels=n.length===3?parseInt(n[2],10):1,s.numChannels=s.channels,s},e.writeRtpMap=function(t){let n=t.payloadType;t.preferredPayloadType!==void 0&&(n=t.preferredPayloadType);const s=t.channels||t.numChannels||1;return"a=rtpmap:"+n+" "+t.name+"/"+t.clockRate+(s!==1?"/"+s:"")+`\r
`},e.parseExtmap=function(t){const n=t.substring(9).split(" ");return{id:parseInt(n[0],10),direction:n[0].indexOf("/")>0?n[0].split("/")[1]:"sendrecv",uri:n[1],attributes:n.slice(2).join(" ")}},e.writeExtmap=function(t){return"a=extmap:"+(t.id||t.preferredId)+(t.direction&&t.direction!=="sendrecv"?"/"+t.direction:"")+" "+t.uri+(t.attributes?" "+t.attributes:"")+`\r
`},e.parseFmtp=function(t){const n={};let s;const a=t.substring(t.indexOf(" ")+1).split(";");for(let l=0;l<a.length;l++)s=a[l].trim().split("="),n[s[0].trim()]=s[1];return n},e.writeFmtp=function(t){let n="",s=t.payloadType;if(t.preferredPayloadType!==void 0&&(s=t.preferredPayloadType),t.parameters&&Object.keys(t.parameters).length){const a=[];Object.keys(t.parameters).forEach(l=>{t.parameters[l]!==void 0?a.push(l+"="+t.parameters[l]):a.push(l)}),n+="a=fmtp:"+s+" "+a.join(";")+`\r
`}return n},e.parseRtcpFb=function(t){const n=t.substring(t.indexOf(" ")+1).split(" ");return{type:n.shift(),parameter:n.join(" ")}},e.writeRtcpFb=function(t){let n="",s=t.payloadType;return t.preferredPayloadType!==void 0&&(s=t.preferredPayloadType),t.rtcpFeedback&&t.rtcpFeedback.length&&t.rtcpFeedback.forEach(a=>{n+="a=rtcp-fb:"+s+" "+a.type+(a.parameter&&a.parameter.length?" "+a.parameter:"")+`\r
`}),n},e.parseSsrcMedia=function(t){const n=t.indexOf(" "),s={ssrc:parseInt(t.substring(7,n),10)},a=t.indexOf(":",n);return a>-1?(s.attribute=t.substring(n+1,a),s.value=t.substring(a+1)):s.attribute=t.substring(n+1),s},e.parseSsrcGroup=function(t){const n=t.substring(13).split(" ");return{semantics:n.shift(),ssrcs:n.map(s=>parseInt(s,10))}},e.getMid=function(t){const n=e.matchPrefix(t,"a=mid:")[0];if(n)return n.substring(6)},e.parseFingerprint=function(t){const n=t.substring(14).split(" ");return{algorithm:n[0].toLowerCase(),value:n[1].toUpperCase()}},e.getDtlsParameters=function(t,n){return{role:"auto",fingerprints:e.matchPrefix(t+n,"a=fingerprint:").map(e.parseFingerprint)}},e.writeDtlsParameters=function(t,n){let s="a=setup:"+n+`\r
`;return t.fingerprints.forEach(a=>{s+="a=fingerprint:"+a.algorithm+" "+a.value+`\r
`}),s},e.parseCryptoLine=function(t){const n=t.substring(9).split(" ");return{tag:parseInt(n[0],10),cryptoSuite:n[1],keyParams:n[2],sessionParams:n.slice(3)}},e.writeCryptoLine=function(t){return"a=crypto:"+t.tag+" "+t.cryptoSuite+" "+(typeof t.keyParams=="object"?e.writeCryptoKeyParams(t.keyParams):t.keyParams)+(t.sessionParams?" "+t.sessionParams.join(" "):"")+`\r
`},e.parseCryptoKeyParams=function(t){if(t.indexOf("inline:")!==0)return null;const n=t.substring(7).split("|");return{keyMethod:"inline",keySalt:n[0],lifeTime:n[1],mkiValue:n[2]?n[2].split(":")[0]:void 0,mkiLength:n[2]?n[2].split(":")[1]:void 0}},e.writeCryptoKeyParams=function(t){return t.keyMethod+":"+t.keySalt+(t.lifeTime?"|"+t.lifeTime:"")+(t.mkiValue&&t.mkiLength?"|"+t.mkiValue+":"+t.mkiLength:"")},e.getCryptoParameters=function(t,n){return e.matchPrefix(t+n,"a=crypto:").map(e.parseCryptoLine)},e.getIceParameters=function(t,n){const s=e.matchPrefix(t+n,"a=ice-ufrag:")[0],a=e.matchPrefix(t+n,"a=ice-pwd:")[0];return s&&a?{usernameFragment:s.substring(12),password:a.substring(10)}:null},e.writeIceParameters=function(t){let n="a=ice-ufrag:"+t.usernameFragment+`\r
a=ice-pwd:`+t.password+`\r
`;return t.iceLite&&(n+=`a=ice-lite\r
`),n},e.parseRtpParameters=function(t){const n={codecs:[],headerExtensions:[],fecMechanisms:[],rtcp:[]},a=e.splitLines(t)[0].split(" ");n.profile=a[2];for(let u=3;u<a.length;u++){const c=a[u],f=e.matchPrefix(t,"a=rtpmap:"+c+" ")[0];if(f){const d=e.parseRtpMap(f),p=e.matchPrefix(t,"a=fmtp:"+c+" ");switch(d.parameters=p.length?e.parseFmtp(p[0]):{},d.rtcpFeedback=e.matchPrefix(t,"a=rtcp-fb:"+c+" ").map(e.parseRtcpFb),n.codecs.push(d),d.name.toUpperCase()){case"RED":case"ULPFEC":n.fecMechanisms.push(d.name.toUpperCase());break}}}e.matchPrefix(t,"a=extmap:").forEach(u=>{n.headerExtensions.push(e.parseExtmap(u))});const l=e.matchPrefix(t,"a=rtcp-fb:* ").map(e.parseRtcpFb);return n.codecs.forEach(u=>{l.forEach(c=>{u.rtcpFeedback.find(d=>d.type===c.type&&d.parameter===c.parameter)||u.rtcpFeedback.push(c)})}),n},e.writeRtpDescription=function(t,n){let s="";s+="m="+t+" ",s+=n.codecs.length>0?"9":"0",s+=" "+(n.profile||"UDP/TLS/RTP/SAVPF")+" ",s+=n.codecs.map(l=>l.preferredPayloadType!==void 0?l.preferredPayloadType:l.payloadType).join(" ")+`\r
`,s+=`c=IN IP4 0.0.0.0\r
`,s+=`a=rtcp:9 IN IP4 0.0.0.0\r
`,n.codecs.forEach(l=>{s+=e.writeRtpMap(l),s+=e.writeFmtp(l),s+=e.writeRtcpFb(l)});let a=0;return n.codecs.forEach(l=>{l.maxptime>a&&(a=l.maxptime)}),a>0&&(s+="a=maxptime:"+a+`\r
`),n.headerExtensions&&n.headerExtensions.forEach(l=>{s+=e.writeExtmap(l)}),s},e.parseRtpEncodingParameters=function(t){const n=[],s=e.parseRtpParameters(t),a=s.fecMechanisms.indexOf("RED")!==-1,l=s.fecMechanisms.indexOf("ULPFEC")!==-1,u=e.matchPrefix(t,"a=ssrc:").map(m=>e.parseSsrcMedia(m)).filter(m=>m.attribute==="cname"),c=u.length>0&&u[0].ssrc;let f;const d=e.matchPrefix(t,"a=ssrc-group:FID").map(m=>m.substring(17).split(" ").map(b=>parseInt(b,10)));d.length>0&&d[0].length>1&&d[0][0]===c&&(f=d[0][1]),s.codecs.forEach(m=>{if(m.name.toUpperCase()==="RTX"&&m.parameters.apt){let v={ssrc:c,codecPayloadType:parseInt(m.parameters.apt,10)};c&&f&&(v.rtx={ssrc:f}),n.push(v),a&&(v=JSON.parse(JSON.stringify(v)),v.fec={ssrc:c,mechanism:l?"red+ulpfec":"red"},n.push(v))}}),n.length===0&&c&&n.push({ssrc:c});let p=e.matchPrefix(t,"b=");return p.length&&(p[0].indexOf("b=TIAS:")===0?p=parseInt(p[0].substring(7),10):p[0].indexOf("b=AS:")===0?p=parseInt(p[0].substring(5),10)*1e3*.95-2e3*8:p=void 0,n.forEach(m=>{m.maxBitrate=p})),n},e.parseRtcpParameters=function(t){const n={},s=e.matchPrefix(t,"a=ssrc:").map(u=>e.parseSsrcMedia(u)).filter(u=>u.attribute==="cname")[0];s&&(n.cname=s.value,n.ssrc=s.ssrc);const a=e.matchPrefix(t,"a=rtcp-rsize");n.reducedSize=a.length>0,n.compound=a.length===0;const l=e.matchPrefix(t,"a=rtcp-mux");return n.mux=l.length>0,n},e.writeRtcpParameters=function(t){let n="";return t.reducedSize&&(n+=`a=rtcp-rsize\r
`),t.mux&&(n+=`a=rtcp-mux\r
`),t.ssrc!==void 0&&t.cname&&(n+="a=ssrc:"+t.ssrc+" cname:"+t.cname+`\r
`),n},e.parseMsid=function(t){let n;const s=e.matchPrefix(t,"a=msid:");if(s.length===1)return n=s[0].substring(7).split(" "),{stream:n[0],track:n[1]};const a=e.matchPrefix(t,"a=ssrc:").map(l=>e.parseSsrcMedia(l)).filter(l=>l.attribute==="msid");if(a.length>0)return n=a[0].value.split(" "),{stream:n[0],track:n[1]}},e.parseSctpDescription=function(t){const n=e.parseMLine(t),s=e.matchPrefix(t,"a=max-message-size:");let a;s.length>0&&(a=parseInt(s[0].substring(19),10)),isNaN(a)&&(a=65536);const l=e.matchPrefix(t,"a=sctp-port:");if(l.length>0)return{port:parseInt(l[0].substring(12),10),protocol:n.fmt,maxMessageSize:a};const u=e.matchPrefix(t,"a=sctpmap:");if(u.length>0){const c=u[0].substring(10).split(" ");return{port:parseInt(c[0],10),protocol:c[1],maxMessageSize:a}}},e.writeSctpDescription=function(t,n){let s=[];return t.protocol!=="DTLS/SCTP"?s=["m="+t.kind+" 9 "+t.protocol+" "+n.protocol+`\r
`,`c=IN IP4 0.0.0.0\r
`,"a=sctp-port:"+n.port+`\r
`]:s=["m="+t.kind+" 9 "+t.protocol+" "+n.port+`\r
`,`c=IN IP4 0.0.0.0\r
`,"a=sctpmap:"+n.port+" "+n.protocol+` 65535\r
`],n.maxMessageSize!==void 0&&s.push("a=max-message-size:"+n.maxMessageSize+`\r
`),s.join("")},e.generateSessionId=function(){return Math.random().toString().substr(2,22)},e.writeSessionBoilerplate=function(t,n,s){let a;const l=n!==void 0?n:2;return t?a=t:a=e.generateSessionId(),`v=0\r
o=`+(s||"thisisadapterortc")+" "+a+" "+l+` IN IP4 127.0.0.1\r
s=-\r
t=0 0\r
`},e.getDirection=function(t,n){const s=e.splitLines(t);for(let a=0;a<s.length;a++)switch(s[a]){case"a=sendrecv":case"a=sendonly":case"a=recvonly":case"a=inactive":return s[a].substring(2)}return n?e.getDirection(n):"sendrecv"},e.getKind=function(t){return e.splitLines(t)[0].split(" ")[0].substring(2)},e.isRejected=function(t){return t.split(" ",2)[1]==="0"},e.parseMLine=function(t){const s=e.splitLines(t)[0].substring(2).split(" ");return{kind:s[0],port:parseInt(s[1],10),protocol:s[2],fmt:s.slice(3).join(" ")}},e.parseOLine=function(t){const s=e.matchPrefix(t,"o=")[0].substring(2).split(" ");return{username:s[0],sessionId:s[1],sessionVersion:parseInt(s[2],10),netType:s[3],addressType:s[4],address:s[5]}},e.isValidSDP=function(t){if(typeof t!="string"||t.length===0)return!1;const n=e.splitLines(t);for(let s=0;s<n.length;s++)if(n[s].length<2||n[s].charAt(1)!=="=")return!1;return!0},i.exports=e})(Tg)),Tg.exports}var ES=F3();const kc=Bc(ES),H3=l3({__proto__:null,default:kc},[ES]);function ch(i){if(!i.RTCIceCandidate||i.RTCIceCandidate&&"foundation"in i.RTCIceCandidate.prototype)return;const e=i.RTCIceCandidate;i.RTCIceCandidate=function(n){if(typeof n=="object"&&n.candidate&&n.candidate.indexOf("a=")===0&&(n=JSON.parse(JSON.stringify(n)),n.candidate=n.candidate.substring(2)),n.candidate&&n.candidate.length){const s=new e(n),a=kc.parseCandidate(n.candidate);for(const l in a)l in s||Object.defineProperty(s,l,{value:a[l]});return s.toJSON=function(){return{candidate:s.candidate,sdpMid:s.sdpMid,sdpMLineIndex:s.sdpMLineIndex,usernameFragment:s.usernameFragment}},s}return new e(n)},i.RTCIceCandidate.prototype=e.prototype,Il(i,"icecandidate",t=>(t.candidate&&Object.defineProperty(t,"candidate",{value:new i.RTCIceCandidate(t.candidate),writable:"false"}),t))}function p0(i){!i.RTCIceCandidate||i.RTCIceCandidate&&"relayProtocol"in i.RTCIceCandidate.prototype||Il(i,"icecandidate",e=>{if(e.candidate){const t=kc.parseCandidate(e.candidate.candidate);t.type==="relay"&&(e.candidate.relayProtocol={0:"tls",1:"tcp",2:"udp"}[t.priority>>24])}return e})}function uh(i,e){if(!i.RTCPeerConnection)return;"sctp"in i.RTCPeerConnection.prototype||Object.defineProperty(i.RTCPeerConnection.prototype,"sctp",{get(){return typeof this._sctp>"u"?null:this._sctp}});const t=function(u){if(!u||!u.sdp)return!1;const c=kc.splitSections(u.sdp);return c.shift(),c.some(f=>{const d=kc.parseMLine(f);return d&&d.kind==="application"&&d.protocol.indexOf("SCTP")!==-1})},n=function(u){const c=u.sdp.match(/mozilla...THIS_IS_SDPARTA-(\d+)/);if(c===null||c.length<2)return-1;const f=parseInt(c[1],10);return f!==f?-1:f},s=function(u){let c=65536;return e.browser==="firefox"&&(e.version<57?u===-1?c=16384:c=2147483637:e.version<60?c=e.version===57?65535:65536:c=2147483637),c},a=function(u,c){let f=65536;e.browser==="firefox"&&e.version===57&&(f=65535);const d=kc.matchPrefix(u.sdp,"a=max-message-size:");return d.length>0?f=parseInt(d[0].substring(19),10):e.browser==="firefox"&&c!==-1&&(f=2147483637),f},l=i.RTCPeerConnection.prototype.setRemoteDescription;i.RTCPeerConnection.prototype.setRemoteDescription=function(){if(this._sctp=null,e.browser==="chrome"&&e.version>=76){const{sdpSemantics:c}=this.getConfiguration();c==="plan-b"&&Object.defineProperty(this,"sctp",{get(){return typeof this._sctp>"u"?null:this._sctp},enumerable:!0,configurable:!0})}if(t(arguments[0])){const c=n(arguments[0]),f=s(c),d=a(arguments[0],c);let p;f===0&&d===0?p=Number.POSITIVE_INFINITY:f===0||d===0?p=Math.max(f,d):p=Math.min(f,d);const m={};Object.defineProperty(m,"maxMessageSize",{get(){return p}}),this._sctp=m}return l.apply(this,arguments)}}function fh(i){if(!(i.RTCPeerConnection&&"createDataChannel"in i.RTCPeerConnection.prototype))return;function e(n,s){const a=n.send;n.send=function(){const u=arguments[0],c=u.length||u.size||u.byteLength;if(n.readyState==="open"&&s.sctp&&c>s.sctp.maxMessageSize)throw new TypeError("Message too large (can send a maximum of "+s.sctp.maxMessageSize+" bytes)");return a.apply(n,arguments)}}const t=i.RTCPeerConnection.prototype.createDataChannel;i.RTCPeerConnection.prototype.createDataChannel=function(){const s=t.apply(this,arguments);return e(s,this),s},Il(i,"datachannel",n=>(e(n.channel,n.target),n))}function g0(i){if(!i.RTCPeerConnection||"connectionState"in i.RTCPeerConnection.prototype)return;const e=i.RTCPeerConnection.prototype;Object.defineProperty(e,"connectionState",{get(){return{completed:"connected",checking:"connecting"}[this.iceConnectionState]||this.iceConnectionState},enumerable:!0,configurable:!0}),Object.defineProperty(e,"onconnectionstatechange",{get(){return this._onconnectionstatechange||null},set(t){this._onconnectionstatechange&&(this.removeEventListener("connectionstatechange",this._onconnectionstatechange),delete this._onconnectionstatechange),t&&this.addEventListener("connectionstatechange",this._onconnectionstatechange=t)},enumerable:!0,configurable:!0}),["setLocalDescription","setRemoteDescription"].forEach(t=>{const n=e[t];e[t]=function(){return this._connectionstatechangepoly||(this._connectionstatechangepoly=s=>{const a=s.target;if(a._lastConnectionState!==a.connectionState){a._lastConnectionState=a.connectionState;const l=new Event("connectionstatechange",s);a.dispatchEvent(l)}return s},this.addEventListener("iceconnectionstatechange",this._connectionstatechangepoly)),n.apply(this,arguments)}})}function m0(i,e){if(!i.RTCPeerConnection||e.browser==="chrome"&&e.version>=71||e.browser==="safari"&&e._safariVersion>=13.1)return;const t=i.RTCPeerConnection.prototype.setRemoteDescription;i.RTCPeerConnection.prototype.setRemoteDescription=function(s){if(s&&s.sdp&&s.sdp.indexOf(`
a=extmap-allow-mixed`)!==-1){const a=s.sdp.split(`
`).filter(l=>l.trim()!=="a=extmap-allow-mixed").join(`
`);i.RTCSessionDescription&&s instanceof i.RTCSessionDescription?arguments[0]=new i.RTCSessionDescription({type:s.type,sdp:a}):s.sdp=a}return t.apply(this,arguments)}}function hh(i,e){if(!(i.RTCPeerConnection&&i.RTCPeerConnection.prototype))return;const t=i.RTCPeerConnection.prototype.addIceCandidate;!t||t.length===0||(i.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?(e.browser==="chrome"&&e.version<78||e.browser==="firefox"&&e.version<68||e.browser==="safari")&&arguments[0]&&arguments[0].candidate===""?Promise.resolve():t.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())})}function dh(i,e){if(!(i.RTCPeerConnection&&i.RTCPeerConnection.prototype))return;const t=i.RTCPeerConnection.prototype.setLocalDescription;!t||t.length===0||(i.RTCPeerConnection.prototype.setLocalDescription=function(){let s=arguments[0]||{};if(typeof s!="object"||s.type&&s.sdp)return t.apply(this,arguments);if(s={type:s.type,sdp:s.sdp},!s.type)switch(this.signalingState){case"stable":case"have-local-offer":case"have-remote-pranswer":s.type="offer";break;default:s.type="answer";break}return s.sdp||s.type!=="offer"&&s.type!=="answer"?t.apply(this,[s]):(s.type==="offer"?this.createOffer:this.createAnswer).apply(this).then(l=>t.apply(this,[l]))})}const z3=Object.freeze(Object.defineProperty({__proto__:null,removeExtmapAllowMixed:m0,shimAddIceCandidateNullOrEmpty:hh,shimConnectionState:g0,shimMaxMessageSize:uh,shimParameterlessSetLocalDescription:dh,shimRTCIceCandidate:ch,shimRTCIceCandidateRelayProtocol:p0,shimSendThrowTypeError:fh},Symbol.toStringTag,{value:"Module"}));function G3({window:i}={},e={shimChrome:!0,shimFirefox:!0,shimSafari:!0}){const t=W2,n=U3(i),s={browserDetails:n,commonShim:z3,extractVersion:Bu,disableLog:P3,disableWarnings:L3,sdp:H3};switch(n.browser){case"chrome":if(!ux||!h0||!e.shimChrome)return t("Chrome shim is not included in this adapter release."),s;if(n.version===null)return t("Chrome shim can not determine version, not shimming."),s;t("adapter.js shimming chrome."),s.browserShim=ux,hh(i,n),dh(i),J2(i,n),Z2(i),h0(i,n),X2(i),rS(i,n),eS(i),tS(i),iS(i,n),ch(i),p0(i),g0(i),uh(i,n),fh(i),m0(i,n);break;case"firefox":if(!fx||!d0||!e.shimFirefox)return t("Firefox shim is not included in this adapter release."),s;t("adapter.js shimming firefox."),s.browserShim=fx,hh(i,n),dh(i),sS(i,n),d0(i,n),oS(i),cS(i),aS(i),lS(i),uS(i),fS(i),hS(i),dS(i),pS(i),ch(i),g0(i),uh(i,n),fh(i);break;case"safari":if(!hx||!e.shimSafari)return t("Safari shim is not included in this adapter release."),s;t("adapter.js shimming safari."),s.browserShim=hx,hh(i,n),dh(i),wS(i),_S(i),yS(i),gS(i),mS(i),xS(i),bS(i),SS(i),ch(i),p0(i),uh(i,n),fh(i),m0(i,n);break;default:t("Unsupported browser!");break}return s}const px=G3({window:typeof window>"u"?void 0:window});function Rl(i,e,t,n){Object.defineProperty(i,e,{get:t,set:n,enumerable:!0,configurable:!0})}class CS{constructor(){this.chunkedMTU=16300,this._dataCount=1,this.chunk=e=>{const t=[],n=e.byteLength,s=Math.ceil(n/this.chunkedMTU);let a=0,l=0;for(;l<n;){const u=Math.min(n,l+this.chunkedMTU),c=e.slice(l,u),f={__peerData:this._dataCount,n:a,data:c,total:s};t.push(f),l=u,a++}return this._dataCount++,t}}}function K3(i){let e=0;for(const s of i)e+=s.byteLength;const t=new Uint8Array(e);let n=0;for(const s of i)t.set(s,n),n+=s.byteLength;return t}const Mg=px.default||px,ku=new class{isWebRTCSupported(){return typeof RTCPeerConnection<"u"}isBrowserSupported(){const i=this.getBrowser(),e=this.getVersion();return this.supportedBrowsers.includes(i)?i==="chrome"?e>=this.minChromeVersion:i==="firefox"?e>=this.minFirefoxVersion:i==="safari"?!this.isIOS&&e>=this.minSafariVersion:!1:!1}getBrowser(){return Mg.browserDetails.browser}getVersion(){return Mg.browserDetails.version||0}isUnifiedPlanSupported(){const i=this.getBrowser(),e=Mg.browserDetails.version||0;if(i==="chrome"&&e<this.minChromeVersion)return!1;if(i==="firefox"&&e>=this.minFirefoxVersion)return!0;if(!window.RTCRtpTransceiver||!("currentDirection"in RTCRtpTransceiver.prototype))return!1;let t,n=!1;try{t=new RTCPeerConnection,t.addTransceiver("audio"),n=!0}catch{}finally{t&&t.close()}return n}toString(){return`Supports:
    browser:${this.getBrowser()}
    version:${this.getVersion()}
    isIOS:${this.isIOS}
    isWebRTCSupported:${this.isWebRTCSupported()}
    isBrowserSupported:${this.isBrowserSupported()}
    isUnifiedPlanSupported:${this.isUnifiedPlanSupported()}`}constructor(){this.isIOS=typeof navigator<"u"?["iPad","iPhone","iPod"].includes(navigator.platform):!1,this.supportedBrowsers=["firefox","chrome","safari"],this.minFirefoxVersion=59,this.minChromeVersion=72,this.minSafariVersion=605}},V3=i=>!i||/^[A-Za-z0-9]+(?:[ _-][A-Za-z0-9]+)*$/.test(i),AS=()=>Math.random().toString(36).slice(2),gx={iceServers:[{urls:"stun:stun.l.google.com:19302"},{urls:["turn:eu-0.turn.peerjs.com:3478","turn:us-0.turn.peerjs.com:3478"],username:"peerjs",credential:"peerjsp"}],sdpSemantics:"unified-plan"};class $3 extends CS{noop(){}blobToArrayBuffer(e,t){const n=new FileReader;return n.onload=function(s){s.target&&t(s.target.result)},n.readAsArrayBuffer(e),n}binaryStringToArrayBuffer(e){const t=new Uint8Array(e.length);for(let n=0;n<e.length;n++)t[n]=e.charCodeAt(n)&255;return t.buffer}isSecure(){return location.protocol==="https:"}constructor(...e){super(...e),this.CLOUD_HOST="0.peerjs.com",this.CLOUD_PORT=443,this.chunkedBrowsers={Chrome:1,chrome:1},this.defaultConfig=gx,this.browser=ku.getBrowser(),this.browserVersion=ku.getVersion(),this.pack=V2,this.unpack=K2,this.supports=(function(){const t={browser:ku.isBrowserSupported(),webRTC:ku.isWebRTCSupported(),audioVideo:!1,data:!1,binaryBlob:!1,reliable:!1};if(!t.webRTC)return t;let n;try{n=new RTCPeerConnection(gx),t.audioVideo=!0;let s;try{s=n.createDataChannel("_PEERJSTEST",{ordered:!0}),t.data=!0,t.reliable=!!s.ordered;try{s.binaryType="blob",t.binaryBlob=!ku.isIOS}catch{}}catch{}finally{s&&s.close()}}catch{}finally{n&&n.close()}return t})(),this.validateId=V3,this.randomToken=AS}}const Pi=new $3,Y3="PeerJS: ";class W3{get logLevel(){return this._logLevel}set logLevel(e){this._logLevel=e}log(...e){this._logLevel>=3&&this._print(3,...e)}warn(...e){this._logLevel>=2&&this._print(2,...e)}error(...e){this._logLevel>=1&&this._print(1,...e)}setLogFunction(e){this._print=e}_print(e,...t){const n=[Y3,...t];for(const s in n)n[s]instanceof Error&&(n[s]="("+n[s].name+") "+n[s].message);e>=3?console.log(...n):e>=2?console.warn("WARNING",...n):e>=1&&console.error("ERROR",...n)}constructor(){this._logLevel=0}}var gn=new W3,Jy={},Q3=Object.prototype.hasOwnProperty,ki="~";function Gu(){}Object.create&&(Gu.prototype=Object.create(null),new Gu().__proto__||(ki=!1));function J3(i,e,t){this.fn=i,this.context=e,this.once=t||!1}function kS(i,e,t,n,s){if(typeof t!="function")throw new TypeError("The listener must be a function");var a=new J3(t,n||i,s),l=ki?ki+e:e;return i._events[l]?i._events[l].fn?i._events[l]=[i._events[l],a]:i._events[l].push(a):(i._events[l]=a,i._eventsCount++),i}function ph(i,e){--i._eventsCount===0?i._events=new Gu:delete i._events[e]}function xi(){this._events=new Gu,this._eventsCount=0}xi.prototype.eventNames=function(){var e=[],t,n;if(this._eventsCount===0)return e;for(n in t=this._events)Q3.call(t,n)&&e.push(ki?n.slice(1):n);return Object.getOwnPropertySymbols?e.concat(Object.getOwnPropertySymbols(t)):e};xi.prototype.listeners=function(e){var t=ki?ki+e:e,n=this._events[t];if(!n)return[];if(n.fn)return[n.fn];for(var s=0,a=n.length,l=new Array(a);s<a;s++)l[s]=n[s].fn;return l};xi.prototype.listenerCount=function(e){var t=ki?ki+e:e,n=this._events[t];return n?n.fn?1:n.length:0};xi.prototype.emit=function(e,t,n,s,a,l){var u=ki?ki+e:e;if(!this._events[u])return!1;var c=this._events[u],f=arguments.length,d,p;if(c.fn){switch(c.once&&this.removeListener(e,c.fn,void 0,!0),f){case 1:return c.fn.call(c.context),!0;case 2:return c.fn.call(c.context,t),!0;case 3:return c.fn.call(c.context,t,n),!0;case 4:return c.fn.call(c.context,t,n,s),!0;case 5:return c.fn.call(c.context,t,n,s,a),!0;case 6:return c.fn.call(c.context,t,n,s,a,l),!0}for(p=1,d=new Array(f-1);p<f;p++)d[p-1]=arguments[p];c.fn.apply(c.context,d)}else{var m=c.length,v;for(p=0;p<m;p++)switch(c[p].once&&this.removeListener(e,c[p].fn,void 0,!0),f){case 1:c[p].fn.call(c[p].context);break;case 2:c[p].fn.call(c[p].context,t);break;case 3:c[p].fn.call(c[p].context,t,n);break;case 4:c[p].fn.call(c[p].context,t,n,s);break;default:if(!d)for(v=1,d=new Array(f-1);v<f;v++)d[v-1]=arguments[v];c[p].fn.apply(c[p].context,d)}}return!0};xi.prototype.on=function(e,t,n){return kS(this,e,t,n,!1)};xi.prototype.once=function(e,t,n){return kS(this,e,t,n,!0)};xi.prototype.removeListener=function(e,t,n,s){var a=ki?ki+e:e;if(!this._events[a])return this;if(!t)return ph(this,a),this;var l=this._events[a];if(l.fn)l.fn===t&&(!s||l.once)&&(!n||l.context===n)&&ph(this,a);else{for(var u=0,c=[],f=l.length;u<f;u++)(l[u].fn!==t||s&&!l[u].once||n&&l[u].context!==n)&&c.push(l[u]);c.length?this._events[a]=c.length===1?c[0]:c:ph(this,a)}return this};xi.prototype.removeAllListeners=function(e){var t;return e?(t=ki?ki+e:e,this._events[t]&&ph(this,t)):(this._events=new Gu,this._eventsCount=0),this};xi.prototype.off=xi.prototype.removeListener;xi.prototype.addListener=xi.prototype.on;xi.prefixed=ki;xi.EventEmitter=xi;Jy=xi;var Ol={};Rl(Ol,"ConnectionType",()=>Da);Rl(Ol,"PeerErrorType",()=>Yr);Rl(Ol,"BaseConnectionErrorType",()=>y0);Rl(Ol,"DataConnectionErrorType",()=>Zy);Rl(Ol,"SerializationType",()=>md);Rl(Ol,"SocketEventType",()=>Ba);Rl(Ol,"ServerMessageType",()=>bi);var Da=(function(i){return i.Data="data",i.Media="media",i})({}),Yr=(function(i){return i.BrowserIncompatible="browser-incompatible",i.Disconnected="disconnected",i.InvalidID="invalid-id",i.InvalidKey="invalid-key",i.Network="network",i.PeerUnavailable="peer-unavailable",i.SslUnavailable="ssl-unavailable",i.ServerError="server-error",i.SocketError="socket-error",i.SocketClosed="socket-closed",i.UnavailableID="unavailable-id",i.WebRTC="webrtc",i})({}),y0=(function(i){return i.NegotiationFailed="negotiation-failed",i.ConnectionClosed="connection-closed",i})({}),Zy=(function(i){return i.NotOpenYet="not-open-yet",i.MessageToBig="message-too-big",i})({}),md=(function(i){return i.Binary="binary",i.BinaryUTF8="binary-utf8",i.JSON="json",i.None="raw",i})({}),Ba=(function(i){return i.Message="message",i.Disconnected="disconnected",i.Error="error",i.Close="close",i})({}),bi=(function(i){return i.Heartbeat="HEARTBEAT",i.Candidate="CANDIDATE",i.Offer="OFFER",i.Answer="ANSWER",i.Open="OPEN",i.Error="ERROR",i.IdTaken="ID-TAKEN",i.InvalidKey="INVALID-KEY",i.Leave="LEAVE",i.Expire="EXPIRE",i})({});const TS="1.5.5";class Z3 extends Jy.EventEmitter{constructor(e,t,n,s,a,l=5e3){super(),this.pingInterval=l,this._disconnected=!0,this._messagesQueue=[];const u=e?"wss://":"ws://";this._baseUrl=u+t+":"+n+s+"peerjs?key="+a}start(e,t){this._id=e;const n=`${this._baseUrl}&id=${e}&token=${t}`;this._socket||!this._disconnected||(this._socket=new WebSocket(n+"&version="+TS),this._disconnected=!1,this._socket.onmessage=s=>{let a;try{a=JSON.parse(s.data),gn.log("Server message received:",a)}catch{gn.log("Invalid server message",s.data);return}this.emit(Ba.Message,a)},this._socket.onclose=s=>{this._disconnected||(gn.log("Socket closed.",s),this._cleanup(),this._disconnected=!0,this.emit(Ba.Disconnected))},this._socket.onopen=()=>{this._disconnected||(this._sendQueuedMessages(),gn.log("Socket open"),this._scheduleHeartbeat())})}_scheduleHeartbeat(){this._wsPingTimer=setTimeout(()=>{this._sendHeartbeat()},this.pingInterval)}_sendHeartbeat(){if(!this._wsOpen()){gn.log("Cannot send heartbeat, because socket closed");return}const e=JSON.stringify({type:bi.Heartbeat});this._socket.send(e),this._scheduleHeartbeat()}_wsOpen(){return!!this._socket&&this._socket.readyState===1}_sendQueuedMessages(){const e=[...this._messagesQueue];this._messagesQueue=[];for(const t of e)this.send(t)}send(e){if(this._disconnected)return;if(!this._id){this._messagesQueue.push(e);return}if(!e.type){this.emit(Ba.Error,"Invalid message");return}if(!this._wsOpen())return;const t=JSON.stringify(e);this._socket.send(t)}close(){this._disconnected||(this._cleanup(),this._disconnected=!0)}_cleanup(){this._socket&&(this._socket.onopen=this._socket.onmessage=this._socket.onclose=null,this._socket.close(),this._socket=void 0),clearTimeout(this._wsPingTimer)}}class MS{constructor(e){this.connection=e}startConnection(e){const t=this._startPeerConnection();if(this.connection.peerConnection=t,this.connection.type===Da.Media&&e._stream&&this._addTracksToConnection(e._stream,t),e.originator){const n=this.connection,s={ordered:!!e.reliable},a=t.createDataChannel(n.label,s);n._initializeDataChannel(a),this._makeOffer()}else this.handleSDP("OFFER",e.sdp)}_startPeerConnection(){gn.log("Creating RTCPeerConnection.");const e=new RTCPeerConnection(this.connection.provider.options.config);return this._setupListeners(e),e}_setupListeners(e){const t=this.connection.peer,n=this.connection.connectionId,s=this.connection.type,a=this.connection.provider;gn.log("Listening for ICE candidates."),e.onicecandidate=l=>{!l.candidate||!l.candidate.candidate||(gn.log(`Received ICE candidates for ${t}:`,l.candidate),a.socket.send({type:bi.Candidate,payload:{candidate:l.candidate,type:s,connectionId:n},dst:t}))},e.oniceconnectionstatechange=()=>{switch(e.iceConnectionState){case"failed":gn.log("iceConnectionState is failed, closing connections to "+t),this.connection.emitError(y0.NegotiationFailed,"Negotiation of connection to "+t+" failed."),this.connection.close();break;case"closed":gn.log("iceConnectionState is closed, closing connections to "+t),this.connection.emitError(y0.ConnectionClosed,"Connection to "+t+" closed."),this.connection.close();break;case"disconnected":gn.log("iceConnectionState changed to disconnected on the connection with "+t);break;case"completed":e.onicecandidate=()=>{};break}this.connection.emit("iceStateChanged",e.iceConnectionState)},gn.log("Listening for data channel"),e.ondatachannel=l=>{gn.log("Received data channel");const u=l.channel;a.getConnection(t,n)._initializeDataChannel(u)},gn.log("Listening for remote stream"),e.ontrack=l=>{gn.log("Received remote stream");const u=l.streams[0],c=a.getConnection(t,n);if(c.type===Da.Media){const f=c;this._addStreamToMediaConnection(u,f)}}}cleanup(){gn.log("Cleaning up PeerConnection to "+this.connection.peer);const e=this.connection.peerConnection;if(!e)return;this.connection.peerConnection=null,e.onicecandidate=e.oniceconnectionstatechange=e.ondatachannel=e.ontrack=()=>{};const t=e.signalingState!=="closed";let n=!1;const s=this.connection.dataChannel;s&&(n=!!s.readyState&&s.readyState!=="closed"),(t||n)&&e.close()}async _makeOffer(){const e=this.connection.peerConnection,t=this.connection.provider;try{const n=await e.createOffer(this.connection.options.constraints);gn.log("Created offer."),this.connection.options.sdpTransform&&typeof this.connection.options.sdpTransform=="function"&&(n.sdp=this.connection.options.sdpTransform(n.sdp)||n.sdp);try{await e.setLocalDescription(n),gn.log("Set localDescription:",n,`for:${this.connection.peer}`);let s={sdp:n,type:this.connection.type,connectionId:this.connection.connectionId,metadata:this.connection.metadata};if(this.connection.type===Da.Data){const a=this.connection;s={...s,label:a.label,reliable:a.reliable,serialization:a.serialization}}t.socket.send({type:bi.Offer,payload:s,dst:this.connection.peer})}catch(s){s!="OperationError: Failed to set local offer sdp: Called in wrong state: kHaveRemoteOffer"&&(t.emitError(Yr.WebRTC,s),gn.log("Failed to setLocalDescription, ",s))}}catch(n){t.emitError(Yr.WebRTC,n),gn.log("Failed to createOffer, ",n)}}async _makeAnswer(){const e=this.connection.peerConnection,t=this.connection.provider;try{const n=await e.createAnswer();gn.log("Created answer."),this.connection.options.sdpTransform&&typeof this.connection.options.sdpTransform=="function"&&(n.sdp=this.connection.options.sdpTransform(n.sdp)||n.sdp);try{await e.setLocalDescription(n),gn.log("Set localDescription:",n,`for:${this.connection.peer}`),t.socket.send({type:bi.Answer,payload:{sdp:n,type:this.connection.type,connectionId:this.connection.connectionId},dst:this.connection.peer})}catch(s){t.emitError(Yr.WebRTC,s),gn.log("Failed to setLocalDescription, ",s)}}catch(n){t.emitError(Yr.WebRTC,n),gn.log("Failed to create answer, ",n)}}async handleSDP(e,t){t=new RTCSessionDescription(t);const n=this.connection.peerConnection,s=this.connection.provider;gn.log("Setting remote description",t);const a=this;try{await n.setRemoteDescription(t),gn.log(`Set remoteDescription:${e} for:${this.connection.peer}`),e==="OFFER"&&await a._makeAnswer()}catch(l){s.emitError(Yr.WebRTC,l),gn.log("Failed to setRemoteDescription, ",l)}}async handleCandidate(e){gn.log("handleCandidate:",e);try{await this.connection.peerConnection.addIceCandidate(e),gn.log(`Added ICE candidate for:${this.connection.peer}`)}catch(t){this.connection.provider.emitError(Yr.WebRTC,t),gn.log("Failed to handleCandidate, ",t)}}_addTracksToConnection(e,t){if(gn.log(`add tracks from stream ${e.id} to peer connection`),!t.addTrack)return gn.error("Your browser does't support RTCPeerConnection#addTrack. Ignored.");e.getTracks().forEach(n=>{t.addTrack(n,e)})}_addStreamToMediaConnection(e,t){gn.log(`add stream ${e.id} to media connection ${t.connectionId}`),t.addStream(e)}}class IS extends Jy.EventEmitter{emitError(e,t){gn.error("Error:",t),this.emit("error",new X3(`${e}`,t))}}class X3 extends Error{constructor(e,t){typeof t=="string"?super(t):(super(),Object.assign(this,t)),this.type=e}}class RS extends IS{get open(){return this._open}constructor(e,t,n){super(),this.peer=e,this.provider=t,this.options=n,this._open=!1,this.metadata=n.metadata}}class Xh extends RS{static#s=this.ID_PREFIX="mc_";get type(){return Da.Media}get localStream(){return this._localStream}get remoteStream(){return this._remoteStream}constructor(e,t,n){super(e,t,n),this._localStream=this.options._stream,this.connectionId=this.options.connectionId||Xh.ID_PREFIX+Pi.randomToken(),this._negotiator=new MS(this),this._localStream&&this._negotiator.startConnection({_stream:this._localStream,originator:!0})}_initializeDataChannel(e){this.dataChannel=e,this.dataChannel.onopen=()=>{gn.log(`DC#${this.connectionId} dc connection success`),this.emit("willCloseOnRemote")},this.dataChannel.onclose=()=>{gn.log(`DC#${this.connectionId} dc closed for:`,this.peer),this.close()}}addStream(e){gn.log("Receiving stream",e),this._remoteStream=e,super.emit("stream",e)}handleMessage(e){const t=e.type,n=e.payload;switch(e.type){case bi.Answer:this._negotiator.handleSDP(t,n.sdp),this._open=!0;break;case bi.Candidate:this._negotiator.handleCandidate(n.candidate);break;default:gn.warn(`Unrecognized message type:${t} from peer:${this.peer}`);break}}answer(e,t={}){if(this._localStream){gn.warn("Local stream already exists on this MediaConnection. Are you answering a call twice?");return}this._localStream=e,t&&t.sdpTransform&&(this.options.sdpTransform=t.sdpTransform),this._negotiator.startConnection({...this.options._payload,_stream:e});const n=this.provider._getMessages(this.connectionId);for(const s of n)this.handleMessage(s);this._open=!0}close(){this._negotiator&&(this._negotiator.cleanup(),this._negotiator=null),this._localStream=null,this._remoteStream=null,this.provider&&(this.provider._removeConnection(this),this.provider=null),this.options&&this.options._stream&&(this.options._stream=null),this.open&&(this._open=!1,super.emit("close"))}}class e4{constructor(e){this._options=e}_buildRequest(e){const t=this._options.secure?"https":"http",{host:n,port:s,path:a,key:l}=this._options,u=new URL(`${t}://${n}:${s}${a}${l}/${e}`);return u.searchParams.set("ts",`${Date.now()}${Math.random()}`),u.searchParams.set("version",TS),fetch(u.href,{referrerPolicy:this._options.referrerPolicy})}async retrieveId(){try{const e=await this._buildRequest("id");if(e.status!==200)throw new Error(`Error. Status:${e.status}`);return e.text()}catch(e){gn.error("Error retrieving ID",e);let t="";throw this._options.path==="/"&&this._options.host!==Pi.CLOUD_HOST&&(t=" If you passed in a `path` to your self-hosted PeerServer, you'll also need to pass in that same path when creating a new Peer."),new Error("Could not get an ID from the server."+t)}}async listAllPeers(){try{const e=await this._buildRequest("peers");if(e.status!==200){if(e.status===401){let t="";throw this._options.host===Pi.CLOUD_HOST?t="It looks like you're using the cloud server. You can email team@peerjs.com to enable peer listing for your API key.":t="You need to enable `allow_discovery` on your self-hosted PeerServer to use this feature.",new Error("It doesn't look like you have permission to list peers IDs. "+t)}throw new Error(`Error. Status:${e.status}`)}return e.json()}catch(e){throw gn.error("Error retrieving list peers",e),new Error("Could not get list peers from the server."+e)}}}class ed extends RS{static#s=this.ID_PREFIX="dc_";static#f=this.MAX_BUFFERED_AMOUNT=8388608;get type(){return Da.Data}constructor(e,t,n){super(e,t,n),this.connectionId=this.options.connectionId||ed.ID_PREFIX+AS(),this.label=this.options.label||this.connectionId,this.reliable=!!this.options.reliable,this._negotiator=new MS(this),this._negotiator.startConnection(this.options._payload||{originator:!0,reliable:this.reliable})}_initializeDataChannel(e){this.dataChannel=e,this.dataChannel.onopen=()=>{gn.log(`DC#${this.connectionId} dc connection success`),this._open=!0,this.emit("open")},this.dataChannel.onmessage=t=>{gn.log(`DC#${this.connectionId} dc onmessage:`,t.data)},this.dataChannel.onclose=()=>{gn.log(`DC#${this.connectionId} dc closed for:`,this.peer),this.close()}}close(e){if(e?.flush){this.send({__peerData:{type:"close"}});return}this._negotiator&&(this._negotiator.cleanup(),this._negotiator=null),this.provider&&(this.provider._removeConnection(this),this.provider=null),this.dataChannel&&(this.dataChannel.onopen=null,this.dataChannel.onmessage=null,this.dataChannel.onclose=null,this.dataChannel=null),this.open&&(this._open=!1,super.emit("close"))}send(e,t=!1){if(!this.open){this.emitError(Zy.NotOpenYet,"Connection is not open. You should listen for the `open` event before sending messages.");return}return this._send(e,t)}async handleMessage(e){const t=e.payload;switch(e.type){case bi.Answer:await this._negotiator.handleSDP(e.type,t.sdp);break;case bi.Candidate:await this._negotiator.handleCandidate(t.candidate);break;default:gn.warn("Unrecognized message type:",e.type,"from peer:",this.peer);break}}}class Xy extends ed{get bufferSize(){return this._bufferSize}_initializeDataChannel(e){super._initializeDataChannel(e),this.dataChannel.binaryType="arraybuffer",this.dataChannel.addEventListener("message",t=>this._handleDataMessage(t))}_bufferedSend(e){(this._buffering||!this._trySend(e))&&(this._buffer.push(e),this._bufferSize=this._buffer.length)}_trySend(e){if(!this.open)return!1;if(this.dataChannel.bufferedAmount>ed.MAX_BUFFERED_AMOUNT)return this._buffering=!0,setTimeout(()=>{this._buffering=!1,this._tryBuffer()},50),!1;try{this.dataChannel.send(e)}catch(t){return gn.error(`DC#:${this.connectionId} Error when sending:`,t),this._buffering=!0,this.close(),!1}return!0}_tryBuffer(){if(!this.open||this._buffer.length===0)return;const e=this._buffer[0];this._trySend(e)&&(this._buffer.shift(),this._bufferSize=this._buffer.length,this._tryBuffer())}close(e){if(e?.flush){this.send({__peerData:{type:"close"}});return}this._buffer=[],this._bufferSize=0,super.close()}constructor(...e){super(...e),this._buffer=[],this._bufferSize=0,this._buffering=!1}}class Ig extends Xy{close(e){super.close(e),this._chunkedData={}}constructor(e,t,n){super(e,t,n),this.chunker=new CS,this.serialization=md.Binary,this._chunkedData={}}_handleDataMessage({data:e}){const t=K2(e),n=t.__peerData;if(n){if(n.type==="close"){this.close();return}this._handleChunk(t);return}this.emit("data",t)}_handleChunk(e){const t=e.__peerData,n=this._chunkedData[t]||{data:[],count:0,total:e.total};if(n.data[e.n]=new Uint8Array(e.data),n.count++,this._chunkedData[t]=n,n.total===n.count){delete this._chunkedData[t];const s=K3(n.data);this._handleDataMessage({data:s})}}_send(e,t){const n=V2(e);if(n instanceof Promise)return this._send_blob(n);if(!t&&n.byteLength>this.chunker.chunkedMTU){this._sendChunks(n);return}this._bufferedSend(n)}async _send_blob(e){const t=await e;if(t.byteLength>this.chunker.chunkedMTU){this._sendChunks(t);return}this._bufferedSend(t)}_sendChunks(e){const t=this.chunker.chunk(e);gn.log(`DC#${this.connectionId} Try to send ${t.length} chunks...`);for(const n of t)this.send(n,!0)}}class t4 extends Xy{_handleDataMessage({data:e}){super.emit("data",e)}_send(e,t){this._bufferedSend(e)}constructor(...e){super(...e),this.serialization=md.None}}class n4 extends Xy{_handleDataMessage({data:e}){const t=this.parse(this.decoder.decode(e)),n=t.__peerData;if(n&&n.type==="close"){this.close();return}this.emit("data",t)}_send(e,t){const n=this.encoder.encode(this.stringify(e));if(n.byteLength>=Pi.chunkedMTU){this.emitError(Zy.MessageToBig,"Message too big for JSON channel");return}this._bufferedSend(n)}constructor(...e){super(...e),this.serialization=md.JSON,this.encoder=new TextEncoder,this.decoder=new TextDecoder,this.stringify=JSON.stringify,this.parse=JSON.parse}}class eb extends IS{static#s=this.DEFAULT_KEY="peerjs";get id(){return this._id}get options(){return this._options}get open(){return this._open}get socket(){return this._socket}get connections(){const e=Object.create(null);for(const[t,n]of this._connections)e[t]=n;return e}get destroyed(){return this._destroyed}get disconnected(){return this._disconnected}constructor(e,t){super(),this._serializers={raw:t4,json:n4,binary:Ig,"binary-utf8":Ig,default:Ig},this._id=null,this._lastServerId=null,this._destroyed=!1,this._disconnected=!1,this._open=!1,this._connections=new Map,this._lostMessages=new Map;let n;if(e&&e.constructor==Object?t=e:e&&(n=e.toString()),t={debug:0,host:Pi.CLOUD_HOST,port:Pi.CLOUD_PORT,path:"/",key:eb.DEFAULT_KEY,token:Pi.randomToken(),config:Pi.defaultConfig,referrerPolicy:"strict-origin-when-cross-origin",serializers:{},...t},this._options=t,this._serializers={...this._serializers,...this.options.serializers},this._options.host==="/"&&(this._options.host=window.location.hostname),this._options.path&&(this._options.path[0]!=="/"&&(this._options.path="/"+this._options.path),this._options.path[this._options.path.length-1]!=="/"&&(this._options.path+="/")),this._options.secure===void 0&&this._options.host!==Pi.CLOUD_HOST?this._options.secure=Pi.isSecure():this._options.host==Pi.CLOUD_HOST&&(this._options.secure=!0),this._options.logFunction&&gn.setLogFunction(this._options.logFunction),gn.logLevel=this._options.debug||0,this._api=new e4(t),this._socket=this._createServerConnection(),!Pi.supports.audioVideo&&!Pi.supports.data){this._delayedAbort(Yr.BrowserIncompatible,"The current browser does not support WebRTC");return}if(n&&!Pi.validateId(n)){this._delayedAbort(Yr.InvalidID,`ID "${n}" is invalid`);return}n?this._initialize(n):this._api.retrieveId().then(s=>this._initialize(s)).catch(s=>this._abort(Yr.ServerError,s))}_createServerConnection(){const e=new Z3(this._options.secure,this._options.host,this._options.port,this._options.path,this._options.key,this._options.pingInterval);return e.on(Ba.Message,t=>{this._handleMessage(t)}),e.on(Ba.Error,t=>{this._abort(Yr.SocketError,t)}),e.on(Ba.Disconnected,()=>{this.disconnected||(this.emitError(Yr.Network,"Lost connection to server."),this.disconnect())}),e.on(Ba.Close,()=>{this.disconnected||this._abort(Yr.SocketClosed,"Underlying socket is already closed.")}),e}_initialize(e){this._id=e,this.socket.start(e,this._options.token)}_handleMessage(e){const t=e.type,n=e.payload,s=e.src;switch(t){case bi.Open:this._lastServerId=this.id,this._open=!0,this.emit("open",this.id);break;case bi.Error:this._abort(Yr.ServerError,n.msg);break;case bi.IdTaken:this._abort(Yr.UnavailableID,`ID "${this.id}" is taken`);break;case bi.InvalidKey:this._abort(Yr.InvalidKey,`API KEY "${this._options.key}" is invalid`);break;case bi.Leave:gn.log(`Received leave message from ${s}`),this._cleanupPeer(s),this._connections.delete(s);break;case bi.Expire:this.emitError(Yr.PeerUnavailable,`Could not connect to peer ${s}`);break;case bi.Offer:{const a=n.connectionId;let l=this.getConnection(s,a);if(l&&(l.close(),gn.warn(`Offer received for existing Connection ID:${a}`)),n.type===Da.Media){const c=new Xh(s,this,{connectionId:a,_payload:n,metadata:n.metadata});l=c,this._addConnection(s,l),this.emit("call",c)}else if(n.type===Da.Data){const c=new this._serializers[n.serialization](s,this,{connectionId:a,_payload:n,metadata:n.metadata,label:n.label,serialization:n.serialization,reliable:n.reliable});l=c,this._addConnection(s,l),this.emit("connection",c)}else{gn.warn(`Received malformed connection type:${n.type}`);return}const u=this._getMessages(a);for(const c of u)l.handleMessage(c);break}default:{if(!n){gn.warn(`You received a malformed message from ${s} of type ${t}`);return}const a=n.connectionId,l=this.getConnection(s,a);l&&l.peerConnection?l.handleMessage(e):a?this._storeMessage(a,e):gn.warn("You received an unrecognized message:",e);break}}}_storeMessage(e,t){this._lostMessages.has(e)||this._lostMessages.set(e,[]),this._lostMessages.get(e).push(t)}_getMessages(e){const t=this._lostMessages.get(e);return t?(this._lostMessages.delete(e),t):[]}connect(e,t={}){if(t={serialization:"default",...t},this.disconnected){gn.warn("You cannot connect to a new Peer because you called .disconnect() on this Peer and ended your connection with the server. You can create a new Peer to reconnect, or call reconnect on this peer if you believe its ID to still be available."),this.emitError(Yr.Disconnected,"Cannot connect to new Peer after disconnecting from server.");return}const n=new this._serializers[t.serialization](e,this,t);return this._addConnection(e,n),n}call(e,t,n={}){if(this.disconnected){gn.warn("You cannot connect to a new Peer because you called .disconnect() on this Peer and ended your connection with the server. You can create a new Peer to reconnect."),this.emitError(Yr.Disconnected,"Cannot connect to new Peer after disconnecting from server.");return}if(!t){gn.error("To call a peer, you must provide a stream from your browser's `getUserMedia`.");return}const s=new Xh(e,this,{...n,_stream:t});return this._addConnection(e,s),s}_addConnection(e,t){gn.log(`add connection ${t.type}:${t.connectionId} to peerId:${e}`),this._connections.has(e)||this._connections.set(e,[]),this._connections.get(e).push(t)}_removeConnection(e){const t=this._connections.get(e.peer);if(t){const n=t.indexOf(e);n!==-1&&t.splice(n,1)}this._lostMessages.delete(e.connectionId)}getConnection(e,t){const n=this._connections.get(e);if(!n)return null;for(const s of n)if(s.connectionId===t)return s;return null}_delayedAbort(e,t){setTimeout(()=>{this._abort(e,t)},0)}_abort(e,t){gn.error("Aborting!"),this.emitError(e,t),this._lastServerId?this.disconnect():this.destroy()}destroy(){this.destroyed||(gn.log(`Destroy peer with ID:${this.id}`),this.disconnect(),this._cleanup(),this._destroyed=!0,this.emit("close"))}_cleanup(){for(const e of this._connections.keys())this._cleanupPeer(e),this._connections.delete(e);this.socket.removeAllListeners()}_cleanupPeer(e){const t=this._connections.get(e);if(t)for(const n of t)n.close()}disconnect(){if(this.disconnected)return;const e=this.id;gn.log(`Disconnect peer with ID:${e}`),this._disconnected=!0,this._open=!1,this.socket.close(),this._lastServerId=e,this._id=null,this.emit("disconnected",e)}reconnect(){if(this.disconnected&&!this.destroyed)gn.log(`Attempting reconnection to server with ID ${this._lastServerId}`),this._disconnected=!1,this._initialize(this._lastServerId);else{if(this.destroyed)throw new Error("This peer cannot reconnect to the server. It has already been destroyed.");if(!this.disconnected&&!this.open)gn.error("In a hurry? We're still trying to make the initial connection!");else throw new Error(`Peer ${this.id} cannot reconnect because it is not disconnected from the server!`)}}listAllPeers(e=t=>{}){this._api.listAllPeers().then(t=>e(t)).catch(t=>this._abort(Yr.ServerError,t))}}var r4=eb;class i4{name="PeerJS";peer=null;userIdHash=null;handshakeCallbacks=new Set;customSignalCallbacks=new Set;connections=new Map;connected=!1;host;constructor(e=["0.peerjs.com"]){this.host=e[0]||"0.peerjs.com"}async initialize(e){this.userIdHash=e;for(let t=1;t<=3;t++)try{await this.attemptConnection(e);return}catch(n){if(n.type==="unavailable-id"&&t<3){console.warn(`[${this.name}] ID taken (stale connection), retrying in 1s... (${t}/3)`),await new Promise(s=>setTimeout(s,1e3));continue}throw n}}attemptConnection(e){return new Promise((t,n)=>{this.peer&&(this.peer.destroy(),this.peer=null),this.peer=new r4(e,{host:this.host,port:443,path:"/",secure:!0,debug:0});let s=!1;const a=l=>{console.error(`[${this.name}] Initialization error:`,l),(l.type==="network"||l.type==="server-error"||l.type==="socket-error"||l.type==="socket-closed")&&(this.connected=!1),s||(s=!0,this.peer?.off("error",a),n(l))};this.peer.on("error",a),this.peer.on("open",l=>{this.connected=!0,console.log(`[${this.name}]  Connected with ID:`,l.substring(0,8)+"..."),s||(s=!0,this.peer?.off("error",a),this.setupRuntimeErrorHandler(),t())}),this.peer.on("connection",l=>{this.setupConnection(l)}),this.peer.on("disconnected",()=>{console.warn(`[${this.name}]  Disconnected from server`),this.connected=!1,setTimeout(()=>{this.peer&&!this.peer.destroyed&&(console.log(`[${this.name}] Reconnecting...`),this.peer.reconnect())},1e3)}),setTimeout(()=>{!this.connected&&!s&&(s=!0,n(new Error("PeerJS connection timeout")))},1e4)})}setupRuntimeErrorHandler(){this.peer&&this.peer.on("error",e=>{console.error(`[${this.name}] Runtime error:`,e),(e.type==="network"||e.type==="server-error"||e.type==="socket-error"||e.type==="socket-closed")&&(console.warn(`[${this.name}] Server connection error, marking disconnected`),this.connected=!1)})}async sendHandshakeMessage(e,t){await this.sendMessage(e,{type:"handshake",message:t})}async sendCustomSignal(e,t){await this.sendMessage(e,{type:"custom",signal:t})}async sendMessage(e,t){if(!this.peer||!this.userIdHash)throw new Error("Not initialized");if(!this.connected)throw new Error("Not connected to PeerJS server");try{let n=this.connections.get(e);(!n||n.open===!1)&&(n=this.peer.connect(e,{reliable:!0,serialization:"json"}),this.setupConnection(n),await new Promise((s,a)=>{const l=setTimeout(()=>{a(new Error("Connection timeout"))},5e3);n.on("open",()=>{clearTimeout(l),s()}),n.on("error",u=>{clearTimeout(l),a(u)})})),n.send(t),console.log(`[${this.name}] Sent ${t.type} to:`,e.substring(0,8))}catch(n){throw console.error(`[${this.name}] Failed to send message:`,n),n}}onHandshakeMessage(e){return this.handshakeCallbacks.add(e),()=>{this.handshakeCallbacks.delete(e)}}onCustomSignal(e){return this.customSignalCallbacks.add(e),()=>{this.customSignalCallbacks.delete(e)}}isConnected(){return this.connected&&this.peer!==null}setupConnection(e){const t=e.peer;e.on("open",()=>{this.connections.set(t,e),console.log(`[${this.name}] Connection opened with:`,t.substring(0,8))}),e.on("data",n=>{n&&n.type==="handshake"&&n.message?(console.log(`[${this.name}] Received handshake from:`,t.substring(0,8)),this.handshakeCallbacks.forEach(s=>{s(t,n.message)})):n&&n.type==="custom"&&n.signal&&(console.log(`[${this.name}] Received custom signal from:`,t.substring(0,8)),this.customSignalCallbacks.forEach(s=>{s(t,n.signal)}))}),e.on("close",()=>{this.connections.delete(t),console.log(`[${this.name}] Connection closed with:`,t.substring(0,8))}),e.on("error",n=>{console.error(`[${this.name}] Connection error with ${t}:`,n),this.connections.delete(t)})}destroy(){this.connections.forEach(e=>{e.close()}),this.connections.clear(),this.peer&&(this.peer.destroy(),this.peer=null),this.handshakeCallbacks.clear(),this.customSignalCallbacks.clear(),this.connected=!1,this.userIdHash=null,console.log(`[${this.name}] Destroyed`)}}function OS(i){throw new Error('Could not dynamically require "'+i+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var gh={exports:{}};gh.exports;var mx;function s4(){return mx||(mx=1,(function(i){(function(){function e(n,s){return s?OS(n):n.slice?e[a(n)]:function(l,u){n(l={exports:{}}),e[a(u)]=l.exports};function a(l){return l.split("/").slice(-1).toString().replace(".js","")}}var t=i;e(function(n){String.random=function(a,l){var u="";for(a=a||24,l=l||"0123456789ABCDEFGHIJKLMNOPQRSTUVWXZabcdefghijklmnopqrstuvwxyz";a-- >0;)u+=l.charAt(Math.floor(Math.random()*l.length));return u},String.match=function(a,l){var u,c;return typeof a!="string"?!1:(typeof l=="string"&&(l={"=":l}),l=l||{},u=l["="]||l["*"]||l[">"]||l["<"],a===u?!0:c!==l["="]?!1:(u=l["*"]||l[">"],a.slice(0,(u||"").length)===u?!0:c!==l["*"]?!1:c!==l[">"]&&c!==l["<"]?a>=l[">"]&&a<=l["<"]:c!==l[">"]&&a>=l[">"]||c!==l["<"]&&a<=l["<"]))},String.hash=function(a,l){if(typeof a=="string"){if(l=l||0,!a.length)return l;for(var u=0,c=a.length,f;u<c;++u)f=a.charCodeAt(u),l=(l<<5)-l+f,l|=0;return l}};var s=Object.prototype.hasOwnProperty;Object.plain=function(a){return a?a instanceof Object&&a.constructor===Object||Object.prototype.toString.call(a).match(/^\[object (\w+)\]$/)[1]==="Object":!1},Object.empty=function(a,l){for(var u in a)if(s.call(a,u)&&(!l||l.indexOf(u)==-1))return!1;return!0},Object.keys=Object.keys||function(a){var l=[];for(var u in a)s.call(a,u)&&l.push(u);return l},(function(){var a,l=setTimeout,u=0,c=0,f=typeof setImmediate!=""+a&&setImmediate||(function(p,m){return typeof MessageChannel==""+a?l:((p=new MessageChannel).port1.onmessage=function(v){v.data==""&&m()},function(v){m=v,p.port2.postMessage("")})})(),d=l.check=l.check||typeof performance!=""+a&&performance||{now:function(){return+new Date}};l.hold=l.hold||9,l.poll=l.poll||function(p){if(l.hold>=d.now()-u&&c++<3333){p();return}f(function(){u=d.now(),p()},c=0)}})(),(function(){var a=setTimeout,l=a.turn=a.turn||function(m){u.push(m)==1&&c(p)},u=l.s=[],c=a.poll,f=0,d,p=function(){(d=u[f++])&&d(),(f==u.length||f==99)&&(u=l.s=u.slice(f),f=0),u.length&&c(p)}})(),(function(){var a,l=setTimeout,u=l.turn;(l.each=l.each||function(c,f,d,p){p=p||9,(function m(v,b,y){if(b=(v=(c||[]).splice(0,p)).length){for(var w=0;w<b&&a===(y=f(v[w]));w++);if(a===y){u(m);return}}d&&d(y)})()})()})()})(e,"./shim"),e(function(n){n.exports=function s(d,l,u){if(!d)return{to:s};var c,f=typeof l=="function",d=(this.tag||(this.tag={}))[d]||f&&(this.tag[d]={tag:d,to:s._={next:function(m){var v;(v=this.to)&&v.next(m)}}});if(f){var p={off:s.off||(s.off=function(){if(this.next===s._.next)return!0;this===this.the.last&&(this.the.last=this.back),this.to.back=this.back,this.next=s._.next,this.back.to=this.to,this.the.last===this.the&&delete this.on.tag[this.the.tag]}),to:s._,next:l,the:d,on:this,as:u};return(p.back=d.last||d).to=p,d.last=p}return(d=d.to)&&c!==l&&d.next(l),d}})(e,"./onto"),e(function(n){n.exports=function(s){return s===null||typeof s=="string"||typeof s=="boolean"||typeof s=="number"&&s!=1/0&&s!=-1/0&&s===s||!!s&&typeof s["#"]=="string"&&Object.keys(s).length===1&&s["#"]}})(e,"./valid"),e(function(n){e("./shim");function s(){var d=+new Date;return c<d?(l=0,c=d+s.drift):c=d+(l+=1)/u+s.drift}s.drift=0;var a=-1/0,l=0,u=999,c=a,f;s.is=function(d,p,m){var v=p&&d&&d._&&d._[">"]||m;if(v)return typeof(v=v[p])=="number"?v:a},s.ify=function(d,p,m,v,b){(d=d||{})._=d._||{},b&&(d._["#"]=b);var y=d._[">"]||(d._[">"]={});return f!==p&&p!=="_"&&(typeof m=="number"&&(y[p]=m),f!==v&&(d[p]=v)),d},n.exports=s})(e,"./state"),e(function(n){e("./shim");function s(a){var l={s:{}},u=l.s;a=a||{max:999,age:1e3*9},l.check=function(f){return u[f]?c(f):!1};var c=l.track=function(f){var d=u[f]||(u[f]={});return d.was=l.now=+new Date,l.to||(l.to=setTimeout(l.drop,a.age+9)),c.ed&&c.ed(f),d};return l.drop=function(f){l.to=null,l.now=+new Date;var d=Object.keys(u);console.STAT&&console.STAT(l.now,+new Date-l.now,"dup drop keys"),setTimeout.each(d,function(p){var m=u[p];m&&(f||a.age)>l.now-m.was||delete u[p]},0,99)},l}n.exports=s})(e,"./dup"),e(function(n){e("./onto"),n.exports=function(l,u){if(this.on){var c=(this.opt||{}).lack||9e3;if(typeof l!="function"){if(!l)return;var d=l["#"]||l,f=(this.tag||"")[d];return f?(u&&(f=this.on(d,u),clearTimeout(f.err),f.err=setTimeout(function(){f.off()},c)),!0):void 0}var d=u&&u["#"]||s(9);if(!l)return d;var p=this.on(d,l,u);return p.err=p.err||setTimeout(function(){p.off(),p.next({err:"Error: No ACK yet.",lack:!0})},c),d}};var s=String.random||function(){return Math.random().toString(36).slice(2)}})(e,"./ask"),e(function(n){function s(b){return b instanceof s?(this._={$:this}).$:this instanceof s?s.create(this._={$:this,opt:b}):new s(b)}s.is=function(b){return b instanceof s||b&&b._&&b===b._.$||!1},s.version=.202,s.chain=s.prototype,s.chain.toJSON=function(){},e("./shim"),s.valid=e("./valid"),s.state=e("./state"),s.on=e("./onto"),s.dup=e("./dup"),s.ask=e("./ask"),(function(){s.create=function(N){N.root=N.root||N,N.graph=N.graph||{},N.on=N.on||s.on,N.ask=N.ask||s.ask,N.dup=N.dup||s.dup();var Q=N.$.opt(N.opt);return N.once||(N.on("in",b,N),N.on("out",b,N),N.on("put",C,N),s.on("create",N),N.on("create",N)),N.once=1,Q};function b(N){if(N){if(N.out===b){this.to.next(N);return}var Q=this,q=Q.as,ee=q.at||q,ne=ee.$,B=ee.dup,z,$=N.DBG;if((z=N["#"])||(z=N["#"]=l(9)),!B.check(z)){if(B.track(z),z=N._,N._=typeof z=="function"?z:function(){},N.$&&N.$===(N.$._||"").$||(N.$=ne),N["@"]&&!N.put&&x(N),!ee.ask(N["@"],N))if($&&($.u=+new Date),N.put){y(N);return}else N.get&&s.on.get(N,ne);$&&($.uc=+new Date),Q.to.next(N),$&&($.ua=+new Date),!(N.nts||N.NTS)&&(N.out=b,ee.on("out",N),$&&($.ue=+new Date))}}}function y(N){if(N){var Q=N._||"",q=Q.root=((Q.$=N.$||"")._||"").root;if(N["@"]&&Q.faith&&!Q.miss){N.out=b,q.on("out",N);return}Q.latch=q.hatch,Q.match=q.hatch=[];var ee=N.put,ne=Q.DBG=N.DBG,B=+new Date;if(Y=Y||B,!(ee["#"]&&ee["."])){ne&&(ne.p=B),Q["#"]=N["#"],Q.msg=N,Q.all=0,Q.stun=1;var z=Object.keys(ee);console.STAT&&console.STAT(B,((ne||Q).pk=+new Date)-B,"put sort");var $=0,V,Z,ae,Ae,be,Ge,Te;(function ve(ke){if(V!=$){if(V=$,!(ae=z[$])){console.STAT&&console.STAT(B,((ne||Q).pd=+new Date)-B,"put"),S(Q);return}(Ae=ee[ae])?(Te=Ae._)?ae!==Te["#"]?Ge=A+R(ae)+"soul not same.":(be=Te[">"])||(Ge=A+R(ae)+"no state."):Ge=A+R(ae)+"no meta.":Ge=A+R(ae)+"no node.",Z=Object.keys(Ae||{})}if(Ge){N.err=Q.err=Ge,S(Q);return}var Me=0,Ie;for(ke=ke||0;ke++<9&&(Ie=Z[Me++]);)if(Ie!=="_"){var Ce=Ae[Ie],ot=be[Ie];if(p===ot){Ge=A+R(Ie)+"on"+R(ae)+"no state.";break}if(!c(Ce)){Ge=A+R(Ie)+"on"+R(ae)+"bad "+typeof Ce+R(Ce);break}w(Ce,Ie,ae,ot,N),++G}if((Z=Z.slice(Me)).length){u(ve);return}++$,Z=null,ve(ke)})()}}}s.on.put=y;function w(N,Q,q,ee,ne){var B=ne._||"",z=B.root,$=z.graph,V,Z=$[q]||m,ae=f(Z,Q,1),Ae=Z[Q],be=B.DBG;(V=console.STAT)&&(!$[q]||!Ae)&&(V.has=(V.has||0)+1);var Ge=te();if(ee>Ge){setTimeout(function(){w(N,Q,q,ee,ne)},(V=ee-Ge)>U?U:V),console.STAT&&console.STAT((be||B).Hf=+new Date,V,"future");return}if(!(ee<ae)&&!(!B.faith&&ee===ae&&(N===Ae||I(N)<=I(Ae))&&!B.miss)){B.stun++;var Te=ne["#"]+B.all++,ve={toString:function(){return Te},_:B};ve.toJSON=ve.toString,z.dup.track(ve)["#"]=ne["#"],be&&(be.ph=be.ph||+new Date),z.on("put",{"#":ve,"@":ne["@"],put:{"#":q,".":Q,":":N,">":ee},ok:ne.ok,_:B})}}function C(N){var Q;(Q=(N._||"").DBG)&&(Q.pa=+new Date,Q.pm=Q.pm||+new Date);var q=this,ee=q.as,ne=ee.graph,B=N._,z=N.put,$=z["#"],V=z["."],Z=z[":"],ae=z[">"];N["#"];var Ae;(Ae=B.msg)&&(Ae=Ae.put)&&(Ae=Ae[$])&&d(Ae,V,ae,Z,$),ne[$]=d(ne[$],V,ae,Z,$),(Ae=(ee.next||"")[$])&&Ae.on("in",N),S(B),q.to.next(N)}function S(N,Q){var q;if(!N.stop&&!(!N.err&&0<--N.stun)&&(N.stop=1,!!(q=N.root))){var ee=N.match;ee.end=1,ee===q.hatch&&(!(ee=N.latch)||ee.end?delete q.hatch:q.hatch=ee),N.hatch&&N.hatch(),setTimeout.each(N.match,function(ne){ne&&ne()}),!(!(Q=N.msg)||N.err||Q.err)&&(Q.out=b,N.root.on("out",Q),O())}}function x(N){var Q=N["@"]||"",q;if(!(q=Q._)){var ee=(ee=N.$)&&(ee=ee._)&&(ee=ee.root)&&(ee=ee.dup);if(!(ee=ee.check(Q)))return;N["@"]=ee["#"]||N["@"];return}q.acks=(q.acks||0)+1,(q.err=N.err)&&(N["@"]=q["#"],S(q)),q.ok=N.ok||q.ok,!q.stop&&!q.crack&&(q.crack=q.match&&q.match.push(function(){k(q)})),k(q)}function k(N){!N||!N.root||N.stun||N.acks!==N.all||N.root.on("in",{"@":N["#"],err:N.err,ok:N.err?p:N.ok||{"":1}})}var A="Error: Invalid graph!",R=function(N){return" '"+(""+N).slice(0,9)+"...' "},I=JSON.stringify,U=2147483647,te=s.state,G=0,Y,O=function(){G>999&&G/-(Y-(Y=+new Date))>1&&(s.window&&console.log("Warning: You're syncing 1K+ records a second, faster than DOM can update - consider limiting query."),O=function(){G=0})}})(),(function(){s.on.get=function(y,w){var C=w._,S=y.get,x=S["#"],k=C.graph[x],A=S["."],R=C.next||(C.next={}),I=R[x],U=y._||{},te=U.DBG=y.DBG;if(te&&(te.g=+new Date),!k)return C.on("get",y);if(A){if((typeof A!="string"||p===k[A])&&!((I||"").next||"")[A]){C.on("get",y);return}k=d({},A,f(k,A),k[A],x)}k&&b(y,k),C.on("get",y)};function b(y,w){var C=+new Date,S=y._||{},x=S.DBG=y.DBG,k=y["#"],A=l(9),R=Object.keys(w||"").sort(),I=((w||"")._||"")["#"];R.length;var U=y.$._.root,te=w===U.graph[I];console.STAT&&console.STAT(C,((x||S).gk=+new Date)-C,"got keys"),w&&(function G(){C=+new Date;for(var Y=0,O,N={},Q;Y<9&&(O=R[Y++]);)d(N,O,f(w,O),w[O],I);R=R.slice(Y),(Q={})[I]=N,N=Q;var q;te&&(q=function(){},q.ram=q.faith=!0),Q=R.length,console.STAT&&console.STAT(C,-(C-(C=+new Date)),"got copied some"),x&&(x.ga=+new Date),U.on("in",{"@":k,"#":A,put:N,"%":Q?A=l(9):p,$:U.$,_:q,DBG:x,FOO:1}),console.STAT&&console.STAT(C,+new Date-C,"got in"),Q&&setTimeout.turn(G)})(),w||U.on("in",{"@":y["#"]})}s.on.get.ack=b})(),(function(){s.chain.opt=function(b){b=b||{};var y=this,w=y._,C=b.peers||b;return Object.plain(b)||(b={}),Object.plain(w.opt)||(w.opt=b),typeof C=="string"&&(C=[C]),Object.plain(w.opt.peers)||(w.opt.peers={}),C instanceof Array&&(b.peers={},C.forEach(function(S){var x={};x.id=x.url=S,b.peers[S]=w.opt.peers[S]=w.opt.peers[S]||x})),a(b,function S(x){var k=this[x];if(this&&this.hasOwnProperty(x)||typeof k=="string"||Object.empty(k)){this[x]=k;return}k&&k.constructor!==Object&&!(k instanceof Array)||a(k,S)}),w.opt.from=b,s.on("opt",w),w.opt.uuid=w.opt.uuid||function(x){return s.state().toString(36).replace(".","")+String.random(x||12)},y}})();var a=function(b,y){Object.keys(b).forEach(y,b)},l=String.random,u=setTimeout.turn,c=s.valid,f=s.state.is,d=s.state.ify,p,m={},v;s.log=function(){return!s.log.off&&v.log.apply(v,arguments),[].slice.call(arguments).join(" ")},s.log.once=function(b,y,w){return(w=s.log.once)[b]=w[b]||0,w[b]++||s.log(y)},typeof window<"u"&&((window.GUN=window.Gun=s).window=window);try{typeof t<"u"&&(t.exports=s)}catch{}n.exports=s,(s.window||{}).console=(s.window||{}).console||{log:function(){}},(v=console).only=function(b,y){return v.only.i&&b===v.only.i&&v.only.i++&&(v.log.apply(v,arguments)||y)},s.log.once("welcome","Hello wonderful person! :) Thanks for using GUN, please ask for help on http://chat.gun.eco if anything takes you longer than 5min to figure out!")})(e,"./root"),e(function(n){var s=e("./root");s.chain.back=function(u,c){var f;if(u=u||1,u===-1||u===1/0)return this._.root.$;if(u===1)return(this._.back||this._).$;var d=this,p=d._;if(typeof u=="string"&&(u=u.split(".")),u instanceof Array){var m=0,v=u.length,f=p;for(m;m<v;m++)f=(f||a)[u[m]];return l!==f?c?d:f:(f=p.back)?f.$.back(u,c):void 0}if(typeof u=="function"){for(var b,f={back:p};(f=f.back)&&l===(b=u(f,c)););return b}return typeof u=="number"?(p.back||p).$.back(u-1):this};var a={},l})(e,"./back"),e(function(n){var s=e("./root");s.chain.chain=function(S){var x=this,k=x._,A=new(S||x).constructor(x),R=A._,I;return R.root=I=k.root,R.id=++I.once,R.back=x._,R.on=s.on,R.on("in",s.on.in,R),R.on("out",s.on.out,R),A};function a(S){var x,k=this.as,A=k.back,R=k.root,I;if(S.$||(S.$=k.$),this.to.next(S),k.err){k.on("in",{put:k.put=p,$:k.$});return}if(x=S.get){if(R.pass&&(R.pass[k.id]=k),k.lex&&Object.keys(k.lex).forEach(function(U){I[U]=k.lex[U]},I=S.get=S.get||{}),x["#"]||k.soul){if(x["#"]=x["#"]||k.soul,S["#"]||(S["#"]=m(9)),A=R.$.get(x["#"])._,x=x["."]){if(b(A.put,x)&&(I=A.ask&&A.ask[x],(A.ask||(A.ask={}))[x]=A.$.get(x)._,A.on("in",{get:x,put:{"#":A.soul,".":x,":":A.put[x],">":w(R.graph[A.soul],x)}}),I))return}else{if(I=A.ask&&A.ask[""],(A.ask||(A.ask={}))[""]=A,p!==A.put&&(A.on("in",A),I))return;S.$=A.$}return R.ask(f,S),R.on("in",S)}if(x["."])return k.get?(S={get:{".":k.get},$:k.$},(A.ask||(A.ask={}))[k.get]=S.$._,A.on("out",S)):(S={get:k.lex?S.get:{},$:k.$},A.on("out",S));if((k.ask||(k.ask={}))[""]=k,k.get)return x["."]=k.get,(A.ask||(A.ask={}))[k.get]=S.$._,A.on("out",S)}return A.on("out",S)}s.on.out=a;function l(S,x){x=x||this.as;var k=x.root,A=S.$||(S.$=x.$),R=(A||"")._||d,I=S.put||"",U=I["#"],te=I["."],G=p!==I["="]?I["="]:I[":"],Y=I[">"]||-1/0,O;if(p!==S.put&&(p===I["#"]||p===I["."]||p===I[":"]&&p===I["="]||p===I[">"])){if(!v(I)){if(!(U=((I||"")._||"")["#"])){console.log("chain not yet supported for",I,"...",S,x);return}return A=x.root.$.get(U),setTimeout.each(Object.keys(I).sort(),function(N){N=="_"||p===(Y=w(I,N))||x.on("in",{$:A,put:{"#":U,".":N,"=":I[N],">":Y},VIA:S})})}x.on("in",{$:R.back.$,put:{"#":U=R.back.soul,".":te=R.has||R.get,"=":I,">":w(R.back.put,te)},via:S});return}(S.seen||"")[x.id]||((S.seen||(S.seen=function(){}))[x.id]=x,x!==R&&(Object.keys(S).forEach(function(N){I[N]=S[N]},I={}),I.get=x.get||I.get,!x.soul&&!x.has?I.$$$=I.$$$||x.$:R.soul&&(I.$=x.$,I.$$=I.$$||R.$),S=I),c(S,x),(x.soul||S.$$)&&Y>=w(k.graph[U],te)&&((I=k.$.get(U)._).put=C(I.put,te,Y,G,U)),!R.soul&&Y>=w(k.graph[U],te)&&(O=(k.$.get(U)._.next||"")[te])&&(O.put=G,typeof(I=v(G))=="string"&&(O.put=k.$.get(I)._.put||G)),this.to&&this.to.next(S),x.any&&setTimeout.each(Object.keys(x.any),function(N){(N=x.any[N])&&N(S)},0,99),x.echo&&setTimeout.each(Object.keys(x.echo),function(N){(N=x.echo[N])&&N.on("in",S)},0,99),((S.$$||"")._||R).soul&&(O=x.next)&&(O=O[te])&&(I={},Object.keys(S).forEach(function(N){I[N]=S[N]}),I.$=(S.$$||S.$).get(I.get=te),delete I.$$,delete I.$$$,O.on("in",I)),u(S,x))}s.on.in=l;function u(S,x){if(x=x||this.as||S.$._,!(S.$$&&this!==s.on)&&!(!S.put||x.soul)){var k=S.put||"",A=k["="]||k[":"],te,R=x.root,I=R.$.get(k["#"]).get(k["."])._;if(typeof(A=v(A))!="string"){this===s.on&&((I.echo||(I.echo={}))[x.id]=x);return}if(!((I.echo||(I.echo={}))[x.id]&&!(R.pass||"")[x.id])){if(te=R.pass){if(te[A+x.id])return;te[A+x.id]=1}(I.echo||(I.echo={}))[x.id]=x,x.has&&(x.link=A);var U=R.$.get(I.link=A)._;(U.echo||(U.echo={}))[I.id]=I;var te=x.ask||"";(te[""]||x.lex)&&U.on("out",{get:{"#":A}}),setTimeout.each(Object.keys(te),function(G,Y){!G||!(Y=te[G])||Y.on("out",{get:{"#":A,".":G}})},0,99)}}}s.on.link=u;function c(S,x){var k=S.put||"",A=p!==k["="]?k["="]:k[":"],R=x.root,I,U;if(p===A){if(x.soul&&p!==x.put||(U=(S.$$||S.$||"")._||"",S["@"]&&(p!==U.put||p!==x.put)))return;(I=x.link||S.linked)&&delete(R.$.get(I)._.echo||"")[x.id],x.has&&(x.link=null),x.put=p,setTimeout.each(Object.keys(x.next||""),function(te,G){(G=x.next[te])&&(I&&delete(R.$.get(I).get(te)._.echo||"")[G.id],G.on("in",{get:te,put:p,$:G.$}))},0,99);return}x.soul||S.$$||(I=v(A),U=S.$._||"",!((I===U.link||x.has&&!U.link)&&!((R.pass||"")[x.id]&&typeof I!="string"))&&(delete(U.echo||"")[x.id],c({get:x.get,put:p,$:S.$,linked:S.linked=S.linked||U.link},x)))}s.on.unlink=c;function f(S,x){var k=this.as,A=k.$._;A.root;var R=k.get||"",I=(S.put||"")[R["#"]]||"";if(!S.put||typeof R["."]=="string"&&p===I[R["."]]){if(p!==A.put||!A.soul&&!A.has)return;A.ack=(A.ack||0)+1,A.on("in",{get:A.get,put:A.put=p,$:A.$,"@":S["@"]});return}(S._||{}).miss=1,s.on.put(S)}var d={},p,m=String.random,v=s.valid,b=function(S,x){return S&&Object.prototype.hasOwnProperty.call(S,x)},y=s.state,w=y.is,C=y.ify})(e,"./chain"),e(function(n){var s=e("./root");s.chain.get=function(p,m,v){var b,y;if(typeof p=="string"){if(p.length==0)return(b=this.chain())._.err={err:s.log("0 length key!",p)},m&&m.call(b,b._.err),b;var w=this,C=w._,S=C.next||c;(b=S[p])||(b=p&&a(p,w)),b=b&&b.$}else if(typeof p=="function"){let te=function(G,Y,O){if(!te.stun&&!((B=k.pass)&&!B[A])){var N=G.$._,Q=(G.$$||"")._,q=(Q||N).put,ee=!N.has&&!N.soul,ne={},B;if((ee||d===q)&&(q=d===((B=G.put)||"")["="]?d===(B||"")[":"]?B:B[":"]:B["="]),typeof(B=s.valid(q))=="string"&&(q=d===(B=k.$.get(B)._.put)?x.not?d:q:B),!(x.not&&d===q)){if(d===x.stun){if((B=k.stun)&&B.on&&(C.$.back(function(z){if(B.on(""+z.id,ne={}),(ne.run||0)<te.id)return ne}),!ne.run&&B.on(""+N.id,ne={}),!ne.run&&Q&&B.on(""+Q.id,ne={}),te.id>ne.run&&((!ne.stun||ne.stun.end)&&(ne.stun=B.on("stun"),ne.stun=ne.stun&&ne.stun.last),ne.stun&&!ne.stun.end))){(ne.stun.add||(ne.stun.add={}))[A]=function(){te(G,Y,1)};return}if(d===q&&(O=0),(B=k.hatch)&&!B.end&&d===x.hatch&&!O){if(R[N.$._.id])return;R[N.$._.id]=1,B.push(function(){te(G,Y,1)});return}R={}}if(k.pass){if(k.pass[A+N.id])return;k.pass[A+N.id]=1}if(x.on){x.ok.call(N.$,q,N.get,G,Y||te);return}if(x.v2020){x.ok(G,Y||te);return}Object.keys(G).forEach(function(z){B[z]=G[z]},B={}),G=B,G.put=q,x.ok.call(x.as,G,Y||te)}}};var I=te;if(m===!0)return l(this,p,m,v),this;b=this;var C=b._,x=m||{},k=C.root,A;x.at=C,x.ok=p;var R={};return te.at=C,(C.any||(C.any={}))[A=String.random(7)]=te,te.off=function(){te.stun=1,C.any&&delete C.any[A]},te.rid=u,te.id=x.run||++k.once,y=k.pass,(k.pass={})[A]=1,x.out=x.out||{get:{}},C.on("out",x.out),k.pass=y,b}else{if(typeof p=="number")return this.get(""+p,m,v);if(typeof(y=f(p))=="string")return this.get(y,m,v);(y=this.get.next)&&(b=y(this,p))}return b?(m&&typeof m=="function"&&b.get(m,v),b):((b=this.chain())._.err={err:s.log("Invalid get request!",p)},m&&m.call(b,b._.err),b)};function a(p,m){var v=m._,b=v.next,y=m.chain(),w=y._;return b||(b=v.next={}),b[w.get=p]=w,m===v.root.$?w.soul=p:(v.soul||v.has)&&(w.has=p),w}function l(p,m,v,b){var y=p._,w=0,C;return(C=y.soul||y.link)?m(C,b,y):y.jam?y.jam.push([m,b]):(y.jam=[[m,b]],p.get(function(x,k){if(!(d===x.put&&!y.root.opt.super&&(C=Object.keys(y.root.opt.peers).length)&&++w<=C)){k.rid(x);var A=(A=x.$)&&A._||{},R=0,I;for(C=y.jam,delete y.jam;I=C[R++];){var U=I[0];I=I[1],U&&U(A.link||A.soul||s.valid(x.put)||((x.put||{})._||{})["#"],I,x,k)}}},{out:{get:{".":!0}}}),p)}function u(p){var m=this.at||this.on;if(!p||m.soul||m.has)return this.off();if(p=(p=(p=p.$||p)._||p).id){m.map;var v;if((v=this.seen||(this.seen={}))[p])return!0;v[p]=!0}}var c={},f=s.valid,d})(e,"./get"),e(function(n){var s=e("./root");s.chain.put=function(b,y,w){var C=this,S=C._,x=S.root;w=w||{},w.root=S.root,w.run||(w.run=x.once),a(w,S.id),w.ack=w.ack||y,w.via=w.via||C,w.data=w.data||b,w.soul||(w.soul=S.soul||typeof y=="string"&&y);var k=w.state=w.state||s.state();return typeof b=="function"?(b(function(A){w.data=A,C.put(f,f,w)}),C):w.soul?(w.$=x.$.get(w.soul),w.todo=[{it:w.data,ref:w.$}],w.turn=w.turn||p,w.ran=w.ran||l,(function A(){var R=w.todo,I=R.pop(),U=I.it;I.ref&&I.ref._.id;var te,G,Y,O,N;if(a(w,I.ref),(O=I.todo)&&(G=O.pop(),U=U[G],O.length&&R.push(I)),G&&(R.path||(R.path=[])).push(G),!(te=m(U))&&!(N=s.is(U))){if(!Object.plain(U)){l.err(w,"Invalid data: "+c(U)+" at "+(w.via.back(function(B){B.get&&O.push(B.get)},O=[])||O.join("."))+"."+(R.path||[]).join("."));return}for(var Q=w.seen||(w.seen=[]),q=Q.length;q--;)if(U===(O=Q[q]).it){te=U=O.link;break}}if(G&&te)I.node=v(I.node,G,k,U);else{let B=function(z,$){var V=Y.link["#"];$&&($.off(),$.rid(z));var Z=V||z.soul||(O=(z.$$||z.$)._||"").soul||O.link||((O=O.put||"")._||"")["#"]||O["#"]||((O=z.put||"")&&z.$$?O["#"]:(O["="]||O[":"]||"")["#"]);if(!V&&a(w,z.$),!Z&&!I.link["#"]){(I.wait||(I.wait=[])).push(function(){B(z,$)});return}Z||(Z=[],(z.$$||z.$).back(function(ae){if(O=ae.soul||ae.link)return Z.push(O);Z.push(ae.get)}),Z=Z.reverse().join("/")),Y.link["#"]=Z,!N&&(((w.graph||(w.graph={}))[Z]=Y.node||(Y.node={_:{}}))._["#"]=Z),delete w.wait[ee],Y.wait&&setTimeout.each(Y.wait,function(ae){ae&&ae()}),w.ran(w)};var ne=B;if(!w.seen){l.err(w,"Data at root of graph must be a node (an object).");return}w.seen.push(Y={it:U,link:{},todo:N?[]:Object.keys(U).sort().reverse(),path:(R.path||[]).slice(),up:I}),I.node=v(I.node,G,k,Y.link),!N&&Y.todo.length&&R.push(Y);var ee=w.seen.length;(w.wait||(w.wait={}))[ee]="",O=(Y.ref=N?U:G?I.ref.get(G):I.ref)._,(O=U&&(U._||"")["#"]||O.soul||O.link)?B({soul:O}):Y.ref.get(B,{run:w.run,v2020:1,out:{get:{".":" "}}})}if(!R.length)return w.ran(w);w.turn(A)})(),C):(u(w),C)};function a(b,y){if(y){y=(y._||"").id||y;var w=b.root.stun||(b.root.stun={on:s.on}),C={},S;b.stun||(b.stun=w.on("stun",function(){})),(S=w.on(""+y))&&S.the.last.next(C),!(C.run>=b.run)&&w.on(""+y,function(x){if(b.stun.end){this.off(),this.to.next(x);return}x.run=x.run||b.run,x.stun=x.stun||b.stun})}}function l(b){if(b.err){l.end(b.stun,b.root);return}if(!(b.todo.length||b.end||!Object.empty(b.wait))){b.end=1;var y=b.$.back(-1)._,w=y.root,C=y.ask(function(A){w.on("ack",A),A.err&&!A.lack&&s.log(A),++S>(b.acks||0)&&this.off(),b.ack&&b.ack(A,this)},b.opt),S=0,x=b.stun,k;(k=function(){x&&(l.end(x,w),setTimeout.each(Object.keys(x=x.add||""),function(A){(A=x[A])&&A()}))}).hatch=k,b.ack&&!b.ok&&(b.ok=b.acks||9),b.via._.on("out",{put:b.out=b.graph,ok:b.ok&&{"@":b.ok+1},opt:b.opt,"#":C,_:k})}}l.end=function(b,y){b.end=d,b.the.to===b&&b===b.the.last&&delete y.stun,b.off()},l.err=function(b,y){(b.ack||d).call(b,b.out={err:b.err=s.log(y)}),b.ran(b)};function u(b){var y=b.via._,w;b.via=b.via.back(function(C){if(C.soul||!C.get)return C.$;w=b.data,(b.data={})[C.get]=w}),(!b.via||!b.via._.soul)&&(b.via=y.root.$.get(((b.data||"")._||"")["#"]||y.$.back("opt.uuid")())),b.via.put(b.data,b.ack,b)}function c(b,y){return b&&(y=b.constructor)&&y.name||typeof b}var f,d=function(){},p=setTimeout.turn,m=s.valid,v=s.state.ify})(e,"./put"),e(function(n){var s=e("./root");e("./chain"),e("./back"),e("./put"),e("./get"),n.exports=s})(e,"./index"),e(function(n){var s=e("./index");s.chain.on=function(u,c,f,d){var p=this,m=p._;m.root;var v;if(typeof u=="string")return c?(v=m.on(u,c,f||m,d),f&&f.$&&(f.subs||(f.subs=[])).push(v),p):m.on(u);var b=c;return(b=b===!0?{change:!0}:b||{}).not=1,b.on=1,p.get(u,b),p},s.chain.once=function(u,c){if(c=c||{},!u)return a(this);var f=this,d=f._,p=d.root;d.put;var m=String.random(7),v;return f.get(function(b,y,w,C){var S=this,x=S._,k=x.one||(x.one={});if(C.stun||k[m]==="")return;if((v=s.valid(b))===!0){A();return}if(typeof v=="string")return;clearTimeout((d.one||"")[m]),clearTimeout(k[m]),k[m]=setTimeout(A,c.wait||99);function A(R){if(!x.has&&!x.soul&&(x={put:b,get:y}),l===(v=x.put)&&(v=((w.$$||"")._||"").put),typeof s.valid(v)=="string"&&(v=p.$.get(v)._.put,v===l&&!R)){k[m]=setTimeout(function(){A(1)},c.wait||99);return}C.stun||k[m]!==""&&(k[m]="",(d.soul||d.has)&&C.off(),u.call(S,v,x.get),clearTimeout(k[m]))}},{on:1}),f};function a(u,c,f){return s.log.once("valonce","Chainable val is experimental, its behavior and API may change moving forward. Please play with it and report bugs and ideas on how to improve it."),(f=u.chain())._.nix=u.once(function(d,p){f._.on("in",this._)}),f._.lex=u._.lex,f}s.chain.off=function(){var u=this,c=u._,f,d=c.back;if(d)return c.ack=0,(f=d.next)&&f[c.get]&&delete f[c.get],(f=d.any)&&(delete d.any,d.any={}),(f=d.ask)&&delete f[c.get],(f=d.put)&&delete f[c.get],(f=c.soul)&&delete d.root.graph[f],(f=c.map)&&Object.keys(f).forEach(function(p,m){m=f[p],m.link&&d.root.$.get(m.link).off()}),(f=c.next)&&Object.keys(f).forEach(function(p,m){m=f[p],m.$.off()}),c.on("off",{}),u};var l})(e,"./on"),e(function(n){var s=e("./index"),a=s.chain.get.next;s.chain.get.next=function(f,d){var p;return Object.plain(d)?(p=((p=d["#"])||"")["="]||p)?f.get(p):((p=f.chain()._).lex=d,f.on("in",function(m){String.match(m.get||(m.put||"")["."],d["."]||d["#"]||d)&&p.on("in",m),this.to.next(m)}),p.$):(a||u)(f,d)},s.chain.map=function(f,d,p){var m=this,v=m._,b,y;return Object.plain(f)&&(b=f["."]?f:{".":f},f=c),f?(s.log.once("mapfn","Map functions are experimental, their behavior and API may change moving forward. Please play with it and report bugs and ideas on how to improve it."),y=m.chain(),m.map().on(function(w,C,S,x){var k=(f||u).call(this,w,C,S,x);if(c!==k){if(w===k)return y._.on("in",S);if(s.is(k))return y._.on("in",k._);var A={};Object.keys(S.put).forEach(function(R){A[R]=S.put[R]},A),A["="]=k,y._.on("in",{get:C,put:A})}}),y):((y=v.each)||((v.each=y=m.chain())._.lex=b||y._.lex||v.lex,y._.nix=m.back("nix"),m.on("in",l,y._)),y)};function l(f){this.to.next(f);var d=this.as,p=f.$,m=p._,v=f.put,b;!m.soul&&!f.$$||(b=d.lex)&&!String.match(f.get||(v||"")["."],b["."]||b["#"]||b)||s.on.link(f,d)}var u=function(){},c})(e,"./map"),e(function(n){var s=e("./index");s.chain.set=function(a,l,u){var c=this,f=c.back(-1),d,p;return l=l||function(){},u=u||{},u.item=u.item||a,(d=((a||"")._||"")["#"])&&((a={})["#"]=d),typeof(p=s.valid(a))=="string"?c.get(d=p).put(a,l,u):s.is(a)?(c.put(function(m){a.get(function(v,b,y){if(!v)return l.call(c,{err:s.log('Only a node can be linked! Not "'+y.put+'"!')});(p={})[v]={"#":v},m(p)},!0)}),a):(Object.plain(a)&&(a=f.get(d=c.back("opt.uuid")()).put(a)),c.get(d||f.back("opt.uuid")(7)).put(a,l,u))}})(e,"./set"),e(function(n){e("./shim");var s=function(){},a=JSON.parseAsync||function(f,d,p){var m,v=+new Date;try{d(m,JSON.parse(f,p),l.sucks(+new Date-v))}catch(b){d(b)}},l=JSON.stringifyAsync||function(f,d,p,m){var v,b=+new Date;try{d(v,JSON.stringify(f,p,m),l.sucks(+new Date-b))}catch(y){d(y)}};l.sucks=function(f){f>99&&(console.log("Warning: JSON blocking CPU detected. Add `gun/lib/yson.js` to fix."),l.sucks=s)};function u(f){var d=function(){},p=f.opt||{};p.log=p.log||console.log,p.gap=p.gap||p.wait||0,p.max=p.max||(p.memory?p.memory*999*999:3e8)*.3,p.pack=p.pack||p.max*.01*.01,p.puff=p.puff||9;var m=setTimeout.turn||setTimeout,v=f.dup,b=v.check,y=v.track,w=d.hear=function(x,k){if(x){if(p.max<=x.length)return d.say({dam:"!",err:"Message too big!"},k);d===this&&(w.d+=x.length||0,++w.c);var A=k.SH=+new Date,R=x[0],I;if(R==="["){a(x,function(U,te){if(U||!te)return d.say({dam:"!",err:"DAM JSON parse error."},k);console.STAT&&console.STAT(+new Date,te.length,"# on hear batch");var G=p.puff;(function Y(){for(var O=+new Date,N=0,Q;N<G&&(Q=te[N++]);)d.hear(Q,k);te=te.slice(N),console.STAT&&console.STAT(O,+new Date-O,"hear loop"),C(k),te.length&&m(Y,0)})()}),x="";return}if(R==="{"||(x["#"]||Object.plain(x))&&(I=x)){if(I)return w.one(I,k,A);a(x,function(U,te){if(U||!te)return d.say({dam:"!",err:"DAM JSON parse error."},k);w.one(te,k,A)});return}}};w.one=function(x,k,Y){var R,I,U,te,G;if(x.DBG&&(x.DBG=G={DBG:x.DBG}),G&&(G.h=Y),G&&(G.hp=+new Date),(R=x["#"])||(R=x["#"]=String.random(9)),!(U=b(R))&&(I=x["##"],!(I&&(U=x["@"]||x.get&&R)&&v.check(te=U+I)))){if((x._=function(){}).via=d.leap=k,(U=x["><"])&&typeof U=="string"&&U.slice(0,99).split(",").forEach(function(O){this[O]=1},x._.yo={}),U=x.dam){(U=d.hear[U])&&U(x,k,f),y(R);return}(U=x.ok)&&(x._.near=U["/"]);var Y=+new Date;G&&(G.is=Y),k.SI=R,y.ed=function(O){R===O&&(y.ed=0,(O=v.s[R])&&(O.via=k,x.get&&(O.it=x)))},f.on("in",d.last=x),G&&(G.hd=+new Date),console.STAT&&console.STAT(Y,+new Date-Y,x.get?"msg get":x.put?"msg put":"msg"),y(R),te&&y(te),d.leap=d.last=null}},w.c=w.d=0,(function(){var x=0,k;d.hash=function(I,U){var te,G,Y,O=+new Date;l(I.put,function N(Q,q){var ee=(G||(G=Y=q||"")).slice(0,32768);if(te=String.hash(ee,te),G=G.slice(32768),G){m(N,0);return}console.STAT&&console.STAT(O,+new Date-O,"say json+hash"),I._.$put=Y,I["##"]=te,d.say(I,U),delete I._.$put},A)};function A(I,U){var te;return U instanceof Object?(Object.keys(U).sort().forEach(R,{to:te={},on:U}),te):U}function R(I){this.to[I]=this.on[I]}d.say=function(I,U){var te;if((te=this)&&(te=te.to)&&te.next&&te.next(I),!I)return!1;var G,Y,O,N=I["@"],Q=I._||(I._=function(){}),q=I.DBG,ee=+new Date;if(Q.y=Q.y||ee,U||q&&(q.y=ee),(G=I["#"])||(G=I["#"]=String.random(9)),!k&&y(G),!(Y=I["##"])&&c!==I.put&&!Q.via&&N){d.hash(I,U);return}if(!U&&N&&(U=(te=v.s[N])&&(te.via||(te=te.it)&&(te=te._)&&te.via)||(te=d.last)&&N===te["#"]&&d.leap),!U&&N)return v.s[N]?void 0:(console.STAT&&console.STAT(+new Date,++x,"total no peer to ack to"),!1);if(N&&!I.put&&!Y&&((v.s[N]||"").it||"")["##"])return!1;if(!U&&d.way)return d.way(I);if(q&&(q.yh=+new Date),!(O=Q.raw)){d.raw(I,U);return}if(q&&(q.yr=+new Date),!U||!U.id){if(!Object.plain(U||p.peers))return!1;var ee=+new Date;p.puff;var ne=p.peers,B=Object.keys(U||p.peers||{});console.STAT&&console.STAT(ee,+new Date-ee,"peer keys"),(function V(){var Z=+new Date;k=1;var ae=Q.raw;Q.raw=O;for(var Ae=0,be;Ae<9&&(be=(B||"")[Ae++]);)(be=ne[be]||(U||"")[be])&&d.say(I,be);Q.raw=ae,k=0,B=B.slice(Ae),console.STAT&&console.STAT(Z,+new Date-Z,"say loop"),B.length&&(m(V,0),N&&y(N))})();return}if(!U.wire&&d.wire&&d.wire(U),G!==U.last){if(U.last=G,U===Q.via||(te=Q.yo)&&(te[U.url]||te[U.pid]||te[U.id]))return!1;if(console.STAT&&console.STAT(ee,((q||Q).yp=+new Date)-(Q.y||ee),"say prep"),!k&&N&&y(N),U.batch){if(U.tail=(te=U.tail||0)+O.length,U.tail<=p.pack){U.batch+=(te?",":"")+O;return}C(U)}U.batch="[";var z=+new Date;setTimeout(function(){console.STAT&&console.STAT(z,+new Date-z,"0ms TO"),C(U)},p.gap),S(O,U),console.STAT&&N===U.SI&&console.STAT(ee,+new Date-U.SH,"say ack")}},d.say.c=d.say.d=0,d.raw=function(I,U){if(!I)return"";var te=I._||{},G,Y;if(Y=te.raw)return Y;if(typeof I=="string")return I;var O=I["##"],N=I["@"];if(O&&N){if(!te.via&&b(N+O))return!1;if(Y=(v.s[N]||"").it){if(O===Y["##"])return!1;Y["##"]||(Y["##"]=O)}}if(!I.dam&&!I["@"]){var Q=0,q=[];Y=p.peers;for(var ee in Y){var ne=Y[ee];if(q.push(ne.url||ne.pid||ne.id),++Q>6)break}Q>1&&(I["><"]=q.join())}if(I.put&&(Y=I.ok)&&(I.ok={"@":(Y["@"]||1)-1,"/":Y["/"]==I._.near?d.near:Y["/"]}),G=te.$put){Y={},Object.keys(I).forEach(function(z){Y[z]=I[z]}),Y.put=":])([:",l(Y,function(z,$){if(!z){var V=+new Date;Y=$.indexOf('"put":":])([:"'),B(c,$=$.slice(0,Y+6)+G+$.slice(Y+14)),console.STAT&&console.STAT(V,+new Date-V,"say slice")}});return}l(I,B);function B(z,$){z||(te.raw=$,d.say(I,U))}}})();function C(x){var k=x.batch,A=typeof k=="string";if(A&&(k+="]"),x.batch=x.tail=null,!!k&&!(A?3>k.length:!k.length)){if(!A)try{k=k.length===1?k[0]:JSON.stringify(k)}catch(R){return p.log("DAM JSON stringify error",R)}k&&S(k,x)}}function S(x,k){try{var A=k.wire;k.say?k.say(x):A.send&&A.send(x),d.say.d+=x.length||0,++d.say.c}catch{(k.queue=k.queue||[]).push(x)}}return d.near=0,d.hi=function(x){var k=x.wire,A;if(!k){d.wire(x.length&&{url:x,id:x}||x);return}x.id?p.peers[x.url||x.id]=x:(A=x.id=x.id||x.url||String.random(9),d.say({dam:"?",pid:f.opt.pid},p.peers[A]=x),delete v.s[x.last]),x.met||(d.near++,x.met=+new Date,f.on("hi",x)),A=x.queue,x.queue=[],setTimeout.each(A||[],function(R){S(R,x)},0,9)},d.bye=function(x){x.met&&--d.near,delete x.met,f.on("bye",x);var k=+new Date;k=k-(x.met||k),d.bye.time=((d.bye.time||k)+k)/2},d.hear["!"]=function(x,k){p.log("Error:",x.err)},d.hear["?"]=function(x,k){x.pid&&(k.pid||(k.pid=x.pid),x["@"])||(d.say({dam:"?",pid:p.pid,"@":x["#"]},k),delete v.s[k.last])},d.hear.mob=function(x,k){if(x.peers){var A=Object.keys(x.peers),R=A[Math.random()*A.length>>0];R&&(d.bye(k),d.hi(R))}},f.on("create",function(x){x.opt.pid=x.opt.pid||String.random(9),this.to.next(x),x.on("out",d.say)}),f.on("bye",function(x,k){x=p.peers[x.id||x]||x,this.to.next(x),x.bye?x.bye():(k=x.wire)&&k.close&&k.close(),delete p.peers[x.id],x.wire=null}),f.on("bye",function(x,k){this.to.next(x),(k=console.STAT)&&(k.peers=d.near),(k=x.url)&&setTimeout(function(){},p.lack||9e3)}),f.on("hi",function(x,k){if(this.to.next(x),(k=console.STAT)&&(k.peers=d.near),!p.super){var A=Object.keys(f.next||"");A.length>9999&&!console.SUBS&&console.log(console.SUBS="Warning: You have more than 10K live GETs, which might use more bandwidth than your screen can show - consider `.off()`."),setTimeout.each(A,function(R){var I=f.next[R];if(p.super||(I.ask||"")[""]){d.say({get:{"#":R}},x);return}setTimeout.each(Object.keys(I.ask||""),function(U){U&&d.say({"##":String.hash((f.graph[R]||"")[U]),get:{"#":R,".":U}},x)})})}}),d}var c;try{n.exports=u}catch{}})(e,"./mesh"),e(function(n){var s=e("./index");s.Mesh=e("./mesh"),s.on("opt",function(l){if(this.to.next(l),l.once)return;var u=l.opt;if(u.WebSocket===!1)return;var c=s.window||{},f=u.WebSocket||c.WebSocket||c.webkitWebSocket||c.mozWebSocket;if(!f)return;u.WebSocket=f;var d=u.mesh=u.mesh||s.Mesh(l);d.wire||u.wire,d.wire=u.wire=p;function p(y){try{if(!y||!y.url)return C&&C(y);var w=y.url.replace(/^http/,"ws"),C=y.wire=new u.WebSocket(w);return C.onclose=function(){v(y),u.mesh.bye(y)},C.onerror=function(S){v(y)},C.onopen=function(){u.mesh.hi(y)},C.onmessage=function(S){S&&u.mesh.hear(S.data||S,y)},C}catch{u.mesh.bye(y)}}setTimeout(function(){!u.super&&l.on("out",{dam:"hi"})},1);var m=2*999;function v(y){clearTimeout(y.defer),u.peers[y.url]&&(b&&y.retry<=0||(y.retry=(y.retry||u.retry+1||60)-(-y.tried+(y.tried=+new Date)<m*4?1:0),y.defer=setTimeout(function w(){if(b&&b.hidden)return setTimeout(w,m);p(y)},m)))}var b=""+a!=typeof document&&document});var a})(e,"./websocket"),e(function(n){if(!(typeof Gun>"u")){var s=function(){},a;try{a=(Gun.window||s).localStorage}catch{}a||(Gun.log("Warning: No localStorage exists to persist data to!"),a={setItem:function(u,c){this[u]=c},removeItem:function(u){delete this[u]},getItem:function(u){return this[u]}});var l=JSON.stringifyAsync||function(u,c,f,d){var p;try{c(p,JSON.stringify(u,f,d))}catch(m){c(m)}};Gun.on("create",function u(c){this.to.next(c);var f=c.opt;c.graph;var d=[],p,m,v,b;if(f.localStorage===!1)return;f.prefix=f.file||"gun/";try{p=u[f.prefix]=u[f.prefix]||JSON.parse(v=a.getItem(f.prefix))||{}}catch{p=u[f.prefix]={}}v=(v||"").length,c.on("get",function(w){this.to.next(w);var C=w.get,S,x,k,A;!C||!(S=C["#"])||(x=p[S]||A,x&&(k=C["."])&&!Object.plain(k)&&(x=Gun.state.ify({},k,Gun.state.is(x,k),x[k],S)),Gun.on.get.ack(w,x))}),c.on("put",function(w){this.to.next(w);var C=w.put,S=C["#"],x=C["."],k=w["#"],A=w.ok||"";if((c.next||"")[S]){if(p[S]=Gun.state.ify(p[S],x,C[">"],C[":"],S),b&&v>4999880){c.on("in",{"@":k,err:"localStorage max!"});return}!w["@"]&&(!w._.via||Math.random()<A["@"]/A["/"])&&d.push(k),!m&&(m=setTimeout(y,9+v/333))}});function y(){if(!d.length&&((setTimeout.turn||"").s||"").length){setTimeout(y,99);return}var w=d;clearTimeout(m),m=!1,d=[],l(p,function(C,S){try{!C&&a.setItem(f.prefix,S)}catch(x){C=b=x||"localStorage failure"}C&&(Gun.log(C+" Consider using GUN's IndexedDB plugin for RAD for more storage space, https://gun.eco/docs/RAD#install"),c.on("localStorage:error",{err:C,get:f.prefix,put:p})),v=S.length,setTimeout.each(w,function(x){c.on("in",{"@":x,err:C,ok:0})},0,99)})}})}})(e,"./localStorage")})(),(function(){var Y;if(""+Y!=typeof Gun){var e=function(O){console.warn("Warning! Deprecated internal utility will break in next version:",O)},t=Gun;t.fn=t.fn||{is:function(O){return e("fn"),!!O&&typeof O=="function"}},t.bi=t.bi||{is:function(O){return e("bi"),O instanceof Boolean||typeof O=="boolean"}},t.num=t.num||{is:function(O){return e("num"),!n(O)&&(O-parseFloat(O)+1>=0||O===1/0||O===-1/0)}},t.text=t.text||{is:function(O){return e("text"),typeof O=="string"}},t.text.ify=t.text.ify||function(O){return e("text.ify"),t.text.is(O)?O:typeof JSON<"u"?JSON.stringify(O):O&&O.toString?O.toString():O},t.text.random=t.text.random||function(O,N){e("text.random");var Q="";for(O=O||24,N=N||"0123456789ABCDEFGHIJKLMNOPQRSTUVWXZabcdefghijklmnopqrstuvwxyz";O>0;)Q+=N.charAt(Math.floor(Math.random()*N.length)),O--;return Q},t.text.match=t.text.match||function(O,N){var Q,q;return e("text.match"),typeof O!="string"?!1:(typeof N=="string"&&(N={"=":N}),N=N||{},Q=N["="]||N["*"]||N[">"]||N["<"],O===Q?!0:q!==N["="]?!1:(Q=N["*"]||N[">"]||N["<"],O.slice(0,(Q||"").length)===Q?!0:q!==N["*"]?!1:q!==N[">"]&&q!==N["<"]?O>=N[">"]&&O<=N["<"]:q!==N[">"]&&O>=N[">"]||q!==N["<"]&&O<=N["<"]))},t.text.hash=t.text.hash||function(O,N){if(e("text.hash"),typeof O=="string"){if(N=N||0,!O.length)return N;for(var Q=0,q=O.length,ee;Q<q;++Q)ee=O.charCodeAt(Q),N=(N<<5)-N+ee,N|=0;return N}},t.list=t.list||{is:function(O){return e("list"),O instanceof Array}},t.list.slit=t.list.slit||Array.prototype.slice,t.list.sort=t.list.sort||function(O){return e("list.sort"),function(N,Q){return!N||!Q?0:(N=N[O],Q=Q[O],N<Q?-1:N>Q?1:0)}},t.list.map=t.list.map||function(O,N,Q){return e("list.map"),te(O,N,Q)},t.list.index=1,t.obj=t.boj||{is:function(O){return e("obj"),O?O instanceof Object&&O.constructor===Object||Object.prototype.toString.call(O).match(/^\[object (\w+)\]$/)[1]==="Object":!1}},t.obj.put=t.obj.put||function(O,N,Q){return e("obj.put"),(O||{})[N]=Q,O},t.obj.has=t.obj.has||function(O,N){return e("obj.has"),O&&Object.prototype.hasOwnProperty.call(O,N)},t.obj.del=t.obj.del||function(O,N){if(e("obj.del"),!!O)return O[N]=null,delete O[N],O},t.obj.as=t.obj.as||function(O,N,Q,q){return e("obj.as"),O[N]=O[N]||(q===Q?{}:Q)},t.obj.ify=t.obj.ify||function(O){if(e("obj.ify"),k(O))return O;try{O=JSON.parse(O)}catch{O={}}return O},(function(){var O;function N(Q,q){R(this,q)&&O!==this[q]||(this[q]=Q)}t.obj.to=t.obj.to||function(Q,q){return e("obj.to"),q=q||{},te(Q,N,q),q}})(),t.obj.copy=t.obj.copy||function(O){return e("obj.copy"),O&&JSON.parse(JSON.stringify(O))},(function(){function O(N,Q){var q=this.n,ee;if(!(q&&(Q===q||k(q)&&R(q,Q)))&&ee!==Q)return!0}t.obj.empty=t.obj.empty||function(N,Q){return e("obj.empty"),N?!te(N,O,{n:Q}):!0}})(),(function(){function O(q,ee){if(arguments.length===2){O.r=O.r||{},O.r[q]=ee;return}O.r=O.r||[],O.r.push(q)}var N=Object.keys,Q;Object.keys=Object.keys||function(q){return Q(q,function(ee,ne,B){B(ne)})},t.obj.map=Q=t.obj.map||function(q,ee,ne){e("obj.map");var B,z=0,$,V,Z,ae,Ae=typeof ee=="function";if(O.r=B,N&&k(q)&&(Z=N(q),ae=!0),ne=ne||{},n(q)||Z)for($=(Z||q).length;z<$;z++){var be=z+t.list.index;if(Ae){if(V=ae?ee.call(ne,q[Z[z]],Z[z],O):ee.call(ne,q[z],be,O),V!==B)return V}else if(ee===q[ae?Z[z]:z])return Z?Z[z]:be}else for(z in q)if(Ae){if(R(q,z)&&(V=ne?ee.call(ne,q[z],z,O):ee(q[z],z,O),V!==B))return V}else if(ee===q[z])return z;return Ae?O.r:t.list.index?0:-1}})(),t.time=t.time||{},t.time.is=t.time.is||function(O){return e("time"),O?O instanceof Date:+new Date().getTime()};var S=t.fn.is,n=t.list.is,x=t.obj,k=x.is,R=x.has,te=x.map,s={};s.is=function(O){return e("val.is"),O===Y?!1:O===null?!0:O===1/0?!1:u(O)||l(O)||b(O)?!0:s.link.is(O)||!1},s.link=s.rel={_:"#"},(function(){s.link.is=function(N){if(e("val.link.is"),N&&N[a]&&!N._&&k(N)){var Q={};if(te(N,O,Q),Q.id)return Q.id}return!1};function O(N,Q){var q=this;if(q.id)return q.id=!1;if(Q==a&&u(N))q.id=N;else return q.id=!1}})(),s.link.ify=function(O){return e("val.link.ify"),U({},a,O)},t.obj.has._=".";var a=s.link._,Y,l=t.bi.is,b=t.num.is,u=t.text.is,x=t.obj,k=x.is,U=x.put,te=x.map;t.val=t.val||s;var c={_:"_"};c.soul=function(O,N){return e("node.soul"),O&&O._&&O._[N||p]},c.soul.ify=function(O,N){return e("node.soul.ify"),N=typeof N=="string"?{soul:N}:N||{},O=O||{},O._=O._||{},O._[p]=N.soul||O._[p]||d(),O},c.soul._=s.link._,(function(){c.is=function(N,Q,q){e("node.is");var ee;return k(N)&&(ee=c.soul(N))?!te(N,O,{as:q,cb:Q,s:ee,n:N}):!1};function O(N,Q){if(Q!==c._){if(!s.is(N))return!0;this.cb&&this.cb.call(this.as,N,Q,this.n,this.s)}}})(),(function(){c.ify=function(N,Q,q){return e("node.ify"),Q?typeof Q=="string"?Q={soul:Q}:typeof Q=="function"&&(Q={map:Q}):Q={},Q.map&&(Q.node=Q.map.call(q,N,Y,Q.node||{})),(Q.node=c.soul.ify(Q.node||{},Q))&&te(N,O,{o:Q,as:q}),Q.node};function O(N,Q){var q=this.o,ee,ne;if(q.map){ee=q.map.call(this.as,N,""+Q,q.node),ne===ee?A(q.node,Q):q.node&&(q.node[Q]=ee);return}s.is(N)&&(q.node[Q]=N)}})();var x=t.obj,k=x.is,A=x.del,te=x.map,f=t.text,d=f.random,p=c.soul._,Y;t.node=t.node||c;var m=t.state;m.lex=function(){return e("state.lex"),m().toString(36).replace(".","")},m.to=function(O,N,Q){e("state.to");var q=(O||{})[N];return k(q)&&(q=G(q)),m.ify(Q,N,m.is(O,N),q,c.soul(O))},(function(){m.map=function(N,Q,q){e("state.map");var ee,ne=k(ne=N||Q)?ne:null;return N=S(N=N||Q)?N:null,ne&&!N?(Q=b(Q)?Q:m(),ne[w]=ne[w]||{},te(ne,O,{o:ne,s:Q}),ne):(q=q||k(Q)?Q:ee,Q=b(Q)?Q:m(),function(B,z,$,V){if(!N)return O.call({o:$,s:Q},B,z),B;N.call(q||this||{},B,z,$,V),!(R($,z)&&ee===$[z])&&O.call({o:$,s:Q},B,z)})};function O(N,Q){w!==Q&&m.ify(this.o,Q,this.s)}})();var x=t.obj;x.as;var R=x.has,k=x.is,te=x.map,G=x.copy,v=t.num,b=v.is,y=t.fn,S=y.is,w=c._,Y,C={};(function(){C.is=function(Q,q,ee,ne){return e("graph.is"),!Q||!k(Q)||I(Q)?!1:!te(Q,O,{cb:q,fn:ee,as:ne})};function O(Q,q){if(!Q||q!==c.soul(Q)||!c.is(Q,this.fn,this.as))return!0;this.cb&&(N.n=Q,N.as=this.as,this.cb.call(N.as,Q,q,N))}function N(Q){Q&&c.is(N.n,Q,N.as)}})(),(function(){C.ify=function(ne,B,z){e("graph.ify");var $={path:[],obj:ne};return B?typeof B=="string"?B={soul:B}:typeof B=="function"&&(B.map=B):B={},typeof z=="string"&&(B.soul=B.soul||z,z=Y),B.soul&&($.link=s.link.ify(B.soul)),B.shell=(z||{}).shell,B.graph=B.graph||{},B.seen=B.seen||[],B.as=B.as||z,O(B,$),B.root=$.node,B.graph};function O(ne,B){var z;return(z=ee(ne,B))?z:(B.env=ne,B.soul=Q,c.ify(B.obj,N,B)&&(B.link=B.link||s.link.ify(c.soul(B.node)),B.obj!==ne.shell&&(ne.graph[s.link.is(B.link)]=B.node)),B)}function N(ne,B,z){var $=this,V=$.env,Z,ae;if(c._===B&&R(ne,s.link._))return z._;if(Z=q(ne,B,z,$,V)){if(B||($.node=$.node||z||{},R(ne,c._)&&c.soul(ne)&&($.node._=G(ne._)),$.node=c.soul.ify($.node,s.link.is($.link)),$.link=$.link||s.link.ify(c.soul($.node))),(ae=V.map)&&(ae.call(V.as||{},ne,B,z,$),R(z,B))){if(ne=z[B],Y===ne){A(z,B);return}if(!(Z=q(ne,B,z,$,V)))return}if(!B)return $.node;if(Z===!0)return ne;if(ae=O(V,{obj:ne,path:$.path.concat(B)}),!!ae.node)return ae.link}}function Q(ne){var B=this,z=s.link.is(B.link),$=B.env.graph;B.link=B.link||s.link.ify(ne),B.link[s.link._]=ne,B.node&&B.node[c._]&&(B.node[c._][s.link._]=ne),R($,z)&&($[ne]=$[z],A($,z))}function q(ne,B,z,$,V){var Z;if(s.is(ne))return!0;if(k(ne))return 1;if(Z=V.invalid)return ne=Z.call(V.as||{},ne,B,z),q(ne,B,z,$,V);V.err="Invalid value at '"+$.path.concat(B).join(".")+"'!",t.list.is(ne)&&(V.err+=" Use `.set(item)` instead of an Array.")}function ee(ne,B){for(var z=ne.seen,$=z.length,V;$--;)if(V=z[$],B.obj===V.obj)return V;z.push(B)}})(),C.node=function(O){e("graph.node");var N=c.soul(O);if(N)return U({},N,O)},(function(){C.to=function(N,Q,q){if(e("graph.to"),!!N){var ee={};return q=q||{seen:{}},te(N[Q],O,{obj:ee,graph:N,opt:q}),ee}};function O(N,Q){var q,ee;if(c._===Q){if(I(N,s.link._))return;this.obj[Q]=G(N);return}if(!(q=s.link.is(N))){this.obj[Q]=N;return}if(ee=this.opt.seen[q]){this.obj[Q]=ee;return}this.obj[Q]=this.opt.seen[q]=C.to(this.graph,q,this.opt)}})();var S=t.fn.is,x=t.obj,k=x.is,A=x.del,R=x.has,I=x.empty,U=x.put,te=x.map,G=x.copy,Y;t.graph=t.graph||C}})()})(gh)),gh.exports}var Rg,yx;function o4(){return yx||(yx=1,Rg=s4()),Rg}var a4=o4();const l4=Bc(a4),c4=["https://gun-manhattan.herokuapp.com/gun","https://peer.wallie.io/gun","https://gunjs.herokuapp.com/gun","https://gun-us.herokuapp.com/gun","https://gun-eu.herokuapp.com/gun"];class u4{name="Gun";gun=null;userIdHash=null;handshakeCallbacks=new Set;customSignalCallbacks=new Set;connected=!1;messageCounter=0;relays;constructor(e=c4){this.relays=e}async initialize(e){this.userIdHash=e,this.gun=l4({peers:this.relays,localStorage:!1,radisk:!1}),await this.waitForConnection(1e4),this.connected=!0,this.subscribeToInbox(),console.log(`[${this.name}] Initialized for user:`,e.substring(0,8)+"...")}waitForConnection(e){return new Promise(t=>{let n=!1;const s=setInterval(()=>{!n&&this.gun&&(n=!0,clearInterval(s),t())},100);setTimeout(()=>{n||(n=!0,clearInterval(s),console.warn(`[${this.name}] Connection timeout - proceeding anyway (Gun will reconnect)`),t())},e),setTimeout(()=>{!n&&this.gun&&(n=!0,clearInterval(s),t())},500)})}subscribeToInbox(){if(!this.gun||!this.userIdHash)return;const e=`adun/signals/${this.userIdHash}`;this.gun.get(e).map().on((t,n)=>{!t||typeof t!="object"||n==="_"||this.gun.get(e).get(n).map().on((s,a)=>{if(!(!s||a==="_"||typeof s!="object")&&!(s._!==void 0&&Object.keys(s).length<=1))try{this.processIncomingMessage(s),this.gun.get(e).get(n).get(a).put(null)}catch(l){console.error(`[${this.name}] Failed to process message:`,l)}})}),console.log(`[${this.name}] Subscribed to inbox:`,e)}processIncomingMessage(e){!e.from||!e.type||(e.type==="handshake"&&e.message?(console.log(`[${this.name}] Received handshake from:`,e.from.substring(0,8)),this.handshakeCallbacks.forEach(t=>{t(e.from,e.message)})):e.type==="custom"&&e.signal&&(console.log(`[${this.name}] Received custom signal from:`,e.from.substring(0,8)),this.customSignalCallbacks.forEach(t=>{t(e.from,e.signal)})))}generateMessageId(){return this.messageCounter++,`${Date.now()}-${this.messageCounter}-${Math.random().toString(36).substring(2,8)}`}async sendMessage(e,t){if(!this.gun||!this.userIdHash)throw new Error("Not initialized");const n=this.generateMessageId(),s={...t,from:this.userIdHash,timestamp:Date.now(),id:n};return new Promise((a,l)=>{const u=setTimeout(()=>{l(new Error("Send timeout"))},5e3);this.gun.get(`adun/signals/${e}`).get(this.userIdHash).get(n).put(s,c=>{clearTimeout(u),c&&c.err?l(new Error(c.err)):a()})})}async sendHandshakeMessage(e,t){await this.sendMessage(e,{type:"handshake",message:t}),console.log(`[${this.name}] Sent handshake to:`,e.substring(0,8))}async sendCustomSignal(e,t){await this.sendMessage(e,{type:"custom",signal:t}),console.log(`[${this.name}] Sent custom signal to:`,e.substring(0,8))}onHandshakeMessage(e){return this.handshakeCallbacks.add(e),()=>{this.handshakeCallbacks.delete(e)}}onCustomSignal(e){return this.customSignalCallbacks.add(e),()=>{this.customSignalCallbacks.delete(e)}}isConnected(){return this.connected&&this.gun!==null}destroy(){this.handshakeCallbacks.clear(),this.customSignalCallbacks.clear(),this.connected=!1,this.userIdHash=null,this.gun=null,console.log(`[${this.name}] Destroyed`)}}var Og,vc,f4={405:i=>{i.exports=async function*(e){for(let t of e)typeof t=="function"&&(t=t()),yield*t}},580:i=>{var e=/["'&<>]/;i.exports=function(t){var n,s=""+t,a=e.exec(s);if(!a)return s;var l="",u=0,c=0;for(u=a.index;u<s.length;u++){switch(s.charCodeAt(u)){case 34:n="&quot;";break;case 38:n="&amp;";break;case 39:n="&#39;";break;case 60:n="&lt;";break;case 62:n="&gt;";break;default:continue}c!==u&&(l+=s.substring(c,u)),c=u+1,l+=n}return c!==u?l+s.substring(c,u):l}},717:(i,e,t)=>{t.r(e),t.d(e,{addListener:()=>m,argv:()=>u,binding:()=>U,browser:()=>a,chdir:()=>te,cwd:()=>R,emit:()=>C,env:()=>l,listeners:()=>A,nextTick:()=>k,off:()=>b,on:()=>p,once:()=>v,prependListener:()=>S,prependOnceListener:()=>x,removeAllListeners:()=>w,removeListener:()=>y,title:()=>s,umask:()=>I,version:()=>c,versions:()=>f});var n=t(9596);const s="browser",a=!0,l={},u=[],c="",f={};function d(){}const p=d,m=d,v=d,b=d,y=d,w=d,C=d,S=d,x=d,k=(G,...Y)=>n(()=>G(...Y)),A=G=>[],R=()=>"/",I=()=>0,U=G=>{throw new Error("process.binding is not supported")},te=G=>{throw new Error("process.chdir is not supported")}},736:(i,e,t)=>{i.exports=function(n){function s(u){let c,f,d,p=null;function m(...v){if(!m.enabled)return;const b=m,y=Number(new Date),w=y-(c||y);b.diff=w,b.prev=c,b.curr=y,c=y,v[0]=s.coerce(v[0]),typeof v[0]!="string"&&v.unshift("%O");let C=0;v[0]=v[0].replace(/%([a-zA-Z%])/g,(S,x)=>{if(S==="%%")return"%";C++;const k=s.formatters[x];if(typeof k=="function"){const A=v[C];S=k.call(b,A),v.splice(C,1),C--}return S}),s.formatArgs.call(b,v),(b.log||s.log).apply(b,v)}return m.namespace=u,m.useColors=s.useColors(),m.color=s.selectColor(u),m.extend=a,m.destroy=s.destroy,Object.defineProperty(m,"enabled",{enumerable:!0,configurable:!1,get:()=>p!==null?p:(f!==s.namespaces&&(f=s.namespaces,d=s.enabled(u)),d),set:v=>{p=v}}),typeof s.init=="function"&&s.init(m),m}function a(u,c){const f=s(this.namespace+(c===void 0?":":c)+u);return f.log=this.log,f}function l(u,c){let f=0,d=0,p=-1,m=0;for(;f<u.length;)if(d<c.length&&(c[d]===u[f]||c[d]==="*"))c[d]==="*"?(p=d,m=f,d++):(f++,d++);else{if(p===-1)return!1;d=p+1,m++,f=m}for(;d<c.length&&c[d]==="*";)d++;return d===c.length}return s.debug=s,s.default=s,s.coerce=function(u){return u instanceof Error?u.stack||u.message:u},s.disable=function(){const u=[...s.names,...s.skips.map(c=>"-"+c)].join(",");return s.enable(""),u},s.enable=function(u){s.save(u),s.namespaces=u,s.names=[],s.skips=[];const c=(typeof u=="string"?u:"").trim().replace(/\s+/g,",").split(",").filter(Boolean);for(const f of c)f[0]==="-"?s.skips.push(f.slice(1)):s.names.push(f)},s.enabled=function(u){for(const c of s.skips)if(l(u,c))return!1;for(const c of s.names)if(l(u,c))return!0;return!1},s.humanize=t(6585),s.destroy=function(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")},Object.keys(n).forEach(u=>{s[u]=n[u]}),s.names=[],s.skips=[],s.formatters={},s.selectColor=function(u){let c=0;for(let f=0;f<u.length;f++)c=(c<<5)-c+u.charCodeAt(f),c|=0;return s.colors[Math.abs(c)%s.colors.length]},s.enable(s.load()),s}},815:(i,e,t)=>{var n,s=t(717),a=t(3519),l=t(6611);try{n=t(2376)}catch{}var u=function(){},c=s!==void 0&&/^v?\.0/.test(s.version),f=function(v){return typeof v=="function"},d=function(v,b,y,w){w=a(w);var C=!1;v.on("close",function(){C=!0}),l(v,{readable:b,writable:y},function(x){if(x)return w(x);C=!0,w()});var S=!1;return function(x){if(!C&&!S)return S=!0,(function(k){return!!c&&!!n&&(k instanceof(n.ReadStream||u)||k instanceof(n.WriteStream||u))&&f(k.close)})(v)?v.close(u):(function(k){return k.setHeader&&f(k.abort)})(v)?v.abort():f(v.destroy)?v.destroy():void w(x||new Error("stream was destroyed"))}},p=function(v){v()},m=function(v,b){return v.pipe(b)};i.exports=function(){var v,b=Array.prototype.slice.call(arguments),y=f(b[b.length-1]||u)&&b.pop()||u;if(Array.isArray(b[0])&&(b=b[0]),b.length<2)throw new Error("pump requires two streams per minimum");var w=b.map(function(C,S){var x=S<b.length-1;return d(C,x,S>0,function(k){v||(v=k),k&&w.forEach(p),x||(w.forEach(p),y(v))})});return b.reduce(m)}},988:(i,e,t)=>{t.d(e,{A:()=>b});var n=t(9639);function s(y){const w=y<0?1:0;return y=Math.abs(Number(y||1)),Math.floor(Math.log10(y))+1+w}function a(y){return ArrayBuffer.isView(y)?"arraybufferview":Array.isArray(y)?"array":y instanceof Number?"number":y instanceof Boolean?"boolean":y instanceof Set?"set":y instanceof Map?"map":y instanceof String?"string":y instanceof ArrayBuffer?"arraybuffer":typeof y}function l(y,w,C){const S=[];let x=null;return l._encode(S,y),x=(0,n.xW)(S),l.bytes=x.length,ArrayBuffer.isView(w)?(w.set(x,C),w):x}l.bytes=-1,l._floatConversionDetected=!1,l._encode=function(y,w){if(w!=null)switch(a(w)){case"object":l.dict(y,w);break;case"map":l.dictMap(y,w);break;case"array":l.list(y,w);break;case"set":l.listSet(y,w);break;case"string":l.string(y,w);break;case"number":case"boolean":l.number(y,w);break;case"arraybufferview":l.buffer(y,new Uint8Array(w.buffer,w.byteOffset,w.byteLength));break;case"arraybuffer":l.buffer(y,new Uint8Array(w))}};const u=new Uint8Array([101]),c=new Uint8Array([100]),f=new Uint8Array([108]);l.buffer=function(y,w){y.push((0,n.L0)(w.length+":"),w)},l.string=function(y,w){y.push((0,n.L0)((0,n.L0)(w).byteLength+":"+w))},l.number=function(y,w){if(Number.isInteger(w))return y.push((0,n.L0)("i"+BigInt(w)+"e"));const C=2147483648,S=(w/C|0)*C+(w%C|0);y.push((0,n.L0)("i"+S+"e")),S===w||l._floatConversionDetected||(l._floatConversionDetected=!0,console.warn('WARNING: Possible data corruption detected with value "'+w+'":','Bencoding only defines support for integers, value was converted to "'+S+'"'),console.trace())},l.dict=function(y,w){y.push(c);let C,S=0;const x=Object.keys(w).sort(),k=x.length;for(;S<k;S++)C=x[S],w[C]!=null&&(l.string(y,C),l._encode(y,w[C]));y.push(u)},l.dictMap=function(y,w){y.push(c);const C=Array.from(w.keys()).sort();for(const S of C)w.get(S)!=null&&(ArrayBuffer.isView(S)?l._encode(y,S):l.string(y,String(S)),l._encode(y,w.get(S)));y.push(u)},l.list=function(y,w){let C=0;const S=w.length;for(y.push(f);C<S;C++)w[C]!=null&&l._encode(y,w[C]);y.push(u)},l.listSet=function(y,w){y.push(f);for(const C of w)C!=null&&l._encode(y,C);y.push(u)};const d=l;function p(y,w,C){let S=0,x=1;for(let k=w;k<C;k++){const A=y[k];if(A<58&&A>=48)S=10*S+(A-48);else if(k!==w||A!==43){if(k!==w||A!==45){if(A===46)break;throw new Error("not a number: buffer["+k+"] = "+A)}x=-1}}return S*x}function m(y,w,C,S){return y==null||y.length===0?null:(typeof w!="number"&&S==null&&(S=w,w=void 0),typeof C!="number"&&S==null&&(S=C,C=void 0),m.position=0,m.encoding=S||null,m.data=ArrayBuffer.isView(y)?new Uint8Array(y.slice(w,C)):(0,n.L0)(y),m.bytes=m.data.length,m.next())}m.bytes=0,m.position=0,m.data=null,m.encoding=null,m.next=function(){switch(m.data[m.position]){case 100:return m.dictionary();case 108:return m.list();case 105:return m.integer();default:return m.buffer()}},m.find=function(y){let w=m.position;const C=m.data.length,S=m.data;for(;w<C;){if(S[w]===y)return w;w++}throw new Error('Invalid data: Missing delimiter "'+String.fromCharCode(y)+'" [0x'+y.toString(16)+"]")},m.dictionary=function(){m.position++;const y={};for(;m.data[m.position]!==101;){const w=m.buffer();let C=(0,n.dU)(w);C.includes("")&&(C=(0,n.V5)(w)),y[C]=m.next()}return m.position++,y},m.list=function(){m.position++;const y=[];for(;m.data[m.position]!==101;)y.push(m.next());return m.position++,y},m.integer=function(){const y=m.find(101),w=p(m.data,m.position+1,y);return m.position+=y+1-m.position,w},m.buffer=function(){let y=m.find(58);const w=p(m.data,m.position,y),C=++y+w;return m.position=C,m.encoding?(0,n.dU)(m.data.slice(y,C)):m.data.slice(y,C)};function v(y){if(y==null)return 0;const w=a(y);switch(w){case"arraybufferview":return(function(C){const S=C.byteLength-C.byteOffset;return s(S)+1+S})(y);case"string":return(function(C){const S=(0,n.L0)(C).byteLength;return s(S)+1+S})(y);case"array":case"set":return(function(C){let S=2;for(const x of C)S+=v(x);return S})(y);case"number":return 1+s(Math.floor(y))+1;case"bigint":return 1+y.toString().length+1;case"object":return(function(C){let S=2;const x=Object.keys(C);for(let k=0;k<x.length;k++){const A=(0,n.L0)(x[k]).byteLength;S+=s(A)+1+A,S+=v(C[x[k]])}return S})(y);case"map":return(function(C){let S=2;for(const[x,k]of C){const A=(0,n.L0)(x).byteLength;S+=s(A)+1+A,S+=v(k)}return S})(y);default:throw new TypeError(`Unsupported value of type "${w}"`)}}const b={encode:d,decode:m,byteLength:v,encodingLength:v}},1035:(i,e,t)=>{var n=t(717);const s=n!==void 0&&!!n.hrtime,a=65535,l=s?1e8:100,u=s?()=>{const[f,d]=n.hrtime();return 1e9*f+d}:()=>performance.now();function c(f){return(u()-f)/l&a}i.exports=function(f){const d=u(),p=10*(f||5),m=[0];let v=1,b=c(d)-1&a;return function(y){const w=c(d);let C=w-b&a;for(C>p&&(C=p),b=w;C--;)v===p&&(v=0),m[v]=m[v===0?p-1:v-1],v++;y&&(m[v-1]+=y);const S=m[v-1],x=m.length<p?0:m[v===p?0:v];return m.length<10?S:10*(S-x)/m.length}}},1048:()=>{},1133:(i,e,t)=>{let n=t(8673);i.exports=new n(t(8446))},1314:i=>{i.exports=function(e,t){if(!(t>=e.length||t<0)){var n=e.pop();if(t<e.length){var s=e[t];return e[t]=n,s}return n}}},1467:i=>{function e(t,n){if(typeof t[0]=="string")return t.join("");if(typeof t[0]=="number")return new Uint8Array(t);const s=new Uint8Array(n);let a=0;for(let l=0,u=t.length;l<u;l++){const c=t[l];s.set(c,a),a+=c.byteLength||c.length}return s}i.exports=async function*(t,n=512,s={}){typeof n=="object"&&(n=(s=n).size);let{nopad:a,zeroPadding:l=!0}=s;a&&(l=!1);let u=[],c=0;for await(const f of t)if(c+=f.byteLength||f.length||1,u.push(f),c>=n){const d=e(u,c);let p=0;for(;c>=n;)yield d.slice(p,p+n),c-=n,p+=n;u=[d.slice(p,d.length)]}c&&(yield e(u,l?n:c))}},1827:()=>{},2072:i=>{i.exports={wait:function(e){return new Promise(t=>setTimeout(t,e))}}},2123:()=>{},2376:()=>{},2532:()=>{},2701:()=>{},2799:()=>{},2878:i=>{function e(a,l){return{start:a.start,end:a.end,index:l}}function t(a){return{start:a.start,end:a.end}}function n(a,l){return a.index-l.index}function s(a,l){return a.start-l.start}i.exports=function(a,l,u){if(typeof l!="string")throw new TypeError("argument str must be a string");var c=l.indexOf("=");if(c===-1)return-2;var f=l.slice(c+1).split(","),d=[];d.type=l.slice(0,c);for(var p=0;p<f.length;p++){var m=f[p].split("-"),v=parseInt(m[0],10),b=parseInt(m[1],10);isNaN(v)?(v=a-b,b=a-1):isNaN(b)&&(b=a-1),b>a-1&&(b=a-1),isNaN(v)||isNaN(b)||v>b||v<0||d.push({start:v,end:b})}return d.length<1?-1:u&&u.combine?(function(y){for(var w=y.map(e).sort(s),C=0,S=1;S<w.length;S++){var x=w[S],k=w[C];x.start>k.end+1?w[++C]=x:x.end>k.end&&(k.end=x.end,k.index=Math.min(k.index,x.index))}w.length=C+1;var A=w.sort(n).map(t);return A.type=y.type,A})(d):d}},3033:(i,e,t)=>{function n(a){return(a>>3)+ +(a%8!=0)}t.d(e,{A:()=>s});class s{get length(){return this.buffer.length<<3}constructor(l=0,u){const c=u?.grow;this.grow=c?Number.isFinite(c)?n(c):c:0,this.buffer=typeof l=="number"?new Uint8Array(n(l)):l}get(l){const u=l>>3;return u<this.buffer.length&&!!(this.buffer[u]&128>>l%8)}set(l,u=!0){const c=l>>3;if(u){if(c>=this.buffer.length){const f=Math.max(c+1,Math.min(2*this.buffer.length,this.grow));if(f<=this.grow){const d=new Uint8Array(f);d.set(this.buffer),this.buffer=d}}this.buffer[c]|=128>>l%8}else c<this.buffer.length&&(this.buffer[c]&=~(128>>l%8))}setAll(l,u=0){const c=Math.min(n(u+l.length),this.grow);if(this.buffer.length<c){const p=new Uint8Array(c);p.set(this.buffer),this.buffer=p}let f=u>>3,d=128>>u%8;for(let p=0;p<l.length;p++)if(l[p]?this.buffer[f]|=d:this.buffer[f]&=~d,d===1){if(f+=1,f>=this.buffer.length)break;d=128}else d>>=1}forEach(l,u=0,c=8*this.buffer.length){let f=u>>3,d=128>>u%8;for(let p=u;p<c;p++)l(!!(this.buffer[f]&d),p),d===1?(f+=1,d=128):d>>=1}isEmpty(){for(let l=0;l<this.buffer.length;l++)if(this.buffer[l]!==0)return!1;return!0}}},3065:(i,e,t)=>{var n=t(717),s=t(5472),a=t(3085),l=function(u,c,f){this.tokenBucket=new s(u,u,c,null),this.tokenBucket.content=u,this.curIntervalStart=a(),this.tokensThisInterval=0,this.fireImmediately=f};l.prototype={tokenBucket:null,curIntervalStart:0,tokensThisInterval:0,fireImmediately:!1,removeTokens:function(u,c){if(u>this.tokenBucket.bucketSize)return n.nextTick(c.bind(null,"Requested tokens "+u+" exceeds maximum tokens per interval "+this.tokenBucket.bucketSize,null)),!1;var f=this,d=a();if((d<this.curIntervalStart||d-this.curIntervalStart>=this.tokenBucket.interval)&&(this.curIntervalStart=d,this.tokensThisInterval=0),u>this.tokenBucket.tokensPerInterval-this.tokensThisInterval){if(this.fireImmediately)n.nextTick(c.bind(null,null,-1));else{var p=Math.ceil(this.curIntervalStart+this.tokenBucket.interval-d);setTimeout(function(){f.tokenBucket.removeTokens(u,m)},p)}return!1}return this.tokenBucket.removeTokens(u,m);function m(v,b){if(v)return c(v,null);f.tokensThisInterval+=u,c(null,b)}},tryRemoveTokens:function(u){if(u>this.tokenBucket.bucketSize)return!1;var c=a();if((c<this.curIntervalStart||c-this.curIntervalStart>=this.tokenBucket.interval)&&(this.curIntervalStart=c,this.tokensThisInterval=0),u>this.tokenBucket.tokensPerInterval-this.tokensThisInterval)return!1;var f=this.tokenBucket.tryRemoveTokens(u);return f&&(this.tokensThisInterval+=u),f},getTokensRemaining:function(){return this.tokenBucket.drip(),this.tokenBucket.content}},i.exports=l},3085:(i,e,t)=>{var n=t(717);i.exports=function(){if(n!==void 0&&n.hrtime){var s=n.hrtime(),a=s[0],l=s[1];return 1e3*a+Math.floor(l/1e6)}return new Date().getTime()}},3198:i=>{i.exports=class{constructor(e){this.decoder=new TextDecoder(e==="utf16le"?"utf16-le":e)}get remaining(){return-1}decode(e){return this.decoder.decode(e,{stream:!0})}flush(){return this.decoder.decode(new Uint8Array(0))}}},3208:()=>{},3278:()=>{},3468:()=>{typeof ReadableStream<"u"&&(ReadableStream.prototype[Symbol.asyncIterator]||(ReadableStream.prototype[Symbol.asyncIterator]=function({preventCancel:i}={}){const e=this.getReader(),t=this;let n=e.read();return{next(){const s=n;return n=e.read(),s},return:async s=>(await n,e.releaseLock(),i||t.cancel(),{done:!0,value:s}),async throw(s){throw await this.return(),s},[Symbol.asyncIterator](){return this}}}),ReadableStream.prototype.getIterator||(ReadableStream.prototype.getIterator=function({preventCancel:i}={}){return this[Symbol.asyncIterator]({preventCancel:i})}))},3519:(i,e,t)=>{var n=t(6587);function s(l){var u=function(){return u.called?u.value:(u.called=!0,u.value=l.apply(this,arguments))};return u.called=!1,u}function a(l){var u=function(){if(u.called)throw new Error(u.onceError);return u.called=!0,u.value=l.apply(this,arguments)},c=l.name||"Function wrapped with `once`";return u.onceError=c+" shouldn't be called more than once",u.called=!1,u}i.exports=n(s),i.exports.strict=n(a),s.proto=s(function(){Object.defineProperty(Function.prototype,"once",{value:function(){return s(this)},configurable:!0}),Object.defineProperty(Function.prototype,"onceStrict",{value:function(){return a(this)},configurable:!0})})},3714:(i,e,t)=>{const n=t(9596);i.exports=class{constructor(s){if(this.store=s,this.chunkLength=s.chunkLength,!this.store||!this.store.get||!this.store.put)throw new Error("First argument must be abstract-chunk-store compliant");this.mem=[]}put(s,a,l=()=>{}){this.mem[s]=a,this.store.put(s,a,u=>{this.mem[s]=null,l(u)})}get(s,a,l=()=>{}){if(typeof a=="function")return this.get(s,null,a);let u=this.mem[s];if(!u)return this.store.get(s,a,l);a||(a={});const c=a.offset||0,f=a.length||u.length-c;c===0&&f===u.length||(u=u.slice(c,f+c)),n(()=>l(null,u))}close(s=()=>{}){this.store.close(s)}destroy(s=()=>{}){this.store.destroy(s)}}},3970:()=>{},4018:i=>{i.exports=function(){for(var e=navigator.hardwareConcurrency||1,t=[],n=0;n<e;n++)t.push({model:"",speed:0,times:{user:0,nice:0,sys:0,idle:0,irq:0}});return t}},4043:()=>{},4343:()=>{},4497:(i,e,t)=>{const n=t(8454),s=t(9596);i.exports=class{constructor(a,l){if(this.store=a,this.chunkLength=a.chunkLength,this.inProgressGets=new Map,!this.store||!this.store.get||!this.store.put)throw new Error("First argument must be abstract-chunk-store compliant");this.cache=new n(l)}put(a,l,u=()=>{}){if(!this.cache)return s(()=>u(new Error("CacheStore closed")));this.cache.remove(a),this.store.put(a,l,u)}get(a,l,u=()=>{}){if(typeof l=="function")return this.get(a,null,l);if(!this.cache)return s(()=>u(new Error("CacheStore closed")));l||(l={});let c=this.cache.get(a);if(c){const p=l.offset||0,m=l.length||c.length-p;return p===0&&m===c.length||(c=c.slice(p,m+p)),s(()=>u(null,c))}let f=this.inProgressGets.get(a);const d=!!f;f||(f=[],this.inProgressGets.set(a,f)),f.push({opts:l,cb:u}),d||this.store.get(a,(p,m)=>{p||this.cache==null||this.cache.set(a,m);const v=this.inProgressGets.get(a);this.inProgressGets.delete(a);for(const{opts:b,cb:y}of v)if(p)y(p);else{const w=b.offset||0,C=b.length||m.length-w;let S=m;w===0&&C===m.length||(S=m.slice(w,C+w)),y(null,S)}})}close(a=()=>{}){if(!this.cache)return s(()=>a(new Error("CacheStore closed")));this.cache=null,this.store.close(a)}destroy(a=()=>{}){if(!this.cache)return s(()=>a(new Error("CacheStore closed")));this.cache=null,this.store.destroy(a)}}},4862:(i,e,t)=>{i.exports=s;const n=t(9596);function s(a,l){if(!(this instanceof s))return new s(a,l);if(l||(l={}),this.chunkLength=Number(a),!this.chunkLength)throw new Error("First argument must be a chunk length");this.chunks=[],this.closed=!1,this.length=Number(l.length)||1/0,this.length!==1/0&&(this.lastChunkLength=this.length%this.chunkLength||this.chunkLength,this.lastChunkIndex=Math.ceil(this.length/this.chunkLength)-1)}s.prototype.put=function(a,l,u=()=>{}){if(this.closed)return n(()=>u(new Error("Storage is closed")));const c=a===this.lastChunkIndex;return c&&l.length!==this.lastChunkLength?n(()=>u(new Error("Last chunk length must be "+this.lastChunkLength))):c||l.length===this.chunkLength?(this.chunks[a]=l,void n(()=>u(null))):n(()=>u(new Error("Chunk length must be "+this.chunkLength)))},s.prototype.get=function(a,l,u=()=>{}){if(typeof l=="function")return this.get(a,null,l);if(this.closed)return n(()=>u(new Error("Storage is closed")));let c=this.chunks[a];if(!c){const p=new Error("Chunk not found");return p.notFound=!0,n(()=>u(p))}l||(l={});const f=l.offset||0,d=l.length||c.length-f;f===0&&d===c.length||(c=c.slice(f,d+f)),n(()=>u(null,c))},s.prototype.close=s.prototype.destroy=function(a=()=>{}){if(this.closed)return n(()=>a(new Error("Storage is closed")));this.closed=!0,this.chunks=null,n(()=>a(null))}},5335:(i,e,t)=>{const n=t(3198),s=t(3198);i.exports=class{constructor(a="utf8"){switch(this.encoding=(function(l){switch(l=l.toLowerCase()){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return l;default:throw new Error("Unknown encoding: "+l)}})(a),this.encoding){case"utf8":this.decoder=new s;break;case"utf16le":case"base64":throw new Error("Unsupported encoding: "+this.encoding);default:this.decoder=new n(this.encoding)}}get remaining(){return this.decoder.remaining}push(a){return typeof a=="string"?a:this.decoder.decode(a)}write(a){return this.push(a)}end(a){let l="";return a&&(l=this.push(a)),l+=this.decoder.flush(),l}}},5372:(i,e,t)=>{i.exports=function(s,a,l){if(typeof a!="number")throw new Error("second argument must be a Number");let u,c,f,d,p,m,v=!0;Array.isArray(s)?(u=[],f=c=s.length):(d=Object.keys(s),u={},f=c=d.length);function b(w){function C(){l&&l(w,u),l=null}v?n(C):C()}function y(w,C,S){if(u[w]=S,C&&(p=!0),--f===0||C)b(C);else if(!p&&m<c){let x;d?(x=d[m],m+=1,s[x](function(k,A){y(x,k,A)})):(x=m,m+=1,s[x](function(k,A){y(x,k,A)}))}}m=a,f?d?d.some(function(w,C){return s[w](function(S,x){y(w,S,x)}),C===a-1}):s.some(function(w,C){return w(function(S,x){y(C,S,x)}),C===a-1}):b(null),v=!1};const n=t(9596)},5472:(i,e,t)=>{var n=t(717),s=function(a,l,u,c){if(this.bucketSize=a,this.tokensPerInterval=l,typeof u=="string")switch(u){case"sec":case"second":this.interval=1e3;break;case"min":case"minute":this.interval=6e4;break;case"hr":case"hour":this.interval=36e5;break;case"day":this.interval=864e5;break;default:throw new Error("Invaid interval "+u)}else this.interval=u;this.parentBucket=c,this.content=0,this.lastDrip=+new Date};s.prototype={bucketSize:1,tokensPerInterval:1,interval:1e3,parentBucket:null,content:0,lastDrip:0,removeTokens:function(a,l){var u=this;return this.bucketSize?a>this.bucketSize?(n.nextTick(l.bind(null,"Requested tokens "+a+" exceeds bucket size "+this.bucketSize,null)),!1):(this.drip(),a>this.content?c():this.parentBucket?this.parentBucket.removeTokens(a,function(f,d){return f?l(f,null):a>u.content?c():(u.content-=a,void l(null,Math.min(d,u.content)))}):(this.content-=a,n.nextTick(l.bind(null,null,this.content)),!0)):(n.nextTick(l.bind(null,null,a,Number.POSITIVE_INFINITY)),!0);function c(){var f=Math.ceil((a-u.content)*(u.interval/u.tokensPerInterval));return setTimeout(function(){u.removeTokens(a,l)},f),!1}},tryRemoveTokens:function(a){return!this.bucketSize||!(a>this.bucketSize)&&(this.drip(),!(a>this.content)&&!(this.parentBucket&&!this.parentBucket.tryRemoveTokens(a))&&(this.content-=a,!0))},drip:function(){if(this.tokensPerInterval){var a=+new Date,l=Math.max(a-this.lastDrip,0);this.lastDrip=a;var u=l*(this.tokensPerInterval/this.interval);this.content=Math.min(this.content+u,this.bucketSize)}else this.content=this.bucketSize}},i.exports=s},5658:(i,e,t)=>{t.d(e,{A:()=>w,enableSecure:()=>y});var n=t(7007),s=t(8179),a=t(1314),l=t(7833),u=t(6458);const c="tcpIncoming",f="tcpOutgoing",d="utpIncoming",p="utpOutgoing",m="webSeed",v=l("webtorrent:peer");let b=!1;const y=()=>{b=!0};class w extends n{constructor(S,x){super(),this.id=S,this.type=x,v("new %s Peer %s",x,S),this.addr=null,this.conn=null,this.swarm=null,this.wire=null,this.source=null,this.connected=!1,this.destroyed=!1,this.timeout=null,this.retries=0,this.sentPe1=!1,this.sentPe2=!1,this.sentPe3=!1,this.sentPe4=!1,this.sentHandshake=!1}onConnect(){if(this.destroyed)return;this.connected=!0,this.emit("connect"),v("Peer %s connected",this.id),clearTimeout(this.connectTimeout);const S=this.conn;S.once("end",()=>{this.destroy()}),S.once("close",()=>{this.destroy()}),S.once("finish",()=>{this.destroy()}),S.once("error",k=>{this.destroy(k)});const x=this.wire=new u.A(this.type,this.retries,b);x.once("end",()=>{this.destroy()}),x.once("close",()=>{this.destroy()}),x.once("finish",()=>{this.destroy()}),x.once("error",k=>{this.destroy(k)}),x.once("pe1",()=>{this.onPe1()}),x.once("pe2",()=>{this.onPe2()}),x.once("pe3",()=>{this.onPe3()}),x.once("pe4",()=>{this.onPe4()}),x.once("handshake",(k,A)=>{this.onHandshake(k,A)}),this.startHandshakeTimeout(),this.setThrottlePipes(),this.swarm&&(this.type==="tcpOutgoing"?b&&this.retries===0&&!this.sentPe1?this.sendPe1():this.sentHandshake||this.handshake():this.type==="tcpIncoming"||this.sentHandshake||this.handshake())}sendPe1(){this.wire.sendPe1(),this.sentPe1=!0}onPe1(){this.sendPe2()}sendPe2(){this.wire.sendPe2(),this.sentPe2=!0}onPe2(){this.sendPe3()}sendPe3(){this.wire.sendPe3(this.swarm.infoHash),this.sentPe3=!0}onPe3(S){this.swarm&&(this.swarm.infoHashHash!==S&&this.destroy(new Error("unexpected crypto handshake info hash for this swarm")),this.sendPe4())}sendPe4(){this.wire.sendPe4(this.swarm.infoHash),this.sentPe4=!0}onPe4(){this.sentHandshake||this.handshake()}clearPipes(){this.conn.unpipe(),this.wire.unpipe()}setThrottlePipes(){const S=this;(0,s.pipeline)(this.conn,this.throttleGroups.down.throttle(),new s.Transform({transform(x,k){S.emit("download",x.length),S.destroyed||k(null,x)}}),this.wire,this.throttleGroups.up.throttle(),new s.Transform({transform(x,k){S.emit("upload",x.length),S.destroyed||k(null,x)}}),this.conn)}onHandshake(S,x){if(!this.swarm||this.destroyed)return;if(this.swarm.destroyed)return this.destroy(new Error("swarm already destroyed"));if(S!==this.swarm.infoHash)return this.destroy(new Error("unexpected handshake info hash for this swarm"));if(x===this.swarm.peerId)return this.destroy(new Error("refusing to connect to ourselves"));v("Peer %s got handshake %s",this.id,S),clearTimeout(this.handshakeTimeout),this.retries=0;let k=this.addr;!k&&this.conn.remoteAddress&&this.conn.remotePort&&(k=`${this.conn.remoteAddress}:${this.conn.remotePort}`),this.swarm._onWire(this.wire,k),this.swarm&&!this.swarm.destroyed&&(this.sentHandshake||this.handshake())}handshake(){const S={dht:!this.swarm.private&&!!this.swarm.client.dht,fast:!0};this.wire.handshake(this.swarm.infoHash,this.swarm.client.peerId,S),this.sentHandshake=!0}startConnectTimeout(){clearTimeout(this.connectTimeout);const S={webrtc:25e3,tcpOutgoing:5e3,utpOutgoing:5e3};this.connectTimeout=setTimeout(()=>{this.destroy(new Error("connect timeout"))},S[this.type]),this.connectTimeout.unref&&this.connectTimeout.unref()}startHandshakeTimeout(){clearTimeout(this.handshakeTimeout),this.handshakeTimeout=setTimeout(()=>{this.destroy(new Error("handshake timeout"))},25e3),this.handshakeTimeout.unref&&this.handshakeTimeout.unref()}destroy(S){if(this.destroyed)return;this.destroyed=!0,this.connected&&this.emit("disconnect",S),this.connected=!1,v("destroy %s %s (error: %s)",this.type,this.id,S&&(S.message||S)),clearTimeout(this.connectTimeout),clearTimeout(this.handshakeTimeout);const x=this.swarm,k=this.conn,A=this.wire;this.swarm=null,this.conn=null,this.wire=null,x&&A&&a(x.wires,x.wires.indexOf(A)),k&&(k.on("error",()=>{}),k.destroy()),A&&A.destroy(),x&&x.removePeer(this.id)}}w.TYPE_TCP_INCOMING=c,w.TYPE_TCP_OUTGOING=f,w.TYPE_UTP_INCOMING=d,w.TYPE_UTP_OUTGOING=p,w.TYPE_WEBRTC="webrtc",w.TYPE_WEBSEED=m,w.SOURCE_MANUAL="manual",w.SOURCE_TRACKER="tracker",w.SOURCE_DHT="dht",w.SOURCE_LSD="lsd",w.SOURCE_UT_PEX="ut_pex",w.createWebRTCPeer=(C,S,x,k=null)=>{const A=new w(C.id,"webrtc");if(A.conn=C,A.swarm=S,A.throttleGroups=x,A.source=k,A.conn.connected)A.onConnect();else{const R=()=>{A.conn.removeListener("connect",I),A.conn.removeListener("error",U)},I=()=>{R(),A.onConnect()},U=te=>{R(),A.destroy(te)};A.conn.once("connect",I),A.conn.once("error",U),A.startConnectTimeout()}return A},w.createTCPIncomingPeer=(C,S)=>w._createIncomingPeer(C,c,S),w.createUTPIncomingPeer=(C,S)=>w._createIncomingPeer(C,d,S),w.createTCPOutgoingPeer=(C,S,x,k)=>w._createOutgoingPeer(C,S,f,x,k),w.createUTPOutgoingPeer=(C,S,x,k)=>w._createOutgoingPeer(C,S,p,x,k),w._createIncomingPeer=(C,S,x)=>{const k=`${C.remoteAddress}:${C.remotePort}`,A=new w(k,S);return A.conn=C,A.addr=k,A.throttleGroups=x,A.onConnect(),A},w._createOutgoingPeer=(C,S,x,k,A=null)=>{const R=new w(C,x);return R.addr=C,R.swarm=S,R.throttleGroups=k,R.source=A,R},w.createWebSeedPeer=(C,S,x,k)=>{const A=new w(S,m);return A.swarm=x,A.conn=C,A.throttleGroups=k,A.onConnect(),A}},5809:i=>{i.exports=class{constructor(e){if(!(e>0)||e-1&e)throw new Error("Max size for a FixedFIFO should be a power of two");this.buffer=new Array(e),this.mask=e-1,this.top=0,this.btm=0,this.next=null}clear(){this.top=this.btm=0,this.next=null,this.buffer.fill(void 0)}push(e){return this.buffer[this.top]===void 0&&(this.buffer[this.top]=e,this.top=this.top+1&this.mask,!0)}shift(){const e=this.buffer[this.btm];if(e!==void 0)return this.buffer[this.btm]=void 0,this.btm=this.btm+1&this.mask,e}peek(){return this.buffer[this.btm]}isEmpty(){return this.buffer[this.btm]===void 0}}},6080:(i,e,t)=>{const n=t(5809);i.exports=class{constructor(s){this.hwm=s||16,this.head=new n(this.hwm),this.tail=this.head,this.length=0}clear(){this.head=this.tail,this.head.clear(),this.length=0}push(s){if(this.length++,!this.head.push(s)){const a=this.head;this.head=a.next=new n(2*this.head.buffer.length),this.head.push(s)}}shift(){this.length!==0&&this.length--;const s=this.tail.shift();if(s===void 0&&this.tail.next){const a=this.tail.next;return this.tail.next=null,this.tail=a,this.tail.shift()}return s}peek(){const s=this.tail.peek();return s===void 0&&this.tail.next?this.tail.next.peek():s}isEmpty(){return this.length===0}}},6310:i=>{function e(t,n){for(const s in n)Object.defineProperty(t,s,{value:n[s],enumerable:!0,configurable:!0});return t}i.exports=function(t,n,s){if(!t||typeof t=="string")throw new TypeError("Please pass an Error to err-code");s||(s={}),typeof n=="object"&&(s=n,n=""),n&&(s.code=n);try{return e(t,s)}catch{s.message=t.message,s.stack=t.stack;const l=function(){};return l.prototype=Object.create(Object.getPrototypeOf(t)),e(new l,s)}}},6458:(i,e,t)=>{t.d(e,{A:()=>ee});var n=t(988),s=t(3033),a=t(7264),l=t(7833),u=t(8727),c=t(8179),f=t(9639),d=t(1035),p=t(1314);const m=l("bittorrent-protocol"),v=(0,f.L0)("BitTorrent protocol"),b=new Uint8Array([0,0,0,0]),y=new Uint8Array([0,0,0,1,0]),w=new Uint8Array([0,0,0,1,1]),C=new Uint8Array([0,0,0,1,2]),S=new Uint8Array([0,0,0,1,3]),x=[0,0,0,0,0,0,0,0],k=[0,0,0,3,9,0,0],A=new Uint8Array([0,0,0,1,14]),R=new Uint8Array([0,0,0,1,15]),I=new Uint8Array([0,0,0,0,0,0,0,0]),U=new Uint8Array([0,0,1,2]),te=new Uint8Array([0,0,0,2]);function G(ne,B){for(let z=ne.length;z--;)ne[z]^=B[z];return ne}function Y(ne,B=0){return ne[B]<<24|ne[B+1]<<16|ne[B+2]<<8|ne[B+3]}function O(ne,B,z){ne[B]=z>>>24&255,ne[B+1]=z>>>16&255,ne[B+2]=z>>>8&255,ne[B+3]=255&z}class N{constructor(B,z,$,V){this.piece=B,this.offset=z,this.length=$,this.callback=V}}class Q{constructor(){this.buffer=new Uint8Array}get(B){return!0}set(B){}}class q extends c.Duplex{constructor(B=null,z=0,$=!1){super(),this._debugId=(0,f.V5)((0,f.po)(4)),this._debug("new wire"),this.peerId=null,this.peerIdBuffer=null,this.type=B,this.amChoking=!0,this.amInterested=!1,this.peerChoking=!0,this.peerInterested=!1,this.peerPieces=new s.A(0,{grow:4e5}),this.extensions={},this.peerExtensions={},this.requests=[],this.peerRequests=[],this.extendedMapping={},this.peerExtendedMapping={},this.extendedHandshake={},this.peerExtendedHandshake={},this.hasFast=!1,this.allowedFastSet=[],this.peerAllowedFastSet=[],this._ext={},this._nextExt=1,this.uploaded=0,this.downloaded=0,this.uploadSpeed=d(),this.downloadSpeed=d(),this._keepAliveInterval=null,this._timeout=null,this._timeoutMs=0,this._timeoutExpiresAt=null,this._finished=!1,this._parserSize=0,this._parser=null,this._buffer=[],this._bufferSize=0,this._peEnabled=$,$?(this._dh=a.createDiffieHellman("ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a63a36210000000000090563","hex",2),this._myPubKey=this._dh.generateKeys("hex")):this._myPubKey=null,this._peerPubKey=null,this._sharedSecret=null,this._peerCryptoProvide=[],this._cryptoHandshakeDone=!1,this._cryptoSyncPattern=null,this._waitMaxBytes=null,this._encryptionMethod=null,this._encryptGenerator=null,this._decryptGenerator=null,this._setGenerators=!1,this.once("finish",()=>this._onFinish()),this.on("finish",this._onFinish),this._debug("type:",this.type),this.type==="tcpIncoming"&&this._peEnabled?this._determineHandshakeType():this.type==="tcpOutgoing"&&this._peEnabled&&z===0?this._parsePe2():this._parseHandshake(null)}setKeepAlive(B){this._debug("setKeepAlive %s",B),clearInterval(this._keepAliveInterval),B!==!1&&(this._keepAliveInterval=setInterval(()=>{this.keepAlive()},55e3))}setTimeout(B,z){this._debug("setTimeout ms=%d unref=%s",B,z),this._timeoutMs=B,this._timeoutUnref=!!z,this._resetTimeout(!0)}destroy(){if(!this.destroyed)return this._debug("destroy"),this.end(),this}end(B){if(!this.destroyed&&!this.destroying)return this._debug("end"),this._onUninterested(),this._onChoke(),super.end(B)}use(B){const z=B.prototype.name;if(!z)throw new Error('Extension class requires a "name" property on the prototype');this._debug("use extension.name=%s",z);const $=this._nextExt,V=new B(this);function Z(){}typeof V.onHandshake!="function"&&(V.onHandshake=Z),typeof V.onExtendedHandshake!="function"&&(V.onExtendedHandshake=Z),typeof V.onMessage!="function"&&(V.onMessage=Z),this.extendedMapping[$]=z,this._ext[z]=V,this[z]=V,this._nextExt+=1}keepAlive(){this._debug("keep-alive"),this._push(b)}sendPe1(){if(this._peEnabled){const B=Math.floor(513*Math.random()),z=(0,f.po)(B);this._push((0,f.xW)([(0,f.fk)(this._myPubKey),z]))}}sendPe2(){const B=Math.floor(513*Math.random()),z=(0,f.po)(B);this._push((0,f.xW)([(0,f.fk)(this._myPubKey),z]))}async sendPe3(B){await this.setEncrypt(this._sharedSecret,B);const z=await(0,f.tW)((0,f.fk)(this._utfToHex("req1")+this._sharedSecret)),$=G(await(0,f.tW)((0,f.fk)(this._utfToHex("req2")+B)),await(0,f.tW)((0,f.fk)(this._utfToHex("req3")+this._sharedSecret))),V=new DataView((0,f.po)(2).buffer).getUint16(0)%512,Z=(0,f.po)(V);let ae=new Uint8Array(14+V+2);ae.set(I),ae.set(U,8);const Ae=new DataView(ae.buffer);Ae.setInt16(12,V),Z.copy(ae,14),Ae.setInt16(14+V,0),ae=this._encryptHandshake(ae),this._push((0,f.xW)([z,$,ae]))}async sendPe4(B){await this.setEncrypt(this._sharedSecret,B);const z=new DataView((0,f.po)(2).buffer).getUint16(0)%512,$=(0,f.po)(z);let V=new Uint8Array(14+z);const Z=new DataView(V.buffer);V.set(I),V.set(te,8),Z.setInt16(12,z),V.set($,14),V=this._encryptHandshake(V),this._push(V),this._cryptoHandshakeDone=!0,this._debug("completed crypto handshake")}handshake(B,z,$){let V,Z;if(typeof B=="string"?(B=B.toLowerCase(),V=(0,f.fk)(B)):(V=B,B=(0,f.V5)(V)),typeof z=="string"?Z=(0,f.fk)(z):(Z=z,z=(0,f.V5)(Z)),this._infoHash=V,V.length!==20||Z.length!==20)throw new Error("infoHash and peerId MUST have length 20");this._debug("handshake i=%s p=%s exts=%o",B,z,$);const ae=new Uint8Array(x);this.extensions={extended:!0,dht:!(!$||!$.dht),fast:!(!$||!$.fast)},ae[5]|=16,this.extensions.dht&&(ae[7]|=1),this.extensions.fast&&(ae[7]|=4),this.extensions.fast&&this.peerExtensions.fast&&(this._debug("fast extension is enabled"),this.hasFast=!0),this._push((0,f.xW)([v,ae,V,Z])),this._handshakeSent=!0,this.peerExtensions.extended&&!this._extendedHandshakeSent&&this._sendExtendedHandshake()}_sendExtendedHandshake(){const B=Object.assign({},this.extendedHandshake);B.m={};for(const z in this.extendedMapping){const $=this.extendedMapping[z];B.m[$]=Number(z)}this.extended(0,n.A.encode(B)),this._extendedHandshakeSent=!0}choke(){if(!this.amChoking)if(this.amChoking=!0,this._debug("choke"),this._push(y),this.hasFast){let B=0;for(;this.peerRequests.length>B;){const z=this.peerRequests[B];this.allowedFastSet.includes(z.piece)?++B:this.reject(z.piece,z.offset,z.length)}}else for(;this.peerRequests.length;)this.peerRequests.pop()}unchoke(){this.amChoking&&(this.amChoking=!1,this._debug("unchoke"),this._push(w))}interested(){this.amInterested||(this.amInterested=!0,this._debug("interested"),this._push(C))}uninterested(){this.amInterested&&(this.amInterested=!1,this._debug("uninterested"),this._push(S))}have(B){this._debug("have %d",B),this._message(4,[B],null)}bitfield(B){this._debug("bitfield"),ArrayBuffer.isView(B)||(B=B.buffer),this._message(5,[],B)}request(B,z,$,V){return V||(V=()=>{}),this._finished?V(new Error("wire is closed")):!this.peerChoking||this.hasFast&&this.peerAllowedFastSet.includes(B)?(this._debug("request index=%d offset=%d length=%d",B,z,$),this.requests.push(new N(B,z,$,V)),this._timeout||this._resetTimeout(!0),void this._message(6,[B,z,$],null)):V(new Error("peer is choking"))}piece(B,z,$){this._debug("piece index=%d offset=%d",B,z),this._message(7,[B,z],$),this.uploaded+=$.length,this.uploadSpeed($.length),this.emit("upload",$.length)}cancel(B,z,$){this._debug("cancel index=%d offset=%d length=%d",B,z,$),this._callback(this._pull(this.requests,B,z,$),new Error("request was cancelled"),null),this._message(8,[B,z,$],null)}port(B){this._debug("port %d",B);const z=new Uint8Array(k);new DataView(z.buffer).setUint16(5,B),this._push(z)}suggest(B){if(!this.hasFast)throw Error("fast extension is disabled");this._debug("suggest %d",B),this._message(13,[B],null)}haveAll(){if(!this.hasFast)throw Error("fast extension is disabled");this._debug("have-all"),this._push(A)}haveNone(){if(!this.hasFast)throw Error("fast extension is disabled");this._debug("have-none"),this._push(R)}reject(B,z,$){if(!this.hasFast)throw Error("fast extension is disabled");this._debug("reject index=%d offset=%d length=%d",B,z,$),this._pull(this.peerRequests,B,z,$),this._message(16,[B,z,$],null)}allowedFast(B){if(!this.hasFast)throw Error("fast extension is disabled");this._debug("allowed-fast %d",B),this.allowedFastSet.includes(B)||this.allowedFastSet.push(B),this._message(17,[B],null)}extended(B,z){if(this._debug("extended ext=%s",B),typeof B=="string"&&this.peerExtendedMapping[B]&&(B=this.peerExtendedMapping[B]),typeof B!="number")throw new Error(`Unrecognized extension: ${B}`);{const $=new Uint8Array([B]),V=ArrayBuffer.isView(z)?z:n.A.encode(z);this._message(20,[],(0,f.xW)([$,V]))}}async setEncrypt(B,z){if(!this.type.startsWith("tcp"))return!1;const $=this.type==="tcpOutgoing",V=new u([...await(0,f.tW)((0,f.fk)(this._utfToHex("keyA")+B+z))]),Z=new u([...await(0,f.tW)((0,f.fk)(this._utfToHex("keyB")+B+z))]);this._encryptGenerator=$?V:Z,this._decryptGenerator=$?Z:V;for(let ae=0;ae<1024;ae++)this._encryptGenerator.randomByte(),this._decryptGenerator.randomByte();return this._setGenerators=!0,this.emit("_generators"),!0}_message(B,z,$){const V=$?$.length:0,Z=new Uint8Array(5+4*z.length);O(Z,0,Z.length+V-4),Z[4]=B;for(let ae=0;ae<z.length;ae++)O(Z,5+4*ae,z[ae]);this._push(Z),$&&this._push($)}_push(B){if(!this._finished)return this._encryptionMethod===2&&this._cryptoHandshakeDone&&(B=this._encrypt(B)),this.push(B)}_onKeepAlive(){this._debug("got keep-alive"),this.emit("keep-alive")}_onPe1(B){this._peerPubKey=(0,f.V5)(B),this._sharedSecret=this._dh.computeSecret(this._peerPubKey,"hex","hex"),this.emit("pe1")}_onPe2(B){this._peerPubKey=(0,f.V5)(B),this._sharedSecret=this._dh.computeSecret(this._peerPubKey,"hex","hex"),this.emit("pe2")}async _onPe3(B){const z=await(0,f.tW)((0,f.fk)(this._utfToHex("req3")+this._sharedSecret)),$=(0,f.V5)(G(z,B));this.emit("pe3",$)}_onPe3Encrypted(B,z){if(!(0,f.LC)(B,I))return this._debug("Error: verification constant did not match"),void this.destroy();for(const $ of z.values())$!==0&&this._peerCryptoProvide.push($);this._peerCryptoProvide.includes(2)?this._encryptionMethod=2:(this._debug("Error: RC4 encryption method not provided by peer"),this.destroy())}_onPe4(B){this._encryptionMethod=B[3],U.includes(this._encryptionMethod)||(this._debug("Error: peer selected invalid crypto method"),this.destroy()),this._cryptoHandshakeDone=!0,this._debug("crypto handshake done"),this.emit("pe4")}_onHandshake(B,z,$){const V=(0,f.V5)(B),Z=(0,f.V5)(z);this._debug("got handshake i=%s p=%s exts=%o",V,Z,$),this.peerId=Z,this.peerIdBuffer=z,this.peerExtensions=$,this.extensions.fast&&this.peerExtensions.fast&&(this._debug("fast extension is enabled"),this.hasFast=!0),this.emit("handshake",V,Z,$);for(const ae in this._ext)this._ext[ae].onHandshake(V,Z,$);$.extended&&this._handshakeSent&&!this._extendedHandshakeSent&&this._sendExtendedHandshake()}_onChoke(){if(this.peerChoking=!0,this._debug("got choke"),this.emit("choke"),!this.hasFast)for(;this.requests.length;)this._callback(this.requests.pop(),new Error("peer is choking"),null)}_onUnchoke(){this.peerChoking=!1,this._debug("got unchoke"),this.emit("unchoke")}_onInterested(){this.peerInterested=!0,this._debug("got interested"),this.emit("interested")}_onUninterested(){this.peerInterested=!1,this._debug("got uninterested"),this.emit("uninterested")}_onHave(B){this.peerPieces.get(B)||(this._debug("got have %d",B),this.peerPieces.set(B,!0),this.emit("have",B))}_onBitField(B){this.peerPieces=new s.A(B),this._debug("got bitfield"),this.emit("bitfield",this.peerPieces)}_onRequest(B,z,$){if(this.amChoking&&(!this.hasFast||!this.allowedFastSet.includes(B)))return void(this.hasFast&&this.reject(B,z,$));this._debug("got request index=%d offset=%d length=%d",B,z,$);const V=(ae,Ae)=>{if(Z===this._pull(this.peerRequests,B,z,$))return ae?(this._debug("error satisfying request index=%d offset=%d length=%d (%s)",B,z,$,ae.message),void(this.hasFast&&this.reject(B,z,$))):void this.piece(B,z,Ae)},Z=new N(B,z,$,V);this.peerRequests.push(Z),this.emit("request",B,z,$,V)}_onPiece(B,z,$){this._debug("got piece index=%d offset=%d",B,z),this._callback(this._pull(this.requests,B,z,$.length),null,$),this.downloaded+=$.length,this.downloadSpeed($.length),this.emit("download",$.length),this.emit("piece",B,z,$)}_onCancel(B,z,$){this._debug("got cancel index=%d offset=%d length=%d",B,z,$),this._pull(this.peerRequests,B,z,$),this.emit("cancel",B,z,$)}_onPort(B){this._debug("got port %d",B),this.emit("port",B)}_onSuggest(B){if(!this.hasFast)return this._debug("Error: got suggest whereas fast extension is disabled"),void this.destroy();this._debug("got suggest %d",B),this.emit("suggest",B)}_onHaveAll(){if(!this.hasFast)return this._debug("Error: got have-all whereas fast extension is disabled"),void this.destroy();this._debug("got have-all"),this.peerPieces=new Q,this.emit("have-all")}_onHaveNone(){if(!this.hasFast)return this._debug("Error: got have-none whereas fast extension is disabled"),void this.destroy();this._debug("got have-none"),this.emit("have-none")}_onReject(B,z,$){if(!this.hasFast)return this._debug("Error: got reject whereas fast extension is disabled"),void this.destroy();this._debug("got reject index=%d offset=%d length=%d",B,z,$),this._callback(this._pull(this.requests,B,z,$),new Error("request was rejected"),null),this.emit("reject",B,z,$)}_onAllowedFast(B){if(!this.hasFast)return this._debug("Error: got allowed-fast whereas fast extension is disabled"),void this.destroy();this._debug("got allowed-fast %d",B),this.peerAllowedFastSet.includes(B)||this.peerAllowedFastSet.push(B),this.peerAllowedFastSet.length>100&&this.peerAllowedFastSet.shift(),this.emit("allowed-fast",B)}_onExtended(B,z){if(B===0){let $;try{$=n.A.decode(z)}catch(V){this._debug("ignoring invalid extended handshake: %s",V.message||V)}if(!$)return;if(this.peerExtendedHandshake=$,typeof $.m=="object")for(const V in $.m)this.peerExtendedMapping[V]=Number($.m[V].toString());for(const V in this._ext)this.peerExtendedMapping[V]&&this._ext[V].onExtendedHandshake(this.peerExtendedHandshake);this._debug("got extended handshake"),this.emit("extended","handshake",this.peerExtendedHandshake)}else this.extendedMapping[B]&&(B=this.extendedMapping[B],this._ext[B]&&this._ext[B].onMessage(z)),this._debug("got extended message ext=%s",B),this.emit("extended",B,z)}_onTimeout(){this._debug("request timed out"),this._callback(this.requests.shift(),new Error("request has timed out"),null),this.emit("timeout")}_write(B,z){if(this._encryptionMethod===2&&this._cryptoHandshakeDone&&(B=this._decrypt(B)),this._bufferSize+=B.length,this._buffer.push(B),this._buffer.length>1&&(this._buffer=[(0,f.xW)(this._buffer,this._bufferSize)]),this._cryptoSyncPattern){const $=this._buffer[0].indexOf(this._cryptoSyncPattern);if($!==-1)this._buffer[0]=this._buffer[0].slice($+this._cryptoSyncPattern.length),this._bufferSize-=$+this._cryptoSyncPattern.length,this._cryptoSyncPattern=null;else if(this._bufferSize+B.length>this._waitMaxBytes+this._cryptoSyncPattern.length)return this._debug("Error: could not resynchronize"),void this.destroy()}for(;this._bufferSize>=this._parserSize&&!this._cryptoSyncPattern;)if(this._parserSize===0)this._parser(new Uint8Array);else{const $=this._buffer[0];this._bufferSize-=this._parserSize,this._buffer=this._bufferSize?[$.subarray(this._parserSize)]:[],this._parser($.subarray(0,this._parserSize))}z(null)}_callback(B,z,$){B&&(this._resetTimeout(!this.peerChoking&&!this._finished),B.callback(z,$))}_resetTimeout(B){if(!B||!this._timeoutMs||!this.requests.length)return clearTimeout(this._timeout),this._timeout=null,void(this._timeoutExpiresAt=null);const z=Date.now()+this._timeoutMs;if(this._timeout){if(z-this._timeoutExpiresAt<.05*this._timeoutMs)return;clearTimeout(this._timeout)}this._timeoutExpiresAt=z,this._timeout=setTimeout(()=>this._onTimeout(),this._timeoutMs),this._timeoutUnref&&this._timeout.unref&&this._timeout.unref()}_parse(B,z){this._parserSize=B,this._parser=z}_parseUntil(B,z){this._cryptoSyncPattern=B,this._waitMaxBytes=z}_onMessageLength(B){const z=Y(B);z>0?this._parse(z,this._onMessage):(this._onKeepAlive(),this._parse(4,this._onMessageLength))}_onMessage(B){switch(this._parse(4,this._onMessageLength),B[0]){case 0:return this._onChoke();case 1:return this._onUnchoke();case 2:return this._onInterested();case 3:return this._onUninterested();case 4:return this._onHave(Y(B,1));case 5:return this._onBitField(B.subarray(1));case 6:return this._onRequest(Y(B,1),Y(B,5),Y(B,9));case 7:return this._onPiece(Y(B,1),Y(B,5),B.subarray(9));case 8:return this._onCancel(Y(B,1),Y(B,5),Y(B,9));case 9:return this._onPort(B[1]<<8|B[2]);case 13:return this._onSuggest(Y(B,1));case 14:return this._onHaveAll();case 15:return this._onHaveNone();case 16:return this._onReject(Y(B,1),Y(B,5),Y(B,9));case 17:return this._onAllowedFast(Y(B,1));case 20:return this._onExtended(B[1],B.subarray(2));default:return this._debug("got unknown message"),this.emit("unknownmessage",B)}}_determineHandshakeType(){this._parse(1,B=>{const z=B[0];z===19?this._parse(z+48,this._onHandshakeBuffer):this._parsePe1(B)})}_parsePe1(B){this._parse(95,z=>{this._onPe1((0,f.xW)([B,z])),this._parsePe3()})}_parsePe2(){this._parse(96,async B=>{this._onPe2(B),this._setGenerators||await new Promise(z=>this.once("_generators",z)),this._parsePe4()})}async _parsePe3(){const B=await(0,f.tW)((0,f.fk)(this._utfToHex("req1")+this._sharedSecret));this._parseUntil(B,512),this._parse(20,async z=>{this._onPe3(z),this._setGenerators||await new Promise($=>this.once("_generators",$)),this._parsePe3Encrypted()})}_parsePe3Encrypted(){this._parse(14,B=>{const z=this._decryptHandshake(B.slice(0,8)),$=this._decryptHandshake(B.slice(8,12)),V=new DataView(this._decryptHandshake(B.slice(12,14)).buffer).getUint16(0);this._parse(V,Z=>{Z=this._decryptHandshake(Z),this._parse(2,ae=>{const Ae=new DataView(this._decryptHandshake(ae).buffer).getUint16(0);this._parse(Ae,be=>{be=this._decryptHandshake(be),this._onPe3Encrypted(z,$,Z,be);const Ge=Ae?be[0]:null,Te=Ae?be.slice(1,20):null;Ge===19&&(0,f.dU)(Te)==="BitTorrent protocol"?this._onHandshakeBuffer(be.slice(1)):this._parseHandshake()})})})})}_parsePe4(){const B=this._decryptHandshake(I);this._parseUntil(B,512),this._parse(6,z=>{const $=this._decryptHandshake(z.slice(0,4)),V=new DataView(this._decryptHandshake(z.slice(4,6)).buffer).getUint16(0);this._parse(V,Z=>{this._decryptHandshake(Z),this._onPe4($),this._parseHandshake(null)})})}_parseHandshake(){this._parse(1,B=>{const z=B[0];if(z!==19)return this._debug("Error: wire not speaking BitTorrent protocol (%s)",z.toString()),void this.end();this._parse(z+48,this._onHandshakeBuffer)})}_onHandshakeBuffer(B){const z=B.slice(0,19);if((0,f.dU)(z)!=="BitTorrent protocol")return this._debug("Error: wire not speaking BitTorrent protocol (%s)",(0,f.dU)(z)),void this.end();B=B.slice(19),this._onHandshake(B.slice(8,28),B.slice(28,48),{dht:!!(1&B[7]),fast:!!(4&B[7]),extended:!!(16&B[5])}),this._parse(4,this._onMessageLength)}_onFinish(){for(this._finished=!0,this.push(null);this.read(););for(clearInterval(this._keepAliveInterval),this._parse(Number.MAX_VALUE,()=>{});this.peerRequests.length;)this.peerRequests.pop();for(;this.requests.length;)this._callback(this.requests.pop(),new Error("wire was closed"),null)}_debug(...B){B[0]=`[${this._debugId}] ${B[0]}`,m(...B)}_pull(B,z,$,V){for(let Z=0;Z<B.length;Z++){const ae=B[Z];if(ae.piece===z&&ae.offset===$&&ae.length===V)return p(B,Z),ae}return null}_encryptHandshake(B){const z=new Uint8Array(B);if(!this._encryptGenerator)return this._debug("Warning: Encrypting without any generator"),z;for(let $=0;$<B.length;$++){const V=this._encryptGenerator.randomByte();z[$]=z[$]^V}return z}_encrypt(B){const z=new Uint8Array(B);if(!this._encryptGenerator||this._encryptionMethod!==2)return z;for(let $=0;$<B.length;$++){const V=this._encryptGenerator.randomByte();z[$]=z[$]^V}return z}_decryptHandshake(B){const z=new Uint8Array(B);if(!this._decryptGenerator)return this._debug("Warning: Decrypting without any generator"),z;for(let $=0;$<B.length;$++){const V=this._decryptGenerator.randomByte();z[$]=z[$]^V}return z}_decrypt(B){const z=new Uint8Array(B);if(!this._decryptGenerator||this._encryptionMethod!==2)return z;for(let $=0;$<B.length;$++){const V=this._decryptGenerator.randomByte();z[$]=z[$]^V}return z}_utfToHex(B){return(0,f.V5)((0,f.L0)(B))}}const ee=q},6585:i=>{var e=1e3,t=60*e,n=60*t,s=24*n,a=7*s,l=365.25*s;function u(c,f,d,p){var m=f>=1.5*d;return Math.round(c/d)+" "+p+(m?"s":"")}i.exports=function(c,f){f=f||{};var d=typeof c;if(d==="string"&&c.length>0)return(function(p){if(!((p=String(p)).length>100)){var m=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(p);if(m){var v=parseFloat(m[1]);switch((m[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return v*l;case"weeks":case"week":case"w":return v*a;case"days":case"day":case"d":return v*s;case"hours":case"hour":case"hrs":case"hr":case"h":return v*n;case"minutes":case"minute":case"mins":case"min":case"m":return v*t;case"seconds":case"second":case"secs":case"sec":case"s":return v*e;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return v;default:return}}}})(c);if(d==="number"&&isFinite(c))return f.long?(function(p){var m=Math.abs(p);return m>=s?u(p,m,s,"day"):m>=n?u(p,m,n,"hour"):m>=t?u(p,m,t,"minute"):m>=e?u(p,m,e,"second"):p+" ms"})(c):(function(p){var m=Math.abs(p);return m>=s?Math.round(p/s)+"d":m>=n?Math.round(p/n)+"h":m>=t?Math.round(p/t)+"m":m>=e?Math.round(p/e)+"s":p+"ms"})(c);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(c))}},6587:i=>{i.exports=function e(t,n){if(t&&n)return e(t)(n);if(typeof t!="function")throw new TypeError("need wrapper function");return Object.keys(t).forEach(function(a){s[a]=t[a]}),s;function s(){for(var a=new Array(arguments.length),l=0;l<a.length;l++)a[l]=arguments[l];var u=t.apply(this,a),c=a[a.length-1];return typeof u=="function"&&u!==c&&Object.keys(c).forEach(function(f){u[f]=c[f]}),u}}},6611:(i,e,t)=>{var n=t(717),s=t(3519),a=function(){},l=globalThis.Bare?queueMicrotask:n.nextTick.bind(n),u=function(c,f,d){if(typeof f=="function")return u(c,null,f);f||(f={}),d=s(d||a);var p=c._writableState,m=c._readableState,v=f.readable||f.readable!==!1&&c.readable,b=f.writable||f.writable!==!1&&c.writable,y=!1,w=function(){c.writable||C()},C=function(){b=!1,v||d.call(c)},S=function(){v=!1,b||d.call(c)},x=function(U){d.call(c,U?new Error("exited with error code: "+U):null)},k=function(U){d.call(c,U)},A=function(){l(R)},R=function(){if(!y)return(!v||m&&m.ended&&!m.destroyed)&&(!b||p&&p.ended&&!p.destroyed)?void 0:d.call(c,new Error("premature close"))},I=function(){c.req.on("finish",C)};return(function(U){return U.setHeader&&typeof U.abort=="function"})(c)?(c.on("complete",C),c.on("abort",A),c.req?I():c.on("request",I)):b&&!p&&(c.on("end",w),c.on("close",w)),(function(U){return U.stdio&&Array.isArray(U.stdio)&&U.stdio.length===3})(c)&&c.on("exit",x),c.on("end",S),c.on("finish",C),f.error!==!1&&c.on("error",k),c.on("close",A),function(){y=!0,c.removeListener("complete",C),c.removeListener("abort",A),c.removeListener("request",I),c.req&&c.req.removeListener("finish",C),c.removeListener("end",w),c.removeListener("close",w),c.removeListener("finish",C),c.removeListener("exit",x),c.removeListener("end",S),c.removeListener("error",k),c.removeListener("close",A)}};i.exports=u},6664:()=>{},6686:()=>{},6698:i=>{typeof Object.create=="function"?i.exports=function(e,t){t&&(e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}))}:i.exports=function(e,t){if(t){e.super_=t;var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e}}},6819:(i,e,t)=>{i.exports=t(8330).version},6889:()=>{},7007:i=>{var e=Object.create||function(y){var w=function(){};return w.prototype=y,new w},t=Object.keys||function(y){var w=[];for(var C in y)Object.prototype.hasOwnProperty.call(y,C)&&w.push(C);return C},n=Function.prototype.bind||function(y){var w=this;return function(){return w.apply(y,arguments)}};function s(){this._events&&Object.prototype.hasOwnProperty.call(this,"_events")||(this._events=e(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0}i.exports=s,s.EventEmitter=s,s.prototype._events=void 0,s.prototype._maxListeners=void 0;var a,l=10;try{var u={};Object.defineProperty&&Object.defineProperty(u,"x",{value:0}),a=u.x===0}catch{a=!1}function c(y){return y._maxListeners===void 0?s.defaultMaxListeners:y._maxListeners}function f(y,w,C,S){var x,k,A;if(typeof C!="function")throw new TypeError('"listener" argument must be a function');if((k=y._events)?(k.newListener&&(y.emit("newListener",w,C.listener?C.listener:C),k=y._events),A=k[w]):(k=y._events=e(null),y._eventsCount=0),A){if(typeof A=="function"?A=k[w]=S?[C,A]:[A,C]:S?A.unshift(C):A.push(C),!A.warned&&(x=c(y))&&x>0&&A.length>x){A.warned=!0;var R=new Error("Possible EventEmitter memory leak detected. "+A.length+' "'+String(w)+'" listeners added. Use emitter.setMaxListeners() to increase limit.');R.name="MaxListenersExceededWarning",R.emitter=y,R.type=w,R.count=A.length,typeof console=="object"&&console.warn&&console.warn("%s: %s",R.name,R.message)}}else A=k[w]=C,++y._eventsCount;return y}function d(){if(!this.fired)switch(this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length){case 0:return this.listener.call(this.target);case 1:return this.listener.call(this.target,arguments[0]);case 2:return this.listener.call(this.target,arguments[0],arguments[1]);case 3:return this.listener.call(this.target,arguments[0],arguments[1],arguments[2]);default:for(var y=new Array(arguments.length),w=0;w<y.length;++w)y[w]=arguments[w];this.listener.apply(this.target,y)}}function p(y,w,C){var S={fired:!1,wrapFn:void 0,target:y,type:w,listener:C},x=n.call(d,S);return x.listener=C,S.wrapFn=x,x}function m(y,w,C){var S=y._events;if(!S)return[];var x=S[w];return x?typeof x=="function"?C?[x.listener||x]:[x]:C?(function(k){for(var A=new Array(k.length),R=0;R<A.length;++R)A[R]=k[R].listener||k[R];return A})(x):b(x,x.length):[]}function v(y){var w=this._events;if(w){var C=w[y];if(typeof C=="function")return 1;if(C)return C.length}return 0}function b(y,w){for(var C=new Array(w),S=0;S<w;++S)C[S]=y[S];return C}a?Object.defineProperty(s,"defaultMaxListeners",{enumerable:!0,get:function(){return l},set:function(y){if(typeof y!="number"||y<0||y!=y)throw new TypeError('"defaultMaxListeners" must be a positive number');l=y}}):s.defaultMaxListeners=l,s.prototype.setMaxListeners=function(y){if(typeof y!="number"||y<0||isNaN(y))throw new TypeError('"n" argument must be a positive number');return this._maxListeners=y,this},s.prototype.getMaxListeners=function(){return c(this)},s.prototype.emit=function(y){var w,C,S,x,k,A,R=y==="error";if(A=this._events)R=R&&A.error==null;else if(!R)return!1;if(R){if(arguments.length>1&&(w=arguments[1]),w instanceof Error)throw w;var I=new Error('Unhandled "error" event. ('+w+")");throw I.context=w,I}if(!(C=A[y]))return!1;var U=typeof C=="function";switch(S=arguments.length){case 1:(function(te,G,Y){if(G)te.call(Y);else for(var O=te.length,N=b(te,O),Q=0;Q<O;++Q)N[Q].call(Y)})(C,U,this);break;case 2:(function(te,G,Y,O){if(G)te.call(Y,O);else for(var N=te.length,Q=b(te,N),q=0;q<N;++q)Q[q].call(Y,O)})(C,U,this,arguments[1]);break;case 3:(function(te,G,Y,O,N){if(G)te.call(Y,O,N);else for(var Q=te.length,q=b(te,Q),ee=0;ee<Q;++ee)q[ee].call(Y,O,N)})(C,U,this,arguments[1],arguments[2]);break;case 4:(function(te,G,Y,O,N,Q){if(G)te.call(Y,O,N,Q);else for(var q=te.length,ee=b(te,q),ne=0;ne<q;++ne)ee[ne].call(Y,O,N,Q)})(C,U,this,arguments[1],arguments[2],arguments[3]);break;default:for(x=new Array(S-1),k=1;k<S;k++)x[k-1]=arguments[k];(function(te,G,Y,O){if(G)te.apply(Y,O);else for(var N=te.length,Q=b(te,N),q=0;q<N;++q)Q[q].apply(Y,O)})(C,U,this,x)}return!0},s.prototype.addListener=function(y,w){return f(this,y,w,!1)},s.prototype.on=s.prototype.addListener,s.prototype.prependListener=function(y,w){return f(this,y,w,!0)},s.prototype.once=function(y,w){if(typeof w!="function")throw new TypeError('"listener" argument must be a function');return this.on(y,p(this,y,w)),this},s.prototype.prependOnceListener=function(y,w){if(typeof w!="function")throw new TypeError('"listener" argument must be a function');return this.prependListener(y,p(this,y,w)),this},s.prototype.removeListener=function(y,w){var C,S,x,k,A;if(typeof w!="function")throw new TypeError('"listener" argument must be a function');if(!(S=this._events))return this;if(!(C=S[y]))return this;if(C===w||C.listener===w)--this._eventsCount===0?this._events=e(null):(delete S[y],S.removeListener&&this.emit("removeListener",y,C.listener||w));else if(typeof C!="function"){for(x=-1,k=C.length-1;k>=0;k--)if(C[k]===w||C[k].listener===w){A=C[k].listener,x=k;break}if(x<0)return this;x===0?C.shift():(function(R,I){for(var U=I,te=U+1,G=R.length;te<G;U+=1,te+=1)R[U]=R[te];R.pop()})(C,x),C.length===1&&(S[y]=C[0]),S.removeListener&&this.emit("removeListener",y,A||w)}return this},s.prototype.removeAllListeners=function(y){var w,C,S;if(!(C=this._events))return this;if(!C.removeListener)return arguments.length===0?(this._events=e(null),this._eventsCount=0):C[y]&&(--this._eventsCount===0?this._events=e(null):delete C[y]),this;if(arguments.length===0){var x,k=t(C);for(S=0;S<k.length;++S)(x=k[S])!=="removeListener"&&this.removeAllListeners(x);return this.removeAllListeners("removeListener"),this._events=e(null),this._eventsCount=0,this}if(typeof(w=C[y])=="function")this.removeListener(y,w);else if(w)for(S=w.length-1;S>=0;S--)this.removeListener(y,w[S]);return this},s.prototype.listeners=function(y){return m(this,y,!0)},s.prototype.rawListeners=function(y){return m(this,y,!1)},s.listenerCount=function(y,w){return typeof y.listenerCount=="function"?y.listenerCount(w):v.call(y,w)},s.prototype.listenerCount=v,s.prototype.eventNames=function(){return this._eventsCount>0?Reflect.ownKeys(this._events):[]}},7264:()=>{},7373:i=>{i.exports=function(e){var t=0;return function(){if(t===e.length)return null;var n=e.length-t,s=Math.random()*n|0,a=e[t+s],l=e[t];return e[t]=a,e[t+s]=l,t++,a}}},7541:(i,e,t)=>{const n=t(8765),s=t(8499);i.exports={Throttle:n,ThrottleGroup:s}},7828:()=>{},7833:(i,e,t)=>{var n=t(717);e.formatArgs=function(a){if(a[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+a[0]+(this.useColors?"%c ":" ")+"+"+i.exports.humanize(this.diff),!this.useColors)return;const l="color: "+this.color;a.splice(1,0,l,"color: inherit");let u=0,c=0;a[0].replace(/%[a-zA-Z%]/g,f=>{f!=="%%"&&(u++,f==="%c"&&(c=u))}),a.splice(c,0,l)},e.save=function(a){try{a?e.storage.setItem("debug",a):e.storage.removeItem("debug")}catch{}},e.load=function(){let a;try{a=e.storage.getItem("debug")||e.storage.getItem("DEBUG")}catch{}return!a&&n!==void 0&&"env"in n&&(a=n.env.DEBUG),a},e.useColors=function(){if(typeof window<"u"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs))return!0;if(typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))return!1;let a;return typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&(a=navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/))&&parseInt(a[1],10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)},e.storage=(function(){try{return localStorage}catch{}})(),e.destroy=(()=>{let a=!1;return()=>{a||(a=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),e.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],e.log=console.debug||console.log||(()=>{}),i.exports=t(736)(e);const{formatters:s}=i.exports;s.j=function(a){try{return JSON.stringify(a)}catch(l){return"[UnexpectedJSONParseError]: "+l.message}}},8179:(i,e,t)=>{const{EventEmitter:n}=t(7007),s=new Error("Stream was destroyed"),a=new Error("Premature close"),l=t(6080),u=t(5335),c=typeof queueMicrotask>"u"?Ht=>globalThis.process.nextTick(Ht):queueMicrotask,f=536870911,d=1^f,p=2^f,m=32,v=64,b=128,y=256,w=1024,C=2048,S=4096,x=8192,k=16384,A=32768,R=131072,I=131328,U=16^f,te=536805375,G=768^f,Y=536838143,O=536739839,N=1<<18,Q=2<<18,q=4<<18,ee=8<<18,ne=16<<18,B=32<<18,z=64<<18,$=128<<18,V=256<<18,Z=512<<18,ae=1024<<18,Ae=535822335,be=503316479,Ge=268435455,Te=262160,ve=536608751,ke=8404992,Me=14,Ie=15,Ce=8405006,ot=33587200,et=33587215,me=2359296,de=270794767,Be=Symbol.asyncIterator||Symbol("asyncIterator");class Je{constructor(pe,{highWaterMark:Ot=16384,map:qt=null,mapWritable:fe,byteLength:we,byteLengthWritable:pt}={}){this.stream=pe,this.queue=new l,this.highWaterMark=Ot,this.buffered=0,this.error=null,this.pipeline=null,this.drains=null,this.byteLength=pt||we||xr,this.map=fe||qt,this.afterWrite=Zt.bind(this),this.afterUpdateNextTick=se.bind(this)}get ended(){return(this.stream._duplexState&B)!==0}push(pe){return!(142606350&this.stream._duplexState)&&(this.map!==null&&(pe=this.map(pe)),this.buffered+=this.byteLength(pe),this.queue.push(pe),this.buffered<this.highWaterMark?(this.stream._duplexState|=ee,!0):(this.stream._duplexState|=6291456,!1))}shift(){const pe=this.queue.shift();return this.buffered-=this.byteLength(pe),this.buffered===0&&(this.stream._duplexState&=534773759),pe}end(pe){typeof pe=="function"?this.stream.once("finish",pe):pe!=null&&this.push(pe),this.stream._duplexState=(this.stream._duplexState|Z)&Ae}autoBatch(pe,Ot){const qt=[],fe=this.stream;for(qt.push(pe);(fe._duplexState&de)===me;)qt.push(fe._writableState.shift());if((fe._duplexState&Ie)!==0)return Ot(null);fe._writev(qt,Ot)}update(){const pe=this.stream;pe._duplexState|=Q;do{for(;(pe._duplexState&de)===ee;){const Ot=this.shift();pe._duplexState|=67371008,pe._write(Ot,this.afterWrite)}1310720&pe._duplexState||this.updateNonPrimary()}while(this.continueUpdate()===!0);pe._duplexState&=536346623}updateNonPrimary(){const pe=this.stream;if((144965647&pe._duplexState)===Z)return pe._duplexState=pe._duplexState|N,void pe._final(Mt.bind(this));(pe._duplexState&Me)!==4?(pe._duplexState&et)===1&&(pe._duplexState=(pe._duplexState|Te)&d,pe._open(Oe.bind(this))):(pe._duplexState&ot)===0&&(pe._duplexState|=Te,pe._destroy(nt.bind(this)))}continueUpdate(){return(this.stream._duplexState&$)!==0&&(this.stream._duplexState&=be,!0)}updateCallback(){(35127311&this.stream._duplexState)===q?this.update():this.updateNextTick()}updateNextTick(){(this.stream._duplexState&$)===0&&(this.stream._duplexState|=$,(this.stream._duplexState&Q)===0&&c(this.afterUpdateNextTick))}}class rt{constructor(pe,{highWaterMark:Ot=16384,map:qt=null,mapReadable:fe,byteLength:we,byteLengthReadable:pt}={}){this.stream=pe,this.queue=new l,this.highWaterMark=Ot===0?1:Ot,this.buffered=0,this.readAhead=Ot>0,this.error=null,this.pipeline=null,this.byteLength=pt||we||xr,this.map=fe||qt,this.pipeTo=null,this.afterRead=j.bind(this),this.afterUpdateNextTick=W.bind(this)}get ended(){return(this.stream._duplexState&k)!==0}pipe(pe,Ot){if(this.pipeTo!==null)throw new Error("Can only pipe to one destination");if(typeof Ot!="function"&&(Ot=null),this.stream._duplexState|=512,this.pipeTo=pe,this.pipeline=new ye(this.stream,pe,Ot),Ot&&this.stream.on("error",_r),Bn(pe))pe._writableState.pipeline=this.pipeline,Ot&&pe.on("error",_r),pe.on("finish",this.pipeline.finished.bind(this.pipeline));else{const qt=this.pipeline.done.bind(this.pipeline,pe),fe=this.pipeline.done.bind(this.pipeline,pe,null);pe.on("error",qt),pe.on("close",fe),pe.on("finish",this.pipeline.finished.bind(this.pipeline))}pe.on("drain",it.bind(this)),this.stream.emit("piping",pe),pe.emit("pipe",this.stream)}push(pe){const Ot=this.stream;return pe===null?(this.highWaterMark=0,Ot._duplexState=536805311&Ot._duplexState|1024,!1):this.map!==null&&(pe=this.map(pe))===null?(Ot._duplexState&=te,this.buffered<this.highWaterMark):(this.buffered+=this.byteLength(pe),this.queue.push(pe),Ot._duplexState=(Ot._duplexState|b)&te,this.buffered<this.highWaterMark)}shift(){const pe=this.queue.shift();return this.buffered-=this.byteLength(pe),this.buffered===0&&(this.stream._duplexState&=536862591),pe}unshift(pe){const Ot=[this.map!==null?this.map(pe):pe];for(;this.buffered>0;)Ot.push(this.shift());for(let qt=0;qt<Ot.length-1;qt++){const fe=Ot[qt];this.buffered+=this.byteLength(fe),this.queue.push(fe)}this.push(Ot[Ot.length-1])}read(){const pe=this.stream;if((16527&pe._duplexState)===b){const Ot=this.shift();return this.pipeTo!==null&&this.pipeTo.write(Ot)===!1&&(pe._duplexState&=G),(pe._duplexState&C)!==0&&pe.emit("data",Ot),Ot}return this.readAhead===!1&&(pe._duplexState|=R,this.updateNextTick()),null}drain(){const pe=this.stream;for(;(16527&pe._duplexState)===b&&768&pe._duplexState;){const Ot=this.shift();this.pipeTo!==null&&this.pipeTo.write(Ot)===!1&&(pe._duplexState&=G),(pe._duplexState&C)!==0&&pe.emit("data",Ot)}}update(){const pe=this.stream;pe._duplexState|=m;do{for(this.drain();this.buffered<this.highWaterMark&&(214047&pe._duplexState)===R;)pe._duplexState|=65552,pe._read(this.afterRead),this.drain();(12431&pe._duplexState)==4224&&(pe._duplexState|=x,pe.emit("readable")),80&pe._duplexState||this.updateNonPrimary()}while(this.continueUpdate()===!0);pe._duplexState&=536870879}updateNonPrimary(){const pe=this.stream;(1167&pe._duplexState)===w&&(pe._duplexState=536869887&pe._duplexState|16384,pe.emit("end"),(pe._duplexState&Ce)===ke&&(pe._duplexState|=4),this.pipeTo!==null&&this.pipeTo.end()),(pe._duplexState&Me)!==4?(pe._duplexState&et)===1&&(pe._duplexState=(pe._duplexState|Te)&d,pe._open(Oe.bind(this))):(pe._duplexState&ot)===0&&(pe._duplexState|=Te,pe._destroy(nt.bind(this)))}continueUpdate(){return(this.stream._duplexState&A)!==0&&(this.stream._duplexState&=Y,!0)}updateCallback(){(32879&this.stream._duplexState)===v?this.update():this.updateNextTick()}updateNextTickIfOpen(){32769&this.stream._duplexState||(this.stream._duplexState|=A,(this.stream._duplexState&m)===0&&c(this.afterUpdateNextTick))}updateNextTick(){(this.stream._duplexState&A)===0&&(this.stream._duplexState|=A,(this.stream._duplexState&m)===0&&c(this.afterUpdateNextTick))}}class at{constructor(pe){this.data=null,this.afterTransform=Ke.bind(pe),this.afterFinal=null}}class ye{constructor(pe,Ot,qt){this.from=pe,this.to=Ot,this.afterPipe=qt,this.error=null,this.pipeToFinished=!1}finished(){this.pipeToFinished=!0}done(pe,Ot){Ot&&(this.error=Ot),pe!==this.to||(this.to=null,this.from===null)?pe!==this.from||(this.from=null,this.to===null)?(this.afterPipe!==null&&this.afterPipe(this.error),this.to=this.from=this.afterPipe=null):(pe._duplexState&k)===0&&this.to.destroy(this.error||new Error("Readable stream closed before ending")):(this.from._duplexState&k)!==0&&this.pipeToFinished||this.from.destroy(this.error||new Error("Writable stream closed prematurely"))}}function it(){this.stream._duplexState|=512,this.updateCallback()}function Mt(Ht){const pe=this.stream;Ht&&pe.destroy(Ht),(pe._duplexState&Me)===0&&(pe._duplexState|=B,pe.emit("finish")),(pe._duplexState&Ce)===ke&&(pe._duplexState|=4),pe._duplexState&=402391039,(pe._duplexState&Q)===0?this.update():this.updateNextTick()}function nt(Ht){const pe=this.stream;Ht||this.error===s||(Ht=this.error),Ht&&pe.emit("error",Ht),pe._duplexState|=8,pe.emit("close");const Ot=pe._readableState,qt=pe._writableState;if(Ot!==null&&Ot.pipeline!==null&&Ot.pipeline.done(pe,Ht),qt!==null){for(;qt.drains!==null&&qt.drains.length>0;)qt.drains.shift().resolve(!1);qt.pipeline!==null&&qt.pipeline.done(pe,Ht)}}function Zt(Ht){const pe=this.stream;Ht&&pe.destroy(Ht),pe._duplexState&=469499903,this.drains!==null&&(function(Ot){for(let qt=0;qt<Ot.length;qt++)--Ot[qt].writes===0&&(Ot.shift().resolve(!0),qt--)})(this.drains),(6553615&pe._duplexState)===ne&&(pe._duplexState&=532676607,(pe._duplexState&z)===z&&pe.emit("drain")),this.updateCallback()}function j(Ht){Ht&&this.stream.destroy(Ht),this.stream._duplexState&=U,this.readAhead===!1&&(this.stream._duplexState&y)===0&&(this.stream._duplexState&=O),this.updateCallback()}function W(){(this.stream._duplexState&m)===0&&(this.stream._duplexState&=Y,this.update())}function se(){(this.stream._duplexState&Q)===0&&(this.stream._duplexState&=be,this.update())}function Oe(Ht){const pe=this.stream;Ht&&pe.destroy(Ht),4&pe._duplexState||(17423&pe._duplexState||(pe._duplexState|=v),142606351&pe._duplexState||(pe._duplexState|=q),pe.emit("open")),pe._duplexState&=ve,pe._writableState!==null&&pe._writableState.updateCallback(),pe._readableState!==null&&pe._readableState.updateCallback()}function Ke(Ht,pe){pe!=null&&this.push(pe),this._writableState.afterWrite(Ht)}function gt(Ht){this._readableState!==null&&(Ht==="data"&&(this._duplexState|=133376,this._readableState.updateNextTick()),Ht==="readable"&&(this._duplexState|=S,this._readableState.updateNextTick())),this._writableState!==null&&Ht==="drain"&&(this._duplexState|=z,this._writableState.updateNextTick())}class Ut extends n{constructor(pe){super(),this._duplexState=0,this._readableState=null,this._writableState=null,pe&&(pe.open&&(this._open=pe.open),pe.destroy&&(this._destroy=pe.destroy),pe.predestroy&&(this._predestroy=pe.predestroy),pe.signal&&pe.signal.addEventListener("abort",Zn.bind(this))),this.on("newListener",gt)}_open(pe){pe(null)}_destroy(pe){pe(null)}_predestroy(){}get readable(){return this._readableState!==null||void 0}get writable(){return this._writableState!==null||void 0}get destroyed(){return!!(8&this._duplexState)}get destroying(){return(this._duplexState&Me)!==0}destroy(pe){(this._duplexState&Me)===0&&(pe||(pe=s),this._duplexState=535822271&this._duplexState|4,this._readableState!==null&&(this._readableState.highWaterMark=0,this._readableState.error=pe),this._writableState!==null&&(this._writableState.highWaterMark=0,this._writableState.error=pe),this._duplexState|=2,this._predestroy(),this._duplexState&=p,this._readableState!==null&&this._readableState.updateNextTick(),this._writableState!==null&&this._writableState.updateNextTick())}}class Le extends Ut{constructor(pe){super(pe),this._duplexState|=8519681,this._readableState=new rt(this,pe),pe&&(this._readableState.readAhead===!1&&(this._duplexState&=O),pe.read&&(this._read=pe.read),pe.eagerOpen&&this._readableState.updateNextTick(),pe.encoding&&this.setEncoding(pe.encoding))}setEncoding(pe){const Ot=new u(pe),qt=this._readableState.map||pr;return this._readableState.map=function(fe){const we=Ot.push(fe);return we===""&&(fe.byteLength!==0||Ot.remaining>0)?null:qt(we)},this}_read(pe){pe(null)}pipe(pe,Ot){return this._readableState.updateNextTick(),this._readableState.pipe(pe,Ot),pe}read(){return this._readableState.updateNextTick(),this._readableState.read()}push(pe){return this._readableState.updateNextTickIfOpen(),this._readableState.push(pe)}unshift(pe){return this._readableState.updateNextTickIfOpen(),this._readableState.unshift(pe)}resume(){return this._duplexState|=I,this._readableState.updateNextTick(),this}pause(){return this._duplexState&=this._readableState.readAhead===!1?536739583:536870655,this}static _fromAsyncIterator(pe,Ot){let qt;const fe=new Le({...Ot,read(pt){pe.next().then(we).then(pt.bind(null,null)).catch(pt)},predestroy(){qt=pe.return()},destroy(pt){if(!qt)return pt(null);qt.then(pt.bind(null,null)).catch(pt)}});return fe;function we(pt){pt.done?fe.push(null):fe.push(pt.value)}}static from(pe,Ot){if(Bn(qt=pe)&&qt.readable)return pe;var qt;if(pe[Be])return this._fromAsyncIterator(pe[Be](),Ot);Array.isArray(pe)||(pe=pe===void 0?[]:[pe]);let fe=0;return new Le({...Ot,read(we){this.push(fe===pe.length?null:pe[fe++]),we(null)}})}static isBackpressured(pe){return!!(17422&pe._duplexState)||pe._readableState.buffered>=pe._readableState.highWaterMark}static isPaused(pe){return(pe._duplexState&y)===0}[Be](){const pe=this;let Ot=null,qt=null,fe=null;return this.on("error",At=>{Ot=At}),this.on("readable",function(){qt!==null&&we(pe.read())}),this.on("close",function(){qt!==null&&we(null)}),{[Be](){return this},next:()=>new Promise(function(At,K){qt=At,fe=K;const oe=pe.read();oe!==null?we(oe):8&pe._duplexState&&we(null)}),return:()=>pt(null),throw:At=>pt(At)};function we(At){fe!==null&&(Ot?fe(Ot):At===null&&(pe._duplexState&k)===0?fe(s):qt({value:At,done:At===null}),fe=qt=null)}function pt(At){return pe.destroy(At),new Promise((K,oe)=>{if(8&pe._duplexState)return K({value:void 0,done:!0});pe.once("close",function(){At?oe(At):K({value:void 0,done:!0})})})}}}class Xe extends Ut{constructor(pe){super(pe),this._duplexState|=16385,this._writableState=new Je(this,pe),pe&&(pe.writev&&(this._writev=pe.writev),pe.write&&(this._write=pe.write),pe.final&&(this._final=pe.final),pe.eagerOpen&&this._writableState.updateNextTick())}cork(){this._duplexState|=ae}uncork(){this._duplexState&=Ge,this._writableState.updateNextTick()}_writev(pe,Ot){Ot(null)}_write(pe,Ot){this._writableState.autoBatch(pe,Ot)}_final(pe){pe(null)}static isBackpressured(pe){return!!(146800654&pe._duplexState)}static drained(pe){if(pe.destroyed)return Promise.resolve(!1);const Ot=pe._writableState;var qt;const fe=((qt=pe)._writev!==Xe.prototype._writev&&qt._writev!==zt.prototype._writev?Math.min(1,Ot.queue.length):Ot.queue.length)+(pe._duplexState&V?1:0);return fe===0?Promise.resolve(!0):(Ot.drains===null&&(Ot.drains=[]),new Promise(we=>{Ot.drains.push({writes:fe,resolve:we})}))}write(pe){return this._writableState.updateNextTick(),this._writableState.push(pe)}end(pe){return this._writableState.updateNextTick(),this._writableState.end(pe),this}}class zt extends Le{constructor(pe){super(pe),this._duplexState=1|this._duplexState&R,this._writableState=new Je(this,pe),pe&&(pe.writev&&(this._writev=pe.writev),pe.write&&(this._write=pe.write),pe.final&&(this._final=pe.final))}cork(){this._duplexState|=ae}uncork(){this._duplexState&=Ge,this._writableState.updateNextTick()}_writev(pe,Ot){Ot(null)}_write(pe,Ot){this._writableState.autoBatch(pe,Ot)}_final(pe){pe(null)}write(pe){return this._writableState.updateNextTick(),this._writableState.push(pe)}end(pe){return this._writableState.updateNextTick(),this._writableState.end(pe),this}}class mt extends zt{constructor(pe){super(pe),this._transformState=new at(this),pe&&(pe.transform&&(this._transform=pe.transform),pe.flush&&(this._flush=pe.flush))}_write(pe,Ot){this._readableState.buffered>=this._readableState.highWaterMark?this._transformState.data=pe:this._transform(pe,this._transformState.afterTransform)}_read(pe){if(this._transformState.data!==null){const Ot=this._transformState.data;this._transformState.data=null,pe(null),this._transform(Ot,this._transformState.afterTransform)}else pe(null)}destroy(pe){super.destroy(pe),this._transformState.data!==null&&(this._transformState.data=null,this._transformState.afterTransform())}_transform(pe,Ot){Ot(null,pe)}_flush(pe){pe(null)}_final(pe){this._transformState.afterFinal=pe,this._flush(an.bind(this))}}function an(Ht,pe){const Ot=this._transformState.afterFinal;if(Ht)return Ot(Ht);pe!=null&&this.push(pe),this.push(null),Ot(null)}function hn(Ht,...pe){const Ot=Array.isArray(Ht)?[...Ht,...pe]:[Ht,...pe],qt=Ot.length&&typeof Ot[Ot.length-1]=="function"?Ot.pop():null;if(Ot.length<2)throw new Error("Pipeline requires at least 2 streams");let fe=Ot[0],we=null,pt=null;for(let oe=1;oe<Ot.length;oe++)we=Ot[oe],Bn(fe)?fe.pipe(we,K):(At(fe,!0,oe>1,K),fe.pipe(we)),fe=we;if(qt){let oe=!1;const ce=Bn(we)||!(!we._writableState||!we._writableState.autoDestroy);we.on("error",D=>{pt===null&&(pt=D)}),we.on("finish",()=>{oe=!0,ce||qt(pt)}),ce&&we.on("close",()=>qt(pt||(oe?null:a)))}return we;function At(oe,ce,D,ge){oe.on("error",ge),oe.on("close",function(){if(oe._readableState&&!oe._readableState.ended||D&&oe._writableState&&!oe._writableState.ended)return ge(a)})}function K(oe){if(oe&&!pt){pt=oe;for(const ce of Ot)ce.destroy(oe)}}}function pr(Ht){return Ht}function Ft(Ht){return!!Ht._readableState||!!Ht._writableState}function Bn(Ht){return typeof Ht._duplexState=="number"&&Ft(Ht)}function xr(Ht){return(function(pe){return typeof pe=="object"&&pe!==null&&typeof pe.byteLength=="number"})(Ht)?Ht.byteLength:1024}function _r(){}function Zn(){this.destroy(new Error("Stream aborted."))}i.exports={pipeline:hn,pipelinePromise:function(...Ht){return new Promise((pe,Ot)=>hn(...Ht,qt=>{if(qt)return Ot(qt);pe()}))},isStream:Ft,isStreamx:Bn,isEnded:function(Ht){return!!Ht._readableState&&Ht._readableState.ended},isFinished:function(Ht){return!!Ht._writableState&&Ht._writableState.ended},isDisturbed:function(Ht){return!!(1&~Ht._duplexState)||(Ht._duplexState&ot)!==0},getStreamError:function(Ht,pe={}){const Ot=Ht._readableState&&Ht._readableState.error||Ht._writableState&&Ht._writableState.error;return pe.all||Ot!==s?Ot:null},Stream:Ut,Writable:Xe,Readable:Le,Duplex:zt,Transform:mt,PassThrough:class extends mt{}}},8190:(i,e,t)=>{i.exports=function(s,a){let l,u,c,f=!0;Array.isArray(s)?(l=[],u=s.length):(c=Object.keys(s),l={},u=c.length);function d(m){function v(){a&&a(m,l),a=null}f?n(v):v()}function p(m,v,b){l[m]=b,(--u===0||v)&&d(v)}u?c?c.forEach(function(m){s[m](function(v,b){p(m,v,b)})}):s.forEach(function(m,v){m(function(b,y){p(v,b,y)})}):d(null),f=!1};const n=t(9596)},8271:()=>{},8330:i=>{i.exports={version:"2.8.5"}},8436:()=>{},8444:i=>{i.exports=function(e){return Math.max(16384,1<<Math.log2(e<1024?1:e/1024)+.5)}},8446:i=>{i.exports={"application/andrew-inset":["ez"],"application/applixware":["aw"],"application/atom+xml":["atom"],"application/atomcat+xml":["atomcat"],"application/atomdeleted+xml":["atomdeleted"],"application/atomsvc+xml":["atomsvc"],"application/atsc-dwd+xml":["dwd"],"application/atsc-held+xml":["held"],"application/atsc-rsat+xml":["rsat"],"application/bdoc":["bdoc"],"application/calendar+xml":["xcs"],"application/ccxml+xml":["ccxml"],"application/cdfx+xml":["cdfx"],"application/cdmi-capability":["cdmia"],"application/cdmi-container":["cdmic"],"application/cdmi-domain":["cdmid"],"application/cdmi-object":["cdmio"],"application/cdmi-queue":["cdmiq"],"application/cu-seeme":["cu"],"application/dash+xml":["mpd"],"application/davmount+xml":["davmount"],"application/docbook+xml":["dbk"],"application/dssc+der":["dssc"],"application/dssc+xml":["xdssc"],"application/ecmascript":["es","ecma"],"application/emma+xml":["emma"],"application/emotionml+xml":["emotionml"],"application/epub+zip":["epub"],"application/exi":["exi"],"application/express":["exp"],"application/fdt+xml":["fdt"],"application/font-tdpfr":["pfr"],"application/geo+json":["geojson"],"application/gml+xml":["gml"],"application/gpx+xml":["gpx"],"application/gxf":["gxf"],"application/gzip":["gz"],"application/hjson":["hjson"],"application/hyperstudio":["stk"],"application/inkml+xml":["ink","inkml"],"application/ipfix":["ipfix"],"application/its+xml":["its"],"application/java-archive":["jar","war","ear"],"application/java-serialized-object":["ser"],"application/java-vm":["class"],"application/javascript":["js","mjs"],"application/json":["json","map"],"application/json5":["json5"],"application/jsonml+json":["jsonml"],"application/ld+json":["jsonld"],"application/lgr+xml":["lgr"],"application/lost+xml":["lostxml"],"application/mac-binhex40":["hqx"],"application/mac-compactpro":["cpt"],"application/mads+xml":["mads"],"application/manifest+json":["webmanifest"],"application/marc":["mrc"],"application/marcxml+xml":["mrcx"],"application/mathematica":["ma","nb","mb"],"application/mathml+xml":["mathml"],"application/mbox":["mbox"],"application/mediaservercontrol+xml":["mscml"],"application/metalink+xml":["metalink"],"application/metalink4+xml":["meta4"],"application/mets+xml":["mets"],"application/mmt-aei+xml":["maei"],"application/mmt-usd+xml":["musd"],"application/mods+xml":["mods"],"application/mp21":["m21","mp21"],"application/mp4":["mp4s","m4p"],"application/msword":["doc","dot"],"application/mxf":["mxf"],"application/n-quads":["nq"],"application/n-triples":["nt"],"application/node":["cjs"],"application/octet-stream":["bin","dms","lrf","mar","so","dist","distz","pkg","bpk","dump","elc","deploy","exe","dll","deb","dmg","iso","img","msi","msp","msm","buffer"],"application/oda":["oda"],"application/oebps-package+xml":["opf"],"application/ogg":["ogx"],"application/omdoc+xml":["omdoc"],"application/onenote":["onetoc","onetoc2","onetmp","onepkg"],"application/oxps":["oxps"],"application/p2p-overlay+xml":["relo"],"application/patch-ops-error+xml":["xer"],"application/pdf":["pdf"],"application/pgp-encrypted":["pgp"],"application/pgp-signature":["asc","sig"],"application/pics-rules":["prf"],"application/pkcs10":["p10"],"application/pkcs7-mime":["p7m","p7c"],"application/pkcs7-signature":["p7s"],"application/pkcs8":["p8"],"application/pkix-attr-cert":["ac"],"application/pkix-cert":["cer"],"application/pkix-crl":["crl"],"application/pkix-pkipath":["pkipath"],"application/pkixcmp":["pki"],"application/pls+xml":["pls"],"application/postscript":["ai","eps","ps"],"application/provenance+xml":["provx"],"application/pskc+xml":["pskcxml"],"application/raml+yaml":["raml"],"application/rdf+xml":["rdf","owl"],"application/reginfo+xml":["rif"],"application/relax-ng-compact-syntax":["rnc"],"application/resource-lists+xml":["rl"],"application/resource-lists-diff+xml":["rld"],"application/rls-services+xml":["rs"],"application/route-apd+xml":["rapd"],"application/route-s-tsid+xml":["sls"],"application/route-usd+xml":["rusd"],"application/rpki-ghostbusters":["gbr"],"application/rpki-manifest":["mft"],"application/rpki-roa":["roa"],"application/rsd+xml":["rsd"],"application/rss+xml":["rss"],"application/rtf":["rtf"],"application/sbml+xml":["sbml"],"application/scvp-cv-request":["scq"],"application/scvp-cv-response":["scs"],"application/scvp-vp-request":["spq"],"application/scvp-vp-response":["spp"],"application/sdp":["sdp"],"application/senml+xml":["senmlx"],"application/sensml+xml":["sensmlx"],"application/set-payment-initiation":["setpay"],"application/set-registration-initiation":["setreg"],"application/shf+xml":["shf"],"application/sieve":["siv","sieve"],"application/smil+xml":["smi","smil"],"application/sparql-query":["rq"],"application/sparql-results+xml":["srx"],"application/srgs":["gram"],"application/srgs+xml":["grxml"],"application/sru+xml":["sru"],"application/ssdl+xml":["ssdl"],"application/ssml+xml":["ssml"],"application/swid+xml":["swidtag"],"application/tei+xml":["tei","teicorpus"],"application/thraud+xml":["tfi"],"application/timestamped-data":["tsd"],"application/toml":["toml"],"application/trig":["trig"],"application/ttml+xml":["ttml"],"application/ubjson":["ubj"],"application/urc-ressheet+xml":["rsheet"],"application/urc-targetdesc+xml":["td"],"application/voicexml+xml":["vxml"],"application/wasm":["wasm"],"application/widget":["wgt"],"application/winhlp":["hlp"],"application/wsdl+xml":["wsdl"],"application/wspolicy+xml":["wspolicy"],"application/xaml+xml":["xaml"],"application/xcap-att+xml":["xav"],"application/xcap-caps+xml":["xca"],"application/xcap-diff+xml":["xdf"],"application/xcap-el+xml":["xel"],"application/xcap-ns+xml":["xns"],"application/xenc+xml":["xenc"],"application/xhtml+xml":["xhtml","xht"],"application/xliff+xml":["xlf"],"application/xml":["xml","xsl","xsd","rng"],"application/xml-dtd":["dtd"],"application/xop+xml":["xop"],"application/xproc+xml":["xpl"],"application/xslt+xml":["*xsl","xslt"],"application/xspf+xml":["xspf"],"application/xv+xml":["mxml","xhvml","xvml","xvm"],"application/yang":["yang"],"application/yin+xml":["yin"],"application/zip":["zip"],"audio/3gpp":["*3gpp"],"audio/adpcm":["adp"],"audio/amr":["amr"],"audio/basic":["au","snd"],"audio/midi":["mid","midi","kar","rmi"],"audio/mobile-xmf":["mxmf"],"audio/mp3":["*mp3"],"audio/mp4":["m4a","mp4a"],"audio/mpeg":["mpga","mp2","mp2a","mp3","m2a","m3a"],"audio/ogg":["oga","ogg","spx","opus"],"audio/s3m":["s3m"],"audio/silk":["sil"],"audio/wav":["wav"],"audio/wave":["*wav"],"audio/webm":["weba"],"audio/xm":["xm"],"font/collection":["ttc"],"font/otf":["otf"],"font/ttf":["ttf"],"font/woff":["woff"],"font/woff2":["woff2"],"image/aces":["exr"],"image/apng":["apng"],"image/avif":["avif"],"image/bmp":["bmp"],"image/cgm":["cgm"],"image/dicom-rle":["drle"],"image/emf":["emf"],"image/fits":["fits"],"image/g3fax":["g3"],"image/gif":["gif"],"image/heic":["heic"],"image/heic-sequence":["heics"],"image/heif":["heif"],"image/heif-sequence":["heifs"],"image/hej2k":["hej2"],"image/hsj2":["hsj2"],"image/ief":["ief"],"image/jls":["jls"],"image/jp2":["jp2","jpg2"],"image/jpeg":["jpeg","jpg","jpe"],"image/jph":["jph"],"image/jphc":["jhc"],"image/jpm":["jpm"],"image/jpx":["jpx","jpf"],"image/jxr":["jxr"],"image/jxra":["jxra"],"image/jxrs":["jxrs"],"image/jxs":["jxs"],"image/jxsc":["jxsc"],"image/jxsi":["jxsi"],"image/jxss":["jxss"],"image/ktx":["ktx"],"image/ktx2":["ktx2"],"image/png":["png"],"image/sgi":["sgi"],"image/svg+xml":["svg","svgz"],"image/t38":["t38"],"image/tiff":["tif","tiff"],"image/tiff-fx":["tfx"],"image/webp":["webp"],"image/wmf":["wmf"],"message/disposition-notification":["disposition-notification"],"message/global":["u8msg"],"message/global-delivery-status":["u8dsn"],"message/global-disposition-notification":["u8mdn"],"message/global-headers":["u8hdr"],"message/rfc822":["eml","mime"],"model/3mf":["3mf"],"model/gltf+json":["gltf"],"model/gltf-binary":["glb"],"model/iges":["igs","iges"],"model/mesh":["msh","mesh","silo"],"model/mtl":["mtl"],"model/obj":["obj"],"model/step+xml":["stpx"],"model/step+zip":["stpz"],"model/step-xml+zip":["stpxz"],"model/stl":["stl"],"model/vrml":["wrl","vrml"],"model/x3d+binary":["*x3db","x3dbz"],"model/x3d+fastinfoset":["x3db"],"model/x3d+vrml":["*x3dv","x3dvz"],"model/x3d+xml":["x3d","x3dz"],"model/x3d-vrml":["x3dv"],"text/cache-manifest":["appcache","manifest"],"text/calendar":["ics","ifb"],"text/coffeescript":["coffee","litcoffee"],"text/css":["css"],"text/csv":["csv"],"text/html":["html","htm","shtml"],"text/jade":["jade"],"text/jsx":["jsx"],"text/less":["less"],"text/markdown":["markdown","md"],"text/mathml":["mml"],"text/mdx":["mdx"],"text/n3":["n3"],"text/plain":["txt","text","conf","def","list","log","in","ini"],"text/richtext":["rtx"],"text/rtf":["*rtf"],"text/sgml":["sgml","sgm"],"text/shex":["shex"],"text/slim":["slim","slm"],"text/spdx":["spdx"],"text/stylus":["stylus","styl"],"text/tab-separated-values":["tsv"],"text/troff":["t","tr","roff","man","me","ms"],"text/turtle":["ttl"],"text/uri-list":["uri","uris","urls"],"text/vcard":["vcard"],"text/vtt":["vtt"],"text/xml":["*xml"],"text/yaml":["yaml","yml"],"video/3gpp":["3gp","3gpp"],"video/3gpp2":["3g2"],"video/h261":["h261"],"video/h263":["h263"],"video/h264":["h264"],"video/iso.segment":["m4s"],"video/jpeg":["jpgv"],"video/jpm":["*jpm","jpgm"],"video/mj2":["mj2","mjp2"],"video/mp2t":["ts"],"video/mp4":["mp4","mp4v","mpg4"],"video/mpeg":["mpeg","mpg","mpe","m1v","m2v"],"video/ogg":["ogv"],"video/quicktime":["qt","mov"],"video/webm":["webm"]}},8454:(i,e,t)=>{var n=t(7007),s=t(6698);function a(l){if(!(this instanceof a))return new a(l);typeof l=="number"&&(l={max:l}),l||(l={}),n.EventEmitter.call(this),this.cache={},this.head=this.tail=null,this.length=0,this.max=l.max||1e3,this.maxAge=l.maxAge||0}i.exports=a,s(a,n.EventEmitter),Object.defineProperty(a.prototype,"keys",{get:function(){return Object.keys(this.cache)}}),a.prototype.clear=function(){this.cache={},this.head=this.tail=null,this.length=0},a.prototype.remove=function(l){if(typeof l!="string"&&(l=""+l),this.cache.hasOwnProperty(l)){var u=this.cache[l];return delete this.cache[l],this._unlink(l,u.prev,u.next),u.value}},a.prototype._unlink=function(l,u,c){this.length--,this.length===0?this.head=this.tail=null:this.head===l?(this.head=u,this.cache[this.head].next=null):this.tail===l?(this.tail=c,this.cache[this.tail].prev=null):(this.cache[u].next=c,this.cache[c].prev=u)},a.prototype.peek=function(l){if(this.cache.hasOwnProperty(l)){var u=this.cache[l];if(this._checkAge(l,u))return u.value}},a.prototype.set=function(l,u){var c;if(typeof l!="string"&&(l=""+l),this.cache.hasOwnProperty(l)){if((c=this.cache[l]).value=u,this.maxAge&&(c.modified=Date.now()),l===this.head)return u;this._unlink(l,c.prev,c.next)}else c={value:u,modified:0,next:null,prev:null},this.maxAge&&(c.modified=Date.now()),this.cache[l]=c,this.length===this.max&&this.evict();return this.length++,c.next=null,c.prev=this.head,this.head&&(this.cache[this.head].next=l),this.head=l,this.tail||(this.tail=l),u},a.prototype._checkAge=function(l,u){return!(this.maxAge&&Date.now()-u.modified>this.maxAge)||(this.remove(l),this.emit("evict",{key:l,value:u.value}),!1)},a.prototype.get=function(l){if(typeof l!="string"&&(l=""+l),this.cache.hasOwnProperty(l)){var u=this.cache[l];if(this._checkAge(l,u))return this.head!==l&&(l===this.tail?(this.tail=u.next,this.cache[this.tail].prev=null):this.cache[u.prev].next=u.next,this.cache[u.next].prev=u.prev,this.cache[this.head].next=l,u.prev=this.head,u.next=null,this.head=l),u.value}},a.prototype.evict=function(){if(this.tail){var l=this.tail,u=this.remove(this.tail);this.emit("evict",{key:l,value:u})}}},8499:(i,e,t)=>{const{TokenBucket:n}=t(9439),s=t(8765);i.exports=class{constructor(a={}){if(typeof a!="object")throw new Error("Options must be an object");this.throttles=[],this.setEnabled(a.enabled),this.setRate(a.rate,a.chunksize)}getEnabled(){return this._enabled}getRate(){return this.bucket.tokensPerInterval}getChunksize(){return this.chunksize}setEnabled(a=!0){if(typeof a!="boolean")throw new Error("Enabled must be a boolean");this._enabled=a;for(const l of this.throttles)l.setEnabled(a)}setRate(a,l=null){if(!Number.isInteger(a)||a<0)throw new Error("Rate must be an integer bigger than zero");if(a=parseInt(a),l&&(typeof l!="number"||l<=0))throw new Error("Chunksize must be bigger than zero");if(l=l||Math.max(parseInt(a/10),1),l=parseInt(l),a>0&&l>a)throw new Error("Chunk size must be smaller than rate");this.bucket||(this.bucket=new n(a,a,"second",null)),this.bucket.bucketSize=a,this.bucket.tokensPerInterval=a,this.chunksize=l}setChunksize(a){if(!Number.isInteger(a)||a<=0)throw new Error("Chunk size must be an integer bigger than zero");const l=this.getRate();if(a=parseInt(a),l>0&&a>l)throw new Error("Chunk size must be smaller than rate");this.chunksize=a}throttle(a={}){if(typeof a!="object")throw new Error("Options must be an object");return new s({...a,group:this})}destroy(){for(const a of this.throttles)a.destroy();this.throttles=[]}_addThrottle(a){if(!(a instanceof s))throw new Error("Throttle must be an instance of Throttle");this.throttles.push(a)}_removeThrottle(a){const l=this.throttles.indexOf(a);l>-1&&this.throttles.splice(l,1)}}},8529:()=>{},8673:i=>{function e(){this._types=Object.create(null),this._extensions=Object.create(null);for(let t=0;t<arguments.length;t++)this.define(arguments[t]);this.define=this.define.bind(this),this.getType=this.getType.bind(this),this.getExtension=this.getExtension.bind(this)}e.prototype.define=function(t,n){for(let s in t){let a=t[s].map(function(l){return l.toLowerCase()});s=s.toLowerCase();for(let l=0;l<a.length;l++){const u=a[l];if(u[0]!=="*"){if(!n&&u in this._types)throw new Error('Attempt to change mapping for "'+u+'" extension from "'+this._types[u]+'" to "'+s+'". Pass `force=true` to allow this, otherwise remove "'+u+'" from the list of extensions for "'+s+'".');this._types[u]=s}}if(n||!this._extensions[s]){const l=a[0];this._extensions[s]=l[0]!=="*"?l:l.substr(1)}}},e.prototype.getType=function(t){let n=(t=String(t)).replace(/^.*[/\\]/,"").toLowerCase(),s=n.replace(/^.*\./,"").toLowerCase(),a=n.length<t.length;return(s.length<n.length-1||!a)&&this._types[s]||null},e.prototype.getExtension=function(t){return(t=/^\s*([^;\s]*)/.test(t)&&RegExp.$1)&&this._extensions[t.toLowerCase()]||null},i.exports=e},8727:i=>{function e(f){return parseInt(f,10)===f}function t(f){function d(m){if(m===void 0){m=new Array(f);for(var v=0;v<f;v++)m[v]=Math.floor(Math.random()*f)}else if(typeof m=="string")m=(m=""+m).split("").map(function(x){return x.charCodeAt(0)%f});else{if(!Array.isArray(m))throw new TypeError("invalid seed key specified");if(!m.every(function(x){return typeof x=="number"&&x===(0|x)}))throw new TypeError("invalid seed key specified: not array of integers")}for(var b=m.length,y=(function(){for(var x=new Array(f),k=0;k<f;k++)x[k]=k;return x})(),w=0,C=0;C<f;C++){w=(w+y[C]+m[C%b])%f;var S=y[C];y[C]=y[w],y[w]=S}return y}function p(m){this.s=d(m),this.i=0,this.j=0}return p.prototype.randomNative=function(){this.i=(this.i+1)%f,this.j=(this.j+this.s[this.i])%f;var m=this.s[this.i];return this.s[this.i]=this.s[this.j],this.s[this.j]=m,this.s[(this.s[this.i]+this.s[this.j])%f]},p.prototype.randomUInt32=function(){return 256*(256*(256*this.randomByte()+this.randomByte())+this.randomByte())+this.randomByte()},p.prototype.randomFloat=function(){return this.randomUInt32()/4294967296},p.prototype.random=function(){var m,v;if(arguments.length===1)m=0,v=arguments[0];else{if(arguments.length!==2)throw new TypeError("random takes one or two integer arguments");m=arguments[0],v=arguments[1]}if(!e(m)||!e(v))throw new TypeError("random takes one or two integer arguments");return m+this.randomUInt32()%(v-m+1)},p.prototype.currentState=function(){return{i:this.i,j:this.j,s:this.s.slice()}},p.prototype.setState=function(m){var v=m.s,b=m.i,y=m.j;if(!(b===(0|b)&&0<=b&&b<f))throw new Error("state.i should be integer [0, "+(f-1)+"]");if(!(y===(0|y)&&0<=y&&y<f))throw new Error("state.j should be integer [0, "+(f-1)+"]");if(!Array.isArray(v)||v.length!==f)throw new Error("state should be array of length "+f);for(var w=0;w<f;w++)if(v.indexOf(w)===-1)throw new Error("state should be permutation of 0.."+(f-1)+": "+w+" is missing");this.i=b,this.j=y,this.s=v.slice()},p}var n=t(256);n.prototype.randomByte=n.prototype.randomNative;var s=t(16);s.prototype.randomByte=function(){return 16*this.randomNative()+this.randomNative()};var a=97,l=48;function u(f){return f<10?String.fromCharCode(l+f):String.fromCharCode(a+f-10)}function c(f){return parseInt(f,16)}s.prototype.currentStateString=function(){var f=this.currentState();return u(f.i)+u(f.j)+f.s.map(u).join("")},s.prototype.setStateString=function(f){if(!f.match(/^[0-9a-f]{18}$/))throw new TypeError("RC4small stateString should be 18 hex character string");var d=c(f[0]),p=c(f[1]),m=f.split("").slice(2).map(c);this.setState({i:d,j:p,s:m})},n.RC4small=s,i.exports=n},8765:(i,e,t)=>{const{EventEmitter:n}=t(7007),{Transform:s}=t(8179),{wait:a}=t(2072);i.exports=class extends s{constructor(u={}){if(super(),typeof u!="object")throw new Error("Options must be an object");const c=Object.assign({},u);if(c.group&&!(c.group instanceof l))throw new Error("Group must be an instanece of ThrottleGroup");c.group||(c.group=new l(c)),this._setEnabled(c.enabled||c.group.enabled),this._group=c.group,this._emitter=new n,this._destroyed=!1,this._group._addThrottle(this)}getEnabled(){return this._enabled}getGroup(){return this._group}_setEnabled(u=!0){if(typeof u!="boolean")throw new Error("Enabled must be a boolean");this._enabled=u}setEnabled(u){this._setEnabled(u),this._enabled?this._emitter.emit("enabled"):this._emitter.emit("disabled")}_transform(u,c){this._processChunk(u,c)}async _waitForTokens(u){return new Promise((c,f)=>{let d=!1;const p=this;function m(v){if(p._emitter.removeListener("disabled",m),p._emitter.removeListener("destroyed",m),!d){if(d=!0,v)return f(v);c()}}this._emitter.once("disabled",m),this._emitter.once("destroyed",m),this._group.bucket.removeTokens(u,m)})}_areBothEnabled(){return this._enabled&&this._group.getEnabled()}async _processChunk(u,c){if(!this._areBothEnabled())return c(null,u);let f=0,d=this._group.getChunksize(),p=u.slice(f,f+d);for(;p.length>0;){if(this._areBothEnabled())try{for(;this._group.getRate()===0&&!this._destroyed&&this._areBothEnabled();)if(await a(1e3),this._destroyed)return;if(this._areBothEnabled()&&!this._group.bucket.tryRemoveTokens(p.length)&&(await this._waitForTokens(p.length),this._destroyed))return}catch(m){return c(m)}this.push(p),f+=d,d=this._areBothEnabled()?this._group.getChunksize():u.length-f,p=u.slice(f,f+d)}return c()}destroy(...u){this._group._removeThrottle(this),this._destroyed=!0,this._emitter.emit("destroyed"),super.destroy(...u)}};const l=t(8499)},8878:()=>{},9439:(i,e,t)=>{e.RateLimiter=t(3065),e.TokenBucket=t(5472)},9596:i=>{let e;i.exports=typeof queueMicrotask=="function"?queueMicrotask.bind(typeof window<"u"?window:globalThis):t=>(e||(e=Promise.resolve())).then(t).catch(n=>setTimeout(()=>{throw n},0))},9639:(i,e,t)=>{t.d(e,{NJ:()=>C,V5:()=>l,dU:()=>b,HB:()=>S,xW:()=>c,LC:()=>f,tW:()=>U,fk:()=>u,Ht:()=>x,po:()=>te,L0:()=>w});const n="0123456789abcdef",s=[],a=[];for(let G=0;G<256;G++)s[G]=n[G>>4&15]+n[15&G],G<16&&(G<10?a[48+G]=G:a[87+G]=G);const l=G=>{const Y=G.length;let O="",N=0;for(;N<Y;)O+=s[G[N++]];return O},u=G=>{const Y=G.length>>1,O=Y<<1,N=new Uint8Array(Y);let Q=0,q=0;for(;q<O;)N[Q++]=a[G.charCodeAt(q++)]<<4|a[G.charCodeAt(q++)];return N},c=(G,Y=0)=>{const O=G.length||0;if(!Y){let ee=O;for(;ee--;)Y+=G[ee].length}const N=new Uint8Array(Y);let Q=Y,q=O;for(;q--;)Q-=G[q].length,N.set(G[q],Q);return N},f=(G,Y)=>{if(G.length!==Y.length)return!1;for(let O=G.length;O>-1;O-=1)if(G[O]!==Y[O])return!1;return!0};for(var d="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",p=typeof Uint8Array>"u"?[]:new Uint8Array(256),m=0;m<64;m++)p[d.charCodeAt(m)]=m;const v=new TextDecoder,b=(G,Y)=>Y?new TextDecoder(Y).decode(G):v.decode(G),y=new TextEncoder,w=G=>y.encode(G),C=G=>(function(Y){var O,N=new Uint8Array(Y),Q=N.length,q="";for(O=0;O<Q;O+=3)q+=d[N[O]>>2],q+=d[(3&N[O])<<4|N[O+1]>>4],q+=d[(15&N[O+1])<<2|N[O+2]>>6],q+=d[63&N[O+2]];return Q%3==2?q=q.substring(0,q.length-1)+"=":Q%3==1&&(q=q.substring(0,q.length-2)+"=="),q})(G),S=G=>{let Y,O="",N=0;const Q=G.length;for(;N<Q;)Y=G.charCodeAt(N++),O+=n[Y>>4]+n[15&Y];return O},x=G=>{const Y=u(G);if(Y.length<=65536)return String.fromCharCode(...Y);let O="",N=0;for(;N<Y.length;)O+=String.fromCharCode(...Y.subarray(N,N+=65536));return O},k=typeof window<"u"?window:self,A=k.crypto||k.msCrypto||{},R=A.subtle||A.webkitSubtle,I={hex:l,base64:C},U=async(G,Y,O="sha-1")=>{if(!R)throw new Error("no web crypto support");typeof G=="string"&&(G=w(G));const N=new Uint8Array(await R.digest(O,G));return Y?I[Y](N):N},te=G=>{const Y=new Uint8Array(G);return A.getRandomValues(Y)}}},bx={};function fn(i){var e=bx[i];if(e!==void 0)return e.exports;var t=bx[i]={exports:{}};return f4[i](t,t.exports,fn),t.exports}vc=Object.getPrototypeOf?i=>Object.getPrototypeOf(i):i=>i.__proto__,fn.t=function(i,e){if(1&e&&(i=this(i)),8&e||typeof i=="object"&&i&&(4&e&&i.__esModule||16&e&&typeof i.then=="function"))return i;var t=Object.create(null);fn.r(t);var n={};Og=Og||[null,vc({}),vc([]),vc(vc)];for(var s=2&e&&i;(typeof s=="object"||typeof s=="function")&&!~Og.indexOf(s);s=vc(s))Object.getOwnPropertyNames(s).forEach(a=>n[a]=()=>i[a]);return n.default=()=>i,fn.d(t,n),t},fn.d=(i,e)=>{for(var t in e)fn.o(e,t)&&!fn.o(i,t)&&Object.defineProperty(i,t,{enumerable:!0,get:e[t]})},fn.o=(i,e)=>Object.prototype.hasOwnProperty.call(i,e),fn.r=i=>{typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(i,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(i,"__esModule",{value:!0})};var No=fn(7007);function td(i){if(typeof i!="string")throw new TypeError("Path must be a string. Received "+JSON.stringify(i))}function h4(i,e){let t,n="",s=0,a=-1,l=0;for(let u=0;u<=i.length;++u){if(u<i.length)t=i.charCodeAt(u);else{if(t===47)break;t=47}if(t===47){if(!(a===u-1||l===1))if(a!==u-1&&l===2){if(n.length<2||s!==2||n.charCodeAt(n.length-1)!==46||n.charCodeAt(n.length-2)!==46){if(n.length>2){const c=n.lastIndexOf("/");if(c!==n.length-1){c===-1?(n="",s=0):(n=n.slice(0,c),s=n.length-1-n.lastIndexOf("/")),a=u,l=0;continue}}else if(n.length===2||n.length===1){n="",s=0,a=u,l=0;continue}}e&&(n.length>0?n+="/..":n="..",s=2)}else n.length>0?n+="/"+i.slice(a+1,u):n=i.slice(a+1,u),s=u-a-1;a=u,l=0}else t===46&&l!==-1?++l:l=-1}return n}function Ku(){if(arguments.length===0)return".";let i;for(let e=0;e<arguments.length;++e){const t=arguments[e];td(t),t.length>0&&(i===void 0?i=t:i+="/"+t)}return i===void 0?".":(function(e){if(td(e),e.length===0)return".";const t=e.charCodeAt(0)===47,n=e.charCodeAt(e.length-1)===47;return(e=h4(e,!t)).length!==0||t||(e="."),e.length>0&&n&&(e+="/"),t?"/"+e:e})(i)}fn(717);const d4="/";var Fs=fn(988),NS=fn(1467),p4=fn(8444),g4=fn(2123);const m4=new RegExp(["^npm-debug\\.log$","^\\..*\\.swp$","^\\.DS_Store$","^\\.AppleDouble$","^\\.LSOverride$","^Icon\\r$","^\\._.*","^\\.Spotlight-V100(?:$|\\/)","\\.Trashes","^__MACOSX$","~$","^Thumbs\\.db$","^ehthumbs\\.db$","^[Dd]esktop\\.ini$","@eaDir$"].join("|"));function y4(i){return m4.test(i)}var BS=fn(405),Pa=fn(8190),Ai=fn(9596),rn=fn(9639),Xf=(fn(3468),fn(2532));const b4=[["udp://tracker.leechers-paradise.org:6969"],["udp://tracker.coppersurfer.tk:6969"],["udp://tracker.opentrackr.org:1337"],["udp://explodie.org:6969"],["udp://tracker.empire-js.us:1337"],["wss://tracker.btorrent.xyz"],["wss://tracker.openwebtorrent.com"],["wss://tracker.webtorrent.dev"]],ns=Symbol("itemPath");function jS(i,e,t){var n;if(n=i,typeof FileList<"u"&&n instanceof FileList&&(i=Array.from(i)),Array.isArray(i)||(i=[i]),i.length===0)throw new Error("invalid input type");i.forEach(c=>{if(c==null)throw new Error(`invalid input type: ${c}`)}),(i=i.map(c=>vx(c)&&typeof c.path=="string"&&typeof Xf=="function"?c.path:c)).length!==1||typeof i[0]=="string"||i[0].name||(i[0].name=e.name);let s=null;i.forEach((c,f)=>{if(typeof c=="string")return;let d=c.fullPath||c.name;d||(d=`Unknown File ${f+1}`,c.unknownName=!0),c[ns]=d.split("/"),c[ns][0]||c[ns].shift(),c[ns].length<2?s=null:f===0&&i.length>1?s=c[ns][0]:c[ns][0]!==s&&(s=null)}),(e.filterJunkFiles===void 0||e.filterJunkFiles)&&(i=i.filter(c=>typeof c=="string"||!(function(f){const d=f[f.length-1];return d[0]==="."&&y4(d)})(c[ns]))),s&&i.forEach(c=>{const f=(ArrayBuffer.isView(c)||xx(c))&&!c[ns];typeof c=="string"||f||c[ns].shift()}),!e.name&&s&&(e.name=s),e.name||i.some(c=>typeof c=="string"?(e.name=(function(f,d){td(f);let p,m=0,v=-1,b=!0;for(p=f.length-1;p>=0;--p)if(f.charCodeAt(p)===47){if(!b){m=p+1;break}}else v===-1&&(b=!1,v=p+1);return v===-1?"":f.slice(m,v)})(c),!0):!c.unknownName&&(e.name=c[ns][c[ns].length-1],!0)),e.name||(e.name=`Unnamed Torrent ${Date.now()}`),e.maxPieceLength||(e.maxPieceLength=4194304);const a=i.reduce((c,f)=>c+ +(typeof f=="string"),0);let l=i.length===1;if(i.length===1&&typeof i[0]=="string"){if(typeof Xf!="function")throw new Error("filesystem paths do not work in the browser");g4(i[0],(c,f)=>{if(c)return t(c);l=f,u()})}else Ai(u);function u(){Pa(i.map(c=>f=>{const d={};if(vx(c))d.getStream=c.stream(),d.length=c.size;else if(ArrayBuffer.isView(c))d.getStream=[c],d.length=c.length;else{if(!xx(c)){if(typeof c=="string"){if(typeof Xf!="function")throw new Error("filesystem paths do not work in the browser");return void Xf(c,a>1||l,f)}throw new Error("invalid input type")}d.getStream=(async function*(p,m){for await(const v of p)m.length+=v.length,yield v})(c,d),d.length=0}d.path=c[ns],f(null,d)}),(c,f)=>{if(c)return t(c);f=f.flat(),t(null,f,l)})}}const v4=5;function w4(i,e){return i+e.length}function vx(i){return typeof Blob<"u"&&i instanceof Blob}function xx(i){return typeof i=="object"&&i!=null&&typeof i.pipe=="function"}const x4=function(i,e,t){typeof e=="function"&&([e,t]=[t,e]),jS(i,e=e?Object.assign({},e):{},(n,s,a)=>{if(n)return t(n);e.singleFileTorrent=a,(function(l,u,c){let f=u.announceList;f||(typeof u.announce=="string"?f=[[u.announce]]:Array.isArray(u.announce)&&(f=u.announce.map(v=>[v]))),f||(f=[]),globalThis.WEBTORRENT_ANNOUNCE&&(typeof globalThis.WEBTORRENT_ANNOUNCE=="string"?f.push([[globalThis.WEBTORRENT_ANNOUNCE]]):Array.isArray(globalThis.WEBTORRENT_ANNOUNCE)&&(f=f.concat(globalThis.WEBTORRENT_ANNOUNCE.map(v=>[v])))),u.announce===void 0&&u.announceList===void 0&&(f=f.concat(b4)),typeof u.urlList=="string"&&(u.urlList=[u.urlList]);const d={info:{name:u.name},"creation date":Math.ceil((Number(u.creationDate)||Date.now())/1e3),encoding:"UTF-8"};f.length!==0&&(d.announce=f[0][0],d["announce-list"]=f),u.comment!==void 0&&(d.comment=u.comment),u.createdBy!==void 0&&(d["created by"]=u.createdBy),u.private!==void 0&&(d.info.private=Number(u.private)),u.info!==void 0&&Object.assign(d.info,u.info),u.sslCert!==void 0&&(d.info["ssl-cert"]=u.sslCert),u.urlList!==void 0&&(d["url-list"]=u.urlList);const p=l.reduce(w4,0),m=u.pieceLength||Math.min(p4(p),u.maxPieceLength);d.info["piece length"]=m,(async function(v,b,y,w,C){const S=[];let x=0,k=0;const A=v.map(Y=>Y.getStream),R=w.onProgress;let I=0,U=0,te=!1;const G=NS(BS(A),b,{zeroPadding:!1});try{for await(const Y of G)await new Promise(O=>{x+=Y.length;const N=U;++U,++I<v4&&O(),(0,rn.tW)(Y,"hex").then(Q=>{S[N]=Q,--I,k+=Y.length,R&&R(k,y),O(),te&&I===0&&C(null,(0,rn.fk)(S.join("")),x)})});if(I===0)return C(null,(0,rn.fk)(S.join("")),x);te=!0}catch(Y){C(Y)}})(l,m,p,u,(v,b,y)=>{if(v)return c(v);d.info.pieces=b,l.forEach(w=>{delete w.getStream}),u.singleFileTorrent?d.info.length=y:d.info.files=l,c(null,Fs.A.encode(d))})})(s,e,t)})};var Ss=fn(7833),_x=fn(6664),Sx=fn(1827),Ex=fn(3208);const tb=self.fetch||(()=>{throw new Error("global fetch is not available!")}),Cx=[255,255,26,27,28,29,30,31,255,255,255,255,255,255,255,255,255,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,255,255,255,255,255,255,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,255,255,255,255,255],_4=function(i){if(!ArrayBuffer.isView(i)&&typeof i!="string")throw new TypeError("base32.decode only takes Buffer or string as parameter");let e,t=0,n=0,s=0;ArrayBuffer.isView(i)||(i=(0,rn.L0)(i));const a=new Uint8Array(Math.ceil(5*i.length/8));for(let l=0;l<i.length&&i[l]!==61;l++){const u=i[l]-48;if(!(u<Cx.length))throw new Error("Invalid input - it is not base32 encoded string");n=Cx[u],t<=3?(t=(t+5)%8,t===0?(e|=n,a[s]=e,s++,e=0):e|=255&n<<8-t):(t=(t+5)%8,e|=255&n>>>t,a[s]=e,s++,e=255&n<<8-t)}return a.subarray(0,s)};function S4(i){return i.reduce((e,t,n,s)=>{const a=t.split("-").map(l=>parseInt(l));return e.concat(((l,u=l)=>Array.from({length:u-l+1},(c,f)=>f+l))(...a))},[])}const Ng=function(i){const e={},t=i.split("magnet:?")[1];let n;return(t&&t.length>=0?t.split("&"):[]).forEach(s=>{const a=s.split("=");if(a.length!==2)return;const l=a[0];let u=a[1];l==="dn"&&(u=decodeURIComponent(u).replace(/\+/g," ")),l!=="tr"&&l!=="xs"&&l!=="as"&&l!=="ws"||(u=decodeURIComponent(u)),l==="kt"&&(u=decodeURIComponent(u).split("+")),l==="ix"&&(u=Number(u)),l==="so"&&(u=S4(decodeURIComponent(u).split(","))),e[l]?(Array.isArray(e[l])||(e[l]=[e[l]]),e[l].push(u)):e[l]=u}),e.xt&&(Array.isArray(e.xt)?e.xt:[e.xt]).forEach(s=>{(n=s.match(/^urn:btih:(.{40})/))?e.infoHash=n[1].toLowerCase():(n=s.match(/^urn:btih:(.{32})/))?e.infoHash=(0,rn.V5)(_4(n[1])):(n=s.match(/^urn:btmh:1220(.{64})/))&&(e.infoHashV2=n[1].toLowerCase())}),e.xs&&(Array.isArray(e.xs)?e.xs:[e.xs]).forEach(s=>{(n=s.match(/^urn:btpk:(.{64})/))&&(e.publicKey=n[1].toLowerCase())}),e.infoHash&&(e.infoHashBuffer=(0,rn.fk)(e.infoHash)),e.infoHashV2&&(e.infoHashV2Buffer=(0,rn.fk)(e.infoHashV2)),e.publicKey&&(e.publicKeyBuffer=(0,rn.fk)(e.publicKey)),e.dn&&(e.name=e.dn),e.kt&&(e.keywords=e.kt),e.announce=[],(typeof e.tr=="string"||Array.isArray(e.tr))&&(e.announce=e.announce.concat(e.tr)),e.urlList=[],(typeof e.as=="string"||Array.isArray(e.as))&&(e.urlList=e.urlList.concat(e.as)),(typeof e.ws=="string"||Array.isArray(e.ws))&&(e.urlList=e.urlList.concat(e.ws)),e.peerAddresses=[],(typeof e["x.pe"]=="string"||Array.isArray(e["x.pe"]))&&(e.peerAddresses=e.peerAddresses.concat(e["x.pe"])),e.announce=Array.from(new Set(e.announce)),e.urlList=Array.from(new Set(e.urlList)),e.peerAddresses=Array.from(new Set(e.peerAddresses)),e};async function b0(i){if(typeof i=="string"&&/^(stream-)?magnet:/.test(i)){const e=Ng(i);if(!e.infoHash)throw new Error("Invalid torrent identifier");return e}if(typeof i=="string"&&(/^[a-f0-9]{40}$/i.test(i)||/^[a-z2-7]{32}$/i.test(i)))return Ng(`magnet:?xt=urn:btih:${i}`);if(ArrayBuffer.isView(i)&&i.length===20)return Ng(`magnet:?xt=urn:btih:${(0,rn.V5)(i)}`);if(ArrayBuffer.isView(i))return await(async function(e){ArrayBuffer.isView(e)&&(e=Fs.A.decode(e)),gl(e.info,"info"),gl(e.info["name.utf-8"]||e.info.name,"info.name"),gl(e.info["piece length"],"info['piece length']"),gl(e.info.pieces,"info.pieces"),e.info.files?e.info.files.forEach(l=>{gl(typeof l.length=="number","info.files[0].length"),gl(l["path.utf-8"]||l.path,"info.files[0].path")}):gl(typeof e.info.length=="number","info.length");const t={info:e.info,infoBuffer:Fs.A.encode(e.info),name:(0,rn.dU)(e.info["name.utf-8"]||e.info.name),announce:[]};t.infoHashBuffer=await(0,rn.tW)(t.infoBuffer),t.infoHash=(0,rn.V5)(t.infoHashBuffer),e.info.private!==void 0&&(t.private=!!e.info.private),e["creation date"]&&(t.created=new Date(1e3*e["creation date"])),e["created by"]&&(t.createdBy=(0,rn.dU)(e["created by"])),ArrayBuffer.isView(e.comment)&&(t.comment=(0,rn.dU)(e.comment)),Array.isArray(e["announce-list"])&&e["announce-list"].length>0?e["announce-list"].forEach(l=>{l.forEach(u=>{t.announce.push((0,rn.dU)(u))})}):e.announce&&t.announce.push((0,rn.dU)(e.announce)),ArrayBuffer.isView(e["url-list"])&&(e["url-list"]=e["url-list"].length>0?[e["url-list"]]:[]),t.urlList=(e["url-list"]||[]).map(l=>(0,rn.dU)(l)),t.announce=Array.from(new Set(t.announce)),t.urlList=Array.from(new Set(t.urlList));let n=0;const s=e.info.files||[e.info];t.files=s.map((l,u)=>{const c=[].concat(t.name,l["path.utf-8"]||l.path||[]).map(f=>ArrayBuffer.isView(f)?(0,rn.dU)(f):f);return n+=l.length,{path:Ku.apply(null,[d4].concat(c)).slice(1),name:c[c.length-1],length:l.length,offset:n-l.length}}),t.length=n;const a=t.files[t.files.length-1];return t.pieceLength=e.info["piece length"],t.lastPieceLength=(a.offset+a.length)%t.pieceLength||t.pieceLength,t.pieces=(function(l){const u=[];for(let c=0;c<l.length;c+=20)u.push((0,rn.V5)(l.slice(c,c+20)));return u})(e.info.pieces),t})(i);if(i&&i.infoHash)return i.infoHash=i.infoHash.toLowerCase(),i.announce||(i.announce=[]),typeof i.announce=="string"&&(i.announce=[i.announce]),i.urlList||(i.urlList=[]),i;throw new Error("Invalid torrent identifier")}async function DS(i,e,t){if(typeof e=="function")return DS(i,{},e);if(typeof t!="function")throw new Error("second argument must be a Function");let n;try{n=await b0(i)}catch{}if(n&&n.infoHash)Ai(()=>{t(null,n)});else if(s=i,typeof Blob<"u"&&s instanceof Blob)try{a(new Uint8Array(await i.arrayBuffer()))}catch(l){return t(new Error(`Error converting Blob: ${l.message}`))}else if(/^https?:/.test(i))try{const l=await tb(i,{headers:{"user-agent":"WebTorrent (https://webtorrent.io)"},signal:AbortSignal.timeout(3e4),...e});a(new Uint8Array(await l.arrayBuffer()))}catch(l){return t(new Error(`Error downloading torrent: ${l.message}`))}else typeof Ex.readFile=="function"&&typeof i=="string"?Ex.readFile(i,(l,u)=>{if(l)return t(new Error("Invalid torrent identifier"));a(u)}):Ai(()=>{t(new Error("Invalid torrent identifier"))});var s;async function a(l){try{n=await b0(l)}catch(u){return t(u)}n&&n.infoHash?t(null,n):t(new Error("Invalid torrent identifier"))}}function gl(i,e){if(!i)throw new Error(`Torrent is missing required field: ${e}`)}const mh=b0,E4=function(i){i=Object.assign({},i);let e=new Set;i.xt&&typeof i.xt=="string"&&e.add(i.xt),i.xt&&Array.isArray(i.xt)&&(e=new Set(i.xt)),i.infoHashBuffer&&e.add(`urn:btih:${(0,rn.V5)(i.infoHashBuffer)}`),i.infoHash&&e.add(`urn:btih:${i.infoHash}`),i.infoHashV2Buffer&&e.add(i.xt=`urn:btmh:1220${(0,rn.V5)(i.infoHashV2Buffer)}`),i.infoHashV2&&e.add(`urn:btmh:1220${i.infoHashV2}`);const t=Array.from(e);t.length===1&&(i.xt=t[0]),t.length>1&&(i.xt=t),i.publicKeyBuffer&&(i.xs=`urn:btpk:${(0,rn.V5)(i.publicKeyBuffer)}`),i.publicKey&&(i.xs=`urn:btpk:${i.publicKey}`),i.name&&(i.dn=i.name),i.keywords&&(i.kt=i.keywords),i.announce&&(i.tr=i.announce),i.urlList&&(i.ws=i.urlList,delete i.as),i.peerAddresses&&(i["x.pe"]=i.peerAddresses);let n="magnet:?";return Object.keys(i).filter(s=>s.length===2||s==="x.pe").forEach((s,a)=>{const l=Array.isArray(i[s])?i[s]:[i[s]];var u;l.forEach((c,f)=>{(a>0||f>0)&&(s!=="kt"&&s!=="so"||f===0)&&(n+="&"),s==="dn"&&(c=encodeURIComponent(c).replace(/%20/g,"+")),s!=="tr"&&s!=="as"&&s!=="ws"||(c=encodeURIComponent(c)),s!=="xs"||c.startsWith("urn:btpk:")||(c=encodeURIComponent(c)),s==="kt"&&(c=encodeURIComponent(c)),s!=="so"&&(n+=s==="kt"&&f>0?`+${c}`:`${s}=${c}`)}),s==="so"&&(n+=`${s}=${u=l,u.reduce((c,f,d,p)=>(d!==0&&f===p[d-1]+1||c.push([]),c[c.length-1].push(f),c),[]).map(c=>c.length>1?`${c[0]}-${c[c.length-1]}`:`${c[0]}`)}`)}),n},Mo=typeof window<"u"?window:self,v0=Mo.RTCPeerConnection||Mo.mozRTCPeerConnection||Mo.webkitRTCPeerConnection,C4=Mo.RTCSessionDescription||Mo.mozRTCSessionDescription||Mo.webkitRTCSessionDescription,A4=Mo.RTCIceCandidate||Mo.mozRTCIceCandidate||Mo.webkitRTCIceCandidate;var yd=fn(8179),Lr=fn(6310);const k4=Ss("simple-peer"),Bg=65536;function Ax(i){return i.replace(/a=ice-options:trickle\s\n/g,"")}let yh=class w0 extends yd.Duplex{_pc;constructor(e){if(super(e=Object.assign({allowHalfOpen:!1},e)),this.__objectMode=!!e.objectMode,this._id=(0,rn.V5)((0,rn.po)(4)).slice(0,7),this._debug("new peer %o",e),this.channelName=e.initiator?e.channelName||(0,rn.V5)((0,rn.po)(20)):null,this.initiator=e.initiator||!1,this.channelConfig=e.channelConfig||w0.channelConfig,this.channelNegotiated=this.channelConfig.negotiated,this.config=Object.assign({},w0.config,e.config),this.offerOptions=e.offerOptions||{},this.answerOptions=e.answerOptions||{},this.sdpTransform=e.sdpTransform||(t=>t),this.trickle=e.trickle===void 0||e.trickle,this.allowHalfTrickle=e.allowHalfTrickle!==void 0&&e.allowHalfTrickle,this.iceCompleteTimeout=e.iceCompleteTimeout||5e3,this._destroying=!1,this._connected=!1,this.remoteAddress=void 0,this.remoteFamily=void 0,this.remotePort=void 0,this.localAddress=void 0,this.localFamily=void 0,this.localPort=void 0,!v0)throw Lr(typeof window>"u"?new Error("No WebRTC support: Specify `opts.wrtc` option in this environment"):new Error("No WebRTC support: Not a supported browser"),"ERR_WEBRTC_SUPPORT");this._pcReady=!1,this._channelReady=!1,this._iceComplete=!1,this._iceCompleteTimer=null,this._channel=null,this._pendingCandidates=[],this._isNegotiating=!1,this._firstNegotiation=!0,this._batchedNegotiation=!1,this._queuedNegotiation=!1,this._sendersAwaitingStable=[],this._closingInterval=null,this._remoteTracks=[],this._remoteStreams=[],this._chunk=null,this._cb=null,this._interval=null;try{this._pc=new v0(this.config)}catch(t){return void this.__destroy(Lr(t,"ERR_PC_CONSTRUCTOR"))}this._isReactNativeWebrtc=typeof this._pc._peerConnectionId=="number",this._pc.oniceconnectionstatechange=()=>{this._onIceStateChange()},this._pc.onicegatheringstatechange=()=>{this._onIceStateChange()},this._pc.onconnectionstatechange=()=>{this._onConnectionStateChange()},this._pc.onsignalingstatechange=()=>{this._onSignalingStateChange()},this._pc.onicecandidate=t=>{this._onIceCandidate(t)},typeof this._pc.peerIdentity=="object"&&this._pc.peerIdentity.catch(t=>{this.__destroy(Lr(t,"ERR_PC_PEER_IDENTITY"))}),this.initiator||this.channelNegotiated?this._setupData({channel:this._pc.createDataChannel(this.channelName,this.channelConfig)}):this._pc.ondatachannel=t=>{this._setupData(t)},this._debug("initial negotiation"),this._needsNegotiation(),this._onFinishBound=()=>{this._onFinish()},this.once("finish",this._onFinishBound)}get bufferSize(){return this._channel&&this._channel.bufferedAmount||0}get connected(){return this._connected&&this._channel.readyState==="open"}address(){return{port:this.localPort,family:this.localFamily,address:this.localAddress}}signal(e){if(!this._destroying){if(this.destroyed)throw Lr(new Error("cannot signal after peer is destroyed"),"ERR_DESTROYED");if(typeof e=="string")try{e=JSON.parse(e)}catch{e={}}this._debug("signal()"),e.renegotiate&&this.initiator&&(this._debug("got request to renegotiate"),this._needsNegotiation()),e.transceiverRequest&&this.initiator&&(this._debug("got request for transceiver"),this.addTransceiver(e.transceiverRequest.kind,e.transceiverRequest.init)),e.candidate&&(this._pc.remoteDescription&&this._pc.remoteDescription.type?this._addIceCandidate(e.candidate):this._pendingCandidates.push(e.candidate)),e.sdp&&this._pc.setRemoteDescription(new C4(e)).then(()=>{this.destroyed||(this._pendingCandidates.forEach(t=>{this._addIceCandidate(t)}),this._pendingCandidates=[],this._pc.remoteDescription.type==="offer"&&this._createAnswer())}).catch(t=>{this.__destroy(Lr(t,"ERR_SET_REMOTE_DESCRIPTION"))}),e.sdp||e.candidate||e.renegotiate||e.transceiverRequest||this.__destroy(Lr(new Error("signal() called with invalid signal data"),"ERR_SIGNALING"))}}_addIceCandidate(e){const t=new A4(e);this._pc.addIceCandidate(t).catch(n=>{var s;!t.address||t.address.endsWith(".local")?(s="Ignoring unsupported ICE candidate.",console.warn(s)):this.__destroy(Lr(n,"ERR_ADD_ICE_CANDIDATE"))})}send(e){if(!this._destroying){if(this.destroyed)throw Lr(new Error("cannot send after peer is destroyed"),"ERR_DESTROYED");this._channel.send(e)}}_needsNegotiation(){this._debug("_needsNegotiation"),this._batchedNegotiation||(this._batchedNegotiation=!0,queueMicrotask(()=>{this._batchedNegotiation=!1,this.initiator||!this._firstNegotiation?(this._debug("starting batched negotiation"),this.negotiate()):this._debug("non-initiator initial negotiation request discarded"),this._firstNegotiation=!1}))}negotiate(){if(!this._destroying){if(this.destroyed)throw Lr(new Error("cannot negotiate after peer is destroyed"),"ERR_DESTROYED");this.initiator?this._isNegotiating?(this._queuedNegotiation=!0,this._debug("already negotiating, queueing")):(this._debug("start negotiation"),setTimeout(()=>{this._createOffer()},0)):this._isNegotiating?(this._queuedNegotiation=!0,this._debug("already negotiating, queueing")):(this._debug("requesting negotiation from initiator"),this.emit("signal",{type:"renegotiate",renegotiate:!0})),this._isNegotiating=!0}}_final(e){this._readableState.ended||this.push(null),e(null)}__destroy(e){this.end(),this._destroy(()=>{},e)}_destroy(e,t){this.destroyed||this._destroying||(this._destroying=!0,this._debug("destroying (error: %s)",t&&(t.message||t)),setTimeout(()=>{if(this._connected&&this.emit("disconnect"),this._connected=!1,this._pcReady=!1,this._channelReady=!1,this._remoteTracks=null,this._remoteStreams=null,this._senderMap=null,clearInterval(this._closingInterval),this._closingInterval=null,clearInterval(this._interval),this._interval=null,this._chunk=null,this._cb=null,this._onFinishBound&&this.removeListener("finish",this._onFinishBound),this._onFinishBound=null,this._channel){try{this._channel.close()}catch{}this._channel.onmessage=null,this._channel.onopen=null,this._channel.onclose=null,this._channel.onerror=null}if(this._pc){try{this._pc.close()}catch{}this._pc.oniceconnectionstatechange=null,this._pc.onicegatheringstatechange=null,this._pc.onsignalingstatechange=null,this._pc.onicecandidate=null,this._pc.ontrack=null,this._pc.ondatachannel=null}this._pc=null,this._channel=null,t&&this.emit("error",t),e()},0))}_setupData(e){if(!e.channel)return this.__destroy(Lr(new Error("Data channel event is missing `channel` property"),"ERR_DATA_CHANNEL"));this._channel=e.channel,this._channel.binaryType="arraybuffer",typeof this._channel.bufferedAmountLowThreshold=="number"&&(this._channel.bufferedAmountLowThreshold=Bg),this.channelName=this._channel.label,this._channel.onmessage=n=>{this._onChannelMessage(n)},this._channel.onbufferedamountlow=()=>{this._onChannelBufferedAmountLow()},this._channel.onopen=()=>{this._onChannelOpen()},this._channel.onclose=()=>{this._onChannelClose()},this._channel.onerror=n=>{const s=n.error instanceof Error?n.error:new Error(`Datachannel error: ${n.message} ${n.filename}:${n.lineno}:${n.colno}`);this.__destroy(Lr(s,"ERR_DATA_CHANNEL"))};let t=!1;this._closingInterval=setInterval(()=>{this._channel&&this._channel.readyState==="closing"?(t&&this._onChannelClose(),t=!0):t=!1},5e3)}_write(e,t){if(this.destroyed)return t(Lr(new Error("cannot write after peer is destroyed"),"ERR_DATA_CHANNEL"));if(this._connected){try{this.send(e)}catch(n){return this.__destroy(Lr(n,"ERR_DATA_CHANNEL"))}this._channel.bufferedAmount>Bg?(this._debug("start backpressure: bufferedAmount %d",this._channel.bufferedAmount),this._cb=t):t(null)}else this._debug("write before connect"),this._chunk=e,this._cb=t}_onFinish(){if(this.destroyed)return;const e=()=>{setTimeout(()=>this.__destroy(),1e3)};this._connected?e():this.once("connect",e)}_startIceCompleteTimeout(){this.destroyed||this._iceCompleteTimer||(this._debug("started iceComplete timeout"),this._iceCompleteTimer=setTimeout(()=>{this._iceComplete||(this._iceComplete=!0,this._debug("iceComplete timeout completed"),this.emit("iceTimeout"),this.emit("_iceComplete"))},this.iceCompleteTimeout))}_createOffer(){this.destroyed||this._pc.createOffer(this.offerOptions).then(e=>{if(this.destroyed)return;this.trickle||this.allowHalfTrickle||(e.sdp=Ax(e.sdp)),e.sdp=this.sdpTransform(e.sdp);const t=()=>{if(this.destroyed)return;const n=this._pc.localDescription||e;this._debug("signal"),this.emit("signal",{type:n.type,sdp:n.sdp})};this._pc.setLocalDescription(e).then(()=>{this._debug("createOffer success"),this.destroyed||(this.trickle||this._iceComplete?t():this.once("_iceComplete",t))}).catch(n=>{this.__destroy(Lr(n,"ERR_SET_LOCAL_DESCRIPTION"))})}).catch(e=>{this.__destroy(Lr(e,"ERR_CREATE_OFFER"))})}_createAnswer(){this.destroyed||this._pc.createAnswer(this.answerOptions).then(e=>{if(this.destroyed)return;this.trickle||this.allowHalfTrickle||(e.sdp=Ax(e.sdp)),e.sdp=this.sdpTransform(e.sdp);const t=()=>{if(this.destroyed)return;const n=this._pc.localDescription||e;this._debug("signal"),this.emit("signal",{type:n.type,sdp:n.sdp}),this.initiator||this._requestMissingTransceivers?.()};this._pc.setLocalDescription(e).then(()=>{this.destroyed||(this.trickle||this._iceComplete?t():this.once("_iceComplete",t))}).catch(n=>{this.__destroy(Lr(n,"ERR_SET_LOCAL_DESCRIPTION"))})}).catch(e=>{this.__destroy(Lr(e,"ERR_CREATE_ANSWER"))})}_onConnectionStateChange(){this.destroyed||this._destroying||this._pc.connectionState==="failed"&&this.__destroy(Lr(new Error("Connection failed."),"ERR_CONNECTION_FAILURE"))}_onIceStateChange(){if(this.destroyed)return;const e=this._pc.iceConnectionState,t=this._pc.iceGatheringState;this._debug("iceStateChange (connection: %s) (gathering: %s)",e,t),this.emit("iceStateChange",e,t),e!=="connected"&&e!=="completed"||(this._pcReady=!0,this._maybeReady()),e==="failed"&&this.__destroy(Lr(new Error("Ice connection failed."),"ERR_ICE_CONNECTION_FAILURE")),e==="closed"&&this.__destroy(Lr(new Error("Ice connection closed."),"ERR_ICE_CONNECTION_CLOSED"))}getStats(e){const t=n=>(Object.prototype.toString.call(n.values)==="[object Array]"&&n.values.forEach(s=>{Object.assign(n,s)}),n);this._pc.getStats.length===0||this._isReactNativeWebrtc?this._pc.getStats().then(n=>{const s=[];n.forEach(a=>{s.push(t(a))}),e(null,s)},n=>e(n)):this._pc.getStats.length>0?this._pc.getStats(n=>{if(this.destroyed)return;const s=[];n.result().forEach(a=>{const l={};a.names().forEach(u=>{l[u]=a.stat(u)}),l.id=a.id,l.type=a.type,l.timestamp=a.timestamp,s.push(t(l))}),e(null,s)},n=>e(n)):e(null,[])}_maybeReady(){if(this._debug("maybeReady pc %s channel %s",this._pcReady,this._channelReady),this._connected||this._connecting||!this._pcReady||!this._channelReady)return;this._connecting=!0;const e=()=>{this.destroyed||this._destroying||this.getStats((t,n)=>{if(this.destroyed||this._destroying)return;t&&(n=[]);const s={},a={},l={};let u=!1;n.forEach(f=>{f.type!=="remotecandidate"&&f.type!=="remote-candidate"||(s[f.id]=f),f.type!=="localcandidate"&&f.type!=="local-candidate"||(a[f.id]=f),f.type!=="candidatepair"&&f.type!=="candidate-pair"||(l[f.id]=f)});const c=f=>{u=!0;let d=a[f.localCandidateId];d&&(d.ip||d.address)?(this.localAddress=d.ip||d.address,this.localPort=Number(d.port)):d&&d.ipAddress?(this.localAddress=d.ipAddress,this.localPort=Number(d.portNumber)):typeof f.googLocalAddress=="string"&&(d=f.googLocalAddress.split(":"),this.localAddress=d[0],this.localPort=Number(d[1])),this.localAddress&&(this.localFamily=this.localAddress.includes(":")?"IPv6":"IPv4");let p=s[f.remoteCandidateId];p&&(p.ip||p.address)?(this.remoteAddress=p.ip||p.address,this.remotePort=Number(p.port)):p&&p.ipAddress?(this.remoteAddress=p.ipAddress,this.remotePort=Number(p.portNumber)):typeof f.googRemoteAddress=="string"&&(p=f.googRemoteAddress.split(":"),this.remoteAddress=p[0],this.remotePort=Number(p[1])),this.remoteAddress&&(this.remoteFamily=this.remoteAddress.includes(":")?"IPv6":"IPv4"),this._debug("connect local: %s:%s remote: %s:%s",this.localAddress,this.localPort,this.remoteAddress,this.remotePort)};if(n.forEach(f=>{f.type==="transport"&&f.selectedCandidatePairId&&c(l[f.selectedCandidatePairId]),(f.type==="googCandidatePair"&&f.googActiveConnection==="true"||(f.type==="candidatepair"||f.type==="candidate-pair")&&f.selected)&&c(f)}),u||Object.keys(l).length&&!Object.keys(a).length){if(this._connecting=!1,this._connected=!0,this.emit("connect"),this._chunk){try{this.send(this._chunk)}catch(d){return this.__destroy(Lr(d,"ERR_DATA_CHANNEL"))}this._chunk=null,this._debug('sent chunk from "write before connect"');const f=this._cb;this._cb=null,f(null)}typeof this._channel.bufferedAmountLowThreshold!="number"&&(this._interval=setInterval(()=>this._onInterval(),150),this._interval.unref&&this._interval.unref()),this._debug("connect"),this.emit("connect")}else setTimeout(e,100)})};e()}_onInterval(){!this._cb||!this._channel||this._channel.bufferedAmount>Bg||this._onChannelBufferedAmountLow()}_onSignalingStateChange(){this.destroyed||(this._pc.signalingState==="stable"&&(this._isNegotiating=!1,this._debug("flushing sender queue",this._sendersAwaitingStable),this._sendersAwaitingStable.forEach(e=>{this._pc.removeTrack(e),this._queuedNegotiation=!0}),this._sendersAwaitingStable=[],this._queuedNegotiation?(this._debug("flushing negotiation queue"),this._queuedNegotiation=!1,this._needsNegotiation()):(this._debug("negotiated"),this.emit("negotiated"))),this._debug("signalingStateChange %s",this._pc.signalingState),this.emit("signalingStateChange",this._pc.signalingState))}_onIceCandidate(e){this.destroyed||(e.candidate&&this.trickle?this.emit("signal",{type:"candidate",candidate:{candidate:e.candidate.candidate,sdpMLineIndex:e.candidate.sdpMLineIndex,sdpMid:e.candidate.sdpMid}}):e.candidate||this._iceComplete||(this._iceComplete=!0,this.emit("_iceComplete")),e.candidate&&this._startIceCompleteTimeout())}_onChannelMessage(e){if(this.destroyed)return;let t=e.data;t instanceof ArrayBuffer?t=new Uint8Array(t):this.__objectMode===!1&&(t=(0,rn.L0)(t)),this.push(t)}_onChannelBufferedAmountLow(){if(this.destroyed||!this._cb)return;this._debug("ending backpressure: bufferedAmount %d",this._channel.bufferedAmount);const e=this._cb;this._cb=null,e(null)}_onChannelOpen(){this._connected||this.destroyed||(this._debug("on channel open"),this._channelReady=!0,this._maybeReady())}_onChannelClose(){this.destroyed||(this._debug("on channel close"),this.__destroy())}_debug(){const e=[].slice.call(arguments);e[0]="["+this._id+"] "+e[0],k4.apply(null,e)}};yh.WEBRTC_SUPPORT=!!v0,yh.config={iceServers:[{urls:["stun:stun.l.google.com:19302","stun:global.stun.twilio.com:3478"]}],sdpSemantics:"unified-plan"},yh.channelConfig={};const nb=yh;var nd=fn(1035),kx=fn(7541),Tx=fn(3278),x0=fn(8271),PS=fn(6686),Mx=fn(7828),Ix=fn(6889);const T4=/^\[?([^\]]+)]?:(\d+)$/;let Tu=new Map;function Mu(i){if(Tu.size===1e5&&Tu.clear(),!Tu.has(i)){const e=T4.exec(i);if(!e)throw new Error(`invalid addr: ${i}`);Tu.set(i,[e[1],Number(e[2])])}return Tu.get(i)}var rd=fn(3033),M4=fn(4497);async function*I4(i,e={}){if(i?.[Symbol.asyncIterator])return void(yield*i[Symbol.asyncIterator](e.offset));if(!i?.get)throw new Error("First argument must be an abstract-chunk-store compliant store");const t=e.chunkLength||i.chunkLength;if(!t)throw new Error("missing required `chunkLength` property");let n=e.length||i.length;if(!Number.isFinite(n))throw new Error("missing required `length` property");const s=e.offset||0,a=(c,f,d)=>new Promise((p,m)=>{i.get(c,{offset:d,length:f},(v,b)=>{v&&m(v),p(b)})});let l=Math.floor(s/t);const u=s%t;if(s){const c=Math.min(n,t-u);n-=c,yield a(l++,c,u)}for(let c=n;c>0;++l,c-=t)yield a(l,Math.min(c,t))}async function R4(i,e,t={}){if(!i?.put)throw new Error("First argument must be an abstract-chunk-store compliant store");const n=t.chunkLength||i.chunkLength;if(!n)throw new Error("missing required `chunkLength` property");const s=t.storeMaxOutstandingPuts||16;let a=0,l=0,u=()=>{},c=!1;for await(const f of NS(e,n,{zeroPadding:t.zeroPadding||!1}))await new Promise((d,p)=>{a++<=s&&d(),i.put(l++,f,m=>{if(m)return p(m);--a,d(),c&&a===0&&u()})});a!==0&&(c=new Promise(f=>{u=f}),await c)}var O4=fn(4018),Rx=fn(3970),LS=fn(3519),N4=fn(8436);const _0={DEFAULT_ANNOUNCE_PEERS:50,MAX_ANNOUNCE_PEERS:82,parseUrl:i=>{const e=new URL(i.replace(/^udp:/,"http:"));return i.match(/^udp:/)&&Object.defineProperties(e,{href:{value:e.href.replace(/^http/,"udp")},protocol:{value:e.protocol.replace(/^http/,"udp")},origin:{value:e.origin.replace(/^http/,"udp")}}),e},...fn.t(N4,2)};var Ox=fn(8529),Nx=fn(1048),Fu=fn(2701);const B4=Ss("simple-websocket"),ju=typeof Fu!="function"?WebSocket:Fu;class US extends yd.Duplex{constructor(e={}){if(typeof e=="string"&&(e={url:e}),super(e=Object.assign({allowHalfOpen:!1},e)),this.__objectMode=!!e.objectMode,e.objectMode!=null&&delete e.objectMode,e.url==null&&e.socket==null)throw new Error("Missing required `url` or `socket` option");if(e.url!=null&&e.socket!=null)throw new Error("Must specify either `url` or `socket` option, not both");if(this._id=(0,rn.V5)((0,rn.po)(4)).slice(0,7),this._debug("new websocket: %o",e),this.connected=!1,this._chunk=null,this._cb=null,this._interval=null,e.socket)this.url=e.socket.url,this._ws=e.socket,this.connected=e.socket.readyState===ju.OPEN;else{this.url=e.url;try{this._ws=typeof Fu=="function"?new ju(e.url,{...e,encoding:void 0}):new ju(e.url)}catch(t){return void Ai(()=>this.destroy(t))}}this._ws.binaryType="arraybuffer",e.socket&&this.connected?Ai(()=>this._handleOpen()):this._ws.onopen=()=>this._handleOpen(),this._ws.onmessage=t=>this._handleMessage(t),this._ws.onclose=()=>this._handleClose(),this._ws.onerror=t=>this._handleError(t),this._handleFinishBound=()=>this._handleFinish(),this.once("finish",this._handleFinishBound)}send(e){this._ws.send(e)}_final(e){this._readableState.ended||this.push(null),e(null)}_destroy(e){if(!this.destroyed){if(this._writableState.ended||this.end(),this.connected=!1,clearInterval(this._interval),this._interval=null,this._chunk=null,this._cb=null,this._handleFinishBound&&this.removeListener("finish",this._handleFinishBound),this._handleFinishBound=null,this._ws){const t=this._ws,n=()=>{t.onclose=null};if(t.readyState===ju.CLOSED)n();else try{t.onclose=n,t.close()}catch{n()}t.onopen=null,t.onmessage=null,t.onerror=()=>{}}this._ws=null,e()}}_write(e,t){if(this.destroyed)return t(new Error("cannot write after socket is destroyed"));if(this.connected){try{this.send(e)}catch(n){return this.destroy(n)}typeof Fu!="function"&&this._ws.bufferedAmount>65536?(this._debug("start backpressure: bufferedAmount %d",this._ws.bufferedAmount),this._cb=t):t(null)}else this._debug("write before connect"),this._chunk=e,this._cb=t}_handleOpen(){if(!this.connected&&!this.destroyed){if(this.connected=!0,this._chunk){try{this.send(this._chunk)}catch(t){return this.destroy(t)}this._chunk=null,this._debug('sent chunk from "write before connect"');const e=this._cb;this._cb=null,e(null)}typeof Fu!="function"&&(this._interval=setInterval(()=>this._onInterval(),150),this._interval.unref&&this._interval.unref()),this._debug("connect"),this.emit("connect")}}_handleMessage(e){if(this.destroyed)return;let t=e.data;t instanceof ArrayBuffer&&(t=new Uint8Array(t)),this.__objectMode===!1&&(t=(0,rn.L0)(t)),this.push(t)}_handleClose(){this.destroyed||(this._debug("on close"),this.destroy())}_handleError(e){this.destroy(new Error(`Error connecting to ${this.url}`))}_handleFinish(){if(this.destroyed)return;const e=()=>{setTimeout(()=>this.destroy(),1e3)};this.connected?e():this.once("connect",e)}_onInterval(){if(!this._cb||!this._ws||this._ws.bufferedAmount>65536)return;this._debug("ending backpressure: bufferedAmount %d",this._ws.bufferedAmount);const e=this._cb;this._cb=null,e(null)}_debug(){const e=[].slice.call(arguments);e[0]="["+this._id+"] "+e[0],B4.apply(null,e)}}US.WEBSOCKET_SUPPORT=!!ju;const j4=class extends No{constructor(e,t){super(),this.client=e,this.announceUrl=t,this.interval=null,this.destroyed=!1}setInterval(e){e==null&&(e=this.DEFAULT_ANNOUNCE_INTERVAL),clearInterval(this.interval),e&&(this.interval=setInterval(()=>{this.announce(this.client._defaultAnnounceOpts())},e),this.interval.unref&&this.interval.unref())}},vs=Ss("bittorrent-tracker:websocket-tracker"),vo={};class S0 extends j4{constructor(e,t){super(e,t),vs("new websocket tracker %s",t),this.peers={},this.socket=null,this.reconnecting=!1,this.retries=0,this.reconnectTimer=null,this.expectingResponse=!1,this._openSocket()}announce(e){if(this.destroyed||this.reconnecting)return;if(!this.socket.connected)return void this.socket.once("connect",()=>{this.announce(e)});const t=Object.assign({},e,{action:"announce",info_hash:this.client._infoHashBinary,peer_id:this.client._peerIdBinary});if(this._trackerId&&(t.trackerid=this._trackerId),e.event==="stopped"||e.event==="completed")this._send(t);else{const n=Math.min(e.numwant,5);this._generateOffers(n,s=>{t.numwant=n,t.offers=s,this._send(t)})}}scrape(e){if(this.destroyed||this.reconnecting)return;if(!this.socket.connected)return void this.socket.once("connect",()=>{this.scrape(e)});const t={action:"scrape",info_hash:Array.isArray(e.infoHash)&&e.infoHash.length>0?e.infoHash.map(n=>(0,rn.Ht)(n)):e.infoHash&&(0,rn.Ht)(e.infoHash)||this.client._infoHashBinary};this._send(t)}destroy(e=Bx){if(this.destroyed)return e(null);this.destroyed=!0,clearInterval(this.interval),clearTimeout(this.reconnectTimer);for(const a in this.peers){const l=this.peers[a];clearTimeout(l.trackerTimeout),l.destroy()}if(this.peers=null,this.socket&&(this.socket.removeListener("connect",this._onSocketConnectBound),this.socket.removeListener("data",this._onSocketDataBound),this.socket.removeListener("close",this._onSocketCloseBound),this.socket.removeListener("error",this._onSocketErrorBound),this.socket=null),this._onSocketConnectBound=null,this._onSocketErrorBound=null,this._onSocketDataBound=null,this._onSocketCloseBound=null,vo[this.announceUrl]&&(vo[this.announceUrl].consumers-=1),vo[this.announceUrl].consumers>0)return e();let t,n=vo[this.announceUrl];if(delete vo[this.announceUrl],n.on("error",Bx),n.once("close",e),!this.expectingResponse)return s();function s(){t&&(clearTimeout(t),t=null),n.removeListener("data",s),n.destroy(),n=null}t=setTimeout(s,_0.DESTROY_TIMEOUT),n.once("data",s)}_openSocket(){if(this.destroyed=!1,this.peers||(this.peers={}),this._onSocketConnectBound=()=>{this._onSocketConnect()},this._onSocketErrorBound=e=>{this._onSocketError(e)},this._onSocketDataBound=e=>{this._onSocketData(e)},this._onSocketCloseBound=()=>{this._onSocketClose()},this.socket=vo[this.announceUrl],this.socket)vo[this.announceUrl].consumers+=1,this.socket.connected&&this._onSocketConnectBound();else{const e=new URL(this.announceUrl);let t;this.client._proxyOpts&&(t=e.protocol==="wss:"?this.client._proxyOpts.httpsAgent:this.client._proxyOpts.httpAgent,!t&&this.client._proxyOpts.socksProxy&&(t=this.client._proxyOpts.socksProxy)),this.socket=vo[this.announceUrl]=new US({url:this.announceUrl,agent:t}),this.socket.consumers=1,this.socket.once("connect",this._onSocketConnectBound)}this.socket.on("data",this._onSocketDataBound),this.socket.once("close",this._onSocketCloseBound),this.socket.once("error",this._onSocketErrorBound)}_onSocketConnect(){this.destroyed||this.reconnecting&&(this.reconnecting=!1,this.retries=0,this.announce(this.client._defaultAnnounceOpts()))}_onSocketData(e){if(!this.destroyed){this.expectingResponse=!1;try{e=JSON.parse((0,rn.dU)(e))}catch{return void this.client.emit("warning",new Error("Invalid tracker response"))}e.action==="announce"?this._onAnnounceResponse(e):e.action==="scrape"?this._onScrapeResponse(e):this._onSocketError(new Error(`invalid action in WS response: ${e.action}`))}}_onAnnounceResponse(e){if(e.info_hash!==this.client._infoHashBinary)return void vs("ignoring websocket data from %s for %s (looking for %s: reused socket)",this.announceUrl,(0,rn.HB)(e.info_hash),this.client.infoHash);if(e.peer_id&&e.peer_id===this.client._peerIdBinary)return;vs("received %s from %s for %s",JSON.stringify(e),this.announceUrl,this.client.infoHash);const t=e["failure reason"];if(t)return this.client.emit("warning",new Error(t));const n=e["warning message"];n&&this.client.emit("warning",new Error(n));const s=e.interval||e["min interval"];s&&this.setInterval(1e3*s);const a=e["tracker id"];if(a&&(this._trackerId=a),e.complete!=null){const u=Object.assign({},e,{announce:this.announceUrl,infoHash:(0,rn.HB)(e.info_hash)});this.client.emit("update",u)}let l;if(e.offer&&e.peer_id&&(vs("creating peer (from remote offer)"),l=this._createPeer(),l.id=(0,rn.HB)(e.peer_id),l.once("signal",u=>{const c={action:"announce",info_hash:this.client._infoHashBinary,peer_id:this.client._peerIdBinary,to_peer_id:e.peer_id,answer:u,offer_id:e.offer_id};this._trackerId&&(c.trackerid=this._trackerId),this._send(c)}),this.client.emit("peer",l),l.signal(e.offer)),e.answer&&e.peer_id){const u=(0,rn.HB)(e.offer_id);l=this.peers[u],l?(l.id=(0,rn.HB)(e.peer_id),this.client.emit("peer",l),l.signal(e.answer),clearTimeout(l.trackerTimeout),l.trackerTimeout=null,delete this.peers[u]):vs(`got unexpected answer: ${JSON.stringify(e.answer)}`)}}_onScrapeResponse(e){e=e.files||{};const t=Object.keys(e);t.length!==0?t.forEach(n=>{const s=Object.assign(e[n],{announce:this.announceUrl,infoHash:(0,rn.HB)(n)});this.client.emit("scrape",s)}):this.client.emit("warning",new Error("invalid scrape response"))}_onSocketClose(){this.destroyed||(this.destroy(),this._startReconnectTimer())}_onSocketError(e){this.destroyed||(this.destroy(),this.client.emit("warning",e),this._startReconnectTimer())}_startReconnectTimer(){const e=Math.floor(3e5*Math.random())+Math.min(1e4*Math.pow(2,this.retries),36e5);this.reconnecting=!0,clearTimeout(this.reconnectTimer),this.reconnectTimer=setTimeout(()=>{this.retries++,this._openSocket()},e),this.reconnectTimer.unref&&this.reconnectTimer.unref(),vs("reconnecting socket in %s ms",e)}_send(e){if(this.destroyed)return;this.expectingResponse=!0;const t=JSON.stringify(e);vs("send %s",t),this.socket.send(t)}_generateOffers(e,t){const n=this,s=[];vs("generating %s offers",e);for(let u=0;u<e;++u)a();function a(){const u=(0,rn.V5)((0,rn.po)(20));vs("creating peer (from _generateOffers)");const c=n.peers[u]=n._createPeer({initiator:!0});c.once("signal",f=>{s.push({offer:f,offer_id:(0,rn.Ht)(u)}),l()}),c.trackerTimeout=setTimeout(()=>{vs("tracker timeout: destroying peer"),c.trackerTimeout=null,delete n.peers[u],c.destroy()},5e4),c.trackerTimeout.unref&&c.trackerTimeout.unref()}function l(){s.length===e&&(vs("generated %s offers",e),t(s))}l()}_createPeer(e){const t=this;e=Object.assign({trickle:!1,config:t.client._rtcConfig,wrtc:t.client._wrtc},e);const n=new nb(e);return n.once("error",s),n.once("connect",function a(){n.removeListener("error",s),n.removeListener("connect",a)}),n;function s(a){t.client.emit("warning",new Error(`Connection error: ${a.message}`)),n.destroy()}}}function Bx(){}S0.prototype.DEFAULT_ANNOUNCE_INTERVAL=3e4,S0._socketPool=vo;const D4=S0;var P4=fn(717);const Ea=Ss("bittorrent-tracker:client");let E0=class extends No{constructor(e={}){if(super(),!e.peerId)throw new Error("Option `peerId` is required");if(!e.infoHash)throw new Error("Option `infoHash` is required");if(!e.announce)throw new Error("Option `announce` is required");if(!P4.browser&&!e.port)throw new Error("Option `port` is required");this.peerId=typeof e.peerId=="string"?e.peerId:(0,rn.V5)(e.peerId),this._peerIdBuffer=(0,rn.fk)(this.peerId),this._peerIdBinary=(0,rn.Ht)(this.peerId),this.infoHash=typeof e.infoHash=="string"?e.infoHash.toLowerCase():(0,rn.V5)(e.infoHash),this._infoHashBuffer=(0,rn.fk)(this.infoHash),this._infoHashBinary=(0,rn.Ht)(this.infoHash),Ea("new client %s",this.infoHash),this.destroyed=!1,this._port=e.port,this._getAnnounceOpts=e.getAnnounceOpts,this._rtcConfig=e.rtcConfig,this._userAgent=e.userAgent,this._proxyOpts=e.proxyOpts,this._wrtc=typeof e.wrtc=="function"?e.wrtc():e.wrtc;let t=typeof e.announce=="string"?[e.announce]:e.announce==null?[]:e.announce;t=t.map(a=>(ArrayBuffer.isView(a)&&(a=(0,rn.dU)(a)),a[a.length-1]==="/"&&(a=a.substring(0,a.length-1)),a)),t=Array.from(new Set(t));const n=this._wrtc!==!1&&(!!this._wrtc||nb.WEBRTC_SUPPORT),s=a=>{Ai(()=>{this.emit("warning",a)})};this._trackers=t.map(a=>{let l;try{l=_0.parseUrl(a)}catch{return s(new Error(`Invalid tracker URL: ${a}`)),null}const u=l.port;if(u<0||u>65535)return s(new Error(`Invalid tracker port: ${a}`)),null;const c=l.protocol;return c!=="http:"&&c!=="https:"||typeof Ox!="function"?c==="udp:"&&typeof Nx=="function"?new Nx(this,a):c!=="ws:"&&c!=="wss:"||!n||c==="ws:"&&typeof window<"u"&&window.location.protocol==="https:"?(s(new Error(`Unsupported tracker protocol: ${a}`)),null):new D4(this,a):new Ox(this,a)}).filter(Boolean)}start(e){(e=this._defaultAnnounceOpts(e)).event="started",Ea("send `start` %o",e),this._announce(e),this._trackers.forEach(t=>{t.setInterval()})}stop(e){(e=this._defaultAnnounceOpts(e)).event="stopped",Ea("send `stop` %o",e),this._announce(e)}complete(e){e||(e={}),(e=this._defaultAnnounceOpts(e)).event="completed",Ea("send `complete` %o",e),this._announce(e)}update(e){(e=this._defaultAnnounceOpts(e)).event&&delete e.event,Ea("send `update` %o",e),this._announce(e)}_announce(e){this._trackers.forEach(t=>{t.announce(e)})}scrape(e){Ea("send `scrape`"),e||(e={}),this._trackers.forEach(t=>{t.scrape(e)})}setInterval(e){Ea("setInterval %d",e),this._trackers.forEach(t=>{t.setInterval(e)})}destroy(e){if(this.destroyed)return;this.destroyed=!0,Ea("destroy");const t=this._trackers.map(n=>s=>{n.destroy(s)});Pa(t,e),this._trackers=[],this._getAnnounceOpts=null}_defaultAnnounceOpts(e={}){return e.numwant==null&&(e.numwant=_0.DEFAULT_ANNOUNCE_PEERS),e.uploaded==null&&(e.uploaded=0),e.downloaded==null&&(e.downloaded=0),this._getAnnounceOpts&&(e=Object.assign({},e,this._getAnnounceOpts())),e}};E0.scrape=(i,e)=>{if(e=LS(e),!i.infoHash)throw new Error("Option `infoHash` is required");if(!i.announce)throw new Error("Option `announce` is required");const t=Object.assign({},i,{infoHash:Array.isArray(i.infoHash)?i.infoHash[0]:i.infoHash,peerId:(0,rn.L0)("01234567890123456789"),port:6881}),n=new E0(t);n.once("error",e),n.once("warning",e);let s=Array.isArray(i.infoHash)?i.infoHash.length:1;const a={};return n.on("scrape",l=>{if(s-=1,a[l.infoHash]=l,s===0){n.destroy();const u=Object.keys(a);u.length===1?e(null,a[u[0]]):e(null,a)}}),n.scrape({infoHash:i.infoHash}),n};const L4=E0;var jx=fn(2799),U4=fn(717);const Dx=Ss("torrent-discovery");let q4=class extends No.EventEmitter{constructor(e){if(super(),!e.peerId)throw new Error("Option `peerId` is required");if(!e.infoHash)throw new Error("Option `infoHash` is required");if(!U4.browser&&!e.port)throw new Error("Option `port` is required");this.peerId=typeof e.peerId=="string"?e.peerId:e.peerId.toString("hex"),this.infoHash=typeof e.infoHash=="string"?e.infoHash.toLowerCase():e.infoHash.toString("hex"),this._port=e.port,this._userAgent=e.userAgent,this.destroyed=!1,this._announce=e.announce||[],this._intervalMs=e.intervalMs||9e5,this._trackerOpts=null,this._dhtAnnouncing=!1,this._dhtTimeout=!1,this._internalDHT=!1,this._onWarning=n=>{this.emit("warning",n)},this._onError=n=>{this.emit("error",n)},this._onDHTPeer=(n,s)=>{s.toString("hex")===this.infoHash&&this.emit("peer",`${n.host}:${n.port}`,"dht")},this._onTrackerPeer=n=>{this.emit("peer",n,"tracker")},this._onTrackerAnnounce=()=>{this.emit("trackerAnnounce")},this._onLSDPeer=(n,s)=>{this.emit("peer",n,"lsd")};const t=(n,s)=>{const a=new Rx.Client(s);return a.on("warning",this._onWarning),a.on("error",this._onError),a.listen(n),this._internalDHT=!0,a};e.tracker===!1?this.tracker=null:e.tracker&&typeof e.tracker=="object"?(this._trackerOpts=Object.assign({},e.tracker),this.tracker=this._createTracker()):this.tracker=this._createTracker(),e.dht===!1||typeof Rx.Client!="function"?this.dht=null:e.dht&&typeof e.dht.addNode=="function"?this.dht=e.dht:e.dht&&typeof e.dht=="object"?this.dht=t(e.dhtPort,e.dht):this.dht=t(e.dhtPort),this.dht&&(this.dht.on("peer",this._onDHTPeer),this._dhtAnnounce()),e.lsd===!1||typeof jx!="function"?this.lsd=null:this.lsd=this._createLSD()}updatePort(e){e!==this._port&&(this._port=e,this.dht&&this._dhtAnnounce(),this.tracker&&(this.tracker.stop(),this.tracker.destroy(()=>{this.tracker=this._createTracker()})))}complete(e){this.tracker&&this.tracker.complete(e)}destroy(e){if(this.destroyed)return;this.destroyed=!0,clearTimeout(this._dhtTimeout);const t=[];this.tracker&&(this.tracker.stop(),this.tracker.removeListener("warning",this._onWarning),this.tracker.removeListener("error",this._onError),this.tracker.removeListener("peer",this._onTrackerPeer),this.tracker.removeListener("update",this._onTrackerAnnounce),t.push(n=>{this.tracker.destroy(n)})),this.dht&&this.dht.removeListener("peer",this._onDHTPeer),this._internalDHT&&(this.dht.removeListener("warning",this._onWarning),this.dht.removeListener("error",this._onError),t.push(n=>{this.dht.destroy(n)})),this.lsd&&(this.lsd.removeListener("warning",this._onWarning),this.lsd.removeListener("error",this._onError),this.lsd.removeListener("peer",this._onLSDPeer),t.push(n=>{this.lsd.destroy(n)})),Pa(t,e),this.dht=null,this.tracker=null,this.lsd=null,this._announce=null}_createTracker(){const e=Object.assign({},this._trackerOpts,{infoHash:this.infoHash,announce:this._announce,peerId:this.peerId,port:this._port,userAgent:this._userAgent}),t=new L4(e);return t.on("warning",this._onWarning),t.on("error",this._onError),t.on("peer",this._onTrackerPeer),t.on("update",this._onTrackerAnnounce),t.setInterval(this._intervalMs),t.start(),t}_dhtAnnounce(){this._dhtAnnouncing||(Dx("dht announce"),this._dhtAnnouncing=!0,clearTimeout(this._dhtTimeout),this.dht.announce(this.infoHash,this._port,e=>{this._dhtAnnouncing=!1,Dx("dht announce complete"),e&&this.emit("warning",e),this.emit("dhtAnnounce"),this.destroyed||(this._dhtTimeout=setTimeout(()=>{this._dhtAnnounce()},this._intervalMs+Math.floor(Math.random()*this._intervalMs/5)),this._dhtTimeout.unref&&this._dhtTimeout.unref())}))}_createLSD(){const e=Object.assign({},{infoHash:this.infoHash,peerId:this.peerId,port:this._port}),t=new jx(e);return t.on("warning",this._onWarning),t.on("error",this._onError),t.on("peer",this._onLSDPeer),t.start(),t}};const F4=q4,H4=["seeking position failed.","InvalidStateError"],z4=["A requested file or directory could not be found at the time an operation was processed.","NotFoundError"],jg=i=>[`Failed to execute 'write' on 'UnderlyingSinkBase': Invalid params passed. ${i}`,"SyntaxError"];let eh=class extends WritableStream{constructor(e){super(e),Object.setPrototypeOf(this,FileSystemWritableFileStream.prototype),this._closed=!1}async close(){this._closed=!0;const e=this.getWriter(),t=e.close();return e.releaseLock(),t}seek(e){return this.write({type:"seek",position:e})}truncate(e){return this.write({type:"truncate",size:e})}write(e){if(this._closed)return Promise.reject(new TypeError("Cannot write to a CLOSED writable stream"));const t=this.getWriter(),n=t.write(e);return t.releaseLock(),n}};if(Object.defineProperty(eh.prototype,Symbol.toStringTag,{value:"FileSystemWritableFileStream",writable:!1,enumerable:!1,configurable:!0}),Object.defineProperties(eh.prototype,{close:{enumerable:!0},seek:{enumerable:!0},truncate:{enumerable:!0},write:{enumerable:!0}}),!globalThis.FileSystemFileHandle||globalThis.FileSystemFileHandle.prototype.createWritable||globalThis.FileSystemWritableFileStream||(globalThis.FileSystemWritableFileStream=eh),globalThis.FileSystemFileHandle&&!globalThis.FileSystemFileHandle.prototype.createWritable){const i=new WeakMap;let e;const t=()=>{let s,a;onmessage=async l=>{const u=l.ports[0],c=l.data;switch(c.type){case"open":{const f=c.name;let d=await navigator.storage.getDirectory();for(const p of c.path)d=await d.getDirectoryHandle(p);s=await d.getFileHandle(f),a=await s.createSyncAccessHandle();break}case"write":a.write(c.data,{at:c.position}),a.flush();break;case"truncate":a.truncate(c.size);break;case"abort":case"close":a.close()}u.postMessage(0)}};globalThis.FileSystemFileHandle.prototype.createWritable=async function(s){if(!e){const v=`(${t.toString()})()`,b=new Blob([v],{type:"text/javascript"});e=URL.createObjectURL(b)}const a=new Worker(e,{type:"module"});let l=0;const u=new TextEncoder;let c=await this.getFile().then(v=>v.size);const f=v=>new Promise((b,y)=>{const w=new MessageChannel;w.port1.onmessage=C=>{C.data instanceof Error?y(C.data):b(C.data),w.port1.close(),w.port2.close(),w.port1.onmessage=null},a.postMessage(v,[w.port2])}),d=await navigator.storage.getDirectory(),p=await i.get(this),m=await d.resolve(p);if(m===null)throw new DOMException(...z4);return await f({type:"open",path:m,name:this.name}),s?.keepExistingData===!1&&(await f({type:"truncate",size:0}),c=0),new eh({async write(v){if((v=v?.constructor===Object?{...v}:{type:"write",data:v,position:l}).type==="write"){if(!("data"in v))throw await f({type:"close"}),new DOMException(...jg("write requires a data argument"));if(v.position??=l,typeof v.data=="string")v.data=u.encode(v.data);else if(v.data instanceof ArrayBuffer)v.data=new Uint8Array(v.data);else if(v.data instanceof Uint8Array||!ArrayBuffer.isView(v.data)){if(!(v.data instanceof Uint8Array)){const b=await new Response(v.data).arrayBuffer();v.data=new Uint8Array(b)}}else v.data=new Uint8Array(v.data.buffer,v.data.byteOffset,v.data.byteLength);Number.isInteger(v.position)&&v.position>=0&&(l=v.position),l+=v.data.byteLength,c+=v.data.byteLength}else{if(v.type==="seek"){if(Number.isInteger(v.position)&&v.position>=0){if(c<v.position)throw new DOMException(...H4);return void(l=v.position)}throw await f({type:"close"}),new DOMException(...jg("seek requires a position argument"))}if(v.type==="truncate"){if(!(Number.isInteger(v.size)&&v.size>=0))throw await f({type:"close"}),new DOMException(...jg("truncate requires a size argument"));c=v.size,l>c&&(l=c)}}await f(v)},async close(){await f({type:"close"}),a.terminate()},async abort(v){await f({type:"abort",reason:v}),a.terminate()}})};const n=FileSystemDirectoryHandle.prototype.getFileHandle;FileSystemDirectoryHandle.prototype.getFileHandle=async function(...s){const a=await n.call(this,...s);return i.set(a,this),a}}const G4=/[<>:"/\\|?*\u0000-\u001F]/g;globalThis.navigator?.storage?.getDirectory&&navigator.storage.getDirectory().then(i=>{i.removeEntry("chunks",{recursive:!0}).catch(()=>{})});const Iu=(i,e)=>{};let qS=class{name="";chunks=[];chunkMap=[];directoryMap={};files;rootDirPromise;storageDirPromise;chunksDirPromise;closing=!1;closed=!1;constructor(e,t={}){if(this.chunkLength=Number(e),!this.chunkLength)throw new Error("First argument must be a chunk length");if(!globalThis.navigator?.storage?.getDirectory)throw new Error("FSA API is not supported");if(this.closed=!1,this.name=t.name||crypto.randomUUID(),this.rootDirPromise=t.rootDir||navigator.storage.getDirectory(),this.storageDirPromise=(async()=>(await this.rootDirPromise).getDirectoryHandle(this.name,{create:!0}))(),this.chunksDirPromise=this.storageDirPromise,t.files&&t.rootDir){if(this.chunksDirPromise=this._getChunksDirHandle(),this.files=t.files.map((n,s,a)=>{if(n.path==null)throw new Error("File is missing `path` property");if(n.length==null)throw new Error("File is missing `length` property");if(n.offset==null)if(s===0)n.offset=0;else{const d=a[s-1];n.offset=d.offset+d.length}n.handle==null&&(n.handle=this._createFileHandle({path:n.path})),n.blob=this._createBlobReference(n.handle);const l=n.offset,u=n.offset+n.length,c=Math.floor(l/this.chunkLength),f=Math.floor((u-1)/this.chunkLength);for(let d=c;d<=f;++d){const p=d*this.chunkLength,m=l<p?0:l-p,v=u>p+this.chunkLength?this.chunkLength:u-p,b=l>p?0:p-l;this.chunkMap[d]||(this.chunkMap[d]=[]),this.chunkMap[d].push({from:m,to:v,offset:b,file:n})}return n}),window.addEventListener("pagehide",()=>this.cleanup()),this.length=this.files.reduce((n,s)=>n+s.length,0),t.length!=null&&t.length!==this.length)throw new Error("total `files` length is not equal to explicit `length` option")}else this.length=Number(t.length)||1/0;this.length!==1/0&&(this.lastChunkLength=this.length%this.chunkLength||this.chunkLength,this.lastChunkIndex=Math.ceil(this.length/this.chunkLength)-1)}async _getChunkHandle(e){let t=this.chunks[e];if(!t){const n=await this.chunksDirPromise;this.chunks[e]=t=await n.getFileHandle(e,{create:!0})}return t}async _createFileHandle(e){const t=e.path.slice(e.path.lastIndexOf("/")+1);return(await this._getDirectoryHandle(e)).getFileHandle(t.replace(G4,""),{create:!0})}async _createBlobReference(e){return(await e).getFile()}async _getDirectoryHandle(e){const t=e.path.lastIndexOf("/");if(t===-1||t===0)return this.storageDirPromise;const n=e.path=e.path.slice(0,t);return this.directoryMap[n]||(this.directoryMap[n]=(async()=>(await this._getDirectoryHandle(e)).getDirectoryHandle(n.slice(n.lastIndexOf("/")+1),{create:!0}))()),this.directoryMap[n]}async _getChunksDirHandle(){return(await(await navigator.storage.getDirectory()).getDirectoryHandle("chunks",{create:!0})).getDirectoryHandle(this.name,{create:!0})}async put(e,t,n=Iu){try{return await this._put(e,t),n(null),null}catch(s){return queueMicrotask(()=>n(s)),s}}async getStreamForHandle(e){return(await e).createWritable({keepExistingData:!0})}async _put(e,t){if(this.closed)throw new Error("Storage is closed");const n=e===this.lastChunkIndex;if(n&&t.length!==this.lastChunkLength)throw new Error(`Last chunk length must be ${this.lastChunkLength}`);if(!n&&t.length!==this.chunkLength)throw new Error(`Chunk length must be ${this.chunkLength}`);const s=(async()=>{const u=await this._getChunkHandle(e),c=await u.createWritable({keepExistingData:!1});await c.write(t),await c.close()})();if(!this.files)return s;const a=this.chunkMap[e];if(!a)throw new Error("No files matching the request range");const l=a.map(async({file:u,offset:c,from:f,to:d})=>{u.stream||(u.stream=this.getStreamForHandle(u.handle)),await(await u.stream).write({type:"write",position:c,data:t.slice(f,d)})});l.push(s),await Promise.all(l)}async get(e,t,n=Iu){t==null&&(t={});try{const s=await this._get(e,t);return n(null,s),s}catch(s){return n(s),s}}async _get(e,t){if(typeof t=="function")return this.get(e,void 0,t);if(this.closed)throw new Error("Storage is closed");const n=e===this.lastChunkIndex?this.lastChunkLength:this.chunkLength,s=t.offset||0,a=t.length?s+t.length:n,l=t.length||n-s;if(s<0||s<0||a>n)throw new Error("Invalid offset and/or length");if(s===a)return new Uint8Array(0);if(!this.files||this.chunks[e]){let m=await(await this._getChunkHandle(e)).getFile();s===0&&l===n||(m=m.slice(s,l+s));const v=await m.arrayBuffer();if(v.byteLength===0)throw new Error(`Index ${e} does not exist`);return new Uint8Array(v)}let u=this.chunkMap[e];if(!u)throw new Error("No files matching the request range");if(t&&(u=u.filter(({from:p,to:m})=>m>s&&p<a),u.length===0))throw new Error("No files matching the request range");const c=u.map(async({from:p,to:m,offset:v,file:b})=>(t&&(m>a&&(m=a),p<s&&(v+=s-p,p=s)),(await b.blob).slice(v,v+m-p))),f=await Promise.all(c),d=f.length===1?await f[0].arrayBuffer():await new Blob(f).arrayBuffer();if(d.byteLength===0)throw new Error(`Index ${e} does not exist`);return new Uint8Array(d)}async close(e=Iu){if(this.closing)return((t=Iu,n)=>queueMicrotask(()=>t(new Error(n))))(e,"Storage is closed");this.closing=!0,this.chunkMap=void 0,this.directoryMap=void 0,this.files&&await this.cleanup(),this.closed=!0,queueMicrotask(()=>e(null))}async cleanup(){if(this.closed||!this.files)return;const e=[];for(const n of this.files)n.stream&&(e.push(n.stream.then(s=>s.close())),n.stream=void 0);const t=(async()=>{const n=await this.chunksDirPromise;this.chunks=[];for await(const s of n.keys())await n.removeEntry(s,{recursive:!0});this.chunksDirPromise=this._getChunksDirHandle(),await this.chunksDirPromise})();await Promise.all(e);for(const n of this.files)n.blob=this._createBlobReference(n.handle);await t}async destroy(e=Iu){this.close(async t=>{if(t)return e(t);try{await(await this.rootDirPromise).removeEntry(this.name,{recursive:!0})}catch(n){return e(n)}e(null)})}};var K4=fn(3714),V4=fn(1314);const Px=Ss("lt_donthave"),FS=()=>{class i extends No.EventEmitter{constructor(t){super(),this._peerSupports=!1,this._wire=t}onExtendedHandshake(){this._peerSupports=!0}onMessage(t){let n;try{n=new DataView(t.buffer).getUint32(0)}catch{return}this._wire.peerPieces.get(n)&&(Px("got donthave %d",n),this._wire.peerPieces.set(n,!1),this.emit("donthave",n),this._failRequests(n))}donthave(t){if(!this._peerSupports)return;Px("donthave %d",t);const n=new Uint8Array(4);new DataView(n.buffer).setUint32(0,t),this._wire.extended("lt_donthave",n)}_failRequests(t){const n=this._wire.requests;for(let s=0;s<n.length;s++){const a=n[s];a.piece===t&&(V4(n,s),s-=1,this._wire._callback(a,new Error("peer sent donthave"),null))}}}return i.prototype.name="lt_donthave",i};var HS=fn(4862),Lx=fn(5372);const qs=16384;class So{constructor(e){this.length=e,this.missing=e,this.sources=null,this._chunks=Math.ceil(e/qs),this._remainder=e%qs||qs,this._buffered=0,this._buffer=null,this._cancellations=null,this._reservations=0,this._flushed=!1}chunkLength(e){return e===this._chunks-1?this._remainder:qs}chunkLengthRemaining(e){return this.length-e*qs}chunkOffset(e){return e*qs}reserve(){return this.init()?this._cancellations.length?this._cancellations.pop():this._reservations<this._chunks?this._reservations++:-1:-1}reserveRemaining(){if(!this.init())return-1;if(this._cancellations.length||this._reservations<this._chunks){let e=this._reservations;for(;this._cancellations.length;)e=Math.min(e,this._cancellations.pop());return this._reservations=this._chunks,e}return-1}cancel(e){this.init()&&this._cancellations.push(e)}cancelRemaining(e){this.init()&&(this._reservations=e)}get(e){return this.init()?this._buffer[e]:null}set(e,t,n){if(!this.init())return!1;const s=t.length,a=Math.ceil(s/qs);for(let l=0;l<a;l++)if(!this._buffer[e+l]){const u=l*qs,c=t.subarray(u,u+qs);this._buffered++,this._buffer[e+l]=c,this.missing-=c.length,this.sources.includes(n)||this.sources.push(n)}return this._buffered===this._chunks}flush(){if(!this._buffer||this._chunks!==this._buffered)return null;const e=(0,rn.xW)(this._buffer,this.length);return this._buffer=null,this._cancellations=null,this.sources=null,this._flushed=!0,e}init(){return!this._flushed&&(this._buffer||(this._buffer=new Array(this._chunks),this._cancellations=[],this.sources=[]),!0)}}So.BLOCK_LENGTH=qs;var $4=fn(7373);const Y4=Ss("ut_metadata"),Ru=16384,W4=i=>{class e extends No.EventEmitter{constructor(n){super(),this._wire=n,this._fetching=!1,this._metadataComplete=!1,this._metadataSize=null,this._remainingRejects=null,this._bitfield=new rd.A(0,{grow:1e3}),ArrayBuffer.isView(i)&&this.setMetadata(i)}onHandshake(n,s,a){this._infoHash=n}onExtendedHandshake(n){return n.m&&n.m.ut_metadata?n.metadata_size?typeof n.metadata_size!="number"||1e7<n.metadata_size||n.metadata_size<=0?this.emit("warning",new Error("Peer gave invalid metadata size")):(this._metadataSize=n.metadata_size,this._numPieces=Math.ceil(this._metadataSize/Ru),this._remainingRejects=2*this._numPieces,void this._requestPieces()):this.emit("warning",new Error("Peer does not have metadata")):this.emit("warning",new Error("Peer does not support ut_metadata"))}onMessage(n){let s,a;try{const l=(0,rn.dU)(n),u=l.indexOf("ee")+2;s=Fs.A.decode(l.substring(0,u)),a=n.slice(u)}catch{return}switch(s.msg_type){case 0:this._onRequest(s.piece);break;case 1:this._onData(s.piece,a,s.total_size);break;case 2:this._onReject(s.piece)}}fetch(){this._metadataComplete||(this._fetching=!0,this._metadataSize&&this._requestPieces())}cancel(){this._fetching=!1}async setMetadata(n){if(this._metadataComplete)return!0;Y4("set metadata");try{const s=Fs.A.decode(n).info;s&&(n=Fs.A.encode(s))}catch{}return(!this._infoHash||this._infoHash===await(0,rn.tW)(n,"hex"))&&(this.cancel(),this.metadata=n,this._metadataComplete=!0,this._metadataSize=this.metadata.length,this._wire.extendedHandshake.metadata_size=this._metadataSize,this.emit("metadata",Fs.A.encode({info:Fs.A.decode(this.metadata)})),!0)}_send(n,s){let a=Fs.A.encode(n);ArrayBuffer.isView(s)&&(a=(0,rn.xW)([a,s])),this._wire.extended("ut_metadata",a)}_request(n){this._send({msg_type:0,piece:n})}_data(n,s,a){const l={msg_type:1,piece:n};typeof a=="number"&&(l.total_size=a),this._send(l,s)}_reject(n){this._send({msg_type:2,piece:n})}_onRequest(n){if(!this._metadataComplete)return void this._reject(n);const s=n*Ru;let a=s+Ru;a>this._metadataSize&&(a=this._metadataSize);const l=this.metadata.slice(s,a);this._data(n,l,this._metadataSize)}_onData(n,s,a){s.length>Ru||!this._fetching||(this.metadata.set(s,n*Ru),this._bitfield.set(n),this._checkDone())}_onReject(n){this._remainingRejects>0&&this._fetching?(this._request(n),this._remainingRejects-=1):this.emit("warning",new Error('Peer sent "reject" too much'))}_requestPieces(){if(this._fetching){this.metadata=new Uint8Array(this._metadataSize);for(let n=0;n<this._numPieces;n++)this._request(n)}}async _checkDone(){let n=!0;for(let s=0;s<this._numPieces;s++)if(!this._bitfield.get(s)){n=!1;break}n&&(await this.setMetadata(this.metadata)||this._failedMetadata())}_failedMetadata(){this._bitfield=new rd.A(0,{grow:1e3}),this._remainingRejects-=this._numPieces,this._remainingRejects>0?this._requestPieces():this.emit("warning",new Error("Peer sent invalid metadata"))}}return e.prototype.name="ut_metadata",e};var Dg=fn(8878),Q4=fn(1133);const J4=Ss("webtorrent:file-iterator");class Z4 extends No{constructor(e,{start:t,end:n}){super(),this._torrent=e._torrent,this._pieceLength=e._torrent.pieceLength,this._startPiece=(t+e.offset)/this._pieceLength|0,this._endPiece=(n+e.offset)/this._pieceLength|0,this._piece=this._startPiece,this._offset=t+e.offset-this._startPiece*this._pieceLength,this._missing=n-t+1,this._criticalLength=Math.min(1048576/this._pieceLength|0,2),this._torrent._select(this._startPiece,this._endPiece,1,null,!0),this.destroyed=!1}[Symbol.asyncIterator](){return this}next(){return new Promise((e,t)=>{if(this._missing===0||this.destroyed)return e({done:!0}),this.destroy();const n=(a,l)=>{if(!this._torrent.bitfield.get(a)){const u=c=>{(c===a||this.destroyed)&&(this._torrent.removeListener("verified",u),c===a?n(a,l):e({done:!0}))};return this._torrent.on("verified",u),this._torrent.critical(a,a+this._criticalLength)}if(this.destroyed)return e({done:!0});this._torrent.store.get(a,l,(u,c)=>this.destroyed?e({done:!0}):(J4("read %s and yielding (length %s) (err %s)",a,c?.length,u?.message),u?(this.destroy(void 0,u),e({done:!0})):void e({value:c,done:!1})))},s=Math.min(this._missing,this._pieceLength-this._offset);n(this._piece++,{length:s,offset:this._offset}),this._missing-=s,this._offset=0})}async return(){return this.destroy(),{done:!0,value:void 0}}async throw(e){throw e}destroy(e=n=>{},t){this.destroyed||(this.destroyed=!0,this._torrent.destroyed||this._torrent._deselect(this._startPiece,this._endPiece,!0),this.emit("return"),e(t))}}class Ux extends No{constructor(e,t){super(),this._torrent=e,this._destroyed=!1,this._fileStreams=new Set,this._iterators=new Set,this.name=t.name,this.path=t.path,this.length=t.length,this.size=t.length,this.type=Q4.getType(this.name)||"application/octet-stream",this.offset=t.offset,this.done=!1;const n=t.offset,s=n+t.length-1;this._startPiece=n/this._torrent.pieceLength|0,this._endPiece=s/this._torrent.pieceLength|0,this.length===0&&(this.done=!0,this.emit("done")),this._client=e.client}get downloaded(){if(this._destroyed||!this._torrent.bitfield)return 0;const{pieces:e,bitfield:t,pieceLength:n,lastPieceLength:s}=this._torrent,{_startPiece:a,_endPiece:l}=this,u=d=>d===e.length-1?s:n,c=d=>{const p=d===e.length-1?s:n;return t.get(d)?p:p-e[d].missing};let f=0;for(let d=a;d<=l;d+=1){const p=c(d);if(f+=p,d===a){const m=this.offset%n;f-=Math.min(m,p)}if(d===l){const m=u(l)-(this.offset+this.length)%n;f-=Math.min(m,p)}}return f}get progress(){return this.length?this.downloaded/this.length:0}select(e){this.length!==0&&this._torrent.select(this._startPiece,this._endPiece,e)}deselect(){this.length!==0&&this._torrent.deselect(this._startPiece,this._endPiece)}[Symbol.asyncIterator](e={}){if(this.length===0||this._destroyed)return(async function*(){})();const{start:t=0}=e??{},n=e?.end&&e.end<this.length?e.end:this.length-1;if(this.done)return I4(this._torrent.store,{offset:t+this.offset,length:n-t+1});const s=new Z4(this,{start:t,end:n});return this._iterators.add(s),s.once("return",()=>{this._iterators.delete(s)}),s}createReadStream(e){if(this._destroyed)throw new Error("File is destroyed");const t=this[Symbol.asyncIterator](e),n=yd.Readable.from(t);return this._fileStreams.add(n),n.once("close",()=>{this._fileStreams.delete(n)}),n}async arrayBuffer(e={}){if(this._destroyed)throw new Error("File is destroyed");const{start:t=0}=e,n=e?.end&&e.end<this.length?e.end:this.length-1,s=new Uint8Array(n-t+1);let a=0;for await(const l of this[Symbol.asyncIterator]({start:t,end:n}))s.set(l,a),a+=l.length;return s.buffer}async blob(e){if(this._destroyed)throw new Error("File is destroyed");return new Blob([await this.arrayBuffer(e)],{type:this.type})}stream(e){if(this._destroyed)throw new Error("File is destroyed");let t;return new ReadableStream({start:()=>{t=this[Symbol.asyncIterator](e)},async pull(n){const{value:s,done:a}=await t.next();a?n.close():n.enqueue(s)},cancel(){t.return()}})}get streamURL(){if(!this._client._server)throw new Error("No server created");return`${this._client._server.pathname}/${this._torrent.infoHash}/${this.path}`}streamTo(e){return e.src=this.streamURL,e}includes(e){return this._startPiece<=e&&this._endPiece>=e}_destroy(){this._destroyed=!0,this._torrent=null;for(const e of this._fileStreams)e.destroy();this._fileStreams.clear();for(const e of this._iterators)e.destroy();this._iterators.clear()}}var ws=fn(5658);class X4{constructor(e){this._torrent=e,this._numPieces=e.pieces.length,this._pieces=new Array(this._numPieces),this._onWire=t=>{this.recalculate(),this._initWire(t)},this._onWireHave=t=>{this._pieces[t]+=1},this._onWireBitfield=()=>{this.recalculate()},this._torrent.wires.forEach(t=>{this._initWire(t)}),this._torrent.on("wire",this._onWire),this.recalculate()}getRarestPiece(e){let t=[],n=1/0;for(let s=0;s<this._numPieces;++s){if(e&&!e(s))continue;const a=this._pieces[s];a===n?t.push(s):a<n&&(t=[s],n=a)}return t.length?t[Math.random()*t.length|0]:-1}destroy(){this._torrent.removeListener("wire",this._onWire),this._torrent.wires.forEach(e=>{this._cleanupWireEvents(e)}),this._torrent=null,this._pieces=null,this._onWire=null,this._onWireHave=null,this._onWireBitfield=null}_initWire(e){e._onClose=()=>{this._cleanupWireEvents(e);for(let t=0;t<this._numPieces;++t)this._pieces[t]-=e.peerPieces.get(t)},e.on("have",this._onWireHave),e.on("bitfield",this._onWireBitfield),e.once("close",e._onClose)}recalculate(){this._pieces.fill(0);for(const e of this._torrent.wires)for(let t=0;t<this._numPieces;++t)this._pieces[t]+=e.peerPieces.get(t)}_cleanupWireEvents(e){e.removeListener("have",this._onWireHave),e.removeListener("bitfield",this._onWireBitfield),e._onClose&&e.removeListener("close",e._onClose),e._onClose=null}}var e6=fn(4343),t6=fn(6458),Qu=fn(6819);const mo=Ss("webtorrent:webconn");class n6 extends t6.A{constructor(e,t){super(),this.url=e,this.connId=e,this._torrent=t,this._init(e)}_init(e){this.setKeepAlive(!0),this.use(FS()),this.once("handshake",async(t,n)=>{const s=await(0,rn.tW)(e,"hex");if(this.destroyed)return;this.handshake(t,s);const a=this._torrent.pieces.length,l=new rd.A(a);for(let u=0;u<=a;u++)l.set(u,!0);this.bitfield(l)}),this.once("interested",()=>{mo("interested"),this.unchoke()}),this.on("uninterested",()=>{mo("uninterested")}),this.on("choke",()=>{mo("choke")}),this.on("unchoke",()=>{mo("unchoke")}),this.on("bitfield",()=>{mo("bitfield")}),this.lt_donthave.on("donthave",()=>{mo("donthave")}),this.on("request",(t,n,s,a)=>{mo("request pieceIndex=%d offset=%d length=%d",t,n,s),this.httpRequest(t,n,s,(l,u)=>{if(l){this.lt_donthave.donthave(t);const c=setTimeout(()=>{this.destroyed||this.have(t)},1e4);c.unref&&c.unref()}a(l,u)})})}async httpRequest(e,t,n,s){s=LS(s);const a=e*this._torrent.pieceLength+t,l=a+n-1,u=this._torrent.files;let c,f;if(u.length<=1)c=[{url:this.url,start:a,end:l}];else{const d=u.filter(p=>p.offset<=l&&p.offset+p.length>a);if(d.length<1)return s(new Error("Could not find file corresponding to web seed range request"));c=d.map(p=>{const m=p.offset+p.length-1;return{url:this.url+(this.url[this.url.length-1]==="/"?"":"/")+p.path.replace(this._torrent.path,""),fileOffsetInRange:Math.max(p.offset-a,0),start:Math.max(a-p.offset,0),end:Math.min(m,l-p.offset)}})}try{f=await Promise.all(c.map(async({start:d,end:p,url:m})=>{mo("Requesting url=%s pieceIndex=%d offset=%d length=%d start=%d end=%d",m,e,t,n,d,p);const v=await tb(m,{cache:"no-store",method:"GET",headers:{"Cache-Control":"no-store","user-agent":`WebTorrent/${Qu} (https://webtorrent.io)`,range:`bytes=${d}-${p}`},signal:AbortSignal.timeout(6e4)});if(!v.ok)throw new Error(`Unexpected HTTP status code ${v.status}`);const b=new Uint8Array(await v.arrayBuffer());return mo("Got data of length %d",b.length),b}))}catch(d){return s(d)}s(null,(0,rn.xW)(f))}destroy(){super.destroy(),this._torrent=null}}class r6{_items=[];remove(e){for(let t=0;t<this._items.length;t++){const n=this._items[t];if(!n.isStreamSelection==!e.isStreamSelection)if(n.isStreamSelection){if(n.from===e.from&&n.to===e.to){this._items.splice(t,1);break}}else if(qx(e,n))n.to=Math.max(e.from-1,0);else if(Fx(e,n))n.from=e.to+1;else if(Hx(e,n)){const s=[],a={...n,to:Math.max(e.from-1,0)};a.to-a.from>=0&&e.from!==0&&s.push(a);const l={...n,from:e.to+1};l.to-l.from>=0&&s.push(l),this._items.splice(t,1,...s),t=t-1+s.length}else zx(e,n)&&(this._items.splice(t,1),t--)}}_mergePriorityAndNotify(e,t){if((t.priority??0)>(e.priority??0)&&(e.priority=t.priority),e.notify&&t.notify){const n=e.notify;e.notify=()=>{n(),t.notify?.()}}else e.notify=t.notify||e.notify}concatenate(e){for(let t=0;t<this._items.length;t++){const n=this._items[t];if(!n.isStreamSelection){if(qx(e,n))e.from=n.from;else if(Fx(e,n))e.to=n.to;else{if(!Hx(e,n)){if(zx(e,n))continue;continue}e.from=n.from,e.to=n.to}this._mergePriorityAndNotify(e,n)}}this.remove(e)}insert(e){if(e.from>e.to)throw new Error("Invalid interval");e.isStreamSelection||this.concatenate(e),this._items.push(e)}sort(e=(t,n)=>t.from-n.from){this._items.sort(e)}get length(){return this._items.length}get(e){return this._items[e]}swap(e,t){const n=this._items[e];this._items[e]=this._items[t],this._items[t]=n}clear(){this._items.length=0}*[Symbol.iterator](){for(let e=0;e<this._items.length;e++){const t=this._items[e];t.remove=()=>{this._items.splice(e,1),e--},yield t,delete t.remove}}}function qx(i,e){return i.from<=e.to+1&&i.from>e.from&&i.to>e.to}function Fx(i,e){return i.to>=e.from-1&&i.to<e.to&&i.from<e.from}function Hx(i,e){const t=e.to-e.from,n=i.to-i.from;return i.from>=e.from&&i.to<=e.to&&n<t}function zx(i,e){return i.from<=e.from&&i.to>=e.to}var zS=fn(717);const i6=Ss("webtorrent:torrent"),Pg=5e3,Lg=3*So.BLOCK_LENGTH,Gx=zS.browser?O4().length:2,Ug=[1e3,5e3,15e3],Kx=`WebTorrent/${Qu} (https://webtorrent.io)`,s6=globalThis.navigator?.storage?.getDirectory&&globalThis.FileSystemFileHandle?.prototype?.createWritable,o6=!zS.browser||s6?qS:HS;let C0;try{C0=Ku(PS.statSync("/tmp")&&"/tmp","webtorrent")}catch{C0=Ku(typeof Ix.tmpdir=="function"?Ix.tmpdir():"/","webtorrent")}const Vx=typeof window<"u"&&typeof window.requestIdleCallback=="function"&&window.requestIdleCallback;class $x extends No{constructor(e,t,n){super(),this._debugId="unknown infohash",this.client=t,this.announce=n.announce,this.urlList=n.urlList,this.path=n.path||C0,this.addUID=n.addUID||!1,this.rootDir=n.rootDir||null,this.skipVerify=!!n.skipVerify,this._startupBitfield=n.bitfield,this._store=n.store||o6,this._preloadedStore=n.preloadedStore||null,this._storeCacheSlots=n.storeCacheSlots!==void 0?n.storeCacheSlots:20,this._destroyStoreOnDestroy=n.destroyStoreOnDestroy||!1,this.store=null,this.storeOpts=n.storeOpts,this.alwaysChokeSeeders=n.alwaysChokeSeeders??!0,this._getAnnounceOpts=n.getAnnounceOpts,typeof n.private=="boolean"&&(this.private=n.private),this.strategy=n.strategy||"sequential",this.maxWebConns=n.maxWebConns||4,this._rechokeNumSlots=n.uploads===!1||n.uploads===0?0:+n.uploads||10,this._rechokeOptimisticWire=null,this._rechokeOptimisticTime=0,this._rechokeIntervalId=null,this._noPeersIntervalId=null,this._noPeersIntervalTime=n.noPeersIntervalTime?1e3*n.noPeersIntervalTime:3e4,this._startAsDeselected=n.deselect||!1,this.ready=!1,this.destroyed=!1,this.paused=n.paused||!1,this.done=!1,this.metadata=null,this.files=[],this.pieces=[],this._amInterested=!1,this._selections=new r6,this._critical=[],this.wires=[],this._queue=[],this._peers=new Map,this._peersLength=0,this.received=0,this.uploaded=0,this._downloadSpeed=nd(),this._uploadSpeed=nd(),this._servers=[],this._xsRequests=[],this._fileModtimes=n.fileModtimes,e!==null&&this._onTorrentId(e),this._debug("new torrent")}get timeRemaining(){return this.done?0:this.downloadSpeed===0?1/0:(this.length-this.downloaded)/this.downloadSpeed*1e3}get downloaded(){if(!this.bitfield)return 0;let e=0;for(let t=0,n=this.pieces.length;t<n;++t)if(this.bitfield.get(t))e+=t===n-1?this.lastPieceLength:this.pieceLength;else{const s=this.pieces[t];e+=s.length-s.missing}return e}get downloadSpeed(){return this._downloadSpeed()}get uploadSpeed(){return this._uploadSpeed()}get progress(){return this.length?this.downloaded/this.length:0}get ratio(){return this.uploaded/(this.received||this.length)}get numPeers(){return this.wires.length}get torrentFileBlob(){return this.torrentFile?new Blob([this.torrentFile],{type:"application/x-bittorrent"}):null}get _numQueued(){return this._queue.length+(this._peersLength-this._numConns)}_numConns=0;async _onTorrentId(e){if(this.destroyed)return;let t;try{t=await mh(e)}catch{}t?(this.infoHash=t.infoHash,this._debugId=(0,rn.V5)(t.infoHash).substring(0,7),Ai(()=>{this.destroyed||this._onParsedTorrent(t)})):DS(e,(n,s)=>{if(!this.destroyed)return n?this._destroy(n):void this._onParsedTorrent(s)})}_onParsedTorrent(e){if(!this.destroyed){if(this._processParsedTorrent(e),!this.infoHash)return this._destroy(new Error("Malformed torrent data: No info hash"));this._rechokeIntervalId=setInterval(()=>{this._rechoke()},1e4),this._rechokeIntervalId.unref&&this._rechokeIntervalId.unref(),this.emit("_infoHash",this.infoHash),this.destroyed||(this.emit("infoHash",this.infoHash),this.destroyed||(this.client.listening?this._onListening():this.client.once("listening",()=>{this._onListening()})))}}_processParsedTorrent(e){this._debugId=(0,rn.V5)(e.infoHash).substring(0,7),this.private!==void 0&&(e.private=this.private),Array.isArray(this.announce)&&(e.announce=e.announce.concat(this.announce)),this.client.tracker&&Array.isArray(this.client.tracker.announce)&&!e.private&&(e.announce=e.announce.concat(this.client.tracker.announce)),this.client.tracker&&globalThis.WEBTORRENT_ANNOUNCE&&!e.private&&(e.announce=e.announce.concat(globalThis.WEBTORRENT_ANNOUNCE)),this.urlList&&(e.urlList=e.urlList.concat(this.urlList)),e.announce=Array.from(new Set(e.announce)),e.urlList=Array.from(new Set(e.urlList)),Object.assign(this,e),this.magnetURI=E4(e),this.torrentFile=(function(t){const n={info:t.info};return n["announce-list"]=(t.announce||[]).map(s=>(n.announce||(n.announce=s),[s=(0,rn.L0)(s)])),n["url-list"]=t.urlList||[],t.private!==void 0&&(n.private=Number(t.private)),t.created&&(n["creation date"]=t.created.getTime()/1e3|0),t.createdBy&&(n["created by"]=t.createdBy),t.comment&&(n.comment=t.comment),Fs.A.encode(n)})(e)}_onListening(){this.destroyed||(this.info?this._onMetadata(this):(this.xs&&this._getMetadataFromServer(),this._startDiscovery()))}_startDiscovery(){if(this.discovery||this.destroyed)return;let e=this.client.tracker;e&&(e=Object.assign({},this.client.tracker,{getAnnounceOpts:()=>{if(this.destroyed)return;const t={uploaded:this.uploaded,downloaded:this.downloaded,left:Math.max(this.length-this.downloaded,0)};return this.client.tracker.getAnnounceOpts&&Object.assign(t,this.client.tracker.getAnnounceOpts()),this._getAnnounceOpts&&Object.assign(t,this._getAnnounceOpts()),t}})),this.peerAddresses&&this.peerAddresses.forEach(t=>this.addPeer(t,ws.A.SOURCE_MANUAL)),this.discovery=new F4({infoHash:this.infoHash,announce:this.announce,peerId:this.client.peerId,dht:!this.private&&this.client.dht,tracker:e,port:this.client.torrentPort,userAgent:Kx,lsd:this.client.lsd}),this.discovery.on("error",t=>{this._destroy(t)}),this.discovery.on("peer",(t,n)=>{this._debug("peer %s discovered via %s",t,n),this.client.seedOutgoingConnections||!this.done?this.addPeer(t,n):this._debug("discovery ignoring peer %s: torrent is done and seedOutgoingConnections is false",t)}),this.discovery.on("trackerAnnounce",()=>{this.emit("trackerAnnounce")}),this.discovery.on("dhtAnnounce",()=>{this.emit("dhtAnnounce")}),this.discovery.on("warning",t=>{this.emit("warning",t)}),this._noPeersIntervalId=setInterval(()=>{if(this.destroyed)return;const t={[ws.A.SOURCE_TRACKER]:{enabled:!!this.client.tracker,numPeers:0},[ws.A.SOURCE_DHT]:{enabled:!!this.client.dht,numPeers:0},[ws.A.SOURCE_LSD]:{enabled:!!this.client.lsd,numPeers:0},[ws.A.SOURCE_UT_PEX]:{enabled:this.client.utPex&&typeof Dg=="function",numPeers:0}};for(const n of this._peers.values()){const s=t[n.source];s!==void 0&&s.numPeers++}for(const n of Object.keys(t)){const s=t[n];s.enabled&&s.numPeers===0&&this.emit("noPeers",n)}},this._noPeersIntervalTime),this._noPeersIntervalId.unref&&this._noPeersIntervalId.unref()}_getMetadataFromServer(){const e=this,t=Array.isArray(this.xs)?this.xs:[this.xs];e._xsRequestsController=new AbortController;const n=e._xsRequestsController.signal,s=t.map(a=>l=>{(async function(u,c){if(u.indexOf("http://")!==0&&u.indexOf("https://")!==0)return e.emit("warning",new Error(`skipping non-http xs param: ${u}`)),c(null);const f={method:"GET",headers:{"user-agent":Kx},signal:n};let d,p,m;try{d=await tb(u,f)}catch{return e.emit("warning",new Error(`http error from xs param: ${u}`)),c(null)}if(e.destroyed||e.metadata)return c(null);if(d.status!==200)return e.emit("warning",new Error(`non-200 status code ${d.status} from xs param: ${u}`)),c(null);try{p=new Uint8Array(await d.arrayBuffer())}catch(v){return e.emit("warning",v),c(null)}try{m=await mh(p)}catch{}if(!m)return e.emit("warning",new Error(`got invalid torrent file from xs param: ${u}`)),c(null);if(m.infoHash!==e.infoHash)return e.emit("warning",new Error(`got torrent file with incorrect info hash from xs param: ${u}`)),c(null);e._onMetadata(m),c(null)})(a,l)});Pa(s)}async _onMetadata(e){if(this.metadata||this.destroyed)return;let t;if(this._debug("got metadata"),this._xsRequestsController?.abort(),this._xsRequestsController=null,e&&e.infoHash)t=e;else try{t=await mh(e)}catch(s){return this._destroy(s)}this._processParsedTorrent(t),this.metadata=this.torrentFile,this.client.enableWebSeeds&&this.urlList.forEach(s=>{this.addWebSeed(s)}),this._rarityMap=new X4(this),this.files=this.files.map(s=>new Ux(this,s));let n=this._preloadedStore;if(n||(n=new this._store(this.pieceLength,{...this.storeOpts,torrent:this,path:this.path,files:this.files,length:this.length,name:this.name+" - "+this.infoHash.slice(0,8),addUID:this.addUID,rootDir:this.rootDir,max:this._storeCacheSlots})),this._storeCacheSlots>0&&!(n instanceof HS)&&(n=new M4(n,{max:this._storeCacheSlots})),this.store=new K4(n),this.so&&!this._startAsDeselected?this.files.forEach((s,a)=>{this.so.includes(a)&&this.files[a].select()}):this.pieces.length===0||this._startAsDeselected||this.select(0,this.pieces.length-1),this._hashes=this.pieces,this._hasStartupBitfield=this._startupBitfield&&this._startupBitfield.length===Math.ceil(this.pieces.length/8)&&!this.skipVerify,this.bitfield=new rd.A(this._hasStartupBitfield?new Uint8Array(this._startupBitfield):this.pieces.length),this._reservations=this._hasStartupBitfield?this.pieces.map((s,a)=>this.bitfield.get(a)?null:[]):this.pieces.map(()=>[]),this.pieces=this.pieces.map((s,a)=>{if(this._hasStartupBitfield&&this.bitfield.get(a))return null;const l=a===this.pieces.length-1?this.lastPieceLength:this.pieceLength;return new So(l)}),this.emit("metadata"),!this.destroyed)if(this.skipVerify)this._markAllVerified(),this._onStore();else{const s=a=>{if(a)return this._destroy(a);this._debug("done verifying"),this._onStore()};this._debug("verifying existing torrent data"),this._fileModtimes&&this._store===qS?this.getFileModtimes((a,l)=>{if(a)return this._destroy(a);this.files.map((u,c)=>l[c]===this._fileModtimes[c]).every(u=>u)?(this._markAllVerified(),this._onStore()):this._verifyPieces(s)}):this._verifyPieces(s)}}getFileModtimes(e){const t=[];Lx(this.files.map((n,s)=>a=>{const l=this.addUID?Ku(this.name+" - "+this.infoHash.slice(0,8)):Ku(this.path,n.path);PS.stat(l,(u,c)=>{if(u&&u.code!=="ENOENT")return a(u);t[s]=c&&c.mtime.getTime(),a(null)})}),Gx,n=>{this._debug("done getting file modtimes"),e(n,t)})}_verifyPiece(e,t){if(this.destroyed)return t(new Error("torrent is destroyed"));const n={};e===this.pieces.length-1&&(n.length=this.lastPieceLength),this.store.get(e,n,async(s,a)=>{if(this.destroyed)return t(new Error("torrent is destroyed"));if(s)return Ai(()=>t(null,!1));const l=await(0,rn.tW)(a,"hex");if(this.destroyed)return t(new Error("torrent is destroyed"));t(null,l===this._hashes[e])})}_verifyPiecesUsingBitfield(e){const t=new Set,n=new Map;for(const s of this.files){let a=2,l=null;for(let u=s._startPiece;u<=s._endPiece;++u)this.bitfield.get(u)&&(a&&(l=u,a--),n.has(u)||n.set(u,[]),n.get(u).push(s));l!==null&&t.add(l)}this._verifyPiecesUsingHash([...t],s=>{if(s)return e(s);const a=new Set;for(const l of t)if(!this.bitfield.get(l)){const u=n.get(l);for(const c of u)a.add(c)}if(a.size){const l=[];for(const u of a)for(let c=u._startPiece;c<=u._endPiece;++c)l.indexOf(c)===-1&&l.push(c);return this._verifyPiecesUsingHash(l,e)}e(null)})}_verifyPiecesUsingHash(e,t){Lx(e.map((n,s)=>a=>{const l=Number.isInteger(n)?n:s;this._verifyPiece(l,(u,c)=>{if(u)return a(u);c?(this._debug("piece verified %s",l),this._markVerified(l)):(this._markUnverified(l),this._debug("piece invalid %s",l)),a(null)})}),Gx,t)}_verifyPieces(e){if(this._hasStartupBitfield)return this._verifyPiecesUsingBitfield(e);this._verifyPiecesUsingHash(this.pieces,e)}rescanFiles(e){if(this.destroyed)throw new Error("torrent is destroyed");e||(e=Yx),this._verifyPiecesUsingHash(this.pieces,t=>{if(t)return this._destroy(t),e(t);this._checkDone(),e(null)})}_markAllVerified(){for(let e=0;e<this.pieces.length;e++)this._markVerified(e)}_markVerified(e){this.pieces[e]=null,this._reservations[e]=null,this.bitfield.set(e,!0),this.emit("verified",e)}_markUnverified(e){const t=e===this.pieces.length-1?this.lastPieceLength:this.pieceLength;this.pieces[e]=new So(t),this.bitfield.set(e,!1),this._startAsDeselected||this.select(e,e);for(const n of this.files)n.done&&n.includes(e)&&(n.done=!1)}_hasAllPieces(){for(let e=0;e<this.pieces.length;e++)if(!this.bitfield.get(e))return!1;return!0}_hasNoPieces(){return!this._hasMorePieces(0)}_hasMorePieces(e){let t=0;for(let n=0;n<this.pieces.length;n++)if(this.bitfield.get(n)&&(t+=1,t>e))return!0;return!1}_onStore(){this.destroyed||(this._debug("on store"),this._startDiscovery(),this.ready=!0,this.emit("ready"),this._checkDone(),this._updateSelections(),this.wires.forEach(e=>{e.ut_metadata&&e.ut_metadata.setMetadata(this.metadata),this._onWireWithMetadata(e)}))}destroy(e,t){if(typeof e=="function")return this.destroy(null,e);this._destroy(null,e,t)}_destroy(e,t,n){if(typeof t=="function")return this._destroy(e,null,t);if(this.destroyed)return;this.destroyed=!0,this._debug("destroy"),this.client._remove(this),this._selections.clear(),clearInterval(this._rechokeIntervalId),clearInterval(this._noPeersIntervalId),this._xsRequestsController?.abort(),this._rarityMap&&this._rarityMap.destroy();for(const a of this._peers.keys())this.removePeer(a);for(const a of this.files)a instanceof Ux&&a._destroy();const s=this._servers.map(a=>l=>{a.destroy(l)});if(this.discovery&&s.push(a=>{this.discovery.destroy(a)}),this.store){let a=this._destroyStoreOnDestroy;t&&t.destroyStore!==void 0&&(a=t.destroyStore),s.push(l=>{a?this.store.destroy(l):this.store.close(l)})}Pa(s,n),e&&(this.listenerCount("error")===0?this.client.emit("error",e):this.emit("error",e)),this.emit("close"),this.client=null,this.files=[],this.discovery=null,this.store=null,this._rarityMap=null,this._peers.clear(),this._peers=null,this._servers=null,this._xsRequests=null,this._queue=null}addPeer(e,t){if(this.destroyed)throw new Error("torrent is destroyed");if(!this.infoHash)throw new Error("addPeer() must not be called before the `infoHash` event");let n;if(typeof e=="string"){let l;try{l=Mu(e)}catch{return this._debug("ignoring peer: invalid %s",e),this.emit("invalidPeer",e),!1}n=l[0]}else typeof e.remoteAddress=="string"&&(n=e.remoteAddress);if(this.client.blocked&&n&&this.client.blocked.contains(n))return this._debug("ignoring peer: blocked %s",e),typeof e!="string"&&e.destroy(),this.emit("blockedPeer",e),!1;const s=this.client.utp&&this._isIPv4(n)?"utp":"tcp",a=!!this._addPeer(e,s,t);return a?this.emit("peer",e):this.emit("invalidPeer",e),a}_addPeer(e,t,n){if(this.destroyed)return typeof e!="string"&&e.destroy(),null;if(typeof e=="string"&&!this._validAddr(e))return this._debug("ignoring peer: invalid %s",e),null;const s=e&&e.id||e;if(this._peers.has(s))return this._debug("ignoring peer: duplicate (%s)",s),typeof e!="string"&&e.destroy(),null;if(this.paused)return this._debug("ignoring peer: torrent is paused"),typeof e!="string"&&e.destroy(),null;let a;return this._debug("add peer %s",s),a=typeof e=="string"?t==="utp"?ws.A.createUTPOutgoingPeer(e,this,this.client.throttleGroups,n):ws.A.createTCPOutgoingPeer(e,this,this.client.throttleGroups,n):ws.A.createWebRTCPeer(e,this,this.client.throttleGroups,n),this._registerPeer(a),typeof e=="string"&&(this._queue.push(a),this._drain()),a}addWebSeed(e){if(this.destroyed)throw new Error("torrent is destroyed");let t,n;if(typeof e=="string"){if(t=e,!/^https?:\/\/.+/.test(t))return this.emit("warning",new Error(`ignoring invalid web seed: ${t}`)),void this.emit("invalidPeer",t);if(this._peers.has(t))return this.emit("warning",new Error(`ignoring duplicate web seed: ${t}`)),void this.emit("invalidPeer",t);n=new n6(t,this)}else{if(!e||typeof e.connId!="string")return void this.emit("warning",new Error("addWebSeed must be passed a string or connection object with id property"));if(n=e,t=n.connId,this._peers.has(t))return this.emit("warning",new Error(`ignoring duplicate web seed: ${t}`)),void this.emit("invalidPeer",t)}this._debug("add web seed %s",t);const s=ws.A.createWebSeedPeer(n,t,this,this.client.throttleGroups);this._registerPeer(s),this.emit("peer",t)}_addIncomingPeer(e){return this.destroyed?e.destroy(new Error("torrent is destroyed")):this.paused?e.destroy(new Error("torrent is paused")):(this._debug("add incoming peer %s",e.id),void this._registerPeer(e))}_registerPeer(e){e.on("download",t=>{this.destroyed||(this.received+=t,this._downloadSpeed(t),this.client._downloadSpeed(t),this.emit("download",t),this.destroyed||this.client.emit("download",t))}),e.on("upload",t=>{this.destroyed||(this.uploaded+=t,this._uploadSpeed(t),this.client._uploadSpeed(t),this.emit("upload",t),this.destroyed||this.client.emit("upload",t))}),e.connected?this._numConns+=1:e.once("connect",()=>{this.destroyed||(this._numConns+=1)}),e.once("disconnect",()=>{this._numConns-=1}),this._peers.set(e.id,e),this._peersLength+=1}removePeer(e){const t=e?.id||e;e&&!e.id&&(e=this._peers?.get(t)),e&&(e.destroy(),this.destroyed||(this._debug("removePeer %s",t),this._peers.delete(t),this._peersLength-=1,this._drain()))}_select(e=0,t=this.pieces.length-1,n,s,a=!1){if(this.destroyed)throw new Error("torrent is destroyed");if(e<0||t<e||this.pieces.length<=t)throw new Error(`invalid selection ${e} : ${t}`);n=Number(n)||0,this._debug("select %s-%s (priority %s)",e,t,n),this._selections.insert({from:e,to:t,offset:0,priority:n,notify:s,isStreamSelection:a}),this._selections.sort((l,u)=>u.priority-l.priority),this._updateSelections()}select(e,t,n,s){this._select(e,t,n,s,!1)}_deselect(e,t,n=!1){if(this.destroyed)throw new Error("torrent is destroyed");this._debug("deselect %s-%s",e,t),this._selections.remove({from:e,to:t,isStreamSelection:n}),this._updateSelections()}deselect(e,t){this._deselect(e,t,!1)}critical(e,t){if(this.destroyed)throw new Error("torrent is destroyed");this._debug("critical %s-%s",e,t);for(let n=e;n<=t;++n)this._critical[n]=!0;this._updateSelections()}_onWire(e,t){if(this._debug("got wire %s (%s)",e._debugId,t||"Unknown"),this.wires.push(e),t){const n=Mu(t);e.remoteAddress=n[0],e.remotePort=n[1]}this.client.dht&&this.client.dht.listening&&e.on("port",n=>{if(!this.destroyed&&!this.client.dht.destroyed){if(!e.remoteAddress)return this._debug("ignoring PORT from peer with no address");if(n===0||n>65536)return this._debug("ignoring invalid PORT from peer");this._debug("port: %s (from %s)",n,t),this.client.dht.addNode({host:e.remoteAddress,port:n})}}),e.on("timeout",()=>{this._debug("wire timeout (%s)",t),e.destroy()}),e.type!=="webSeed"&&e.setTimeout(3e4,!0),e.setKeepAlive(!0),e.use(W4(this.metadata)),e.ut_metadata.on("warning",n=>{this._debug("ut_metadata warning: %s",n.message)}),this.metadata||(e.ut_metadata.on("metadata",n=>{this._debug("got metadata via ut_metadata"),this._onMetadata(n)}),e.ut_metadata.fetch()),this.client.utPex&&typeof Dg=="function"&&!this.private&&(e.use(Dg()),e.ut_pex.on("peer",n=>{this.client.seedOutgoingConnections||!this.done?(this._debug("ut_pex: got peer: %s (from %s)",n,t),this.addPeer(n,ws.A.SOURCE_UT_PEX)):this._debug("ut_pex ignoring peer %s: torrent is done and seedOutgoingConnections is false",n)}),e.ut_pex.on("dropped",n=>{const s=this._peers.get(n);s&&!s.connected&&(this._debug("ut_pex: dropped peer: %s (from %s)",n,t),this.removePeer(n))}),e.once("close",()=>{e.ut_pex.reset()})),e.use(FS()),this.emit("wire",e,t),this.ready&&Ai(()=>{this._onWireWithMetadata(e)})}_onWireWithMetadata(e){let t=null;const n=()=>{this.destroyed||e.destroyed||(this._numQueued>2*(this._numConns-this.numPeers)&&e.amInterested?e.destroy():(t=setTimeout(n,Pg),t.unref&&t.unref()))};let s;const a=()=>{if(e.peerPieces.buffer.length&&e.peerPieces.setAll){if(e.peerPieces.buffer.length!==this.bitfield.buffer.length)return;for(s=0;s<this.pieces.length;++s)if(!e.peerPieces.get(s))return}e.isSeeder=!0,this.alwaysChokeSeeders&&e.choke()};e.on("bitfield",()=>{a(),this._update(),this._updateWireInterest(e)}),e.on("have",()=>{a(),this._update(),this._updateWireInterest(e)}),e.lt_donthave.on("donthave",()=>{a(),this._update(),this._updateWireInterest(e)}),e.on("have-all",()=>{e.isSeeder=!0,this.alwaysChokeSeeders&&e.choke(),this._update(),this._updateWireInterest(e)}),e.on("have-none",()=>{e.isSeeder=!1,this._update(),this._updateWireInterest(e)}),e.on("allowed-fast",l=>{this._update()}),e.once("interested",()=>{e.unchoke()}),e.once("close",()=>{clearTimeout(t)}),e.on("choke",()=>{clearTimeout(t),t=setTimeout(n,Pg),t.unref&&t.unref()}),e.on("unchoke",()=>{clearTimeout(t),this._update()}),e.on("request",(l,u,c,f)=>{if(c>131072)return e.destroy();this.pieces[l]||this.store.get(l,{offset:u,length:c},f)}),e.hasFast&&this._hasAllPieces()?e.haveAll():e.hasFast&&this._hasNoPieces()?e.haveNone():e.bitfield(this.bitfield),this._updateWireInterest(e),e.peerExtensions.dht&&this.client.dht&&this.client.dht.listening&&e.port(this.client.dht.address().port),e.type!=="webSeed"&&(t=setTimeout(n,Pg),t.unref&&t.unref()),e.isSeeder=!1,a()}_updateSelections(){this.ready&&!this.destroyed&&(Ai(()=>{this._gcSelections()}),this._updateInterest(),this._update())}_gcSelections(){for(const e of this._selections){const t=e.offset;for(;this.bitfield.get(e.from+e.offset)&&e.from+e.offset<e.to;)e.offset+=1;t!==e.offset&&e.notify?.(),e.to===e.from+e.offset&&this.bitfield.get(e.from+e.offset)&&(e.remove(),e.notify?.(),this._updateInterest())}this._selections.length||this.emit("idle")}_updateInterest(){const e=this._amInterested;this._amInterested=!!this._selections.length,this.wires.forEach(t=>this._updateWireInterest(t)),e!==this._amInterested&&(this._amInterested?this.emit("interested"):this.emit("uninterested"))}_updateWireInterest(e){let t=!1;for(let n=0;n<this.pieces.length;++n)if(this.pieces[n]&&e.peerPieces.get(n)){t=!0;break}t?e.interested():e.uninterested()}_update(){Vx?Vx(()=>this._updateWireWrapper(),{timeout:250}):this._updateWireWrapper()}_updateWireWrapper(){if(this.destroyed)return;const e=$4(this.wires);let t;for(;t=e();)this._updateWire(t)}_updateWire(e){if(e.destroyed)return!1;const t=this,n=qg(e,.5);if(e.requests.length>=n)return;const s=qg(e,1);if(e.peerChoking)e.hasFast&&e.peerAllowedFastSet.length>0&&!this._hasMorePieces(e.peerAllowedFastSet.length-1)&&(function(){if(e.requests.length>=s)return!1;for(const c of e.peerAllowedFastSet){if(e.peerPieces.get(c)&&!t.bitfield.get(c))for(;t._request(e,c,!1)&&e.requests.length<s;);if(!(e.requests.length<s))return!0}})();else{if(!e.downloaded)return(function(){if(e.requests.length)return;let c=t._selections.length;for(;c--;){const f=t._selections.get(c);let d;if(t.strategy==="rarest"){const p=f.from+f.offset,m=f.to,v=m-p+1,b={};let y=0;const w=a(p,m,b);for(;y<v&&(d=t._rarityMap.getRarestPiece(w),!(d<0));){if(t._request(e,d,!1))return;b[d]=!0,y+=1}}else for(d=f.to;d>=f.from+f.offset;--d)if(e.peerPieces.get(d)&&t._request(e,d,!1))return}})();u(!1)||u(!0)}function a(c,f,d,p){return m=>m>=c&&m<=f&&!(m in d)&&e.peerPieces.get(m)&&(!p||p(m))}function l(c){let f=c;for(let d=c;d<t._selections.length&&t._selections.get(d).priority;d++)f=d;t._selections.swap(c,f)}function u(c){if(e.requests.length>=s)return!0;const f=(function(){const d=e.downloadSpeed()||1;if(d>Lg)return()=>!0;const p=Math.max(1,e.requests.length)*So.BLOCK_LENGTH/d;let m=10,v=0;return b=>{if(!m||t.bitfield.get(b))return!0;let y=t.pieces[b].missing;for(;v<t.wires.length;v++){const w=t.wires[v],C=w.downloadSpeed();if(!(C<Lg)&&!(C<=d)&&w.peerPieces.get(b)&&!((y-=C*p)>0))return m--,!1}return!0}})();for(let d=0;d<t._selections.length;d++){const p=t._selections.get(d);let m;if(t.strategy==="rarest"){const v=p.from+p.offset,b=p.to,y=b-v+1,w={};let C=0;const S=a(v,b,w,f);for(;C<y&&(m=t._rarityMap.getRarestPiece(S),!(m<0));){for(;t._request(e,m,t._critical[m]||c)&&e.requests.length<s;);if(!(e.requests.length<s))return p.priority&&l(d),!0;w[m]=!0,C++}}else for(m=p.from+p.offset;m<=p.to;m++)if(e.peerPieces.get(m)&&f(m)){for(;t._request(e,m,t._critical[m]||c)&&e.requests.length<s;);if(!(e.requests.length<s))return p.priority&&l(d),!0}}return!1}}_rechoke(){if(!this.ready)return;const e=this.wires.map(s=>({wire:s,random:Math.random()})).sort((s,a)=>{const l=s.wire,u=a.wire;return l.downloadSpeed()!==u.downloadSpeed()?l.downloadSpeed()-u.downloadSpeed():l.uploadSpeed()!==u.uploadSpeed()?l.uploadSpeed()-u.uploadSpeed():l.amChoking!==u.amChoking?l.amChoking?-1:1:s.random-a.random}).map(s=>s.wire);this._rechokeOptimisticTime<=0?this._rechokeOptimisticWire=null:this._rechokeOptimisticTime-=1;let t=0;for(;e.length>0&&t<this._rechokeNumSlots-1;){const s=e.pop();s.isSeeder||s===this._rechokeOptimisticWire||(s.unchoke(),s.peerInterested&&t++)}if(this._rechokeOptimisticWire===null&&this._rechokeNumSlots>0){const s=e.filter(a=>a.peerInterested);if(s.length>0){const a=s[n=s.length,Math.random()*n|0];a.unchoke(),this._rechokeOptimisticWire=a,this._rechokeOptimisticTime=2}}var n;e.filter(s=>s!==this._rechokeOptimisticWire).forEach(s=>s.choke())}_hotswap(e,t){const n=e.downloadSpeed();if(n<So.BLOCK_LENGTH||!this._reservations[t])return!1;const s=this._reservations[t];if(!s)return!1;let a,l,u=1/0;for(l=0;l<s.length;l++){const c=s[l];if(!c||c===e)continue;const f=c.downloadSpeed();f>=Lg||2*f>n||f>u||(a=c,u=f)}if(!a)return!1;for(l=0;l<s.length;l++)s[l]===a&&(s[l]=null);for(l=0;l<a.requests.length;l++){const c=a.requests[l];c.piece===t&&this.pieces[t].cancel(c.offset/So.BLOCK_LENGTH|0)}return this.emit("hotswap",a,e,t),!0}_request(e,t,n){const s=this,a=e.requests.length,l=e.type==="webSeed";if(s.bitfield.get(t))return!1;const u=l?Math.min((function(y,w,C){return 1+Math.ceil(w*y.downloadSpeed()/C)})(e,1,s.pieceLength),s.maxWebConns):qg(e,1);if(a>=u)return!1;const c=s.pieces[t];let f=l?c.reserveRemaining():c.reserve();if(f===-1&&n&&s._hotswap(e,t)&&(f=l?c.reserveRemaining():c.reserve()),f===-1)return!1;let d=s._reservations[t];d||(d=s._reservations[t]=[]);let p=d.indexOf(null);p===-1&&(p=d.length),d[p]=e;const m=c.chunkOffset(f),v=l?c.chunkLengthRemaining(f):c.chunkLength(f);function b(){Ai(()=>{s._update()})}return e.request(t,m,v,async function y(w,C){if(s.destroyed)return;if(!s.ready)return s.once("ready",()=>{y(w,C)});if(d[p]===e&&(d[p]=null),c!==s.pieces[t])return b();if(w)return s._debug("error getting piece %s (offset: %s length: %s) from %s: %s",t,m,v,`${e.remoteAddress}:${e.remotePort}`,w.message),l?c.cancelRemaining(f):c.cancel(f),void b();if(s._debug("got piece %s (offset: %s length: %s) from %s",t,m,v,`${e.remoteAddress}:${e.remotePort}`),!c.set(f,C,e))return b();const S=c.flush(),x=await(0,rn.tW)(S,"hex");s.destroyed||(x===s._hashes[t]?(s._debug("piece verified %s",t),s.store.put(t,S,k=>{k?s._destroy(k):(s.pieces[t]=null,s._markVerified(t),s.wires.forEach(A=>{A.have(t)}),s._checkDone(),b())})):(s.pieces[t]=new So(c.length),s.emit("warning",new Error(`Piece ${t} failed verification`)),b()))}),!0}_checkDone(){if(this.destroyed)return;this.files.forEach(t=>{if(!t.done){for(let n=t._startPiece;n<=t._endPiece;++n)if(!this.bitfield.get(n))return;t.done=!0,t.emit("done"),this._debug(`file done: ${t.name}`)}});const e=this.files.every(t=>t.done);return!this.done&&e?(this.done=!0,this._debug(`torrent done: ${this.infoHash}`),this.emit("done"),this.destroyed||this.discovery.complete()):this.done&&!e&&(this.done=!1,this.discovery.tracker?.start()),this._gcSelections(),e}async load(e,t){if(this.destroyed)throw new Error("torrent is destroyed");if(!this.ready)return this.once("ready",()=>{this.load(e,t)});Array.isArray(e)||(e=[e]),t||(t=Yx);try{await R4(this.store,BS(e),{chunkLength:this.pieceLength}),this._markAllVerified(),this._checkDone(),t(null)}catch(n){return t(n),n}}pause(){this.destroyed||(this._debug("pause"),this.paused=!0)}resume(){this.destroyed||(this._debug("resume"),this.paused=!1,this._drain())}_debug(...e){e[0]=`[${this.client._debugId}] [${this._debugId}] ${e[0]}`,i6(...e)}_drain(){if(this._debug("_drain numConns %s maxConns %s _peersLength %s",this._numConns,this.client.maxConns,this._peersLength),typeof Mx.connect!="function"||this.destroyed||this.paused||this._numConns>=this.client.maxConns)return;this._debug("drain (%s queued, %s/%s peers)",this._numQueued,this.numPeers,this.client.maxConns);const e=this._queue.shift();if(!e)return;this._debug("%s connect attempt to %s",e.type,e.addr);const t=Mu(e.addr),n={host:t[0],port:t[1]};this.client.utp&&e.type===ws.A.TYPE_UTP_OUTGOING?e.conn=e6.connect(n.port,n.host):e.conn=Mx.connect(n);const s=e.conn;s.once("connect",()=>{this.destroyed||e.onConnect()}),s.once("error",a=>{e.destroy(a)}),e.startConnectTimeout(),s.on("close",()=>{if(this.destroyed)return;if(e.retries>=Ug.length){if(this.client.utp){const u=this._addPeer(e.addr,"tcp",e.source);u&&(u.retries=0)}else this._debug("conn %s closed: will not re-add (max %s attempts)",e.addr,Ug.length);return}const a=Ug[e.retries];this._debug("conn %s closed: will re-add to queue in %sms (attempt %s)",e.addr,a,e.retries+1);const l=setTimeout(()=>{if(this.destroyed)return;const u=Mu(e.addr)[0],c=this.client.utp&&this._isIPv4(u)?"utp":"tcp",f=this._addPeer(e.addr,c,e.source);f&&(f.retries=e.retries+1)},a);l.unref&&l.unref()})}_validAddr(e){let t;try{t=Mu(e)}catch{return!1}const n=t[0],s=t[1];return s>0&&s<65535&&!(n==="127.0.0.1"&&s===this.client.torrentPort)}_isIPv4(e){return/^((?:[0-9]|[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5])[.]){3}(?:[0-9]|[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5])$/.test(e)}}function qg(i,e){let t=2+Math.ceil(e*i.downloadSpeed()/So.BLOCK_LENGTH);if(i.peerExtendedHandshake){const n=i.peerExtendedHandshake.reqq;typeof n=="number"&&n>0&&(t=Math.min(t,n))}return t}function Yx(){}var a6=fn(4043),yo=fn(580),GS=fn(815),l6=fn(2878);class is{constructor(e,t={}){this.client=e,t.origin||(t.origin="*"),this.opts=t,this.pendingReady=new Set}static serveIndexPage(e,t,n){const s=t.map(a=>`<li>
        <a href="${yo(n)}/${a.infoHash}">
          ${yo(a.name)}
        </a>
        (${yo(a.length)} bytes)
      </li>`).join("<br>");return e.status=200,e.headers["Content-Type"]="text/html",e.body=th("WebTorrent",`<h1>WebTorrent</h1>
       <ol>${s}</ol>`),e}isOriginAllowed(e){return this.opts.origin!==!1&&(this.opts.origin==="*"||e.headers.origin===this.opts.origin)}static serveMethodNotAllowed(e){return e.status=405,e.headers["Content-Type"]="text/html",e.body=th("405 - Method Not Allowed","<h1>405 - Method Not Allowed</h1>"),e}static serve404Page(e){return e.status=404,e.headers["Content-Type"]="text/html",e.body=th("404 - Not Found","<h1>404 - Not Found</h1>"),e}static serveTorrentPage(e,t,n){const s=e.files.map(a=>`<li>
        <a href="${yo(n)}/${e.infoHash}/${yo(a.path)}">
          ${yo(a.path)}
        </a>
        (${yo(a.length)} bytes)
      </li>`).join("<br>");return t.status=200,t.headers["Content-Type"]="text/html",t.body=th(`${yo(e.name)} - WebTorrent`,`<h1>${yo(e.name)}</h1>
      <ol>${s}</ol>`),t}static serveOptionsRequest(e,t){return t.status=204,t.headers["Access-Control-Max-Age"]="600",t.headers["Access-Control-Allow-Methods"]="GET,HEAD",e.headers["access-control-request-headers"]&&(t.headers["Access-Control-Allow-Headers"]=e.headers["access-control-request-headers"]),t}static serveFile(e,t,n){n.status=200,n.headers.Expires="0",n.headers["Cache-Control"]="no-cache, no-store, must-revalidate, max-age=0",n.headers["Accept-Ranges"]="bytes",n.headers["Content-Type"]=e.type,n.headers["transferMode.dlna.org"]="Streaming",n.headers["contentFeatures.dlna.org"]="DLNA.ORG_OP=01;DLNA.ORG_CI=0;DLNA.ORG_FLAGS=01700000000000000000000000000000",t.destination==="document"?(n.headers["Content-Type"]="application/octet-stream",n.headers["Content-Disposition"]=`attachment; filename*=UTF-8''${Wx(e.name)}`,n.body="DOWNLOAD"):n.headers["Content-Disposition"]=`inline; filename*=UTF-8''${Wx(e.name)}`;let s=l6(e.length,t.headers.range||"");if(Array.isArray(s)?(n.status=206,s=s[0],n.headers["Content-Range"]=`bytes ${s.start}-${s.end}/${e.length}`,n.headers["Content-Length"]=s.end-s.start+1):(n.statusCode=200,s=null,n.headers["Content-Length"]=e.length),t.method==="GET"){const a=e[Symbol.asyncIterator](s);let l=null;e.emit("iterator",{iterator:a,req:t,file:e},f=>{l=f});const u=yd.Readable.from(l||a);let c=null;e.emit("stream",{stream:u,req:t,file:e},f=>{c=GS(u,f)}),n.body=c||u}else n.body=!1;return n}async onRequest(e,t){let n=new URL(e.url,"http://example.com").pathname;n=n.slice(n.indexOf(this.pathname)+this.pathname.length+1);const s={headers:{"X-Content-Type-Options":"nosniff","Content-Security-Policy":"base-uri 'none'; frame-ancestors 'none'; form-action 'none';"}};if(this.isOriginAllowed(e)&&(s.headers["Access-Control-Allow-Origin"]=this.opts.origin==="*"?"*":e.headers.origin),n==="favicon.ico")return t(is.serve404Page(s));if(e.method==="OPTIONS")return this.isOriginAllowed(e)?t(is.serveOptionsRequest(e,s)):t(is.serveMethodNotAllowed(s));const a=async()=>{this.pendingReady.delete(a);const u=await l();t(u)},l=async()=>{if(n==="")return is.serveIndexPage(s,this.client.torrents,this.pathname);let[u,...c]=n.split("/");c=decodeURI(c.join("/"));const f=await this.client.get(u);if(!u||!f)return is.serve404Page(s);if(!c)return is.serveTorrentPage(f,s,this.pathname);const d=f.files.find(p=>p.path.replace(/\\/g,"/")===c);return d?is.serveFile(d,e,s):is.serve404Page(s)};if(e.method==="GET"||e.method==="HEAD"){if(this.client.ready){const u=await l();return t(u)}return this.pendingReady.add(a),void this.client.once("ready",a)}return t(is.serveMethodNotAllowed(s))}close(e=()=>{}){this.closed=!0,this.pendingReady.forEach(t=>{this.client.removeListener("ready",t)}),this.pendingReady.clear(),Ai(e)}destroy(e=()=>{}){this.closed?Ai(e):this.close(e),this.client=null}}class c6 extends is{constructor(e,t){super(e,t),this.server=a6.createServer(),this._listen=this.server.listen,this.server.listen=this.listen.bind(this),this._close=this.server.close,this.server.close=this.close.bind(this),this.sockets=new Set,this.closed=!1,this.pathname=t?.pathname||"/webtorrent"}wrapRequest(e,t){return this.opts.hostname&&e.headers.host!==`${this.opts.hostname}:${this.server.address().port}`?e.destroy():new URL(e.url,"http://example.com").pathname.startsWith(this.pathname)?void this.onRequest(e,({status:n,headers:s,body:a})=>{t.writeHead(n,s),a?._readableState||a?._writableState?GS(a,t):t.end(a)}):e.destroy()}onConnection(e){e.setTimeout(36e6),this.sockets.add(e),e.once("close",()=>{this.sockets.delete(e)})}address(){return this.server.address()}listen(...e){return this.closed=!1,this.server.on("connection",this.onConnection.bind(this)),this.server.on("request",this.wrapRequest.bind(this)),this._listen.apply(this.server,e)}close(e=()=>{}){this.server.removeAllListeners("connection"),this.server.removeAllListeners("request"),this.server.removeAllListeners("listening"),super.close(),this._close.call(this.server,e)}destroy(e){this.sockets.forEach(t=>{t.destroy()}),super.destroy(e)}}class u6 extends is{constructor(e,t){super(e,t),this.registration=t.controller,this.workerKeepAliveInterval=null,this.workerPortCount=0;const n=new URL(t.controller.scope);this.pathname=n.pathname+"webtorrent",this._address={port:n.port,family:"IPv4",address:n.hostname},this.boundHandler=this.wrapRequest.bind(this),navigator.serviceWorker.addEventListener("message",this.boundHandler),fetch(`${this.pathname}/cancel/`).then(s=>{s.body.cancel()})}wrapRequest(e){const t=e.data;if(!t?.type==="webtorrent"||!t.url)return null;const[n]=e.ports;this.onRequest(t,({status:s,headers:a,body:l})=>{const u=l[Symbol.asyncIterator]?.(),c=()=>{n.onmessage=null,l?.destroy&&l.destroy(),this.workerPortCount--,this.workerPortCount||(clearInterval(this.workerKeepAliveInterval),this.workerKeepAliveInterval=null)};n.onmessage=async f=>{if(f.data){let d;try{d=(await u.next()).value}catch{}n.postMessage(d),d||c(),this.workerKeepAliveInterval||(this.workerKeepAliveInterval=setInterval(()=>fetch(`${this.pathname}/keepalive/`),2e4))}else c()},this.workerPortCount++,n.postMessage({status:s,headers:a,body:u?"STREAM":l})})}listen(e,t){t()}address(){return this._address}close(e){navigator.serviceWorker.removeEventListener("message",this.boundHandler),super.close(e)}destroy(e){super.destroy(e)}}function th(i,e){return`
    <!DOCTYPE html>
    <html lang="en">
      <head>
        <meta charset="utf-8">
        <title>${i}</title>
      </head>
      <body>
        ${e}
      </body>
    </html>
  `}function Wx(i){return encodeURIComponent(i).replace(/['()]/g,escape).replace(/\*/g,"%2A").replace(/%(?:7C|60|5E)/g,unescape)}const Fg=Ss("webtorrent"),KS=Qu.replace(/\d*./g,i=>("0"+i%100).slice(-2)).slice(0,4),f6=`-WW${KS}-`;let bh=class VS extends No{constructor(e={}){super(),typeof e.peerId=="string"?this.peerId=e.peerId:ArrayBuffer.isView(e.peerId)?this.peerId=(0,rn.V5)(e.peerId):this.peerId=(0,rn.V5)((0,rn.L0)(f6+(0,rn.NJ)((0,rn.po)(9)))),this.peerIdBuffer=(0,rn.fk)(this.peerId),typeof e.nodeId=="string"?this.nodeId=e.nodeId:ArrayBuffer.isView(e.nodeId)?this.nodeId=(0,rn.V5)(e.nodeId):this.nodeId=(0,rn.V5)((0,rn.po)(20)),this.nodeIdBuffer=(0,rn.fk)(this.nodeId),this._debugId=this.peerId.substring(0,7),this.destroyed=!1,this.listening=!1,this.torrentPort=e.torrentPort||0,this.dhtPort=e.dhtPort||0,this.tracker=e.tracker!==void 0?e.tracker:{},this.lsd=e.lsd!==!1,this.utPex=e.utPex!==!1,this.natUpnp=e.natUpnp??!0,this.natPmp=e.natPmp??!0,this.torrents=[],this.maxConns=Number(e.maxConns)||55,this.utp=VS.UTP_SUPPORT&&e.utp!==!1,this.seedOutgoingConnections=e.seedOutgoingConnections??!0,this._downloadLimit=Math.max(typeof e.downloadLimit=="number"?e.downloadLimit:-1,-1),this._uploadLimit=Math.max(typeof e.uploadLimit=="number"?e.uploadLimit:-1,-1),(this.natUpnp||this.natPmp)&&typeof Tx=="function"&&(this.natTraversal=new Tx({enableUPNP:this.natUpnp,enablePMP:this.natPmp,upnpPermanentFallback:e.natUpnp==="permanent"})),e.secure===!0&&Promise.resolve().then(fn.bind(fn,5658)).then(({enableSecure:n})=>n()),this._debug("new webtorrent (peerId %s, nodeId %s, port %s)",this.peerId,this.nodeId,this.torrentPort),this.throttleGroups={down:new kx.ThrottleGroup({rate:Math.max(this._downloadLimit,0),enabled:this._downloadLimit>=0}),up:new kx.ThrottleGroup({rate:Math.max(this._uploadLimit,0),enabled:this._uploadLimit>=0})},this.tracker&&(typeof this.tracker!="object"&&(this.tracker={}),globalThis.WRTC&&!this.tracker.wrtc&&(this.tracker.wrtc=globalThis.WRTC)),typeof x0=="function"?this._connPool=new x0(this):Ai(()=>{this._onListening()}),this._downloadSpeed=nd(),this._uploadSpeed=nd(),e.dht!==!1&&typeof _x.Client=="function"?(this.dht=new _x.Client(Object.assign({},{nodeId:this.nodeId},e.dht)),this.dht.once("error",n=>{this._destroy(n)}),this.dht.once("listening",()=>{const n=this.dht.address();n&&(this.dhtPort=n.port,this.natTraversal&&this.natTraversal.map({publicPort:this.dhtPort,privatePort:this.dhtPort,protocol:"udp",description:"WebTorrent DHT"}).catch(s=>{Fg("error mapping DHT port via UPnP/PMP: %o",s)}))}),this.dht.setMaxListeners(0),this.dht.listen(this.dhtPort)):this.dht=!1,this.enableWebSeeds=e.webSeeds!==!1;const t=()=>{this.destroyed||(this.ready=!0,this.emit("ready"))};typeof Sx=="function"&&e.blocklist!=null?Sx(e.blocklist,{headers:{"user-agent":`WebTorrent/${Qu} (https://webtorrent.io)`}},(n,s)=>{if(n)return console.error(`Failed to load blocklist: ${n.message}`);this.blocked=s,t()}):Ai(t)}createServer(e,t){if(this.destroyed)throw new Error("torrent is destroyed");if(this._server)throw new Error("server already created");if(typeof window<"u"&&t!=="node"||t==="browser"){if(!(e?.controller instanceof ServiceWorkerRegistration))throw new Error("Invalid worker registration");if(e.controller.active.state!=="activated")throw new Error("Worker isn't activated");return this._server=new u6(this,e),this._server}return this._server=new c6(this,e),this._server}get downloadSpeed(){return this._downloadSpeed()}get uploadSpeed(){return this._uploadSpeed()}get progress(){const e=this.torrents.filter(t=>t.progress!==1);return e.reduce((t,n)=>t+n.downloaded,0)/(e.reduce((t,n)=>t+(n.length||0),0)||1)}get ratio(){return this.torrents.reduce((e,t)=>e+t.uploaded,0)/(this.torrents.reduce((e,t)=>e+t.received,0)||1)}async get(e){if(e instanceof $x){if(this.torrents.includes(e))return e}else{const t=this.torrents;let n;try{n=await mh(e)}catch{}if(!n)return null;if(!n.infoHash)throw new Error("Invalid torrent identifier");for(const s of t)if(s.infoHash===n.infoHash)return s}return null}add(e,t={},n=()=>{}){if(this.destroyed)throw new Error("client is destroyed");typeof t=="function"&&([t,n]=[{},t]);const s=()=>{if(!this.destroyed){for(const u of this.torrents)if(u.infoHash===l.infoHash&&u!==l)return l._destroy(new Error(`Cannot add duplicate torrent ${l.infoHash}`)),void n(u)}},a=()=>{this.destroyed||(n(l),this.emit("torrent",l))};this._debug("add"),t=t?Object.assign({},t):{};const l=new $x(e,this,t);return this.torrents.push(l),l.once("_infoHash",s),l.once("ready",a),l.once("close",function u(){l.removeListener("_infoHash",s),l.removeListener("ready",a),l.removeListener("close",u)}),this.emit("add",l),l}seed(e,t,n){if(this.destroyed)throw new Error("client is destroyed");typeof t=="function"&&([t,n]=[{},t]),this._debug("seed"),(t=t?Object.assign({},t):{}).skipVerify=!0;const s=typeof e=="string";s&&(t.path=(function(f){if(td(f),f.length===0)return".";let d=f.charCodeAt(0);const p=d===47;let m=-1,v=!0;for(let b=f.length-1;b>=1;--b)if(d=f.charCodeAt(b),d===47){if(!v){m=b;break}}else v=!1;return m===-1?p?"/":".":p&&m===1?"//":f.slice(0,m)})(e)),t.createdBy||(t.createdBy=`WebTorrent/${KS}`);const a=f=>{this._debug("on seed"),typeof n=="function"&&n(f),f.emit("seed"),this.emit("seed",f)},l=this.add(null,t,f=>{const d=[p=>{if(s||t.preloadedStore)return p();f.load(u,p)}];this.dht&&d.push(p=>{f.once("dhtAnnounce",p)}),Pa(d,p=>{if(!this.destroyed)return p?f._destroy(p):void a(f)})});let u;var c;return c=e,typeof FileList<"u"&&c instanceof FileList?e=Array.from(e):Array.isArray(e)||(e=[e]),Pa(e.map(f=>async d=>{if(!t.preloadedStore&&(function(p){return typeof p=="object"&&p!=null&&typeof p.pipe=="function"})(f)){const p=[];try{for await(const v of f)p.push(v)}catch(v){return d(v)}const m=(0,rn.xW)(p);m.name=f.name,d(null,m)}else d(null,f)}),(f,d)=>{if(!this.destroyed)return f?l._destroy(f):void(function(p,m,v){typeof m=="function"&&([m,v]=[v,m]),jS(p,m=m?Object.assign({},m):{},v)})(d,t,(p,m)=>{if(!this.destroyed){if(p)return l._destroy(p);u=m.map(v=>v.getStream),x4(d,t,async(v,b)=>{if(this.destroyed)return;if(v)return l._destroy(v);const y=await this.get(b);y?(console.warn("A torrent with the same id is already being seeded"),l._destroy(),typeof n=="function"&&n(y)):l._onTorrentId(b)})}})}),l}async remove(e,t,n){if(typeof t=="function")return this.remove(e,null,t);this._debug("remove");const s=await this.get(e);if(!s)throw new Error(`No torrent with id ${e}`);this._remove(s,t,n)}_remove(e,t,n){if(!e)return;if(typeof t=="function")return this._remove(e,null,t);const s=this.torrents.indexOf(e);s!==-1&&(this.torrents.splice(s,1),e.destroy(t,n),this.dht&&this.dht._tables.remove(e.infoHash),this.emit("remove",e))}address(){return this.listening?this._connPool?this._connPool.tcpServer.address():{address:"0.0.0.0",family:"IPv4",port:0}:null}throttleDownload(e){return e=Number(e),!(isNaN(e)||!isFinite(e)||e<-1)&&(this._downloadLimit=e,this._downloadLimit<0?this.throttleGroups.down.setEnabled(!1):(this.throttleGroups.down.setEnabled(!0),void this.throttleGroups.down.setRate(this._downloadLimit)))}throttleUpload(e){return e=Number(e),!(isNaN(e)||!isFinite(e)||e<-1)&&(this._uploadLimit=e,this._uploadLimit<0?this.throttleGroups.up.setEnabled(!1):(this.throttleGroups.up.setEnabled(!0),void this.throttleGroups.up.setRate(this._uploadLimit)))}destroy(e){if(this.destroyed)throw new Error("client already destroyed");this._destroy(null,e)}_destroy(e,t){this._debug("client destroy"),this.destroyed=!0;const n=this.torrents.map(s=>a=>{s.destroy(a)});this._connPool&&n.push(s=>{this._connPool.destroy(s)}),this.dht&&n.push(s=>{this.dht.destroy(s)}),this._server&&n.push(s=>{this._server.destroy(s)}),this.natTraversal&&n.push(s=>{this.natTraversal.destroy().then(()=>s())}),Pa(n,t),e&&this.emit("error",e),this.torrents=[],this._connPool=null,this.dht=null,this.throttleGroups.down.destroy(),this.throttleGroups.up.destroy()}_onListening(){if(this._debug("listening"),this.listening=!0,this._connPool){const e=this._connPool.tcpServer.address();e&&(this.torrentPort=e.port,this.natTraversal&&this.natTraversal.map({publicPort:this.torrentPort,privatePort:this.torrentPort,protocol:this.utp?null:"tcp",description:"WebTorrent Torrent"}).catch(t=>{Fg("error mapping WebTorrent port via UPnP/PMP: %o",t)}))}this.emit("listening")}_debug(){const e=[].slice.call(arguments);e[0]=`[${this._debugId}] ${e[0]}`,Fg(...e)}async _getByHash(e){for(const t of this.torrents)if(t.infoHashHash||(t.infoHashHash=await(0,rn.tW)((0,rn.fk)("72657132"+t.infoHash),"hex")),e===t.infoHashHash)return t;return null}};bh.WEBRTC_SUPPORT=nb.WEBRTC_SUPPORT,bh.UTP_SUPPORT=x0.UTP_SUPPORT,bh.VERSION=Qu;const Qx=100,h6=["wss://tracker.openwebtorrent.com"];async function d6(i){if(typeof crypto<"u"&&crypto.subtle){const s=new TextEncoder().encode(i),a=await crypto.subtle.digest("SHA-1",s);return Array.from(new Uint8Array(a)).map(u=>u.toString(16).padStart(2,"0")).join("")}let e=0;for(let n=0;n<i.length;n++){const s=i.charCodeAt(n);e=(e<<5)-e+s,e=e&e}const t=Math.abs(e).toString(16).padStart(8,"0");return(t+t+t+t+t).substring(0,40)}class p6{name="WebTorrent";client=null;userIdHash=null;connected=!1;ownInboxTorrent=null;peerTorrents=new Map;handshakeCallbacks=new Set;customSignalCallbacks=new Set;messageCounter=0;trackers;initializePromise=null;initializeError=null;constructor(e=h6){this.trackers=e}async initialize(e){if(this.initializePromise)return this.initializePromise;if(this.initializeError)throw this.initializeError;if(!(this.connected&&this.client&&!this.client.destroyed)){this.initializePromise=this._doInitialize(e);try{await this.initializePromise}catch(t){throw this.initializeError=t,t}finally{this.initializePromise=null}}}async _doInitialize(e){this.userIdHash=e;try{this.client=new bh({tracker:{announce:this.trackers}})}catch(t){throw new Error(`Failed to create WebTorrent client: ${t}`)}this.client.on("error",t=>{console.error(`[${this.name}] Client error:`,t),this.connected=!1});try{this.ownInboxTorrent=await this.joinSwarm(e)}catch(t){throw new Error(`Failed to join own swarm: ${t}`)}this.setupInboxLivenessMonitoring(),this.connected=!0}setupInboxLivenessMonitoring(){this.ownInboxTorrent&&this.ownInboxTorrent.on("error",e=>{console.error(`[${this.name}] Inbox torrent error:`,e),this.connected=!1})}async generateInfoHash(e){return await d6("adun-signal-v1-"+e)}async getMagnetURI(e){const t=await this.generateInfoHash(e),n=this.trackers.map(s=>`&tr=${encodeURIComponent(s)}`).join("");return`magnet:?xt=urn:btih:${t}${n}`}async joinSwarm(e){const t=e.substring(0,8);if(!this.client)throw new Error("Cannot join swarm: client is null");if(this.client.destroyed)throw new Error("Cannot join swarm: client is destroyed");const n=await this.getMagnetURI(e),s=await this.generateInfoHash(e),a=e===this.userIdHash,l=this.client.torrents.find(u=>u.infoHash===s&&!u.destroyed);return l?(a&&!this.ownInboxTorrent&&(this.ownInboxTorrent=l,this.setupInboxLivenessMonitoring()),l):new Promise((u,c)=>{let f=!1;const d=setTimeout(()=>{f||(f=!0,c(new Error(`Swarm join timeout for ${t}`)))},15e3),p=this.client.add(n,{announce:this.trackers});p.on("infoHash",()=>{f||(f=!0,clearTimeout(d),u(p))}),p.on("wire",m=>{this.setupWireExtension(m,a)}),p.on("error",m=>{if(!f){if(f=!0,clearTimeout(d),m.message.includes("duplicate")){const v=this.client.torrents.find(b=>b.infoHash===s&&!b.destroyed);if(v){a&&!this.ownInboxTorrent&&(this.ownInboxTorrent=v,this.setupInboxLivenessMonitoring()),u(v);return}}c(m)}})})}setupWireExtension(e,t){e._adunSignalSetup||(e._adunSignalSetup=!0,e.on("extended",(n,s)=>{if(n===Qx)try{const a=new TextDecoder().decode(s),l=JSON.parse(a);t&&this.handleIncomingMessage(l)}catch(a){console.error(`[${this.name}] Failed to parse wire message:`,a)}}))}handleIncomingMessage(e){!e.from||!e.type||(e.type==="handshake"&&e.message?this.handshakeCallbacks.forEach(t=>{t(e.from,e.message)}):e.type==="custom"&&e.signal&&this.customSignalCallbacks.forEach(t=>{t(e.from,e.signal)}))}generateMessageId(){return this.messageCounter++,`${Date.now()}-${this.messageCounter}-${Math.random().toString(36).substring(2,8)}`}async sendMessage(e,t){const n=e.substring(0,8);if(!this.client)throw new Error("Cannot send: client is null");if(this.client.destroyed)throw new Error("Cannot send: client is destroyed");if(!this.userIdHash)throw new Error("Cannot send: not initialized");if(!this.connected)throw new Error("Cannot send: not connected");let s=this.peerTorrents.get(e);if(s&&s.destroyed&&(this.peerTorrents.delete(e),s=null),!s){if(s=await this.joinSwarm(e),!s)throw new Error(`Failed to join swarm for ${n}`);this.peerTorrents.set(e,s)}const a={...t,from:this.userIdHash,timestamp:Date.now(),id:this.generateMessageId()},l=new TextEncoder().encode(JSON.stringify(a));await this.waitForWiresAndSend(s,l,n)}async waitForWiresAndSend(e,t,n){return new Promise((s,a)=>{const l=Date.now(),u=setTimeout(()=>{const p=Date.now()-l,m=e.wires||[],v=m.filter(b=>b.peerExtensions?.extended).length;a(new Error(`No peers available for ${n} after ${p}ms (${m.length} wires, ${v} extended)`))},1e4),c=()=>{const p=e.wires||[];for(const m of p)if(m.peerExtensions?.extended)try{return m.extended(Qx,t),clearTimeout(u),s(),!0}catch{}return!1};if(c())return;const f=p=>{this.setupWireExtension(p,!1),p.on("handshake",()=>{setTimeout(()=>{c()&&e.removeListener("wire",f)},100)})};e.on("wire",f);const d=setInterval(()=>{c()&&(clearInterval(d),e.removeListener("wire",f))},500);setTimeout(()=>{clearInterval(d),e.removeListener("wire",f)},1e4)})}async sendHandshakeMessage(e,t){await this.sendMessage(e,{type:"handshake",message:t})}async sendCustomSignal(e,t){await this.sendMessage(e,{type:"custom",signal:t})}onHandshakeMessage(e){return this.handshakeCallbacks.add(e),()=>{this.handshakeCallbacks.delete(e)}}onCustomSignal(e){return this.customSignalCallbacks.add(e),()=>{this.customSignalCallbacks.delete(e)}}isConnected(){return this.connected&&this.client!==null&&!this.client.destroyed&&this.ownInboxTorrent!==null&&!this.ownInboxTorrent.destroyed}destroy(){this.client&&this.client.destroy(),this.ownInboxTorrent=null,this.peerTorrents.clear(),this.handshakeCallbacks.clear(),this.customSignalCallbacks.clear(),this.connected=!1,this.userIdHash=null,this.client=null,this.initializePromise=null,this.initializeError=null}}var rb=Object.defineProperty,g6=Object.getOwnPropertyDescriptor,m6=Object.getOwnPropertyNames,y6=Object.prototype.hasOwnProperty,qi=(i,e)=>()=>(i&&(e=i(i=0)),e),Rt=(i,e)=>()=>(e||i((e={exports:{}}).exports,e),e.exports),jc=(i,e)=>{for(var t in e)rb(i,t,{get:e[t],enumerable:!0})},b6=(i,e,t,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let s of m6(e))!y6.call(i,s)&&s!==t&&rb(i,s,{get:()=>e[s],enumerable:!(n=g6(e,s))||n.enumerable});return i},dr=i=>b6(rb({},"__esModule",{value:!0}),i),_t=qi(()=>{}),vr={};jc(vr,{_debugEnd:()=>sm,_debugProcess:()=>im,_events:()=>wm,_eventsCount:()=>xm,_exiting:()=>G0,_fatalExceptions:()=>tm,_getActiveHandles:()=>XS,_getActiveRequests:()=>ZS,_kill:()=>$0,_linkedBinding:()=>QS,_maxListeners:()=>vm,_preload_modules:()=>ym,_rawDebug:()=>F0,_startProfilerIdleNotifier:()=>om,_stopProfilerIdleNotifier:()=>am,_tickCallback:()=>rm,abort:()=>fm,addListener:()=>_m,allowedNodeEnvironmentFlags:()=>X0,arch:()=>k0,argv:()=>I0,argv0:()=>mm,assert:()=>eE,binding:()=>j0,browser:()=>q0,chdir:()=>L0,config:()=>K0,cpuUsage:()=>Du,cwd:()=>P0,debugPort:()=>gm,default:()=>sb,dlopen:()=>JS,domain:()=>z0,emit:()=>km,emitWarning:()=>B0,env:()=>M0,execArgv:()=>R0,execPath:()=>pm,exit:()=>J0,features:()=>em,hasUncaughtExceptionCaptureCallback:()=>tE,hrtime:()=>vh,kill:()=>Q0,listeners:()=>rE,memoryUsage:()=>W0,moduleLoadList:()=>H0,nextTick:()=>YS,off:()=>Em,on:()=>wo,once:()=>Sm,openStdin:()=>Z0,pid:()=>hm,platform:()=>T0,ppid:()=>dm,prependListener:()=>Tm,prependOnceListener:()=>Mm,reallyExit:()=>V0,release:()=>U0,removeAllListeners:()=>Am,removeListener:()=>Cm,resourceUsage:()=>Y0,setSourceMapsEnabled:()=>bm,setUncaughtExceptionCaptureCallback:()=>nm,stderr:()=>cm,stdin:()=>um,stdout:()=>lm,title:()=>A0,umask:()=>D0,uptime:()=>nE,version:()=>O0,versions:()=>N0});function ib(i){throw new Error("Node.js process "+i+" is not supported by JSPM core outside of Node.js")}function v6(){!Cl||!wl||(Cl=!1,wl.length?Hs=wl.concat(Hs):Hu=-1,Hs.length&&$S())}function $S(){if(!Cl){var i=setTimeout(v6,0);Cl=!0;for(var e=Hs.length;e;){for(wl=Hs,Hs=[];++Hu<e;)wl&&wl[Hu].run();Hu=-1,e=Hs.length}wl=null,Cl=!1,clearTimeout(i)}}function YS(i){var e=new Array(arguments.length-1);if(arguments.length>1)for(var t=1;t<arguments.length;t++)e[t-1]=arguments[t];Hs.push(new WS(i,e)),Hs.length===1&&!Cl&&setTimeout($S,0)}function WS(i,e){this.fun=i,this.array=e}function di(){}function QS(i){ib("_linkedBinding")}function JS(i){ib("dlopen")}function ZS(){return[]}function XS(){return[]}function eE(i,e){if(!i)throw new Error(e||"assertion error")}function tE(){return!1}function nE(){return Eo.now()/1e3}function vh(i){var e=Math.floor((Date.now()-Eo.now())*.001),t=Eo.now()*.001,n=Math.floor(t)+e,s=Math.floor(t%1*1e9);return i&&(n=n-i[0],s=s-i[1],s<0&&(n--,s+=wh)),[n,s]}function wo(){return sb}function rE(i){return[]}var Hs,Cl,wl,Hu,A0,k0,T0,M0,I0,R0,O0,N0,B0,j0,D0,P0,L0,U0,q0,F0,H0,z0,G0,K0,V0,$0,Du,Y0,W0,Q0,J0,Z0,X0,em,tm,nm,rm,im,sm,om,am,lm,cm,um,fm,hm,dm,pm,gm,mm,ym,bm,Eo,Hg,wh,vm,wm,xm,_m,Sm,Em,Cm,Am,km,Tm,Mm,sb,w6=qi(()=>{_t(),Et(),St(),Hs=[],Cl=!1,Hu=-1,WS.prototype.run=function(){this.fun.apply(null,this.array)},A0="browser",k0="x64",T0="browser",M0={PATH:"/usr/bin",LANG:typeof navigator<"u"?navigator.language+".UTF-8":void 0,PWD:"/",HOME:"/home",TMP:"/tmp"},I0=["/usr/bin/node"],R0=[],O0="v16.8.0",N0={},B0=function(i,e){console.warn((e?e+": ":"")+i)},j0=function(i){ib("binding")},D0=function(i){return 0},P0=function(){return"/"},L0=function(i){},U0={name:"node",sourceUrl:"",headersUrl:"",libUrl:""},q0=!0,F0=di,H0=[],z0={},G0=!1,K0={},V0=di,$0=di,Du=function(){return{}},Y0=Du,W0=Du,Q0=di,J0=di,Z0=di,X0={},em={inspector:!1,debug:!1,uv:!1,ipv6:!1,tls_alpn:!1,tls_sni:!1,tls_ocsp:!1,tls:!1,cached_builtins:!0},tm=di,nm=di,rm=di,im=di,sm=di,om=di,am=di,lm=void 0,cm=void 0,um=void 0,fm=di,hm=2,dm=1,pm="/bin/usr/node",gm=9229,mm="node",ym=[],bm=di,Eo={now:typeof performance<"u"?performance.now.bind(performance):void 0,timing:typeof performance<"u"?performance.timing:void 0},Eo.now===void 0&&(Hg=Date.now(),Eo.timing&&Eo.timing.navigationStart&&(Hg=Eo.timing.navigationStart),Eo.now=()=>Date.now()-Hg),wh=1e9,vh.bigint=function(i){var e=vh(i);return typeof BigInt>"u"?e[0]*wh+e[1]:BigInt(e[0]*wh)+BigInt(e[1])},vm=10,wm={},xm=0,_m=wo,Sm=wo,Em=wo,Cm=wo,Am=wo,km=di,Tm=wo,Mm=wo,sb={version:O0,versions:N0,arch:k0,platform:T0,browser:q0,release:U0,_rawDebug:F0,moduleLoadList:H0,binding:j0,_linkedBinding:QS,_events:wm,_eventsCount:xm,_maxListeners:vm,on:wo,addListener:_m,once:Sm,off:Em,removeListener:Cm,removeAllListeners:Am,emit:km,prependListener:Tm,prependOnceListener:Mm,listeners:rE,domain:z0,_exiting:G0,config:K0,dlopen:JS,uptime:nE,_getActiveRequests:ZS,_getActiveHandles:XS,reallyExit:V0,_kill:$0,cpuUsage:Du,resourceUsage:Y0,memoryUsage:W0,kill:Q0,exit:J0,openStdin:Z0,allowedNodeEnvironmentFlags:X0,assert:eE,features:em,_fatalExceptions:tm,setUncaughtExceptionCaptureCallback:nm,hasUncaughtExceptionCaptureCallback:tE,emitWarning:B0,nextTick:YS,_tickCallback:rm,_debugProcess:im,_debugEnd:sm,_startProfilerIdleNotifier:om,_stopProfilerIdleNotifier:am,stdout:lm,stdin:um,stderr:cm,abort:fm,umask:D0,chdir:L0,cwd:P0,env:M0,title:A0,argv:I0,execArgv:R0,pid:hm,ppid:dm,execPath:pm,debugPort:gm,hrtime:vh,argv0:mm,_preload_modules:ym,setSourceMapsEnabled:bm}}),St=qi(()=>{w6()});function x6(){if(Im)return xc;Im=!0,xc.byteLength=u,xc.toByteArray=f,xc.fromByteArray=m;for(var i=[],e=[],t=typeof Uint8Array<"u"?Uint8Array:Array,n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",s=0,a=n.length;s<a;++s)i[s]=n[s],e[n.charCodeAt(s)]=s;e[45]=62,e[95]=63;function l(v){var b=v.length;if(b%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var y=v.indexOf("=");y===-1&&(y=b);var w=y===b?0:4-y%4;return[y,w]}function u(v){var b=l(v),y=b[0],w=b[1];return(y+w)*3/4-w}function c(v,b,y){return(b+y)*3/4-y}function f(v){var b,y=l(v),w=y[0],C=y[1],S=new t(c(v,w,C)),x=0,k=C>0?w-4:w,A;for(A=0;A<k;A+=4)b=e[v.charCodeAt(A)]<<18|e[v.charCodeAt(A+1)]<<12|e[v.charCodeAt(A+2)]<<6|e[v.charCodeAt(A+3)],S[x++]=b>>16&255,S[x++]=b>>8&255,S[x++]=b&255;return C===2&&(b=e[v.charCodeAt(A)]<<2|e[v.charCodeAt(A+1)]>>4,S[x++]=b&255),C===1&&(b=e[v.charCodeAt(A)]<<10|e[v.charCodeAt(A+1)]<<4|e[v.charCodeAt(A+2)]>>2,S[x++]=b>>8&255,S[x++]=b&255),S}function d(v){return i[v>>18&63]+i[v>>12&63]+i[v>>6&63]+i[v&63]}function p(v,b,y){for(var w,C=[],S=b;S<y;S+=3)w=(v[S]<<16&16711680)+(v[S+1]<<8&65280)+(v[S+2]&255),C.push(d(w));return C.join("")}function m(v){for(var b,y=v.length,w=y%3,C=[],S=16383,x=0,k=y-w;x<k;x+=S)C.push(p(v,x,x+S>k?k:x+S));return w===1?(b=v[y-1],C.push(i[b>>2]+i[b<<4&63]+"==")):w===2&&(b=(v[y-2]<<8)+v[y-1],C.push(i[b>>10]+i[b>>4&63]+i[b<<2&63]+"=")),C.join("")}return xc}function _6(){return Rm?Pu:(Rm=!0,Pu.read=function(i,e,t,n,s){var a,l,u=s*8-n-1,c=(1<<u)-1,f=c>>1,d=-7,p=t?s-1:0,m=t?-1:1,v=i[e+p];for(p+=m,a=v&(1<<-d)-1,v>>=-d,d+=u;d>0;a=a*256+i[e+p],p+=m,d-=8);for(l=a&(1<<-d)-1,a>>=-d,d+=n;d>0;l=l*256+i[e+p],p+=m,d-=8);if(a===0)a=1-f;else{if(a===c)return l?NaN:(v?-1:1)*(1/0);l=l+Math.pow(2,n),a=a-f}return(v?-1:1)*l*Math.pow(2,a-n)},Pu.write=function(i,e,t,n,s,a){var l,u,c,f=a*8-s-1,d=(1<<f)-1,p=d>>1,m=s===23?Math.pow(2,-24)-Math.pow(2,-77):0,v=n?0:a-1,b=n?1:-1,y=e<0||e===0&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(u=isNaN(e)?1:0,l=d):(l=Math.floor(Math.log(e)/Math.LN2),e*(c=Math.pow(2,-l))<1&&(l--,c*=2),l+p>=1?e+=m/c:e+=m*Math.pow(2,1-p),e*c>=2&&(l++,c/=2),l+p>=d?(u=0,l=d):l+p>=1?(u=(e*c-1)*Math.pow(2,s),l=l+p):(u=e*Math.pow(2,p-1)*Math.pow(2,s),l=0));s>=8;i[t+v]=u&255,v+=b,u/=256,s-=8);for(l=l<<s|u,f+=s;f>0;i[t+v]=l&255,v+=b,l/=256,f-=8);i[t+v-b]|=y*128},Pu)}function S6(){if(Om)return Ra;Om=!0;let i=x6(),e=_6(),t=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;Ra.Buffer=l,Ra.SlowBuffer=C,Ra.INSPECT_MAX_BYTES=50;let n=2147483647;Ra.kMaxLength=n,l.TYPED_ARRAY_SUPPORT=s(),!l.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function s(){try{let j=new Uint8Array(1),W={foo:function(){return 42}};return Object.setPrototypeOf(W,Uint8Array.prototype),Object.setPrototypeOf(j,W),j.foo()===42}catch{return!1}}Object.defineProperty(l.prototype,"parent",{enumerable:!0,get:function(){if(l.isBuffer(this))return this.buffer}}),Object.defineProperty(l.prototype,"offset",{enumerable:!0,get:function(){if(l.isBuffer(this))return this.byteOffset}});function a(j){if(j>n)throw new RangeError('The value "'+j+'" is invalid for option "size"');let W=new Uint8Array(j);return Object.setPrototypeOf(W,l.prototype),W}function l(j,W,se){if(typeof j=="number"){if(typeof W=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return d(j)}return u(j,W,se)}l.poolSize=8192;function u(j,W,se){if(typeof j=="string")return p(j,W);if(ArrayBuffer.isView(j))return v(j);if(j==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof j);if(ye(j,ArrayBuffer)||j&&ye(j.buffer,ArrayBuffer)||typeof SharedArrayBuffer<"u"&&(ye(j,SharedArrayBuffer)||j&&ye(j.buffer,SharedArrayBuffer)))return b(j,W,se);if(typeof j=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');let Oe=j.valueOf&&j.valueOf();if(Oe!=null&&Oe!==j)return l.from(Oe,W,se);let Ke=y(j);if(Ke)return Ke;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof j[Symbol.toPrimitive]=="function")return l.from(j[Symbol.toPrimitive]("string"),W,se);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof j)}l.from=function(j,W,se){return u(j,W,se)},Object.setPrototypeOf(l.prototype,Uint8Array.prototype),Object.setPrototypeOf(l,Uint8Array);function c(j){if(typeof j!="number")throw new TypeError('"size" argument must be of type number');if(j<0)throw new RangeError('The value "'+j+'" is invalid for option "size"')}function f(j,W,se){return c(j),j<=0?a(j):W!==void 0?typeof se=="string"?a(j).fill(W,se):a(j).fill(W):a(j)}l.alloc=function(j,W,se){return f(j,W,se)};function d(j){return c(j),a(j<0?0:w(j)|0)}l.allocUnsafe=function(j){return d(j)},l.allocUnsafeSlow=function(j){return d(j)};function p(j,W){if((typeof W!="string"||W==="")&&(W="utf8"),!l.isEncoding(W))throw new TypeError("Unknown encoding: "+W);let se=S(j,W)|0,Oe=a(se),Ke=Oe.write(j,W);return Ke!==se&&(Oe=Oe.slice(0,Ke)),Oe}function m(j){let W=j.length<0?0:w(j.length)|0,se=a(W);for(let Oe=0;Oe<W;Oe+=1)se[Oe]=j[Oe]&255;return se}function v(j){if(ye(j,Uint8Array)){let W=new Uint8Array(j);return b(W.buffer,W.byteOffset,W.byteLength)}return m(j)}function b(j,W,se){if(W<0||j.byteLength<W)throw new RangeError('"offset" is outside of buffer bounds');if(j.byteLength<W+(se||0))throw new RangeError('"length" is outside of buffer bounds');let Oe;return W===void 0&&se===void 0?Oe=new Uint8Array(j):se===void 0?Oe=new Uint8Array(j,W):Oe=new Uint8Array(j,W,se),Object.setPrototypeOf(Oe,l.prototype),Oe}function y(j){if(l.isBuffer(j)){let W=w(j.length)|0,se=a(W);return se.length===0||j.copy(se,0,0,W),se}if(j.length!==void 0)return typeof j.length!="number"||it(j.length)?a(0):m(j);if(j.type==="Buffer"&&Array.isArray(j.data))return m(j.data)}function w(j){if(j>=n)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+n.toString(16)+" bytes");return j|0}function C(j){return+j!=j&&(j=0),l.alloc(+j)}l.isBuffer=function(j){return j!=null&&j._isBuffer===!0&&j!==l.prototype},l.compare=function(j,W){if(ye(j,Uint8Array)&&(j=l.from(j,j.offset,j.byteLength)),ye(W,Uint8Array)&&(W=l.from(W,W.offset,W.byteLength)),!l.isBuffer(j)||!l.isBuffer(W))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(j===W)return 0;let se=j.length,Oe=W.length;for(let Ke=0,gt=Math.min(se,Oe);Ke<gt;++Ke)if(j[Ke]!==W[Ke]){se=j[Ke],Oe=W[Ke];break}return se<Oe?-1:Oe<se?1:0},l.isEncoding=function(j){switch(String(j).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},l.concat=function(j,W){if(!Array.isArray(j))throw new TypeError('"list" argument must be an Array of Buffers');if(j.length===0)return l.alloc(0);let se;if(W===void 0)for(W=0,se=0;se<j.length;++se)W+=j[se].length;let Oe=l.allocUnsafe(W),Ke=0;for(se=0;se<j.length;++se){let gt=j[se];if(ye(gt,Uint8Array))Ke+gt.length>Oe.length?(l.isBuffer(gt)||(gt=l.from(gt)),gt.copy(Oe,Ke)):Uint8Array.prototype.set.call(Oe,gt,Ke);else if(l.isBuffer(gt))gt.copy(Oe,Ke);else throw new TypeError('"list" argument must be an Array of Buffers');Ke+=gt.length}return Oe};function S(j,W){if(l.isBuffer(j))return j.length;if(ArrayBuffer.isView(j)||ye(j,ArrayBuffer))return j.byteLength;if(typeof j!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof j);let se=j.length,Oe=arguments.length>2&&arguments[2]===!0;if(!Oe&&se===0)return 0;let Ke=!1;for(;;)switch(W){case"ascii":case"latin1":case"binary":return se;case"utf8":case"utf-8":return de(j).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return se*2;case"hex":return se>>>1;case"base64":return rt(j).length;default:if(Ke)return Oe?-1:de(j).length;W=(""+W).toLowerCase(),Ke=!0}}l.byteLength=S;function x(j,W,se){let Oe=!1;if((W===void 0||W<0)&&(W=0),W>this.length||((se===void 0||se>this.length)&&(se=this.length),se<=0)||(se>>>=0,W>>>=0,se<=W))return"";for(j||(j="utf8");;)switch(j){case"hex":return B(this,W,se);case"utf8":case"utf-8":return N(this,W,se);case"ascii":return ee(this,W,se);case"latin1":case"binary":return ne(this,W,se);case"base64":return O(this,W,se);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return z(this,W,se);default:if(Oe)throw new TypeError("Unknown encoding: "+j);j=(j+"").toLowerCase(),Oe=!0}}l.prototype._isBuffer=!0;function k(j,W,se){let Oe=j[W];j[W]=j[se],j[se]=Oe}l.prototype.swap16=function(){let j=this.length;if(j%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let W=0;W<j;W+=2)k(this,W,W+1);return this},l.prototype.swap32=function(){let j=this.length;if(j%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let W=0;W<j;W+=4)k(this,W,W+3),k(this,W+1,W+2);return this},l.prototype.swap64=function(){let j=this.length;if(j%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let W=0;W<j;W+=8)k(this,W,W+7),k(this,W+1,W+6),k(this,W+2,W+5),k(this,W+3,W+4);return this},l.prototype.toString=function(){let j=this.length;return j===0?"":arguments.length===0?N(this,0,j):x.apply(this,arguments)},l.prototype.toLocaleString=l.prototype.toString,l.prototype.equals=function(j){if(!l.isBuffer(j))throw new TypeError("Argument must be a Buffer");return this===j?!0:l.compare(this,j)===0},l.prototype.inspect=function(){let j="",W=Ra.INSPECT_MAX_BYTES;return j=this.toString("hex",0,W).replace(/(.{2})/g,"$1 ").trim(),this.length>W&&(j+=" ... "),"<Buffer "+j+">"},t&&(l.prototype[t]=l.prototype.inspect),l.prototype.compare=function(j,W,se,Oe,Ke){if(ye(j,Uint8Array)&&(j=l.from(j,j.offset,j.byteLength)),!l.isBuffer(j))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof j);if(W===void 0&&(W=0),se===void 0&&(se=j?j.length:0),Oe===void 0&&(Oe=0),Ke===void 0&&(Ke=this.length),W<0||se>j.length||Oe<0||Ke>this.length)throw new RangeError("out of range index");if(Oe>=Ke&&W>=se)return 0;if(Oe>=Ke)return-1;if(W>=se)return 1;if(W>>>=0,se>>>=0,Oe>>>=0,Ke>>>=0,this===j)return 0;let gt=Ke-Oe,Ut=se-W,Le=Math.min(gt,Ut),Xe=this.slice(Oe,Ke),zt=j.slice(W,se);for(let mt=0;mt<Le;++mt)if(Xe[mt]!==zt[mt]){gt=Xe[mt],Ut=zt[mt];break}return gt<Ut?-1:Ut<gt?1:0};function A(j,W,se,Oe,Ke){if(j.length===0)return-1;if(typeof se=="string"?(Oe=se,se=0):se>2147483647?se=2147483647:se<-2147483648&&(se=-2147483648),se=+se,it(se)&&(se=Ke?0:j.length-1),se<0&&(se=j.length+se),se>=j.length){if(Ke)return-1;se=j.length-1}else if(se<0)if(Ke)se=0;else return-1;if(typeof W=="string"&&(W=l.from(W,Oe)),l.isBuffer(W))return W.length===0?-1:R(j,W,se,Oe,Ke);if(typeof W=="number")return W=W&255,typeof Uint8Array.prototype.indexOf=="function"?Ke?Uint8Array.prototype.indexOf.call(j,W,se):Uint8Array.prototype.lastIndexOf.call(j,W,se):R(j,[W],se,Oe,Ke);throw new TypeError("val must be string, number or Buffer")}function R(j,W,se,Oe,Ke){let gt=1,Ut=j.length,Le=W.length;if(Oe!==void 0&&(Oe=String(Oe).toLowerCase(),Oe==="ucs2"||Oe==="ucs-2"||Oe==="utf16le"||Oe==="utf-16le")){if(j.length<2||W.length<2)return-1;gt=2,Ut/=2,Le/=2,se/=2}function Xe(mt,an){return gt===1?mt[an]:mt.readUInt16BE(an*gt)}let zt;if(Ke){let mt=-1;for(zt=se;zt<Ut;zt++)if(Xe(j,zt)===Xe(W,mt===-1?0:zt-mt)){if(mt===-1&&(mt=zt),zt-mt+1===Le)return mt*gt}else mt!==-1&&(zt-=zt-mt),mt=-1}else for(se+Le>Ut&&(se=Ut-Le),zt=se;zt>=0;zt--){let mt=!0;for(let an=0;an<Le;an++)if(Xe(j,zt+an)!==Xe(W,an)){mt=!1;break}if(mt)return zt}return-1}l.prototype.includes=function(j,W,se){return this.indexOf(j,W,se)!==-1},l.prototype.indexOf=function(j,W,se){return A(this,j,W,se,!0)},l.prototype.lastIndexOf=function(j,W,se){return A(this,j,W,se,!1)};function I(j,W,se,Oe){se=Number(se)||0;let Ke=j.length-se;Oe?(Oe=Number(Oe),Oe>Ke&&(Oe=Ke)):Oe=Ke;let gt=W.length;Oe>gt/2&&(Oe=gt/2);let Ut;for(Ut=0;Ut<Oe;++Ut){let Le=parseInt(W.substr(Ut*2,2),16);if(it(Le))return Ut;j[se+Ut]=Le}return Ut}function U(j,W,se,Oe){return at(de(W,j.length-se),j,se,Oe)}function te(j,W,se,Oe){return at(Be(W),j,se,Oe)}function G(j,W,se,Oe){return at(rt(W),j,se,Oe)}function Y(j,W,se,Oe){return at(Je(W,j.length-se),j,se,Oe)}l.prototype.write=function(j,W,se,Oe){if(W===void 0)Oe="utf8",se=this.length,W=0;else if(se===void 0&&typeof W=="string")Oe=W,se=this.length,W=0;else if(isFinite(W))W=W>>>0,isFinite(se)?(se=se>>>0,Oe===void 0&&(Oe="utf8")):(Oe=se,se=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");let Ke=this.length-W;if((se===void 0||se>Ke)&&(se=Ke),j.length>0&&(se<0||W<0)||W>this.length)throw new RangeError("Attempt to write outside buffer bounds");Oe||(Oe="utf8");let gt=!1;for(;;)switch(Oe){case"hex":return I(this,j,W,se);case"utf8":case"utf-8":return U(this,j,W,se);case"ascii":case"latin1":case"binary":return te(this,j,W,se);case"base64":return G(this,j,W,se);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Y(this,j,W,se);default:if(gt)throw new TypeError("Unknown encoding: "+Oe);Oe=(""+Oe).toLowerCase(),gt=!0}},l.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function O(j,W,se){return W===0&&se===j.length?i.fromByteArray(j):i.fromByteArray(j.slice(W,se))}function N(j,W,se){se=Math.min(j.length,se);let Oe=[],Ke=W;for(;Ke<se;){let gt=j[Ke],Ut=null,Le=gt>239?4:gt>223?3:gt>191?2:1;if(Ke+Le<=se){let Xe,zt,mt,an;switch(Le){case 1:gt<128&&(Ut=gt);break;case 2:Xe=j[Ke+1],(Xe&192)===128&&(an=(gt&31)<<6|Xe&63,an>127&&(Ut=an));break;case 3:Xe=j[Ke+1],zt=j[Ke+2],(Xe&192)===128&&(zt&192)===128&&(an=(gt&15)<<12|(Xe&63)<<6|zt&63,an>2047&&(an<55296||an>57343)&&(Ut=an));break;case 4:Xe=j[Ke+1],zt=j[Ke+2],mt=j[Ke+3],(Xe&192)===128&&(zt&192)===128&&(mt&192)===128&&(an=(gt&15)<<18|(Xe&63)<<12|(zt&63)<<6|mt&63,an>65535&&an<1114112&&(Ut=an))}}Ut===null?(Ut=65533,Le=1):Ut>65535&&(Ut-=65536,Oe.push(Ut>>>10&1023|55296),Ut=56320|Ut&1023),Oe.push(Ut),Ke+=Le}return q(Oe)}let Q=4096;function q(j){let W=j.length;if(W<=Q)return String.fromCharCode.apply(String,j);let se="",Oe=0;for(;Oe<W;)se+=String.fromCharCode.apply(String,j.slice(Oe,Oe+=Q));return se}function ee(j,W,se){let Oe="";se=Math.min(j.length,se);for(let Ke=W;Ke<se;++Ke)Oe+=String.fromCharCode(j[Ke]&127);return Oe}function ne(j,W,se){let Oe="";se=Math.min(j.length,se);for(let Ke=W;Ke<se;++Ke)Oe+=String.fromCharCode(j[Ke]);return Oe}function B(j,W,se){let Oe=j.length;(!W||W<0)&&(W=0),(!se||se<0||se>Oe)&&(se=Oe);let Ke="";for(let gt=W;gt<se;++gt)Ke+=Mt[j[gt]];return Ke}function z(j,W,se){let Oe=j.slice(W,se),Ke="";for(let gt=0;gt<Oe.length-1;gt+=2)Ke+=String.fromCharCode(Oe[gt]+Oe[gt+1]*256);return Ke}l.prototype.slice=function(j,W){let se=this.length;j=~~j,W=W===void 0?se:~~W,j<0?(j+=se,j<0&&(j=0)):j>se&&(j=se),W<0?(W+=se,W<0&&(W=0)):W>se&&(W=se),W<j&&(W=j);let Oe=this.subarray(j,W);return Object.setPrototypeOf(Oe,l.prototype),Oe};function $(j,W,se){if(j%1!==0||j<0)throw new RangeError("offset is not uint");if(j+W>se)throw new RangeError("Trying to access beyond buffer length")}l.prototype.readUintLE=l.prototype.readUIntLE=function(j,W,se){j=j>>>0,W=W>>>0,se||$(j,W,this.length);let Oe=this[j],Ke=1,gt=0;for(;++gt<W&&(Ke*=256);)Oe+=this[j+gt]*Ke;return Oe},l.prototype.readUintBE=l.prototype.readUIntBE=function(j,W,se){j=j>>>0,W=W>>>0,se||$(j,W,this.length);let Oe=this[j+--W],Ke=1;for(;W>0&&(Ke*=256);)Oe+=this[j+--W]*Ke;return Oe},l.prototype.readUint8=l.prototype.readUInt8=function(j,W){return j=j>>>0,W||$(j,1,this.length),this[j]},l.prototype.readUint16LE=l.prototype.readUInt16LE=function(j,W){return j=j>>>0,W||$(j,2,this.length),this[j]|this[j+1]<<8},l.prototype.readUint16BE=l.prototype.readUInt16BE=function(j,W){return j=j>>>0,W||$(j,2,this.length),this[j]<<8|this[j+1]},l.prototype.readUint32LE=l.prototype.readUInt32LE=function(j,W){return j=j>>>0,W||$(j,4,this.length),(this[j]|this[j+1]<<8|this[j+2]<<16)+this[j+3]*16777216},l.prototype.readUint32BE=l.prototype.readUInt32BE=function(j,W){return j=j>>>0,W||$(j,4,this.length),this[j]*16777216+(this[j+1]<<16|this[j+2]<<8|this[j+3])},l.prototype.readBigUInt64LE=nt(function(j){j=j>>>0,Ce(j,"offset");let W=this[j],se=this[j+7];(W===void 0||se===void 0)&&ot(j,this.length-8);let Oe=W+this[++j]*2**8+this[++j]*2**16+this[++j]*2**24,Ke=this[++j]+this[++j]*2**8+this[++j]*2**16+se*2**24;return BigInt(Oe)+(BigInt(Ke)<<BigInt(32))}),l.prototype.readBigUInt64BE=nt(function(j){j=j>>>0,Ce(j,"offset");let W=this[j],se=this[j+7];(W===void 0||se===void 0)&&ot(j,this.length-8);let Oe=W*2**24+this[++j]*2**16+this[++j]*2**8+this[++j],Ke=this[++j]*2**24+this[++j]*2**16+this[++j]*2**8+se;return(BigInt(Oe)<<BigInt(32))+BigInt(Ke)}),l.prototype.readIntLE=function(j,W,se){j=j>>>0,W=W>>>0,se||$(j,W,this.length);let Oe=this[j],Ke=1,gt=0;for(;++gt<W&&(Ke*=256);)Oe+=this[j+gt]*Ke;return Ke*=128,Oe>=Ke&&(Oe-=Math.pow(2,8*W)),Oe},l.prototype.readIntBE=function(j,W,se){j=j>>>0,W=W>>>0,se||$(j,W,this.length);let Oe=W,Ke=1,gt=this[j+--Oe];for(;Oe>0&&(Ke*=256);)gt+=this[j+--Oe]*Ke;return Ke*=128,gt>=Ke&&(gt-=Math.pow(2,8*W)),gt},l.prototype.readInt8=function(j,W){return j=j>>>0,W||$(j,1,this.length),this[j]&128?(255-this[j]+1)*-1:this[j]},l.prototype.readInt16LE=function(j,W){j=j>>>0,W||$(j,2,this.length);let se=this[j]|this[j+1]<<8;return se&32768?se|4294901760:se},l.prototype.readInt16BE=function(j,W){j=j>>>0,W||$(j,2,this.length);let se=this[j+1]|this[j]<<8;return se&32768?se|4294901760:se},l.prototype.readInt32LE=function(j,W){return j=j>>>0,W||$(j,4,this.length),this[j]|this[j+1]<<8|this[j+2]<<16|this[j+3]<<24},l.prototype.readInt32BE=function(j,W){return j=j>>>0,W||$(j,4,this.length),this[j]<<24|this[j+1]<<16|this[j+2]<<8|this[j+3]},l.prototype.readBigInt64LE=nt(function(j){j=j>>>0,Ce(j,"offset");let W=this[j],se=this[j+7];(W===void 0||se===void 0)&&ot(j,this.length-8);let Oe=this[j+4]+this[j+5]*2**8+this[j+6]*2**16+(se<<24);return(BigInt(Oe)<<BigInt(32))+BigInt(W+this[++j]*2**8+this[++j]*2**16+this[++j]*2**24)}),l.prototype.readBigInt64BE=nt(function(j){j=j>>>0,Ce(j,"offset");let W=this[j],se=this[j+7];(W===void 0||se===void 0)&&ot(j,this.length-8);let Oe=(W<<24)+this[++j]*2**16+this[++j]*2**8+this[++j];return(BigInt(Oe)<<BigInt(32))+BigInt(this[++j]*2**24+this[++j]*2**16+this[++j]*2**8+se)}),l.prototype.readFloatLE=function(j,W){return j=j>>>0,W||$(j,4,this.length),e.read(this,j,!0,23,4)},l.prototype.readFloatBE=function(j,W){return j=j>>>0,W||$(j,4,this.length),e.read(this,j,!1,23,4)},l.prototype.readDoubleLE=function(j,W){return j=j>>>0,W||$(j,8,this.length),e.read(this,j,!0,52,8)},l.prototype.readDoubleBE=function(j,W){return j=j>>>0,W||$(j,8,this.length),e.read(this,j,!1,52,8)};function V(j,W,se,Oe,Ke,gt){if(!l.isBuffer(j))throw new TypeError('"buffer" argument must be a Buffer instance');if(W>Ke||W<gt)throw new RangeError('"value" argument is out of bounds');if(se+Oe>j.length)throw new RangeError("Index out of range")}l.prototype.writeUintLE=l.prototype.writeUIntLE=function(j,W,se,Oe){if(j=+j,W=W>>>0,se=se>>>0,!Oe){let Ut=Math.pow(2,8*se)-1;V(this,j,W,se,Ut,0)}let Ke=1,gt=0;for(this[W]=j&255;++gt<se&&(Ke*=256);)this[W+gt]=j/Ke&255;return W+se},l.prototype.writeUintBE=l.prototype.writeUIntBE=function(j,W,se,Oe){if(j=+j,W=W>>>0,se=se>>>0,!Oe){let Ut=Math.pow(2,8*se)-1;V(this,j,W,se,Ut,0)}let Ke=se-1,gt=1;for(this[W+Ke]=j&255;--Ke>=0&&(gt*=256);)this[W+Ke]=j/gt&255;return W+se},l.prototype.writeUint8=l.prototype.writeUInt8=function(j,W,se){return j=+j,W=W>>>0,se||V(this,j,W,1,255,0),this[W]=j&255,W+1},l.prototype.writeUint16LE=l.prototype.writeUInt16LE=function(j,W,se){return j=+j,W=W>>>0,se||V(this,j,W,2,65535,0),this[W]=j&255,this[W+1]=j>>>8,W+2},l.prototype.writeUint16BE=l.prototype.writeUInt16BE=function(j,W,se){return j=+j,W=W>>>0,se||V(this,j,W,2,65535,0),this[W]=j>>>8,this[W+1]=j&255,W+2},l.prototype.writeUint32LE=l.prototype.writeUInt32LE=function(j,W,se){return j=+j,W=W>>>0,se||V(this,j,W,4,4294967295,0),this[W+3]=j>>>24,this[W+2]=j>>>16,this[W+1]=j>>>8,this[W]=j&255,W+4},l.prototype.writeUint32BE=l.prototype.writeUInt32BE=function(j,W,se){return j=+j,W=W>>>0,se||V(this,j,W,4,4294967295,0),this[W]=j>>>24,this[W+1]=j>>>16,this[W+2]=j>>>8,this[W+3]=j&255,W+4};function Z(j,W,se,Oe,Ke){Ie(W,Oe,Ke,j,se,7);let gt=Number(W&BigInt(4294967295));j[se++]=gt,gt=gt>>8,j[se++]=gt,gt=gt>>8,j[se++]=gt,gt=gt>>8,j[se++]=gt;let Ut=Number(W>>BigInt(32)&BigInt(4294967295));return j[se++]=Ut,Ut=Ut>>8,j[se++]=Ut,Ut=Ut>>8,j[se++]=Ut,Ut=Ut>>8,j[se++]=Ut,se}function ae(j,W,se,Oe,Ke){Ie(W,Oe,Ke,j,se,7);let gt=Number(W&BigInt(4294967295));j[se+7]=gt,gt=gt>>8,j[se+6]=gt,gt=gt>>8,j[se+5]=gt,gt=gt>>8,j[se+4]=gt;let Ut=Number(W>>BigInt(32)&BigInt(4294967295));return j[se+3]=Ut,Ut=Ut>>8,j[se+2]=Ut,Ut=Ut>>8,j[se+1]=Ut,Ut=Ut>>8,j[se]=Ut,se+8}l.prototype.writeBigUInt64LE=nt(function(j,W=0){return Z(this,j,W,BigInt(0),BigInt("0xffffffffffffffff"))}),l.prototype.writeBigUInt64BE=nt(function(j,W=0){return ae(this,j,W,BigInt(0),BigInt("0xffffffffffffffff"))}),l.prototype.writeIntLE=function(j,W,se,Oe){if(j=+j,W=W>>>0,!Oe){let Le=Math.pow(2,8*se-1);V(this,j,W,se,Le-1,-Le)}let Ke=0,gt=1,Ut=0;for(this[W]=j&255;++Ke<se&&(gt*=256);)j<0&&Ut===0&&this[W+Ke-1]!==0&&(Ut=1),this[W+Ke]=(j/gt>>0)-Ut&255;return W+se},l.prototype.writeIntBE=function(j,W,se,Oe){if(j=+j,W=W>>>0,!Oe){let Le=Math.pow(2,8*se-1);V(this,j,W,se,Le-1,-Le)}let Ke=se-1,gt=1,Ut=0;for(this[W+Ke]=j&255;--Ke>=0&&(gt*=256);)j<0&&Ut===0&&this[W+Ke+1]!==0&&(Ut=1),this[W+Ke]=(j/gt>>0)-Ut&255;return W+se},l.prototype.writeInt8=function(j,W,se){return j=+j,W=W>>>0,se||V(this,j,W,1,127,-128),j<0&&(j=255+j+1),this[W]=j&255,W+1},l.prototype.writeInt16LE=function(j,W,se){return j=+j,W=W>>>0,se||V(this,j,W,2,32767,-32768),this[W]=j&255,this[W+1]=j>>>8,W+2},l.prototype.writeInt16BE=function(j,W,se){return j=+j,W=W>>>0,se||V(this,j,W,2,32767,-32768),this[W]=j>>>8,this[W+1]=j&255,W+2},l.prototype.writeInt32LE=function(j,W,se){return j=+j,W=W>>>0,se||V(this,j,W,4,2147483647,-2147483648),this[W]=j&255,this[W+1]=j>>>8,this[W+2]=j>>>16,this[W+3]=j>>>24,W+4},l.prototype.writeInt32BE=function(j,W,se){return j=+j,W=W>>>0,se||V(this,j,W,4,2147483647,-2147483648),j<0&&(j=4294967295+j+1),this[W]=j>>>24,this[W+1]=j>>>16,this[W+2]=j>>>8,this[W+3]=j&255,W+4},l.prototype.writeBigInt64LE=nt(function(j,W=0){return Z(this,j,W,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))}),l.prototype.writeBigInt64BE=nt(function(j,W=0){return ae(this,j,W,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))});function Ae(j,W,se,Oe,Ke,gt){if(se+Oe>j.length)throw new RangeError("Index out of range");if(se<0)throw new RangeError("Index out of range")}function be(j,W,se,Oe,Ke){return W=+W,se=se>>>0,Ke||Ae(j,W,se,4),e.write(j,W,se,Oe,23,4),se+4}l.prototype.writeFloatLE=function(j,W,se){return be(this,j,W,!0,se)},l.prototype.writeFloatBE=function(j,W,se){return be(this,j,W,!1,se)};function Ge(j,W,se,Oe,Ke){return W=+W,se=se>>>0,Ke||Ae(j,W,se,8),e.write(j,W,se,Oe,52,8),se+8}l.prototype.writeDoubleLE=function(j,W,se){return Ge(this,j,W,!0,se)},l.prototype.writeDoubleBE=function(j,W,se){return Ge(this,j,W,!1,se)},l.prototype.copy=function(j,W,se,Oe){if(!l.isBuffer(j))throw new TypeError("argument should be a Buffer");if(se||(se=0),!Oe&&Oe!==0&&(Oe=this.length),W>=j.length&&(W=j.length),W||(W=0),Oe>0&&Oe<se&&(Oe=se),Oe===se||j.length===0||this.length===0)return 0;if(W<0)throw new RangeError("targetStart out of bounds");if(se<0||se>=this.length)throw new RangeError("Index out of range");if(Oe<0)throw new RangeError("sourceEnd out of bounds");Oe>this.length&&(Oe=this.length),j.length-W<Oe-se&&(Oe=j.length-W+se);let Ke=Oe-se;return this===j&&typeof Uint8Array.prototype.copyWithin=="function"?this.copyWithin(W,se,Oe):Uint8Array.prototype.set.call(j,this.subarray(se,Oe),W),Ke},l.prototype.fill=function(j,W,se,Oe){if(typeof j=="string"){if(typeof W=="string"?(Oe=W,W=0,se=this.length):typeof se=="string"&&(Oe=se,se=this.length),Oe!==void 0&&typeof Oe!="string")throw new TypeError("encoding must be a string");if(typeof Oe=="string"&&!l.isEncoding(Oe))throw new TypeError("Unknown encoding: "+Oe);if(j.length===1){let gt=j.charCodeAt(0);(Oe==="utf8"&&gt<128||Oe==="latin1")&&(j=gt)}}else typeof j=="number"?j=j&255:typeof j=="boolean"&&(j=Number(j));if(W<0||this.length<W||this.length<se)throw new RangeError("Out of range index");if(se<=W)return this;W=W>>>0,se=se===void 0?this.length:se>>>0,j||(j=0);let Ke;if(typeof j=="number")for(Ke=W;Ke<se;++Ke)this[Ke]=j;else{let gt=l.isBuffer(j)?j:l.from(j,Oe),Ut=gt.length;if(Ut===0)throw new TypeError('The value "'+j+'" is invalid for argument "value"');for(Ke=0;Ke<se-W;++Ke)this[Ke+W]=gt[Ke%Ut]}return this};let Te={};function ve(j,W,se){Te[j]=class extends se{constructor(){super(),Object.defineProperty(this,"message",{value:W.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${j}]`,this.stack,delete this.name}get code(){return j}set code(Oe){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:Oe,writable:!0})}toString(){return`${this.name} [${j}]: ${this.message}`}}}ve("ERR_BUFFER_OUT_OF_BOUNDS",function(j){return j?`${j} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError),ve("ERR_INVALID_ARG_TYPE",function(j,W){return`The "${j}" argument must be of type number. Received type ${typeof W}`},TypeError),ve("ERR_OUT_OF_RANGE",function(j,W,se){let Oe=`The value of "${j}" is out of range.`,Ke=se;return Number.isInteger(se)&&Math.abs(se)>2**32?Ke=ke(String(se)):typeof se=="bigint"&&(Ke=String(se),(se>BigInt(2)**BigInt(32)||se<-(BigInt(2)**BigInt(32)))&&(Ke=ke(Ke)),Ke+="n"),Oe+=` It must be ${W}. Received ${Ke}`,Oe},RangeError);function ke(j){let W="",se=j.length,Oe=j[0]==="-"?1:0;for(;se>=Oe+4;se-=3)W=`_${j.slice(se-3,se)}${W}`;return`${j.slice(0,se)}${W}`}function Me(j,W,se){Ce(W,"offset"),(j[W]===void 0||j[W+se]===void 0)&&ot(W,j.length-(se+1))}function Ie(j,W,se,Oe,Ke,gt){if(j>se||j<W){let Ut=typeof W=="bigint"?"n":"",Le;throw W===0||W===BigInt(0)?Le=`>= 0${Ut} and < 2${Ut} ** ${(gt+1)*8}${Ut}`:Le=`>= -(2${Ut} ** ${(gt+1)*8-1}${Ut}) and < 2 ** ${(gt+1)*8-1}${Ut}`,new Te.ERR_OUT_OF_RANGE("value",Le,j)}Me(Oe,Ke,gt)}function Ce(j,W){if(typeof j!="number")throw new Te.ERR_INVALID_ARG_TYPE(W,"number",j)}function ot(j,W,se){throw Math.floor(j)!==j?(Ce(j,se),new Te.ERR_OUT_OF_RANGE("offset","an integer",j)):W<0?new Te.ERR_BUFFER_OUT_OF_BOUNDS:new Te.ERR_OUT_OF_RANGE("offset",`>= 0 and <= ${W}`,j)}let et=/[^+/0-9A-Za-z-_]/g;function me(j){if(j=j.split("=")[0],j=j.trim().replace(et,""),j.length<2)return"";for(;j.length%4!==0;)j=j+"=";return j}function de(j,W){W=W||1/0;let se,Oe=j.length,Ke=null,gt=[];for(let Ut=0;Ut<Oe;++Ut){if(se=j.charCodeAt(Ut),se>55295&&se<57344){if(!Ke){if(se>56319){(W-=3)>-1&&gt.push(239,191,189);continue}else if(Ut+1===Oe){(W-=3)>-1&&gt.push(239,191,189);continue}Ke=se;continue}if(se<56320){(W-=3)>-1&&gt.push(239,191,189),Ke=se;continue}se=(Ke-55296<<10|se-56320)+65536}else Ke&&(W-=3)>-1&&gt.push(239,191,189);if(Ke=null,se<128){if((W-=1)<0)break;gt.push(se)}else if(se<2048){if((W-=2)<0)break;gt.push(se>>6|192,se&63|128)}else if(se<65536){if((W-=3)<0)break;gt.push(se>>12|224,se>>6&63|128,se&63|128)}else if(se<1114112){if((W-=4)<0)break;gt.push(se>>18|240,se>>12&63|128,se>>6&63|128,se&63|128)}else throw new Error("Invalid code point")}return gt}function Be(j){let W=[];for(let se=0;se<j.length;++se)W.push(j.charCodeAt(se)&255);return W}function Je(j,W){let se,Oe,Ke,gt=[];for(let Ut=0;Ut<j.length&&!((W-=2)<0);++Ut)se=j.charCodeAt(Ut),Oe=se>>8,Ke=se%256,gt.push(Ke),gt.push(Oe);return gt}function rt(j){return i.toByteArray(me(j))}function at(j,W,se,Oe){let Ke;for(Ke=0;Ke<Oe&&!(Ke+se>=W.length||Ke>=j.length);++Ke)W[Ke+se]=j[Ke];return Ke}function ye(j,W){return j instanceof W||j!=null&&j.constructor!=null&&j.constructor.name!=null&&j.constructor.name===W.name}function it(j){return j!==j}let Mt=(function(){let j="0123456789abcdef",W=new Array(256);for(let se=0;se<16;++se){let Oe=se*16;for(let Ke=0;Ke<16;++Ke)W[Oe+Ke]=j[se]+j[Ke]}return W})();function nt(j){return typeof BigInt>"u"?Zt:j}function Zt(){throw new Error("BigInt not supported")}return Ra}var xc,Im,Pu,Rm,Ra,Om,E6=qi(()=>{_t(),Et(),St(),xc={},Im=!1,Pu={},Rm=!1,Ra={},Om=!1}),ti={};jc(ti,{Buffer:()=>id,INSPECT_MAX_BYTES:()=>iE,default:()=>xo,kMaxLength:()=>sE});var xo,id,iE,sE,ni=qi(()=>{_t(),Et(),St(),E6(),xo=S6(),xo.Buffer,xo.SlowBuffer,xo.INSPECT_MAX_BYTES,xo.kMaxLength,id=xo.Buffer,iE=xo.INSPECT_MAX_BYTES,sE=xo.kMaxLength}),Et=qi(()=>{ni()}),Nr=Rt((i,e)=>{_t(),Et(),St();var t=class extends Error{constructor(n){if(!Array.isArray(n))throw new TypeError(`Expected input to be an Array, got ${typeof n}`);let s="";for(let a=0;a<n.length;a++)s+=`    ${n[a].stack}
`;super(s),this.name="AggregateError",this.errors=n}};e.exports={AggregateError:t,ArrayIsArray(n){return Array.isArray(n)},ArrayPrototypeIncludes(n,s){return n.includes(s)},ArrayPrototypeIndexOf(n,s){return n.indexOf(s)},ArrayPrototypeJoin(n,s){return n.join(s)},ArrayPrototypeMap(n,s){return n.map(s)},ArrayPrototypePop(n,s){return n.pop(s)},ArrayPrototypePush(n,s){return n.push(s)},ArrayPrototypeSlice(n,s,a){return n.slice(s,a)},Error,FunctionPrototypeCall(n,s,...a){return n.call(s,...a)},FunctionPrototypeSymbolHasInstance(n,s){return Function.prototype[Symbol.hasInstance].call(n,s)},MathFloor:Math.floor,Number,NumberIsInteger:Number.isInteger,NumberIsNaN:Number.isNaN,NumberMAX_SAFE_INTEGER:Number.MAX_SAFE_INTEGER,NumberMIN_SAFE_INTEGER:Number.MIN_SAFE_INTEGER,NumberParseInt:Number.parseInt,ObjectDefineProperties(n,s){return Object.defineProperties(n,s)},ObjectDefineProperty(n,s,a){return Object.defineProperty(n,s,a)},ObjectGetOwnPropertyDescriptor(n,s){return Object.getOwnPropertyDescriptor(n,s)},ObjectKeys(n){return Object.keys(n)},ObjectSetPrototypeOf(n,s){return Object.setPrototypeOf(n,s)},Promise,PromisePrototypeCatch(n,s){return n.catch(s)},PromisePrototypeThen(n,s,a){return n.then(s,a)},PromiseReject(n){return Promise.reject(n)},PromiseResolve(n){return Promise.resolve(n)},ReflectApply:Reflect.apply,RegExpPrototypeTest(n,s){return n.test(s)},SafeSet:Set,String,StringPrototypeSlice(n,s,a){return n.slice(s,a)},StringPrototypeToLowerCase(n){return n.toLowerCase()},StringPrototypeToUpperCase(n){return n.toUpperCase()},StringPrototypeTrim(n){return n.trim()},Symbol,SymbolFor:Symbol.for,SymbolAsyncIterator:Symbol.asyncIterator,SymbolHasInstance:Symbol.hasInstance,SymbolIterator:Symbol.iterator,SymbolDispose:Symbol.dispose||Symbol("Symbol.dispose"),SymbolAsyncDispose:Symbol.asyncDispose||Symbol("Symbol.asyncDispose"),TypedArrayPrototypeSet(n,s,a){return n.set(s,a)},Boolean,Uint8Array}}),oE=Rt((i,e)=>{_t(),Et(),St(),e.exports={format(t,...n){return t.replace(/%([sdifj])/g,function(...[s,a]){let l=n.shift();return a==="f"?l.toFixed(6):a==="j"?JSON.stringify(l):a==="s"&&typeof l=="object"?`${l.constructor!==Object?l.constructor.name:""} {}`.trim():l.toString()})},inspect(t){switch(typeof t){case"string":if(t.includes("'"))if(t.includes('"')){if(!t.includes("`")&&!t.includes("${"))return`\`${t}\``}else return`"${t}"`;return`'${t}'`;case"number":return isNaN(t)?"NaN":Object.is(t,-0)?String(t):t;case"bigint":return`${String(t)}n`;case"boolean":case"undefined":return String(t);case"object":return"{}"}}}}),Ti=Rt((i,e)=>{_t(),Et(),St();var{format:t,inspect:n}=oE(),{AggregateError:s}=Nr(),a=globalThis.AggregateError||s,l=Symbol("kIsNodeError"),u=["string","function","number","object","Function","Object","boolean","bigint","symbol"],c=/^([A-Z][a-z0-9]*)+$/,f="__node_internal_",d={};function p(S,x){if(!S)throw new d.ERR_INTERNAL_ASSERTION(x)}function m(S){let x="",k=S.length,A=S[0]==="-"?1:0;for(;k>=A+4;k-=3)x=`_${S.slice(k-3,k)}${x}`;return`${S.slice(0,k)}${x}`}function v(S,x,k){if(typeof x=="function")return p(x.length<=k.length,`Code: ${S}; The provided arguments length (${k.length}) does not match the required ones (${x.length}).`),x(...k);let A=(x.match(/%[dfijoOs]/g)||[]).length;return p(A===k.length,`Code: ${S}; The provided arguments length (${k.length}) does not match the required ones (${A}).`),k.length===0?x:t(x,...k)}function b(S,x,k){k||(k=Error);class A extends k{constructor(...I){super(v(S,x,I))}toString(){return`${this.name} [${S}]: ${this.message}`}}Object.defineProperties(A.prototype,{name:{value:k.name,writable:!0,enumerable:!1,configurable:!0},toString:{value(){return`${this.name} [${S}]: ${this.message}`},writable:!0,enumerable:!1,configurable:!0}}),A.prototype.code=S,A.prototype[l]=!0,d[S]=A}function y(S){let x=f+S.name;return Object.defineProperty(S,"name",{value:x}),S}function w(S,x){if(S&&x&&S!==x){if(Array.isArray(x.errors))return x.errors.push(S),x;let k=new a([x,S],x.message);return k.code=x.code,k}return S||x}var C=class extends Error{constructor(S="The operation was aborted",x=void 0){if(x!==void 0&&typeof x!="object")throw new d.ERR_INVALID_ARG_TYPE("options","Object",x);super(S,x),this.code="ABORT_ERR",this.name="AbortError"}};b("ERR_ASSERTION","%s",Error),b("ERR_INVALID_ARG_TYPE",(S,x,k)=>{p(typeof S=="string","'name' must be a string"),Array.isArray(x)||(x=[x]);let A="The ";S.endsWith(" argument")?A+=`${S} `:A+=`"${S}" ${S.includes(".")?"property":"argument"} `,A+="must be ";let R=[],I=[],U=[];for(let G of x)p(typeof G=="string","All expected entries have to be of type string"),u.includes(G)?R.push(G.toLowerCase()):c.test(G)?I.push(G):(p(G!=="object",'The value "object" should be written as "Object"'),U.push(G));if(I.length>0){let G=R.indexOf("object");G!==-1&&(R.splice(R,G,1),I.push("Object"))}if(R.length>0){switch(R.length){case 1:A+=`of type ${R[0]}`;break;case 2:A+=`one of type ${R[0]} or ${R[1]}`;break;default:{let G=R.pop();A+=`one of type ${R.join(", ")}, or ${G}`}}(I.length>0||U.length>0)&&(A+=" or ")}if(I.length>0){switch(I.length){case 1:A+=`an instance of ${I[0]}`;break;case 2:A+=`an instance of ${I[0]} or ${I[1]}`;break;default:{let G=I.pop();A+=`an instance of ${I.join(", ")}, or ${G}`}}U.length>0&&(A+=" or ")}switch(U.length){case 0:break;case 1:U[0].toLowerCase()!==U[0]&&(A+="an "),A+=`${U[0]}`;break;case 2:A+=`one of ${U[0]} or ${U[1]}`;break;default:{let G=U.pop();A+=`one of ${U.join(", ")}, or ${G}`}}if(k==null)A+=`. Received ${k}`;else if(typeof k=="function"&&k.name)A+=`. Received function ${k.name}`;else if(typeof k=="object"){var te;if((te=k.constructor)!==null&&te!==void 0&&te.name)A+=`. Received an instance of ${k.constructor.name}`;else{let G=n(k,{depth:-1});A+=`. Received ${G}`}}else{let G=n(k,{colors:!1});G.length>25&&(G=`${G.slice(0,25)}...`),A+=`. Received type ${typeof k} (${G})`}return A},TypeError),b("ERR_INVALID_ARG_VALUE",(S,x,k="is invalid")=>{let A=n(x);return A.length>128&&(A=A.slice(0,128)+"..."),`The ${S.includes(".")?"property":"argument"} '${S}' ${k}. Received ${A}`},TypeError),b("ERR_INVALID_RETURN_VALUE",(S,x,k)=>{var A;let R=k!=null&&(A=k.constructor)!==null&&A!==void 0&&A.name?`instance of ${k.constructor.name}`:`type ${typeof k}`;return`Expected ${S} to be returned from the "${x}" function but got ${R}.`},TypeError),b("ERR_MISSING_ARGS",(...S)=>{p(S.length>0,"At least one arg needs to be specified");let x,k=S.length;switch(S=(Array.isArray(S)?S:[S]).map(A=>`"${A}"`).join(" or "),k){case 1:x+=`The ${S[0]} argument`;break;case 2:x+=`The ${S[0]} and ${S[1]} arguments`;break;default:{let A=S.pop();x+=`The ${S.join(", ")}, and ${A} arguments`}break}return`${x} must be specified`},TypeError),b("ERR_OUT_OF_RANGE",(S,x,k)=>{p(x,'Missing "range" argument');let A;if(Number.isInteger(k)&&Math.abs(k)>2**32)A=m(String(k));else if(typeof k=="bigint"){A=String(k);let R=BigInt(2)**BigInt(32);(k>R||k<-R)&&(A=m(A)),A+="n"}else A=n(k);return`The value of "${S}" is out of range. It must be ${x}. Received ${A}`},RangeError),b("ERR_MULTIPLE_CALLBACK","Callback called multiple times",Error),b("ERR_METHOD_NOT_IMPLEMENTED","The %s method is not implemented",Error),b("ERR_STREAM_ALREADY_FINISHED","Cannot call %s after a stream was finished",Error),b("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable",Error),b("ERR_STREAM_DESTROYED","Cannot call %s after a stream was destroyed",Error),b("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError),b("ERR_STREAM_PREMATURE_CLOSE","Premature close",Error),b("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF",Error),b("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event",Error),b("ERR_STREAM_WRITE_AFTER_END","write after end",Error),b("ERR_UNKNOWN_ENCODING","Unknown encoding: %s",TypeError),e.exports={AbortError:C,aggregateTwoErrors:y(w),hideStackFrames:y,codes:d}}),Vu=Rt((i,e)=>{_t(),Et(),St();var{AbortController:t,AbortSignal:n}=typeof self<"u"?self:typeof window<"u"?window:void 0;e.exports=t,e.exports.AbortSignal=n,e.exports.default=t}),qa={};jc(qa,{EventEmitter:()=>aE,default:()=>_c,defaultMaxListeners:()=>lE,init:()=>cE,listenerCount:()=>uE,on:()=>fE,once:()=>hE});function C6(){if(Nm)return Lu;Nm=!0;var i=typeof Reflect=="object"?Reflect:null,e=i&&typeof i.apply=="function"?i.apply:function(k,A,R){return Function.prototype.apply.call(k,A,R)},t;i&&typeof i.ownKeys=="function"?t=i.ownKeys:Object.getOwnPropertySymbols?t=function(k){return Object.getOwnPropertyNames(k).concat(Object.getOwnPropertySymbols(k))}:t=function(k){return Object.getOwnPropertyNames(k)};function n(k){console&&console.warn&&console.warn(k)}var s=Number.isNaN||function(k){return k!==k};function a(){a.init.call(this)}Lu=a,Lu.once=C,a.EventEmitter=a,a.prototype._events=void 0,a.prototype._eventsCount=0,a.prototype._maxListeners=void 0;var l=10;function u(k){if(typeof k!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof k)}Object.defineProperty(a,"defaultMaxListeners",{enumerable:!0,get:function(){return l},set:function(k){if(typeof k!="number"||k<0||s(k))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+k+".");l=k}}),a.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},a.prototype.setMaxListeners=function(k){if(typeof k!="number"||k<0||s(k))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+k+".");return this._maxListeners=k,this};function c(k){return k._maxListeners===void 0?a.defaultMaxListeners:k._maxListeners}a.prototype.getMaxListeners=function(){return c(this)},a.prototype.emit=function(k){for(var A=[],R=1;R<arguments.length;R++)A.push(arguments[R]);var I=k==="error",U=this._events;if(U!==void 0)I=I&&U.error===void 0;else if(!I)return!1;if(I){var te;if(A.length>0&&(te=A[0]),te instanceof Error)throw te;var G=new Error("Unhandled error."+(te?" ("+te.message+")":""));throw G.context=te,G}var Y=U[k];if(Y===void 0)return!1;if(typeof Y=="function")e(Y,this,A);else for(var O=Y.length,N=b(Y,O),R=0;R<O;++R)e(N[R],this,A);return!0};function f(k,A,R,I){var U,te,G;if(u(R),te=k._events,te===void 0?(te=k._events=Object.create(null),k._eventsCount=0):(te.newListener!==void 0&&(k.emit("newListener",A,R.listener?R.listener:R),te=k._events),G=te[A]),G===void 0)G=te[A]=R,++k._eventsCount;else if(typeof G=="function"?G=te[A]=I?[R,G]:[G,R]:I?G.unshift(R):G.push(R),U=c(k),U>0&&G.length>U&&!G.warned){G.warned=!0;var Y=new Error("Possible EventEmitter memory leak detected. "+G.length+" "+String(A)+" listeners added. Use emitter.setMaxListeners() to increase limit");Y.name="MaxListenersExceededWarning",Y.emitter=k,Y.type=A,Y.count=G.length,n(Y)}return k}a.prototype.addListener=function(k,A){return f(this,k,A,!1)},a.prototype.on=a.prototype.addListener,a.prototype.prependListener=function(k,A){return f(this,k,A,!0)};function d(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function p(k,A,R){var I={fired:!1,wrapFn:void 0,target:k,type:A,listener:R},U=d.bind(I);return U.listener=R,I.wrapFn=U,U}a.prototype.once=function(k,A){return u(A),this.on(k,p(this,k,A)),this},a.prototype.prependOnceListener=function(k,A){return u(A),this.prependListener(k,p(this,k,A)),this},a.prototype.removeListener=function(k,A){var R,I,U,te,G;if(u(A),I=this._events,I===void 0)return this;if(R=I[k],R===void 0)return this;if(R===A||R.listener===A)--this._eventsCount===0?this._events=Object.create(null):(delete I[k],I.removeListener&&this.emit("removeListener",k,R.listener||A));else if(typeof R!="function"){for(U=-1,te=R.length-1;te>=0;te--)if(R[te]===A||R[te].listener===A){G=R[te].listener,U=te;break}if(U<0)return this;U===0?R.shift():y(R,U),R.length===1&&(I[k]=R[0]),I.removeListener!==void 0&&this.emit("removeListener",k,G||A)}return this},a.prototype.off=a.prototype.removeListener,a.prototype.removeAllListeners=function(k){var A,R,I;if(R=this._events,R===void 0)return this;if(R.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):R[k]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete R[k]),this;if(arguments.length===0){var U=Object.keys(R),te;for(I=0;I<U.length;++I)te=U[I],te!=="removeListener"&&this.removeAllListeners(te);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(A=R[k],typeof A=="function")this.removeListener(k,A);else if(A!==void 0)for(I=A.length-1;I>=0;I--)this.removeListener(k,A[I]);return this};function m(k,A,R){var I=k._events;if(I===void 0)return[];var U=I[A];return U===void 0?[]:typeof U=="function"?R?[U.listener||U]:[U]:R?w(U):b(U,U.length)}a.prototype.listeners=function(k){return m(this,k,!0)},a.prototype.rawListeners=function(k){return m(this,k,!1)},a.listenerCount=function(k,A){return typeof k.listenerCount=="function"?k.listenerCount(A):v.call(k,A)},a.prototype.listenerCount=v;function v(k){var A=this._events;if(A!==void 0){var R=A[k];if(typeof R=="function")return 1;if(R!==void 0)return R.length}return 0}a.prototype.eventNames=function(){return this._eventsCount>0?t(this._events):[]};function b(k,A){for(var R=new Array(A),I=0;I<A;++I)R[I]=k[I];return R}function y(k,A){for(;A+1<k.length;A++)k[A]=k[A+1];k.pop()}function w(k){for(var A=new Array(k.length),R=0;R<A.length;++R)A[R]=k[R].listener||k[R];return A}function C(k,A){return new Promise(function(R,I){function U(G){k.removeListener(A,te),I(G)}function te(){typeof k.removeListener=="function"&&k.removeListener("error",U),R([].slice.call(arguments))}x(k,A,te,{once:!0}),A!=="error"&&S(k,U,{once:!0})})}function S(k,A,R){typeof k.on=="function"&&x(k,"error",A,R)}function x(k,A,R,I){if(typeof k.on=="function")I.once?k.once(A,R):k.on(A,R);else if(typeof k.addEventListener=="function")k.addEventListener(A,function U(te){I.once&&k.removeEventListener(A,U),R(te)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof k)}return Lu}var Lu,Nm,_c,aE,lE,cE,uE,fE,hE,Nl=qi(()=>{_t(),Et(),St(),Lu={},Nm=!1,_c=C6(),_c.once,_c.once=function(i,e){return new Promise((t,n)=>{function s(...l){a!==void 0&&i.removeListener("error",a),t(l)}let a;e!=="error"&&(a=l=>{i.removeListener(name,s),n(l)},i.once("error",a)),i.once(e,s)})},_c.on=function(i,e){let t=[],n=[],s=null,a=!1,l={async next(){let f=t.shift();if(f)return createIterResult(f,!1);if(s){let d=Promise.reject(s);return s=null,d}return a?createIterResult(void 0,!0):new Promise((d,p)=>n.push({resolve:d,reject:p}))},async return(){i.removeListener(e,u),i.removeListener("error",c),a=!0;for(let f of n)f.resolve(createIterResult(void 0,!0));return createIterResult(void 0,!0)},throw(f){s=f,i.removeListener(e,u),i.removeListener("error",c)},[Symbol.asyncIterator](){return this}};return i.on(e,u),i.on("error",c),l;function u(...f){let d=n.shift();d?d.resolve(createIterResult(f,!1)):t.push(f)}function c(f){a=!0;let d=n.shift();d?d.reject(f):s=f,l.return()}},{EventEmitter:aE,defaultMaxListeners:lE,init:cE,listenerCount:uE,on:fE,once:hE}=_c}),Li=Rt((i,e)=>{_t(),Et(),St();var t=(ni(),dr(ti)),{format:n,inspect:s}=oE(),{codes:{ERR_INVALID_ARG_TYPE:a}}=Ti(),{kResistStopPropagation:l,AggregateError:u,SymbolDispose:c}=Nr(),f=globalThis.AbortSignal||Vu().AbortSignal,d=globalThis.AbortController||Vu().AbortController,p=Object.getPrototypeOf(async function(){}).constructor,m=globalThis.Blob||t.Blob,v=typeof m<"u"?function(w){return w instanceof m}:function(w){return!1},b=(w,C)=>{if(w!==void 0&&(w===null||typeof w!="object"||!("aborted"in w)))throw new a(C,"AbortSignal",w)},y=(w,C)=>{if(typeof w!="function")throw new a(C,"Function",w)};e.exports={AggregateError:u,kEmptyObject:Object.freeze({}),once(w){let C=!1;return function(...S){C||(C=!0,w.apply(this,S))}},createDeferredPromise:function(){let w,C;return{promise:new Promise((S,x)=>{w=S,C=x}),resolve:w,reject:C}},promisify(w){return new Promise((C,S)=>{w((x,...k)=>x?S(x):C(...k))})},debuglog(){return function(){}},format:n,inspect:s,types:{isAsyncFunction(w){return w instanceof p},isArrayBufferView(w){return ArrayBuffer.isView(w)}},isBlob:v,deprecate(w,C){return w},addAbortListener:(Nl(),dr(qa)).addAbortListener||function(w,C){if(w===void 0)throw new a("signal","AbortSignal",w);b(w,"signal"),y(C,"listener");let S;return w.aborted?queueMicrotask(()=>C()):(w.addEventListener("abort",C,{__proto__:null,once:!0,[l]:!0}),S=()=>{w.removeEventListener("abort",C)}),{__proto__:null,[c](){var x;(x=S)===null||x===void 0||x()}}},AbortSignalAny:f.any||function(w){if(w.length===1)return w[0];let C=new d,S=()=>C.abort();return w.forEach(x=>{b(x,"signals"),x.addEventListener("abort",S,{once:!0})}),C.signal.addEventListener("abort",()=>{w.forEach(x=>x.removeEventListener("abort",S))},{once:!0}),C.signal}},e.exports.promisify.custom=Symbol.for("nodejs.util.promisify.custom")}),Ju=Rt((i,e)=>{_t(),Et(),St();var{ArrayIsArray:t,ArrayPrototypeIncludes:n,ArrayPrototypeJoin:s,ArrayPrototypeMap:a,NumberIsInteger:l,NumberIsNaN:u,NumberMAX_SAFE_INTEGER:c,NumberMIN_SAFE_INTEGER:f,NumberParseInt:d,ObjectPrototypeHasOwnProperty:p,RegExpPrototypeExec:m,String:v,StringPrototypeToUpperCase:b,StringPrototypeTrim:y}=Nr(),{hideStackFrames:w,codes:{ERR_SOCKET_BAD_PORT:C,ERR_INVALID_ARG_TYPE:S,ERR_INVALID_ARG_VALUE:x,ERR_OUT_OF_RANGE:k,ERR_UNKNOWN_SIGNAL:A}}=Ti(),{normalizeEncoding:R}=Li(),{isAsyncFunction:I,isArrayBufferView:U}=Li().types,te={};function G(ye){return ye===(ye|0)}function Y(ye){return ye===ye>>>0}var O=/^[0-7]+$/,N="must be a 32-bit unsigned integer or an octal string";function Q(ye,it,Mt){if(typeof ye>"u"&&(ye=Mt),typeof ye=="string"){if(m(O,ye)===null)throw new x(it,ye,N);ye=d(ye,8)}return ne(ye,it),ye}var q=w((ye,it,Mt=f,nt=c)=>{if(typeof ye!="number")throw new S(it,"number",ye);if(!l(ye))throw new k(it,"an integer",ye);if(ye<Mt||ye>nt)throw new k(it,`>= ${Mt} && <= ${nt}`,ye)}),ee=w((ye,it,Mt=-2147483648,nt=2147483647)=>{if(typeof ye!="number")throw new S(it,"number",ye);if(!l(ye))throw new k(it,"an integer",ye);if(ye<Mt||ye>nt)throw new k(it,`>= ${Mt} && <= ${nt}`,ye)}),ne=w((ye,it,Mt=!1)=>{if(typeof ye!="number")throw new S(it,"number",ye);if(!l(ye))throw new k(it,"an integer",ye);let nt=Mt?1:0,Zt=4294967295;if(ye<nt||ye>Zt)throw new k(it,`>= ${nt} && <= ${Zt}`,ye)});function B(ye,it){if(typeof ye!="string")throw new S(it,"string",ye)}function z(ye,it,Mt=void 0,nt){if(typeof ye!="number")throw new S(it,"number",ye);if(Mt!=null&&ye<Mt||nt!=null&&ye>nt||(Mt!=null||nt!=null)&&u(ye))throw new k(it,`${Mt!=null?`>= ${Mt}`:""}${Mt!=null&&nt!=null?" && ":""}${nt!=null?`<= ${nt}`:""}`,ye)}var $=w((ye,it,Mt)=>{if(!n(Mt,ye)){let nt="must be one of: "+s(a(Mt,Zt=>typeof Zt=="string"?`'${Zt}'`:v(Zt)),", ");throw new x(it,ye,nt)}});function V(ye,it){if(typeof ye!="boolean")throw new S(it,"boolean",ye)}function Z(ye,it,Mt){return ye==null||!p(ye,it)?Mt:ye[it]}var ae=w((ye,it,Mt=null)=>{let nt=Z(Mt,"allowArray",!1),Zt=Z(Mt,"allowFunction",!1);if(!Z(Mt,"nullable",!1)&&ye===null||!nt&&t(ye)||typeof ye!="object"&&(!Zt||typeof ye!="function"))throw new S(it,"Object",ye)}),Ae=w((ye,it)=>{if(ye!=null&&typeof ye!="object"&&typeof ye!="function")throw new S(it,"a dictionary",ye)}),be=w((ye,it,Mt=0)=>{if(!t(ye))throw new S(it,"Array",ye);if(ye.length<Mt){let nt=`must be longer than ${Mt}`;throw new x(it,ye,nt)}});function Ge(ye,it){be(ye,it);for(let Mt=0;Mt<ye.length;Mt++)B(ye[Mt],`${it}[${Mt}]`)}function Te(ye,it){be(ye,it);for(let Mt=0;Mt<ye.length;Mt++)V(ye[Mt],`${it}[${Mt}]`)}function ve(ye,it){be(ye,it);for(let Mt=0;Mt<ye.length;Mt++){let nt=ye[Mt],Zt=`${it}[${Mt}]`;if(nt==null)throw new S(Zt,"AbortSignal",nt);ot(nt,Zt)}}function ke(ye,it="signal"){if(B(ye,it),te[ye]===void 0)throw te[b(ye)]!==void 0?new A(ye+" (signals must use all capital letters)"):new A(ye)}var Me=w((ye,it="buffer")=>{if(!U(ye))throw new S(it,["Buffer","TypedArray","DataView"],ye)});function Ie(ye,it){let Mt=R(it),nt=ye.length;if(Mt==="hex"&&nt%2!==0)throw new x("encoding",it,`is invalid for data of length ${nt}`)}function Ce(ye,it="Port",Mt=!0){if(typeof ye!="number"&&typeof ye!="string"||typeof ye=="string"&&y(ye).length===0||+ye!==+ye>>>0||ye>65535||ye===0&&!Mt)throw new C(it,ye,Mt);return ye|0}var ot=w((ye,it)=>{if(ye!==void 0&&(ye===null||typeof ye!="object"||!("aborted"in ye)))throw new S(it,"AbortSignal",ye)}),et=w((ye,it)=>{if(typeof ye!="function")throw new S(it,"Function",ye)}),me=w((ye,it)=>{if(typeof ye!="function"||I(ye))throw new S(it,"Function",ye)}),de=w((ye,it)=>{if(ye!==void 0)throw new S(it,"undefined",ye)});function Be(ye,it,Mt){if(!n(Mt,ye))throw new S(it,`('${s(Mt,"|")}')`,ye)}var Je=/^(?:<[^>]*>)(?:\s*;\s*[^;"\s]+(?:=(")?[^;"\s]*\1)?)*$/;function rt(ye,it){if(typeof ye>"u"||!m(Je,ye))throw new x(it,ye,'must be an array or string of format "</styles.css>; rel=preload; as=style"')}function at(ye){if(typeof ye=="string")return rt(ye,"hints"),ye;if(t(ye)){let it=ye.length,Mt="";if(it===0)return Mt;for(let nt=0;nt<it;nt++){let Zt=ye[nt];rt(Zt,"hints"),Mt+=Zt,nt!==it-1&&(Mt+=", ")}return Mt}throw new x("hints",ye,'must be an array or string of format "</styles.css>; rel=preload; as=style"')}e.exports={isInt32:G,isUint32:Y,parseFileMode:Q,validateArray:be,validateStringArray:Ge,validateBooleanArray:Te,validateAbortSignalArray:ve,validateBoolean:V,validateBuffer:Me,validateDictionary:Ae,validateEncoding:Ie,validateFunction:et,validateInt32:ee,validateInteger:q,validateNumber:z,validateObject:ae,validateOneOf:$,validatePlainFunction:me,validatePort:Ce,validateSignalName:ke,validateString:B,validateUint32:ne,validateUndefined:de,validateUnion:Be,validateAbortSignal:ot,validateLinkHeaderValue:at}}),Bl=Rt((i,e)=>{_t(),Et(),St();var t=e.exports={},n,s;function a(){throw new Error("setTimeout has not been defined")}function l(){throw new Error("clearTimeout has not been defined")}(function(){try{typeof setTimeout=="function"?n=setTimeout:n=a}catch{n=a}try{typeof clearTimeout=="function"?s=clearTimeout:s=l}catch{s=l}})();function u(C){if(n===setTimeout)return setTimeout(C,0);if((n===a||!n)&&setTimeout)return n=setTimeout,setTimeout(C,0);try{return n(C,0)}catch{try{return n.call(null,C,0)}catch{return n.call(this,C,0)}}}function c(C){if(s===clearTimeout)return clearTimeout(C);if((s===l||!s)&&clearTimeout)return s=clearTimeout,clearTimeout(C);try{return s(C)}catch{try{return s.call(null,C)}catch{return s.call(this,C)}}}var f=[],d=!1,p,m=-1;function v(){!d||!p||(d=!1,p.length?f=p.concat(f):m=-1,f.length&&b())}function b(){if(!d){var C=u(v);d=!0;for(var S=f.length;S;){for(p=f,f=[];++m<S;)p&&p[m].run();m=-1,S=f.length}p=null,d=!1,c(C)}}t.nextTick=function(C){var S=new Array(arguments.length-1);if(arguments.length>1)for(var x=1;x<arguments.length;x++)S[x-1]=arguments[x];f.push(new y(C,S)),f.length===1&&!d&&u(b)};function y(C,S){this.fun=C,this.array=S}y.prototype.run=function(){this.fun.apply(null,this.array)},t.title="browser",t.browser=!0,t.env={},t.argv=[],t.version="",t.versions={};function w(){}t.on=w,t.addListener=w,t.once=w,t.off=w,t.removeListener=w,t.removeAllListeners=w,t.emit=w,t.prependListener=w,t.prependOnceListener=w,t.listeners=function(C){return[]},t.binding=function(C){throw new Error("process.binding is not supported")},t.cwd=function(){return"/"},t.chdir=function(C){throw new Error("process.chdir is not supported")},t.umask=function(){return 0}}),Bo=Rt((i,e)=>{_t(),Et(),St();var{SymbolAsyncIterator:t,SymbolIterator:n,SymbolFor:s}=Nr(),a=s("nodejs.stream.destroyed"),l=s("nodejs.stream.errored"),u=s("nodejs.stream.readable"),c=s("nodejs.stream.writable"),f=s("nodejs.stream.disturbed"),d=s("nodejs.webstream.isClosedPromise"),p=s("nodejs.webstream.controllerErrorFunction");function m(Z,ae=!1){var Ae;return!!(Z&&typeof Z.pipe=="function"&&typeof Z.on=="function"&&(!ae||typeof Z.pause=="function"&&typeof Z.resume=="function")&&(!Z._writableState||((Ae=Z._readableState)===null||Ae===void 0?void 0:Ae.readable)!==!1)&&(!Z._writableState||Z._readableState))}function v(Z){var ae;return!!(Z&&typeof Z.write=="function"&&typeof Z.on=="function"&&(!Z._readableState||((ae=Z._writableState)===null||ae===void 0?void 0:ae.writable)!==!1))}function b(Z){return!!(Z&&typeof Z.pipe=="function"&&Z._readableState&&typeof Z.on=="function"&&typeof Z.write=="function")}function y(Z){return Z&&(Z._readableState||Z._writableState||typeof Z.write=="function"&&typeof Z.on=="function"||typeof Z.pipe=="function"&&typeof Z.on=="function")}function w(Z){return!!(Z&&!y(Z)&&typeof Z.pipeThrough=="function"&&typeof Z.getReader=="function"&&typeof Z.cancel=="function")}function C(Z){return!!(Z&&!y(Z)&&typeof Z.getWriter=="function"&&typeof Z.abort=="function")}function S(Z){return!!(Z&&!y(Z)&&typeof Z.readable=="object"&&typeof Z.writable=="object")}function x(Z){return w(Z)||C(Z)||S(Z)}function k(Z,ae){return Z==null?!1:ae===!0?typeof Z[t]=="function":ae===!1?typeof Z[n]=="function":typeof Z[t]=="function"||typeof Z[n]=="function"}function A(Z){if(!y(Z))return null;let ae=Z._writableState,Ae=Z._readableState,be=ae||Ae;return!!(Z.destroyed||Z[a]||be!=null&&be.destroyed)}function R(Z){if(!v(Z))return null;if(Z.writableEnded===!0)return!0;let ae=Z._writableState;return ae!=null&&ae.errored?!1:typeof ae?.ended!="boolean"?null:ae.ended}function I(Z,ae){if(!v(Z))return null;if(Z.writableFinished===!0)return!0;let Ae=Z._writableState;return Ae!=null&&Ae.errored?!1:typeof Ae?.finished!="boolean"?null:!!(Ae.finished||ae===!1&&Ae.ended===!0&&Ae.length===0)}function U(Z){if(!m(Z))return null;if(Z.readableEnded===!0)return!0;let ae=Z._readableState;return!ae||ae.errored?!1:typeof ae?.ended!="boolean"?null:ae.ended}function te(Z,ae){if(!m(Z))return null;let Ae=Z._readableState;return Ae!=null&&Ae.errored?!1:typeof Ae?.endEmitted!="boolean"?null:!!(Ae.endEmitted||ae===!1&&Ae.ended===!0&&Ae.length===0)}function G(Z){return Z&&Z[u]!=null?Z[u]:typeof Z?.readable!="boolean"?null:A(Z)?!1:m(Z)&&Z.readable&&!te(Z)}function Y(Z){return Z&&Z[c]!=null?Z[c]:typeof Z?.writable!="boolean"?null:A(Z)?!1:v(Z)&&Z.writable&&!R(Z)}function O(Z,ae){return y(Z)?A(Z)?!0:!(ae?.readable!==!1&&G(Z)||ae?.writable!==!1&&Y(Z)):null}function N(Z){var ae,Ae;return y(Z)?Z.writableErrored?Z.writableErrored:(ae=(Ae=Z._writableState)===null||Ae===void 0?void 0:Ae.errored)!==null&&ae!==void 0?ae:null:null}function Q(Z){var ae,Ae;return y(Z)?Z.readableErrored?Z.readableErrored:(ae=(Ae=Z._readableState)===null||Ae===void 0?void 0:Ae.errored)!==null&&ae!==void 0?ae:null:null}function q(Z){if(!y(Z))return null;if(typeof Z.closed=="boolean")return Z.closed;let ae=Z._writableState,Ae=Z._readableState;return typeof ae?.closed=="boolean"||typeof Ae?.closed=="boolean"?ae?.closed||Ae?.closed:typeof Z._closed=="boolean"&&ee(Z)?Z._closed:null}function ee(Z){return typeof Z._closed=="boolean"&&typeof Z._defaultKeepAlive=="boolean"&&typeof Z._removedConnection=="boolean"&&typeof Z._removedContLen=="boolean"}function ne(Z){return typeof Z._sent100=="boolean"&&ee(Z)}function B(Z){var ae;return typeof Z._consuming=="boolean"&&typeof Z._dumped=="boolean"&&((ae=Z.req)===null||ae===void 0?void 0:ae.upgradeOrConnect)===void 0}function z(Z){if(!y(Z))return null;let ae=Z._writableState,Ae=Z._readableState,be=ae||Ae;return!be&&ne(Z)||!!(be&&be.autoDestroy&&be.emitClose&&be.closed===!1)}function $(Z){var ae;return!!(Z&&((ae=Z[f])!==null&&ae!==void 0?ae:Z.readableDidRead||Z.readableAborted))}function V(Z){var ae,Ae,be,Ge,Te,ve,ke,Me,Ie,Ce;return!!(Z&&((ae=(Ae=(be=(Ge=(Te=(ve=Z[l])!==null&&ve!==void 0?ve:Z.readableErrored)!==null&&Te!==void 0?Te:Z.writableErrored)!==null&&Ge!==void 0?Ge:(ke=Z._readableState)===null||ke===void 0?void 0:ke.errorEmitted)!==null&&be!==void 0?be:(Me=Z._writableState)===null||Me===void 0?void 0:Me.errorEmitted)!==null&&Ae!==void 0?Ae:(Ie=Z._readableState)===null||Ie===void 0?void 0:Ie.errored)!==null&&ae!==void 0?ae:!((Ce=Z._writableState)===null||Ce===void 0)&&Ce.errored))}e.exports={isDestroyed:A,kIsDestroyed:a,isDisturbed:$,kIsDisturbed:f,isErrored:V,kIsErrored:l,isReadable:G,kIsReadable:u,kIsClosedPromise:d,kControllerErrorFunction:p,kIsWritable:c,isClosed:q,isDuplexNodeStream:b,isFinished:O,isIterable:k,isReadableNodeStream:m,isReadableStream:w,isReadableEnded:U,isReadableFinished:te,isReadableErrored:Q,isNodeStream:y,isWebStream:x,isWritable:Y,isWritableNodeStream:v,isWritableStream:C,isWritableEnded:R,isWritableFinished:I,isWritableErrored:N,isServerRequest:B,isServerResponse:ne,willEmitClose:z,isTransformStream:S}}),Fa=Rt((i,e)=>{_t(),Et(),St();var t=Bl(),{AbortError:n,codes:s}=Ti(),{ERR_INVALID_ARG_TYPE:a,ERR_STREAM_PREMATURE_CLOSE:l}=s,{kEmptyObject:u,once:c}=Li(),{validateAbortSignal:f,validateFunction:d,validateObject:p,validateBoolean:m}=Ju(),{Promise:v,PromisePrototypeThen:b,SymbolDispose:y}=Nr(),{isClosed:w,isReadable:C,isReadableNodeStream:S,isReadableStream:x,isReadableFinished:k,isReadableErrored:A,isWritable:R,isWritableNodeStream:I,isWritableStream:U,isWritableFinished:te,isWritableErrored:G,isNodeStream:Y,willEmitClose:O,kIsClosedPromise:N}=Bo(),Q;function q($){return $.setHeader&&typeof $.abort=="function"}var ee=()=>{};function ne($,V,Z){var ae,Ae;if(arguments.length===2?(Z=V,V=u):V==null?V=u:p(V,"options"),d(Z,"callback"),f(V.signal,"options.signal"),Z=c(Z),x($)||U($))return B($,V,Z);if(!Y($))throw new a("stream",["ReadableStream","WritableStream","Stream"],$);let be=(ae=V.readable)!==null&&ae!==void 0?ae:S($),Ge=(Ae=V.writable)!==null&&Ae!==void 0?Ae:I($),Te=$._writableState,ve=$._readableState,ke=()=>{$.writable||Ce()},Me=O($)&&S($)===be&&I($)===Ge,Ie=te($,!1),Ce=()=>{Ie=!0,$.destroyed&&(Me=!1),!(Me&&(!$.readable||be))&&(!be||ot)&&Z.call($)},ot=k($,!1),et=()=>{ot=!0,$.destroyed&&(Me=!1),!(Me&&(!$.writable||Ge))&&(!Ge||Ie)&&Z.call($)},me=ye=>{Z.call($,ye)},de=w($),Be=()=>{de=!0;let ye=G($)||A($);if(ye&&typeof ye!="boolean")return Z.call($,ye);if(be&&!ot&&S($,!0)&&!k($,!1))return Z.call($,new l);if(Ge&&!Ie&&!te($,!1))return Z.call($,new l);Z.call($)},Je=()=>{de=!0;let ye=G($)||A($);if(ye&&typeof ye!="boolean")return Z.call($,ye);Z.call($)},rt=()=>{$.req.on("finish",Ce)};q($)?($.on("complete",Ce),Me||$.on("abort",Be),$.req?rt():$.on("request",rt)):Ge&&!Te&&($.on("end",ke),$.on("close",ke)),!Me&&typeof $.aborted=="boolean"&&$.on("aborted",Be),$.on("end",et),$.on("finish",Ce),V.error!==!1&&$.on("error",me),$.on("close",Be),de?t.nextTick(Be):Te!=null&&Te.errorEmitted||ve!=null&&ve.errorEmitted?Me||t.nextTick(Je):(!be&&(!Me||C($))&&(Ie||R($)===!1)||!Ge&&(!Me||R($))&&(ot||C($)===!1)||ve&&$.req&&$.aborted)&&t.nextTick(Je);let at=()=>{Z=ee,$.removeListener("aborted",Be),$.removeListener("complete",Ce),$.removeListener("abort",Be),$.removeListener("request",rt),$.req&&$.req.removeListener("finish",Ce),$.removeListener("end",ke),$.removeListener("close",ke),$.removeListener("finish",Ce),$.removeListener("end",et),$.removeListener("error",me),$.removeListener("close",Be)};if(V.signal&&!de){let ye=()=>{let it=Z;at(),it.call($,new n(void 0,{cause:V.signal.reason}))};if(V.signal.aborted)t.nextTick(ye);else{Q=Q||Li().addAbortListener;let it=Q(V.signal,ye),Mt=Z;Z=c((...nt)=>{it[y](),Mt.apply($,nt)})}}return at}function B($,V,Z){let ae=!1,Ae=ee;if(V.signal)if(Ae=()=>{ae=!0,Z.call($,new n(void 0,{cause:V.signal.reason}))},V.signal.aborted)t.nextTick(Ae);else{Q=Q||Li().addAbortListener;let Ge=Q(V.signal,Ae),Te=Z;Z=c((...ve)=>{Ge[y](),Te.apply($,ve)})}let be=(...Ge)=>{ae||t.nextTick(()=>Z.apply($,Ge))};return b($[N].promise,be,be),ee}function z($,V){var Z;let ae=!1;return V===null&&(V=u),(Z=V)!==null&&Z!==void 0&&Z.cleanup&&(m(V.cleanup,"cleanup"),ae=V.cleanup),new v((Ae,be)=>{let Ge=ne($,V,Te=>{ae&&Ge(),Te?be(Te):Ae()})})}e.exports=ne,e.exports.finished=z}),Dc=Rt((i,e)=>{_t(),Et(),St();var t=Bl(),{aggregateTwoErrors:n,codes:{ERR_MULTIPLE_CALLBACK:s},AbortError:a}=Ti(),{Symbol:l}=Nr(),{kIsDestroyed:u,isDestroyed:c,isFinished:f,isServerRequest:d}=Bo(),p=l("kDestroy"),m=l("kConstruct");function v(O,N,Q){O&&(O.stack,N&&!N.errored&&(N.errored=O),Q&&!Q.errored&&(Q.errored=O))}function b(O,N){let Q=this._readableState,q=this._writableState,ee=q||Q;return q!=null&&q.destroyed||Q!=null&&Q.destroyed?(typeof N=="function"&&N(),this):(v(O,q,Q),q&&(q.destroyed=!0),Q&&(Q.destroyed=!0),ee.constructed?y(this,O,N):this.once(p,function(ne){y(this,n(ne,O),N)}),this)}function y(O,N,Q){let q=!1;function ee(ne){if(q)return;q=!0;let B=O._readableState,z=O._writableState;v(ne,z,B),z&&(z.closed=!0),B&&(B.closed=!0),typeof Q=="function"&&Q(ne),ne?t.nextTick(w,O,ne):t.nextTick(C,O)}try{O._destroy(N||null,ee)}catch(ne){ee(ne)}}function w(O,N){S(O,N),C(O)}function C(O){let N=O._readableState,Q=O._writableState;Q&&(Q.closeEmitted=!0),N&&(N.closeEmitted=!0),(Q!=null&&Q.emitClose||N!=null&&N.emitClose)&&O.emit("close")}function S(O,N){let Q=O._readableState,q=O._writableState;q!=null&&q.errorEmitted||Q!=null&&Q.errorEmitted||(q&&(q.errorEmitted=!0),Q&&(Q.errorEmitted=!0),O.emit("error",N))}function x(){let O=this._readableState,N=this._writableState;O&&(O.constructed=!0,O.closed=!1,O.closeEmitted=!1,O.destroyed=!1,O.errored=null,O.errorEmitted=!1,O.reading=!1,O.ended=O.readable===!1,O.endEmitted=O.readable===!1),N&&(N.constructed=!0,N.destroyed=!1,N.closed=!1,N.closeEmitted=!1,N.errored=null,N.errorEmitted=!1,N.finalCalled=!1,N.prefinished=!1,N.ended=N.writable===!1,N.ending=N.writable===!1,N.finished=N.writable===!1)}function k(O,N,Q){let q=O._readableState,ee=O._writableState;if(ee!=null&&ee.destroyed||q!=null&&q.destroyed)return this;q!=null&&q.autoDestroy||ee!=null&&ee.autoDestroy?O.destroy(N):N&&(N.stack,ee&&!ee.errored&&(ee.errored=N),q&&!q.errored&&(q.errored=N),Q?t.nextTick(S,O,N):S(O,N))}function A(O,N){if(typeof O._construct!="function")return;let Q=O._readableState,q=O._writableState;Q&&(Q.constructed=!1),q&&(q.constructed=!1),O.once(m,N),!(O.listenerCount(m)>1)&&t.nextTick(R,O)}function R(O){let N=!1;function Q(q){if(N){k(O,q??new s);return}N=!0;let ee=O._readableState,ne=O._writableState,B=ne||ee;ee&&(ee.constructed=!0),ne&&(ne.constructed=!0),B.destroyed?O.emit(p,q):q?k(O,q,!0):t.nextTick(I,O)}try{O._construct(q=>{t.nextTick(Q,q)})}catch(q){t.nextTick(Q,q)}}function I(O){O.emit(m)}function U(O){return O?.setHeader&&typeof O.abort=="function"}function te(O){O.emit("close")}function G(O,N){O.emit("error",N),t.nextTick(te,O)}function Y(O,N){!O||c(O)||(!N&&!f(O)&&(N=new a),d(O)?(O.socket=null,O.destroy(N)):U(O)?O.abort():U(O.req)?O.req.abort():typeof O.destroy=="function"?O.destroy(N):typeof O.close=="function"?O.close():N?t.nextTick(G,O,N):t.nextTick(te,O),O.destroyed||(O[u]=!0))}e.exports={construct:A,destroyer:Y,destroy:b,undestroy:x,errorOrDestroy:k}}),ob=Rt((i,e)=>{_t(),Et(),St();var{ArrayIsArray:t,ObjectSetPrototypeOf:n}=Nr(),{EventEmitter:s}=(Nl(),dr(qa));function a(u){s.call(this,u)}n(a.prototype,s.prototype),n(a,s),a.prototype.pipe=function(u,c){let f=this;function d(C){u.writable&&u.write(C)===!1&&f.pause&&f.pause()}f.on("data",d);function p(){f.readable&&f.resume&&f.resume()}u.on("drain",p),!u._isStdio&&(!c||c.end!==!1)&&(f.on("end",v),f.on("close",b));let m=!1;function v(){m||(m=!0,u.end())}function b(){m||(m=!0,typeof u.destroy=="function"&&u.destroy())}function y(C){w(),s.listenerCount(this,"error")===0&&this.emit("error",C)}l(f,"error",y),l(u,"error",y);function w(){f.removeListener("data",d),u.removeListener("drain",p),f.removeListener("end",v),f.removeListener("close",b),f.removeListener("error",y),u.removeListener("error",y),f.removeListener("end",w),f.removeListener("close",w),u.removeListener("close",w)}return f.on("end",w),f.on("close",w),u.on("close",w),u.emit("pipe",f),u};function l(u,c,f){if(typeof u.prependListener=="function")return u.prependListener(c,f);!u._events||!u._events[c]?u.on(c,f):t(u._events[c])?u._events[c].unshift(f):u._events[c]=[f,u._events[c]]}e.exports={Stream:a,prependListener:l}}),bd=Rt((i,e)=>{_t(),Et(),St();var{SymbolDispose:t}=Nr(),{AbortError:n,codes:s}=Ti(),{isNodeStream:a,isWebStream:l,kControllerErrorFunction:u}=Bo(),c=Fa(),{ERR_INVALID_ARG_TYPE:f}=s,d,p=(m,v)=>{if(typeof m!="object"||!("aborted"in m))throw new f(v,"AbortSignal",m)};e.exports.addAbortSignal=function(m,v){if(p(m,"signal"),!a(v)&&!l(v))throw new f("stream",["ReadableStream","WritableStream","Stream"],v);return e.exports.addAbortSignalNoValidate(m,v)},e.exports.addAbortSignalNoValidate=function(m,v){if(typeof m!="object"||!("aborted"in m))return v;let b=a(v)?()=>{v.destroy(new n(void 0,{cause:m.reason}))}:()=>{v[u](new n(void 0,{cause:m.reason}))};if(m.aborted)b();else{d=d||Li().addAbortListener;let y=d(m,b);c(v,y[t])}return v}}),A6=Rt((i,e)=>{_t(),Et(),St();var{StringPrototypeSlice:t,SymbolIterator:n,TypedArrayPrototypeSet:s,Uint8Array:a}=Nr(),{Buffer:l}=(ni(),dr(ti)),{inspect:u}=Li();e.exports=class{constructor(){this.head=null,this.tail=null,this.length=0}push(c){let f={data:c,next:null};this.length>0?this.tail.next=f:this.head=f,this.tail=f,++this.length}unshift(c){let f={data:c,next:this.head};this.length===0&&(this.tail=f),this.head=f,++this.length}shift(){if(this.length===0)return;let c=this.head.data;return this.length===1?this.head=this.tail=null:this.head=this.head.next,--this.length,c}clear(){this.head=this.tail=null,this.length=0}join(c){if(this.length===0)return"";let f=this.head,d=""+f.data;for(;(f=f.next)!==null;)d+=c+f.data;return d}concat(c){if(this.length===0)return l.alloc(0);let f=l.allocUnsafe(c>>>0),d=this.head,p=0;for(;d;)s(f,d.data,p),p+=d.data.length,d=d.next;return f}consume(c,f){let d=this.head.data;if(c<d.length){let p=d.slice(0,c);return this.head.data=d.slice(c),p}return c===d.length?this.shift():f?this._getString(c):this._getBuffer(c)}first(){return this.head.data}*[n](){for(let c=this.head;c;c=c.next)yield c.data}_getString(c){let f="",d=this.head,p=0;do{let m=d.data;if(c>m.length)f+=m,c-=m.length;else{c===m.length?(f+=m,++p,d.next?this.head=d.next:this.head=this.tail=null):(f+=t(m,0,c),this.head=d,d.data=t(m,c));break}++p}while((d=d.next)!==null);return this.length-=p,f}_getBuffer(c){let f=l.allocUnsafe(c),d=c,p=this.head,m=0;do{let v=p.data;if(c>v.length)s(f,v,d-c),c-=v.length;else{c===v.length?(s(f,v,d-c),++m,p.next?this.head=p.next:this.head=this.tail=null):(s(f,new a(v.buffer,v.byteOffset,c),d-c),this.head=p,p.data=v.slice(c));break}++m}while((p=p.next)!==null);return this.length-=m,f}[Symbol.for("nodejs.util.inspect.custom")](c,f){return u(this,{...f,depth:0,customInspect:!1})}}}),vd=Rt((i,e)=>{_t(),Et(),St();var{MathFloor:t,NumberIsInteger:n}=Nr(),{validateInteger:s}=Ju(),{ERR_INVALID_ARG_VALUE:a}=Ti().codes,l=16*1024,u=16;function c(m,v,b){return m.highWaterMark!=null?m.highWaterMark:v?m[b]:null}function f(m){return m?u:l}function d(m,v){s(v,"value",0),m?u=v:l=v}function p(m,v,b,y){let w=c(v,y,b);if(w!=null){if(!n(w)||w<0){let C=y?`options.${b}`:"options.highWaterMark";throw new a(C,w)}return t(w)}return f(m.objectMode)}e.exports={getHighWaterMark:p,getDefaultHighWaterMark:f,setDefaultHighWaterMark:d}}),k6=Rt((i,e)=>{_t(),Et(),St();var t=(ni(),dr(ti)),n=t.Buffer;function s(l,u){for(var c in l)u[c]=l[c]}n.from&&n.alloc&&n.allocUnsafe&&n.allocUnsafeSlow?e.exports=t:(s(t,i),i.Buffer=a);function a(l,u,c){return n(l,u,c)}a.prototype=Object.create(n.prototype),s(n,a),a.from=function(l,u,c){if(typeof l=="number")throw new TypeError("Argument must not be a number");return n(l,u,c)},a.alloc=function(l,u,c){if(typeof l!="number")throw new TypeError("Argument must be a number");var f=n(l);return u!==void 0?typeof c=="string"?f.fill(u,c):f.fill(u):f.fill(0),f},a.allocUnsafe=function(l){if(typeof l!="number")throw new TypeError("Argument must be a number");return n(l)},a.allocUnsafeSlow=function(l){if(typeof l!="number")throw new TypeError("Argument must be a number");return t.SlowBuffer(l)}}),T6=Rt(i=>{_t(),Et(),St();var e=k6().Buffer,t=e.isEncoding||function(S){switch(S=""+S,S&&S.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function n(S){if(!S)return"utf8";for(var x;;)switch(S){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return S;default:if(x)return;S=(""+S).toLowerCase(),x=!0}}function s(S){var x=n(S);if(typeof x!="string"&&(e.isEncoding===t||!t(S)))throw new Error("Unknown encoding: "+S);return x||S}i.StringDecoder=a;function a(S){this.encoding=s(S);var x;switch(this.encoding){case"utf16le":this.text=m,this.end=v,x=4;break;case"utf8":this.fillLast=f,x=4;break;case"base64":this.text=b,this.end=y,x=3;break;default:this.write=w,this.end=C;return}this.lastNeed=0,this.lastTotal=0,this.lastChar=e.allocUnsafe(x)}a.prototype.write=function(S){if(S.length===0)return"";var x,k;if(this.lastNeed){if(x=this.fillLast(S),x===void 0)return"";k=this.lastNeed,this.lastNeed=0}else k=0;return k<S.length?x?x+this.text(S,k):this.text(S,k):x||""},a.prototype.end=p,a.prototype.text=d,a.prototype.fillLast=function(S){if(this.lastNeed<=S.length)return S.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);S.copy(this.lastChar,this.lastTotal-this.lastNeed,0,S.length),this.lastNeed-=S.length};function l(S){return S<=127?0:S>>5===6?2:S>>4===14?3:S>>3===30?4:S>>6===2?-1:-2}function u(S,x,k){var A=x.length-1;if(A<k)return 0;var R=l(x[A]);return R>=0?(R>0&&(S.lastNeed=R-1),R):--A<k||R===-2?0:(R=l(x[A]),R>=0?(R>0&&(S.lastNeed=R-2),R):--A<k||R===-2?0:(R=l(x[A]),R>=0?(R>0&&(R===2?R=0:S.lastNeed=R-3),R):0))}function c(S,x,k){if((x[0]&192)!==128)return S.lastNeed=0,"";if(S.lastNeed>1&&x.length>1){if((x[1]&192)!==128)return S.lastNeed=1,"";if(S.lastNeed>2&&x.length>2&&(x[2]&192)!==128)return S.lastNeed=2,""}}function f(S){var x=this.lastTotal-this.lastNeed,k=c(this,S);if(k!==void 0)return k;if(this.lastNeed<=S.length)return S.copy(this.lastChar,x,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);S.copy(this.lastChar,x,0,S.length),this.lastNeed-=S.length}function d(S,x){var k=u(this,S,x);if(!this.lastNeed)return S.toString("utf8",x);this.lastTotal=k;var A=S.length-(k-this.lastNeed);return S.copy(this.lastChar,0,A),S.toString("utf8",x,A)}function p(S){var x=S&&S.length?this.write(S):"";return this.lastNeed?x+"":x}function m(S,x){if((S.length-x)%2===0){var k=S.toString("utf16le",x);if(k){var A=k.charCodeAt(k.length-1);if(A>=55296&&A<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=S[S.length-2],this.lastChar[1]=S[S.length-1],k.slice(0,-1)}return k}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=S[S.length-1],S.toString("utf16le",x,S.length-1)}function v(S){var x=S&&S.length?this.write(S):"";if(this.lastNeed){var k=this.lastTotal-this.lastNeed;return x+this.lastChar.toString("utf16le",0,k)}return x}function b(S,x){var k=(S.length-x)%3;return k===0?S.toString("base64",x):(this.lastNeed=3-k,this.lastTotal=3,k===1?this.lastChar[0]=S[S.length-1]:(this.lastChar[0]=S[S.length-2],this.lastChar[1]=S[S.length-1]),S.toString("base64",x,S.length-k))}function y(S){var x=S&&S.length?this.write(S):"";return this.lastNeed?x+this.lastChar.toString("base64",0,3-this.lastNeed):x}function w(S){return S.toString(this.encoding)}function C(S){return S&&S.length?this.write(S):""}}),dE=Rt((i,e)=>{_t(),Et(),St();var t=Bl(),{PromisePrototypeThen:n,SymbolAsyncIterator:s,SymbolIterator:a}=Nr(),{Buffer:l}=(ni(),dr(ti)),{ERR_INVALID_ARG_TYPE:u,ERR_STREAM_NULL_VALUES:c}=Ti().codes;function f(d,p,m){let v;if(typeof p=="string"||p instanceof l)return new d({objectMode:!0,...m,read(){this.push(p),this.push(null)}});let b;if(p&&p[s])b=!0,v=p[s]();else if(p&&p[a])b=!1,v=p[a]();else throw new u("iterable",["Iterable"],p);let y=new d({objectMode:!0,highWaterMark:1,...m}),w=!1;y._read=function(){w||(w=!0,S())},y._destroy=function(x,k){n(C(x),()=>t.nextTick(k,x),A=>t.nextTick(k,A||x))};async function C(x){let k=x!=null,A=typeof v.throw=="function";if(k&&A){let{value:R,done:I}=await v.throw(x);if(await R,I)return}if(typeof v.return=="function"){let{value:R}=await v.return();await R}}async function S(){for(;;){try{let{value:x,done:k}=b?await v.next():v.next();if(k)y.push(null);else{let A=x&&typeof x.then=="function"?await x:x;if(A===null)throw w=!1,new c;if(y.push(A))continue;w=!1}}catch(x){y.destroy(x)}break}}return y}e.exports=f}),wd=Rt((i,e)=>{_t(),Et(),St();var t=Bl(),{ArrayPrototypeIndexOf:n,NumberIsInteger:s,NumberIsNaN:a,NumberParseInt:l,ObjectDefineProperties:u,ObjectKeys:c,ObjectSetPrototypeOf:f,Promise:d,SafeSet:p,SymbolAsyncDispose:m,SymbolAsyncIterator:v,Symbol:b}=Nr();e.exports=nt,nt.ReadableState=Mt;var{EventEmitter:y}=(Nl(),dr(qa)),{Stream:w,prependListener:C}=ob(),{Buffer:S}=(ni(),dr(ti)),{addAbortSignal:x}=bd(),k=Fa(),A=Li().debuglog("stream",fe=>{A=fe}),R=A6(),I=Dc(),{getHighWaterMark:U,getDefaultHighWaterMark:te}=vd(),{aggregateTwoErrors:G,codes:{ERR_INVALID_ARG_TYPE:Y,ERR_METHOD_NOT_IMPLEMENTED:O,ERR_OUT_OF_RANGE:N,ERR_STREAM_PUSH_AFTER_EOF:Q,ERR_STREAM_UNSHIFT_AFTER_END_EVENT:q},AbortError:ee}=Ti(),{validateObject:ne}=Ju(),B=b("kPaused"),{StringDecoder:z}=T6(),$=dE();f(nt.prototype,w.prototype),f(nt,w);var V=()=>{},{errorOrDestroy:Z}=I,ae=1,Ae=2,be=4,Ge=8,Te=16,ve=32,ke=64,Me=128,Ie=256,Ce=512,ot=1024,et=2048,me=4096,de=8192,Be=16384,Je=32768,rt=65536,at=1<<17,ye=1<<18;function it(fe){return{enumerable:!1,get(){return(this.state&fe)!==0},set(we){we?this.state|=fe:this.state&=~fe}}}u(Mt.prototype,{objectMode:it(ae),ended:it(Ae),endEmitted:it(be),reading:it(Ge),constructed:it(Te),sync:it(ve),needReadable:it(ke),emittedReadable:it(Me),readableListening:it(Ie),resumeScheduled:it(Ce),errorEmitted:it(ot),emitClose:it(et),autoDestroy:it(me),destroyed:it(de),closed:it(Be),closeEmitted:it(Je),multiAwaitDrain:it(rt),readingMore:it(at),dataEmitted:it(ye)});function Mt(fe,we,pt){typeof pt!="boolean"&&(pt=we instanceof Io()),this.state=et|me|Te|ve,fe&&fe.objectMode&&(this.state|=ae),pt&&fe&&fe.readableObjectMode&&(this.state|=ae),this.highWaterMark=fe?U(this,fe,"readableHighWaterMark",pt):te(!1),this.buffer=new R,this.length=0,this.pipes=[],this.flowing=null,this[B]=null,fe&&fe.emitClose===!1&&(this.state&=~et),fe&&fe.autoDestroy===!1&&(this.state&=~me),this.errored=null,this.defaultEncoding=fe&&fe.defaultEncoding||"utf8",this.awaitDrainWriters=null,this.decoder=null,this.encoding=null,fe&&fe.encoding&&(this.decoder=new z(fe.encoding),this.encoding=fe.encoding)}function nt(fe){if(!(this instanceof nt))return new nt(fe);let we=this instanceof Io();this._readableState=new Mt(fe,this,we),fe&&(typeof fe.read=="function"&&(this._read=fe.read),typeof fe.destroy=="function"&&(this._destroy=fe.destroy),typeof fe.construct=="function"&&(this._construct=fe.construct),fe.signal&&!we&&x(fe.signal,this)),w.call(this,fe),I.construct(this,()=>{this._readableState.needReadable&&Le(this,this._readableState)})}nt.prototype.destroy=I.destroy,nt.prototype._undestroy=I.undestroy,nt.prototype._destroy=function(fe,we){we(fe)},nt.prototype[y.captureRejectionSymbol]=function(fe){this.destroy(fe)},nt.prototype[m]=function(){let fe;return this.destroyed||(fe=this.readableEnded?null:new ee,this.destroy(fe)),new d((we,pt)=>k(this,At=>At&&At!==fe?pt(At):we(null)))},nt.prototype.push=function(fe,we){return Zt(this,fe,we,!1)},nt.prototype.unshift=function(fe,we){return Zt(this,fe,we,!0)};function Zt(fe,we,pt,At){A("readableAddChunk",we);let K=fe._readableState,oe;if((K.state&ae)===0&&(typeof we=="string"?(pt=pt||K.defaultEncoding,K.encoding!==pt&&(At&&K.encoding?we=S.from(we,pt).toString(K.encoding):(we=S.from(we,pt),pt=""))):we instanceof S?pt="":w._isUint8Array(we)?(we=w._uint8ArrayToBuffer(we),pt=""):we!=null&&(oe=new Y("chunk",["string","Buffer","Uint8Array"],we))),oe)Z(fe,oe);else if(we===null)K.state&=~Ge,Ke(fe,K);else if((K.state&ae)!==0||we&&we.length>0)if(At)if((K.state&be)!==0)Z(fe,new q);else{if(K.destroyed||K.errored)return!1;j(fe,K,we,!0)}else if(K.ended)Z(fe,new Q);else{if(K.destroyed||K.errored)return!1;K.state&=~Ge,K.decoder&&!pt?(we=K.decoder.write(we),K.objectMode||we.length!==0?j(fe,K,we,!1):Le(fe,K)):j(fe,K,we,!1)}else At||(K.state&=~Ge,Le(fe,K));return!K.ended&&(K.length<K.highWaterMark||K.length===0)}function j(fe,we,pt,At){we.flowing&&we.length===0&&!we.sync&&fe.listenerCount("data")>0?((we.state&rt)!==0?we.awaitDrainWriters.clear():we.awaitDrainWriters=null,we.dataEmitted=!0,fe.emit("data",pt)):(we.length+=we.objectMode?1:pt.length,At?we.buffer.unshift(pt):we.buffer.push(pt),(we.state&ke)!==0&&gt(fe)),Le(fe,we)}nt.prototype.isPaused=function(){let fe=this._readableState;return fe[B]===!0||fe.flowing===!1},nt.prototype.setEncoding=function(fe){let we=new z(fe);this._readableState.decoder=we,this._readableState.encoding=this._readableState.decoder.encoding;let pt=this._readableState.buffer,At="";for(let K of pt)At+=we.write(K);return pt.clear(),At!==""&&pt.push(At),this._readableState.length=At.length,this};var W=1073741824;function se(fe){if(fe>W)throw new N("size","<= 1GiB",fe);return fe--,fe|=fe>>>1,fe|=fe>>>2,fe|=fe>>>4,fe|=fe>>>8,fe|=fe>>>16,fe++,fe}function Oe(fe,we){return fe<=0||we.length===0&&we.ended?0:(we.state&ae)!==0?1:a(fe)?we.flowing&&we.length?we.buffer.first().length:we.length:fe<=we.length?fe:we.ended?we.length:0}nt.prototype.read=function(fe){A("read",fe),fe===void 0?fe=NaN:s(fe)||(fe=l(fe,10));let we=this._readableState,pt=fe;if(fe>we.highWaterMark&&(we.highWaterMark=se(fe)),fe!==0&&(we.state&=~Me),fe===0&&we.needReadable&&((we.highWaterMark!==0?we.length>=we.highWaterMark:we.length>0)||we.ended))return A("read: emitReadable",we.length,we.ended),we.length===0&&we.ended?Zn(this):gt(this),null;if(fe=Oe(fe,we),fe===0&&we.ended)return we.length===0&&Zn(this),null;let At=(we.state&ke)!==0;if(A("need readable",At),(we.length===0||we.length-fe<we.highWaterMark)&&(At=!0,A("length less than watermark",At)),we.ended||we.reading||we.destroyed||we.errored||!we.constructed)At=!1,A("reading, ended or constructing",At);else if(At){A("do read"),we.state|=Ge|ve,we.length===0&&(we.state|=ke);try{this._read(we.highWaterMark)}catch(oe){Z(this,oe)}we.state&=~ve,we.reading||(fe=Oe(pt,we))}let K;return fe>0?K=_r(fe,we):K=null,K===null?(we.needReadable=we.length<=we.highWaterMark,fe=0):(we.length-=fe,we.multiAwaitDrain?we.awaitDrainWriters.clear():we.awaitDrainWriters=null),we.length===0&&(we.ended||(we.needReadable=!0),pt!==fe&&we.ended&&Zn(this)),K!==null&&!we.errorEmitted&&!we.closeEmitted&&(we.dataEmitted=!0,this.emit("data",K)),K};function Ke(fe,we){if(A("onEofChunk"),!we.ended){if(we.decoder){let pt=we.decoder.end();pt&&pt.length&&(we.buffer.push(pt),we.length+=we.objectMode?1:pt.length)}we.ended=!0,we.sync?gt(fe):(we.needReadable=!1,we.emittedReadable=!0,Ut(fe))}}function gt(fe){let we=fe._readableState;A("emitReadable",we.needReadable,we.emittedReadable),we.needReadable=!1,we.emittedReadable||(A("emitReadable",we.flowing),we.emittedReadable=!0,t.nextTick(Ut,fe))}function Ut(fe){let we=fe._readableState;A("emitReadable_",we.destroyed,we.length,we.ended),!we.destroyed&&!we.errored&&(we.length||we.ended)&&(fe.emit("readable"),we.emittedReadable=!1),we.needReadable=!we.flowing&&!we.ended&&we.length<=we.highWaterMark,Ft(fe)}function Le(fe,we){!we.readingMore&&we.constructed&&(we.readingMore=!0,t.nextTick(Xe,fe,we))}function Xe(fe,we){for(;!we.reading&&!we.ended&&(we.length<we.highWaterMark||we.flowing&&we.length===0);){let pt=we.length;if(A("maybeReadMore read 0"),fe.read(0),pt===we.length)break}we.readingMore=!1}nt.prototype._read=function(fe){throw new O("_read()")},nt.prototype.pipe=function(fe,we){let pt=this,At=this._readableState;At.pipes.length===1&&(At.multiAwaitDrain||(At.multiAwaitDrain=!0,At.awaitDrainWriters=new p(At.awaitDrainWriters?[At.awaitDrainWriters]:[]))),At.pipes.push(fe),A("pipe count=%d opts=%j",At.pipes.length,we);let K=(!we||we.end!==!1)&&fe!==t.stdout&&fe!==t.stderr?ce:vn;At.endEmitted?t.nextTick(K):pt.once("end",K),fe.on("unpipe",oe);function oe($t,sn){A("onunpipe"),$t===pt&&sn&&sn.hasUnpiped===!1&&(sn.hasUnpiped=!0,$e())}function ce(){A("onend"),fe.end()}let D,ge=!1;function $e(){A("cleanup"),fe.removeListener("close",Yt),fe.removeListener("finish",Kt),D&&fe.removeListener("drain",D),fe.removeListener("error",Nt),fe.removeListener("unpipe",oe),pt.removeListener("end",ce),pt.removeListener("end",vn),pt.removeListener("data",vt),ge=!0,D&&At.awaitDrainWriters&&(!fe._writableState||fe._writableState.needDrain)&&D()}function ze(){ge||(At.pipes.length===1&&At.pipes[0]===fe?(A("false write response, pause",0),At.awaitDrainWriters=fe,At.multiAwaitDrain=!1):At.pipes.length>1&&At.pipes.includes(fe)&&(A("false write response, pause",At.awaitDrainWriters.size),At.awaitDrainWriters.add(fe)),pt.pause()),D||(D=zt(pt,fe),fe.on("drain",D))}pt.on("data",vt);function vt($t){A("ondata");let sn=fe.write($t);A("dest.write",sn),sn===!1&&ze()}function Nt($t){if(A("onerror",$t),vn(),fe.removeListener("error",Nt),fe.listenerCount("error")===0){let sn=fe._writableState||fe._readableState;sn&&!sn.errorEmitted?Z(fe,$t):fe.emit("error",$t)}}C(fe,"error",Nt);function Yt(){fe.removeListener("finish",Kt),vn()}fe.once("close",Yt);function Kt(){A("onfinish"),fe.removeListener("close",Yt),vn()}fe.once("finish",Kt);function vn(){A("unpipe"),pt.unpipe(fe)}return fe.emit("pipe",pt),fe.writableNeedDrain===!0?ze():At.flowing||(A("pipe resume"),pt.resume()),fe};function zt(fe,we){return function(){let pt=fe._readableState;pt.awaitDrainWriters===we?(A("pipeOnDrain",1),pt.awaitDrainWriters=null):pt.multiAwaitDrain&&(A("pipeOnDrain",pt.awaitDrainWriters.size),pt.awaitDrainWriters.delete(we)),(!pt.awaitDrainWriters||pt.awaitDrainWriters.size===0)&&fe.listenerCount("data")&&fe.resume()}}nt.prototype.unpipe=function(fe){let we=this._readableState,pt={hasUnpiped:!1};if(we.pipes.length===0)return this;if(!fe){let K=we.pipes;we.pipes=[],this.pause();for(let oe=0;oe<K.length;oe++)K[oe].emit("unpipe",this,{hasUnpiped:!1});return this}let At=n(we.pipes,fe);return At===-1?this:(we.pipes.splice(At,1),we.pipes.length===0&&this.pause(),fe.emit("unpipe",this,pt),this)},nt.prototype.on=function(fe,we){let pt=w.prototype.on.call(this,fe,we),At=this._readableState;return fe==="data"?(At.readableListening=this.listenerCount("readable")>0,At.flowing!==!1&&this.resume()):fe==="readable"&&!At.endEmitted&&!At.readableListening&&(At.readableListening=At.needReadable=!0,At.flowing=!1,At.emittedReadable=!1,A("on readable",At.length,At.reading),At.length?gt(this):At.reading||t.nextTick(an,this)),pt},nt.prototype.addListener=nt.prototype.on,nt.prototype.removeListener=function(fe,we){let pt=w.prototype.removeListener.call(this,fe,we);return fe==="readable"&&t.nextTick(mt,this),pt},nt.prototype.off=nt.prototype.removeListener,nt.prototype.removeAllListeners=function(fe){let we=w.prototype.removeAllListeners.apply(this,arguments);return(fe==="readable"||fe===void 0)&&t.nextTick(mt,this),we};function mt(fe){let we=fe._readableState;we.readableListening=fe.listenerCount("readable")>0,we.resumeScheduled&&we[B]===!1?we.flowing=!0:fe.listenerCount("data")>0?fe.resume():we.readableListening||(we.flowing=null)}function an(fe){A("readable nexttick read 0"),fe.read(0)}nt.prototype.resume=function(){let fe=this._readableState;return fe.flowing||(A("resume"),fe.flowing=!fe.readableListening,hn(this,fe)),fe[B]=!1,this};function hn(fe,we){we.resumeScheduled||(we.resumeScheduled=!0,t.nextTick(pr,fe,we))}function pr(fe,we){A("resume",we.reading),we.reading||fe.read(0),we.resumeScheduled=!1,fe.emit("resume"),Ft(fe),we.flowing&&!we.reading&&fe.read(0)}nt.prototype.pause=function(){return A("call pause flowing=%j",this._readableState.flowing),this._readableState.flowing!==!1&&(A("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState[B]=!0,this};function Ft(fe){let we=fe._readableState;for(A("flow",we.flowing);we.flowing&&fe.read()!==null;);}nt.prototype.wrap=function(fe){let we=!1;fe.on("data",At=>{!this.push(At)&&fe.pause&&(we=!0,fe.pause())}),fe.on("end",()=>{this.push(null)}),fe.on("error",At=>{Z(this,At)}),fe.on("close",()=>{this.destroy()}),fe.on("destroy",()=>{this.destroy()}),this._read=()=>{we&&fe.resume&&(we=!1,fe.resume())};let pt=c(fe);for(let At=1;At<pt.length;At++){let K=pt[At];this[K]===void 0&&typeof fe[K]=="function"&&(this[K]=fe[K].bind(fe))}return this},nt.prototype[v]=function(){return Bn(this)},nt.prototype.iterator=function(fe){return fe!==void 0&&ne(fe,"options"),Bn(this,fe)};function Bn(fe,we){typeof fe.read!="function"&&(fe=nt.wrap(fe,{objectMode:!0}));let pt=xr(fe,we);return pt.stream=fe,pt}async function*xr(fe,we){let pt=V;function At(ce){this===fe?(pt(),pt=V):pt=ce}fe.on("readable",At);let K,oe=k(fe,{writable:!1},ce=>{K=ce?G(K,ce):null,pt(),pt=V});try{for(;;){let ce=fe.destroyed?null:fe.read();if(ce!==null)yield ce;else{if(K)throw K;if(K===null)return;await new d(At)}}}catch(ce){throw K=G(K,ce),K}finally{(K||we?.destroyOnReturn!==!1)&&(K===void 0||fe._readableState.autoDestroy)?I.destroyer(fe,null):(fe.off("readable",At),oe())}}u(nt.prototype,{readable:{__proto__:null,get(){let fe=this._readableState;return!!fe&&fe.readable!==!1&&!fe.destroyed&&!fe.errorEmitted&&!fe.endEmitted},set(fe){this._readableState&&(this._readableState.readable=!!fe)}},readableDidRead:{__proto__:null,enumerable:!1,get:function(){return this._readableState.dataEmitted}},readableAborted:{__proto__:null,enumerable:!1,get:function(){return!!(this._readableState.readable!==!1&&(this._readableState.destroyed||this._readableState.errored)&&!this._readableState.endEmitted)}},readableHighWaterMark:{__proto__:null,enumerable:!1,get:function(){return this._readableState.highWaterMark}},readableBuffer:{__proto__:null,enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}},readableFlowing:{__proto__:null,enumerable:!1,get:function(){return this._readableState.flowing},set:function(fe){this._readableState&&(this._readableState.flowing=fe)}},readableLength:{__proto__:null,enumerable:!1,get(){return this._readableState.length}},readableObjectMode:{__proto__:null,enumerable:!1,get(){return this._readableState?this._readableState.objectMode:!1}},readableEncoding:{__proto__:null,enumerable:!1,get(){return this._readableState?this._readableState.encoding:null}},errored:{__proto__:null,enumerable:!1,get(){return this._readableState?this._readableState.errored:null}},closed:{__proto__:null,get(){return this._readableState?this._readableState.closed:!1}},destroyed:{__proto__:null,enumerable:!1,get(){return this._readableState?this._readableState.destroyed:!1},set(fe){this._readableState&&(this._readableState.destroyed=fe)}},readableEnded:{__proto__:null,enumerable:!1,get(){return this._readableState?this._readableState.endEmitted:!1}}}),u(Mt.prototype,{pipesCount:{__proto__:null,get(){return this.pipes.length}},paused:{__proto__:null,get(){return this[B]!==!1},set(fe){this[B]=!!fe}}}),nt._fromList=_r;function _r(fe,we){if(we.length===0)return null;let pt;return we.objectMode?pt=we.buffer.shift():!fe||fe>=we.length?(we.decoder?pt=we.buffer.join(""):we.buffer.length===1?pt=we.buffer.first():pt=we.buffer.concat(we.length),we.buffer.clear()):pt=we.buffer.consume(fe,we.decoder),pt}function Zn(fe){let we=fe._readableState;A("endReadable",we.endEmitted),we.endEmitted||(we.ended=!0,t.nextTick(Ht,we,fe))}function Ht(fe,we){if(A("endReadableNT",fe.endEmitted,fe.length),!fe.errored&&!fe.closeEmitted&&!fe.endEmitted&&fe.length===0){if(fe.endEmitted=!0,we.emit("end"),we.writable&&we.allowHalfOpen===!1)t.nextTick(pe,we);else if(fe.autoDestroy){let pt=we._writableState;(!pt||pt.autoDestroy&&(pt.finished||pt.writable===!1))&&we.destroy()}}}function pe(fe){fe.writable&&!fe.writableEnded&&!fe.destroyed&&fe.end()}nt.from=function(fe,we){return $(nt,fe,we)};var Ot;function qt(){return Ot===void 0&&(Ot={}),Ot}nt.fromWeb=function(fe,we){return qt().newStreamReadableFromReadableStream(fe,we)},nt.toWeb=function(fe,we){return qt().newReadableStreamFromStreamReadable(fe,we)},nt.wrap=function(fe,we){var pt,At;return new nt({objectMode:(pt=(At=fe.readableObjectMode)!==null&&At!==void 0?At:fe.objectMode)!==null&&pt!==void 0?pt:!0,...we,destroy(K,oe){I.destroyer(fe,K),oe(K)}}).wrap(fe)}}),ab=Rt((i,e)=>{_t(),Et(),St();var t=Bl(),{ArrayPrototypeSlice:n,Error:s,FunctionPrototypeSymbolHasInstance:a,ObjectDefineProperty:l,ObjectDefineProperties:u,ObjectSetPrototypeOf:c,StringPrototypeToLowerCase:f,Symbol:d,SymbolHasInstance:p}=Nr();e.exports=ne,ne.WritableState=q;var{EventEmitter:m}=(Nl(),dr(qa)),v=ob().Stream,{Buffer:b}=(ni(),dr(ti)),y=Dc(),{addAbortSignal:w}=bd(),{getHighWaterMark:C,getDefaultHighWaterMark:S}=vd(),{ERR_INVALID_ARG_TYPE:x,ERR_METHOD_NOT_IMPLEMENTED:k,ERR_MULTIPLE_CALLBACK:A,ERR_STREAM_CANNOT_PIPE:R,ERR_STREAM_DESTROYED:I,ERR_STREAM_ALREADY_FINISHED:U,ERR_STREAM_NULL_VALUES:te,ERR_STREAM_WRITE_AFTER_END:G,ERR_UNKNOWN_ENCODING:Y}=Ti().codes,{errorOrDestroy:O}=y;c(ne.prototype,v.prototype),c(ne,v);function N(){}var Q=d("kOnFinished");function q(me,de,Be){typeof Be!="boolean"&&(Be=de instanceof Io()),this.objectMode=!!(me&&me.objectMode),Be&&(this.objectMode=this.objectMode||!!(me&&me.writableObjectMode)),this.highWaterMark=me?C(this,me,"writableHighWaterMark",Be):S(!1),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;let Je=!!(me&&me.decodeStrings===!1);this.decodeStrings=!Je,this.defaultEncoding=me&&me.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=Z.bind(void 0,de),this.writecb=null,this.writelen=0,this.afterWriteTickInfo=null,ee(this),this.pendingcb=0,this.constructed=!0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=!me||me.emitClose!==!1,this.autoDestroy=!me||me.autoDestroy!==!1,this.errored=null,this.closed=!1,this.closeEmitted=!1,this[Q]=[]}function ee(me){me.buffered=[],me.bufferedIndex=0,me.allBuffers=!0,me.allNoop=!0}q.prototype.getBuffer=function(){return n(this.buffered,this.bufferedIndex)},l(q.prototype,"bufferedRequestCount",{__proto__:null,get(){return this.buffered.length-this.bufferedIndex}});function ne(me){let de=this instanceof Io();if(!de&&!a(ne,this))return new ne(me);this._writableState=new q(me,this,de),me&&(typeof me.write=="function"&&(this._write=me.write),typeof me.writev=="function"&&(this._writev=me.writev),typeof me.destroy=="function"&&(this._destroy=me.destroy),typeof me.final=="function"&&(this._final=me.final),typeof me.construct=="function"&&(this._construct=me.construct),me.signal&&w(me.signal,this)),v.call(this,me),y.construct(this,()=>{let Be=this._writableState;Be.writing||Ge(this,Be),Me(this,Be)})}l(ne,p,{__proto__:null,value:function(me){return a(this,me)?!0:this!==ne?!1:me&&me._writableState instanceof q}}),ne.prototype.pipe=function(){O(this,new R)};function B(me,de,Be,Je){let rt=me._writableState;if(typeof Be=="function")Je=Be,Be=rt.defaultEncoding;else{if(!Be)Be=rt.defaultEncoding;else if(Be!=="buffer"&&!b.isEncoding(Be))throw new Y(Be);typeof Je!="function"&&(Je=N)}if(de===null)throw new te;if(!rt.objectMode)if(typeof de=="string")rt.decodeStrings!==!1&&(de=b.from(de,Be),Be="buffer");else if(de instanceof b)Be="buffer";else if(v._isUint8Array(de))de=v._uint8ArrayToBuffer(de),Be="buffer";else throw new x("chunk",["string","Buffer","Uint8Array"],de);let at;return rt.ending?at=new G:rt.destroyed&&(at=new I("write")),at?(t.nextTick(Je,at),O(me,at,!0),at):(rt.pendingcb++,z(me,rt,de,Be,Je))}ne.prototype.write=function(me,de,Be){return B(this,me,de,Be)===!0},ne.prototype.cork=function(){this._writableState.corked++},ne.prototype.uncork=function(){let me=this._writableState;me.corked&&(me.corked--,me.writing||Ge(this,me))},ne.prototype.setDefaultEncoding=function(me){if(typeof me=="string"&&(me=f(me)),!b.isEncoding(me))throw new Y(me);return this._writableState.defaultEncoding=me,this};function z(me,de,Be,Je,rt){let at=de.objectMode?1:Be.length;de.length+=at;let ye=de.length<de.highWaterMark;return ye||(de.needDrain=!0),de.writing||de.corked||de.errored||!de.constructed?(de.buffered.push({chunk:Be,encoding:Je,callback:rt}),de.allBuffers&&Je!=="buffer"&&(de.allBuffers=!1),de.allNoop&&rt!==N&&(de.allNoop=!1)):(de.writelen=at,de.writecb=rt,de.writing=!0,de.sync=!0,me._write(Be,Je,de.onwrite),de.sync=!1),ye&&!de.errored&&!de.destroyed}function $(me,de,Be,Je,rt,at,ye){de.writelen=Je,de.writecb=ye,de.writing=!0,de.sync=!0,de.destroyed?de.onwrite(new I("write")):Be?me._writev(rt,de.onwrite):me._write(rt,at,de.onwrite),de.sync=!1}function V(me,de,Be,Je){--de.pendingcb,Je(Be),be(de),O(me,Be)}function Z(me,de){let Be=me._writableState,Je=Be.sync,rt=Be.writecb;if(typeof rt!="function"){O(me,new A);return}Be.writing=!1,Be.writecb=null,Be.length-=Be.writelen,Be.writelen=0,de?(de.stack,Be.errored||(Be.errored=de),me._readableState&&!me._readableState.errored&&(me._readableState.errored=de),Je?t.nextTick(V,me,Be,de,rt):V(me,Be,de,rt)):(Be.buffered.length>Be.bufferedIndex&&Ge(me,Be),Je?Be.afterWriteTickInfo!==null&&Be.afterWriteTickInfo.cb===rt?Be.afterWriteTickInfo.count++:(Be.afterWriteTickInfo={count:1,cb:rt,stream:me,state:Be},t.nextTick(ae,Be.afterWriteTickInfo)):Ae(me,Be,1,rt))}function ae({stream:me,state:de,count:Be,cb:Je}){return de.afterWriteTickInfo=null,Ae(me,de,Be,Je)}function Ae(me,de,Be,Je){for(!de.ending&&!me.destroyed&&de.length===0&&de.needDrain&&(de.needDrain=!1,me.emit("drain"));Be-- >0;)de.pendingcb--,Je();de.destroyed&&be(de),Me(me,de)}function be(me){if(me.writing)return;for(let rt=me.bufferedIndex;rt<me.buffered.length;++rt){var de;let{chunk:at,callback:ye}=me.buffered[rt],it=me.objectMode?1:at.length;me.length-=it,ye((de=me.errored)!==null&&de!==void 0?de:new I("write"))}let Be=me[Q].splice(0);for(let rt=0;rt<Be.length;rt++){var Je;Be[rt]((Je=me.errored)!==null&&Je!==void 0?Je:new I("end"))}ee(me)}function Ge(me,de){if(de.corked||de.bufferProcessing||de.destroyed||!de.constructed)return;let{buffered:Be,bufferedIndex:Je,objectMode:rt}=de,at=Be.length-Je;if(!at)return;let ye=Je;if(de.bufferProcessing=!0,at>1&&me._writev){de.pendingcb-=at-1;let it=de.allNoop?N:nt=>{for(let Zt=ye;Zt<Be.length;++Zt)Be[Zt].callback(nt)},Mt=de.allNoop&&ye===0?Be:n(Be,ye);Mt.allBuffers=de.allBuffers,$(me,de,!0,de.length,Mt,"",it),ee(de)}else{do{let{chunk:it,encoding:Mt,callback:nt}=Be[ye];Be[ye++]=null;let Zt=rt?1:it.length;$(me,de,!1,Zt,it,Mt,nt)}while(ye<Be.length&&!de.writing);ye===Be.length?ee(de):ye>256?(Be.splice(0,ye),de.bufferedIndex=0):de.bufferedIndex=ye}de.bufferProcessing=!1}ne.prototype._write=function(me,de,Be){if(this._writev)this._writev([{chunk:me,encoding:de}],Be);else throw new k("_write()")},ne.prototype._writev=null,ne.prototype.end=function(me,de,Be){let Je=this._writableState;typeof me=="function"?(Be=me,me=null,de=null):typeof de=="function"&&(Be=de,de=null);let rt;if(me!=null){let at=B(this,me,de);at instanceof s&&(rt=at)}return Je.corked&&(Je.corked=1,this.uncork()),rt||(!Je.errored&&!Je.ending?(Je.ending=!0,Me(this,Je,!0),Je.ended=!0):Je.finished?rt=new U("end"):Je.destroyed&&(rt=new I("end"))),typeof Be=="function"&&(rt||Je.finished?t.nextTick(Be,rt):Je[Q].push(Be)),this};function Te(me){return me.ending&&!me.destroyed&&me.constructed&&me.length===0&&!me.errored&&me.buffered.length===0&&!me.finished&&!me.writing&&!me.errorEmitted&&!me.closeEmitted}function ve(me,de){let Be=!1;function Je(rt){if(Be){O(me,rt??A());return}if(Be=!0,de.pendingcb--,rt){let at=de[Q].splice(0);for(let ye=0;ye<at.length;ye++)at[ye](rt);O(me,rt,de.sync)}else Te(de)&&(de.prefinished=!0,me.emit("prefinish"),de.pendingcb++,t.nextTick(Ie,me,de))}de.sync=!0,de.pendingcb++;try{me._final(Je)}catch(rt){Je(rt)}de.sync=!1}function ke(me,de){!de.prefinished&&!de.finalCalled&&(typeof me._final=="function"&&!de.destroyed?(de.finalCalled=!0,ve(me,de)):(de.prefinished=!0,me.emit("prefinish")))}function Me(me,de,Be){Te(de)&&(ke(me,de),de.pendingcb===0&&(Be?(de.pendingcb++,t.nextTick((Je,rt)=>{Te(rt)?Ie(Je,rt):rt.pendingcb--},me,de)):Te(de)&&(de.pendingcb++,Ie(me,de))))}function Ie(me,de){de.pendingcb--,de.finished=!0;let Be=de[Q].splice(0);for(let Je=0;Je<Be.length;Je++)Be[Je]();if(me.emit("finish"),de.autoDestroy){let Je=me._readableState;(!Je||Je.autoDestroy&&(Je.endEmitted||Je.readable===!1))&&me.destroy()}}u(ne.prototype,{closed:{__proto__:null,get(){return this._writableState?this._writableState.closed:!1}},destroyed:{__proto__:null,get(){return this._writableState?this._writableState.destroyed:!1},set(me){this._writableState&&(this._writableState.destroyed=me)}},writable:{__proto__:null,get(){let me=this._writableState;return!!me&&me.writable!==!1&&!me.destroyed&&!me.errored&&!me.ending&&!me.ended},set(me){this._writableState&&(this._writableState.writable=!!me)}},writableFinished:{__proto__:null,get(){return this._writableState?this._writableState.finished:!1}},writableObjectMode:{__proto__:null,get(){return this._writableState?this._writableState.objectMode:!1}},writableBuffer:{__proto__:null,get(){return this._writableState&&this._writableState.getBuffer()}},writableEnded:{__proto__:null,get(){return this._writableState?this._writableState.ending:!1}},writableNeedDrain:{__proto__:null,get(){let me=this._writableState;return me?!me.destroyed&&!me.ending&&me.needDrain:!1}},writableHighWaterMark:{__proto__:null,get(){return this._writableState&&this._writableState.highWaterMark}},writableCorked:{__proto__:null,get(){return this._writableState?this._writableState.corked:0}},writableLength:{__proto__:null,get(){return this._writableState&&this._writableState.length}},errored:{__proto__:null,enumerable:!1,get(){return this._writableState?this._writableState.errored:null}},writableAborted:{__proto__:null,enumerable:!1,get:function(){return!!(this._writableState.writable!==!1&&(this._writableState.destroyed||this._writableState.errored)&&!this._writableState.finished)}}});var Ce=y.destroy;ne.prototype.destroy=function(me,de){let Be=this._writableState;return!Be.destroyed&&(Be.bufferedIndex<Be.buffered.length||Be[Q].length)&&t.nextTick(be,Be),Ce.call(this,me,de),this},ne.prototype._undestroy=y.undestroy,ne.prototype._destroy=function(me,de){de(me)},ne.prototype[m.captureRejectionSymbol]=function(me){this.destroy(me)};var ot;function et(){return ot===void 0&&(ot={}),ot}ne.fromWeb=function(me,de){return et().newStreamWritableFromWritableStream(me,de)},ne.toWeb=function(me){return et().newWritableStreamFromStreamWritable(me)}}),M6=Rt((i,e)=>{_t(),Et(),St();var t=Bl(),n=(ni(),dr(ti)),{isReadable:s,isWritable:a,isIterable:l,isNodeStream:u,isReadableNodeStream:c,isWritableNodeStream:f,isDuplexNodeStream:d,isReadableStream:p,isWritableStream:m}=Bo(),v=Fa(),{AbortError:b,codes:{ERR_INVALID_ARG_TYPE:y,ERR_INVALID_RETURN_VALUE:w}}=Ti(),{destroyer:C}=Dc(),S=Io(),x=wd(),k=ab(),{createDeferredPromise:A}=Li(),R=dE(),I=globalThis.Blob||n.Blob,U=typeof I<"u"?function(Q){return Q instanceof I}:function(Q){return!1},te=globalThis.AbortController||Vu().AbortController,{FunctionPrototypeCall:G}=Nr(),Y=class extends S{constructor(Q){super(Q),Q?.readable===!1&&(this._readableState.readable=!1,this._readableState.ended=!0,this._readableState.endEmitted=!0),Q?.writable===!1&&(this._writableState.writable=!1,this._writableState.ending=!0,this._writableState.ended=!0,this._writableState.finished=!0)}};e.exports=function Q(q,ee){if(d(q))return q;if(c(q))return N({readable:q});if(f(q))return N({writable:q});if(u(q))return N({writable:!1,readable:!1});if(p(q))return N({readable:x.fromWeb(q)});if(m(q))return N({writable:k.fromWeb(q)});if(typeof q=="function"){let{value:B,write:z,final:$,destroy:V}=O(q);if(l(B))return R(Y,B,{objectMode:!0,write:z,final:$,destroy:V});let Z=B?.then;if(typeof Z=="function"){let ae,Ae=G(Z,B,be=>{if(be!=null)throw new w("nully","body",be)},be=>{C(ae,be)});return ae=new Y({objectMode:!0,readable:!1,write:z,final(be){$(async()=>{try{await Ae,t.nextTick(be,null)}catch(Ge){t.nextTick(be,Ge)}})},destroy:V})}throw new w("Iterable, AsyncIterable or AsyncFunction",ee,B)}if(U(q))return Q(q.arrayBuffer());if(l(q))return R(Y,q,{objectMode:!0,writable:!1});if(p(q?.readable)&&m(q?.writable))return Y.fromWeb(q);if(typeof q?.writable=="object"||typeof q?.readable=="object"){let B=q!=null&&q.readable?c(q?.readable)?q?.readable:Q(q.readable):void 0,z=q!=null&&q.writable?f(q?.writable)?q?.writable:Q(q.writable):void 0;return N({readable:B,writable:z})}let ne=q?.then;if(typeof ne=="function"){let B;return G(ne,q,z=>{z!=null&&B.push(z),B.push(null)},z=>{C(B,z)}),B=new Y({objectMode:!0,writable:!1,read(){}})}throw new y(ee,["Blob","ReadableStream","WritableStream","Stream","Iterable","AsyncIterable","Function","{ readable, writable } pair","Promise"],q)};function O(Q){let{promise:q,resolve:ee}=A(),ne=new te,B=ne.signal;return{value:Q((async function*(){for(;;){let z=q;q=null;let{chunk:$,done:V,cb:Z}=await z;if(t.nextTick(Z),V)return;if(B.aborted)throw new b(void 0,{cause:B.reason});({promise:q,resolve:ee}=A()),yield $}})(),{signal:B}),write(z,$,V){let Z=ee;ee=null,Z({chunk:z,done:!1,cb:V})},final(z){let $=ee;ee=null,$({done:!0,cb:z})},destroy(z,$){ne.abort(),$(z)}}}function N(Q){let q=Q.readable&&typeof Q.readable.read!="function"?x.wrap(Q.readable):Q.readable,ee=Q.writable,ne=!!s(q),B=!!a(ee),z,$,V,Z,ae;function Ae(be){let Ge=Z;Z=null,Ge?Ge(be):be&&ae.destroy(be)}return ae=new Y({readableObjectMode:!!(q!=null&&q.readableObjectMode),writableObjectMode:!!(ee!=null&&ee.writableObjectMode),readable:ne,writable:B}),B&&(v(ee,be=>{B=!1,be&&C(q,be),Ae(be)}),ae._write=function(be,Ge,Te){ee.write(be,Ge)?Te():z=Te},ae._final=function(be){ee.end(),$=be},ee.on("drain",function(){if(z){let be=z;z=null,be()}}),ee.on("finish",function(){if($){let be=$;$=null,be()}})),ne&&(v(q,be=>{ne=!1,be&&C(q,be),Ae(be)}),q.on("readable",function(){if(V){let be=V;V=null,be()}}),q.on("end",function(){ae.push(null)}),ae._read=function(){for(;;){let be=q.read();if(be===null){V=ae._read;return}if(!ae.push(be))return}}),ae._destroy=function(be,Ge){!be&&Z!==null&&(be=new b),V=null,z=null,$=null,Z===null?Ge(be):(Z=Ge,C(ee,be),C(q,be))},ae}}),Io=Rt((i,e)=>{_t(),Et(),St();var{ObjectDefineProperties:t,ObjectGetOwnPropertyDescriptor:n,ObjectKeys:s,ObjectSetPrototypeOf:a}=Nr();e.exports=c;var l=wd(),u=ab();a(c.prototype,l.prototype),a(c,l);{let m=s(u.prototype);for(let v=0;v<m.length;v++){let b=m[v];c.prototype[b]||(c.prototype[b]=u.prototype[b])}}function c(m){if(!(this instanceof c))return new c(m);l.call(this,m),u.call(this,m),m?(this.allowHalfOpen=m.allowHalfOpen!==!1,m.readable===!1&&(this._readableState.readable=!1,this._readableState.ended=!0,this._readableState.endEmitted=!0),m.writable===!1&&(this._writableState.writable=!1,this._writableState.ending=!0,this._writableState.ended=!0,this._writableState.finished=!0)):this.allowHalfOpen=!0}t(c.prototype,{writable:{__proto__:null,...n(u.prototype,"writable")},writableHighWaterMark:{__proto__:null,...n(u.prototype,"writableHighWaterMark")},writableObjectMode:{__proto__:null,...n(u.prototype,"writableObjectMode")},writableBuffer:{__proto__:null,...n(u.prototype,"writableBuffer")},writableLength:{__proto__:null,...n(u.prototype,"writableLength")},writableFinished:{__proto__:null,...n(u.prototype,"writableFinished")},writableCorked:{__proto__:null,...n(u.prototype,"writableCorked")},writableEnded:{__proto__:null,...n(u.prototype,"writableEnded")},writableNeedDrain:{__proto__:null,...n(u.prototype,"writableNeedDrain")},destroyed:{__proto__:null,get(){return this._readableState===void 0||this._writableState===void 0?!1:this._readableState.destroyed&&this._writableState.destroyed},set(m){this._readableState&&this._writableState&&(this._readableState.destroyed=m,this._writableState.destroyed=m)}}});var f;function d(){return f===void 0&&(f={}),f}c.fromWeb=function(m,v){return d().newStreamDuplexFromReadableWritablePair(m,v)},c.toWeb=function(m){return d().newReadableWritablePairFromDuplex(m)};var p;c.from=function(m){return p||(p=M6()),p(m,"body")}}),pE=Rt((i,e)=>{_t(),Et(),St();var{ObjectSetPrototypeOf:t,Symbol:n}=Nr();e.exports=c;var{ERR_METHOD_NOT_IMPLEMENTED:s}=Ti().codes,a=Io(),{getHighWaterMark:l}=vd();t(c.prototype,a.prototype),t(c,a);var u=n("kCallback");function c(p){if(!(this instanceof c))return new c(p);let m=p?l(this,p,"readableHighWaterMark",!0):null;m===0&&(p={...p,highWaterMark:null,readableHighWaterMark:m,writableHighWaterMark:p.writableHighWaterMark||0}),a.call(this,p),this._readableState.sync=!1,this[u]=null,p&&(typeof p.transform=="function"&&(this._transform=p.transform),typeof p.flush=="function"&&(this._flush=p.flush)),this.on("prefinish",d)}function f(p){typeof this._flush=="function"&&!this.destroyed?this._flush((m,v)=>{if(m){p?p(m):this.destroy(m);return}v!=null&&this.push(v),this.push(null),p&&p()}):(this.push(null),p&&p())}function d(){this._final!==f&&f.call(this)}c.prototype._final=f,c.prototype._transform=function(p,m,v){throw new s("_transform()")},c.prototype._write=function(p,m,v){let b=this._readableState,y=this._writableState,w=b.length;this._transform(p,m,(C,S)=>{if(C){v(C);return}S!=null&&this.push(S),y.ended||w===b.length||b.length<b.highWaterMark?v():this[u]=v})},c.prototype._read=function(){if(this[u]){let p=this[u];this[u]=null,p()}}}),gE=Rt((i,e)=>{_t(),Et(),St();var{ObjectSetPrototypeOf:t}=Nr();e.exports=s;var n=pE();t(s.prototype,n.prototype),t(s,n);function s(a){if(!(this instanceof s))return new s(a);n.call(this,a)}s.prototype._transform=function(a,l,u){u(null,a)}}),lb=Rt((i,e)=>{_t(),Et(),St();var t=Bl(),{ArrayIsArray:n,Promise:s,SymbolAsyncIterator:a,SymbolDispose:l}=Nr(),u=Fa(),{once:c}=Li(),f=Dc(),d=Io(),{aggregateTwoErrors:p,codes:{ERR_INVALID_ARG_TYPE:m,ERR_INVALID_RETURN_VALUE:v,ERR_MISSING_ARGS:b,ERR_STREAM_DESTROYED:y,ERR_STREAM_PREMATURE_CLOSE:w},AbortError:C}=Ti(),{validateFunction:S,validateAbortSignal:x}=Ju(),{isIterable:k,isReadable:A,isReadableNodeStream:R,isNodeStream:I,isTransformStream:U,isWebStream:te,isReadableStream:G,isReadableFinished:Y}=Bo(),O=globalThis.AbortController||Vu().AbortController,N,Q,q;function ee(be,Ge,Te){let ve=!1;be.on("close",()=>{ve=!0});let ke=u(be,{readable:Ge,writable:Te},Me=>{ve=!Me});return{destroy:Me=>{ve||(ve=!0,f.destroyer(be,Me||new y("pipe")))},cleanup:ke}}function ne(be){return S(be[be.length-1],"streams[stream.length - 1]"),be.pop()}function B(be){if(k(be))return be;if(R(be))return z(be);throw new m("val",["Readable","Iterable","AsyncIterable"],be)}async function*z(be){Q||(Q=wd()),yield*Q.prototype[a].call(be)}async function $(be,Ge,Te,{end:ve}){let ke,Me=null,Ie=et=>{if(et&&(ke=et),Me){let me=Me;Me=null,me()}},Ce=()=>new s((et,me)=>{ke?me(ke):Me=()=>{ke?me(ke):et()}});Ge.on("drain",Ie);let ot=u(Ge,{readable:!1},Ie);try{Ge.writableNeedDrain&&await Ce();for await(let et of be)Ge.write(et)||await Ce();ve&&(Ge.end(),await Ce()),Te()}catch(et){Te(ke!==et?p(ke,et):et)}finally{ot(),Ge.off("drain",Ie)}}async function V(be,Ge,Te,{end:ve}){U(Ge)&&(Ge=Ge.writable);let ke=Ge.getWriter();try{for await(let Me of be)await ke.ready,ke.write(Me).catch(()=>{});await ke.ready,ve&&await ke.close(),Te()}catch(Me){try{await ke.abort(Me),Te(Me)}catch(Ie){Te(Ie)}}}function Z(...be){return ae(be,c(ne(be)))}function ae(be,Ge,Te){if(be.length===1&&n(be[0])&&(be=be[0]),be.length<2)throw new b("streams");let ve=new O,ke=ve.signal,Me=Te?.signal,Ie=[];x(Me,"options.signal");function Ce(){rt(new C)}q=q||Li().addAbortListener;let ot;Me&&(ot=q(Me,Ce));let et,me,de=[],Be=0;function Je(Mt){rt(Mt,--Be===0)}function rt(Mt,nt){var Zt;if(Mt&&(!et||et.code==="ERR_STREAM_PREMATURE_CLOSE")&&(et=Mt),!(!et&&!nt)){for(;de.length;)de.shift()(et);(Zt=ot)===null||Zt===void 0||Zt[l](),ve.abort(),nt&&(et||Ie.forEach(j=>j()),t.nextTick(Ge,et,me))}}let at;for(let Mt=0;Mt<be.length;Mt++){let nt=be[Mt],Zt=Mt<be.length-1,j=Mt>0,W=Zt||Te?.end!==!1,se=Mt===be.length-1;if(I(nt)){let Oe=function(Ke){Ke&&Ke.name!=="AbortError"&&Ke.code!=="ERR_STREAM_PREMATURE_CLOSE"&&Je(Ke)};if(W){let{destroy:Ke,cleanup:gt}=ee(nt,Zt,j);de.push(Ke),A(nt)&&se&&Ie.push(gt)}nt.on("error",Oe),A(nt)&&se&&Ie.push(()=>{nt.removeListener("error",Oe)})}if(Mt===0)if(typeof nt=="function"){if(at=nt({signal:ke}),!k(at))throw new v("Iterable, AsyncIterable or Stream","source",at)}else k(nt)||R(nt)||U(nt)?at=nt:at=d.from(nt);else if(typeof nt=="function"){if(U(at)){var ye;at=B((ye=at)===null||ye===void 0?void 0:ye.readable)}else at=B(at);if(at=nt(at,{signal:ke}),Zt){if(!k(at,!0))throw new v("AsyncIterable",`transform[${Mt-1}]`,at)}else{var it;N||(N=gE());let Oe=new N({objectMode:!0}),Ke=(it=at)===null||it===void 0?void 0:it.then;if(typeof Ke=="function")Be++,Ke.call(at,Le=>{me=Le,Le!=null&&Oe.write(Le),W&&Oe.end(),t.nextTick(Je)},Le=>{Oe.destroy(Le),t.nextTick(Je,Le)});else if(k(at,!0))Be++,$(at,Oe,Je,{end:W});else if(G(at)||U(at)){let Le=at.readable||at;Be++,$(Le,Oe,Je,{end:W})}else throw new v("AsyncIterable or Promise","destination",at);at=Oe;let{destroy:gt,cleanup:Ut}=ee(at,!1,!0);de.push(gt),se&&Ie.push(Ut)}}else if(I(nt)){if(R(at)){Be+=2;let Oe=Ae(at,nt,Je,{end:W});A(nt)&&se&&Ie.push(Oe)}else if(U(at)||G(at)){let Oe=at.readable||at;Be++,$(Oe,nt,Je,{end:W})}else if(k(at))Be++,$(at,nt,Je,{end:W});else throw new m("val",["Readable","Iterable","AsyncIterable","ReadableStream","TransformStream"],at);at=nt}else if(te(nt)){if(R(at))Be++,V(B(at),nt,Je,{end:W});else if(G(at)||k(at))Be++,V(at,nt,Je,{end:W});else if(U(at))Be++,V(at.readable,nt,Je,{end:W});else throw new m("val",["Readable","Iterable","AsyncIterable","ReadableStream","TransformStream"],at);at=nt}else at=d.from(nt)}return(ke!=null&&ke.aborted||Me!=null&&Me.aborted)&&t.nextTick(Ce),at}function Ae(be,Ge,Te,{end:ve}){let ke=!1;if(Ge.on("close",()=>{ke||Te(new w)}),be.pipe(Ge,{end:!1}),ve){let Me=function(){ke=!0,Ge.end()};Y(be)?t.nextTick(Me):be.once("end",Me)}else Te();return u(be,{readable:!0,writable:!1},Me=>{let Ie=be._readableState;Me&&Me.code==="ERR_STREAM_PREMATURE_CLOSE"&&Ie&&Ie.ended&&!Ie.errored&&!Ie.errorEmitted?be.once("end",Te).once("error",Te):Te(Me)}),u(Ge,{readable:!1,writable:!0},Te)}e.exports={pipelineImpl:ae,pipeline:Z}}),mE=Rt((i,e)=>{_t(),Et(),St();var{pipeline:t}=lb(),n=Io(),{destroyer:s}=Dc(),{isNodeStream:a,isReadable:l,isWritable:u,isWebStream:c,isTransformStream:f,isWritableStream:d,isReadableStream:p}=Bo(),{AbortError:m,codes:{ERR_INVALID_ARG_VALUE:v,ERR_MISSING_ARGS:b}}=Ti(),y=Fa();e.exports=function(...w){if(w.length===0)throw new b("streams");if(w.length===1)return n.from(w[0]);let C=[...w];if(typeof w[0]=="function"&&(w[0]=n.from(w[0])),typeof w[w.length-1]=="function"){let O=w.length-1;w[O]=n.from(w[O])}for(let O=0;O<w.length;++O)if(!(!a(w[O])&&!c(w[O]))){if(O<w.length-1&&!(l(w[O])||p(w[O])||f(w[O])))throw new v(`streams[${O}]`,C[O],"must be readable");if(O>0&&!(u(w[O])||d(w[O])||f(w[O])))throw new v(`streams[${O}]`,C[O],"must be writable")}let S,x,k,A,R;function I(O){let N=A;A=null,N?N(O):O?R.destroy(O):!Y&&!G&&R.destroy()}let U=w[0],te=t(w,I),G=!!(u(U)||d(U)||f(U)),Y=!!(l(te)||p(te)||f(te));if(R=new n({writableObjectMode:!!(U!=null&&U.writableObjectMode),readableObjectMode:!!(te!=null&&te.readableObjectMode),writable:G,readable:Y}),G){if(a(U))R._write=function(N,Q,q){U.write(N,Q)?q():S=q},R._final=function(N){U.end(),x=N},U.on("drain",function(){if(S){let N=S;S=null,N()}});else if(c(U)){let N=(f(U)?U.writable:U).getWriter();R._write=async function(Q,q,ee){try{await N.ready,N.write(Q).catch(()=>{}),ee()}catch(ne){ee(ne)}},R._final=async function(Q){try{await N.ready,N.close().catch(()=>{}),x=Q}catch(q){Q(q)}}}let O=f(te)?te.readable:te;y(O,()=>{if(x){let N=x;x=null,N()}})}if(Y){if(a(te))te.on("readable",function(){if(k){let O=k;k=null,O()}}),te.on("end",function(){R.push(null)}),R._read=function(){for(;;){let O=te.read();if(O===null){k=R._read;return}if(!R.push(O))return}};else if(c(te)){let O=(f(te)?te.readable:te).getReader();R._read=async function(){for(;;)try{let{value:N,done:Q}=await O.read();if(!R.push(N))return;if(Q){R.push(null);return}}catch{return}}}}return R._destroy=function(O,N){!O&&A!==null&&(O=new m),k=null,S=null,x=null,A===null?N(O):(A=N,a(te)&&s(te,O))},R}}),I6=Rt((i,e)=>{_t(),Et(),St();var t=globalThis.AbortController||Vu().AbortController,{codes:{ERR_INVALID_ARG_VALUE:n,ERR_INVALID_ARG_TYPE:s,ERR_MISSING_ARGS:a,ERR_OUT_OF_RANGE:l},AbortError:u}=Ti(),{validateAbortSignal:c,validateInteger:f,validateObject:d}=Ju(),p=Nr().Symbol("kWeak"),m=Nr().Symbol("kResistStopPropagation"),{finished:v}=Fa(),b=mE(),{addAbortSignalNoValidate:y}=bd(),{isWritable:w,isNodeStream:C}=Bo(),{deprecate:S}=Li(),{ArrayPrototypePush:x,Boolean:k,MathFloor:A,Number:R,NumberIsNaN:I,Promise:U,PromiseReject:te,PromiseResolve:G,PromisePrototypeThen:Y,Symbol:O}=Nr(),N=O("kEmpty"),Q=O("kEof");function q(Me,Ie){if(Ie!=null&&d(Ie,"options"),Ie?.signal!=null&&c(Ie.signal,"options.signal"),C(Me)&&!w(Me))throw new n("stream",Me,"must be writable");let Ce=b(this,Me);return Ie!=null&&Ie.signal&&y(Ie.signal,Ce),Ce}function ee(Me,Ie){if(typeof Me!="function")throw new s("fn",["Function","AsyncFunction"],Me);Ie!=null&&d(Ie,"options"),Ie?.signal!=null&&c(Ie.signal,"options.signal");let Ce=1;Ie?.concurrency!=null&&(Ce=A(Ie.concurrency));let ot=Ce-1;return Ie?.highWaterMark!=null&&(ot=A(Ie.highWaterMark)),f(Ce,"options.concurrency",1),f(ot,"options.highWaterMark",0),ot+=Ce,(async function*(){let et=Li().AbortSignalAny([Ie?.signal].filter(k)),me=this,de=[],Be={signal:et},Je,rt,at=!1,ye=0;function it(){at=!0,Mt()}function Mt(){ye-=1,nt()}function nt(){rt&&!at&&ye<Ce&&de.length<ot&&(rt(),rt=null)}async function Zt(){try{for await(let j of me){if(at)return;if(et.aborted)throw new u;try{if(j=Me(j,Be),j===N)continue;j=G(j)}catch(W){j=te(W)}ye+=1,Y(j,Mt,it),de.push(j),Je&&(Je(),Je=null),!at&&(de.length>=ot||ye>=Ce)&&await new U(W=>{rt=W})}de.push(Q)}catch(j){let W=te(j);Y(W,Mt,it),de.push(W)}finally{at=!0,Je&&(Je(),Je=null)}}Zt();try{for(;;){for(;de.length>0;){let j=await de[0];if(j===Q)return;if(et.aborted)throw new u;j!==N&&(yield j),de.shift(),nt()}await new U(j=>{Je=j})}}finally{at=!0,rt&&(rt(),rt=null)}}).call(this)}function ne(Me=void 0){return Me!=null&&d(Me,"options"),Me?.signal!=null&&c(Me.signal,"options.signal"),(async function*(){let Ie=0;for await(let ot of this){var Ce;if(Me!=null&&(Ce=Me.signal)!==null&&Ce!==void 0&&Ce.aborted)throw new u({cause:Me.signal.reason});yield[Ie++,ot]}}).call(this)}async function B(Me,Ie=void 0){for await(let Ce of Z.call(this,Me,Ie))return!0;return!1}async function z(Me,Ie=void 0){if(typeof Me!="function")throw new s("fn",["Function","AsyncFunction"],Me);return!await B.call(this,async(...Ce)=>!await Me(...Ce),Ie)}async function $(Me,Ie){for await(let Ce of Z.call(this,Me,Ie))return Ce}async function V(Me,Ie){if(typeof Me!="function")throw new s("fn",["Function","AsyncFunction"],Me);async function Ce(ot,et){return await Me(ot,et),N}for await(let ot of ee.call(this,Ce,Ie));}function Z(Me,Ie){if(typeof Me!="function")throw new s("fn",["Function","AsyncFunction"],Me);async function Ce(ot,et){return await Me(ot,et)?ot:N}return ee.call(this,Ce,Ie)}var ae=class extends a{constructor(){super("reduce"),this.message="Reduce of an empty stream requires an initial value"}};async function Ae(Me,Ie,Ce){var ot;if(typeof Me!="function")throw new s("reducer",["Function","AsyncFunction"],Me);Ce!=null&&d(Ce,"options"),Ce?.signal!=null&&c(Ce.signal,"options.signal");let et=arguments.length>1;if(Ce!=null&&(ot=Ce.signal)!==null&&ot!==void 0&&ot.aborted){let rt=new u(void 0,{cause:Ce.signal.reason});throw this.once("error",()=>{}),await v(this.destroy(rt)),rt}let me=new t,de=me.signal;if(Ce!=null&&Ce.signal){let rt={once:!0,[p]:this,[m]:!0};Ce.signal.addEventListener("abort",()=>me.abort(),rt)}let Be=!1;try{for await(let rt of this){var Je;if(Be=!0,Ce!=null&&(Je=Ce.signal)!==null&&Je!==void 0&&Je.aborted)throw new u;et?Ie=await Me(Ie,rt,{signal:de}):(Ie=rt,et=!0)}if(!Be&&!et)throw new ae}finally{me.abort()}return Ie}async function be(Me){Me!=null&&d(Me,"options"),Me?.signal!=null&&c(Me.signal,"options.signal");let Ie=[];for await(let ot of this){var Ce;if(Me!=null&&(Ce=Me.signal)!==null&&Ce!==void 0&&Ce.aborted)throw new u(void 0,{cause:Me.signal.reason});x(Ie,ot)}return Ie}function Ge(Me,Ie){let Ce=ee.call(this,Me,Ie);return(async function*(){for await(let ot of Ce)yield*ot}).call(this)}function Te(Me){if(Me=R(Me),I(Me))return 0;if(Me<0)throw new l("number",">= 0",Me);return Me}function ve(Me,Ie=void 0){return Ie!=null&&d(Ie,"options"),Ie?.signal!=null&&c(Ie.signal,"options.signal"),Me=Te(Me),(async function*(){var Ce;if(Ie!=null&&(Ce=Ie.signal)!==null&&Ce!==void 0&&Ce.aborted)throw new u;for await(let et of this){var ot;if(Ie!=null&&(ot=Ie.signal)!==null&&ot!==void 0&&ot.aborted)throw new u;Me--<=0&&(yield et)}}).call(this)}function ke(Me,Ie=void 0){return Ie!=null&&d(Ie,"options"),Ie?.signal!=null&&c(Ie.signal,"options.signal"),Me=Te(Me),(async function*(){var Ce;if(Ie!=null&&(Ce=Ie.signal)!==null&&Ce!==void 0&&Ce.aborted)throw new u;for await(let et of this){var ot;if(Ie!=null&&(ot=Ie.signal)!==null&&ot!==void 0&&ot.aborted)throw new u;if(Me-- >0&&(yield et),Me<=0)return}}).call(this)}e.exports.streamReturningOperators={asIndexedPairs:S(ne,"readable.asIndexedPairs will be removed in a future version."),drop:ve,filter:Z,flatMap:Ge,map:ee,take:ke,compose:q},e.exports.promiseReturningOperators={every:z,forEach:V,reduce:Ae,toArray:be,some:B,find:$}}),yE=Rt((i,e)=>{_t(),Et(),St();var{ArrayPrototypePop:t,Promise:n}=Nr(),{isIterable:s,isNodeStream:a,isWebStream:l}=Bo(),{pipelineImpl:u}=lb(),{finished:c}=Fa();bE();function f(...d){return new n((p,m)=>{let v,b,y=d[d.length-1];if(y&&typeof y=="object"&&!a(y)&&!s(y)&&!l(y)){let w=t(d);v=w.signal,b=w.end}u(d,(w,C)=>{w?m(w):p(C)},{signal:v,end:b})})}e.exports={finished:c,pipeline:f}}),bE=Rt((i,e)=>{_t(),Et(),St();var{Buffer:t}=(ni(),dr(ti)),{ObjectDefineProperty:n,ObjectKeys:s,ReflectApply:a}=Nr(),{promisify:{custom:l}}=Li(),{streamReturningOperators:u,promiseReturningOperators:c}=I6(),{codes:{ERR_ILLEGAL_CONSTRUCTOR:f}}=Ti(),d=mE(),{setDefaultHighWaterMark:p,getDefaultHighWaterMark:m}=vd(),{pipeline:v}=lb(),{destroyer:b}=Dc(),y=Fa(),w=yE(),C=Bo(),S=e.exports=ob().Stream;S.isDestroyed=C.isDestroyed,S.isDisturbed=C.isDisturbed,S.isErrored=C.isErrored,S.isReadable=C.isReadable,S.isWritable=C.isWritable,S.Readable=wd();for(let k of s(u)){let A=function(...I){if(new.target)throw f();return S.Readable.from(a(R,this,I))},R=u[k];n(A,"name",{__proto__:null,value:R.name}),n(A,"length",{__proto__:null,value:R.length}),n(S.Readable.prototype,k,{__proto__:null,value:A,enumerable:!1,configurable:!0,writable:!0})}for(let k of s(c)){let A=function(...I){if(new.target)throw f();return a(R,this,I)},R=c[k];n(A,"name",{__proto__:null,value:R.name}),n(A,"length",{__proto__:null,value:R.length}),n(S.Readable.prototype,k,{__proto__:null,value:A,enumerable:!1,configurable:!0,writable:!0})}S.Writable=ab(),S.Duplex=Io(),S.Transform=pE(),S.PassThrough=gE(),S.pipeline=v;var{addAbortSignal:x}=bd();S.addAbortSignal=x,S.finished=y,S.destroy=b,S.compose=d,S.setDefaultHighWaterMark=p,S.getDefaultHighWaterMark=m,n(S,"promises",{__proto__:null,configurable:!0,enumerable:!0,get(){return w}}),n(v,l,{__proto__:null,enumerable:!0,get(){return w.pipeline}}),n(y,l,{__proto__:null,enumerable:!0,get(){return w.finished}}),S.Stream=S,S._isUint8Array=function(k){return k instanceof Uint8Array},S._uint8ArrayToBuffer=function(k){return t.from(k.buffer,k.byteOffset,k.byteLength)}}),jl=Rt((i,e)=>{_t(),Et(),St();var t=bE(),n=yE(),s=t.Readable.destroy;e.exports=t.Readable,e.exports._uint8ArrayToBuffer=t._uint8ArrayToBuffer,e.exports._isUint8Array=t._isUint8Array,e.exports.isDisturbed=t.isDisturbed,e.exports.isErrored=t.isErrored,e.exports.isReadable=t.isReadable,e.exports.Readable=t.Readable,e.exports.Writable=t.Writable,e.exports.Duplex=t.Duplex,e.exports.Transform=t.Transform,e.exports.PassThrough=t.PassThrough,e.exports.addAbortSignal=t.addAbortSignal,e.exports.finished=t.finished,e.exports.destroy=t.destroy,e.exports.destroy=s,e.exports.pipeline=t.pipeline,e.exports.compose=t.compose,Object.defineProperty(t,"promises",{configurable:!0,enumerable:!0,get(){return n}}),e.exports.Stream=t.Stream,e.exports.default=e.exports}),R6=Rt((i,e)=>{_t(),Et(),St(),typeof Object.create=="function"?e.exports=function(t,n){n&&(t.super_=n,t.prototype=Object.create(n.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}))}:e.exports=function(t,n){if(n){t.super_=n;var s=function(){};s.prototype=n.prototype,t.prototype=new s,t.prototype.constructor=t}}}),O6=Rt((i,e)=>{_t(),Et(),St();var{Buffer:t}=(ni(),dr(ti)),n=Symbol.for("BufferList");function s(a){if(!(this instanceof s))return new s(a);s._init.call(this,a)}s._init=function(a){Object.defineProperty(this,n,{value:!0}),this._bufs=[],this.length=0,a&&this.append(a)},s.prototype._new=function(a){return new s(a)},s.prototype._offset=function(a){if(a===0)return[0,0];let l=0;for(let u=0;u<this._bufs.length;u++){let c=l+this._bufs[u].length;if(a<c||u===this._bufs.length-1)return[u,a-l];l=c}},s.prototype._reverseOffset=function(a){let l=a[0],u=a[1];for(let c=0;c<l;c++)u+=this._bufs[c].length;return u},s.prototype.getBuffers=function(){return this._bufs},s.prototype.get=function(a){if(a>this.length||a<0)return;let l=this._offset(a);return this._bufs[l[0]][l[1]]},s.prototype.slice=function(a,l){return typeof a=="number"&&a<0&&(a+=this.length),typeof l=="number"&&l<0&&(l+=this.length),this.copy(null,0,a,l)},s.prototype.copy=function(a,l,u,c){if((typeof u!="number"||u<0)&&(u=0),(typeof c!="number"||c>this.length)&&(c=this.length),u>=this.length||c<=0)return a||t.alloc(0);let f=!!a,d=this._offset(u),p=c-u,m=p,v=f&&l||0,b=d[1];if(u===0&&c===this.length){if(!f)return this._bufs.length===1?this._bufs[0]:t.concat(this._bufs,this.length);for(let y=0;y<this._bufs.length;y++)this._bufs[y].copy(a,v),v+=this._bufs[y].length;return a}if(m<=this._bufs[d[0]].length-b)return f?this._bufs[d[0]].copy(a,l,b,b+m):this._bufs[d[0]].slice(b,b+m);f||(a=t.allocUnsafe(p));for(let y=d[0];y<this._bufs.length;y++){let w=this._bufs[y].length-b;if(m>w)this._bufs[y].copy(a,v,b),v+=w;else{this._bufs[y].copy(a,v,b,b+m),v+=w;break}m-=w,b&&(b=0)}return a.length>v?a.slice(0,v):a},s.prototype.shallowSlice=function(a,l){if(a=a||0,l=typeof l!="number"?this.length:l,a<0&&(a+=this.length),l<0&&(l+=this.length),a===l)return this._new();let u=this._offset(a),c=this._offset(l),f=this._bufs.slice(u[0],c[0]+1);return c[1]===0?f.pop():f[f.length-1]=f[f.length-1].slice(0,c[1]),u[1]!==0&&(f[0]=f[0].slice(u[1])),this._new(f)},s.prototype.toString=function(a,l,u){return this.slice(l,u).toString(a)},s.prototype.consume=function(a){if(a=Math.trunc(a),Number.isNaN(a)||a<=0)return this;for(;this._bufs.length;)if(a>=this._bufs[0].length)a-=this._bufs[0].length,this.length-=this._bufs[0].length,this._bufs.shift();else{this._bufs[0]=this._bufs[0].slice(a),this.length-=a;break}return this},s.prototype.duplicate=function(){let a=this._new();for(let l=0;l<this._bufs.length;l++)a.append(this._bufs[l]);return a},s.prototype.append=function(a){return this._attach(a,s.prototype._appendBuffer)},s.prototype.prepend=function(a){return this._attach(a,s.prototype._prependBuffer,!0)},s.prototype._attach=function(a,l,u){if(a==null)return this;if(a.buffer)l.call(this,t.from(a.buffer,a.byteOffset,a.byteLength));else if(Array.isArray(a)){let[c,f]=u?[a.length-1,-1]:[0,1];for(let d=c;d>=0&&d<a.length;d+=f)this._attach(a[d],l,u)}else if(this._isBufferList(a)){let[c,f]=u?[a._bufs.length-1,-1]:[0,1];for(let d=c;d>=0&&d<a._bufs.length;d+=f)this._attach(a._bufs[d],l,u)}else typeof a=="number"&&(a=a.toString()),l.call(this,t.from(a));return this},s.prototype._appendBuffer=function(a){this._bufs.push(a),this.length+=a.length},s.prototype._prependBuffer=function(a){this._bufs.unshift(a),this.length+=a.length},s.prototype.indexOf=function(a,l,u){if(u===void 0&&typeof l=="string"&&(u=l,l=void 0),typeof a=="function"||Array.isArray(a))throw new TypeError('The "value" argument must be one of type string, Buffer, BufferList, or Uint8Array.');if(typeof a=="number"?a=t.from([a]):typeof a=="string"?a=t.from(a,u):this._isBufferList(a)?a=a.slice():Array.isArray(a.buffer)?a=t.from(a.buffer,a.byteOffset,a.byteLength):t.isBuffer(a)||(a=t.from(a)),l=Number(l||0),isNaN(l)&&(l=0),l<0&&(l=this.length+l),l<0&&(l=0),a.length===0)return l>this.length?this.length:l;let c=this._offset(l),f=c[0],d=c[1];for(;f<this._bufs.length;f++){let p=this._bufs[f];for(;d<p.length;)if(p.length-d>=a.length){let m=p.indexOf(a,d);if(m!==-1)return this._reverseOffset([f,m]);d=p.length-a.length+1}else{let m=this._reverseOffset([f,d]);if(this._match(m,a))return m;d++}d=0}return-1},s.prototype._match=function(a,l){if(this.length-a<l.length)return!1;for(let u=0;u<l.length;u++)if(this.get(a+u)!==l[u])return!1;return!0},(function(){let a={readDoubleBE:8,readDoubleLE:8,readFloatBE:4,readFloatLE:4,readBigInt64BE:8,readBigInt64LE:8,readBigUInt64BE:8,readBigUInt64LE:8,readInt32BE:4,readInt32LE:4,readUInt32BE:4,readUInt32LE:4,readInt16BE:2,readInt16LE:2,readUInt16BE:2,readUInt16LE:2,readInt8:1,readUInt8:1,readIntBE:null,readIntLE:null,readUIntBE:null,readUIntLE:null};for(let l in a)(function(u){a[u]===null?s.prototype[u]=function(c,f){return this.slice(c,c+f)[u](0,f)}:s.prototype[u]=function(c=0){return this.slice(c,c+a[u])[u](0)}})(l)})(),s.prototype._isBufferList=function(a){return a instanceof s||s.isBufferList(a)},s.isBufferList=function(a){return a!=null&&a[n]},e.exports=s}),N6=Rt((i,e)=>{_t(),Et(),St();var t=jl().Duplex,n=R6(),s=O6();function a(l){if(!(this instanceof a))return new a(l);if(typeof l=="function"){this._callback=l;let u=(function(c){this._callback&&(this._callback(c),this._callback=null)}).bind(this);this.on("pipe",function(c){c.on("error",u)}),this.on("unpipe",function(c){c.removeListener("error",u)}),l=null}s._init.call(this,l),t.call(this)}n(a,t),Object.assign(a.prototype,s.prototype),a.prototype._new=function(l){return new a(l)},a.prototype._write=function(l,u,c){this._appendBuffer(l),typeof c=="function"&&c()},a.prototype._read=function(l){if(!this.length)return this.push(null);l=Math.min(l,this.length),this.push(this.slice(0,l)),this.consume(l)},a.prototype.end=function(l){t.prototype.end.call(this,l),this._callback&&(this._callback(null,this.slice()),this._callback=null)},a.prototype._destroy=function(l,u){this._bufs.length=0,this.length=0,u(l)},a.prototype._isBufferList=function(l){return l instanceof a||l instanceof s||a.isBufferList(l)},a.isBufferList=s.isBufferList,e.exports=a,e.exports.BufferListStream=a,e.exports.BufferList=s}),B6=Rt((i,e)=>{_t(),Et(),St();var t=class{constructor(){this.cmd=null,this.retain=!1,this.qos=0,this.dup=!1,this.length=-1,this.topic=null,this.payload=null}};e.exports=t}),vE=Rt((i,e)=>{_t(),Et(),St();var t=e.exports,{Buffer:n}=(ni(),dr(ti));t.types={0:"reserved",1:"connect",2:"connack",3:"publish",4:"puback",5:"pubrec",6:"pubrel",7:"pubcomp",8:"subscribe",9:"suback",10:"unsubscribe",11:"unsuback",12:"pingreq",13:"pingresp",14:"disconnect",15:"auth"},t.requiredHeaderFlags={1:0,2:0,4:0,5:0,6:2,7:0,8:2,9:0,10:2,11:0,12:0,13:0,14:0,15:0},t.requiredHeaderFlagsErrors={};for(let a in t.requiredHeaderFlags){let l=t.requiredHeaderFlags[a];t.requiredHeaderFlagsErrors[a]="Invalid header flag bits, must be 0x"+l.toString(16)+" for "+t.types[a]+" packet"}t.codes={};for(let a in t.types){let l=t.types[a];t.codes[l]=a}t.CMD_SHIFT=4,t.CMD_MASK=240,t.DUP_MASK=8,t.QOS_MASK=3,t.QOS_SHIFT=1,t.RETAIN_MASK=1,t.VARBYTEINT_MASK=127,t.VARBYTEINT_FIN_MASK=128,t.VARBYTEINT_MAX=268435455,t.SESSIONPRESENT_MASK=1,t.SESSIONPRESENT_HEADER=n.from([t.SESSIONPRESENT_MASK]),t.CONNACK_HEADER=n.from([t.codes.connack<<t.CMD_SHIFT]),t.USERNAME_MASK=128,t.PASSWORD_MASK=64,t.WILL_RETAIN_MASK=32,t.WILL_QOS_MASK=24,t.WILL_QOS_SHIFT=3,t.WILL_FLAG_MASK=4,t.CLEAN_SESSION_MASK=2,t.CONNECT_HEADER=n.from([t.codes.connect<<t.CMD_SHIFT]),t.properties={sessionExpiryInterval:17,willDelayInterval:24,receiveMaximum:33,maximumPacketSize:39,topicAliasMaximum:34,requestResponseInformation:25,requestProblemInformation:23,userProperties:38,authenticationMethod:21,authenticationData:22,payloadFormatIndicator:1,messageExpiryInterval:2,contentType:3,responseTopic:8,correlationData:9,maximumQoS:36,retainAvailable:37,assignedClientIdentifier:18,reasonString:31,wildcardSubscriptionAvailable:40,subscriptionIdentifiersAvailable:41,sharedSubscriptionAvailable:42,serverKeepAlive:19,responseInformation:26,serverReference:28,topicAlias:35,subscriptionIdentifier:11},t.propertiesCodes={};for(let a in t.properties){let l=t.properties[a];t.propertiesCodes[l]=a}t.propertiesTypes={sessionExpiryInterval:"int32",willDelayInterval:"int32",receiveMaximum:"int16",maximumPacketSize:"int32",topicAliasMaximum:"int16",requestResponseInformation:"byte",requestProblemInformation:"byte",userProperties:"pair",authenticationMethod:"string",authenticationData:"binary",payloadFormatIndicator:"byte",messageExpiryInterval:"int32",contentType:"string",responseTopic:"string",correlationData:"binary",maximumQoS:"int8",retainAvailable:"byte",assignedClientIdentifier:"string",reasonString:"string",wildcardSubscriptionAvailable:"byte",subscriptionIdentifiersAvailable:"byte",sharedSubscriptionAvailable:"byte",serverKeepAlive:"int16",responseInformation:"string",serverReference:"string",topicAlias:"int16",subscriptionIdentifier:"var"};function s(a){return[0,1,2].map(l=>[0,1].map(u=>[0,1].map(c=>{let f=n.alloc(1);return f.writeUInt8(t.codes[a]<<t.CMD_SHIFT|(u?t.DUP_MASK:0)|l<<t.QOS_SHIFT|c,0,!0),f})))}t.PUBLISH_HEADER=s("publish"),t.SUBSCRIBE_HEADER=s("subscribe"),t.SUBSCRIBE_OPTIONS_QOS_MASK=3,t.SUBSCRIBE_OPTIONS_NL_MASK=1,t.SUBSCRIBE_OPTIONS_NL_SHIFT=2,t.SUBSCRIBE_OPTIONS_RAP_MASK=1,t.SUBSCRIBE_OPTIONS_RAP_SHIFT=3,t.SUBSCRIBE_OPTIONS_RH_MASK=3,t.SUBSCRIBE_OPTIONS_RH_SHIFT=4,t.SUBSCRIBE_OPTIONS_RH=[0,16,32],t.SUBSCRIBE_OPTIONS_NL=4,t.SUBSCRIBE_OPTIONS_RAP=8,t.SUBSCRIBE_OPTIONS_QOS=[0,1,2],t.UNSUBSCRIBE_HEADER=s("unsubscribe"),t.ACKS={unsuback:s("unsuback"),puback:s("puback"),pubcomp:s("pubcomp"),pubrel:s("pubrel"),pubrec:s("pubrec")},t.SUBACK_HEADER=n.from([t.codes.suback<<t.CMD_SHIFT]),t.VERSION3=n.from([3]),t.VERSION4=n.from([4]),t.VERSION5=n.from([5]),t.VERSION131=n.from([131]),t.VERSION132=n.from([132]),t.QOS=[0,1,2].map(a=>n.from([a])),t.EMPTY={pingreq:n.from([t.codes.pingreq<<4,0]),pingresp:n.from([t.codes.pingresp<<4,0]),disconnect:n.from([t.codes.disconnect<<4,0])},t.MQTT5_PUBACK_PUBREC_CODES={0:"Success",16:"No matching subscribers",128:"Unspecified error",131:"Implementation specific error",135:"Not authorized",144:"Topic Name invalid",145:"Packet identifier in use",151:"Quota exceeded",153:"Payload format invalid"},t.MQTT5_PUBREL_PUBCOMP_CODES={0:"Success",146:"Packet Identifier not found"},t.MQTT5_SUBACK_CODES={0:"Granted QoS 0",1:"Granted QoS 1",2:"Granted QoS 2",128:"Unspecified error",131:"Implementation specific error",135:"Not authorized",143:"Topic Filter invalid",145:"Packet Identifier in use",151:"Quota exceeded",158:"Shared Subscriptions not supported",161:"Subscription Identifiers not supported",162:"Wildcard Subscriptions not supported"},t.MQTT5_UNSUBACK_CODES={0:"Success",17:"No subscription existed",128:"Unspecified error",131:"Implementation specific error",135:"Not authorized",143:"Topic Filter invalid",145:"Packet Identifier in use"},t.MQTT5_DISCONNECT_CODES={0:"Normal disconnection",4:"Disconnect with Will Message",128:"Unspecified error",129:"Malformed Packet",130:"Protocol Error",131:"Implementation specific error",135:"Not authorized",137:"Server busy",139:"Server shutting down",141:"Keep Alive timeout",142:"Session taken over",143:"Topic Filter invalid",144:"Topic Name invalid",147:"Receive Maximum exceeded",148:"Topic Alias invalid",149:"Packet too large",150:"Message rate too high",151:"Quota exceeded",152:"Administrative action",153:"Payload format invalid",154:"Retain not supported",155:"QoS not supported",156:"Use another server",157:"Server moved",158:"Shared Subscriptions not supported",159:"Connection rate exceeded",160:"Maximum connect time",161:"Subscription Identifiers not supported",162:"Wildcard Subscriptions not supported"},t.MQTT5_AUTH_CODES={0:"Success",24:"Continue authentication",25:"Re-authenticate"}}),j6=Rt((i,e)=>{_t(),Et(),St();var t=1e3,n=t*60,s=n*60,a=s*24,l=a*7,u=a*365.25;e.exports=function(m,v){v=v||{};var b=typeof m;if(b==="string"&&m.length>0)return c(m);if(b==="number"&&isFinite(m))return v.long?d(m):f(m);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(m))};function c(m){if(m=String(m),!(m.length>100)){var v=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(m);if(v){var b=parseFloat(v[1]),y=(v[2]||"ms").toLowerCase();switch(y){case"years":case"year":case"yrs":case"yr":case"y":return b*u;case"weeks":case"week":case"w":return b*l;case"days":case"day":case"d":return b*a;case"hours":case"hour":case"hrs":case"hr":case"h":return b*s;case"minutes":case"minute":case"mins":case"min":case"m":return b*n;case"seconds":case"second":case"secs":case"sec":case"s":return b*t;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return b;default:return}}}}function f(m){var v=Math.abs(m);return v>=a?Math.round(m/a)+"d":v>=s?Math.round(m/s)+"h":v>=n?Math.round(m/n)+"m":v>=t?Math.round(m/t)+"s":m+"ms"}function d(m){var v=Math.abs(m);return v>=a?p(m,v,a,"day"):v>=s?p(m,v,s,"hour"):v>=n?p(m,v,n,"minute"):v>=t?p(m,v,t,"second"):m+" ms"}function p(m,v,b,y){var w=v>=b*1.5;return Math.round(m/b)+" "+y+(w?"s":"")}}),D6=Rt((i,e)=>{_t(),Et(),St();function t(n){a.debug=a,a.default=a,a.coerce=p,a.disable=f,a.enable=u,a.enabled=d,a.humanize=j6(),a.destroy=m,Object.keys(n).forEach(v=>{a[v]=n[v]}),a.names=[],a.skips=[],a.formatters={};function s(v){let b=0;for(let y=0;y<v.length;y++)b=(b<<5)-b+v.charCodeAt(y),b|=0;return a.colors[Math.abs(b)%a.colors.length]}a.selectColor=s;function a(v){let b,y=null,w,C;function S(...x){if(!S.enabled)return;let k=S,A=Number(new Date),R=A-(b||A);k.diff=R,k.prev=b,k.curr=A,b=A,x[0]=a.coerce(x[0]),typeof x[0]!="string"&&x.unshift("%O");let I=0;x[0]=x[0].replace(/%([a-zA-Z%])/g,(U,te)=>{if(U==="%%")return"%";I++;let G=a.formatters[te];if(typeof G=="function"){let Y=x[I];U=G.call(k,Y),x.splice(I,1),I--}return U}),a.formatArgs.call(k,x),(k.log||a.log).apply(k,x)}return S.namespace=v,S.useColors=a.useColors(),S.color=a.selectColor(v),S.extend=l,S.destroy=a.destroy,Object.defineProperty(S,"enabled",{enumerable:!0,configurable:!1,get:()=>y!==null?y:(w!==a.namespaces&&(w=a.namespaces,C=a.enabled(v)),C),set:x=>{y=x}}),typeof a.init=="function"&&a.init(S),S}function l(v,b){let y=a(this.namespace+(typeof b>"u"?":":b)+v);return y.log=this.log,y}function u(v){a.save(v),a.namespaces=v,a.names=[],a.skips=[];let b=(typeof v=="string"?v:"").trim().replace(/\s+/g,",").split(",").filter(Boolean);for(let y of b)y[0]==="-"?a.skips.push(y.slice(1)):a.names.push(y)}function c(v,b){let y=0,w=0,C=-1,S=0;for(;y<v.length;)if(w<b.length&&(b[w]===v[y]||b[w]==="*"))b[w]==="*"?(C=w,S=y,w++):(y++,w++);else if(C!==-1)w=C+1,S++,y=S;else return!1;for(;w<b.length&&b[w]==="*";)w++;return w===b.length}function f(){let v=[...a.names,...a.skips.map(b=>"-"+b)].join(",");return a.enable(""),v}function d(v){for(let b of a.skips)if(c(v,b))return!1;for(let b of a.names)if(c(v,b))return!0;return!1}function p(v){return v instanceof Error?v.stack||v.message:v}function m(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")}return a.enable(a.load()),a}e.exports=t}),Ro=Rt((i,e)=>{_t(),Et(),St(),i.formatArgs=n,i.save=s,i.load=a,i.useColors=t,i.storage=l(),i.destroy=(()=>{let c=!1;return()=>{c||(c=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),i.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function t(){if(typeof window<"u"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs))return!0;if(typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))return!1;let c;return typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&(c=navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/))&&parseInt(c[1],10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}function n(c){if(c[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+c[0]+(this.useColors?"%c ":" ")+"+"+e.exports.humanize(this.diff),!this.useColors)return;let f="color: "+this.color;c.splice(1,0,f,"color: inherit");let d=0,p=0;c[0].replace(/%[a-zA-Z%]/g,m=>{m!=="%%"&&(d++,m==="%c"&&(p=d))}),c.splice(p,0,f)}i.log=console.debug||console.log||(()=>{});function s(c){try{c?i.storage.setItem("debug",c):i.storage.removeItem("debug")}catch{}}function a(){let c;try{c=i.storage.getItem("debug")||i.storage.getItem("DEBUG")}catch{}return!c&&typeof vr<"u"&&"env"in vr&&(c=vr.env.DEBUG),c}function l(){try{return localStorage}catch{}}e.exports=D6()(i);var{formatters:u}=e.exports;u.j=function(c){try{return JSON.stringify(c)}catch(f){return"[UnexpectedJSONParseError]: "+f.message}}}),P6=Rt((i,e)=>{_t(),Et(),St();var t=N6(),{EventEmitter:n}=(Nl(),dr(qa)),s=B6(),a=vE(),l=Ro()("mqtt-packet:parser"),u=class Bm extends n{constructor(){super(),this.parser=this.constructor.parser}static parser(f){return this instanceof Bm?(this.settings=f||{},this._states=["_parseHeader","_parseLength","_parsePayload","_newPacket"],this._resetState(),this):new Bm().parser(f)}_resetState(){l("_resetState: resetting packet, error, _list, and _stateCounter"),this.packet=new s,this.error=null,this._list=t(),this._stateCounter=0}parse(f){for(this.error&&this._resetState(),this._list.append(f),l("parse: current state: %s",this._states[this._stateCounter]);(this.packet.length!==-1||this._list.length>0)&&this[this._states[this._stateCounter]]()&&!this.error;)this._stateCounter++,l("parse: state complete. _stateCounter is now: %d",this._stateCounter),l("parse: packet.length: %d, buffer list length: %d",this.packet.length,this._list.length),this._stateCounter>=this._states.length&&(this._stateCounter=0);return l("parse: exited while loop. packet: %d, buffer list length: %d",this.packet.length,this._list.length),this._list.length}_parseHeader(){let f=this._list.readUInt8(0),d=f>>a.CMD_SHIFT;this.packet.cmd=a.types[d];let p=f&15,m=a.requiredHeaderFlags[d];return m!=null&&p!==m?this._emitError(new Error(a.requiredHeaderFlagsErrors[d])):(this.packet.retain=(f&a.RETAIN_MASK)!==0,this.packet.qos=f>>a.QOS_SHIFT&a.QOS_MASK,this.packet.qos>2?this._emitError(new Error("Packet must not have both QoS bits set to 1")):(this.packet.dup=(f&a.DUP_MASK)!==0,l("_parseHeader: packet: %o",this.packet),this._list.consume(1),!0))}_parseLength(){let f=this._parseVarByteNum(!0);return f&&(this.packet.length=f.value,this._list.consume(f.bytes)),l("_parseLength %d",f.value),!!f}_parsePayload(){l("_parsePayload: payload %O",this._list);let f=!1;if(this.packet.length===0||this._list.length>=this.packet.length){switch(this._pos=0,this.packet.cmd){case"connect":this._parseConnect();break;case"connack":this._parseConnack();break;case"publish":this._parsePublish();break;case"puback":case"pubrec":case"pubrel":case"pubcomp":this._parseConfirmation();break;case"subscribe":this._parseSubscribe();break;case"suback":this._parseSuback();break;case"unsubscribe":this._parseUnsubscribe();break;case"unsuback":this._parseUnsuback();break;case"pingreq":case"pingresp":break;case"disconnect":this._parseDisconnect();break;case"auth":this._parseAuth();break;default:this._emitError(new Error("Not supported"))}f=!0}return l("_parsePayload complete result: %s",f),f}_parseConnect(){l("_parseConnect");let f,d,p,m,v={},b=this.packet,y=this._parseString();if(y===null)return this._emitError(new Error("Cannot parse protocolId"));if(y!=="MQTT"&&y!=="MQIsdp")return this._emitError(new Error("Invalid protocolId"));if(b.protocolId=y,this._pos>=this._list.length)return this._emitError(new Error("Packet too short"));if(b.protocolVersion=this._list.readUInt8(this._pos),b.protocolVersion>=128&&(b.bridgeMode=!0,b.protocolVersion=b.protocolVersion-128),b.protocolVersion!==3&&b.protocolVersion!==4&&b.protocolVersion!==5)return this._emitError(new Error("Invalid protocol version"));if(this._pos++,this._pos>=this._list.length)return this._emitError(new Error("Packet too short"));if(this._list.readUInt8(this._pos)&1)return this._emitError(new Error("Connect flag bit 0 must be 0, but got 1"));v.username=this._list.readUInt8(this._pos)&a.USERNAME_MASK,v.password=this._list.readUInt8(this._pos)&a.PASSWORD_MASK,v.will=this._list.readUInt8(this._pos)&a.WILL_FLAG_MASK;let w=!!(this._list.readUInt8(this._pos)&a.WILL_RETAIN_MASK),C=(this._list.readUInt8(this._pos)&a.WILL_QOS_MASK)>>a.WILL_QOS_SHIFT;if(v.will)b.will={},b.will.retain=w,b.will.qos=C;else{if(w)return this._emitError(new Error("Will Retain Flag must be set to zero when Will Flag is set to 0"));if(C)return this._emitError(new Error("Will QoS must be set to zero when Will Flag is set to 0"))}if(b.clean=(this._list.readUInt8(this._pos)&a.CLEAN_SESSION_MASK)!==0,this._pos++,b.keepalive=this._parseNum(),b.keepalive===-1)return this._emitError(new Error("Packet too short"));if(b.protocolVersion===5){let x=this._parseProperties();Object.getOwnPropertyNames(x).length&&(b.properties=x)}let S=this._parseString();if(S===null)return this._emitError(new Error("Packet too short"));if(b.clientId=S,l("_parseConnect: packet.clientId: %s",b.clientId),v.will){if(b.protocolVersion===5){let x=this._parseProperties();Object.getOwnPropertyNames(x).length&&(b.will.properties=x)}if(f=this._parseString(),f===null)return this._emitError(new Error("Cannot parse will topic"));if(b.will.topic=f,l("_parseConnect: packet.will.topic: %s",b.will.topic),d=this._parseBuffer(),d===null)return this._emitError(new Error("Cannot parse will payload"));b.will.payload=d,l("_parseConnect: packet.will.paylaod: %s",b.will.payload)}if(v.username){if(m=this._parseString(),m===null)return this._emitError(new Error("Cannot parse username"));b.username=m,l("_parseConnect: packet.username: %s",b.username)}if(v.password){if(p=this._parseBuffer(),p===null)return this._emitError(new Error("Cannot parse password"));b.password=p}return this.settings=b,l("_parseConnect: complete"),b}_parseConnack(){l("_parseConnack");let f=this.packet;if(this._list.length<1)return null;let d=this._list.readUInt8(this._pos++);if(d>1)return this._emitError(new Error("Invalid connack flags, bits 7-1 must be set to 0"));if(f.sessionPresent=!!(d&a.SESSIONPRESENT_MASK),this.settings.protocolVersion===5)this._list.length>=2?f.reasonCode=this._list.readUInt8(this._pos++):f.reasonCode=0;else{if(this._list.length<2)return null;f.returnCode=this._list.readUInt8(this._pos++)}if(f.returnCode===-1||f.reasonCode===-1)return this._emitError(new Error("Cannot parse return code"));if(this.settings.protocolVersion===5){let p=this._parseProperties();Object.getOwnPropertyNames(p).length&&(f.properties=p)}l("_parseConnack: complete")}_parsePublish(){l("_parsePublish");let f=this.packet;if(f.topic=this._parseString(),f.topic===null)return this._emitError(new Error("Cannot parse topic"));if(!(f.qos>0&&!this._parseMessageId())){if(this.settings.protocolVersion===5){let d=this._parseProperties();Object.getOwnPropertyNames(d).length&&(f.properties=d)}f.payload=this._list.slice(this._pos,f.length),l("_parsePublish: payload from buffer list: %o",f.payload)}}_parseSubscribe(){l("_parseSubscribe");let f=this.packet,d,p,m,v,b,y,w;if(f.subscriptions=[],!!this._parseMessageId()){if(this.settings.protocolVersion===5){let C=this._parseProperties();Object.getOwnPropertyNames(C).length&&(f.properties=C)}if(f.length<=0)return this._emitError(new Error("Malformed subscribe, no payload specified"));for(;this._pos<f.length;){if(d=this._parseString(),d===null)return this._emitError(new Error("Cannot parse topic"));if(this._pos>=f.length)return this._emitError(new Error("Malformed Subscribe Payload"));if(p=this._parseByte(),this.settings.protocolVersion===5){if(p&192)return this._emitError(new Error("Invalid subscribe topic flag bits, bits 7-6 must be 0"))}else if(p&252)return this._emitError(new Error("Invalid subscribe topic flag bits, bits 7-2 must be 0"));if(m=p&a.SUBSCRIBE_OPTIONS_QOS_MASK,m>2)return this._emitError(new Error("Invalid subscribe QoS, must be <= 2"));if(y=(p>>a.SUBSCRIBE_OPTIONS_NL_SHIFT&a.SUBSCRIBE_OPTIONS_NL_MASK)!==0,b=(p>>a.SUBSCRIBE_OPTIONS_RAP_SHIFT&a.SUBSCRIBE_OPTIONS_RAP_MASK)!==0,v=p>>a.SUBSCRIBE_OPTIONS_RH_SHIFT&a.SUBSCRIBE_OPTIONS_RH_MASK,v>2)return this._emitError(new Error("Invalid retain handling, must be <= 2"));w={topic:d,qos:m},this.settings.protocolVersion===5?(w.nl=y,w.rap=b,w.rh=v):this.settings.bridgeMode&&(w.rh=0,w.rap=!0,w.nl=!0),l("_parseSubscribe: push subscription `%s` to subscription",w),f.subscriptions.push(w)}}}_parseSuback(){l("_parseSuback");let f=this.packet;if(this.packet.granted=[],!!this._parseMessageId()){if(this.settings.protocolVersion===5){let d=this._parseProperties();Object.getOwnPropertyNames(d).length&&(f.properties=d)}if(f.length<=0)return this._emitError(new Error("Malformed suback, no payload specified"));for(;this._pos<this.packet.length;){let d=this._list.readUInt8(this._pos++);if(this.settings.protocolVersion===5){if(!a.MQTT5_SUBACK_CODES[d])return this._emitError(new Error("Invalid suback code"))}else if(d>2&&d!==128)return this._emitError(new Error("Invalid suback QoS, must be 0, 1, 2 or 128"));this.packet.granted.push(d)}}}_parseUnsubscribe(){l("_parseUnsubscribe");let f=this.packet;if(f.unsubscriptions=[],!!this._parseMessageId()){if(this.settings.protocolVersion===5){let d=this._parseProperties();Object.getOwnPropertyNames(d).length&&(f.properties=d)}if(f.length<=0)return this._emitError(new Error("Malformed unsubscribe, no payload specified"));for(;this._pos<f.length;){let d=this._parseString();if(d===null)return this._emitError(new Error("Cannot parse topic"));l("_parseUnsubscribe: push topic `%s` to unsubscriptions",d),f.unsubscriptions.push(d)}}}_parseUnsuback(){l("_parseUnsuback");let f=this.packet;if(!this._parseMessageId())return this._emitError(new Error("Cannot parse messageId"));if((this.settings.protocolVersion===3||this.settings.protocolVersion===4)&&f.length!==2)return this._emitError(new Error("Malformed unsuback, payload length must be 2"));if(f.length<=0)return this._emitError(new Error("Malformed unsuback, no payload specified"));if(this.settings.protocolVersion===5){let d=this._parseProperties();for(Object.getOwnPropertyNames(d).length&&(f.properties=d),f.granted=[];this._pos<this.packet.length;){let p=this._list.readUInt8(this._pos++);if(!a.MQTT5_UNSUBACK_CODES[p])return this._emitError(new Error("Invalid unsuback code"));this.packet.granted.push(p)}}}_parseConfirmation(){l("_parseConfirmation: packet.cmd: `%s`",this.packet.cmd);let f=this.packet;if(this._parseMessageId(),this.settings.protocolVersion===5){if(f.length>2){switch(f.reasonCode=this._parseByte(),this.packet.cmd){case"puback":case"pubrec":if(!a.MQTT5_PUBACK_PUBREC_CODES[f.reasonCode])return this._emitError(new Error("Invalid "+this.packet.cmd+" reason code"));break;case"pubrel":case"pubcomp":if(!a.MQTT5_PUBREL_PUBCOMP_CODES[f.reasonCode])return this._emitError(new Error("Invalid "+this.packet.cmd+" reason code"));break}l("_parseConfirmation: packet.reasonCode `%d`",f.reasonCode)}else f.reasonCode=0;if(f.length>3){let d=this._parseProperties();Object.getOwnPropertyNames(d).length&&(f.properties=d)}}return!0}_parseDisconnect(){let f=this.packet;if(l("_parseDisconnect"),this.settings.protocolVersion===5){this._list.length>0?(f.reasonCode=this._parseByte(),a.MQTT5_DISCONNECT_CODES[f.reasonCode]||this._emitError(new Error("Invalid disconnect reason code"))):f.reasonCode=0;let d=this._parseProperties();Object.getOwnPropertyNames(d).length&&(f.properties=d)}return l("_parseDisconnect result: true"),!0}_parseAuth(){l("_parseAuth");let f=this.packet;if(this.settings.protocolVersion!==5)return this._emitError(new Error("Not supported auth packet for this version MQTT"));if(f.reasonCode=this._parseByte(),!a.MQTT5_AUTH_CODES[f.reasonCode])return this._emitError(new Error("Invalid auth reason code"));let d=this._parseProperties();return Object.getOwnPropertyNames(d).length&&(f.properties=d),l("_parseAuth: result: true"),!0}_parseMessageId(){let f=this.packet;return f.messageId=this._parseNum(),f.messageId===null?(this._emitError(new Error("Cannot parse messageId")),!1):(l("_parseMessageId: packet.messageId %d",f.messageId),!0)}_parseString(f){let d=this._parseNum(),p=d+this._pos;if(d===-1||p>this._list.length||p>this.packet.length)return null;let m=this._list.toString("utf8",this._pos,p);return this._pos+=d,l("_parseString: result: %s",m),m}_parseStringPair(){return l("_parseStringPair"),{name:this._parseString(),value:this._parseString()}}_parseBuffer(){let f=this._parseNum(),d=f+this._pos;if(f===-1||d>this._list.length||d>this.packet.length)return null;let p=this._list.slice(this._pos,d);return this._pos+=f,l("_parseBuffer: result: %o",p),p}_parseNum(){if(this._list.length-this._pos<2)return-1;let f=this._list.readUInt16BE(this._pos);return this._pos+=2,l("_parseNum: result: %s",f),f}_parse4ByteNum(){if(this._list.length-this._pos<4)return-1;let f=this._list.readUInt32BE(this._pos);return this._pos+=4,l("_parse4ByteNum: result: %s",f),f}_parseVarByteNum(f){l("_parseVarByteNum");let d=4,p=0,m=1,v=0,b=!1,y,w=this._pos?this._pos:0;for(;p<d&&w+p<this._list.length;){if(y=this._list.readUInt8(w+p++),v+=m*(y&a.VARBYTEINT_MASK),m*=128,(y&a.VARBYTEINT_FIN_MASK)===0){b=!0;break}if(this._list.length<=p)break}return!b&&p===d&&this._list.length>=p&&this._emitError(new Error("Invalid variable byte integer")),w&&(this._pos+=p),b?f?b={bytes:p,value:v}:b=v:b=!1,l("_parseVarByteNum: result: %o",b),b}_parseByte(){let f;return this._pos<this._list.length&&(f=this._list.readUInt8(this._pos),this._pos++),l("_parseByte: result: %o",f),f}_parseByType(f){switch(l("_parseByType: type: %s",f),f){case"byte":return this._parseByte()!==0;case"int8":return this._parseByte();case"int16":return this._parseNum();case"int32":return this._parse4ByteNum();case"var":return this._parseVarByteNum();case"string":return this._parseString();case"pair":return this._parseStringPair();case"binary":return this._parseBuffer()}}_parseProperties(){l("_parseProperties");let f=this._parseVarByteNum(),d=this._pos+f,p={};for(;this._pos<d;){let m=this._parseByte();if(!m)return this._emitError(new Error("Cannot parse property code type")),!1;let v=a.propertiesCodes[m];if(!v)return this._emitError(new Error("Unknown property")),!1;if(v==="userProperties"){p[v]||(p[v]=Object.create(null));let b=this._parseByType(a.propertiesTypes[v]);if(p[v][b.name])if(Array.isArray(p[v][b.name]))p[v][b.name].push(b.value);else{let y=p[v][b.name];p[v][b.name]=[y],p[v][b.name].push(b.value)}else p[v][b.name]=b.value;continue}p[v]?Array.isArray(p[v])?p[v].push(this._parseByType(a.propertiesTypes[v])):(p[v]=[p[v]],p[v].push(this._parseByType(a.propertiesTypes[v]))):p[v]=this._parseByType(a.propertiesTypes[v])}return p}_newPacket(){return l("_newPacket"),this.packet&&(this._list.consume(this.packet.length),l("_newPacket: parser emit packet: packet.cmd: %s, packet.payload: %s, packet.length: %d",this.packet.cmd,this.packet.payload,this.packet.length),this.emit("packet",this.packet)),l("_newPacket: new packet"),this.packet=new s,this._pos=0,!0}_emitError(f){l("_emitError",f),this.error=f,this.emit("error",f)}};e.exports=u}),L6=Rt((i,e)=>{_t(),Et(),St();var{Buffer:t}=(ni(),dr(ti)),n=65536,s={},a=t.isBuffer(t.from([1,2]).subarray(0,1));function l(d){let p=t.allocUnsafe(2);return p.writeUInt8(d>>8,0),p.writeUInt8(d&255,1),p}function u(){for(let d=0;d<n;d++)s[d]=l(d)}function c(d){let p=0,m=0,v=t.allocUnsafe(4);do p=d%128|0,d=d/128|0,d>0&&(p=p|128),v.writeUInt8(p,m++);while(d>0&&m<4);return d>0&&(m=0),a?v.subarray(0,m):v.slice(0,m)}function f(d){let p=t.allocUnsafe(4);return p.writeUInt32BE(d,0),p}e.exports={cache:s,generateCache:u,generateNumber:l,genBufVariableByteInt:c,generate4ByteBuffer:f}}),U6=Rt((i,e)=>{_t(),Et(),St(),typeof vr>"u"||!vr.version||vr.version.indexOf("v0.")===0||vr.version.indexOf("v1.")===0&&vr.version.indexOf("v1.8.")!==0?e.exports={nextTick:t}:e.exports=vr;function t(n,s,a,l){if(typeof n!="function")throw new TypeError('"callback" argument must be a function');var u=arguments.length,c,f;switch(u){case 0:case 1:return vr.nextTick(n);case 2:return vr.nextTick(function(){n.call(null,s)});case 3:return vr.nextTick(function(){n.call(null,s,a)});case 4:return vr.nextTick(function(){n.call(null,s,a,l)});default:for(c=new Array(u-1),f=0;f<c.length;)c[f++]=arguments[f];return vr.nextTick(function(){n.apply(null,c)})}}}),wE=Rt((i,e)=>{_t(),Et(),St();var t=vE(),{Buffer:n}=(ni(),dr(ti)),s=n.allocUnsafe(0),a=n.from([0]),l=L6(),u=U6().nextTick,c=Ro()("mqtt-packet:writeToStream"),f=l.cache,d=l.generateNumber,p=l.generateCache,m=l.genBufVariableByteInt,v=l.generate4ByteBuffer,b=ne,y=!0;function w(Te,ve,ke){switch(c("generate called"),ve.cork&&(ve.cork(),u(C,ve)),y&&(y=!1,p()),c("generate: packet.cmd: %s",Te.cmd),Te.cmd){case"connect":return S(Te,ve);case"connack":return x(Te,ve,ke);case"publish":return k(Te,ve,ke);case"puback":case"pubrec":case"pubrel":case"pubcomp":return A(Te,ve,ke);case"subscribe":return R(Te,ve,ke);case"suback":return I(Te,ve,ke);case"unsubscribe":return U(Te,ve,ke);case"unsuback":return te(Te,ve,ke);case"pingreq":case"pingresp":return G(Te,ve);case"disconnect":return Y(Te,ve,ke);case"auth":return O(Te,ve,ke);default:return ve.destroy(new Error("Unknown command")),!1}}Object.defineProperty(w,"cacheNumbers",{get(){return b===ne},set(Te){Te?((!f||Object.keys(f).length===0)&&(y=!0),b=ne):(y=!1,b=B)}});function C(Te){Te.uncork()}function S(Te,ve,ke){let Me=Te||{},Ie=Me.protocolId||"MQTT",Ce=Me.protocolVersion||4,ot=Me.will,et=Me.clean,me=Me.keepalive||0,de=Me.clientId||"",Be=Me.username,Je=Me.password,rt=Me.properties;et===void 0&&(et=!0);let at=0;if(typeof Ie!="string"&&!n.isBuffer(Ie))return ve.destroy(new Error("Invalid protocolId")),!1;if(at+=Ie.length+2,Ce!==3&&Ce!==4&&Ce!==5)return ve.destroy(new Error("Invalid protocol version")),!1;if(at+=1,(typeof de=="string"||n.isBuffer(de))&&(de||Ce>=4)&&(de||et))at+=n.byteLength(de)+2;else{if(Ce<4)return ve.destroy(new Error("clientId must be supplied before 3.1.1")),!1;if(et*1===0)return ve.destroy(new Error("clientId must be given if cleanSession set to 0")),!1}if(typeof me!="number"||me<0||me>65535||me%1!==0)return ve.destroy(new Error("Invalid keepalive")),!1;at+=2,at+=1;let ye,it;if(Ce===5){if(ye=V(ve,rt),!ye)return!1;at+=ye.length}if(ot){if(typeof ot!="object")return ve.destroy(new Error("Invalid will")),!1;if(!ot.topic||typeof ot.topic!="string")return ve.destroy(new Error("Invalid will topic")),!1;if(at+=n.byteLength(ot.topic)+2,at+=2,ot.payload)if(ot.payload.length>=0)typeof ot.payload=="string"?at+=n.byteLength(ot.payload):at+=ot.payload.length;else return ve.destroy(new Error("Invalid will payload")),!1;if(it={},Ce===5){if(it=V(ve,ot.properties),!it)return!1;at+=it.length}}let Mt=!1;if(Be!=null)if(Ge(Be))Mt=!0,at+=n.byteLength(Be)+2;else return ve.destroy(new Error("Invalid username")),!1;if(Je!=null){if(!Mt)return ve.destroy(new Error("Username is required to use password")),!1;if(Ge(Je))at+=be(Je)+2;else return ve.destroy(new Error("Invalid password")),!1}ve.write(t.CONNECT_HEADER),Q(ve,at),$(ve,Ie),Me.bridgeMode&&(Ce+=128),ve.write(Ce===131?t.VERSION131:Ce===132?t.VERSION132:Ce===4?t.VERSION4:Ce===5?t.VERSION5:t.VERSION3);let nt=0;return nt|=Be!=null?t.USERNAME_MASK:0,nt|=Je!=null?t.PASSWORD_MASK:0,nt|=ot&&ot.retain?t.WILL_RETAIN_MASK:0,nt|=ot&&ot.qos?ot.qos<<t.WILL_QOS_SHIFT:0,nt|=ot?t.WILL_FLAG_MASK:0,nt|=et?t.CLEAN_SESSION_MASK:0,ve.write(n.from([nt])),b(ve,me),Ce===5&&ye.write(),$(ve,de),ot&&(Ce===5&&it.write(),q(ve,ot.topic),$(ve,ot.payload)),Be!=null&&$(ve,Be),Je!=null&&$(ve,Je),!0}function x(Te,ve,ke){let Me=ke?ke.protocolVersion:4,Ie=Te||{},Ce=Me===5?Ie.reasonCode:Ie.returnCode,ot=Ie.properties,et=2;if(typeof Ce!="number")return ve.destroy(new Error("Invalid return code")),!1;let me=null;if(Me===5){if(me=V(ve,ot),!me)return!1;et+=me.length}return ve.write(t.CONNACK_HEADER),Q(ve,et),ve.write(Ie.sessionPresent?t.SESSIONPRESENT_HEADER:a),ve.write(n.from([Ce])),me?.write(),!0}function k(Te,ve,ke){c("publish: packet: %o",Te);let Me=ke?ke.protocolVersion:4,Ie=Te||{},Ce=Ie.qos||0,ot=Ie.retain?t.RETAIN_MASK:0,et=Ie.topic,me=Ie.payload||s,de=Ie.messageId,Be=Ie.properties,Je=0;if(typeof et=="string")Je+=n.byteLength(et)+2;else if(n.isBuffer(et))Je+=et.length+2;else return ve.destroy(new Error("Invalid topic")),!1;if(n.isBuffer(me)?Je+=me.length:Je+=n.byteLength(me),Ce&&typeof de!="number")return ve.destroy(new Error("Invalid messageId")),!1;Ce&&(Je+=2);let rt=null;if(Me===5){if(rt=V(ve,Be),!rt)return!1;Je+=rt.length}return ve.write(t.PUBLISH_HEADER[Ce][Ie.dup?1:0][ot?1:0]),Q(ve,Je),b(ve,be(et)),ve.write(et),Ce>0&&b(ve,de),rt?.write(),c("publish: payload: %o",me),ve.write(me)}function A(Te,ve,ke){let Me=ke?ke.protocolVersion:4,Ie=Te||{},Ce=Ie.cmd||"puback",ot=Ie.messageId,et=Ie.dup&&Ce==="pubrel"?t.DUP_MASK:0,me=0,de=Ie.reasonCode,Be=Ie.properties,Je=Me===5?3:2;if(Ce==="pubrel"&&(me=1),typeof ot!="number")return ve.destroy(new Error("Invalid messageId")),!1;let rt=null;if(Me===5&&typeof Be=="object"){if(rt=Z(ve,Be,ke,Je),!rt)return!1;Je+=rt.length}return ve.write(t.ACKS[Ce][me][et][0]),Je===3&&(Je+=de!==0?1:-1),Q(ve,Je),b(ve,ot),Me===5&&Je!==2&&ve.write(n.from([de])),rt!==null?rt.write():Je===4&&ve.write(n.from([0])),!0}function R(Te,ve,ke){c("subscribe: packet: ");let Me=ke?ke.protocolVersion:4,Ie=Te||{},Ce=Ie.dup?t.DUP_MASK:0,ot=Ie.messageId,et=Ie.subscriptions,me=Ie.properties,de=0;if(typeof ot!="number")return ve.destroy(new Error("Invalid messageId")),!1;de+=2;let Be=null;if(Me===5){if(Be=V(ve,me),!Be)return!1;de+=Be.length}if(typeof et=="object"&&et.length)for(let rt=0;rt<et.length;rt+=1){let at=et[rt].topic,ye=et[rt].qos;if(typeof at!="string")return ve.destroy(new Error("Invalid subscriptions - invalid topic")),!1;if(typeof ye!="number")return ve.destroy(new Error("Invalid subscriptions - invalid qos")),!1;if(Me===5){if(typeof(et[rt].nl||!1)!="boolean")return ve.destroy(new Error("Invalid subscriptions - invalid No Local")),!1;if(typeof(et[rt].rap||!1)!="boolean")return ve.destroy(new Error("Invalid subscriptions - invalid Retain as Published")),!1;let it=et[rt].rh||0;if(typeof it!="number"||it>2)return ve.destroy(new Error("Invalid subscriptions - invalid Retain Handling")),!1}de+=n.byteLength(at)+2+1}else return ve.destroy(new Error("Invalid subscriptions")),!1;c("subscribe: writing to stream: %o",t.SUBSCRIBE_HEADER),ve.write(t.SUBSCRIBE_HEADER[1][Ce?1:0][0]),Q(ve,de),b(ve,ot),Be!==null&&Be.write();let Je=!0;for(let rt of et){let at=rt.topic,ye=rt.qos,it=+rt.nl,Mt=+rt.rap,nt=rt.rh,Zt;q(ve,at),Zt=t.SUBSCRIBE_OPTIONS_QOS[ye],Me===5&&(Zt|=it?t.SUBSCRIBE_OPTIONS_NL:0,Zt|=Mt?t.SUBSCRIBE_OPTIONS_RAP:0,Zt|=nt?t.SUBSCRIBE_OPTIONS_RH[nt]:0),Je=ve.write(n.from([Zt]))}return Je}function I(Te,ve,ke){let Me=ke?ke.protocolVersion:4,Ie=Te||{},Ce=Ie.messageId,ot=Ie.granted,et=Ie.properties,me=0;if(typeof Ce!="number")return ve.destroy(new Error("Invalid messageId")),!1;if(me+=2,typeof ot=="object"&&ot.length)for(let Be=0;Be<ot.length;Be+=1){if(typeof ot[Be]!="number")return ve.destroy(new Error("Invalid qos vector")),!1;me+=1}else return ve.destroy(new Error("Invalid qos vector")),!1;let de=null;if(Me===5){if(de=Z(ve,et,ke,me),!de)return!1;me+=de.length}return ve.write(t.SUBACK_HEADER),Q(ve,me),b(ve,Ce),de!==null&&de.write(),ve.write(n.from(ot))}function U(Te,ve,ke){let Me=ke?ke.protocolVersion:4,Ie=Te||{},Ce=Ie.messageId,ot=Ie.dup?t.DUP_MASK:0,et=Ie.unsubscriptions,me=Ie.properties,de=0;if(typeof Ce!="number")return ve.destroy(new Error("Invalid messageId")),!1;if(de+=2,typeof et=="object"&&et.length)for(let rt=0;rt<et.length;rt+=1){if(typeof et[rt]!="string")return ve.destroy(new Error("Invalid unsubscriptions")),!1;de+=n.byteLength(et[rt])+2}else return ve.destroy(new Error("Invalid unsubscriptions")),!1;let Be=null;if(Me===5){if(Be=V(ve,me),!Be)return!1;de+=Be.length}ve.write(t.UNSUBSCRIBE_HEADER[1][ot?1:0][0]),Q(ve,de),b(ve,Ce),Be!==null&&Be.write();let Je=!0;for(let rt=0;rt<et.length;rt++)Je=q(ve,et[rt]);return Je}function te(Te,ve,ke){let Me=ke?ke.protocolVersion:4,Ie=Te||{},Ce=Ie.messageId,ot=Ie.dup?t.DUP_MASK:0,et=Ie.granted,me=Ie.properties,de=Ie.cmd,Be=0,Je=2;if(typeof Ce!="number")return ve.destroy(new Error("Invalid messageId")),!1;if(Me===5)if(typeof et=="object"&&et.length)for(let at=0;at<et.length;at+=1){if(typeof et[at]!="number")return ve.destroy(new Error("Invalid qos vector")),!1;Je+=1}else return ve.destroy(new Error("Invalid qos vector")),!1;let rt=null;if(Me===5){if(rt=Z(ve,me,ke,Je),!rt)return!1;Je+=rt.length}return ve.write(t.ACKS[de][Be][ot][0]),Q(ve,Je),b(ve,Ce),rt!==null&&rt.write(),Me===5&&ve.write(n.from(et)),!0}function G(Te,ve,ke){return ve.write(t.EMPTY[Te.cmd])}function Y(Te,ve,ke){let Me=ke?ke.protocolVersion:4,Ie=Te||{},Ce=Ie.reasonCode,ot=Ie.properties,et=Me===5?1:0,me=null;if(Me===5){if(me=Z(ve,ot,ke,et),!me)return!1;et+=me.length}return ve.write(n.from([t.codes.disconnect<<4])),Q(ve,et),Me===5&&ve.write(n.from([Ce])),me!==null&&me.write(),!0}function O(Te,ve,ke){let Me=ke?ke.protocolVersion:4,Ie=Te||{},Ce=Ie.reasonCode,ot=Ie.properties,et=Me===5?1:0;Me!==5&&ve.destroy(new Error("Invalid mqtt version for auth packet"));let me=Z(ve,ot,ke,et);return me?(et+=me.length,ve.write(n.from([t.codes.auth<<4])),Q(ve,et),ve.write(n.from([Ce])),me!==null&&me.write(),!0):!1}var N={};function Q(Te,ve){if(ve>t.VARBYTEINT_MAX)return Te.destroy(new Error(`Invalid variable byte integer: ${ve}`)),!1;let ke=N[ve];return ke||(ke=m(ve),ve<16384&&(N[ve]=ke)),c("writeVarByteInt: writing to stream: %o",ke),Te.write(ke)}function q(Te,ve){let ke=n.byteLength(ve);return b(Te,ke),c("writeString: %s",ve),Te.write(ve,"utf8")}function ee(Te,ve,ke){q(Te,ve),q(Te,ke)}function ne(Te,ve){return c("writeNumberCached: number: %d",ve),c("writeNumberCached: %o",f[ve]),Te.write(f[ve])}function B(Te,ve){let ke=d(ve);return c("writeNumberGenerated: %o",ke),Te.write(ke)}function z(Te,ve){let ke=v(ve);return c("write4ByteNumber: %o",ke),Te.write(ke)}function $(Te,ve){typeof ve=="string"?q(Te,ve):ve?(b(Te,ve.length),Te.write(ve)):b(Te,0)}function V(Te,ve){if(typeof ve!="object"||ve.length!=null)return{length:1,write(){Ae(Te,{},0)}};let ke=0;function Me(Ie,Ce){let ot=t.propertiesTypes[Ie],et=0;switch(ot){case"byte":{if(typeof Ce!="boolean")return Te.destroy(new Error(`Invalid ${Ie}: ${Ce}`)),!1;et+=2;break}case"int8":{if(typeof Ce!="number"||Ce<0||Ce>255)return Te.destroy(new Error(`Invalid ${Ie}: ${Ce}`)),!1;et+=2;break}case"binary":{if(Ce&&Ce===null)return Te.destroy(new Error(`Invalid ${Ie}: ${Ce}`)),!1;et+=1+n.byteLength(Ce)+2;break}case"int16":{if(typeof Ce!="number"||Ce<0||Ce>65535)return Te.destroy(new Error(`Invalid ${Ie}: ${Ce}`)),!1;et+=3;break}case"int32":{if(typeof Ce!="number"||Ce<0||Ce>4294967295)return Te.destroy(new Error(`Invalid ${Ie}: ${Ce}`)),!1;et+=5;break}case"var":{if(typeof Ce!="number"||Ce<0||Ce>268435455)return Te.destroy(new Error(`Invalid ${Ie}: ${Ce}`)),!1;et+=1+n.byteLength(m(Ce));break}case"string":{if(typeof Ce!="string")return Te.destroy(new Error(`Invalid ${Ie}: ${Ce}`)),!1;et+=3+n.byteLength(Ce.toString());break}case"pair":{if(typeof Ce!="object")return Te.destroy(new Error(`Invalid ${Ie}: ${Ce}`)),!1;et+=Object.getOwnPropertyNames(Ce).reduce((me,de)=>{let Be=Ce[de];return Array.isArray(Be)?me+=Be.reduce((Je,rt)=>(Je+=3+n.byteLength(de.toString())+2+n.byteLength(rt.toString()),Je),0):me+=3+n.byteLength(de.toString())+2+n.byteLength(Ce[de].toString()),me},0);break}default:return Te.destroy(new Error(`Invalid property ${Ie}: ${Ce}`)),!1}return et}if(ve)for(let Ie in ve){let Ce=0,ot=0,et=ve[Ie];if(et!==void 0){if(Array.isArray(et))for(let me=0;me<et.length;me++){if(ot=Me(Ie,et[me]),!ot)return!1;Ce+=ot}else{if(ot=Me(Ie,et),!ot)return!1;Ce=ot}if(!Ce)return!1;ke+=Ce}}return{length:n.byteLength(m(ke))+ke,write(){Ae(Te,ve,ke)}}}function Z(Te,ve,ke,Me){let Ie=["reasonString","userProperties"],Ce=ke&&ke.properties&&ke.properties.maximumPacketSize?ke.properties.maximumPacketSize:0,ot=V(Te,ve);if(Ce)for(;Me+ot.length>Ce;){let et=Ie.shift();if(et&&ve[et])delete ve[et],ot=V(Te,ve);else return!1}return ot}function ae(Te,ve,ke){switch(t.propertiesTypes[ve]){case"byte":{Te.write(n.from([t.properties[ve]])),Te.write(n.from([+ke]));break}case"int8":{Te.write(n.from([t.properties[ve]])),Te.write(n.from([ke]));break}case"binary":{Te.write(n.from([t.properties[ve]])),$(Te,ke);break}case"int16":{Te.write(n.from([t.properties[ve]])),b(Te,ke);break}case"int32":{Te.write(n.from([t.properties[ve]])),z(Te,ke);break}case"var":{Te.write(n.from([t.properties[ve]])),Q(Te,ke);break}case"string":{Te.write(n.from([t.properties[ve]])),q(Te,ke);break}case"pair":{Object.getOwnPropertyNames(ke).forEach(Me=>{let Ie=ke[Me];Array.isArray(Ie)?Ie.forEach(Ce=>{Te.write(n.from([t.properties[ve]])),ee(Te,Me.toString(),Ce.toString())}):(Te.write(n.from([t.properties[ve]])),ee(Te,Me.toString(),Ie.toString()))});break}default:return Te.destroy(new Error(`Invalid property ${ve} value: ${ke}`)),!1}}function Ae(Te,ve,ke){Q(Te,ke);for(let Me in ve)if(Object.prototype.hasOwnProperty.call(ve,Me)&&ve[Me]!=null){let Ie=ve[Me];if(Array.isArray(Ie))for(let Ce=0;Ce<Ie.length;Ce++)ae(Te,Me,Ie[Ce]);else ae(Te,Me,Ie)}}function be(Te){return Te?Te instanceof n?Te.length:n.byteLength(Te):0}function Ge(Te){return typeof Te=="string"||Te instanceof n}e.exports=w}),q6=Rt((i,e)=>{_t(),Et(),St();var t=wE(),{EventEmitter:n}=(Nl(),dr(qa)),{Buffer:s}=(ni(),dr(ti));function a(u,c){let f=new l;return t(u,f,c),f.concat()}var l=class extends n{constructor(){super(),this._array=new Array(20),this._i=0}write(u){return this._array[this._i++]=u,!0}concat(){let u=0,c=new Array(this._array.length),f=this._array,d=0,p;for(p=0;p<f.length&&f[p]!==void 0;p++)typeof f[p]!="string"?c[p]=f[p].length:c[p]=s.byteLength(f[p]),u+=c[p];let m=s.allocUnsafe(u);for(p=0;p<f.length&&f[p]!==void 0;p++)typeof f[p]!="string"?(f[p].copy(m,d),d+=c[p]):(m.write(f[p],d),d+=c[p]);return m}destroy(u){u&&this.emit("error",u)}};e.exports=a}),F6=Rt(i=>{_t(),Et(),St(),i.parser=P6().parser,i.generate=q6(),i.writeToStream=wE()}),H6=Rt((i,e)=>{_t(),Et(),St(),e.exports=n;function t(a){return a instanceof id?id.from(a):new a.constructor(a.buffer.slice(),a.byteOffset,a.length)}function n(a){if(a=a||{},a.circles)return s(a);let l=new Map;if(l.set(Date,p=>new Date(p)),l.set(Map,(p,m)=>new Map(c(Array.from(p),m))),l.set(Set,(p,m)=>new Set(c(Array.from(p),m))),a.constructorHandlers)for(let p of a.constructorHandlers)l.set(p[0],p[1]);let u=null;return a.proto?d:f;function c(p,m){let v=Object.keys(p),b=new Array(v.length);for(let y=0;y<v.length;y++){let w=v[y],C=p[w];typeof C!="object"||C===null?b[w]=C:C.constructor!==Object&&(u=l.get(C.constructor))?b[w]=u(C,m):ArrayBuffer.isView(C)?b[w]=t(C):b[w]=m(C)}return b}function f(p){if(typeof p!="object"||p===null)return p;if(Array.isArray(p))return c(p,f);if(p.constructor!==Object&&(u=l.get(p.constructor)))return u(p,f);let m={};for(let v in p){if(Object.hasOwnProperty.call(p,v)===!1)continue;let b=p[v];typeof b!="object"||b===null?m[v]=b:b.constructor!==Object&&(u=l.get(b.constructor))?m[v]=u(b,f):ArrayBuffer.isView(b)?m[v]=t(b):m[v]=f(b)}return m}function d(p){if(typeof p!="object"||p===null)return p;if(Array.isArray(p))return c(p,d);if(p.constructor!==Object&&(u=l.get(p.constructor)))return u(p,d);let m={};for(let v in p){let b=p[v];typeof b!="object"||b===null?m[v]=b:b.constructor!==Object&&(u=l.get(b.constructor))?m[v]=u(b,d):ArrayBuffer.isView(b)?m[v]=t(b):m[v]=d(b)}return m}}function s(a){let l=[],u=[],c=new Map;if(c.set(Date,v=>new Date(v)),c.set(Map,(v,b)=>new Map(d(Array.from(v),b))),c.set(Set,(v,b)=>new Set(d(Array.from(v),b))),a.constructorHandlers)for(let v of a.constructorHandlers)c.set(v[0],v[1]);let f=null;return a.proto?m:p;function d(v,b){let y=Object.keys(v),w=new Array(y.length);for(let C=0;C<y.length;C++){let S=y[C],x=v[S];if(typeof x!="object"||x===null)w[S]=x;else if(x.constructor!==Object&&(f=c.get(x.constructor)))w[S]=f(x,b);else if(ArrayBuffer.isView(x))w[S]=t(x);else{let k=l.indexOf(x);k!==-1?w[S]=u[k]:w[S]=b(x)}}return w}function p(v){if(typeof v!="object"||v===null)return v;if(Array.isArray(v))return d(v,p);if(v.constructor!==Object&&(f=c.get(v.constructor)))return f(v,p);let b={};l.push(v),u.push(b);for(let y in v){if(Object.hasOwnProperty.call(v,y)===!1)continue;let w=v[y];if(typeof w!="object"||w===null)b[y]=w;else if(w.constructor!==Object&&(f=c.get(w.constructor)))b[y]=f(w,p);else if(ArrayBuffer.isView(w))b[y]=t(w);else{let C=l.indexOf(w);C!==-1?b[y]=u[C]:b[y]=p(w)}}return l.pop(),u.pop(),b}function m(v){if(typeof v!="object"||v===null)return v;if(Array.isArray(v))return d(v,m);if(v.constructor!==Object&&(f=c.get(v.constructor)))return f(v,m);let b={};l.push(v),u.push(b);for(let y in v){let w=v[y];if(typeof w!="object"||w===null)b[y]=w;else if(w.constructor!==Object&&(f=c.get(w.constructor)))b[y]=f(w,m);else if(ArrayBuffer.isView(w))b[y]=t(w);else{let C=l.indexOf(w);C!==-1?b[y]=u[C]:b[y]=m(w)}}return l.pop(),u.pop(),b}}}),z6=Rt((i,e)=>{_t(),Et(),St(),e.exports=H6()()}),G6=Rt(i=>{_t(),Et(),St(),Object.defineProperty(i,"__esModule",{value:!0}),i.validateTopic=e,i.validateTopics=t;function e(n){let s=n.split("/");for(let a=0;a<s.length;a++)if(s[a]!=="+"){if(s[a]==="#")return a===s.length-1;if(s[a].indexOf("+")!==-1||s[a].indexOf("#")!==-1)return!1}return!0}function t(n){if(n.length===0)return"empty_topic_list";for(let s=0;s<n.length;s++)if(!e(n[s]))return n[s];return null}}),xE=Rt(i=>{_t(),Et(),St(),Object.defineProperty(i,"__esModule",{value:!0});var e=jl(),t={objectMode:!0},n={clean:!0},s=class{options;_inflights;constructor(a){this.options=a||{},this.options={...n,...a},this._inflights=new Map}put(a,l){return this._inflights.set(a.messageId,a),l&&l(),this}createStream(){let a=new e.Readable(t),l=[],u=!1,c=0;return this._inflights.forEach((f,d)=>{l.push(f)}),a._read=()=>{!u&&c<l.length?a.push(l[c++]):a.push(null)},a.destroy=f=>{if(!u)return u=!0,setTimeout(()=>{a.emit("close")},0),a},a}del(a,l){let u=this._inflights.get(a.messageId);return u?(this._inflights.delete(a.messageId),l(null,u)):l&&l(new Error("missing packet")),this}get(a,l){let u=this._inflights.get(a.messageId);return u?l(null,u):l&&l(new Error("missing packet")),this}close(a){this.options.clean&&(this._inflights=null),a&&a()}};i.default=s}),K6=Rt(i=>{_t(),Et(),St(),Object.defineProperty(i,"__esModule",{value:!0});var e=[0,16,128,131,135,144,145,151,153],t=(n,s,a)=>{n.log("handlePublish: packet %o",s),a=typeof a<"u"?a:n.noop;let l=s.topic.toString(),u=s.payload,{qos:c}=s,{messageId:f}=s,{options:d}=n;if(n.options.protocolVersion===5){let p;if(s.properties&&(p=s.properties.topicAlias),typeof p<"u")if(l.length===0)if(p>0&&p<=65535){let m=n.topicAliasRecv.getTopicByAlias(p);if(m)l=m,n.log("handlePublish :: topic complemented by alias. topic: %s - alias: %d",l,p);else{n.log("handlePublish :: unregistered topic alias. alias: %d",p),n.emit("error",new Error("Received unregistered Topic Alias"));return}}else{n.log("handlePublish :: topic alias out of range. alias: %d",p),n.emit("error",new Error("Received Topic Alias is out of range"));return}else if(n.topicAliasRecv.put(l,p))n.log("handlePublish :: registered topic: %s - alias: %d",l,p);else{n.log("handlePublish :: topic alias out of range. alias: %d",p),n.emit("error",new Error("Received Topic Alias is out of range"));return}}switch(n.log("handlePublish: qos %d",c),c){case 2:{d.customHandleAcks(l,u,s,(p,m)=>{if(typeof p=="number"&&(m=p,p=null),p)return n.emit("error",p);if(e.indexOf(m)===-1)return n.emit("error",new Error("Wrong reason code for pubrec"));m?n._sendPacket({cmd:"pubrec",messageId:f,reasonCode:m},a):n.incomingStore.put(s,()=>{n._sendPacket({cmd:"pubrec",messageId:f},a)})});break}case 1:{d.customHandleAcks(l,u,s,(p,m)=>{if(typeof p=="number"&&(m=p,p=null),p)return n.emit("error",p);if(e.indexOf(m)===-1)return n.emit("error",new Error("Wrong reason code for puback"));m||n.emit("message",l,u,s),n.handleMessage(s,v=>{if(v)return a&&a(v);n._sendPacket({cmd:"puback",messageId:f,reasonCode:m},a)})});break}case 0:n.emit("message",l,u,s),n.handleMessage(s,a);break;default:n.log("handlePublish: unknown QoS. Doing nothing.");break}};i.default=t}),V6=Rt((i,e)=>{e.exports={version:"5.14.1"}}),Pc=Rt(i=>{_t(),Et(),St(),Object.defineProperty(i,"__esModule",{value:!0}),i.MQTTJS_VERSION=i.nextTick=i.ErrorWithSubackPacket=i.ErrorWithReasonCode=void 0,i.applyMixin=n;var e=class _E extends Error{code;constructor(a,l){super(a),this.code=l,Object.setPrototypeOf(this,_E.prototype),Object.getPrototypeOf(this).name="ErrorWithReasonCode"}};i.ErrorWithReasonCode=e;var t=class SE extends Error{packet;constructor(a,l){super(a),this.packet=l,Object.setPrototypeOf(this,SE.prototype),Object.getPrototypeOf(this).name="ErrorWithSubackPacket"}};i.ErrorWithSubackPacket=t;function n(s,a,l=!1){let u=[a];for(;;){let c=u[0],f=Object.getPrototypeOf(c);if(f?.prototype)u.unshift(f);else break}for(let c of u)for(let f of Object.getOwnPropertyNames(c.prototype))(l||f!=="constructor")&&Object.defineProperty(s.prototype,f,Object.getOwnPropertyDescriptor(c.prototype,f)??Object.create(null))}i.nextTick=typeof vr?.nextTick=="function"?vr.nextTick:s=>{setTimeout(s,0)},i.MQTTJS_VERSION=V6().version}),xd=Rt(i=>{_t(),Et(),St(),Object.defineProperty(i,"__esModule",{value:!0}),i.ReasonCodes=void 0;var e=Pc();i.ReasonCodes={0:"",1:"Unacceptable protocol version",2:"Identifier rejected",3:"Server unavailable",4:"Bad username or password",5:"Not authorized",16:"No matching subscribers",17:"No subscription existed",128:"Unspecified error",129:"Malformed Packet",130:"Protocol Error",131:"Implementation specific error",132:"Unsupported Protocol Version",133:"Client Identifier not valid",134:"Bad User Name or Password",135:"Not authorized",136:"Server unavailable",137:"Server busy",138:"Banned",139:"Server shutting down",140:"Bad authentication method",141:"Keep Alive timeout",142:"Session taken over",143:"Topic Filter invalid",144:"Topic Name invalid",145:"Packet identifier in use",146:"Packet Identifier not found",147:"Receive Maximum exceeded",148:"Topic Alias invalid",149:"Packet too large",150:"Message rate too high",151:"Quota exceeded",152:"Administrative action",153:"Payload format invalid",154:"Retain not supported",155:"QoS not supported",156:"Use another server",157:"Server moved",158:"Shared Subscriptions not supported",159:"Connection rate exceeded",160:"Maximum connect time",161:"Subscription Identifiers not supported",162:"Wildcard Subscriptions not supported"};var t=(n,s)=>{let{messageId:a}=s,l=s.cmd,u=null,c=n.outgoing[a]?n.outgoing[a].cb:null,f=null;if(!c){n.log("_handleAck :: Server sent an ack in error. Ignoring.");return}switch(n.log("_handleAck :: packet type",l),l){case"pubcomp":case"puback":{let d=s.reasonCode;d&&d>0&&d!==16?(f=new e.ErrorWithReasonCode(`Publish error: ${i.ReasonCodes[d]}`,d),n._removeOutgoingAndStoreMessage(a,()=>{c(f,s)})):n._removeOutgoingAndStoreMessage(a,c);break}case"pubrec":{u={cmd:"pubrel",qos:2,messageId:a};let d=s.reasonCode;d&&d>0&&d!==16?(f=new e.ErrorWithReasonCode(`Publish error: ${i.ReasonCodes[d]}`,d),n._removeOutgoingAndStoreMessage(a,()=>{c(f,s)})):n._sendPacket(u);break}case"suback":{delete n.outgoing[a],n.messageIdProvider.deallocate(a);let d=s.granted;for(let p=0;p<d.length;p++){let m=d[p];if((m&128)!==0){f=new Error(`Subscribe error: ${i.ReasonCodes[m]}`),f.code=m;let v=n.messageIdToTopic[a];v&&v.forEach(b=>{delete n._resubscribeTopics[b]})}}delete n.messageIdToTopic[a],n._invokeStoreProcessingQueue(),c(f,s);break}case"unsuback":{delete n.outgoing[a],n.messageIdProvider.deallocate(a),n._invokeStoreProcessingQueue(),c(null,s);break}default:n.emit("error",new Error("unrecognized packet type"))}n.disconnecting&&Object.keys(n.outgoing).length===0&&n.emit("outgoingEmpty")};i.default=t}),$6=Rt(i=>{_t(),Et(),St(),Object.defineProperty(i,"__esModule",{value:!0});var e=Pc(),t=xd(),n=(s,a)=>{let{options:l}=s,u=l.protocolVersion,c=u===5?a.reasonCode:a.returnCode;if(u!==5){let f=new e.ErrorWithReasonCode(`Protocol error: Auth packets are only supported in MQTT 5. Your version:${u}`,c);s.emit("error",f);return}s.handleAuth(a,(f,d)=>{if(f){s.emit("error",f);return}if(c===24)s.reconnecting=!1,s._sendPacket(d);else{let p=new e.ErrorWithReasonCode(`Connection refused: ${t.ReasonCodes[c]}`,c);s.emit("error",p)}})};i.default=n}),Y6=Rt(i=>{_t(),Et(),St(),Object.defineProperty(i,"__esModule",{value:!0}),i.LRUCache=void 0;var e=typeof performance=="object"&&performance&&typeof performance.now=="function"?performance:Date,t=new Set,n=typeof vr=="object"&&vr?vr:{},s=(v,b,y,w)=>{typeof n.emitWarning=="function"?n.emitWarning(v,b,y,w):console.error(`[${y}] ${b}: ${v}`)},a=globalThis.AbortController,l=globalThis.AbortSignal;if(typeof a>"u"){l=class{onabort;_onabort=[];reason;aborted=!1;addEventListener(y,w){this._onabort.push(w)}},a=class{constructor(){b()}signal=new l;abort(y){if(!this.signal.aborted){this.signal.reason=y,this.signal.aborted=!0;for(let w of this.signal._onabort)w(y);this.signal.onabort?.(y)}}};let v=n.env?.LRU_CACHE_IGNORE_AC_WARNING!=="1",b=()=>{v&&(v=!1,s("AbortController is not defined. If using lru-cache in node 14, load an AbortController polyfill from the `node-abort-controller` package. A minimal polyfill is provided for use by LRUCache.fetch(), but it should not be relied upon in other contexts (eg, passing it to other APIs that use AbortController/AbortSignal might have undesirable effects). You may disable this with LRU_CACHE_IGNORE_AC_WARNING=1 in the env.","NO_ABORT_CONTROLLER","ENOTSUP",b))}}var u=v=>!t.has(v),c=v=>v&&v===Math.floor(v)&&v>0&&isFinite(v),f=v=>c(v)?v<=Math.pow(2,8)?Uint8Array:v<=Math.pow(2,16)?Uint16Array:v<=Math.pow(2,32)?Uint32Array:v<=Number.MAX_SAFE_INTEGER?d:null:null,d=class extends Array{constructor(v){super(v),this.fill(0)}},p=class Uu{heap;length;static#s=!1;static create(b){let y=f(b);if(!y)return[];Uu.#s=!0;let w=new Uu(b,y);return Uu.#s=!1,w}constructor(b,y){if(!Uu.#s)throw new TypeError("instantiate Stack using Stack.create(n)");this.heap=new y(b),this.length=0}push(b){this.heap[this.length++]=b}pop(){return this.heap[--this.length]}},m=class EE{#s;#f;#g;#m;#I;#R;ttl;ttlResolution;ttlAutopurge;updateAgeOnGet;updateAgeOnHas;allowStale;noDisposeOnSet;noUpdateTTL;maxEntrySize;sizeCalculation;noDeleteOnFetchRejection;noDeleteOnStaleGet;allowStaleOnFetchAbort;allowStaleOnFetchRejection;ignoreFetchAbort;#i;#y;#r;#n;#e;#c;#h;#l;#o;#b;#a;#v;#w;#d;#x;#A;#u;static unsafeExposeInternals(b){return{starts:b.#w,ttls:b.#d,sizes:b.#v,keyMap:b.#r,keyList:b.#n,valList:b.#e,next:b.#c,prev:b.#h,get head(){return b.#l},get tail(){return b.#o},free:b.#b,isBackgroundFetch:y=>b.#t(y),backgroundFetch:(y,w,C,S)=>b.#B(y,w,C,S),moveToTail:y=>b.#M(y),indexes:y=>b.#_(y),rindexes:y=>b.#S(y),isStale:y=>b.#p(y)}}get max(){return this.#s}get maxSize(){return this.#f}get calculatedSize(){return this.#y}get size(){return this.#i}get fetchMethod(){return this.#I}get memoMethod(){return this.#R}get dispose(){return this.#g}get disposeAfter(){return this.#m}constructor(b){let{max:y=0,ttl:w,ttlResolution:C=1,ttlAutopurge:S,updateAgeOnGet:x,updateAgeOnHas:k,allowStale:A,dispose:R,disposeAfter:I,noDisposeOnSet:U,noUpdateTTL:te,maxSize:G=0,maxEntrySize:Y=0,sizeCalculation:O,fetchMethod:N,memoMethod:Q,noDeleteOnFetchRejection:q,noDeleteOnStaleGet:ee,allowStaleOnFetchRejection:ne,allowStaleOnFetchAbort:B,ignoreFetchAbort:z}=b;if(y!==0&&!c(y))throw new TypeError("max option must be a nonnegative integer");let $=y?f(y):Array;if(!$)throw new Error("invalid max value: "+y);if(this.#s=y,this.#f=G,this.maxEntrySize=Y||this.#f,this.sizeCalculation=O,this.sizeCalculation){if(!this.#f&&!this.maxEntrySize)throw new TypeError("cannot set sizeCalculation without setting maxSize or maxEntrySize");if(typeof this.sizeCalculation!="function")throw new TypeError("sizeCalculation set to non-function")}if(Q!==void 0&&typeof Q!="function")throw new TypeError("memoMethod must be a function if defined");if(this.#R=Q,N!==void 0&&typeof N!="function")throw new TypeError("fetchMethod must be a function if specified");if(this.#I=N,this.#A=!!N,this.#r=new Map,this.#n=new Array(y).fill(void 0),this.#e=new Array(y).fill(void 0),this.#c=new $(y),this.#h=new $(y),this.#l=0,this.#o=0,this.#b=p.create(y),this.#i=0,this.#y=0,typeof R=="function"&&(this.#g=R),typeof I=="function"?(this.#m=I,this.#a=[]):(this.#m=void 0,this.#a=void 0),this.#x=!!this.#g,this.#u=!!this.#m,this.noDisposeOnSet=!!U,this.noUpdateTTL=!!te,this.noDeleteOnFetchRejection=!!q,this.allowStaleOnFetchRejection=!!ne,this.allowStaleOnFetchAbort=!!B,this.ignoreFetchAbort=!!z,this.maxEntrySize!==0){if(this.#f!==0&&!c(this.#f))throw new TypeError("maxSize must be a positive integer if specified");if(!c(this.maxEntrySize))throw new TypeError("maxEntrySize must be a positive integer if specified");this.#F()}if(this.allowStale=!!A,this.noDeleteOnStaleGet=!!ee,this.updateAgeOnGet=!!x,this.updateAgeOnHas=!!k,this.ttlResolution=c(C)||C===0?C:1,this.ttlAutopurge=!!S,this.ttl=w||0,this.ttl){if(!c(this.ttl))throw new TypeError("ttl must be a positive integer if specified");this.#j()}if(this.#s===0&&this.ttl===0&&this.#f===0)throw new TypeError("At least one of max, maxSize, or ttl is required");if(!this.ttlAutopurge&&!this.#s&&!this.#f){let V="LRU_CACHE_UNBOUNDED";u(V)&&(t.add(V),s("TTL caching without ttlAutopurge, max, or maxSize can result in unbounded memory consumption.","UnboundedCacheWarning",V,EE))}}getRemainingTTL(b){return this.#r.has(b)?1/0:0}#j(){let b=new d(this.#s),y=new d(this.#s);this.#d=b,this.#w=y,this.#D=(S,x,k=e.now())=>{if(y[S]=x!==0?k:0,b[S]=x,x!==0&&this.ttlAutopurge){let A=setTimeout(()=>{this.#p(S)&&this.#E(this.#n[S],"expire")},x+1);A.unref&&A.unref()}},this.#k=S=>{y[S]=b[S]!==0?e.now():0},this.#C=(S,x)=>{if(b[x]){let k=b[x],A=y[x];if(!k||!A)return;S.ttl=k,S.start=A,S.now=w||C();let R=S.now-A;S.remainingTTL=k-R}};let w=0,C=()=>{let S=e.now();if(this.ttlResolution>0){w=S;let x=setTimeout(()=>w=0,this.ttlResolution);x.unref&&x.unref()}return S};this.getRemainingTTL=S=>{let x=this.#r.get(S);if(x===void 0)return 0;let k=b[x],A=y[x];if(!k||!A)return 1/0;let R=(w||C())-A;return k-R},this.#p=S=>{let x=y[S],k=b[S];return!!k&&!!x&&(w||C())-x>k}}#k=()=>{};#C=()=>{};#D=()=>{};#p=()=>!1;#F(){let b=new d(this.#s);this.#y=0,this.#v=b,this.#T=y=>{this.#y-=b[y],b[y]=0},this.#P=(y,w,C,S)=>{if(this.#t(w))return 0;if(!c(C))if(S){if(typeof S!="function")throw new TypeError("sizeCalculation must be a function");if(C=S(w,y),!c(C))throw new TypeError("sizeCalculation return invalid (expect positive integer)")}else throw new TypeError("invalid size value (must be positive integer). When maxSize or maxEntrySize is used, sizeCalculation or size must be set.");return C},this.#O=(y,w,C)=>{if(b[y]=w,this.#f){let S=this.#f-b[y];for(;this.#y>S;)this.#N(!0)}this.#y+=b[y],C&&(C.entrySize=w,C.totalCalculatedSize=this.#y)}}#T=b=>{};#O=(b,y,w)=>{};#P=(b,y,w,C)=>{if(w||C)throw new TypeError("cannot set size without setting maxSize or maxEntrySize on cache");return 0};*#_({allowStale:b=this.allowStale}={}){if(this.#i)for(let y=this.#o;!(!this.#L(y)||((b||!this.#p(y))&&(yield y),y===this.#l));)y=this.#h[y]}*#S({allowStale:b=this.allowStale}={}){if(this.#i)for(let y=this.#l;!(!this.#L(y)||((b||!this.#p(y))&&(yield y),y===this.#o));)y=this.#c[y]}#L(b){return b!==void 0&&this.#r.get(this.#n[b])===b}*entries(){for(let b of this.#_())this.#e[b]!==void 0&&this.#n[b]!==void 0&&!this.#t(this.#e[b])&&(yield[this.#n[b],this.#e[b]])}*rentries(){for(let b of this.#S())this.#e[b]!==void 0&&this.#n[b]!==void 0&&!this.#t(this.#e[b])&&(yield[this.#n[b],this.#e[b]])}*keys(){for(let b of this.#_()){let y=this.#n[b];y!==void 0&&!this.#t(this.#e[b])&&(yield y)}}*rkeys(){for(let b of this.#S()){let y=this.#n[b];y!==void 0&&!this.#t(this.#e[b])&&(yield y)}}*values(){for(let b of this.#_())this.#e[b]!==void 0&&!this.#t(this.#e[b])&&(yield this.#e[b])}*rvalues(){for(let b of this.#S())this.#e[b]!==void 0&&!this.#t(this.#e[b])&&(yield this.#e[b])}[Symbol.iterator](){return this.entries()}[Symbol.toStringTag]="LRUCache";find(b,y={}){for(let w of this.#_()){let C=this.#e[w],S=this.#t(C)?C.__staleWhileFetching:C;if(S!==void 0&&b(S,this.#n[w],this))return this.get(this.#n[w],y)}}forEach(b,y=this){for(let w of this.#_()){let C=this.#e[w],S=this.#t(C)?C.__staleWhileFetching:C;S!==void 0&&b.call(y,S,this.#n[w],this)}}rforEach(b,y=this){for(let w of this.#S()){let C=this.#e[w],S=this.#t(C)?C.__staleWhileFetching:C;S!==void 0&&b.call(y,S,this.#n[w],this)}}purgeStale(){let b=!1;for(let y of this.#S({allowStale:!0}))this.#p(y)&&(this.#E(this.#n[y],"expire"),b=!0);return b}info(b){let y=this.#r.get(b);if(y===void 0)return;let w=this.#e[y],C=this.#t(w)?w.__staleWhileFetching:w;if(C===void 0)return;let S={value:C};if(this.#d&&this.#w){let x=this.#d[y],k=this.#w[y];if(x&&k){let A=x-(e.now()-k);S.ttl=A,S.start=Date.now()}}return this.#v&&(S.size=this.#v[y]),S}dump(){let b=[];for(let y of this.#_({allowStale:!0})){let w=this.#n[y],C=this.#e[y],S=this.#t(C)?C.__staleWhileFetching:C;if(S===void 0||w===void 0)continue;let x={value:S};if(this.#d&&this.#w){x.ttl=this.#d[y];let k=e.now()-this.#w[y];x.start=Math.floor(Date.now()-k)}this.#v&&(x.size=this.#v[y]),b.unshift([w,x])}return b}load(b){this.clear();for(let[y,w]of b){if(w.start){let C=Date.now()-w.start;w.start=e.now()-C}this.set(y,w.value,w)}}set(b,y,w={}){if(y===void 0)return this.delete(b),this;let{ttl:C=this.ttl,start:S,noDisposeOnSet:x=this.noDisposeOnSet,sizeCalculation:k=this.sizeCalculation,status:A}=w,{noUpdateTTL:R=this.noUpdateTTL}=w,I=this.#P(b,y,w.size||0,k);if(this.maxEntrySize&&I>this.maxEntrySize)return A&&(A.set="miss",A.maxEntrySizeExceeded=!0),this.#E(b,"set"),this;let U=this.#i===0?void 0:this.#r.get(b);if(U===void 0)U=this.#i===0?this.#o:this.#b.length!==0?this.#b.pop():this.#i===this.#s?this.#N(!1):this.#i,this.#n[U]=b,this.#e[U]=y,this.#r.set(b,U),this.#c[this.#o]=U,this.#h[U]=this.#o,this.#o=U,this.#i++,this.#O(U,I,A),A&&(A.set="add"),R=!1;else{this.#M(U);let te=this.#e[U];if(y!==te){if(this.#A&&this.#t(te)){te.__abortController.abort(new Error("replaced"));let{__staleWhileFetching:G}=te;G!==void 0&&!x&&(this.#x&&this.#g?.(G,b,"set"),this.#u&&this.#a?.push([G,b,"set"]))}else x||(this.#x&&this.#g?.(te,b,"set"),this.#u&&this.#a?.push([te,b,"set"]));if(this.#T(U),this.#O(U,I,A),this.#e[U]=y,A){A.set="replace";let G=te&&this.#t(te)?te.__staleWhileFetching:te;G!==void 0&&(A.oldValue=G)}}else A&&(A.set="update")}if(C!==0&&!this.#d&&this.#j(),this.#d&&(R||this.#D(U,C,S),A&&this.#C(A,U)),!x&&this.#u&&this.#a){let te=this.#a,G;for(;G=te?.shift();)this.#m?.(...G)}return this}pop(){try{for(;this.#i;){let b=this.#e[this.#l];if(this.#N(!0),this.#t(b)){if(b.__staleWhileFetching)return b.__staleWhileFetching}else if(b!==void 0)return b}}finally{if(this.#u&&this.#a){let b=this.#a,y;for(;y=b?.shift();)this.#m?.(...y)}}}#N(b){let y=this.#l,w=this.#n[y],C=this.#e[y];return this.#A&&this.#t(C)?C.__abortController.abort(new Error("evicted")):(this.#x||this.#u)&&(this.#x&&this.#g?.(C,w,"evict"),this.#u&&this.#a?.push([C,w,"evict"])),this.#T(y),b&&(this.#n[y]=void 0,this.#e[y]=void 0,this.#b.push(y)),this.#i===1?(this.#l=this.#o=0,this.#b.length=0):this.#l=this.#c[y],this.#r.delete(w),this.#i--,y}has(b,y={}){let{updateAgeOnHas:w=this.updateAgeOnHas,status:C}=y,S=this.#r.get(b);if(S!==void 0){let x=this.#e[S];if(this.#t(x)&&x.__staleWhileFetching===void 0)return!1;if(this.#p(S))C&&(C.has="stale",this.#C(C,S));else return w&&this.#k(S),C&&(C.has="hit",this.#C(C,S)),!0}else C&&(C.has="miss");return!1}peek(b,y={}){let{allowStale:w=this.allowStale}=y,C=this.#r.get(b);if(C===void 0||!w&&this.#p(C))return;let S=this.#e[C];return this.#t(S)?S.__staleWhileFetching:S}#B(b,y,w,C){let S=y===void 0?void 0:this.#e[y];if(this.#t(S))return S;let x=new a,{signal:k}=w;k?.addEventListener("abort",()=>x.abort(k.reason),{signal:x.signal});let A={signal:x.signal,options:w,context:C},R=(O,N=!1)=>{let{aborted:Q}=x.signal,q=w.ignoreFetchAbort&&O!==void 0;if(w.status&&(Q&&!N?(w.status.fetchAborted=!0,w.status.fetchError=x.signal.reason,q&&(w.status.fetchAbortIgnored=!0)):w.status.fetchResolved=!0),Q&&!q&&!N)return U(x.signal.reason);let ee=G;return this.#e[y]===G&&(O===void 0?ee.__staleWhileFetching?this.#e[y]=ee.__staleWhileFetching:this.#E(b,"fetch"):(w.status&&(w.status.fetchUpdated=!0),this.set(b,O,A.options))),O},I=O=>(w.status&&(w.status.fetchRejected=!0,w.status.fetchError=O),U(O)),U=O=>{let{aborted:N}=x.signal,Q=N&&w.allowStaleOnFetchAbort,q=Q||w.allowStaleOnFetchRejection,ee=q||w.noDeleteOnFetchRejection,ne=G;if(this.#e[y]===G&&(!ee||ne.__staleWhileFetching===void 0?this.#E(b,"fetch"):Q||(this.#e[y]=ne.__staleWhileFetching)),q)return w.status&&ne.__staleWhileFetching!==void 0&&(w.status.returnedStale=!0),ne.__staleWhileFetching;if(ne.__returned===ne)throw O},te=(O,N)=>{let Q=this.#I?.(b,S,A);Q&&Q instanceof Promise&&Q.then(q=>O(q===void 0?void 0:q),N),x.signal.addEventListener("abort",()=>{(!w.ignoreFetchAbort||w.allowStaleOnFetchAbort)&&(O(void 0),w.allowStaleOnFetchAbort&&(O=q=>R(q,!0)))})};w.status&&(w.status.fetchDispatched=!0);let G=new Promise(te).then(R,I),Y=Object.assign(G,{__abortController:x,__staleWhileFetching:S,__returned:void 0});return y===void 0?(this.set(b,Y,{...A.options,status:void 0}),y=this.#r.get(b)):this.#e[y]=Y,Y}#t(b){if(!this.#A)return!1;let y=b;return!!y&&y instanceof Promise&&y.hasOwnProperty("__staleWhileFetching")&&y.__abortController instanceof a}async fetch(b,y={}){let{allowStale:w=this.allowStale,updateAgeOnGet:C=this.updateAgeOnGet,noDeleteOnStaleGet:S=this.noDeleteOnStaleGet,ttl:x=this.ttl,noDisposeOnSet:k=this.noDisposeOnSet,size:A=0,sizeCalculation:R=this.sizeCalculation,noUpdateTTL:I=this.noUpdateTTL,noDeleteOnFetchRejection:U=this.noDeleteOnFetchRejection,allowStaleOnFetchRejection:te=this.allowStaleOnFetchRejection,ignoreFetchAbort:G=this.ignoreFetchAbort,allowStaleOnFetchAbort:Y=this.allowStaleOnFetchAbort,context:O,forceRefresh:N=!1,status:Q,signal:q}=y;if(!this.#A)return Q&&(Q.fetch="get"),this.get(b,{allowStale:w,updateAgeOnGet:C,noDeleteOnStaleGet:S,status:Q});let ee={allowStale:w,updateAgeOnGet:C,noDeleteOnStaleGet:S,ttl:x,noDisposeOnSet:k,size:A,sizeCalculation:R,noUpdateTTL:I,noDeleteOnFetchRejection:U,allowStaleOnFetchRejection:te,allowStaleOnFetchAbort:Y,ignoreFetchAbort:G,status:Q,signal:q},ne=this.#r.get(b);if(ne===void 0){Q&&(Q.fetch="miss");let B=this.#B(b,ne,ee,O);return B.__returned=B}else{let B=this.#e[ne];if(this.#t(B)){let Z=w&&B.__staleWhileFetching!==void 0;return Q&&(Q.fetch="inflight",Z&&(Q.returnedStale=!0)),Z?B.__staleWhileFetching:B.__returned=B}let z=this.#p(ne);if(!N&&!z)return Q&&(Q.fetch="hit"),this.#M(ne),C&&this.#k(ne),Q&&this.#C(Q,ne),B;let $=this.#B(b,ne,ee,O),V=$.__staleWhileFetching!==void 0&&w;return Q&&(Q.fetch=z?"stale":"refresh",V&&z&&(Q.returnedStale=!0)),V?$.__staleWhileFetching:$.__returned=$}}async forceFetch(b,y={}){let w=await this.fetch(b,y);if(w===void 0)throw new Error("fetch() returned undefined");return w}memo(b,y={}){let w=this.#R;if(!w)throw new Error("no memoMethod provided to constructor");let{context:C,forceRefresh:S,...x}=y,k=this.get(b,x);if(!S&&k!==void 0)return k;let A=w(b,k,{options:x,context:C});return this.set(b,A,x),A}get(b,y={}){let{allowStale:w=this.allowStale,updateAgeOnGet:C=this.updateAgeOnGet,noDeleteOnStaleGet:S=this.noDeleteOnStaleGet,status:x}=y,k=this.#r.get(b);if(k!==void 0){let A=this.#e[k],R=this.#t(A);return x&&this.#C(x,k),this.#p(k)?(x&&(x.get="stale"),R?(x&&w&&A.__staleWhileFetching!==void 0&&(x.returnedStale=!0),w?A.__staleWhileFetching:void 0):(S||this.#E(b,"expire"),x&&w&&(x.returnedStale=!0),w?A:void 0)):(x&&(x.get="hit"),R?A.__staleWhileFetching:(this.#M(k),C&&this.#k(k),A))}else x&&(x.get="miss")}#U(b,y){this.#h[y]=b,this.#c[b]=y}#M(b){b!==this.#o&&(b===this.#l?this.#l=this.#c[b]:this.#U(this.#h[b],this.#c[b]),this.#U(this.#o,b),this.#o=b)}delete(b){return this.#E(b,"delete")}#E(b,y){let w=!1;if(this.#i!==0){let C=this.#r.get(b);if(C!==void 0)if(w=!0,this.#i===1)this.#q(y);else{this.#T(C);let S=this.#e[C];if(this.#t(S)?S.__abortController.abort(new Error("deleted")):(this.#x||this.#u)&&(this.#x&&this.#g?.(S,b,y),this.#u&&this.#a?.push([S,b,y])),this.#r.delete(b),this.#n[C]=void 0,this.#e[C]=void 0,C===this.#o)this.#o=this.#h[C];else if(C===this.#l)this.#l=this.#c[C];else{let x=this.#h[C];this.#c[x]=this.#c[C];let k=this.#c[C];this.#h[k]=this.#h[C]}this.#i--,this.#b.push(C)}}if(this.#u&&this.#a?.length){let C=this.#a,S;for(;S=C?.shift();)this.#m?.(...S)}return w}clear(){return this.#q("delete")}#q(b){for(let y of this.#S({allowStale:!0})){let w=this.#e[y];if(this.#t(w))w.__abortController.abort(new Error("deleted"));else{let C=this.#n[y];this.#x&&this.#g?.(w,C,b),this.#u&&this.#a?.push([w,C,b])}}if(this.#r.clear(),this.#e.fill(void 0),this.#n.fill(void 0),this.#d&&this.#w&&(this.#d.fill(0),this.#w.fill(0)),this.#v&&this.#v.fill(0),this.#l=0,this.#o=0,this.#b.length=0,this.#y=0,this.#i=0,this.#u&&this.#a){let y=this.#a,w;for(;w=y?.shift();)this.#m?.(...w)}}};i.LRUCache=m}),jo=Rt(i=>{_t(),Et(),St(),Object.defineProperty(i,"t",{value:!0}),i.ContainerIterator=i.Container=i.Base=void 0;var e=class{constructor(s=0){this.iteratorType=s}equals(s){return this.o===s.o}};i.ContainerIterator=e;var t=class{constructor(){this.i=0}get length(){return this.i}size(){return this.i}empty(){return this.i===0}};i.Base=t;var n=class extends t{};i.Container=n}),W6=Rt(i=>{_t(),Et(),St(),Object.defineProperty(i,"t",{value:!0}),i.default=void 0;var e=jo(),t=class extends e.Base{constructor(s=[]){super(),this.S=[];let a=this;s.forEach(function(l){a.push(l)})}clear(){this.i=0,this.S=[]}push(s){return this.S.push(s),this.i+=1,this.i}pop(){if(this.i!==0)return this.i-=1,this.S.pop()}top(){return this.S[this.i-1]}},n=t;i.default=n}),Q6=Rt(i=>{_t(),Et(),St(),Object.defineProperty(i,"t",{value:!0}),i.default=void 0;var e=jo(),t=class extends e.Base{constructor(s=[]){super(),this.j=0,this.q=[];let a=this;s.forEach(function(l){a.push(l)})}clear(){this.q=[],this.i=this.j=0}push(s){let a=this.q.length;if(this.j/a>.5&&this.j+this.i>=a&&a>4096){let l=this.i;for(let u=0;u<l;++u)this.q[u]=this.q[this.j+u];this.j=0,this.q[this.i]=s}else this.q[this.j+this.i]=s;return++this.i}pop(){if(this.i===0)return;let s=this.q[this.j++];return this.i-=1,s}front(){if(this.i!==0)return this.q[this.j]}},n=t;i.default=n}),J6=Rt(i=>{_t(),Et(),St(),Object.defineProperty(i,"t",{value:!0}),i.default=void 0;var e=jo(),t=class extends e.Base{constructor(s=[],a=function(u,c){return u>c?-1:u<c?1:0},l=!0){if(super(),this.v=a,Array.isArray(s))this.C=l?[...s]:s;else{this.C=[];let c=this;s.forEach(function(f){c.C.push(f)})}this.i=this.C.length;let u=this.i>>1;for(let c=this.i-1>>1;c>=0;--c)this.k(c,u)}m(s){let a=this.C[s];for(;s>0;){let l=s-1>>1,u=this.C[l];if(this.v(u,a)<=0)break;this.C[s]=u,s=l}this.C[s]=a}k(s,a){let l=this.C[s];for(;s<a;){let u=s<<1|1,c=u+1,f=this.C[u];if(c<this.i&&this.v(f,this.C[c])>0&&(u=c,f=this.C[c]),this.v(f,l)>=0)break;this.C[s]=f,s=u}this.C[s]=l}clear(){this.i=0,this.C.length=0}push(s){this.C.push(s),this.m(this.i),this.i+=1}pop(){if(this.i===0)return;let s=this.C[0],a=this.C.pop();return this.i-=1,this.i&&(this.C[0]=a,this.k(0,this.i>>1)),s}top(){return this.C[0]}find(s){return this.C.indexOf(s)>=0}remove(s){let a=this.C.indexOf(s);return a<0?!1:(a===0?this.pop():a===this.i-1?(this.C.pop(),this.i-=1):(this.C.splice(a,1,this.C.pop()),this.i-=1,this.m(a),this.k(a,this.i>>1)),!0)}updateItem(s){let a=this.C.indexOf(s);return a<0?!1:(this.m(a),this.k(a,this.i>>1),!0)}toArray(){return[...this.C]}},n=t;i.default=n}),cb=Rt(i=>{_t(),Et(),St(),Object.defineProperty(i,"t",{value:!0}),i.default=void 0;var e=jo(),t=class extends e.Container{},n=t;i.default=n}),Do=Rt(i=>{_t(),Et(),St(),Object.defineProperty(i,"t",{value:!0}),i.throwIteratorAccessError=e;function e(){throw new RangeError("Iterator access denied!")}}),CE=Rt(i=>{_t(),Et(),St(),Object.defineProperty(i,"t",{value:!0}),i.RandomIterator=void 0;var e=jo(),t=Do(),n=class extends e.ContainerIterator{constructor(s,a){super(a),this.o=s,this.iteratorType===0?(this.pre=function(){return this.o===0&&(0,t.throwIteratorAccessError)(),this.o-=1,this},this.next=function(){return this.o===this.container.size()&&(0,t.throwIteratorAccessError)(),this.o+=1,this}):(this.pre=function(){return this.o===this.container.size()-1&&(0,t.throwIteratorAccessError)(),this.o+=1,this},this.next=function(){return this.o===-1&&(0,t.throwIteratorAccessError)(),this.o-=1,this})}get pointer(){return this.container.getElementByPos(this.o)}set pointer(s){this.container.setElementByPos(this.o,s)}};i.RandomIterator=n}),Z6=Rt(i=>{_t(),Et(),St(),Object.defineProperty(i,"t",{value:!0}),i.default=void 0;var e=n(cb()),t=CE();function n(u){return u&&u.t?u:{default:u}}var s=class AE extends t.RandomIterator{constructor(c,f,d){super(c,d),this.container=f}copy(){return new AE(this.o,this.container,this.iteratorType)}},a=class extends e.default{constructor(u=[],c=!0){if(super(),Array.isArray(u))this.J=c?[...u]:u,this.i=u.length;else{this.J=[];let f=this;u.forEach(function(d){f.pushBack(d)})}}clear(){this.i=0,this.J.length=0}begin(){return new s(0,this)}end(){return new s(this.i,this)}rBegin(){return new s(this.i-1,this,1)}rEnd(){return new s(-1,this,1)}front(){return this.J[0]}back(){return this.J[this.i-1]}getElementByPos(u){if(u<0||u>this.i-1)throw new RangeError;return this.J[u]}eraseElementByPos(u){if(u<0||u>this.i-1)throw new RangeError;return this.J.splice(u,1),this.i-=1,this.i}eraseElementByValue(u){let c=0;for(let f=0;f<this.i;++f)this.J[f]!==u&&(this.J[c++]=this.J[f]);return this.i=this.J.length=c,this.i}eraseElementByIterator(u){let c=u.o;return u=u.next(),this.eraseElementByPos(c),u}pushBack(u){return this.J.push(u),this.i+=1,this.i}popBack(){if(this.i!==0)return this.i-=1,this.J.pop()}setElementByPos(u,c){if(u<0||u>this.i-1)throw new RangeError;this.J[u]=c}insert(u,c,f=1){if(u<0||u>this.i)throw new RangeError;return this.J.splice(u,0,...new Array(f).fill(c)),this.i+=f,this.i}find(u){for(let c=0;c<this.i;++c)if(this.J[c]===u)return new s(c,this);return this.end()}reverse(){this.J.reverse()}unique(){let u=1;for(let c=1;c<this.i;++c)this.J[c]!==this.J[c-1]&&(this.J[u++]=this.J[c]);return this.i=this.J.length=u,this.i}sort(u){this.J.sort(u)}forEach(u){for(let c=0;c<this.i;++c)u(this.J[c],c,this)}[Symbol.iterator](){return(function*(){yield*this.J}).bind(this)()}},l=a;i.default=l}),X6=Rt(i=>{_t(),Et(),St(),Object.defineProperty(i,"t",{value:!0}),i.default=void 0;var e=s(cb()),t=jo(),n=Do();function s(c){return c&&c.t?c:{default:c}}var a=class kE extends t.ContainerIterator{constructor(f,d,p,m){super(m),this.o=f,this.h=d,this.container=p,this.iteratorType===0?(this.pre=function(){return this.o.L===this.h&&(0,n.throwIteratorAccessError)(),this.o=this.o.L,this},this.next=function(){return this.o===this.h&&(0,n.throwIteratorAccessError)(),this.o=this.o.B,this}):(this.pre=function(){return this.o.B===this.h&&(0,n.throwIteratorAccessError)(),this.o=this.o.B,this},this.next=function(){return this.o===this.h&&(0,n.throwIteratorAccessError)(),this.o=this.o.L,this})}get pointer(){return this.o===this.h&&(0,n.throwIteratorAccessError)(),this.o.l}set pointer(f){this.o===this.h&&(0,n.throwIteratorAccessError)(),this.o.l=f}copy(){return new kE(this.o,this.h,this.container,this.iteratorType)}},l=class extends e.default{constructor(c=[]){super(),this.h={},this.p=this._=this.h.L=this.h.B=this.h;let f=this;c.forEach(function(d){f.pushBack(d)})}V(c){let{L:f,B:d}=c;f.B=d,d.L=f,c===this.p&&(this.p=d),c===this._&&(this._=f),this.i-=1}G(c,f){let d=f.B,p={l:c,L:f,B:d};f.B=p,d.L=p,f===this.h&&(this.p=p),d===this.h&&(this._=p),this.i+=1}clear(){this.i=0,this.p=this._=this.h.L=this.h.B=this.h}begin(){return new a(this.p,this.h,this)}end(){return new a(this.h,this.h,this)}rBegin(){return new a(this._,this.h,this,1)}rEnd(){return new a(this.h,this.h,this,1)}front(){return this.p.l}back(){return this._.l}getElementByPos(c){if(c<0||c>this.i-1)throw new RangeError;let f=this.p;for(;c--;)f=f.B;return f.l}eraseElementByPos(c){if(c<0||c>this.i-1)throw new RangeError;let f=this.p;for(;c--;)f=f.B;return this.V(f),this.i}eraseElementByValue(c){let f=this.p;for(;f!==this.h;)f.l===c&&this.V(f),f=f.B;return this.i}eraseElementByIterator(c){let f=c.o;return f===this.h&&(0,n.throwIteratorAccessError)(),c=c.next(),this.V(f),c}pushBack(c){return this.G(c,this._),this.i}popBack(){if(this.i===0)return;let c=this._.l;return this.V(this._),c}pushFront(c){return this.G(c,this.h),this.i}popFront(){if(this.i===0)return;let c=this.p.l;return this.V(this.p),c}setElementByPos(c,f){if(c<0||c>this.i-1)throw new RangeError;let d=this.p;for(;c--;)d=d.B;d.l=f}insert(c,f,d=1){if(c<0||c>this.i)throw new RangeError;if(d<=0)return this.i;if(c===0)for(;d--;)this.pushFront(f);else if(c===this.i)for(;d--;)this.pushBack(f);else{let p=this.p;for(let v=1;v<c;++v)p=p.B;let m=p.B;for(this.i+=d;d--;)p.B={l:f,L:p},p.B.L=p,p=p.B;p.B=m,m.L=p}return this.i}find(c){let f=this.p;for(;f!==this.h;){if(f.l===c)return new a(f,this.h,this);f=f.B}return this.end()}reverse(){if(this.i<=1)return;let c=this.p,f=this._,d=0;for(;d<<1<this.i;){let p=c.l;c.l=f.l,f.l=p,c=c.B,f=f.L,d+=1}}unique(){if(this.i<=1)return this.i;let c=this.p;for(;c!==this.h;){let f=c;for(;f.B!==this.h&&f.l===f.B.l;)f=f.B,this.i-=1;c.B=f.B,c.B.L=c,c=c.B}return this.i}sort(c){if(this.i<=1)return;let f=[];this.forEach(function(p){f.push(p)}),f.sort(c);let d=this.p;f.forEach(function(p){d.l=p,d=d.B})}merge(c){let f=this;if(this.i===0)c.forEach(function(d){f.pushBack(d)});else{let d=this.p;c.forEach(function(p){for(;d!==f.h&&d.l<=p;)d=d.B;f.G(p,d.L)})}return this.i}forEach(c){let f=this.p,d=0;for(;f!==this.h;)c(f.l,d++,this),f=f.B}[Symbol.iterator](){return(function*(){if(this.i===0)return;let c=this.p;for(;c!==this.h;)yield c.l,c=c.B}).bind(this)()}},u=l;i.default=u}),e5=Rt(i=>{_t(),Et(),St(),Object.defineProperty(i,"t",{value:!0}),i.default=void 0;var e=n(cb()),t=CE();function n(u){return u&&u.t?u:{default:u}}var s=class TE extends t.RandomIterator{constructor(c,f,d){super(c,d),this.container=f}copy(){return new TE(this.o,this.container,this.iteratorType)}},a=class extends e.default{constructor(u=[],c=4096){super(),this.j=0,this.D=0,this.R=0,this.N=0,this.P=0,this.A=[];let f=(()=>{if(typeof u.length=="number")return u.length;if(typeof u.size=="number")return u.size;if(typeof u.size=="function")return u.size();throw new TypeError("Cannot get the length or size of the container")})();this.F=c,this.P=Math.max(Math.ceil(f/this.F),1);for(let m=0;m<this.P;++m)this.A.push(new Array(this.F));let d=Math.ceil(f/this.F);this.j=this.R=(this.P>>1)-(d>>1),this.D=this.N=this.F-f%this.F>>1;let p=this;u.forEach(function(m){p.pushBack(m)})}T(){let u=[],c=Math.max(this.P>>1,1);for(let f=0;f<c;++f)u[f]=new Array(this.F);for(let f=this.j;f<this.P;++f)u[u.length]=this.A[f];for(let f=0;f<this.R;++f)u[u.length]=this.A[f];u[u.length]=[...this.A[this.R]],this.j=c,this.R=u.length-1;for(let f=0;f<c;++f)u[u.length]=new Array(this.F);this.A=u,this.P=u.length}O(u){let c=this.D+u+1,f=c%this.F,d=f-1,p=this.j+(c-f)/this.F;return f===0&&(p-=1),p%=this.P,d<0&&(d+=this.F),{curNodeBucketIndex:p,curNodePointerIndex:d}}clear(){this.A=[new Array(this.F)],this.P=1,this.j=this.R=this.i=0,this.D=this.N=this.F>>1}begin(){return new s(0,this)}end(){return new s(this.i,this)}rBegin(){return new s(this.i-1,this,1)}rEnd(){return new s(-1,this,1)}front(){if(this.i!==0)return this.A[this.j][this.D]}back(){if(this.i!==0)return this.A[this.R][this.N]}pushBack(u){return this.i&&(this.N<this.F-1?this.N+=1:this.R<this.P-1?(this.R+=1,this.N=0):(this.R=0,this.N=0),this.R===this.j&&this.N===this.D&&this.T()),this.i+=1,this.A[this.R][this.N]=u,this.i}popBack(){if(this.i===0)return;let u=this.A[this.R][this.N];return this.i!==1&&(this.N>0?this.N-=1:this.R>0?(this.R-=1,this.N=this.F-1):(this.R=this.P-1,this.N=this.F-1)),this.i-=1,u}pushFront(u){return this.i&&(this.D>0?this.D-=1:this.j>0?(this.j-=1,this.D=this.F-1):(this.j=this.P-1,this.D=this.F-1),this.j===this.R&&this.D===this.N&&this.T()),this.i+=1,this.A[this.j][this.D]=u,this.i}popFront(){if(this.i===0)return;let u=this.A[this.j][this.D];return this.i!==1&&(this.D<this.F-1?this.D+=1:this.j<this.P-1?(this.j+=1,this.D=0):(this.j=0,this.D=0)),this.i-=1,u}getElementByPos(u){if(u<0||u>this.i-1)throw new RangeError;let{curNodeBucketIndex:c,curNodePointerIndex:f}=this.O(u);return this.A[c][f]}setElementByPos(u,c){if(u<0||u>this.i-1)throw new RangeError;let{curNodeBucketIndex:f,curNodePointerIndex:d}=this.O(u);this.A[f][d]=c}insert(u,c,f=1){if(u<0||u>this.i)throw new RangeError;if(u===0)for(;f--;)this.pushFront(c);else if(u===this.i)for(;f--;)this.pushBack(c);else{let d=[];for(let p=u;p<this.i;++p)d.push(this.getElementByPos(p));this.cut(u-1);for(let p=0;p<f;++p)this.pushBack(c);for(let p=0;p<d.length;++p)this.pushBack(d[p])}return this.i}cut(u){if(u<0)return this.clear(),0;let{curNodeBucketIndex:c,curNodePointerIndex:f}=this.O(u);return this.R=c,this.N=f,this.i=u+1,this.i}eraseElementByPos(u){if(u<0||u>this.i-1)throw new RangeError;if(u===0)this.popFront();else if(u===this.i-1)this.popBack();else{let c=[];for(let d=u+1;d<this.i;++d)c.push(this.getElementByPos(d));this.cut(u),this.popBack();let f=this;c.forEach(function(d){f.pushBack(d)})}return this.i}eraseElementByValue(u){if(this.i===0)return 0;let c=[];for(let d=0;d<this.i;++d){let p=this.getElementByPos(d);p!==u&&c.push(p)}let f=c.length;for(let d=0;d<f;++d)this.setElementByPos(d,c[d]);return this.cut(f-1)}eraseElementByIterator(u){let c=u.o;return this.eraseElementByPos(c),u=u.next(),u}find(u){for(let c=0;c<this.i;++c)if(this.getElementByPos(c)===u)return new s(c,this);return this.end()}reverse(){let u=0,c=this.i-1;for(;u<c;){let f=this.getElementByPos(u);this.setElementByPos(u,this.getElementByPos(c)),this.setElementByPos(c,f),u+=1,c-=1}}unique(){if(this.i<=1)return this.i;let u=1,c=this.getElementByPos(0);for(let f=1;f<this.i;++f){let d=this.getElementByPos(f);d!==c&&(c=d,this.setElementByPos(u++,d))}for(;this.i>u;)this.popBack();return this.i}sort(u){let c=[];for(let f=0;f<this.i;++f)c.push(this.getElementByPos(f));c.sort(u);for(let f=0;f<this.i;++f)this.setElementByPos(f,c[f])}shrinkToFit(){if(this.i===0)return;let u=[];this.forEach(function(c){u.push(c)}),this.P=Math.max(Math.ceil(this.i/this.F),1),this.i=this.j=this.R=this.D=this.N=0,this.A=[];for(let c=0;c<this.P;++c)this.A.push(new Array(this.F));for(let c=0;c<u.length;++c)this.pushBack(u[c])}forEach(u){for(let c=0;c<this.i;++c)u(this.getElementByPos(c),c,this)}[Symbol.iterator](){return(function*(){for(let u=0;u<this.i;++u)yield this.getElementByPos(u)}).bind(this)()}},l=a;i.default=l}),t5=Rt(i=>{_t(),Et(),St(),Object.defineProperty(i,"t",{value:!0}),i.TreeNodeEnableIndex=i.TreeNode=void 0;var e=class{constructor(n,s){this.ee=1,this.u=void 0,this.l=void 0,this.U=void 0,this.W=void 0,this.tt=void 0,this.u=n,this.l=s}L(){let n=this;if(n.ee===1&&n.tt.tt===n)n=n.W;else if(n.U)for(n=n.U;n.W;)n=n.W;else{let s=n.tt;for(;s.U===n;)n=s,s=n.tt;n=s}return n}B(){let n=this;if(n.W){for(n=n.W;n.U;)n=n.U;return n}else{let s=n.tt;for(;s.W===n;)n=s,s=n.tt;return n.W!==s?s:n}}te(){let n=this.tt,s=this.W,a=s.U;return n.tt===this?n.tt=s:n.U===this?n.U=s:n.W=s,s.tt=n,s.U=this,this.tt=s,this.W=a,a&&(a.tt=this),s}se(){let n=this.tt,s=this.U,a=s.W;return n.tt===this?n.tt=s:n.U===this?n.U=s:n.W=s,s.tt=n,s.W=this,this.tt=s,this.U=a,a&&(a.tt=this),s}};i.TreeNode=e;var t=class extends e{constructor(){super(...arguments),this.rt=1}te(){let n=super.te();return this.ie(),n.ie(),n}se(){let n=super.se();return this.ie(),n.ie(),n}ie(){this.rt=1,this.U&&(this.rt+=this.U.rt),this.W&&(this.rt+=this.W.rt)}};i.TreeNodeEnableIndex=t}),ME=Rt(i=>{_t(),Et(),St(),Object.defineProperty(i,"t",{value:!0}),i.default=void 0;var e=t5(),t=jo(),n=Do(),s=class extends t.Container{constructor(l=function(c,f){return c<f?-1:c>f?1:0},u=!1){super(),this.Y=void 0,this.v=l,u?(this.re=e.TreeNodeEnableIndex,this.M=function(c,f,d){let p=this.ne(c,f,d);if(p){let m=p.tt;for(;m!==this.h;)m.rt+=1,m=m.tt;let v=this.he(p);if(v){let{parentNode:b,grandParent:y,curNode:w}=v;b.ie(),y.ie(),w.ie()}}return this.i},this.V=function(c){let f=this.fe(c);for(;f!==this.h;)f.rt-=1,f=f.tt}):(this.re=e.TreeNode,this.M=function(c,f,d){let p=this.ne(c,f,d);return p&&this.he(p),this.i},this.V=this.fe),this.h=new this.re}X(l,u){let c=this.h;for(;l;){let f=this.v(l.u,u);if(f<0)l=l.W;else if(f>0)c=l,l=l.U;else return l}return c}Z(l,u){let c=this.h;for(;l;)this.v(l.u,u)<=0?l=l.W:(c=l,l=l.U);return c}$(l,u){let c=this.h;for(;l;){let f=this.v(l.u,u);if(f<0)c=l,l=l.W;else if(f>0)l=l.U;else return l}return c}rr(l,u){let c=this.h;for(;l;)this.v(l.u,u)<0?(c=l,l=l.W):l=l.U;return c}ue(l){for(;;){let u=l.tt;if(u===this.h)return;if(l.ee===1){l.ee=0;return}if(l===u.U){let c=u.W;if(c.ee===1)c.ee=0,u.ee=1,u===this.Y?this.Y=u.te():u.te();else if(c.W&&c.W.ee===1){c.ee=u.ee,u.ee=0,c.W.ee=0,u===this.Y?this.Y=u.te():u.te();return}else c.U&&c.U.ee===1?(c.ee=1,c.U.ee=0,c.se()):(c.ee=1,l=u)}else{let c=u.U;if(c.ee===1)c.ee=0,u.ee=1,u===this.Y?this.Y=u.se():u.se();else if(c.U&&c.U.ee===1){c.ee=u.ee,u.ee=0,c.U.ee=0,u===this.Y?this.Y=u.se():u.se();return}else c.W&&c.W.ee===1?(c.ee=1,c.W.ee=0,c.te()):(c.ee=1,l=u)}}}fe(l){if(this.i===1)return this.clear(),this.h;let u=l;for(;u.U||u.W;){if(u.W)for(u=u.W;u.U;)u=u.U;else u=u.U;[l.u,u.u]=[u.u,l.u],[l.l,u.l]=[u.l,l.l],l=u}this.h.U===u?this.h.U=u.tt:this.h.W===u&&(this.h.W=u.tt),this.ue(u);let c=u.tt;return u===c.U?c.U=void 0:c.W=void 0,this.i-=1,this.Y.ee=0,c}oe(l,u){return l===void 0?!1:this.oe(l.U,u)||u(l)?!0:this.oe(l.W,u)}he(l){for(;;){let u=l.tt;if(u.ee===0)return;let c=u.tt;if(u===c.U){let f=c.W;if(f&&f.ee===1){if(f.ee=u.ee=0,c===this.Y)return;c.ee=1,l=c;continue}else if(l===u.W){if(l.ee=0,l.U&&(l.U.tt=u),l.W&&(l.W.tt=c),u.W=l.U,c.U=l.W,l.U=u,l.W=c,c===this.Y)this.Y=l,this.h.tt=l;else{let d=c.tt;d.U===c?d.U=l:d.W=l}return l.tt=c.tt,u.tt=l,c.tt=l,c.ee=1,{parentNode:u,grandParent:c,curNode:l}}else u.ee=0,c===this.Y?this.Y=c.se():c.se(),c.ee=1}else{let f=c.U;if(f&&f.ee===1){if(f.ee=u.ee=0,c===this.Y)return;c.ee=1,l=c;continue}else if(l===u.U){if(l.ee=0,l.U&&(l.U.tt=c),l.W&&(l.W.tt=u),c.W=l.U,u.U=l.W,l.U=c,l.W=u,c===this.Y)this.Y=l,this.h.tt=l;else{let d=c.tt;d.U===c?d.U=l:d.W=l}return l.tt=c.tt,u.tt=l,c.tt=l,c.ee=1,{parentNode:u,grandParent:c,curNode:l}}else u.ee=0,c===this.Y?this.Y=c.te():c.te(),c.ee=1}return}}ne(l,u,c){if(this.Y===void 0){this.i+=1,this.Y=new this.re(l,u),this.Y.ee=0,this.Y.tt=this.h,this.h.tt=this.Y,this.h.U=this.Y,this.h.W=this.Y;return}let f,d=this.h.U,p=this.v(d.u,l);if(p===0){d.l=u;return}else if(p>0)d.U=new this.re(l,u),d.U.tt=d,f=d.U,this.h.U=f;else{let m=this.h.W,v=this.v(m.u,l);if(v===0){m.l=u;return}else if(v<0)m.W=new this.re(l,u),m.W.tt=m,f=m.W,this.h.W=f;else{if(c!==void 0){let b=c.o;if(b!==this.h){let y=this.v(b.u,l);if(y===0){b.l=u;return}else if(y>0){let w=b.L(),C=this.v(w.u,l);if(C===0){w.l=u;return}else C<0&&(f=new this.re(l,u),w.W===void 0?(w.W=f,f.tt=w):(b.U=f,f.tt=b))}}}if(f===void 0)for(f=this.Y;;){let b=this.v(f.u,l);if(b>0){if(f.U===void 0){f.U=new this.re(l,u),f.U.tt=f,f=f.U;break}f=f.U}else if(b<0){if(f.W===void 0){f.W=new this.re(l,u),f.W.tt=f,f=f.W;break}f=f.W}else{f.l=u;return}}}}return this.i+=1,f}I(l,u){for(;l;){let c=this.v(l.u,u);if(c<0)l=l.W;else if(c>0)l=l.U;else return l}return l||this.h}clear(){this.i=0,this.Y=void 0,this.h.tt=void 0,this.h.U=this.h.W=void 0}updateKeyByIterator(l,u){let c=l.o;if(c===this.h&&(0,n.throwIteratorAccessError)(),this.i===1)return c.u=u,!0;if(c===this.h.U)return this.v(c.B().u,u)>0?(c.u=u,!0):!1;if(c===this.h.W)return this.v(c.L().u,u)<0?(c.u=u,!0):!1;let f=c.L().u;if(this.v(f,u)>=0)return!1;let d=c.B().u;return this.v(d,u)<=0?!1:(c.u=u,!0)}eraseElementByPos(l){if(l<0||l>this.i-1)throw new RangeError;let u=0,c=this;return this.oe(this.Y,function(f){return l===u?(c.V(f),!0):(u+=1,!1)}),this.i}eraseElementByKey(l){if(this.i===0)return!1;let u=this.I(this.Y,l);return u===this.h?!1:(this.V(u),!0)}eraseElementByIterator(l){let u=l.o;u===this.h&&(0,n.throwIteratorAccessError)();let c=u.W===void 0;return l.iteratorType===0?c&&l.next():(!c||u.U===void 0)&&l.next(),this.V(u),l}forEach(l){let u=0;for(let c of this)l(c,u++,this)}getElementByPos(l){if(l<0||l>this.i-1)throw new RangeError;let u,c=0;for(let f of this){if(c===l){u=f;break}c+=1}return u}getHeight(){if(this.i===0)return 0;let l=function(u){return u?Math.max(l(u.U),l(u.W))+1:0};return l(this.Y)}},a=s;i.default=a}),IE=Rt(i=>{_t(),Et(),St(),Object.defineProperty(i,"t",{value:!0}),i.default=void 0;var e=jo(),t=Do(),n=class extends e.ContainerIterator{constructor(a,l,u){super(u),this.o=a,this.h=l,this.iteratorType===0?(this.pre=function(){return this.o===this.h.U&&(0,t.throwIteratorAccessError)(),this.o=this.o.L(),this},this.next=function(){return this.o===this.h&&(0,t.throwIteratorAccessError)(),this.o=this.o.B(),this}):(this.pre=function(){return this.o===this.h.W&&(0,t.throwIteratorAccessError)(),this.o=this.o.B(),this},this.next=function(){return this.o===this.h&&(0,t.throwIteratorAccessError)(),this.o=this.o.L(),this})}get index(){let a=this.o,l=this.h.tt;if(a===this.h)return l?l.rt-1:0;let u=0;for(a.U&&(u+=a.U.rt);a!==l;){let c=a.tt;a===c.W&&(u+=1,c.U&&(u+=c.U.rt)),a=c}return u}},s=n;i.default=s}),n5=Rt(i=>{_t(),Et(),St(),Object.defineProperty(i,"t",{value:!0}),i.default=void 0;var e=s(ME()),t=s(IE()),n=Do();function s(c){return c&&c.t?c:{default:c}}var a=class RE extends t.default{constructor(f,d,p,m){super(f,d,m),this.container=p}get pointer(){return this.o===this.h&&(0,n.throwIteratorAccessError)(),this.o.u}copy(){return new RE(this.o,this.h,this.container,this.iteratorType)}},l=class extends e.default{constructor(c=[],f,d){super(f,d);let p=this;c.forEach(function(m){p.insert(m)})}*K(c){c!==void 0&&(yield*this.K(c.U),yield c.u,yield*this.K(c.W))}begin(){return new a(this.h.U||this.h,this.h,this)}end(){return new a(this.h,this.h,this)}rBegin(){return new a(this.h.W||this.h,this.h,this,1)}rEnd(){return new a(this.h,this.h,this,1)}front(){return this.h.U?this.h.U.u:void 0}back(){return this.h.W?this.h.W.u:void 0}insert(c,f){return this.M(c,void 0,f)}find(c){let f=this.I(this.Y,c);return new a(f,this.h,this)}lowerBound(c){let f=this.X(this.Y,c);return new a(f,this.h,this)}upperBound(c){let f=this.Z(this.Y,c);return new a(f,this.h,this)}reverseLowerBound(c){let f=this.$(this.Y,c);return new a(f,this.h,this)}reverseUpperBound(c){let f=this.rr(this.Y,c);return new a(f,this.h,this)}union(c){let f=this;return c.forEach(function(d){f.insert(d)}),this.i}[Symbol.iterator](){return this.K(this.Y)}},u=l;i.default=u}),r5=Rt(i=>{_t(),Et(),St(),Object.defineProperty(i,"t",{value:!0}),i.default=void 0;var e=s(ME()),t=s(IE()),n=Do();function s(c){return c&&c.t?c:{default:c}}var a=class OE extends t.default{constructor(f,d,p,m){super(f,d,m),this.container=p}get pointer(){this.o===this.h&&(0,n.throwIteratorAccessError)();let f=this;return new Proxy([],{get(d,p){if(p==="0")return f.o.u;if(p==="1")return f.o.l},set(d,p,m){if(p!=="1")throw new TypeError("props must be 1");return f.o.l=m,!0}})}copy(){return new OE(this.o,this.h,this.container,this.iteratorType)}},l=class extends e.default{constructor(c=[],f,d){super(f,d);let p=this;c.forEach(function(m){p.setElement(m[0],m[1])})}*K(c){c!==void 0&&(yield*this.K(c.U),yield[c.u,c.l],yield*this.K(c.W))}begin(){return new a(this.h.U||this.h,this.h,this)}end(){return new a(this.h,this.h,this)}rBegin(){return new a(this.h.W||this.h,this.h,this,1)}rEnd(){return new a(this.h,this.h,this,1)}front(){if(this.i===0)return;let c=this.h.U;return[c.u,c.l]}back(){if(this.i===0)return;let c=this.h.W;return[c.u,c.l]}lowerBound(c){let f=this.X(this.Y,c);return new a(f,this.h,this)}upperBound(c){let f=this.Z(this.Y,c);return new a(f,this.h,this)}reverseLowerBound(c){let f=this.$(this.Y,c);return new a(f,this.h,this)}reverseUpperBound(c){let f=this.rr(this.Y,c);return new a(f,this.h,this)}setElement(c,f,d){return this.M(c,f,d)}find(c){let f=this.I(this.Y,c);return new a(f,this.h,this)}getElementByKey(c){return this.I(this.Y,c).l}union(c){let f=this;return c.forEach(function(d){f.setElement(d[0],d[1])}),this.i}[Symbol.iterator](){return this.K(this.Y)}},u=l;i.default=u}),NE=Rt(i=>{_t(),Et(),St(),Object.defineProperty(i,"t",{value:!0}),i.default=e;function e(t){let n=typeof t;return n==="object"&&t!==null||n==="function"}}),BE=Rt(i=>{_t(),Et(),St(),Object.defineProperty(i,"t",{value:!0}),i.HashContainerIterator=i.HashContainer=void 0;var e=jo(),t=s(NE()),n=Do();function s(u){return u&&u.t?u:{default:u}}var a=class extends e.ContainerIterator{constructor(u,c,f){super(f),this.o=u,this.h=c,this.iteratorType===0?(this.pre=function(){return this.o.L===this.h&&(0,n.throwIteratorAccessError)(),this.o=this.o.L,this},this.next=function(){return this.o===this.h&&(0,n.throwIteratorAccessError)(),this.o=this.o.B,this}):(this.pre=function(){return this.o.B===this.h&&(0,n.throwIteratorAccessError)(),this.o=this.o.B,this},this.next=function(){return this.o===this.h&&(0,n.throwIteratorAccessError)(),this.o=this.o.L,this})}};i.HashContainerIterator=a;var l=class extends e.Container{constructor(){super(),this.H=[],this.g={},this.HASH_TAG=Symbol("@@HASH_TAG"),Object.setPrototypeOf(this.g,null),this.h={},this.h.L=this.h.B=this.p=this._=this.h}V(u){let{L:c,B:f}=u;c.B=f,f.L=c,u===this.p&&(this.p=f),u===this._&&(this._=c),this.i-=1}M(u,c,f){f===void 0&&(f=(0,t.default)(u));let d;if(f){let p=u[this.HASH_TAG];if(p!==void 0)return this.H[p].l=c,this.i;Object.defineProperty(u,this.HASH_TAG,{value:this.H.length,configurable:!0}),d={u,l:c,L:this._,B:this.h},this.H.push(d)}else{let p=this.g[u];if(p)return p.l=c,this.i;d={u,l:c,L:this._,B:this.h},this.g[u]=d}return this.i===0?(this.p=d,this.h.B=d):this._.B=d,this._=d,this.h.L=d,++this.i}I(u,c){if(c===void 0&&(c=(0,t.default)(u)),c){let f=u[this.HASH_TAG];return f===void 0?this.h:this.H[f]}else return this.g[u]||this.h}clear(){let u=this.HASH_TAG;this.H.forEach(function(c){delete c.u[u]}),this.H=[],this.g={},Object.setPrototypeOf(this.g,null),this.i=0,this.p=this._=this.h.L=this.h.B=this.h}eraseElementByKey(u,c){let f;if(c===void 0&&(c=(0,t.default)(u)),c){let d=u[this.HASH_TAG];if(d===void 0)return!1;delete u[this.HASH_TAG],f=this.H[d],delete this.H[d]}else{if(f=this.g[u],f===void 0)return!1;delete this.g[u]}return this.V(f),!0}eraseElementByIterator(u){let c=u.o;return c===this.h&&(0,n.throwIteratorAccessError)(),this.V(c),u.next()}eraseElementByPos(u){if(u<0||u>this.i-1)throw new RangeError;let c=this.p;for(;u--;)c=c.B;return this.V(c),this.i}};i.HashContainer=l}),i5=Rt(i=>{_t(),Et(),St(),Object.defineProperty(i,"t",{value:!0}),i.default=void 0;var e=BE(),t=Do(),n=class jE extends e.HashContainerIterator{constructor(u,c,f,d){super(u,c,d),this.container=f}get pointer(){return this.o===this.h&&(0,t.throwIteratorAccessError)(),this.o.u}copy(){return new jE(this.o,this.h,this.container,this.iteratorType)}},s=class extends e.HashContainer{constructor(l=[]){super();let u=this;l.forEach(function(c){u.insert(c)})}begin(){return new n(this.p,this.h,this)}end(){return new n(this.h,this.h,this)}rBegin(){return new n(this._,this.h,this,1)}rEnd(){return new n(this.h,this.h,this,1)}front(){return this.p.u}back(){return this._.u}insert(l,u){return this.M(l,void 0,u)}getElementByPos(l){if(l<0||l>this.i-1)throw new RangeError;let u=this.p;for(;l--;)u=u.B;return u.u}find(l,u){let c=this.I(l,u);return new n(c,this.h,this)}forEach(l){let u=0,c=this.p;for(;c!==this.h;)l(c.u,u++,this),c=c.B}[Symbol.iterator](){return(function*(){let l=this.p;for(;l!==this.h;)yield l.u,l=l.B}).bind(this)()}},a=s;i.default=a}),s5=Rt(i=>{_t(),Et(),St(),Object.defineProperty(i,"t",{value:!0}),i.default=void 0;var e=BE(),t=s(NE()),n=Do();function s(c){return c&&c.t?c:{default:c}}var a=class DE extends e.HashContainerIterator{constructor(f,d,p,m){super(f,d,m),this.container=p}get pointer(){this.o===this.h&&(0,n.throwIteratorAccessError)();let f=this;return new Proxy([],{get(d,p){if(p==="0")return f.o.u;if(p==="1")return f.o.l},set(d,p,m){if(p!=="1")throw new TypeError("props must be 1");return f.o.l=m,!0}})}copy(){return new DE(this.o,this.h,this.container,this.iteratorType)}},l=class extends e.HashContainer{constructor(c=[]){super();let f=this;c.forEach(function(d){f.setElement(d[0],d[1])})}begin(){return new a(this.p,this.h,this)}end(){return new a(this.h,this.h,this)}rBegin(){return new a(this._,this.h,this,1)}rEnd(){return new a(this.h,this.h,this,1)}front(){if(this.i!==0)return[this.p.u,this.p.l]}back(){if(this.i!==0)return[this._.u,this._.l]}setElement(c,f,d){return this.M(c,f,d)}getElementByKey(c,f){if(f===void 0&&(f=(0,t.default)(c)),f){let p=c[this.HASH_TAG];return p!==void 0?this.H[p].l:void 0}let d=this.g[c];return d?d.l:void 0}getElementByPos(c){if(c<0||c>this.i-1)throw new RangeError;let f=this.p;for(;c--;)f=f.B;return[f.u,f.l]}find(c,f){let d=this.I(c,f);return new a(d,this.h,this)}forEach(c){let f=0,d=this.p;for(;d!==this.h;)c([d.u,d.l],f++,this),d=d.B}[Symbol.iterator](){return(function*(){let c=this.p;for(;c!==this.h;)yield[c.u,c.l],c=c.B}).bind(this)()}},u=l;i.default=u}),o5=Rt(i=>{_t(),Et(),St(),Object.defineProperty(i,"t",{value:!0}),Object.defineProperty(i,"Deque",{enumerable:!0,get:function(){return l.default}}),Object.defineProperty(i,"HashMap",{enumerable:!0,get:function(){return d.default}}),Object.defineProperty(i,"HashSet",{enumerable:!0,get:function(){return f.default}}),Object.defineProperty(i,"LinkList",{enumerable:!0,get:function(){return a.default}}),Object.defineProperty(i,"OrderedMap",{enumerable:!0,get:function(){return c.default}}),Object.defineProperty(i,"OrderedSet",{enumerable:!0,get:function(){return u.default}}),Object.defineProperty(i,"PriorityQueue",{enumerable:!0,get:function(){return n.default}}),Object.defineProperty(i,"Queue",{enumerable:!0,get:function(){return t.default}}),Object.defineProperty(i,"Stack",{enumerable:!0,get:function(){return e.default}}),Object.defineProperty(i,"Vector",{enumerable:!0,get:function(){return s.default}});var e=p(W6()),t=p(Q6()),n=p(J6()),s=p(Z6()),a=p(X6()),l=p(e5()),u=p(n5()),c=p(r5()),f=p(i5()),d=p(s5());function p(m){return m&&m.t?m:{default:m}}}),a5=Rt((i,e)=>{_t(),Et(),St();var t=o5().OrderedSet,n=Ro()("number-allocator:trace"),s=Ro()("number-allocator:error");function a(u,c){this.low=u,this.high=c}a.prototype.equals=function(u){return this.low===u.low&&this.high===u.high},a.prototype.compare=function(u){return this.low<u.low&&this.high<u.low?-1:u.low<this.low&&u.high<this.low?1:0};function l(u,c){if(!(this instanceof l))return new l(u,c);this.min=u,this.max=c,this.ss=new t([],(f,d)=>f.compare(d)),n("Create"),this.clear()}l.prototype.firstVacant=function(){return this.ss.size()===0?null:this.ss.front().low},l.prototype.alloc=function(){if(this.ss.size()===0)return n("alloc():empty"),null;let u=this.ss.begin(),c=u.pointer.low,f=u.pointer.high,d=c;return d+1<=f?this.ss.updateKeyByIterator(u,new a(c+1,f)):this.ss.eraseElementByPos(0),n("alloc():"+d),d},l.prototype.use=function(u){let c=new a(u,u),f=this.ss.lowerBound(c);if(!f.equals(this.ss.end())){let d=f.pointer.low,p=f.pointer.high;return f.pointer.equals(c)?(this.ss.eraseElementByIterator(f),n("use():"+u),!0):d>u?!1:d===u?(this.ss.updateKeyByIterator(f,new a(d+1,p)),n("use():"+u),!0):p===u?(this.ss.updateKeyByIterator(f,new a(d,p-1)),n("use():"+u),!0):(this.ss.updateKeyByIterator(f,new a(u+1,p)),this.ss.insert(new a(d,u-1)),n("use():"+u),!0)}return n("use():failed"),!1},l.prototype.free=function(u){if(u<this.min||u>this.max){s("free():"+u+" is out of range");return}let c=new a(u,u),f=this.ss.upperBound(c);if(f.equals(this.ss.end())){if(f.equals(this.ss.begin())){this.ss.insert(c);return}f.pre();let d=f.pointer.high;f.pointer.high+1===u?this.ss.updateKeyByIterator(f,new a(d,u)):this.ss.insert(c)}else if(f.equals(this.ss.begin()))if(u+1===f.pointer.low){let d=f.pointer.high;this.ss.updateKeyByIterator(f,new a(u,d))}else this.ss.insert(c);else{let d=f.pointer.low,p=f.pointer.high;f.pre();let m=f.pointer.low;f.pointer.high+1===u?u+1===d?(this.ss.eraseElementByIterator(f),this.ss.updateKeyByIterator(f,new a(m,p))):this.ss.updateKeyByIterator(f,new a(m,u)):u+1===d?(this.ss.eraseElementByIterator(f.next()),this.ss.insert(new a(u,p))):this.ss.insert(c)}n("free():"+u)},l.prototype.clear=function(){n("clear()"),this.ss.clear(),this.ss.insert(new a(this.min,this.max))},l.prototype.intervalCount=function(){return this.ss.size()},l.prototype.dump=function(){console.log("length:"+this.ss.size());for(let u of this.ss)console.log(u)},e.exports=l}),PE=Rt((i,e)=>{_t(),Et(),St();var t=a5();e.exports.NumberAllocator=t}),l5=Rt(i=>{_t(),Et(),St(),Object.defineProperty(i,"__esModule",{value:!0});var e=Y6(),t=PE(),n=class{aliasToTopic;topicToAlias;max;numberAllocator;length;constructor(s){s>0&&(this.aliasToTopic=new e.LRUCache({max:s}),this.topicToAlias={},this.numberAllocator=new t.NumberAllocator(1,s),this.max=s,this.length=0)}put(s,a){if(a===0||a>this.max)return!1;let l=this.aliasToTopic.get(a);return l&&delete this.topicToAlias[l],this.aliasToTopic.set(a,s),this.topicToAlias[s]=a,this.numberAllocator.use(a),this.length=this.aliasToTopic.size,!0}getTopicByAlias(s){return this.aliasToTopic.get(s)}getAliasByTopic(s){let a=this.topicToAlias[s];return typeof a<"u"&&this.aliasToTopic.get(a),a}clear(){this.aliasToTopic.clear(),this.topicToAlias={},this.numberAllocator.clear(),this.length=0}getLruAlias(){return this.numberAllocator.firstVacant()||[...this.aliasToTopic.keys()][this.aliasToTopic.size-1]}};i.default=n}),c5=Rt(i=>{_t(),Et(),St();var e=i&&i.__importDefault||function(l){return l&&l.__esModule?l:{default:l}};Object.defineProperty(i,"__esModule",{value:!0});var t=xd(),n=e(l5()),s=Pc(),a=(l,u)=>{l.log("_handleConnack");let{options:c}=l,f=c.protocolVersion===5?u.reasonCode:u.returnCode;if(clearTimeout(l.connackTimer),delete l.topicAliasSend,u.properties){if(u.properties.topicAliasMaximum){if(u.properties.topicAliasMaximum>65535){l.emit("error",new Error("topicAliasMaximum from broker is out of range"));return}u.properties.topicAliasMaximum>0&&(l.topicAliasSend=new n.default(u.properties.topicAliasMaximum))}u.properties.serverKeepAlive&&c.keepalive&&(c.keepalive=u.properties.serverKeepAlive),u.properties.maximumPacketSize&&(c.properties||(c.properties={}),c.properties.maximumPacketSize=u.properties.maximumPacketSize)}if(f===0)l.reconnecting=!1,l._onConnect(u);else if(f>0){let d=new s.ErrorWithReasonCode(`Connection refused: ${t.ReasonCodes[f]}`,f);l.emit("error",d),l.options.reconnectOnConnackError&&l._cleanUp(!0)}};i.default=a}),u5=Rt(i=>{_t(),Et(),St(),Object.defineProperty(i,"__esModule",{value:!0});var e=(t,n,s)=>{t.log("handling pubrel packet");let a=typeof s<"u"?s:t.noop,{messageId:l}=n,u={cmd:"pubcomp",messageId:l};t.incomingStore.get(n,(c,f)=>{c?t._sendPacket(u,a):(t.emit("message",f.topic,f.payload,f),t.handleMessage(f,d=>{if(d)return a(d);t.incomingStore.del(f,t.noop),t._sendPacket(u,a)}))})};i.default=e}),f5=Rt(i=>{_t(),Et(),St();var e=i&&i.__importDefault||function(c){return c&&c.__esModule?c:{default:c}};Object.defineProperty(i,"__esModule",{value:!0});var t=e(K6()),n=e($6()),s=e(c5()),a=e(xd()),l=e(u5()),u=(c,f,d)=>{let{options:p}=c;if(p.protocolVersion===5&&p.properties&&p.properties.maximumPacketSize&&p.properties.maximumPacketSize<f.length)return c.emit("error",new Error(`exceeding packets size ${f.cmd}`)),c.end({reasonCode:149,properties:{reasonString:"Maximum packet size was exceeded"}}),c;switch(c.log("_handlePacket :: emitting packetreceive"),c.emit("packetreceive",f),f.cmd){case"publish":(0,t.default)(c,f,d);break;case"puback":case"pubrec":case"pubcomp":case"suback":case"unsuback":c.reschedulePing(),(0,a.default)(c,f),d();break;case"pubrel":c.reschedulePing(),(0,l.default)(c,f,d);break;case"connack":(0,s.default)(c,f),d();break;case"auth":c.reschedulePing(),(0,n.default)(c,f),d();break;case"pingresp":c.log("_handlePacket :: received pingresp"),c.reschedulePing(!0),d();break;case"disconnect":c.emit("disconnect",f),d();break;default:c.log("_handlePacket :: unknown command"),d();break}};i.default=u}),LE=Rt(i=>{_t(),Et(),St(),Object.defineProperty(i,"__esModule",{value:!0});var e=class{nextId;constructor(){this.nextId=Math.max(1,Math.floor(Math.random()*65535))}allocate(){let t=this.nextId++;return this.nextId===65536&&(this.nextId=1),t}getLastAllocated(){return this.nextId===1?65535:this.nextId-1}register(t){return!0}deallocate(t){}clear(){}};i.default=e}),h5=Rt(i=>{_t(),Et(),St(),Object.defineProperty(i,"__esModule",{value:!0});var e=class{aliasToTopic;max;length;constructor(t){this.aliasToTopic={},this.max=t}put(t,n){return n===0||n>this.max?!1:(this.aliasToTopic[n]=t,this.length=Object.keys(this.aliasToTopic).length,!0)}getTopicByAlias(t){return this.aliasToTopic[t]}clear(){this.aliasToTopic={}}};i.default=e}),d5=Rt(i=>{_t(),Et(),St();var e=i&&i.__importDefault||function(a){return a&&a.__esModule?a:{default:a}};Object.defineProperty(i,"__esModule",{value:!0}),i.TypedEventEmitter=void 0;var t=e((Nl(),dr(qa))),n=Pc(),s=class{};i.TypedEventEmitter=s,(0,n.applyMixin)(s,t.default)}),_d=Rt((i,e)=>{_t(),Et(),St();function t(n){"@babel/helpers - typeof";return e.exports=t=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(s){return typeof s}:function(s){return s&&typeof Symbol=="function"&&s.constructor===Symbol&&s!==Symbol.prototype?"symbol":typeof s},e.exports.__esModule=!0,e.exports.default=e.exports,t(n)}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports}),p5=Rt((i,e)=>{_t(),Et(),St();var t=_d().default;function n(s,a){if(t(s)!="object"||!s)return s;var l=s[Symbol.toPrimitive];if(l!==void 0){var u=l.call(s,a||"default");if(t(u)!="object")return u;throw new TypeError("@@toPrimitive must return a primitive value.")}return(a==="string"?String:Number)(s)}e.exports=n,e.exports.__esModule=!0,e.exports.default=e.exports}),g5=Rt((i,e)=>{_t(),Et(),St();var t=_d().default,n=p5();function s(a){var l=n(a,"string");return t(l)=="symbol"?l:l+""}e.exports=s,e.exports.__esModule=!0,e.exports.default=e.exports}),m5=Rt((i,e)=>{_t(),Et(),St();var t=g5();function n(s,a,l){return(a=t(a))in s?Object.defineProperty(s,a,{value:l,enumerable:!0,configurable:!0,writable:!0}):s[a]=l,s}e.exports=n,e.exports.__esModule=!0,e.exports.default=e.exports}),y5=Rt((i,e)=>{_t(),Et(),St();function t(n){if(Array.isArray(n))return n}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports}),b5=Rt((i,e)=>{_t(),Et(),St();function t(n,s){var a=n==null?null:typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(a!=null){var l,u,c,f,d=[],p=!0,m=!1;try{if(c=(a=a.call(n)).next,s===0){if(Object(a)!==a)return;p=!1}else for(;!(p=(l=c.call(a)).done)&&(d.push(l.value),d.length!==s);p=!0);}catch(v){m=!0,u=v}finally{try{if(!p&&a.return!=null&&(f=a.return(),Object(f)!==f))return}finally{if(m)throw u}}return d}}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports}),v5=Rt((i,e)=>{_t(),Et(),St();function t(n,s){(s==null||s>n.length)&&(s=n.length);for(var a=0,l=Array(s);a<s;a++)l[a]=n[a];return l}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports}),w5=Rt((i,e)=>{_t(),Et(),St();var t=v5();function n(s,a){if(s){if(typeof s=="string")return t(s,a);var l={}.toString.call(s).slice(8,-1);return l==="Object"&&s.constructor&&(l=s.constructor.name),l==="Map"||l==="Set"?Array.from(s):l==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(l)?t(s,a):void 0}}e.exports=n,e.exports.__esModule=!0,e.exports.default=e.exports}),x5=Rt((i,e)=>{_t(),Et(),St();function t(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports}),_5=Rt((i,e)=>{_t(),Et(),St();var t=y5(),n=b5(),s=w5(),a=x5();function l(u,c){return t(u)||n(u,c)||s(u,c)||a()}e.exports=l,e.exports.__esModule=!0,e.exports.default=e.exports}),UE=Rt((i,e)=>{_t(),Et(),St(),(function(t,n){typeof i=="object"&&typeof e<"u"?n(i):typeof define=="function"&&define.amd?define(["exports"],n):(t=typeof globalThis<"u"?globalThis:t||self,n(t.fastUniqueNumbers={}))})(i,function(t){var n=function(v){return function(b){var y=v(b);return b.add(y),y}},s=function(v){return function(b,y){return v.set(b,y),y}},a=Number.MAX_SAFE_INTEGER===void 0?9007199254740991:Number.MAX_SAFE_INTEGER,l=536870912,u=l*2,c=function(v,b){return function(y){var w=b.get(y),C=w===void 0?y.size:w<u?w+1:0;if(!y.has(C))return v(y,C);if(y.size<l){for(;y.has(C);)C=Math.floor(Math.random()*u);return v(y,C)}if(y.size>a)throw new Error("Congratulations, you created a collection of unique numbers which uses all available integers!");for(;y.has(C);)C=Math.floor(Math.random()*a);return v(y,C)}},f=new WeakMap,d=s(f),p=c(d,f),m=n(p);t.addUniqueNumber=m,t.generateUniqueNumber=p})}),S5=Rt((i,e)=>{_t(),Et(),St();function t(s,a,l,u,c,f,d){try{var p=s[f](d),m=p.value}catch(v){return void l(v)}p.done?a(m):Promise.resolve(m).then(u,c)}function n(s){return function(){var a=this,l=arguments;return new Promise(function(u,c){var f=s.apply(a,l);function d(m){t(f,u,c,d,p,"next",m)}function p(m){t(f,u,c,d,p,"throw",m)}d(void 0)})}}e.exports=n,e.exports.__esModule=!0,e.exports.default=e.exports}),qE=Rt((i,e)=>{_t(),Et(),St();function t(n,s){this.v=n,this.k=s}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports}),FE=Rt((i,e)=>{_t(),Et(),St();function t(n,s,a,l){var u=Object.defineProperty;try{u({},"",{})}catch{u=0}e.exports=t=function(c,f,d,p){function m(v,b){t(c,v,function(y){return this._invoke(v,b,y)})}f?u?u(c,f,{value:d,enumerable:!p,configurable:!p,writable:!p}):c[f]=d:(m("next",0),m("throw",1),m("return",2))},e.exports.__esModule=!0,e.exports.default=e.exports,t(n,s,a,l)}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports}),HE=Rt((i,e)=>{_t(),Et(),St();var t=FE();function n(){var s,a,l=typeof Symbol=="function"?Symbol:{},u=l.iterator||"@@iterator",c=l.toStringTag||"@@toStringTag";function f(C,S,x,k){var A=S&&S.prototype instanceof p?S:p,R=Object.create(A.prototype);return t(R,"_invoke",(function(I,U,te){var G,Y,O,N=0,Q=te||[],q=!1,ee={p:0,n:0,v:s,a:ne,f:ne.bind(s,4),d:function(B,z){return G=B,Y=0,O=s,ee.n=z,d}};function ne(B,z){for(Y=B,O=z,a=0;!q&&N&&!$&&a<Q.length;a++){var $,V=Q[a],Z=ee.p,ae=V[2];B>3?($=ae===z)&&(O=V[(Y=V[4])?5:(Y=3,3)],V[4]=V[5]=s):V[0]<=Z&&(($=B<2&&Z<V[1])?(Y=0,ee.v=z,ee.n=V[1]):Z<ae&&($=B<3||V[0]>z||z>ae)&&(V[4]=B,V[5]=z,ee.n=ae,Y=0))}if($||B>1)return d;throw q=!0,z}return function(B,z,$){if(N>1)throw TypeError("Generator is already running");for(q&&z===1&&ne(z,$),Y=z,O=$;(a=Y<2?s:O)||!q;){G||(Y?Y<3?(Y>1&&(ee.n=-1),ne(Y,O)):ee.n=O:ee.v=O);try{if(N=2,G){if(Y||(B="next"),a=G[B]){if(!(a=a.call(G,O)))throw TypeError("iterator result is not an object");if(!a.done)return a;O=a.value,Y<2&&(Y=0)}else Y===1&&(a=G.return)&&a.call(G),Y<2&&(O=TypeError("The iterator does not provide a '"+B+"' method"),Y=1);G=s}else if((a=(q=ee.n<0)?O:I.call(U,ee))!==d)break}catch(V){G=s,Y=1,O=V}finally{N=1}}return{value:a,done:q}}})(C,x,k),!0),R}var d={};function p(){}function m(){}function v(){}a=Object.getPrototypeOf;var b=[][u]?a(a([][u]())):(t(a={},u,function(){return this}),a),y=v.prototype=p.prototype=Object.create(b);function w(C){return Object.setPrototypeOf?Object.setPrototypeOf(C,v):(C.__proto__=v,t(C,c,"GeneratorFunction")),C.prototype=Object.create(y),C}return m.prototype=v,t(y,"constructor",v),t(v,"constructor",m),m.displayName="GeneratorFunction",t(v,c,"GeneratorFunction"),t(y),t(y,c,"Generator"),t(y,u,function(){return this}),t(y,"toString",function(){return"[object Generator]"}),(e.exports=n=function(){return{w:f,m:w}},e.exports.__esModule=!0,e.exports.default=e.exports)()}e.exports=n,e.exports.__esModule=!0,e.exports.default=e.exports}),zE=Rt((i,e)=>{_t(),Et(),St();var t=qE(),n=FE();function s(a,l){function u(f,d,p,m){try{var v=a[f](d),b=v.value;return b instanceof t?l.resolve(b.v).then(function(y){u("next",y,p,m)},function(y){u("throw",y,p,m)}):l.resolve(b).then(function(y){v.value=y,p(v)},function(y){return u("throw",y,p,m)})}catch(y){m(y)}}var c;this.next||(n(s.prototype),n(s.prototype,typeof Symbol=="function"&&Symbol.asyncIterator||"@asyncIterator",function(){return this})),n(this,"_invoke",function(f,d,p){function m(){return new l(function(v,b){u(f,p,v,b)})}return c=c?c.then(m,m):m()},!0)}e.exports=s,e.exports.__esModule=!0,e.exports.default=e.exports}),GE=Rt((i,e)=>{_t(),Et(),St();var t=HE(),n=zE();function s(a,l,u,c,f){return new n(t().w(a,l,u,c),f||Promise)}e.exports=s,e.exports.__esModule=!0,e.exports.default=e.exports}),E5=Rt((i,e)=>{_t(),Et(),St();var t=GE();function n(s,a,l,u,c){var f=t(s,a,l,u,c);return f.next().then(function(d){return d.done?d.value:f.next()})}e.exports=n,e.exports.__esModule=!0,e.exports.default=e.exports}),C5=Rt((i,e)=>{_t(),Et(),St();function t(n){var s=Object(n),a=[];for(var l in s)a.unshift(l);return function u(){for(;a.length;)if((l=a.pop())in s)return u.value=l,u.done=!1,u;return u.done=!0,u}}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports}),A5=Rt((i,e)=>{_t(),Et(),St();var t=_d().default;function n(s){if(s!=null){var a=s[typeof Symbol=="function"&&Symbol.iterator||"@@iterator"],l=0;if(a)return a.call(s);if(typeof s.next=="function")return s;if(!isNaN(s.length))return{next:function(){return s&&l>=s.length&&(s=void 0),{value:s&&s[l++],done:!s}}}}throw new TypeError(t(s)+" is not iterable")}e.exports=n,e.exports.__esModule=!0,e.exports.default=e.exports}),k5=Rt((i,e)=>{_t(),Et(),St();var t=qE(),n=HE(),s=E5(),a=GE(),l=zE(),u=C5(),c=A5();function f(){var d=n(),p=d.m(f),m=(Object.getPrototypeOf?Object.getPrototypeOf(p):p.__proto__).constructor;function v(w){var C=typeof w=="function"&&w.constructor;return!!C&&(C===m||(C.displayName||C.name)==="GeneratorFunction")}var b={throw:1,return:2,break:3,continue:3};function y(w){var C,S;return function(x){C||(C={stop:function(){return S(x.a,2)},catch:function(){return x.v},abrupt:function(k,A){return S(x.a,b[k],A)},delegateYield:function(k,A,R){return C.resultName=A,S(x.d,c(k),R)},finish:function(k){return S(x.f,k)}},S=function(k,A,R){x.p=C.prev,x.n=C.next;try{return k(A,R)}finally{C.next=x.n}}),C.resultName&&(C[C.resultName]=x.v,C.resultName=void 0),C.sent=x.v,C.next=x.n;try{return w.call(this,C)}finally{x.p=C.prev,x.n=C.next}}}return(e.exports=f=function(){return{wrap:function(w,C,S,x){return d.w(y(w),C,S,x&&x.reverse())},isGeneratorFunction:v,mark:d.m,awrap:function(w,C){return new t(w,C)},AsyncIterator:l,async:function(w,C,S,x,k){return(v(C)?a:s)(y(w),C,S,x,k)},keys:u,values:c}},e.exports.__esModule=!0,e.exports.default=e.exports)()}e.exports=f,e.exports.__esModule=!0,e.exports.default=e.exports}),T5=Rt((i,e)=>{_t(),Et(),St();var t=k5()();e.exports=t;try{regeneratorRuntime=t}catch{typeof globalThis=="object"?globalThis.regeneratorRuntime=t:Function("r","regeneratorRuntime = r")(t)}}),M5=Rt((i,e)=>{_t(),Et(),St(),(function(t,n){typeof i=="object"&&typeof e<"u"?n(i,m5(),_5(),UE(),S5(),T5()):typeof define=="function"&&define.amd?define(["exports","@babel/runtime/helpers/defineProperty","@babel/runtime/helpers/slicedToArray","fast-unique-numbers","@babel/runtime/helpers/asyncToGenerator","@babel/runtime/regenerator"],n):(t=typeof globalThis<"u"?globalThis:t||self,n(t.brokerFactory={},t._defineProperty,t._slicedToArray,t.fastUniqueNumbers,t._asyncToGenerator,t._regeneratorRuntime))})(i,function(t,n,s,a,l,u){var c=function(S){return typeof S.start=="function"},f=new WeakMap;function d(S,x){var k=Object.keys(S);if(Object.getOwnPropertySymbols){var A=Object.getOwnPropertySymbols(S);x&&(A=A.filter(function(R){return Object.getOwnPropertyDescriptor(S,R).enumerable})),k.push.apply(k,A)}return k}function p(S){for(var x=1;x<arguments.length;x++){var k=arguments[x]!=null?arguments[x]:{};x%2?d(Object(k),!0).forEach(function(A){n(S,A,k[A])}):Object.getOwnPropertyDescriptors?Object.defineProperties(S,Object.getOwnPropertyDescriptors(k)):d(Object(k)).forEach(function(A){Object.defineProperty(S,A,Object.getOwnPropertyDescriptor(k,A))})}return S}var m=function(S){return p(p({},S),{},{connect:function(x){var k=x.call;return l(u.mark(function A(){var R,I,U,te;return u.wrap(function(G){for(;;)switch(G.prev=G.next){case 0:return R=new MessageChannel,I=R.port1,U=R.port2,G.next=1,k("connect",{port:I},[I]);case 1:return te=G.sent,f.set(U,te),G.abrupt("return",U);case 2:case"end":return G.stop()}},A)}))},disconnect:function(x){var k=x.call;return(function(){var A=l(u.mark(function R(I){var U;return u.wrap(function(te){for(;;)switch(te.prev=te.next){case 0:if(U=f.get(I),U!==void 0){te.next=1;break}throw new Error("The given port is not connected.");case 1:return te.next=2,k("disconnect",{portId:U});case 2:case"end":return te.stop()}},R)}));return function(R){return A.apply(this,arguments)}})()},isSupported:function(x){var k=x.call;return function(){return k("isSupported")}}})};function v(S,x){var k=Object.keys(S);if(Object.getOwnPropertySymbols){var A=Object.getOwnPropertySymbols(S);x&&(A=A.filter(function(R){return Object.getOwnPropertyDescriptor(S,R).enumerable})),k.push.apply(k,A)}return k}function b(S){for(var x=1;x<arguments.length;x++){var k=arguments[x]!=null?arguments[x]:{};x%2?v(Object(k),!0).forEach(function(A){n(S,A,k[A])}):Object.getOwnPropertyDescriptors?Object.defineProperties(S,Object.getOwnPropertyDescriptors(k)):v(Object(k)).forEach(function(A){Object.defineProperty(S,A,Object.getOwnPropertyDescriptor(k,A))})}return S}var y=new WeakMap,w=function(S){if(y.has(S))return y.get(S);var x=new Map;return y.set(S,x),x},C=function(S){var x=m(S);return function(k){var A=w(k);k.addEventListener("message",function(Q){var q=Q.data,ee=q.id;if(ee!==null&&A.has(ee)){var ne=A.get(ee),B=ne.reject,z=ne.resolve;A.delete(ee),q.error===void 0?z(q.result):B(new Error(q.error.message))}}),c(k)&&k.start();for(var R=function(Q){var q=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,ee=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];return new Promise(function(ne,B){var z=a.generateUniqueNumber(A);A.set(z,{reject:B,resolve:ne}),q===null?k.postMessage({id:z,method:Q},ee):k.postMessage({id:z,method:Q,params:q},ee)})},I=function(Q,q){var ee=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];k.postMessage({id:null,method:Q,params:q},ee)},U={},te=0,G=Object.entries(x);te<G.length;te++){var Y=s(G[te],2),O=Y[0],N=Y[1];U=b(b({},U),{},n({},O,N({call:R,notify:I})))}return b({},U)}};t.createBroker=C})}),I5=Rt((i,e)=>{_t(),Et(),St(),(function(t,n){typeof i=="object"&&typeof e<"u"?n(i,_d(),M5(),UE()):typeof define=="function"&&define.amd?define(["exports","@babel/runtime/helpers/typeof","broker-factory","fast-unique-numbers"],n):(t=typeof globalThis<"u"?globalThis:t||self,n(t.workerTimersBroker={},t._typeof,t.brokerFactory,t.fastUniqueNumbers))})(i,function(t,n,s,a){var l=new Map([[0,null]]),u=new Map([[0,null]]),c=s.createBroker({clearInterval:function(d){var p=d.call;return function(m){n(l.get(m))==="symbol"&&(l.set(m,null),p("clear",{timerId:m,timerType:"interval"}).then(function(){l.delete(m)}))}},clearTimeout:function(d){var p=d.call;return function(m){n(u.get(m))==="symbol"&&(u.set(m,null),p("clear",{timerId:m,timerType:"timeout"}).then(function(){u.delete(m)}))}},setInterval:function(d){var p=d.call;return function(m){for(var v=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,b=arguments.length,y=new Array(b>2?b-2:0),w=2;w<b;w++)y[w-2]=arguments[w];var C=Symbol(),S=a.generateUniqueNumber(l);l.set(S,C);var x=function(){return p("set",{delay:v,now:performance.timeOrigin+performance.now(),timerId:S,timerType:"interval"}).then(function(){var k=l.get(S);if(k===void 0)throw new Error("The timer is in an undefined state.");k===C&&(m.apply(void 0,y),l.get(S)===C&&x())})};return x(),S}},setTimeout:function(d){var p=d.call;return function(m){for(var v=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,b=arguments.length,y=new Array(b>2?b-2:0),w=2;w<b;w++)y[w-2]=arguments[w];var C=Symbol(),S=a.generateUniqueNumber(u);return u.set(S,C),p("set",{delay:v,now:performance.timeOrigin+performance.now(),timerId:S,timerType:"timeout"}).then(function(){var x=u.get(S);if(x===void 0)throw new Error("The timer is in an undefined state.");x===C&&(u.delete(S),m.apply(void 0,y))}),S}}}),f=function(d){var p=new Worker(d);return c(p)};t.load=f,t.wrap=c})}),R5=Rt((i,e)=>{_t(),Et(),St(),(function(t,n){typeof i=="object"&&typeof e<"u"?n(i,I5()):typeof define=="function"&&define.amd?define(["exports","worker-timers-broker"],n):(t=typeof globalThis<"u"?globalThis:t||self,n(t.workerTimers={},t.workerTimersBroker))})(i,function(t,n){var s=function(p,m){var v=null;return function(){if(v!==null)return v;var b=new Blob([m],{type:"application/javascript; charset=utf-8"}),y=URL.createObjectURL(b);return v=p(y),setTimeout(function(){return URL.revokeObjectURL(y)}),v}},a=`(()=>{var e={45:(e,t,r)=>{var n=r(738).default;e.exports=function(e,t){if("object"!=n(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,t||"default");if("object"!=n(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)},e.exports.__esModule=!0,e.exports.default=e.exports},79:e=>{e.exports=function(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n},e.exports.__esModule=!0,e.exports.default=e.exports},122:(e,t,r)=>{var n=r(79);e.exports=function(e,t){if(e){if("string"==typeof e)return n(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?n(e,t):void 0}},e.exports.__esModule=!0,e.exports.default=e.exports},156:e=>{e.exports=function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,u,a,i=[],s=!0,c=!1;try{if(u=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=u.call(r)).done)&&(i.push(n.value),i.length!==t);s=!0);}catch(e){c=!0,o=e}finally{try{if(!s&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(c)throw o}}return i}},e.exports.__esModule=!0,e.exports.default=e.exports},172:e=>{e.exports=function(e,t){this.v=e,this.k=t},e.exports.__esModule=!0,e.exports.default=e.exports},293:e=>{function t(e,t,r,n,o,u,a){try{var i=e[u](a),s=i.value}catch(e){return void r(e)}i.done?t(s):Promise.resolve(s).then(n,o)}e.exports=function(e){return function(){var r=this,n=arguments;return new Promise((function(o,u){var a=e.apply(r,n);function i(e){t(a,o,u,i,s,"next",e)}function s(e){t(a,o,u,i,s,"throw",e)}i(void 0)}))}},e.exports.__esModule=!0,e.exports.default=e.exports},373:e=>{e.exports=function(e){var t=Object(e),r=[];for(var n in t)r.unshift(n);return function e(){for(;r.length;)if((n=r.pop())in t)return e.value=n,e.done=!1,e;return e.done=!0,e}},e.exports.__esModule=!0,e.exports.default=e.exports},389:function(e,t){!function(e){"use strict";var t=function(e){return function(t){var r=e(t);return t.add(r),r}},r=function(e){return function(t,r){return e.set(t,r),r}},n=void 0===Number.MAX_SAFE_INTEGER?9007199254740991:Number.MAX_SAFE_INTEGER,o=536870912,u=2*o,a=function(e,t){return function(r){var a=t.get(r),i=void 0===a?r.size:a<u?a+1:0;if(!r.has(i))return e(r,i);if(r.size<o){for(;r.has(i);)i=Math.floor(Math.random()*u);return e(r,i)}if(r.size>n)throw new Error("Congratulations, you created a collection of unique numbers which uses all available integers!");for(;r.has(i);)i=Math.floor(Math.random()*n);return e(r,i)}},i=new WeakMap,s=r(i),c=a(s,i),f=t(c);e.addUniqueNumber=f,e.generateUniqueNumber=c}(t)},472:function(e,t,r){!function(e,t,r,n){"use strict";var o=function(e,t){return function(r){var o=t.get(r);if(void 0===o)return Promise.resolve(!1);var u=n(o,2),a=u[0],i=u[1];return e(a),t.delete(r),i(!1),Promise.resolve(!0)}},u=function(e,t){var r=function(n,o,u,a){var i=n-e.now();i>0?o.set(a,[t(r,i,n,o,u,a),u]):(o.delete(a),u(!0))};return r},a=function(e,t,r,n){return function(o,u,a){var i=o+u-t.timeOrigin,s=i-t.now();return new Promise((function(t){e.set(a,[r(n,s,i,e,t,a),t])}))}},i=new Map,s=o(globalThis.clearTimeout,i),c=new Map,f=o(globalThis.clearTimeout,c),l=u(performance,globalThis.setTimeout),p=a(i,performance,globalThis.setTimeout,l),d=a(c,performance,globalThis.setTimeout,l);r.createWorker(self,{clear:function(){var r=e(t.mark((function e(r){var n,o,u;return t.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=r.timerId,o=r.timerType,e.next=1,"interval"===o?s(n):f(n);case 1:return u=e.sent,e.abrupt("return",{result:u});case 2:case"end":return e.stop()}}),e)})));function n(e){return r.apply(this,arguments)}return n}(),set:function(){var r=e(t.mark((function e(r){var n,o,u,a,i;return t.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=r.delay,o=r.now,u=r.timerId,a=r.timerType,e.next=1,("interval"===a?p:d)(n,o,u);case 1:return i=e.sent,e.abrupt("return",{result:i});case 2:case"end":return e.stop()}}),e)})));function n(e){return r.apply(this,arguments)}return n}()})}(r(293),r(756),r(623),r(715))},546:e=>{function t(r,n,o,u){var a=Object.defineProperty;try{a({},"",{})}catch(r){a=0}e.exports=t=function(e,r,n,o){if(r)a?a(e,r,{value:n,enumerable:!o,configurable:!o,writable:!o}):e[r]=n;else{var u=function(r,n){t(e,r,(function(e){return this._invoke(r,n,e)}))};u("next",0),u("throw",1),u("return",2)}},e.exports.__esModule=!0,e.exports.default=e.exports,t(r,n,o,u)}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports},579:(e,t,r)=>{var n=r(738).default;e.exports=function(e){if(null!=e){var t=e["function"==typeof Symbol&&Symbol.iterator||"@@iterator"],r=0;if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length))return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}}}throw new TypeError(n(e)+" is not iterable")},e.exports.__esModule=!0,e.exports.default=e.exports},623:function(e,t,r){!function(e,t,r,n,o){"use strict";var u={INTERNAL_ERROR:-32603,INVALID_PARAMS:-32602,METHOD_NOT_FOUND:-32601},a=function(e,t){return Object.assign(new Error(e),{status:t})},i=function(e){return a('The requested method called "'.concat(e,'" is not supported.'),u.METHOD_NOT_FOUND)},s=function(e){return a('The handler of the method called "'.concat(e,'" returned no required result.'),u.INTERNAL_ERROR)},c=function(e){return a('The handler of the method called "'.concat(e,'" returned an unexpected result.'),u.INTERNAL_ERROR)},f=function(e){return a('The specified parameter called "portId" with the given value "'.concat(e,'" does not identify a port connected to this worker.'),u.INVALID_PARAMS)},l=function(e,n){return function(){var o=t(r.mark((function t(o){var u,a,f,l,p,d,v,x,y,b,h,m,_,g,w;return r.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(u=o.data,a=u.id,f=u.method,l=u.params,p=n[f],t.prev=1,void 0!==p){t.next=2;break}throw i(f);case 2:if(void 0!==(d=void 0===l?p():p(l))){t.next=3;break}throw s(f);case 3:if(!(d instanceof Promise)){t.next=5;break}return t.next=4,d;case 4:g=t.sent,t.next=6;break;case 5:g=d;case 6:if(v=g,null!==a){t.next=8;break}if(void 0===v.result){t.next=7;break}throw c(f);case 7:t.next=10;break;case 8:if(void 0!==v.result){t.next=9;break}throw c(f);case 9:x=v.result,y=v.transferables,b=void 0===y?[]:y,e.postMessage({id:a,result:x},b);case 10:t.next=12;break;case 11:t.prev=11,w=t.catch(1),h=w.message,m=w.status,_=void 0===m?-32603:m,e.postMessage({error:{code:_,message:h},id:a});case 12:case"end":return t.stop()}}),t,null,[[1,11]])})));return function(e){return o.apply(this,arguments)}}()},p=function(){return new Promise((function(e){var t=new ArrayBuffer(0),r=new MessageChannel,n=r.port1,o=r.port2;n.onmessage=function(t){var r=t.data;return e(null!==r)},o.postMessage(t,[t])}))};function d(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function v(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?d(Object(r),!0).forEach((function(t){n(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):d(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var x=new Map,y=function(e,n,u){return v(v({},n),{},{connect:function(t){var r=t.port;r.start();var u=e(r,n),a=o.generateUniqueNumber(x);return x.set(a,(function(){u(),r.close(),x.delete(a)})),{result:a}},disconnect:function(e){var t=e.portId,r=x.get(t);if(void 0===r)throw f(t);return r(),{result:null}},isSupported:function(){var e=t(r.mark((function e(){var t,n,o;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=1,p();case 1:if(!e.sent){e.next=5;break}if(!((t=u())instanceof Promise)){e.next=3;break}return e.next=2,t;case 2:o=e.sent,e.next=4;break;case 3:o=t;case 4:return n=o,e.abrupt("return",{result:n});case 5:return e.abrupt("return",{result:!1});case 6:case"end":return e.stop()}}),e)})));function n(){return e.apply(this,arguments)}return n}()})},b=function(e,t){var r=y(b,t,arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){return!0}),n=l(e,r);return e.addEventListener("message",n),function(){return e.removeEventListener("message",n)}};e.createWorker=b,e.isSupported=p}(t,r(293),r(756),r(693),r(389))},633:(e,t,r)=>{var n=r(172),o=r(993),u=r(869),a=r(887),i=r(791),s=r(373),c=r(579);function f(){"use strict";var t=o(),r=t.m(f),l=(Object.getPrototypeOf?Object.getPrototypeOf(r):r.__proto__).constructor;function p(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===l||"GeneratorFunction"===(t.displayName||t.name))}var d={throw:1,return:2,break:3,continue:3};function v(e){var t,r;return function(n){t||(t={stop:function(){return r(n.a,2)},catch:function(){return n.v},abrupt:function(e,t){return r(n.a,d[e],t)},delegateYield:function(e,o,u){return t.resultName=o,r(n.d,c(e),u)},finish:function(e){return r(n.f,e)}},r=function(e,r,o){n.p=t.prev,n.n=t.next;try{return e(r,o)}finally{t.next=n.n}}),t.resultName&&(t[t.resultName]=n.v,t.resultName=void 0),t.sent=n.v,t.next=n.n;try{return e.call(this,t)}finally{n.p=t.prev,n.n=t.next}}}return(e.exports=f=function(){return{wrap:function(e,r,n,o){return t.w(v(e),r,n,o&&o.reverse())},isGeneratorFunction:p,mark:t.m,awrap:function(e,t){return new n(e,t)},AsyncIterator:i,async:function(e,t,r,n,o){return(p(t)?a:u)(v(e),t,r,n,o)},keys:s,values:c}},e.exports.__esModule=!0,e.exports.default=e.exports)()}e.exports=f,e.exports.__esModule=!0,e.exports.default=e.exports},693:(e,t,r)=>{var n=r(736);e.exports=function(e,t,r){return(t=n(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e},e.exports.__esModule=!0,e.exports.default=e.exports},715:(e,t,r)=>{var n=r(987),o=r(156),u=r(122),a=r(752);e.exports=function(e,t){return n(e)||o(e,t)||u(e,t)||a()},e.exports.__esModule=!0,e.exports.default=e.exports},736:(e,t,r)=>{var n=r(738).default,o=r(45);e.exports=function(e){var t=o(e,"string");return"symbol"==n(t)?t:t+""},e.exports.__esModule=!0,e.exports.default=e.exports},738:e=>{function t(r){return e.exports=t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e.exports.__esModule=!0,e.exports.default=e.exports,t(r)}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports},752:e=>{e.exports=function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")},e.exports.__esModule=!0,e.exports.default=e.exports},756:(e,t,r)=>{var n=r(633)();e.exports=n;try{regeneratorRuntime=n}catch(e){"object"==typeof globalThis?globalThis.regeneratorRuntime=n:Function("r","regeneratorRuntime = r")(n)}},791:(e,t,r)=>{var n=r(172),o=r(546);e.exports=function e(t,r){function u(e,o,a,i){try{var s=t[e](o),c=s.value;return c instanceof n?r.resolve(c.v).then((function(e){u("next",e,a,i)}),(function(e){u("throw",e,a,i)})):r.resolve(c).then((function(e){s.value=e,a(s)}),(function(e){return u("throw",e,a,i)}))}catch(e){i(e)}}var a;this.next||(o(e.prototype),o(e.prototype,"function"==typeof Symbol&&Symbol.asyncIterator||"@asyncIterator",(function(){return this}))),o(this,"_invoke",(function(e,t,n){function o(){return new r((function(t,r){u(e,n,t,r)}))}return a=a?a.then(o,o):o()}),!0)},e.exports.__esModule=!0,e.exports.default=e.exports},869:(e,t,r)=>{var n=r(887);e.exports=function(e,t,r,o,u){var a=n(e,t,r,o,u);return a.next().then((function(e){return e.done?e.value:a.next()}))},e.exports.__esModule=!0,e.exports.default=e.exports},887:(e,t,r)=>{var n=r(993),o=r(791);e.exports=function(e,t,r,u,a){return new o(n().w(e,t,r,u),a||Promise)},e.exports.__esModule=!0,e.exports.default=e.exports},987:e=>{e.exports=function(e){if(Array.isArray(e))return e},e.exports.__esModule=!0,e.exports.default=e.exports},993:(e,t,r)=>{var n=r(546);function o(){var t,r,u="function"==typeof Symbol?Symbol:{},a=u.iterator||"@@iterator",i=u.toStringTag||"@@toStringTag";function s(e,o,u,a){var i=o&&o.prototype instanceof f?o:f,s=Object.create(i.prototype);return n(s,"_invoke",function(e,n,o){var u,a,i,s=0,f=o||[],l=!1,p={p:0,n:0,v:t,a:d,f:d.bind(t,4),d:function(e,r){return u=e,a=0,i=t,p.n=r,c}};function d(e,n){for(a=e,i=n,r=0;!l&&s&&!o&&r<f.length;r++){var o,u=f[r],d=p.p,v=u[2];e>3?(o=v===n)&&(i=u[(a=u[4])?5:(a=3,3)],u[4]=u[5]=t):u[0]<=d&&((o=e<2&&d<u[1])?(a=0,p.v=n,p.n=u[1]):d<v&&(o=e<3||u[0]>n||n>v)&&(u[4]=e,u[5]=n,p.n=v,a=0))}if(o||e>1)return c;throw l=!0,n}return function(o,f,v){if(s>1)throw TypeError("Generator is already running");for(l&&1===f&&d(f,v),a=f,i=v;(r=a<2?t:i)||!l;){u||(a?a<3?(a>1&&(p.n=-1),d(a,i)):p.n=i:p.v=i);try{if(s=2,u){if(a||(o="next"),r=u[o]){if(!(r=r.call(u,i)))throw TypeError("iterator result is not an object");if(!r.done)return r;i=r.value,a<2&&(a=0)}else 1===a&&(r=u.return)&&r.call(u),a<2&&(i=TypeError("The iterator does not provide a '"+o+"' method"),a=1);u=t}else if((r=(l=p.n<0)?i:e.call(n,p))!==c)break}catch(e){u=t,a=1,i=e}finally{s=1}}return{value:r,done:l}}}(e,u,a),!0),s}var c={};function f(){}function l(){}function p(){}r=Object.getPrototypeOf;var d=[][a]?r(r([][a]())):(n(r={},a,(function(){return this})),r),v=p.prototype=f.prototype=Object.create(d);function x(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,p):(e.__proto__=p,n(e,i,"GeneratorFunction")),e.prototype=Object.create(v),e}return l.prototype=p,n(v,"constructor",p),n(p,"constructor",l),l.displayName="GeneratorFunction",n(p,i,"GeneratorFunction"),n(v),n(v,i,"Generator"),n(v,a,(function(){return this})),n(v,"toString",(function(){return"[object Generator]"})),(e.exports=o=function(){return{w:s,m:x}},e.exports.__esModule=!0,e.exports.default=e.exports)()}e.exports=o,e.exports.__esModule=!0,e.exports.default=e.exports}},t={};function r(n){var o=t[n];if(void 0!==o)return o.exports;var u=t[n]={exports:{}};return e[n].call(u.exports,u,u.exports,r),u.exports}r.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return r.d(t,{a:t}),t},r.d=(e,t)=>{for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{"use strict";r(472)})()})();`,l=s(n.load,a),u=function(p){return l().clearInterval(p)},c=function(p){return l().clearTimeout(p)},f=function(){var p;return(p=l()).setInterval.apply(p,arguments)},d=function(){var p;return(p=l()).setTimeout.apply(p,arguments)};t.clearInterval=u,t.clearTimeout=c,t.setInterval=f,t.setTimeout=d})}),Sd=Rt(i=>{_t(),Et(),St(),Object.defineProperty(i,"__esModule",{value:!0}),i.isReactNativeBrowser=i.isWebWorker=void 0;var e=()=>typeof window<"u"?typeof navigator<"u"&&navigator.userAgent?.toLowerCase().indexOf(" electron/")>-1&&vr?.versions?!Object.prototype.hasOwnProperty.call(vr.versions,"electron"):typeof window.document<"u":!1,t=()=>!!(typeof self=="object"&&self?.constructor?.name?.includes("WorkerGlobalScope")&&typeof Deno>"u"),n=()=>typeof navigator<"u"&&navigator.product==="ReactNative",s=e()||t()||n();i.isWebWorker=t(),i.isReactNativeBrowser=n(),i.default=s}),O5=Rt(i=>{_t(),Et(),St();var e=i&&i.__createBinding||(Object.create?function(f,d,p,m){m===void 0&&(m=p);var v=Object.getOwnPropertyDescriptor(d,p);(!v||("get"in v?!d.__esModule:v.writable||v.configurable))&&(v={enumerable:!0,get:function(){return d[p]}}),Object.defineProperty(f,m,v)}:function(f,d,p,m){m===void 0&&(m=p),f[m]=d[p]}),t=i&&i.__setModuleDefault||(Object.create?function(f,d){Object.defineProperty(f,"default",{enumerable:!0,value:d})}:function(f,d){f.default=d}),n=i&&i.__importStar||(function(){var f=function(d){return f=Object.getOwnPropertyNames||function(p){var m=[];for(var v in p)Object.prototype.hasOwnProperty.call(p,v)&&(m[m.length]=v);return m},f(d)};return function(d){if(d&&d.__esModule)return d;var p={};if(d!=null)for(var m=f(d),v=0;v<m.length;v++)m[v]!=="default"&&e(p,d,m[v]);return t(p,d),p}})();Object.defineProperty(i,"__esModule",{value:!0});var s=R5(),a=n(Sd()),l={set:s.setInterval,clear:s.clearInterval},u={set:(f,d)=>setInterval(f,d),clear:f=>clearInterval(f)},c=f=>{switch(f){case"native":return u;case"worker":return l;case"auto":default:return a.default&&!a.isWebWorker&&!a.isReactNativeBrowser?l:u}};i.default=c}),KE=Rt(i=>{_t(),Et(),St();var e=i&&i.__importDefault||function(s){return s&&s.__esModule?s:{default:s}};Object.defineProperty(i,"__esModule",{value:!0});var t=e(O5()),n=class{_keepalive;timerId;timer;destroyed=!1;counter;client;_keepaliveTimeoutTimestamp;_intervalEvery;get keepaliveTimeoutTimestamp(){return this._keepaliveTimeoutTimestamp}get intervalEvery(){return this._intervalEvery}get keepalive(){return this._keepalive}constructor(s,a){this.client=s,this.timer=typeof a=="object"&&"set"in a&&"clear"in a?a:(0,t.default)(a),this.setKeepalive(s.options.keepalive)}clear(){this.timerId&&(this.timer.clear(this.timerId),this.timerId=null)}setKeepalive(s){if(s*=1e3,isNaN(s)||s<=0||s>2147483647)throw new Error(`Keepalive value must be an integer between 0 and 2147483647. Provided value is ${s}`);this._keepalive=s,this.reschedule(),this.client.log(`KeepaliveManager: set keepalive to ${s}ms`)}destroy(){this.clear(),this.destroyed=!0}reschedule(){if(this.destroyed)return;this.clear(),this.counter=0;let s=Math.ceil(this._keepalive*1.5);this._keepaliveTimeoutTimestamp=Date.now()+s,this._intervalEvery=Math.ceil(this._keepalive/2),this.timerId=this.timer.set(()=>{this.destroyed||(this.counter+=1,this.counter===2?this.client.sendPing():this.counter>2&&this.client.onKeepaliveTimeout())},this._intervalEvery)}};i.default=n}),jm=Rt(i=>{_t(),Et(),St();var e=i&&i.__createBinding||(Object.create?function(A,R,I,U){U===void 0&&(U=I);var te=Object.getOwnPropertyDescriptor(R,I);(!te||("get"in te?!R.__esModule:te.writable||te.configurable))&&(te={enumerable:!0,get:function(){return R[I]}}),Object.defineProperty(A,U,te)}:function(A,R,I,U){U===void 0&&(U=I),A[U]=R[I]}),t=i&&i.__setModuleDefault||(Object.create?function(A,R){Object.defineProperty(A,"default",{enumerable:!0,value:R})}:function(A,R){A.default=R}),n=i&&i.__importStar||(function(){var A=function(R){return A=Object.getOwnPropertyNames||function(I){var U=[];for(var te in I)Object.prototype.hasOwnProperty.call(I,te)&&(U[U.length]=te);return U},A(R)};return function(R){if(R&&R.__esModule)return R;var I={};if(R!=null)for(var U=A(R),te=0;te<U.length;te++)U[te]!=="default"&&e(I,R,U[te]);return t(I,R),I}})(),s=i&&i.__importDefault||function(A){return A&&A.__esModule?A:{default:A}};Object.defineProperty(i,"__esModule",{value:!0});var a=s(F6()),l=jl(),u=s(z6()),c=s(Ro()),f=n(G6()),d=s(xE()),p=s(f5()),m=s(LE()),v=s(h5()),b=Pc(),y=d5(),w=s(KE()),C=n(Sd()),S=globalThis.setImmediate||((...A)=>{let R=A.shift();(0,b.nextTick)(()=>{R(...A)})}),x={keepalive:60,reschedulePings:!0,protocolId:"MQTT",protocolVersion:4,reconnectPeriod:1e3,connectTimeout:30*1e3,clean:!0,resubscribe:!0,subscribeBatchSize:null,writeCache:!0,timerVariant:"auto"},k=class Dm extends y.TypedEventEmitter{static VERSION=b.MQTTJS_VERSION;connected;disconnecting;disconnected;reconnecting;incomingStore;outgoingStore;options;queueQoSZero;_reconnectCount;log;messageIdProvider;outgoing;messageIdToTopic;noop;keepaliveManager;stream;queue;streamBuilder;_resubscribeTopics;connackTimer;reconnectTimer;_storeProcessing;_packetIdsDuringStoreProcessing;_storeProcessingQueue;_firstConnection;topicAliasRecv;topicAliasSend;_deferredReconnect;connackPacket;static defaultId(){return`mqttjs_${Math.random().toString(16).substr(2,8)}`}constructor(R,I){super(),this.options=I||{};for(let U in x)typeof this.options[U]>"u"?this.options[U]=x[U]:this.options[U]=I[U];this.log=this.options.log||(0,c.default)("mqttjs:client"),this.noop=this._noop.bind(this),this.log("MqttClient :: version:",Dm.VERSION),C.isWebWorker?this.log("MqttClient :: environment","webworker"):this.log("MqttClient :: environment",C.default?"browser":"node"),this.log("MqttClient :: options.protocol",I.protocol),this.log("MqttClient :: options.protocolVersion",I.protocolVersion),this.log("MqttClient :: options.username",I.username),this.log("MqttClient :: options.keepalive",I.keepalive),this.log("MqttClient :: options.reconnectPeriod",I.reconnectPeriod),this.log("MqttClient :: options.rejectUnauthorized",I.rejectUnauthorized),this.log("MqttClient :: options.properties.topicAliasMaximum",I.properties?I.properties.topicAliasMaximum:void 0),this.options.clientId=typeof I.clientId=="string"?I.clientId:Dm.defaultId(),this.log("MqttClient :: clientId",this.options.clientId),this.options.customHandleAcks=I.protocolVersion===5&&I.customHandleAcks?I.customHandleAcks:(...U)=>{U[3](null,0)},this.options.writeCache||(a.default.writeToStream.cacheNumbers=!1),this.streamBuilder=R,this.messageIdProvider=typeof this.options.messageIdProvider>"u"?new m.default:this.options.messageIdProvider,this.outgoingStore=I.outgoingStore||new d.default,this.incomingStore=I.incomingStore||new d.default,this.queueQoSZero=I.queueQoSZero===void 0?!0:I.queueQoSZero,this._resubscribeTopics={},this.messageIdToTopic={},this.keepaliveManager=null,this.connected=!1,this.disconnecting=!1,this.reconnecting=!1,this.queue=[],this.connackTimer=null,this.reconnectTimer=null,this._storeProcessing=!1,this._packetIdsDuringStoreProcessing={},this._storeProcessingQueue=[],this.outgoing={},this._firstConnection=!0,I.properties&&I.properties.topicAliasMaximum>0&&(I.properties.topicAliasMaximum>65535?this.log("MqttClient :: options.properties.topicAliasMaximum is out of range"):this.topicAliasRecv=new v.default(I.properties.topicAliasMaximum)),this.on("connect",()=>{let{queue:U}=this,te=()=>{let G=U.shift();this.log("deliver :: entry %o",G);let Y=null;if(!G){this._resubscribe();return}Y=G.packet,this.log("deliver :: call _sendPacket for %o",Y);let O=!0;Y.messageId&&Y.messageId!==0&&(this.messageIdProvider.register(Y.messageId)||(O=!1)),O?this._sendPacket(Y,N=>{G.cb&&G.cb(N),te()}):(this.log("messageId: %d has already used. The message is skipped and removed.",Y.messageId),te())};this.log("connect :: sending queued packets"),te()}),this.on("close",()=>{this.log("close :: connected set to `false`"),this.connected=!1,this.log("close :: clearing connackTimer"),clearTimeout(this.connackTimer),this._destroyKeepaliveManager(),this.topicAliasRecv&&this.topicAliasRecv.clear(),this.log("close :: calling _setupReconnect"),this._setupReconnect()}),this.options.manualConnect||(this.log("MqttClient :: setting up stream"),this.connect())}handleAuth(R,I){I()}handleMessage(R,I){I()}_nextId(){return this.messageIdProvider.allocate()}getLastMessageId(){return this.messageIdProvider.getLastAllocated()}connect(){let R=new l.Writable,I=a.default.parser(this.options),U=null,te=[];this.log("connect :: calling method to clear reconnect"),this._clearReconnect(),this.disconnected&&!this.reconnecting&&(this.incomingStore=this.options.incomingStore||new d.default,this.outgoingStore=this.options.outgoingStore||new d.default,this.disconnecting=!1,this.disconnected=!1),this.log("connect :: using streamBuilder provided to client to create stream"),this.stream=this.streamBuilder(this),I.on("packet",Q=>{this.log("parser :: on packet push to packets array."),te.push(Q)});let G=()=>{this.log("work :: getting next packet in queue");let Q=te.shift();if(Q)this.log("work :: packet pulled from queue"),(0,p.default)(this,Q,Y);else{this.log("work :: no packets in queue");let q=U;U=null,this.log("work :: done flag is %s",!!q),q&&q()}},Y=()=>{if(te.length)(0,b.nextTick)(G);else{let Q=U;U=null,Q()}};R._write=(Q,q,ee)=>{U=ee,this.log("writable stream :: parsing buffer"),I.parse(Q),G()};let O=Q=>{this.log("streamErrorHandler :: error",Q.message),Q.code?(this.log("streamErrorHandler :: emitting error"),this.emit("error",Q)):this.noop(Q)};this.log("connect :: pipe stream to writable stream"),this.stream.pipe(R),this.stream.on("error",O),this.stream.on("close",()=>{this.log("(%s)stream :: on close",this.options.clientId),this._flushVolatile(),this.log("stream: emit close to MqttClient"),this.emit("close")}),this.log("connect: sending packet `connect`");let N={cmd:"connect",protocolId:this.options.protocolId,protocolVersion:this.options.protocolVersion,clean:this.options.clean,clientId:this.options.clientId,keepalive:this.options.keepalive,username:this.options.username,password:this.options.password,properties:this.options.properties};if(this.options.will&&(N.will={...this.options.will,payload:this.options.will?.payload}),this.topicAliasRecv&&(N.properties||(N.properties={}),this.topicAliasRecv&&(N.properties.topicAliasMaximum=this.topicAliasRecv.max)),this._writePacket(N),I.on("error",this.emit.bind(this,"error")),this.options.properties){if(!this.options.properties.authenticationMethod&&this.options.properties.authenticationData)return this.end(()=>this.emit("error",new Error("Packet has no Authentication Method"))),this;if(this.options.properties.authenticationMethod&&this.options.authPacket&&typeof this.options.authPacket=="object"){let Q={cmd:"auth",reasonCode:0,...this.options.authPacket};this._writePacket(Q)}}return this.stream.setMaxListeners(1e3),clearTimeout(this.connackTimer),this.connackTimer=setTimeout(()=>{this.log("!!connectTimeout hit!! Calling _cleanUp with force `true`"),this.emit("error",new Error("connack timeout")),this._cleanUp(!0)},this.options.connectTimeout),this}publish(R,I,U,te){this.log("publish :: message `%s` to topic `%s`",I,R);let{options:G}=this;typeof U=="function"&&(te=U,U=null),U=U||{},U={qos:0,retain:!1,dup:!1,...U};let{qos:Y,retain:O,dup:N,properties:Q,cbStorePut:q}=U;if(this._checkDisconnecting(te))return this;let ee=()=>{let ne=0;if((Y===1||Y===2)&&(ne=this._nextId(),ne===null))return this.log("No messageId left"),!1;let B={cmd:"publish",topic:R,payload:I,qos:Y,retain:O,messageId:ne,dup:N};switch(G.protocolVersion===5&&(B.properties=Q),this.log("publish :: qos",Y),Y){case 1:case 2:this.outgoing[B.messageId]={volatile:!1,cb:te||this.noop},this.log("MqttClient:publish: packet cmd: %s",B.cmd),this._sendPacket(B,void 0,q);break;default:this.log("MqttClient:publish: packet cmd: %s",B.cmd),this._sendPacket(B,te,q);break}return!0};return(this._storeProcessing||this._storeProcessingQueue.length>0||!ee())&&this._storeProcessingQueue.push({invoke:ee,cbStorePut:U.cbStorePut,callback:te}),this}publishAsync(R,I,U){return new Promise((te,G)=>{this.publish(R,I,U,(Y,O)=>{Y?G(Y):te(O)})})}subscribe(R,I,U){let te=this.options.protocolVersion;typeof I=="function"&&(U=I),U=U||this.noop;let G=!1,Y=[];typeof R=="string"?(R=[R],Y=R):Array.isArray(R)?Y=R:typeof R=="object"&&(G=R.resubscribe,delete R.resubscribe,Y=Object.keys(R));let O=f.validateTopics(Y);if(O!==null)return S(U,new Error(`Invalid topic ${O}`)),this;if(this._checkDisconnecting(U))return this.log("subscribe: discconecting true"),this;let N={qos:0};te===5&&(N.nl=!1,N.rap=!1,N.rh=0),I={...N,...I};let{properties:Q}=I,q=[],ee=(z,$)=>{if($=$||I,!Object.prototype.hasOwnProperty.call(this._resubscribeTopics,z)||this._resubscribeTopics[z].qos<$.qos||G){let V={topic:z,qos:$.qos};te===5&&(V.nl=$.nl,V.rap=$.rap,V.rh=$.rh,V.properties=Q),this.log("subscribe: pushing topic `%s` and qos `%s` to subs list",V.topic,V.qos),q.push(V)}};if(Array.isArray(R)?R.forEach(z=>{this.log("subscribe: array topic %s",z),ee(z)}):Object.keys(R).forEach(z=>{this.log("subscribe: object topic %s, %o",z,R[z]),ee(z,R[z])}),!q.length)return U(null,[]),this;let ne=(z,$)=>{let V={cmd:"subscribe",subscriptions:z,messageId:$};if(Q&&(V.properties=Q),this.options.resubscribe){this.log("subscribe :: resubscribe true");let ae=[];z.forEach(Ae=>{if(this.options.reconnectPeriod>0){let be={qos:Ae.qos};te===5&&(be.nl=Ae.nl||!1,be.rap=Ae.rap||!1,be.rh=Ae.rh||0,be.properties=Ae.properties),this._resubscribeTopics[Ae.topic]=be,ae.push(Ae.topic)}}),this.messageIdToTopic[V.messageId]=ae}let Z=new Promise((ae,Ae)=>{this.outgoing[V.messageId]={volatile:!0,cb(be,Ge){if(!be){let{granted:Te}=Ge;for(let ve=0;ve<Te.length;ve+=1)z[ve].qos=Te[ve]}be?Ae(new b.ErrorWithSubackPacket(be.message,Ge)):ae(Ge)}}});return this.log("subscribe :: call _sendPacket"),this._sendPacket(V),Z},B=()=>{let z=this.options.subscribeBatchSize??q.length,$=[];for(let V=0;V<q.length;V+=z){let Z=q.slice(V,V+z),ae=this._nextId();if(ae===null)return this.log("No messageId left"),!1;$.push(ne(Z,ae))}return Promise.all($).then(V=>{U(null,q,V.at(-1))}).catch(V=>{U(V,q,V.packet)}),!0};return(this._storeProcessing||this._storeProcessingQueue.length>0||!B())&&this._storeProcessingQueue.push({invoke:B,callback:U}),this}subscribeAsync(R,I){return new Promise((U,te)=>{this.subscribe(R,I,(G,Y)=>{G?te(G):U(Y)})})}unsubscribe(R,I,U){typeof R=="string"&&(R=[R]),typeof I=="function"&&(U=I),U=U||this.noop;let te=f.validateTopics(R);if(te!==null)return S(U,new Error(`Invalid topic ${te}`)),this;if(this._checkDisconnecting(U))return this;let G=()=>{let Y=this._nextId();if(Y===null)return this.log("No messageId left"),!1;let O={cmd:"unsubscribe",messageId:Y,unsubscriptions:[]};return typeof R=="string"?O.unsubscriptions=[R]:Array.isArray(R)&&(O.unsubscriptions=R),this.options.resubscribe&&O.unsubscriptions.forEach(N=>{delete this._resubscribeTopics[N]}),typeof I=="object"&&I.properties&&(O.properties=I.properties),this.outgoing[O.messageId]={volatile:!0,cb:U},this.log("unsubscribe: call _sendPacket"),this._sendPacket(O),!0};return(this._storeProcessing||this._storeProcessingQueue.length>0||!G())&&this._storeProcessingQueue.push({invoke:G,callback:U}),this}unsubscribeAsync(R,I){return new Promise((U,te)=>{this.unsubscribe(R,I,(G,Y)=>{G?te(G):U(Y)})})}end(R,I,U){this.log("end :: (%s)",this.options.clientId),(R==null||typeof R!="boolean")&&(U=U||I,I=R,R=!1),typeof I!="object"&&(U=U||I,I=null),this.log("end :: cb? %s",!!U),(!U||typeof U!="function")&&(U=this.noop);let te=()=>{this.log("end :: closeStores: closing incoming and outgoing stores"),this.disconnected=!0,this.incomingStore.close(Y=>{this.outgoingStore.close(O=>{if(this.log("end :: closeStores: emitting end"),this.emit("end"),U){let N=Y||O;this.log("end :: closeStores: invoking callback with args"),U(N)}})}),this._deferredReconnect?this._deferredReconnect():(this.options.reconnectPeriod===0||this.options.manualConnect)&&(this.disconnecting=!1)},G=()=>{this.log("end :: (%s) :: finish :: calling _cleanUp with force %s",this.options.clientId,R),this._cleanUp(R,()=>{this.log("end :: finish :: calling process.nextTick on closeStores"),(0,b.nextTick)(te)},I)};return this.disconnecting?(U(),this):(this._clearReconnect(),this.disconnecting=!0,!R&&Object.keys(this.outgoing).length>0?(this.log("end :: (%s) :: calling finish in 10ms once outgoing is empty",this.options.clientId),this.once("outgoingEmpty",setTimeout.bind(null,G,10))):(this.log("end :: (%s) :: immediately calling finish",this.options.clientId),G()),this)}endAsync(R,I){return new Promise((U,te)=>{this.end(R,I,G=>{G?te(G):U()})})}removeOutgoingMessage(R){if(this.outgoing[R]){let{cb:I}=this.outgoing[R];this._removeOutgoingAndStoreMessage(R,()=>{I(new Error("Message removed"))})}return this}reconnect(R){this.log("client reconnect");let I=()=>{R?(this.options.incomingStore=R.incomingStore,this.options.outgoingStore=R.outgoingStore):(this.options.incomingStore=null,this.options.outgoingStore=null),this.incomingStore=this.options.incomingStore||new d.default,this.outgoingStore=this.options.outgoingStore||new d.default,this.disconnecting=!1,this.disconnected=!1,this._deferredReconnect=null,this._reconnect()};return this.disconnecting&&!this.disconnected?this._deferredReconnect=I:I(),this}_flushVolatile(){this.outgoing&&(this.log("_flushVolatile :: deleting volatile messages from the queue and setting their callbacks as error function"),Object.keys(this.outgoing).forEach(R=>{this.outgoing[R].volatile&&typeof this.outgoing[R].cb=="function"&&(this.outgoing[R].cb(new Error("Connection closed")),delete this.outgoing[R])}))}_flush(){this.outgoing&&(this.log("_flush: queue exists? %b",!!this.outgoing),Object.keys(this.outgoing).forEach(R=>{typeof this.outgoing[R].cb=="function"&&(this.outgoing[R].cb(new Error("Connection closed")),delete this.outgoing[R])}))}_removeTopicAliasAndRecoverTopicName(R){let I;R.properties&&(I=R.properties.topicAlias);let U=R.topic.toString();if(this.log("_removeTopicAliasAndRecoverTopicName :: alias %d, topic %o",I,U),U.length===0){if(typeof I>"u")return new Error("Unregistered Topic Alias");if(U=this.topicAliasSend.getTopicByAlias(I),typeof U>"u")return new Error("Unregistered Topic Alias");R.topic=U}I&&delete R.properties.topicAlias}_checkDisconnecting(R){return this.disconnecting&&(R&&R!==this.noop?R(new Error("client disconnecting")):this.emit("error",new Error("client disconnecting"))),this.disconnecting}_reconnect(){this.log("_reconnect: emitting reconnect to client"),this.emit("reconnect"),this.connected?(this.end(()=>{this.connect()}),this.log("client already connected. disconnecting first.")):(this.log("_reconnect: calling connect"),this.connect())}_setupReconnect(){!this.disconnecting&&!this.reconnectTimer&&this.options.reconnectPeriod>0?(this.reconnecting||(this.log("_setupReconnect :: emit `offline` state"),this.emit("offline"),this.log("_setupReconnect :: set `reconnecting` to `true`"),this.reconnecting=!0),this.log("_setupReconnect :: setting reconnectTimer for %d ms",this.options.reconnectPeriod),this.reconnectTimer=setInterval(()=>{this.log("reconnectTimer :: reconnect triggered!"),this._reconnect()},this.options.reconnectPeriod)):this.log("_setupReconnect :: doing nothing...")}_clearReconnect(){this.log("_clearReconnect : clearing reconnect timer"),this.reconnectTimer&&(clearInterval(this.reconnectTimer),this.reconnectTimer=null)}_cleanUp(R,I,U={}){if(I&&(this.log("_cleanUp :: done callback provided for on stream close"),this.stream.on("close",I)),this.log("_cleanUp :: forced? %s",R),R)this.options.reconnectPeriod===0&&this.options.clean&&this._flush(),this.log("_cleanUp :: (%s) :: destroying stream",this.options.clientId),this.stream.destroy();else{let te={cmd:"disconnect",...U};this.log("_cleanUp :: (%s) :: call _sendPacket with disconnect packet",this.options.clientId),this._sendPacket(te,()=>{this.log("_cleanUp :: (%s) :: destroying stream",this.options.clientId),S(()=>{this.stream.end(()=>{this.log("_cleanUp :: (%s) :: stream destroyed",this.options.clientId)})})})}!this.disconnecting&&!this.reconnecting&&(this.log("_cleanUp :: client not disconnecting/reconnecting. Clearing and resetting reconnect."),this._clearReconnect(),this._setupReconnect()),this._destroyKeepaliveManager(),I&&!this.connected&&(this.log("_cleanUp :: (%s) :: removing stream `done` callback `close` listener",this.options.clientId),this.stream.removeListener("close",I),I())}_storeAndSend(R,I,U){this.log("storeAndSend :: store packet with cmd %s to outgoingStore",R.cmd);let te=R,G;if(te.cmd==="publish"&&(te=(0,u.default)(R),G=this._removeTopicAliasAndRecoverTopicName(te),G))return I&&I(G);this.outgoingStore.put(te,Y=>{if(Y)return I&&I(Y);U(),this._writePacket(R,I)})}_applyTopicAlias(R){if(this.options.protocolVersion===5&&R.cmd==="publish"){let I;R.properties&&(I=R.properties.topicAlias);let U=R.topic.toString();if(this.topicAliasSend)if(I){if(U.length!==0&&(this.log("applyTopicAlias :: register topic: %s - alias: %d",U,I),!this.topicAliasSend.put(U,I)))return this.log("applyTopicAlias :: error out of range. topic: %s - alias: %d",U,I),new Error("Sending Topic Alias out of range")}else U.length!==0&&(this.options.autoAssignTopicAlias?(I=this.topicAliasSend.getAliasByTopic(U),I?(R.topic="",R.properties={...R.properties,topicAlias:I},this.log("applyTopicAlias :: auto assign(use) topic: %s - alias: %d",U,I)):(I=this.topicAliasSend.getLruAlias(),this.topicAliasSend.put(U,I),R.properties={...R.properties,topicAlias:I},this.log("applyTopicAlias :: auto assign topic: %s - alias: %d",U,I))):this.options.autoUseTopicAlias&&(I=this.topicAliasSend.getAliasByTopic(U),I&&(R.topic="",R.properties={...R.properties,topicAlias:I},this.log("applyTopicAlias :: auto use topic: %s - alias: %d",U,I))));else if(I)return this.log("applyTopicAlias :: error out of range. topic: %s - alias: %d",U,I),new Error("Sending Topic Alias out of range")}}_noop(R){this.log("noop ::",R)}_writePacket(R,I){this.log("_writePacket :: packet: %O",R),this.log("_writePacket :: emitting `packetsend`"),this.emit("packetsend",R),this.log("_writePacket :: writing to stream");let U=a.default.writeToStream(R,this.stream,this.options);this.log("_writePacket :: writeToStream result %s",U),!U&&I&&I!==this.noop?(this.log("_writePacket :: handle events on `drain` once through callback."),this.stream.once("drain",I)):I&&(this.log("_writePacket :: invoking cb"),I())}_sendPacket(R,I,U,te){this.log("_sendPacket :: (%s) ::  start",this.options.clientId),U=U||this.noop,I=I||this.noop;let G=this._applyTopicAlias(R);if(G){I(G);return}if(!this.connected){if(R.cmd==="auth"){this._writePacket(R,I);return}this.log("_sendPacket :: client not connected. Storing packet offline."),this._storePacket(R,I,U);return}if(te){this._writePacket(R,I);return}switch(R.cmd){case"publish":break;case"pubrel":this._storeAndSend(R,I,U);return;default:this._writePacket(R,I);return}switch(R.qos){case 2:case 1:this._storeAndSend(R,I,U);break;case 0:default:this._writePacket(R,I);break}this.log("_sendPacket :: (%s) ::  end",this.options.clientId)}_storePacket(R,I,U){this.log("_storePacket :: packet: %o",R),this.log("_storePacket :: cb? %s",!!I),U=U||this.noop;let te=R;if(te.cmd==="publish"){te=(0,u.default)(R);let Y=this._removeTopicAliasAndRecoverTopicName(te);if(Y)return I&&I(Y)}let G=te.qos||0;G===0&&this.queueQoSZero||te.cmd!=="publish"?this.queue.push({packet:te,cb:I}):G>0?(I=this.outgoing[te.messageId]?this.outgoing[te.messageId].cb:null,this.outgoingStore.put(te,Y=>{if(Y)return I&&I(Y);U()})):I&&I(new Error("No connection to broker"))}_setupKeepaliveManager(){this.log("_setupKeepaliveManager :: keepalive %d (seconds)",this.options.keepalive),!this.keepaliveManager&&this.options.keepalive&&(this.keepaliveManager=new w.default(this,this.options.timerVariant))}_destroyKeepaliveManager(){this.keepaliveManager&&(this.log("_destroyKeepaliveManager :: destroying keepalive manager"),this.keepaliveManager.destroy(),this.keepaliveManager=null)}reschedulePing(R=!1){this.keepaliveManager&&this.options.keepalive&&(R||this.options.reschedulePings)&&this._reschedulePing()}_reschedulePing(){this.log("_reschedulePing :: rescheduling ping"),this.keepaliveManager.reschedule()}sendPing(){this.log("_sendPing :: sending pingreq"),this._sendPacket({cmd:"pingreq"})}onKeepaliveTimeout(){this.emit("error",new Error("Keepalive timeout")),this.log("onKeepaliveTimeout :: calling _cleanUp with force true"),this._cleanUp(!0)}_resubscribe(){this.log("_resubscribe");let R=Object.keys(this._resubscribeTopics);if(!this._firstConnection&&(this.options.clean||this.options.protocolVersion>=4&&!this.connackPacket.sessionPresent)&&R.length>0)if(this.options.resubscribe)if(this.options.protocolVersion===5){this.log("_resubscribe: protocolVersion 5");for(let I=0;I<R.length;I++){let U={};U[R[I]]=this._resubscribeTopics[R[I]],U.resubscribe=!0,this.subscribe(U,{properties:U[R[I]].properties})}}else this._resubscribeTopics.resubscribe=!0,this.subscribe(this._resubscribeTopics);else this._resubscribeTopics={};this._firstConnection=!1}_onConnect(R){if(this.disconnected){this.emit("connect",R);return}this.connackPacket=R,this.messageIdProvider.clear(),this._setupKeepaliveManager(),this.connected=!0;let I=()=>{let U=this.outgoingStore.createStream(),te=()=>{U.destroy(),U=null,this._flushStoreProcessingQueue(),G()},G=()=>{this._storeProcessing=!1,this._packetIdsDuringStoreProcessing={}};this.once("close",te),U.on("error",O=>{G(),this._flushStoreProcessingQueue(),this.removeListener("close",te),this.emit("error",O)});let Y=()=>{if(!U)return;let O=U.read(1),N;if(!O){U.once("readable",Y);return}if(this._storeProcessing=!0,this._packetIdsDuringStoreProcessing[O.messageId]){Y();return}!this.disconnecting&&!this.reconnectTimer?(N=this.outgoing[O.messageId]?this.outgoing[O.messageId].cb:null,this.outgoing[O.messageId]={volatile:!1,cb(Q,q){N&&N(Q,q),Y()}},this._packetIdsDuringStoreProcessing[O.messageId]=!0,this.messageIdProvider.register(O.messageId)?this._sendPacket(O,void 0,void 0,!0):this.log("messageId: %d has already used.",O.messageId)):U.destroy&&U.destroy()};U.on("end",()=>{let O=!0;for(let N in this._packetIdsDuringStoreProcessing)if(!this._packetIdsDuringStoreProcessing[N]){O=!1;break}this.removeListener("close",te),O?(G(),this._invokeAllStoreProcessingQueue(),this.emit("connect",R)):I()}),Y()};I()}_invokeStoreProcessingQueue(){if(!this._storeProcessing&&this._storeProcessingQueue.length>0){let R=this._storeProcessingQueue[0];if(R&&R.invoke())return this._storeProcessingQueue.shift(),!0}return!1}_invokeAllStoreProcessingQueue(){for(;this._invokeStoreProcessingQueue(););}_flushStoreProcessingQueue(){for(let R of this._storeProcessingQueue)R.cbStorePut&&R.cbStorePut(new Error("Connection closed")),R.callback&&R.callback(new Error("Connection closed"));this._storeProcessingQueue.splice(0)}_removeOutgoingAndStoreMessage(R,I){delete this.outgoing[R],this.outgoingStore.del({messageId:R},(U,te)=>{I(U,te),this.messageIdProvider.deallocate(R),this._invokeStoreProcessingQueue()})}};i.default=k}),N5=Rt(i=>{_t(),Et(),St(),Object.defineProperty(i,"__esModule",{value:!0});var e=PE(),t=class{numberAllocator;lastId;constructor(){this.numberAllocator=new e.NumberAllocator(1,65535)}allocate(){return this.lastId=this.numberAllocator.alloc(),this.lastId}getLastAllocated(){return this.lastId}register(n){return this.numberAllocator.use(n)}deallocate(n){this.numberAllocator.free(n)}clear(){this.numberAllocator.clear()}};i.default=t});function B5(){if(Pm)return xh;Pm=!0;let i=2147483647,e=36,t=1,n=26,s=38,a=700,l=72,u=128,c="-",f=/^xn--/,d=/[^\0-\x7F]/,p=/[\x2E\u3002\uFF0E\uFF61]/g,m={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},v=e-t,b=Math.floor,y=String.fromCharCode;function w(G){throw new RangeError(m[G])}function C(G,Y){let O=[],N=G.length;for(;N--;)O[N]=Y(G[N]);return O}function S(G,Y){let O=G.split("@"),N="";O.length>1&&(N=O[0]+"@",G=O[1]),G=G.replace(p,".");let Q=G.split("."),q=C(Q,Y).join(".");return N+q}function x(G){let Y=[],O=0,N=G.length;for(;O<N;){let Q=G.charCodeAt(O++);if(Q>=55296&&Q<=56319&&O<N){let q=G.charCodeAt(O++);(q&64512)==56320?Y.push(((Q&1023)<<10)+(q&1023)+65536):(Y.push(Q),O--)}else Y.push(Q)}return Y}let k=G=>String.fromCodePoint(...G),A=function(G){return G>=48&&G<58?26+(G-48):G>=65&&G<91?G-65:G>=97&&G<123?G-97:e},R=function(G,Y){return G+22+75*(G<26)-((Y!=0)<<5)},I=function(G,Y,O){let N=0;for(G=O?b(G/a):G>>1,G+=b(G/Y);G>v*n>>1;N+=e)G=b(G/v);return b(N+(v+1)*G/(G+s))},U=function(G){let Y=[],O=G.length,N=0,Q=u,q=l,ee=G.lastIndexOf(c);ee<0&&(ee=0);for(let ne=0;ne<ee;++ne)G.charCodeAt(ne)>=128&&w("not-basic"),Y.push(G.charCodeAt(ne));for(let ne=ee>0?ee+1:0;ne<O;){let B=N;for(let $=1,V=e;;V+=e){ne>=O&&w("invalid-input");let Z=A(G.charCodeAt(ne++));Z>=e&&w("invalid-input"),Z>b((i-N)/$)&&w("overflow"),N+=Z*$;let ae=V<=q?t:V>=q+n?n:V-q;if(Z<ae)break;let Ae=e-ae;$>b(i/Ae)&&w("overflow"),$*=Ae}let z=Y.length+1;q=I(N-B,z,B==0),b(N/z)>i-Q&&w("overflow"),Q+=b(N/z),N%=z,Y.splice(N++,0,Q)}return String.fromCodePoint(...Y)},te=function(G){let Y=[];G=x(G);let O=G.length,N=u,Q=0,q=l;for(let B of G)B<128&&Y.push(y(B));let ee=Y.length,ne=ee;for(ee&&Y.push(c);ne<O;){let B=i;for(let $ of G)$>=N&&$<B&&(B=$);let z=ne+1;B-N>b((i-Q)/z)&&w("overflow"),Q+=(B-N)*z,N=B;for(let $ of G)if($<N&&++Q>i&&w("overflow"),$===N){let V=Q;for(let Z=e;;Z+=e){let ae=Z<=q?t:Z>=q+n?n:Z-q;if(V<ae)break;let Ae=V-ae,be=e-ae;Y.push(y(R(ae+Ae%be,0))),V=b(Ae/be)}Y.push(y(R(V,0))),q=I(Q,z,ne===ee),Q=0,++ne}++Q,++N}return Y.join("")};return xh={version:"2.3.1",ucs2:{decode:x,encode:k},decode:U,encode:te,toASCII:function(G){return S(G,function(Y){return d.test(Y)?"xn--"+te(Y):Y})},toUnicode:function(G){return S(G,function(Y){return f.test(Y)?U(Y.slice(4).toLowerCase()):Y})}},xh}var xh,Pm,Oa,j5=qi(()=>{_t(),Et(),St(),xh={},Pm=!1,Oa=B5(),Oa.decode,Oa.encode,Oa.toASCII,Oa.toUnicode,Oa.ucs2,Oa.version});function D5(){return Um||(Um=!0,Lm=function(){if(typeof Symbol!="function"||typeof Object.getOwnPropertySymbols!="function")return!1;if(typeof Symbol.iterator=="symbol")return!0;var i={},e=Symbol("test"),t=Object(e);if(typeof e=="string"||Object.prototype.toString.call(e)!=="[object Symbol]"||Object.prototype.toString.call(t)!=="[object Symbol]")return!1;var n=42;i[e]=n;for(e in i)return!1;if(typeof Object.keys=="function"&&Object.keys(i).length!==0||typeof Object.getOwnPropertyNames=="function"&&Object.getOwnPropertyNames(i).length!==0)return!1;var s=Object.getOwnPropertySymbols(i);if(s.length!==1||s[0]!==e||!Object.prototype.propertyIsEnumerable.call(i,e))return!1;if(typeof Object.getOwnPropertyDescriptor=="function"){var a=Object.getOwnPropertyDescriptor(i,e);if(a.value!==n||a.enumerable!==!0)return!1}return!0}),Lm}function P5(){return Fm||(Fm=!0,qm=Error),qm}function L5(){return zm||(zm=!0,Hm=EvalError),Hm}function U5(){return Km||(Km=!0,Gm=RangeError),Gm}function q5(){return $m||($m=!0,Vm=ReferenceError),Vm}function VE(){return Wm||(Wm=!0,Ym=SyntaxError),Ym}function Zu(){return Jm||(Jm=!0,Qm=TypeError),Qm}function F5(){return Xm||(Xm=!0,Zm=URIError),Zm}function H5(){if(ey)return _h;ey=!0;var i=typeof Symbol<"u"&&Symbol,e=D5();return _h=function(){return typeof i!="function"||typeof Symbol!="function"||typeof i("foo")!="symbol"||typeof Symbol("bar")!="symbol"?!1:e()},_h}function z5(){if(ty)return Sh;ty=!0;var i={__proto__:null,foo:{}},e=Object;return Sh=function(){return{__proto__:i}.foo===i.foo&&!(i instanceof e)},Sh}function G5(){if(ny)return Eh;ny=!0;var i="Function.prototype.bind called on incompatible ",e=Object.prototype.toString,t=Math.max,n="[object Function]",s=function(u,c){for(var f=[],d=0;d<u.length;d+=1)f[d]=u[d];for(var p=0;p<c.length;p+=1)f[p+u.length]=c[p];return f},a=function(u,c){for(var f=[],d=c,p=0;d<u.length;d+=1,p+=1)f[p]=u[d];return f},l=function(u,c){for(var f="",d=0;d<u.length;d+=1)f+=u[d],d+1<u.length&&(f+=c);return f};return Eh=function(u){var c=this;if(typeof c!="function"||e.apply(c)!==n)throw new TypeError(i+c);for(var f=a(arguments,1),d,p=function(){if(this instanceof d){var w=c.apply(this,s(f,arguments));return Object(w)===w?w:this}return c.apply(u,s(f,arguments))},m=t(0,c.length-f.length),v=[],b=0;b<m;b++)v[b]="$"+b;if(d=Function("binder","return function ("+l(v,",")+"){ return binder.apply(this,arguments); }")(p),c.prototype){var y=function(){};y.prototype=c.prototype,d.prototype=new y,y.prototype=null}return d},Eh}function ub(){if(ry)return Ch;ry=!0;var i=G5();return Ch=Function.prototype.bind||i,Ch}function K5(){if(iy)return Ah;iy=!0;var i=Function.prototype.call,e=Object.prototype.hasOwnProperty,t=ub();return Ah=t.call(i,e),Ah}function Lc(){if(sy)return kh;sy=!0;var i,e=P5(),t=L5(),n=U5(),s=q5(),a=VE(),l=Zu(),u=F5(),c=Function,f=function(ne){try{return c('"use strict"; return ('+ne+").constructor;")()}catch{}},d=Object.getOwnPropertyDescriptor;if(d)try{d({},"")}catch{d=null}var p=function(){throw new l},m=d?(function(){try{return arguments.callee,p}catch{try{return d(arguments,"callee").get}catch{return p}}})():p,v=H5()(),b=z5()(),y=Object.getPrototypeOf||(b?function(ne){return ne.__proto__}:null),w={},C=typeof Uint8Array>"u"||!y?i:y(Uint8Array),S={__proto__:null,"%AggregateError%":typeof AggregateError>"u"?i:AggregateError,"%Array%":Array,"%ArrayBuffer%":typeof ArrayBuffer>"u"?i:ArrayBuffer,"%ArrayIteratorPrototype%":v&&y?y([][Symbol.iterator]()):i,"%AsyncFromSyncIteratorPrototype%":i,"%AsyncFunction%":w,"%AsyncGenerator%":w,"%AsyncGeneratorFunction%":w,"%AsyncIteratorPrototype%":w,"%Atomics%":typeof Atomics>"u"?i:Atomics,"%BigInt%":typeof BigInt>"u"?i:BigInt,"%BigInt64Array%":typeof BigInt64Array>"u"?i:BigInt64Array,"%BigUint64Array%":typeof BigUint64Array>"u"?i:BigUint64Array,"%Boolean%":Boolean,"%DataView%":typeof DataView>"u"?i:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":e,"%eval%":eval,"%EvalError%":t,"%Float32Array%":typeof Float32Array>"u"?i:Float32Array,"%Float64Array%":typeof Float64Array>"u"?i:Float64Array,"%FinalizationRegistry%":typeof FinalizationRegistry>"u"?i:FinalizationRegistry,"%Function%":c,"%GeneratorFunction%":w,"%Int8Array%":typeof Int8Array>"u"?i:Int8Array,"%Int16Array%":typeof Int16Array>"u"?i:Int16Array,"%Int32Array%":typeof Int32Array>"u"?i:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":v&&y?y(y([][Symbol.iterator]())):i,"%JSON%":typeof JSON=="object"?JSON:i,"%Map%":typeof Map>"u"?i:Map,"%MapIteratorPrototype%":typeof Map>"u"||!v||!y?i:y(new Map()[Symbol.iterator]()),"%Math%":Math,"%Number%":Number,"%Object%":Object,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":typeof Promise>"u"?i:Promise,"%Proxy%":typeof Proxy>"u"?i:Proxy,"%RangeError%":n,"%ReferenceError%":s,"%Reflect%":typeof Reflect>"u"?i:Reflect,"%RegExp%":RegExp,"%Set%":typeof Set>"u"?i:Set,"%SetIteratorPrototype%":typeof Set>"u"||!v||!y?i:y(new Set()[Symbol.iterator]()),"%SharedArrayBuffer%":typeof SharedArrayBuffer>"u"?i:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":v&&y?y(""[Symbol.iterator]()):i,"%Symbol%":v?Symbol:i,"%SyntaxError%":a,"%ThrowTypeError%":m,"%TypedArray%":C,"%TypeError%":l,"%Uint8Array%":typeof Uint8Array>"u"?i:Uint8Array,"%Uint8ClampedArray%":typeof Uint8ClampedArray>"u"?i:Uint8ClampedArray,"%Uint16Array%":typeof Uint16Array>"u"?i:Uint16Array,"%Uint32Array%":typeof Uint32Array>"u"?i:Uint32Array,"%URIError%":u,"%WeakMap%":typeof WeakMap>"u"?i:WeakMap,"%WeakRef%":typeof WeakRef>"u"?i:WeakRef,"%WeakSet%":typeof WeakSet>"u"?i:WeakSet};if(y)try{null.error}catch(ne){var x=y(y(ne));S["%Error.prototype%"]=x}var k=function ne(B){var z;if(B==="%AsyncFunction%")z=f("async function () {}");else if(B==="%GeneratorFunction%")z=f("function* () {}");else if(B==="%AsyncGeneratorFunction%")z=f("async function* () {}");else if(B==="%AsyncGenerator%"){var $=ne("%AsyncGeneratorFunction%");$&&(z=$.prototype)}else if(B==="%AsyncIteratorPrototype%"){var V=ne("%AsyncGenerator%");V&&y&&(z=y(V.prototype))}return S[B]=z,z},A={__proto__:null,"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},R=ub(),I=K5(),U=R.call(Function.call,Array.prototype.concat),te=R.call(Function.apply,Array.prototype.splice),G=R.call(Function.call,String.prototype.replace),Y=R.call(Function.call,String.prototype.slice),O=R.call(Function.call,RegExp.prototype.exec),N=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,Q=/\\(\\)?/g,q=function(ne){var B=Y(ne,0,1),z=Y(ne,-1);if(B==="%"&&z!=="%")throw new a("invalid intrinsic syntax, expected closing `%`");if(z==="%"&&B!=="%")throw new a("invalid intrinsic syntax, expected opening `%`");var $=[];return G(ne,N,function(V,Z,ae,Ae){$[$.length]=ae?G(Ae,Q,"$1"):Z||V}),$},ee=function(ne,B){var z=ne,$;if(I(A,z)&&($=A[z],z="%"+$[0]+"%"),I(S,z)){var V=S[z];if(V===w&&(V=k(z)),typeof V>"u"&&!B)throw new l("intrinsic "+ne+" exists, but is not available. Please file an issue!");return{alias:$,name:z,value:V}}throw new a("intrinsic "+ne+" does not exist!")};return kh=function(ne,B){if(typeof ne!="string"||ne.length===0)throw new l("intrinsic name must be a non-empty string");if(arguments.length>1&&typeof B!="boolean")throw new l('"allowMissing" argument must be a boolean');if(O(/^%?[^%]*%?$/,ne)===null)throw new a("`%` may not be present anywhere but at the beginning and end of the intrinsic name");var z=q(ne),$=z.length>0?z[0]:"",V=ee("%"+$+"%",B),Z=V.name,ae=V.value,Ae=!1,be=V.alias;be&&($=be[0],te(z,U([0,1],be)));for(var Ge=1,Te=!0;Ge<z.length;Ge+=1){var ve=z[Ge],ke=Y(ve,0,1),Me=Y(ve,-1);if((ke==='"'||ke==="'"||ke==="`"||Me==='"'||Me==="'"||Me==="`")&&ke!==Me)throw new a("property names with quotes must have matching quotes");if((ve==="constructor"||!Te)&&(Ae=!0),$+="."+ve,Z="%"+$+"%",I(S,Z))ae=S[Z];else if(ae!=null){if(!(ve in ae)){if(!B)throw new l("base intrinsic for "+ne+" exists, but the property is not available.");return}if(d&&Ge+1>=z.length){var Ie=d(ae,ve);Te=!!Ie,Te&&"get"in Ie&&!("originalValue"in Ie.get)?ae=Ie.get:ae=ae[ve]}else Te=I(ae,ve),ae=ae[ve];Te&&!Ae&&(S[Z]=ae)}}return ae},kh}function fb(){if(oy)return Th;oy=!0;var i=Lc(),e=i("%Object.defineProperty%",!0)||!1;if(e)try{e({},"a",{value:1})}catch{e=!1}return Th=e,Th}function $E(){if(ay)return Mh;ay=!0;var i=Lc(),e=i("%Object.getOwnPropertyDescriptor%",!0);if(e)try{e([],"length")}catch{e=null}return Mh=e,Mh}function V5(){if(ly)return Ih;ly=!0;var i=fb(),e=VE(),t=Zu(),n=$E();return Ih=function(s,a,l){if(!s||typeof s!="object"&&typeof s!="function")throw new t("`obj` must be an object or a function`");if(typeof a!="string"&&typeof a!="symbol")throw new t("`property` must be a string or a symbol`");if(arguments.length>3&&typeof arguments[3]!="boolean"&&arguments[3]!==null)throw new t("`nonEnumerable`, if provided, must be a boolean or null");if(arguments.length>4&&typeof arguments[4]!="boolean"&&arguments[4]!==null)throw new t("`nonWritable`, if provided, must be a boolean or null");if(arguments.length>5&&typeof arguments[5]!="boolean"&&arguments[5]!==null)throw new t("`nonConfigurable`, if provided, must be a boolean or null");if(arguments.length>6&&typeof arguments[6]!="boolean")throw new t("`loose`, if provided, must be a boolean");var u=arguments.length>3?arguments[3]:null,c=arguments.length>4?arguments[4]:null,f=arguments.length>5?arguments[5]:null,d=arguments.length>6?arguments[6]:!1,p=!!n&&n(s,a);if(i)i(s,a,{configurable:f===null&&p?p.configurable:!f,enumerable:u===null&&p?p.enumerable:!u,value:l,writable:c===null&&p?p.writable:!c});else if(d||!u&&!c&&!f)s[a]=l;else throw new e("This environment does not support defining a property as non-configurable, non-writable, or non-enumerable.")},Ih}function $5(){if(cy)return Rh;cy=!0;var i=fb(),e=function(){return!!i};return e.hasArrayLengthDefineBug=function(){if(!i)return null;try{return i([],"length",{value:1}).length!==1}catch{return!0}},Rh=e,Rh}function Y5(){if(uy)return Oh;uy=!0;var i=Lc(),e=V5(),t=$5()(),n=$E(),s=Zu(),a=i("%Math.floor%");return Oh=function(l,u){if(typeof l!="function")throw new s("`fn` is not a function");if(typeof u!="number"||u<0||u>4294967295||a(u)!==u)throw new s("`length` must be a positive 32-bit integer");var c=arguments.length>2&&!!arguments[2],f=!0,d=!0;if("length"in l&&n){var p=n(l,"length");p&&!p.configurable&&(f=!1),p&&!p.writable&&(d=!1)}return(f||d||!c)&&(t?e(l,"length",u,!0,!0):e(l,"length",u)),l},Oh}function W5(){if(fy)return Sc;fy=!0;var i=ub(),e=Lc(),t=Y5(),n=Zu(),s=e("%Function.prototype.apply%"),a=e("%Function.prototype.call%"),l=e("%Reflect.apply%",!0)||i.call(a,s),u=fb(),c=e("%Math.max%");Sc=function(d){if(typeof d!="function")throw new n("a function is required");var p=l(i,a,arguments);return t(p,1+c(0,d.length-(arguments.length-1)),!0)};var f=function(){return l(i,s,arguments)};return u?u(Sc,"apply",{value:f}):Sc.apply=f,Sc}function Q5(){if(hy)return Nh;hy=!0;var i=Lc(),e=W5(),t=e(i("String.prototype.indexOf"));return Nh=function(n,s){var a=i(n,!!s);return typeof a=="function"&&t(n,".prototype.")>-1?e(a):a},Nh}var Lm,Um,qm,Fm,Hm,zm,Gm,Km,Vm,$m,Ym,Wm,Qm,Jm,Zm,Xm,_h,ey,Sh,ty,Eh,ny,Ch,ry,Ah,iy,kh,sy,Th,oy,Mh,ay,Ih,ly,Rh,cy,Oh,uy,Sc,fy,Nh,hy,J5=qi(()=>{_t(),Et(),St(),Lm={},Um=!1,qm={},Fm=!1,Hm={},zm=!1,Gm={},Km=!1,Vm={},$m=!1,Ym={},Wm=!1,Qm={},Jm=!1,Zm={},Xm=!1,_h={},ey=!1,Sh={},ty=!1,Eh={},ny=!1,Ch={},ry=!1,Ah={},iy=!1,kh={},sy=!1,Th={},oy=!1,Mh={},ay=!1,Ih={},ly=!1,Rh={},cy=!1,Oh={},uy=!1,Sc={},fy=!1,Nh={},hy=!1});function hb(i){throw new Error("Node.js process "+i+" is not supported by JSPM core outside of Node.js")}function Z5(){!Al||!xl||(Al=!1,xl.length?zs=xl.concat(zs):zu=-1,zs.length&&YE())}function YE(){if(!Al){var i=setTimeout(Z5,0);Al=!0;for(var e=zs.length;e;){for(xl=zs,zs=[];++zu<e;)xl&&xl[zu].run();zu=-1,e=zs.length}xl=null,Al=!1,clearTimeout(i)}}function X5(i){var e=new Array(arguments.length-1);if(arguments.length>1)for(var t=1;t<arguments.length;t++)e[t-1]=arguments[t];zs.push(new WE(i,e)),zs.length===1&&!Al&&setTimeout(YE,0)}function WE(i,e){this.fun=i,this.array=e}function pi(){}function e8(i){hb("_linkedBinding")}function t8(i){hb("dlopen")}function n8(){return[]}function r8(){return[]}function i8(i,e){if(!i)throw new Error(e||"assertion error")}function s8(){return!1}function o8(){return Co.now()/1e3}function zg(i){var e=Math.floor((Date.now()-Co.now())*.001),t=Co.now()*.001,n=Math.floor(t)+e,s=Math.floor(t%1*1e9);return i&&(n=n-i[0],s=s-i[1],s<0&&(n--,s+=Bh)),[n,s]}function Ca(){return db}function a8(i){return[]}var zs,Al,xl,zu,Jx,Zx,Xx,e_,t_,n_,r_,i_,s_,o_,a_,l_,c_,u_,f_,h_,d_,p_,g_,m_,y_,nh,b_,v_,w_,x_,__,S_,E_,C_,A_,k_,T_,M_,I_,R_,O_,N_,B_,j_,D_,P_,L_,U_,q_,F_,H_,Co,Gg,Bh,z_,G_,K_,V_,$_,Y_,W_,Q_,J_,Z_,X_,db,QE=qi(()=>{_t(),Et(),St(),zs=[],Al=!1,zu=-1,WE.prototype.run=function(){this.fun.apply(null,this.array)},Jx="browser",Zx="x64",Xx="browser",e_={PATH:"/usr/bin",LANG:navigator.language+".UTF-8",PWD:"/",HOME:"/home",TMP:"/tmp"},t_=["/usr/bin/node"],n_=[],r_="v16.8.0",i_={},s_=function(i,e){console.warn((e?e+": ":"")+i)},o_=function(i){hb("binding")},a_=function(i){return 0},l_=function(){return"/"},c_=function(i){},u_={name:"node",sourceUrl:"",headersUrl:"",libUrl:""},f_=pi,h_=[],d_={},p_=!1,g_={},m_=pi,y_=pi,nh=function(){return{}},b_=nh,v_=nh,w_=pi,x_=pi,__=pi,S_={},E_={inspector:!1,debug:!1,uv:!1,ipv6:!1,tls_alpn:!1,tls_sni:!1,tls_ocsp:!1,tls:!1,cached_builtins:!0},C_=pi,A_=pi,k_=pi,T_=pi,M_=pi,I_=pi,R_=pi,O_=void 0,N_=void 0,B_=void 0,j_=pi,D_=2,P_=1,L_="/bin/usr/node",U_=9229,q_="node",F_=[],H_=pi,Co={now:typeof performance<"u"?performance.now.bind(performance):void 0,timing:typeof performance<"u"?performance.timing:void 0},Co.now===void 0&&(Gg=Date.now(),Co.timing&&Co.timing.navigationStart&&(Gg=Co.timing.navigationStart),Co.now=()=>Date.now()-Gg),Bh=1e9,zg.bigint=function(i){var e=zg(i);return typeof BigInt>"u"?e[0]*Bh+e[1]:BigInt(e[0]*Bh)+BigInt(e[1])},z_=10,G_={},K_=0,V_=Ca,$_=Ca,Y_=Ca,W_=Ca,Q_=Ca,J_=pi,Z_=Ca,X_=Ca,db={version:r_,versions:i_,arch:Zx,platform:Xx,release:u_,_rawDebug:f_,moduleLoadList:h_,binding:o_,_linkedBinding:e8,_events:G_,_eventsCount:K_,_maxListeners:z_,on:Ca,addListener:V_,once:$_,off:Y_,removeListener:W_,removeAllListeners:Q_,emit:J_,prependListener:Z_,prependOnceListener:X_,listeners:a8,domain:d_,_exiting:p_,config:g_,dlopen:t8,uptime:o8,_getActiveRequests:n8,_getActiveHandles:r8,reallyExit:m_,_kill:y_,cpuUsage:nh,resourceUsage:b_,memoryUsage:v_,kill:w_,exit:x_,openStdin:__,allowedNodeEnvironmentFlags:S_,assert:i8,features:E_,_fatalExceptions:C_,setUncaughtExceptionCaptureCallback:A_,hasUncaughtExceptionCaptureCallback:s8,emitWarning:s_,nextTick:X5,_tickCallback:k_,_debugProcess:T_,_debugEnd:M_,_startProfilerIdleNotifier:I_,_stopProfilerIdleNotifier:R_,stdout:O_,stdin:B_,stderr:N_,abort:j_,umask:a_,chdir:c_,cwd:l_,env:e_,title:Jx,argv:t_,execArgv:n_,pid:D_,ppid:P_,execPath:L_,debugPort:U_,hrtime:zg,argv0:q_,_preload_modules:F_,setSourceMapsEnabled:H_}});function l8(){if(dy)return jh;dy=!0;var i=db;function e(a){if(typeof a!="string")throw new TypeError("Path must be a string. Received "+JSON.stringify(a))}function t(a,l){for(var u="",c=0,f=-1,d=0,p,m=0;m<=a.length;++m){if(m<a.length)p=a.charCodeAt(m);else{if(p===47)break;p=47}if(p===47){if(!(f===m-1||d===1))if(f!==m-1&&d===2){if(u.length<2||c!==2||u.charCodeAt(u.length-1)!==46||u.charCodeAt(u.length-2)!==46){if(u.length>2){var v=u.lastIndexOf("/");if(v!==u.length-1){v===-1?(u="",c=0):(u=u.slice(0,v),c=u.length-1-u.lastIndexOf("/")),f=m,d=0;continue}}else if(u.length===2||u.length===1){u="",c=0,f=m,d=0;continue}}l&&(u.length>0?u+="/..":u="..",c=2)}else u.length>0?u+="/"+a.slice(f+1,m):u=a.slice(f+1,m),c=m-f-1;f=m,d=0}else p===46&&d!==-1?++d:d=-1}return u}function n(a,l){var u=l.dir||l.root,c=l.base||(l.name||"")+(l.ext||"");return u?u===l.root?u+c:u+a+c:c}var s={resolve:function(){for(var a="",l=!1,u,c=arguments.length-1;c>=-1&&!l;c--){var f;c>=0?f=arguments[c]:(u===void 0&&(u=i.cwd()),f=u),e(f),f.length!==0&&(a=f+"/"+a,l=f.charCodeAt(0)===47)}return a=t(a,!l),l?a.length>0?"/"+a:"/":a.length>0?a:"."},normalize:function(a){if(e(a),a.length===0)return".";var l=a.charCodeAt(0)===47,u=a.charCodeAt(a.length-1)===47;return a=t(a,!l),a.length===0&&!l&&(a="."),a.length>0&&u&&(a+="/"),l?"/"+a:a},isAbsolute:function(a){return e(a),a.length>0&&a.charCodeAt(0)===47},join:function(){if(arguments.length===0)return".";for(var a,l=0;l<arguments.length;++l){var u=arguments[l];e(u),u.length>0&&(a===void 0?a=u:a+="/"+u)}return a===void 0?".":s.normalize(a)},relative:function(a,l){if(e(a),e(l),a===l||(a=s.resolve(a),l=s.resolve(l),a===l))return"";for(var u=1;u<a.length&&a.charCodeAt(u)===47;++u);for(var c=a.length,f=c-u,d=1;d<l.length&&l.charCodeAt(d)===47;++d);for(var p=l.length,m=p-d,v=f<m?f:m,b=-1,y=0;y<=v;++y){if(y===v){if(m>v){if(l.charCodeAt(d+y)===47)return l.slice(d+y+1);if(y===0)return l.slice(d+y)}else f>v&&(a.charCodeAt(u+y)===47?b=y:y===0&&(b=0));break}var w=a.charCodeAt(u+y),C=l.charCodeAt(d+y);if(w!==C)break;w===47&&(b=y)}var S="";for(y=u+b+1;y<=c;++y)(y===c||a.charCodeAt(y)===47)&&(S.length===0?S+="..":S+="/..");return S.length>0?S+l.slice(d+b):(d+=b,l.charCodeAt(d)===47&&++d,l.slice(d))},_makeLong:function(a){return a},dirname:function(a){if(e(a),a.length===0)return".";for(var l=a.charCodeAt(0),u=l===47,c=-1,f=!0,d=a.length-1;d>=1;--d)if(l=a.charCodeAt(d),l===47){if(!f){c=d;break}}else f=!1;return c===-1?u?"/":".":u&&c===1?"//":a.slice(0,c)},basename:function(a,l){if(l!==void 0&&typeof l!="string")throw new TypeError('"ext" argument must be a string');e(a);var u=0,c=-1,f=!0,d;if(l!==void 0&&l.length>0&&l.length<=a.length){if(l.length===a.length&&l===a)return"";var p=l.length-1,m=-1;for(d=a.length-1;d>=0;--d){var v=a.charCodeAt(d);if(v===47){if(!f){u=d+1;break}}else m===-1&&(f=!1,m=d+1),p>=0&&(v===l.charCodeAt(p)?--p===-1&&(c=d):(p=-1,c=m))}return u===c?c=m:c===-1&&(c=a.length),a.slice(u,c)}else{for(d=a.length-1;d>=0;--d)if(a.charCodeAt(d)===47){if(!f){u=d+1;break}}else c===-1&&(f=!1,c=d+1);return c===-1?"":a.slice(u,c)}},extname:function(a){e(a);for(var l=-1,u=0,c=-1,f=!0,d=0,p=a.length-1;p>=0;--p){var m=a.charCodeAt(p);if(m===47){if(!f){u=p+1;break}continue}c===-1&&(f=!1,c=p+1),m===46?l===-1?l=p:d!==1&&(d=1):l!==-1&&(d=-1)}return l===-1||c===-1||d===0||d===1&&l===c-1&&l===u+1?"":a.slice(l,c)},format:function(a){if(a===null||typeof a!="object")throw new TypeError('The "pathObject" argument must be of type Object. Received type '+typeof a);return n("/",a)},parse:function(a){e(a);var l={root:"",dir:"",base:"",ext:"",name:""};if(a.length===0)return l;var u=a.charCodeAt(0),c=u===47,f;c?(l.root="/",f=1):f=0;for(var d=-1,p=0,m=-1,v=!0,b=a.length-1,y=0;b>=f;--b){if(u=a.charCodeAt(b),u===47){if(!v){p=b+1;break}continue}m===-1&&(v=!1,m=b+1),u===46?d===-1?d=b:y!==1&&(y=1):d!==-1&&(y=-1)}return d===-1||m===-1||y===0||y===1&&d===m-1&&d===p+1?m!==-1&&(p===0&&c?l.base=l.name=a.slice(1,m):l.base=l.name=a.slice(p,m)):(p===0&&c?(l.name=a.slice(1,d),l.base=a.slice(1,m)):(l.name=a.slice(p,d),l.base=a.slice(p,m)),l.ext=a.slice(d,m)),p>0?l.dir=a.slice(0,p-1):c&&(l.dir="/"),l},sep:"/",delimiter:":",win32:null,posix:null};return s.posix=s,jh=s,jh}var jh,dy,py,c8=qi(()=>{_t(),Et(),St(),QE(),jh={},dy=!1,py=l8()}),JE={};jc(JE,{URL:()=>aC,Url:()=>nC,default:()=>gi,fileURLToPath:()=>XE,format:()=>rC,parse:()=>oC,pathToFileURL:()=>eC,resolve:()=>iC,resolveObject:()=>sC});function u8(){if(gy)return Dh;gy=!0;var i=typeof Map=="function"&&Map.prototype,e=Object.getOwnPropertyDescriptor&&i?Object.getOwnPropertyDescriptor(Map.prototype,"size"):null,t=i&&e&&typeof e.get=="function"?e.get:null,n=i&&Map.prototype.forEach,s=typeof Set=="function"&&Set.prototype,a=Object.getOwnPropertyDescriptor&&s?Object.getOwnPropertyDescriptor(Set.prototype,"size"):null,l=s&&a&&typeof a.get=="function"?a.get:null,u=s&&Set.prototype.forEach,c=typeof WeakMap=="function"&&WeakMap.prototype,f=c?WeakMap.prototype.has:null,d=typeof WeakSet=="function"&&WeakSet.prototype,p=d?WeakSet.prototype.has:null,m=typeof WeakRef=="function"&&WeakRef.prototype,v=m?WeakRef.prototype.deref:null,b=Boolean.prototype.valueOf,y=Object.prototype.toString,w=Function.prototype.toString,C=String.prototype.match,S=String.prototype.slice,x=String.prototype.replace,k=String.prototype.toUpperCase,A=String.prototype.toLowerCase,R=RegExp.prototype.test,I=Array.prototype.concat,U=Array.prototype.join,te=Array.prototype.slice,G=Math.floor,Y=typeof BigInt=="function"?BigInt.prototype.valueOf:null,O=Object.getOwnPropertySymbols,N=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Symbol.prototype.toString:null,Q=typeof Symbol=="function"&&typeof Symbol.iterator=="object",q=typeof Symbol=="function"&&Symbol.toStringTag&&(typeof Symbol.toStringTag===Q||!0)?Symbol.toStringTag:null,ee=Object.prototype.propertyIsEnumerable,ne=(typeof Reflect=="function"?Reflect.getPrototypeOf:Object.getPrototypeOf)||([].__proto__===Array.prototype?function(Le){return Le.__proto__}:null);function B(Le,Xe){if(Le===1/0||Le===-1/0||Le!==Le||Le&&Le>-1e3&&Le<1e3||R.call(/e/,Xe))return Xe;var zt=/[0-9](?=(?:[0-9]{3})+(?![0-9]))/g;if(typeof Le=="number"){var mt=Le<0?-G(-Le):G(Le);if(mt!==Le){var an=String(mt),hn=S.call(Xe,an.length+1);return x.call(an,zt,"$&_")+"."+x.call(x.call(hn,/([0-9]{3})/g,"$&_"),/_$/,"")}}return x.call(Xe,zt,"$&_")}var z=tC,$=z.custom,V=Ie($)?$:null;Dh=function Le(Xe,zt,mt,an){var hn=zt||{};if(et(hn,"quoteStyle")&&hn.quoteStyle!=="single"&&hn.quoteStyle!=="double")throw new TypeError('option "quoteStyle" must be "single" or "double"');if(et(hn,"maxStringLength")&&(typeof hn.maxStringLength=="number"?hn.maxStringLength<0&&hn.maxStringLength!==1/0:hn.maxStringLength!==null))throw new TypeError('option "maxStringLength", if provided, must be a positive integer, Infinity, or `null`');var pr=et(hn,"customInspect")?hn.customInspect:!0;if(typeof pr!="boolean"&&pr!=="symbol")throw new TypeError("option \"customInspect\", if provided, must be `true`, `false`, or `'symbol'`");if(et(hn,"indent")&&hn.indent!==null&&hn.indent!=="	"&&!(parseInt(hn.indent,10)===hn.indent&&hn.indent>0))throw new TypeError('option "indent" must be "\\t", an integer > 0, or `null`');if(et(hn,"numericSeparator")&&typeof hn.numericSeparator!="boolean")throw new TypeError('option "numericSeparator", if provided, must be `true` or `false`');var Ft=hn.numericSeparator;if(typeof Xe>"u")return"undefined";if(Xe===null)return"null";if(typeof Xe=="boolean")return Xe?"true":"false";if(typeof Xe=="string")return nt(Xe,hn);if(typeof Xe=="number"){if(Xe===0)return 1/0/Xe>0?"0":"-0";var Bn=String(Xe);return Ft?B(Xe,Bn):Bn}if(typeof Xe=="bigint"){var xr=String(Xe)+"n";return Ft?B(Xe,xr):xr}var _r=typeof hn.depth>"u"?5:hn.depth;if(typeof mt>"u"&&(mt=0),mt>=_r&&_r>0&&typeof Xe=="object")return Ae(Xe)?"[Array]":"[Object]";var Zn=Ke(hn,mt);if(typeof an>"u")an=[];else if(Be(an,Xe)>=0)return"[Circular]";function Ht(Yt,Kt,vn){if(Kt&&(an=te.call(an),an.push(Kt)),vn){var $t={depth:hn.depth};return et(hn,"quoteStyle")&&($t.quoteStyle=hn.quoteStyle),Le(Yt,$t,mt+1,an)}return Le(Yt,hn,mt+1,an)}if(typeof Xe=="function"&&!Ge(Xe)){var pe=de(Xe),Ot=Ut(Xe,Ht);return"[Function"+(pe?": "+pe:" (anonymous)")+"]"+(Ot.length>0?" { "+U.call(Ot,", ")+" }":"")}if(Ie(Xe)){var qt=Q?x.call(String(Xe),/^(Symbol\(.*\))_[^)]*$/,"$1"):N.call(Xe);return typeof Xe=="object"&&!Q?j(qt):qt}if(Mt(Xe)){for(var fe="<"+A.call(String(Xe.nodeName)),we=Xe.attributes||[],pt=0;pt<we.length;pt++)fe+=" "+we[pt].name+"="+Z(ae(we[pt].value),"double",hn);return fe+=">",Xe.childNodes&&Xe.childNodes.length&&(fe+="..."),fe+="</"+A.call(String(Xe.nodeName))+">",fe}if(Ae(Xe)){if(Xe.length===0)return"[]";var At=Ut(Xe,Ht);return Zn&&!Oe(At)?"["+gt(At,Zn)+"]":"[ "+U.call(At,", ")+" ]"}if(Te(Xe)){var K=Ut(Xe,Ht);return!("cause"in Error.prototype)&&"cause"in Xe&&!ee.call(Xe,"cause")?"{ ["+String(Xe)+"] "+U.call(I.call("[cause]: "+Ht(Xe.cause),K),", ")+" }":K.length===0?"["+String(Xe)+"]":"{ ["+String(Xe)+"] "+U.call(K,", ")+" }"}if(typeof Xe=="object"&&pr){if(V&&typeof Xe[V]=="function"&&z)return z(Xe,{depth:_r-mt});if(pr!=="symbol"&&typeof Xe.inspect=="function")return Xe.inspect()}if(Je(Xe)){var oe=[];return n&&n.call(Xe,function(Yt,Kt){oe.push(Ht(Kt,Xe,!0)+" => "+Ht(Yt,Xe))}),se("Map",t.call(Xe),oe,Zn)}if(ye(Xe)){var ce=[];return u&&u.call(Xe,function(Yt){ce.push(Ht(Yt,Xe))}),se("Set",l.call(Xe),ce,Zn)}if(rt(Xe))return W("WeakMap");if(it(Xe))return W("WeakSet");if(at(Xe))return W("WeakRef");if(ke(Xe))return j(Ht(Number(Xe)));if(Ce(Xe))return j(Ht(Y.call(Xe)));if(Me(Xe))return j(b.call(Xe));if(ve(Xe))return j(Ht(String(Xe)));if(typeof window<"u"&&Xe===window)return"{ [object Window] }";if(typeof globalThis<"u"&&Xe===globalThis||typeof Ph<"u"&&Xe===Ph)return"{ [object globalThis] }";if(!be(Xe)&&!Ge(Xe)){var D=Ut(Xe,Ht),ge=ne?ne(Xe)===Object.prototype:Xe instanceof Object||Xe.constructor===Object,$e=Xe instanceof Object?"":"null prototype",ze=!ge&&q&&Object(Xe)===Xe&&q in Xe?S.call(me(Xe),8,-1):$e?"Object":"",vt=ge||typeof Xe.constructor!="function"?"":Xe.constructor.name?Xe.constructor.name+" ":"",Nt=vt+(ze||$e?"["+U.call(I.call([],ze||[],$e||[]),": ")+"] ":"");return D.length===0?Nt+"{}":Zn?Nt+"{"+gt(D,Zn)+"}":Nt+"{ "+U.call(D,", ")+" }"}return String(Xe)};function Z(Le,Xe,zt){var mt=(zt.quoteStyle||Xe)==="double"?'"':"'";return mt+Le+mt}function ae(Le){return x.call(String(Le),/"/g,"&quot;")}function Ae(Le){return me(Le)==="[object Array]"&&(!q||!(typeof Le=="object"&&q in Le))}function be(Le){return me(Le)==="[object Date]"&&(!q||!(typeof Le=="object"&&q in Le))}function Ge(Le){return me(Le)==="[object RegExp]"&&(!q||!(typeof Le=="object"&&q in Le))}function Te(Le){return me(Le)==="[object Error]"&&(!q||!(typeof Le=="object"&&q in Le))}function ve(Le){return me(Le)==="[object String]"&&(!q||!(typeof Le=="object"&&q in Le))}function ke(Le){return me(Le)==="[object Number]"&&(!q||!(typeof Le=="object"&&q in Le))}function Me(Le){return me(Le)==="[object Boolean]"&&(!q||!(typeof Le=="object"&&q in Le))}function Ie(Le){if(Q)return Le&&typeof Le=="object"&&Le instanceof Symbol;if(typeof Le=="symbol")return!0;if(!Le||typeof Le!="object"||!N)return!1;try{return N.call(Le),!0}catch{}return!1}function Ce(Le){if(!Le||typeof Le!="object"||!Y)return!1;try{return Y.call(Le),!0}catch{}return!1}var ot=Object.prototype.hasOwnProperty||function(Le){return Le in(this||Ph)};function et(Le,Xe){return ot.call(Le,Xe)}function me(Le){return y.call(Le)}function de(Le){if(Le.name)return Le.name;var Xe=C.call(w.call(Le),/^function\s*([\w$]+)/);return Xe?Xe[1]:null}function Be(Le,Xe){if(Le.indexOf)return Le.indexOf(Xe);for(var zt=0,mt=Le.length;zt<mt;zt++)if(Le[zt]===Xe)return zt;return-1}function Je(Le){if(!t||!Le||typeof Le!="object")return!1;try{t.call(Le);try{l.call(Le)}catch{return!0}return Le instanceof Map}catch{}return!1}function rt(Le){if(!f||!Le||typeof Le!="object")return!1;try{f.call(Le,f);try{p.call(Le,p)}catch{return!0}return Le instanceof WeakMap}catch{}return!1}function at(Le){if(!v||!Le||typeof Le!="object")return!1;try{return v.call(Le),!0}catch{}return!1}function ye(Le){if(!l||!Le||typeof Le!="object")return!1;try{l.call(Le);try{t.call(Le)}catch{return!0}return Le instanceof Set}catch{}return!1}function it(Le){if(!p||!Le||typeof Le!="object")return!1;try{p.call(Le,p);try{f.call(Le,f)}catch{return!0}return Le instanceof WeakSet}catch{}return!1}function Mt(Le){return!Le||typeof Le!="object"?!1:typeof HTMLElement<"u"&&Le instanceof HTMLElement?!0:typeof Le.nodeName=="string"&&typeof Le.getAttribute=="function"}function nt(Le,Xe){if(Le.length>Xe.maxStringLength){var zt=Le.length-Xe.maxStringLength,mt="... "+zt+" more character"+(zt>1?"s":"");return nt(S.call(Le,0,Xe.maxStringLength),Xe)+mt}var an=x.call(x.call(Le,/(['\\])/g,"\\$1"),/[\x00-\x1f]/g,Zt);return Z(an,"single",Xe)}function Zt(Le){var Xe=Le.charCodeAt(0),zt={8:"b",9:"t",10:"n",12:"f",13:"r"}[Xe];return zt?"\\"+zt:"\\x"+(Xe<16?"0":"")+k.call(Xe.toString(16))}function j(Le){return"Object("+Le+")"}function W(Le){return Le+" { ? }"}function se(Le,Xe,zt,mt){var an=mt?gt(zt,mt):U.call(zt,", ");return Le+" ("+Xe+") {"+an+"}"}function Oe(Le){for(var Xe=0;Xe<Le.length;Xe++)if(Be(Le[Xe],`
`)>=0)return!1;return!0}function Ke(Le,Xe){var zt;if(Le.indent==="	")zt="	";else if(typeof Le.indent=="number"&&Le.indent>0)zt=U.call(Array(Le.indent+1)," ");else return null;return{base:zt,prev:U.call(Array(Xe+1),zt)}}function gt(Le,Xe){if(Le.length===0)return"";var zt=`
`+Xe.prev+Xe.base;return zt+U.call(Le,","+zt)+`
`+Xe.prev}function Ut(Le,Xe){var zt=Ae(Le),mt=[];if(zt){mt.length=Le.length;for(var an=0;an<Le.length;an++)mt[an]=et(Le,an)?Xe(Le[an],Le):""}var hn=typeof O=="function"?O(Le):[],pr;if(Q){pr={};for(var Ft=0;Ft<hn.length;Ft++)pr["$"+hn[Ft]]=hn[Ft]}for(var Bn in Le)et(Le,Bn)&&(zt&&String(Number(Bn))===Bn&&Bn<Le.length||Q&&pr["$"+Bn]instanceof Symbol||(R.call(/[^\w$]/,Bn)?mt.push(Xe(Bn,Le)+": "+Xe(Le[Bn],Le)):mt.push(Bn+": "+Xe(Le[Bn],Le))));if(typeof O=="function")for(var xr=0;xr<hn.length;xr++)ee.call(Le,hn[xr])&&mt.push("["+Xe(hn[xr])+"]: "+Xe(Le[hn[xr]],Le));return mt}return Dh}function f8(){if(my)return Lh;my=!0;var i=Lc(),e=Q5(),t=u8(),n=Zu(),s=i("%WeakMap%",!0),a=i("%Map%",!0),l=e("WeakMap.prototype.get",!0),u=e("WeakMap.prototype.set",!0),c=e("WeakMap.prototype.has",!0),f=e("Map.prototype.get",!0),d=e("Map.prototype.set",!0),p=e("Map.prototype.has",!0),m=function(w,C){for(var S=w,x;(x=S.next)!==null;S=x)if(x.key===C)return S.next=x.next,x.next=w.next,w.next=x,x},v=function(w,C){var S=m(w,C);return S&&S.value},b=function(w,C,S){var x=m(w,C);x?x.value=S:w.next={key:C,next:w.next,value:S}},y=function(w,C){return!!m(w,C)};return Lh=function(){var w,C,S,x={assert:function(k){if(!x.has(k))throw new n("Side channel does not contain "+t(k))},get:function(k){if(s&&k&&(typeof k=="object"||typeof k=="function")){if(w)return l(w,k)}else if(a){if(C)return f(C,k)}else if(S)return v(S,k)},has:function(k){if(s&&k&&(typeof k=="object"||typeof k=="function")){if(w)return c(w,k)}else if(a){if(C)return p(C,k)}else if(S)return y(S,k);return!1},set:function(k,A){s&&k&&(typeof k=="object"||typeof k=="function")?(w||(w=new s),u(w,k,A)):a?(C||(C=new a),d(C,k,A)):(S||(S={key:{},next:null}),b(S,k,A))}};return x},Lh}function pb(){if(yy)return Uh;yy=!0;var i=String.prototype.replace,e=/%20/g,t={RFC1738:"RFC1738",RFC3986:"RFC3986"};return Uh={default:t.RFC3986,formatters:{RFC1738:function(n){return i.call(n,e,"+")},RFC3986:function(n){return String(n)}},RFC1738:t.RFC1738,RFC3986:t.RFC3986},Uh}function ZE(){if(by)return qh;by=!0;var i=pb(),e=Object.prototype.hasOwnProperty,t=Array.isArray,n=(function(){for(var w=[],C=0;C<256;++C)w.push("%"+((C<16?"0":"")+C.toString(16)).toUpperCase());return w})(),s=function(w){for(;w.length>1;){var C=w.pop(),S=C.obj[C.prop];if(t(S)){for(var x=[],k=0;k<S.length;++k)typeof S[k]<"u"&&x.push(S[k]);C.obj[C.prop]=x}}},a=function(w,C){for(var S=C&&C.plainObjects?Object.create(null):{},x=0;x<w.length;++x)typeof w[x]<"u"&&(S[x]=w[x]);return S},l=function w(C,S,x){if(!S)return C;if(typeof S!="object"){if(t(C))C.push(S);else if(C&&typeof C=="object")(x&&(x.plainObjects||x.allowPrototypes)||!e.call(Object.prototype,S))&&(C[S]=!0);else return[C,S];return C}if(!C||typeof C!="object")return[C].concat(S);var k=C;return t(C)&&!t(S)&&(k=a(C,x)),t(C)&&t(S)?(S.forEach(function(A,R){if(e.call(C,R)){var I=C[R];I&&typeof I=="object"&&A&&typeof A=="object"?C[R]=w(I,A,x):C.push(A)}else C[R]=A}),C):Object.keys(S).reduce(function(A,R){var I=S[R];return e.call(A,R)?A[R]=w(A[R],I,x):A[R]=I,A},k)},u=function(w,C){return Object.keys(C).reduce(function(S,x){return S[x]=C[x],S},w)},c=function(w,C,S){var x=w.replace(/\+/g," ");if(S==="iso-8859-1")return x.replace(/%[0-9a-f]{2}/gi,unescape);try{return decodeURIComponent(x)}catch{return x}},f=1024,d=function(w,C,S,x,k){if(w.length===0)return w;var A=w;if(typeof w=="symbol"?A=Symbol.prototype.toString.call(w):typeof w!="string"&&(A=String(w)),S==="iso-8859-1")return escape(A).replace(/%u[0-9a-f]{4}/gi,function(O){return"%26%23"+parseInt(O.slice(2),16)+"%3B"});for(var R="",I=0;I<A.length;I+=f){for(var U=A.length>=f?A.slice(I,I+f):A,te=[],G=0;G<U.length;++G){var Y=U.charCodeAt(G);if(Y===45||Y===46||Y===95||Y===126||Y>=48&&Y<=57||Y>=65&&Y<=90||Y>=97&&Y<=122||k===i.RFC1738&&(Y===40||Y===41)){te[te.length]=U.charAt(G);continue}if(Y<128){te[te.length]=n[Y];continue}if(Y<2048){te[te.length]=n[192|Y>>6]+n[128|Y&63];continue}if(Y<55296||Y>=57344){te[te.length]=n[224|Y>>12]+n[128|Y>>6&63]+n[128|Y&63];continue}G+=1,Y=65536+((Y&1023)<<10|U.charCodeAt(G)&1023),te[te.length]=n[240|Y>>18]+n[128|Y>>12&63]+n[128|Y>>6&63]+n[128|Y&63]}R+=te.join("")}return R},p=function(w){for(var C=[{obj:{o:w},prop:"o"}],S=[],x=0;x<C.length;++x)for(var k=C[x],A=k.obj[k.prop],R=Object.keys(A),I=0;I<R.length;++I){var U=R[I],te=A[U];typeof te=="object"&&te!==null&&S.indexOf(te)===-1&&(C.push({obj:A,prop:U}),S.push(te))}return s(C),w},m=function(w){return Object.prototype.toString.call(w)==="[object RegExp]"},v=function(w){return!w||typeof w!="object"?!1:!!(w.constructor&&w.constructor.isBuffer&&w.constructor.isBuffer(w))},b=function(w,C){return[].concat(w,C)},y=function(w,C){if(t(w)){for(var S=[],x=0;x<w.length;x+=1)S.push(C(w[x]));return S}return C(w)};return qh={arrayToObject:a,assign:u,combine:b,compact:p,decode:c,encode:d,isBuffer:v,isRegExp:m,maybeMap:y,merge:l},qh}function h8(){if(vy)return Fh;vy=!0;var i=f8(),e=ZE(),t=pb(),n=Object.prototype.hasOwnProperty,s={brackets:function(y){return y+"[]"},comma:"comma",indices:function(y,w){return y+"["+w+"]"},repeat:function(y){return y}},a=Array.isArray,l=Array.prototype.push,u=function(y,w){l.apply(y,a(w)?w:[w])},c=Date.prototype.toISOString,f=t.default,d={addQueryPrefix:!1,allowDots:!1,allowEmptyArrays:!1,arrayFormat:"indices",charset:"utf-8",charsetSentinel:!1,delimiter:"&",encode:!0,encodeDotInKeys:!1,encoder:e.encode,encodeValuesOnly:!1,format:f,formatter:t.formatters[f],indices:!1,serializeDate:function(y){return c.call(y)},skipNulls:!1,strictNullHandling:!1},p=function(y){return typeof y=="string"||typeof y=="number"||typeof y=="boolean"||typeof y=="symbol"||typeof y=="bigint"},m={},v=function y(w,C,S,x,k,A,R,I,U,te,G,Y,O,N,Q,q,ee,ne){for(var B=w,z=ne,$=0,V=!1;(z=z.get(m))!==void 0&&!V;){var Z=z.get(w);if($+=1,typeof Z<"u"){if(Z===$)throw new RangeError("Cyclic object value");V=!0}typeof z.get(m)>"u"&&($=0)}if(typeof te=="function"?B=te(C,B):B instanceof Date?B=O(B):S==="comma"&&a(B)&&(B=e.maybeMap(B,function(me){return me instanceof Date?O(me):me})),B===null){if(A)return U&&!q?U(C,d.encoder,ee,"key",N):C;B=""}if(p(B)||e.isBuffer(B)){if(U){var ae=q?C:U(C,d.encoder,ee,"key",N);return[Q(ae)+"="+Q(U(B,d.encoder,ee,"value",N))]}return[Q(C)+"="+Q(String(B))]}var Ae=[];if(typeof B>"u")return Ae;var be;if(S==="comma"&&a(B))q&&U&&(B=e.maybeMap(B,U)),be=[{value:B.length>0?B.join(",")||null:void 0}];else if(a(te))be=te;else{var Ge=Object.keys(B);be=G?Ge.sort(G):Ge}var Te=I?C.replace(/\./g,"%2E"):C,ve=x&&a(B)&&B.length===1?Te+"[]":Te;if(k&&a(B)&&B.length===0)return ve+"[]";for(var ke=0;ke<be.length;++ke){var Me=be[ke],Ie=typeof Me=="object"&&typeof Me.value<"u"?Me.value:B[Me];if(!(R&&Ie===null)){var Ce=Y&&I?Me.replace(/\./g,"%2E"):Me,ot=a(B)?typeof S=="function"?S(ve,Ce):ve:ve+(Y?"."+Ce:"["+Ce+"]");ne.set(w,$);var et=i();et.set(m,ne),u(Ae,y(Ie,ot,S,x,k,A,R,I,S==="comma"&&q&&a(B)?null:U,te,G,Y,O,N,Q,q,ee,et))}}return Ae},b=function(y){if(!y)return d;if(typeof y.allowEmptyArrays<"u"&&typeof y.allowEmptyArrays!="boolean")throw new TypeError("`allowEmptyArrays` option can only be `true` or `false`, when provided");if(typeof y.encodeDotInKeys<"u"&&typeof y.encodeDotInKeys!="boolean")throw new TypeError("`encodeDotInKeys` option can only be `true` or `false`, when provided");if(y.encoder!==null&&typeof y.encoder<"u"&&typeof y.encoder!="function")throw new TypeError("Encoder has to be a function.");var w=y.charset||d.charset;if(typeof y.charset<"u"&&y.charset!=="utf-8"&&y.charset!=="iso-8859-1")throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");var C=t.default;if(typeof y.format<"u"){if(!n.call(t.formatters,y.format))throw new TypeError("Unknown format option provided.");C=y.format}var S=t.formatters[C],x=d.filter;(typeof y.filter=="function"||a(y.filter))&&(x=y.filter);var k;if(y.arrayFormat in s?k=y.arrayFormat:"indices"in y?k=y.indices?"indices":"repeat":k=d.arrayFormat,"commaRoundTrip"in y&&typeof y.commaRoundTrip!="boolean")throw new TypeError("`commaRoundTrip` must be a boolean, or absent");var A=typeof y.allowDots>"u"?y.encodeDotInKeys===!0?!0:d.allowDots:!!y.allowDots;return{addQueryPrefix:typeof y.addQueryPrefix=="boolean"?y.addQueryPrefix:d.addQueryPrefix,allowDots:A,allowEmptyArrays:typeof y.allowEmptyArrays=="boolean"?!!y.allowEmptyArrays:d.allowEmptyArrays,arrayFormat:k,charset:w,charsetSentinel:typeof y.charsetSentinel=="boolean"?y.charsetSentinel:d.charsetSentinel,commaRoundTrip:y.commaRoundTrip,delimiter:typeof y.delimiter>"u"?d.delimiter:y.delimiter,encode:typeof y.encode=="boolean"?y.encode:d.encode,encodeDotInKeys:typeof y.encodeDotInKeys=="boolean"?y.encodeDotInKeys:d.encodeDotInKeys,encoder:typeof y.encoder=="function"?y.encoder:d.encoder,encodeValuesOnly:typeof y.encodeValuesOnly=="boolean"?y.encodeValuesOnly:d.encodeValuesOnly,filter:x,format:C,formatter:S,serializeDate:typeof y.serializeDate=="function"?y.serializeDate:d.serializeDate,skipNulls:typeof y.skipNulls=="boolean"?y.skipNulls:d.skipNulls,sort:typeof y.sort=="function"?y.sort:null,strictNullHandling:typeof y.strictNullHandling=="boolean"?y.strictNullHandling:d.strictNullHandling}};return Fh=function(y,w){var C=y,S=b(w),x,k;typeof S.filter=="function"?(k=S.filter,C=k("",C)):a(S.filter)&&(k=S.filter,x=k);var A=[];if(typeof C!="object"||C===null)return"";var R=s[S.arrayFormat],I=R==="comma"&&S.commaRoundTrip;x||(x=Object.keys(C)),S.sort&&x.sort(S.sort);for(var U=i(),te=0;te<x.length;++te){var G=x[te];S.skipNulls&&C[G]===null||u(A,v(C[G],G,R,I,S.allowEmptyArrays,S.strictNullHandling,S.skipNulls,S.encodeDotInKeys,S.encode?S.encoder:null,S.filter,S.sort,S.allowDots,S.serializeDate,S.format,S.formatter,S.encodeValuesOnly,S.charset,U))}var Y=A.join(S.delimiter),O=S.addQueryPrefix===!0?"?":"";return S.charsetSentinel&&(S.charset==="iso-8859-1"?O+="utf8=%26%2310003%3B&":O+="utf8=%E2%9C%93&"),Y.length>0?O+Y:""},Fh}function d8(){if(wy)return Hh;wy=!0;var i=ZE(),e=Object.prototype.hasOwnProperty,t=Array.isArray,n={allowDots:!1,allowEmptyArrays:!1,allowPrototypes:!1,allowSparse:!1,arrayLimit:20,charset:"utf-8",charsetSentinel:!1,comma:!1,decodeDotInKeys:!1,decoder:i.decode,delimiter:"&",depth:5,duplicates:"combine",ignoreQueryPrefix:!1,interpretNumericEntities:!1,parameterLimit:1e3,parseArrays:!0,plainObjects:!1,strictDepth:!1,strictNullHandling:!1},s=function(m){return m.replace(/&#(\d+);/g,function(v,b){return String.fromCharCode(parseInt(b,10))})},a=function(m,v){return m&&typeof m=="string"&&v.comma&&m.indexOf(",")>-1?m.split(","):m},l="utf8=%26%2310003%3B",u="utf8=%E2%9C%93",c=function(m,v){var b={__proto__:null},y=v.ignoreQueryPrefix?m.replace(/^\?/,""):m;y=y.replace(/%5B/gi,"[").replace(/%5D/gi,"]");var w=v.parameterLimit===1/0?void 0:v.parameterLimit,C=y.split(v.delimiter,w),S=-1,x,k=v.charset;if(v.charsetSentinel)for(x=0;x<C.length;++x)C[x].indexOf("utf8=")===0&&(C[x]===u?k="utf-8":C[x]===l&&(k="iso-8859-1"),S=x,x=C.length);for(x=0;x<C.length;++x)if(x!==S){var A=C[x],R=A.indexOf("]="),I=R===-1?A.indexOf("="):R+1,U,te;I===-1?(U=v.decoder(A,n.decoder,k,"key"),te=v.strictNullHandling?null:""):(U=v.decoder(A.slice(0,I),n.decoder,k,"key"),te=i.maybeMap(a(A.slice(I+1),v),function(Y){return v.decoder(Y,n.decoder,k,"value")})),te&&v.interpretNumericEntities&&k==="iso-8859-1"&&(te=s(te)),A.indexOf("[]=")>-1&&(te=t(te)?[te]:te);var G=e.call(b,U);G&&v.duplicates==="combine"?b[U]=i.combine(b[U],te):(!G||v.duplicates==="last")&&(b[U]=te)}return b},f=function(m,v,b,y){for(var w=y?v:a(v,b),C=m.length-1;C>=0;--C){var S,x=m[C];if(x==="[]"&&b.parseArrays)S=b.allowEmptyArrays&&(w===""||b.strictNullHandling&&w===null)?[]:[].concat(w);else{S=b.plainObjects?Object.create(null):{};var k=x.charAt(0)==="["&&x.charAt(x.length-1)==="]"?x.slice(1,-1):x,A=b.decodeDotInKeys?k.replace(/%2E/g,"."):k,R=parseInt(A,10);!b.parseArrays&&A===""?S={0:w}:!isNaN(R)&&x!==A&&String(R)===A&&R>=0&&b.parseArrays&&R<=b.arrayLimit?(S=[],S[R]=w):A!=="__proto__"&&(S[A]=w)}w=S}return w},d=function(m,v,b,y){if(m){var w=b.allowDots?m.replace(/\.([^.[]+)/g,"[$1]"):m,C=/(\[[^[\]]*])/,S=/(\[[^[\]]*])/g,x=b.depth>0&&C.exec(w),k=x?w.slice(0,x.index):w,A=[];if(k){if(!b.plainObjects&&e.call(Object.prototype,k)&&!b.allowPrototypes)return;A.push(k)}for(var R=0;b.depth>0&&(x=S.exec(w))!==null&&R<b.depth;){if(R+=1,!b.plainObjects&&e.call(Object.prototype,x[1].slice(1,-1))&&!b.allowPrototypes)return;A.push(x[1])}if(x){if(b.strictDepth===!0)throw new RangeError("Input depth exceeded depth option of "+b.depth+" and strictDepth is true");A.push("["+w.slice(x.index)+"]")}return f(A,v,b,y)}},p=function(m){if(!m)return n;if(typeof m.allowEmptyArrays<"u"&&typeof m.allowEmptyArrays!="boolean")throw new TypeError("`allowEmptyArrays` option can only be `true` or `false`, when provided");if(typeof m.decodeDotInKeys<"u"&&typeof m.decodeDotInKeys!="boolean")throw new TypeError("`decodeDotInKeys` option can only be `true` or `false`, when provided");if(m.decoder!==null&&typeof m.decoder<"u"&&typeof m.decoder!="function")throw new TypeError("Decoder has to be a function.");if(typeof m.charset<"u"&&m.charset!=="utf-8"&&m.charset!=="iso-8859-1")throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");var v=typeof m.charset>"u"?n.charset:m.charset,b=typeof m.duplicates>"u"?n.duplicates:m.duplicates;if(b!=="combine"&&b!=="first"&&b!=="last")throw new TypeError("The duplicates option must be either combine, first, or last");var y=typeof m.allowDots>"u"?m.decodeDotInKeys===!0?!0:n.allowDots:!!m.allowDots;return{allowDots:y,allowEmptyArrays:typeof m.allowEmptyArrays=="boolean"?!!m.allowEmptyArrays:n.allowEmptyArrays,allowPrototypes:typeof m.allowPrototypes=="boolean"?m.allowPrototypes:n.allowPrototypes,allowSparse:typeof m.allowSparse=="boolean"?m.allowSparse:n.allowSparse,arrayLimit:typeof m.arrayLimit=="number"?m.arrayLimit:n.arrayLimit,charset:v,charsetSentinel:typeof m.charsetSentinel=="boolean"?m.charsetSentinel:n.charsetSentinel,comma:typeof m.comma=="boolean"?m.comma:n.comma,decodeDotInKeys:typeof m.decodeDotInKeys=="boolean"?m.decodeDotInKeys:n.decodeDotInKeys,decoder:typeof m.decoder=="function"?m.decoder:n.decoder,delimiter:typeof m.delimiter=="string"||i.isRegExp(m.delimiter)?m.delimiter:n.delimiter,depth:typeof m.depth=="number"||m.depth===!1?+m.depth:n.depth,duplicates:b,ignoreQueryPrefix:m.ignoreQueryPrefix===!0,interpretNumericEntities:typeof m.interpretNumericEntities=="boolean"?m.interpretNumericEntities:n.interpretNumericEntities,parameterLimit:typeof m.parameterLimit=="number"?m.parameterLimit:n.parameterLimit,parseArrays:m.parseArrays!==!1,plainObjects:typeof m.plainObjects=="boolean"?m.plainObjects:n.plainObjects,strictDepth:typeof m.strictDepth=="boolean"?!!m.strictDepth:n.strictDepth,strictNullHandling:typeof m.strictNullHandling=="boolean"?m.strictNullHandling:n.strictNullHandling}};return Hh=function(m,v){var b=p(v);if(m===""||m===null||typeof m>"u")return b.plainObjects?Object.create(null):{};for(var y=typeof m=="string"?c(m,b):m,w=b.plainObjects?Object.create(null):{},C=Object.keys(y),S=0;S<C.length;++S){var x=C[S],k=d(x,y[x],b,typeof m=="string");w=i.merge(w,k,b)}return b.allowSparse===!0?w:i.compact(w)},Hh}function p8(){if(xy)return zh;xy=!0;var i=h8(),e=d8(),t=pb();return zh={formats:t,parse:e,stringify:i},zh}function g8(){if(_y)return Na;_y=!0;var i=Oa;function e(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}var t=/^([a-z0-9.+-]+:)/i,n=/:[0-9]*$/,s=/^(\/\/?(?!\/)[^?\s]*)(\?[^\s]*)?$/,a=["<",">",'"',"`"," ","\r",`
`,"	"],l=["{","}","|","\\","^","`"].concat(a),u=["'"].concat(l),c=["%","/","?",";","#"].concat(u),f=["/","?","#"],d=255,p=/^[+a-z0-9A-Z_-]{0,63}$/,m=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,v={javascript:!0,"javascript:":!0},b={javascript:!0,"javascript:":!0},y={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},w=p8();function C(A,R,I){if(A&&typeof A=="object"&&A instanceof e)return A;var U=new e;return U.parse(A,R,I),U}e.prototype.parse=function(A,R,I){if(typeof A!="string")throw new TypeError("Parameter 'url' must be a string, not "+typeof A);var U=A.indexOf("?"),te=U!==-1&&U<A.indexOf("#")?"?":"#",G=A.split(te),Y=/\\/g;G[0]=G[0].replace(Y,"/"),A=G.join(te);var O=A;if(O=O.trim(),!I&&A.split("#").length===1){var N=s.exec(O);if(N)return this.path=O,this.href=O,this.pathname=N[1],N[2]?(this.search=N[2],R?this.query=w.parse(this.search.substr(1)):this.query=this.search.substr(1)):R&&(this.search="",this.query={}),this}var Q=t.exec(O);if(Q){Q=Q[0];var q=Q.toLowerCase();this.protocol=q,O=O.substr(Q.length)}if(I||Q||O.match(/^\/\/[^@/]+@[^@/]+/)){var ee=O.substr(0,2)==="//";ee&&!(Q&&b[Q])&&(O=O.substr(2),this.slashes=!0)}if(!b[Q]&&(ee||Q&&!y[Q])){for(var ne=-1,B=0;B<f.length;B++){var z=O.indexOf(f[B]);z!==-1&&(ne===-1||z<ne)&&(ne=z)}var $,V;ne===-1?V=O.lastIndexOf("@"):V=O.lastIndexOf("@",ne),V!==-1&&($=O.slice(0,V),O=O.slice(V+1),this.auth=decodeURIComponent($)),ne=-1;for(var B=0;B<c.length;B++){var z=O.indexOf(c[B]);z!==-1&&(ne===-1||z<ne)&&(ne=z)}ne===-1&&(ne=O.length),this.host=O.slice(0,ne),O=O.slice(ne),this.parseHost(),this.hostname=this.hostname||"";var Z=this.hostname[0]==="["&&this.hostname[this.hostname.length-1]==="]";if(!Z)for(var ae=this.hostname.split(/\./),B=0,Ae=ae.length;B<Ae;B++){var be=ae[B];if(be&&!be.match(p)){for(var Ge="",Te=0,ve=be.length;Te<ve;Te++)be.charCodeAt(Te)>127?Ge+="x":Ge+=be[Te];if(!Ge.match(p)){var ke=ae.slice(0,B),Me=ae.slice(B+1),Ie=be.match(m);Ie&&(ke.push(Ie[1]),Me.unshift(Ie[2])),Me.length&&(O="/"+Me.join(".")+O),this.hostname=ke.join(".");break}}}this.hostname.length>d?this.hostname="":this.hostname=this.hostname.toLowerCase(),Z||(this.hostname=i.toASCII(this.hostname));var Ce=this.port?":"+this.port:"",ot=this.hostname||"";this.host=ot+Ce,this.href+=this.host,Z&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),O[0]!=="/"&&(O="/"+O))}if(!v[q])for(var B=0,Ae=u.length;B<Ae;B++){var et=u[B];if(O.indexOf(et)!==-1){var me=encodeURIComponent(et);me===et&&(me=escape(et)),O=O.split(et).join(me)}}var de=O.indexOf("#");de!==-1&&(this.hash=O.substr(de),O=O.slice(0,de));var Be=O.indexOf("?");if(Be!==-1?(this.search=O.substr(Be),this.query=O.substr(Be+1),R&&(this.query=w.parse(this.query)),O=O.slice(0,Be)):R&&(this.search="",this.query={}),O&&(this.pathname=O),y[q]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){var Ce=this.pathname||"",Je=this.search||"";this.path=Ce+Je}return this.href=this.format(),this};function S(A){return typeof A=="string"&&(A=C(A)),A instanceof e?A.format():e.prototype.format.call(A)}e.prototype.format=function(){var A=this.auth||"";A&&(A=encodeURIComponent(A),A=A.replace(/%3A/i,":"),A+="@");var R=this.protocol||"",I=this.pathname||"",U=this.hash||"",te=!1,G="";this.host?te=A+this.host:this.hostname&&(te=A+(this.hostname.indexOf(":")===-1?this.hostname:"["+this.hostname+"]"),this.port&&(te+=":"+this.port)),this.query&&typeof this.query=="object"&&Object.keys(this.query).length&&(G=w.stringify(this.query,{arrayFormat:"repeat",addQueryPrefix:!1}));var Y=this.search||G&&"?"+G||"";return R&&R.substr(-1)!==":"&&(R+=":"),this.slashes||(!R||y[R])&&te!==!1?(te="//"+(te||""),I&&I.charAt(0)!=="/"&&(I="/"+I)):te||(te=""),U&&U.charAt(0)!=="#"&&(U="#"+U),Y&&Y.charAt(0)!=="?"&&(Y="?"+Y),I=I.replace(/[?#]/g,function(O){return encodeURIComponent(O)}),Y=Y.replace("#","%23"),R+te+I+Y+U};function x(A,R){return C(A,!1,!0).resolve(R)}e.prototype.resolve=function(A){return this.resolveObject(C(A,!1,!0)).format()};function k(A,R){return A?C(A,!1,!0).resolveObject(R):R}return e.prototype.resolveObject=function(A){if(typeof A=="string"){var R=new e;R.parse(A,!1,!0),A=R}for(var I=new e,U=Object.keys(this),te=0;te<U.length;te++){var G=U[te];I[G]=this[G]}if(I.hash=A.hash,A.href==="")return I.href=I.format(),I;if(A.slashes&&!A.protocol){for(var Y=Object.keys(A),O=0;O<Y.length;O++){var N=Y[O];N!=="protocol"&&(I[N]=A[N])}return y[I.protocol]&&I.hostname&&!I.pathname&&(I.pathname="/",I.path=I.pathname),I.href=I.format(),I}if(A.protocol&&A.protocol!==I.protocol){if(!y[A.protocol]){for(var Q=Object.keys(A),q=0;q<Q.length;q++){var ee=Q[q];I[ee]=A[ee]}return I.href=I.format(),I}if(I.protocol=A.protocol,!A.host&&!b[A.protocol]){for(var Ae=(A.pathname||"").split("/");Ae.length&&!(A.host=Ae.shift()););A.host||(A.host=""),A.hostname||(A.hostname=""),Ae[0]!==""&&Ae.unshift(""),Ae.length<2&&Ae.unshift(""),I.pathname=Ae.join("/")}else I.pathname=A.pathname;if(I.search=A.search,I.query=A.query,I.host=A.host||"",I.auth=A.auth,I.hostname=A.hostname||A.host,I.port=A.port,I.pathname||I.search){var ne=I.pathname||"",B=I.search||"";I.path=ne+B}return I.slashes=I.slashes||A.slashes,I.href=I.format(),I}var z=I.pathname&&I.pathname.charAt(0)==="/",$=A.host||A.pathname&&A.pathname.charAt(0)==="/",V=$||z||I.host&&A.pathname,Z=V,ae=I.pathname&&I.pathname.split("/")||[],Ae=A.pathname&&A.pathname.split("/")||[],be=I.protocol&&!y[I.protocol];if(be&&(I.hostname="",I.port=null,I.host&&(ae[0]===""?ae[0]=I.host:ae.unshift(I.host)),I.host="",A.protocol&&(A.hostname=null,A.port=null,A.host&&(Ae[0]===""?Ae[0]=A.host:Ae.unshift(A.host)),A.host=null),V=V&&(Ae[0]===""||ae[0]==="")),$)I.host=A.host||A.host===""?A.host:I.host,I.hostname=A.hostname||A.hostname===""?A.hostname:I.hostname,I.search=A.search,I.query=A.query,ae=Ae;else if(Ae.length)ae||(ae=[]),ae.pop(),ae=ae.concat(Ae),I.search=A.search,I.query=A.query;else if(A.search!=null){if(be){I.host=ae.shift(),I.hostname=I.host;var Ge=I.host&&I.host.indexOf("@")>0?I.host.split("@"):!1;Ge&&(I.auth=Ge.shift(),I.hostname=Ge.shift(),I.host=I.hostname)}return I.search=A.search,I.query=A.query,(I.pathname!==null||I.search!==null)&&(I.path=(I.pathname?I.pathname:"")+(I.search?I.search:"")),I.href=I.format(),I}if(!ae.length)return I.pathname=null,I.search?I.path="/"+I.search:I.path=null,I.href=I.format(),I;for(var Te=ae.slice(-1)[0],ve=(I.host||A.host||ae.length>1)&&(Te==="."||Te==="..")||Te==="",ke=0,Me=ae.length;Me>=0;Me--)Te=ae[Me],Te==="."?ae.splice(Me,1):Te===".."?(ae.splice(Me,1),ke++):ke&&(ae.splice(Me,1),ke--);if(!V&&!Z)for(;ke--;ke)ae.unshift("..");V&&ae[0]!==""&&(!ae[0]||ae[0].charAt(0)!=="/")&&ae.unshift(""),ve&&ae.join("/").substr(-1)!=="/"&&ae.push("");var Ie=ae[0]===""||ae[0]&&ae[0].charAt(0)==="/";if(be){I.hostname=Ie?"":ae.length?ae.shift():"",I.host=I.hostname;var Ge=I.host&&I.host.indexOf("@")>0?I.host.split("@"):!1;Ge&&(I.auth=Ge.shift(),I.hostname=Ge.shift(),I.host=I.hostname)}return V=V||I.host&&ae.length,V&&!Ie&&ae.unshift(""),ae.length>0?I.pathname=ae.join("/"):(I.pathname=null,I.path=null),(I.pathname!==null||I.search!==null)&&(I.path=(I.pathname?I.pathname:"")+(I.search?I.search:"")),I.auth=A.auth||I.auth,I.slashes=I.slashes||A.slashes,I.href=I.format(),I},e.prototype.parseHost=function(){var A=this.host,R=n.exec(A);R&&(R=R[0],R!==":"&&(this.port=R.substr(1)),A=A.substr(0,A.length-R.length)),A&&(this.hostname=A)},Na.parse=C,Na.resolve=x,Na.resolveObject=k,Na.format=S,Na.Url=e,Na}function XE(i){if(typeof i=="string")i=new URL(i);else if(!(i instanceof URL))throw new Deno.errors.InvalidData("invalid argument path , must be a string or URL");if(i.protocol!=="file:")throw new Deno.errors.InvalidData("invalid url scheme");return sd?m8(i):y8(i)}function m8(i){let e=i.hostname,t=i.pathname;for(let n=0;n<t.length;n++)if(t[n]==="%"){let s=t.codePointAt(n+2)||32;if(t[n+1]==="2"&&s===102||t[n+1]==="5"&&s===99)throw new Deno.errors.InvalidData("must not include encoded \\ or / characters")}if(t=t.replace(hC,"\\"),t=decodeURIComponent(t),e!=="")return`\\\\${e}${t}`;{let n=t.codePointAt(1)|32,s=t[2];if(n<uC||n>fC||s!==":")throw new Deno.errors.InvalidData("file url path must be absolute");return t.slice(1)}}function y8(i){if(i.hostname!=="")throw new Deno.errors.InvalidData("invalid file url hostname");let e=i.pathname;for(let t=0;t<e.length;t++)if(e[t]==="%"){let n=e.codePointAt(t+2)||32;if(e[t+1]==="2"&&n===102)throw new Deno.errors.InvalidData("must not include encoded / characters")}return decodeURIComponent(e)}function eC(i){let e=py.resolve(i),t=i.charCodeAt(i.length-1);(t===cC||sd&&t===lC)&&e[e.length-1]!==py.sep&&(e+="/");let n=new URL("file://");return e.includes("%")&&(e=e.replace(dC,"%25")),!sd&&e.includes("\\")&&(e=e.replace(pC,"%5C")),e.includes(`
`)&&(e=e.replace(gC,"%0A")),e.includes("\r")&&(e=e.replace(mC,"%0D")),e.includes("	")&&(e=e.replace(yC,"%09")),n.pathname=e,n}var tC,Dh,gy,Ph,Lh,my,Uh,yy,qh,by,Fh,vy,Hh,wy,zh,xy,Na,_y,gi,e2,nC,rC,iC,sC,oC,aC,lC,cC,uC,fC,sd,hC,dC,pC,gC,mC,yC,b8=qi(()=>{_t(),Et(),St(),j5(),J5(),c8(),QE(),tC=Object.freeze(Object.create(null)),Dh={},gy=!1,Ph=typeof globalThis<"u"?globalThis:typeof self<"u"?self:global,Lh={},my=!1,Uh={},yy=!1,qh={},by=!1,Fh={},vy=!1,Hh={},wy=!1,zh={},xy=!1,Na={},_y=!1,gi=g8(),gi.parse,gi.resolve,gi.resolveObject,gi.format,gi.Url,e2=typeof Deno<"u"?Deno.build.os==="windows"?"win32":Deno.build.os:void 0,gi.URL=typeof URL<"u"?URL:null,gi.pathToFileURL=eC,gi.fileURLToPath=XE,nC=gi.Url,rC=gi.format,iC=gi.resolve,sC=gi.resolveObject,oC=gi.parse,aC=gi.URL,lC=92,cC=47,uC=97,fC=122,sd=e2==="win32",hC=/\//g,dC=/%/g,pC=/\\/g,gC=/\n/g,mC=/\r/g,yC=/\t/g}),v8=Rt((i,e)=>{_t(),Et(),St(),e.exports=function(){throw new Error("ws does not work in the browser. Browser clients must use the native WebSocket object")}}),gb=Rt(i=>{_t(),Et(),St(),Object.defineProperty(i,"__esModule",{value:!0}),i.BufferedDuplex=void 0,i.writev=n;var e=jl(),t=(ni(),dr(ti));function n(a,l){let u=new Array(a.length);for(let c=0;c<a.length;c++)typeof a[c].chunk=="string"?u[c]=t.Buffer.from(a[c].chunk,"utf8"):u[c]=a[c].chunk;this._write(t.Buffer.concat(u),"binary",l)}var s=class extends e.Duplex{socket;proxy;isSocketOpen;writeQueue;constructor(a,l,u){super({objectMode:!0}),this.proxy=l,this.socket=u,this.writeQueue=[],a.objectMode||(this._writev=n.bind(this)),this.isSocketOpen=!1,this.proxy.on("data",c=>{!this.destroyed&&this.readable&&this.push(c)})}_read(a){this.proxy.read(a)}_write(a,l,u){this.isSocketOpen?this.writeToProxy(a,l,u):this.writeQueue.push({chunk:a,encoding:l,cb:u})}_final(a){this.writeQueue=[],this.proxy.end(a)}_destroy(a,l){this.writeQueue=[],this.proxy.destroy(),l(a)}socketReady(){this.emit("connect"),this.isSocketOpen=!0,this.processWriteQueue()}writeToProxy(a,l,u){this.proxy.write(a,l)===!1?this.proxy.once("drain",u):u()}processWriteQueue(){for(;this.writeQueue.length>0;){let{chunk:a,encoding:l,cb:u}=this.writeQueue.shift();this.writeToProxy(a,l,u)}}};i.BufferedDuplex=s}),rh=Rt(i=>{_t(),Et(),St();var e=i&&i.__importDefault||function(C){return C&&C.__esModule?C:{default:C}};Object.defineProperty(i,"__esModule",{value:!0}),i.streamBuilder=i.browserStreamBuilder=void 0;var t=(ni(),dr(ti)),n=e(v8()),s=e(Ro()),a=jl(),l=e(Sd()),u=gb(),c=(0,s.default)("mqttjs:ws"),f=["rejectUnauthorized","ca","cert","key","pfx","passphrase"];function d(C,S){let x=`${C.protocol}://${C.hostname}:${C.port}${C.path}`;return typeof C.transformWsUrl=="function"&&(x=C.transformWsUrl(x,C,S)),x}function p(C){let S=C;return C.port||(C.protocol==="wss"?S.port=443:S.port=80),C.path||(S.path="/"),C.wsOptions||(S.wsOptions={}),!l.default&&!C.forceNativeWebSocket&&C.protocol==="wss"&&f.forEach(x=>{Object.prototype.hasOwnProperty.call(C,x)&&!Object.prototype.hasOwnProperty.call(C.wsOptions,x)&&(S.wsOptions[x]=C[x])}),S}function m(C){let S=p(C);if(S.hostname||(S.hostname=S.host),!S.hostname){if(typeof document>"u")throw new Error("Could not determine host. Specify host manually.");let x=new URL(document.URL);S.hostname=x.hostname,S.port||(S.port=Number(x.port))}return S.objectMode===void 0&&(S.objectMode=!(S.binary===!0||S.binary===void 0)),S}function v(C,S,x){c("createWebSocket"),c(`protocol: ${x.protocolId} ${x.protocolVersion}`);let k=x.protocolId==="MQIsdp"&&x.protocolVersion===3?"mqttv3.1":"mqtt";c(`creating new Websocket for url: ${S} and protocol: ${k}`);let A;return x.createWebsocket?A=x.createWebsocket(S,[k],x):A=new n.default(S,[k],x.wsOptions),A}function b(C,S){let x=S.protocolId==="MQIsdp"&&S.protocolVersion===3?"mqttv3.1":"mqtt",k=d(S,C),A;return S.createWebsocket?A=S.createWebsocket(k,[x],S):A=new WebSocket(k,[x]),A.binaryType="arraybuffer",A}var y=(C,S)=>{c("streamBuilder");let x=p(S);x.hostname=x.hostname||x.host||"localhost";let k=d(x,C),A=v(C,k,x),R=n.default.createWebSocketStream(A,x.wsOptions);return R.url=k,A.on("close",()=>{R.destroy()}),R};i.streamBuilder=y;var w=(C,S)=>{c("browserStreamBuilder");let x,k=m(S).browserBufferSize||1024*512,A=S.browserBufferTimeout||1e3,R=!S.objectMode,I=b(C,S),U=G(S,q,ee);S.objectMode||(U._writev=u.writev.bind(U)),U.on("close",()=>{I.close()});let te=typeof I.addEventListener<"u";I.readyState===I.OPEN?(x=U,x.socket=I):(x=new u.BufferedDuplex(S,U,I),te?I.addEventListener("open",Y):I.onopen=Y),te?(I.addEventListener("close",O),I.addEventListener("error",N),I.addEventListener("message",Q)):(I.onclose=O,I.onerror=N,I.onmessage=Q);function G(ne,B,z){let $=new a.Transform({objectMode:ne.objectMode});return $._write=B,$._flush=z,$}function Y(){c("WebSocket onOpen"),x instanceof u.BufferedDuplex&&x.socketReady()}function O(ne){c("WebSocket onClose",ne),x.end(),x.destroy()}function N(ne){c("WebSocket onError",ne);let B=new Error("WebSocket error");B.event=ne,x.destroy(B)}async function Q(ne){if(!U||!U.readable||!U.writable)return;let{data:B}=ne;B instanceof ArrayBuffer?B=t.Buffer.from(B):B instanceof Blob?B=t.Buffer.from(await new Response(B).arrayBuffer()):B=t.Buffer.from(B,"utf8"),U.push(B)}function q(ne,B,z){if(I.bufferedAmount>k){setTimeout(q,A,ne,B,z);return}R&&typeof ne=="string"&&(ne=t.Buffer.from(ne,"utf8"));try{I.send(ne)}catch($){return z($)}z()}function ee(ne){I.close(),ne()}return x};i.browserStreamBuilder=w}),mb={};jc(mb,{Server:()=>Mr,Socket:()=>Mr,Stream:()=>Mr,_createServerHandle:()=>Mr,_normalizeArgs:()=>Mr,_setSimultaneousAccepts:()=>Mr,connect:()=>Mr,createConnection:()=>Mr,createServer:()=>Mr,default:()=>bC,isIP:()=>Mr,isIPv4:()=>Mr,isIPv6:()=>Mr});function Mr(){throw new Error("Node.js net module is not supported by JSPM core outside of Node.js")}var bC,vC=qi(()=>{_t(),Et(),St(),bC={_createServerHandle:Mr,_normalizeArgs:Mr,_setSimultaneousAccepts:Mr,connect:Mr,createConnection:Mr,createServer:Mr,isIP:Mr,isIPv4:Mr,isIPv6:Mr,Server:Mr,Socket:Mr,Stream:Mr}}),wC=Rt((i,e)=>{_t(),Et(),St(),e.exports={}}),t2=Rt(i=>{_t(),Et(),St();var e=i&&i.__importDefault||function(u){return u&&u.__esModule?u:{default:u}};Object.defineProperty(i,"__esModule",{value:!0});var t=e((vC(),dr(mb))),n=e(Ro()),s=e(wC()),a=(0,n.default)("mqttjs:tcp"),l=(u,c)=>{if(c.port=c.port||1883,c.hostname=c.hostname||c.host||"localhost",c.socksProxy)return(0,s.default)(c.hostname,c.port,c.socksProxy,{timeout:c.socksTimeout});let{port:f,path:d}=c,p=c.hostname;return a("port %d and host %s",f,p),t.default.createConnection({port:f,host:p,path:d})};i.default=l}),xC={};jc(xC,{default:()=>_C});var _C,w8=qi(()=>{_t(),Et(),St(),_C={}}),n2=Rt(i=>{_t(),Et(),St();var e=i&&i.__importDefault||function(f){return f&&f.__esModule?f:{default:f}};Object.defineProperty(i,"__esModule",{value:!0});var t=(w8(),dr(xC)),n=e((vC(),dr(mb))),s=e(Ro()),a=e(wC()),l=(0,s.default)("mqttjs:tls");function u(f){let{host:d,port:p,socksProxy:m,...v}=f;if(m!==void 0){let b=(0,a.default)(d,p,m,{timeout:f.socksTimeout});return(0,t.connect)({...v,socket:b})}return(0,t.connect)(f)}var c=(f,d)=>{d.port=d.port||8883,d.host=d.hostname||d.host||"localhost",n.default.isIP(d.host)===0&&(d.servername=d.host),d.rejectUnauthorized=d.rejectUnauthorized!==!1,delete d.path,l("port %d host %s rejectUnauthorized %b",d.port,d.host,d.rejectUnauthorized);let p=u(d);p.on("secureConnect",()=>{d.rejectUnauthorized&&!p.authorized?p.emit("error",new Error("TLS not authorized")):p.removeListener("error",m)});function m(v){d.rejectUnauthorized&&f.emit("error",v),p.end()}return p.on("error",m),p};i.default=c}),r2=Rt(i=>{_t(),Et(),St(),Object.defineProperty(i,"__esModule",{value:!0});var e=(ni(),dr(ti)),t=jl(),n=gb(),s,a,l;function u(){let m=new t.Transform;return m._write=(v,b,y)=>{s.send({data:v.buffer,success(){y()},fail(w){y(new Error(w))}})},m._flush=v=>{s.close({success(){v()}})},m}function c(m){m.hostname||(m.hostname="localhost"),m.path||(m.path="/"),m.wsOptions||(m.wsOptions={})}function f(m,v){let b=m.protocol==="wxs"?"wss":"ws",y=`${b}://${m.hostname}${m.path}`;return m.port&&m.port!==80&&m.port!==443&&(y=`${b}://${m.hostname}:${m.port}${m.path}`),typeof m.transformWsUrl=="function"&&(y=m.transformWsUrl(y,m,v)),y}function d(){s.onOpen(()=>{l.socketReady()}),s.onMessage(m=>{let{data:v}=m;v instanceof ArrayBuffer?v=e.Buffer.from(v):v=e.Buffer.from(v,"utf8"),a.push(v)}),s.onClose(()=>{l.emit("close"),l.end(),l.destroy()}),s.onError(m=>{let v=new Error(m.errMsg);l.destroy(v)})}var p=(m,v)=>{if(v.hostname=v.hostname||v.host,!v.hostname)throw new Error("Could not determine host. Specify host manually.");let b=v.protocolId==="MQIsdp"&&v.protocolVersion===3?"mqttv3.1":"mqtt";c(v);let y=f(v,m);s=wx.connectSocket({url:y,protocols:[b]}),a=u(),l=new n.BufferedDuplex(v,a,s),l._destroy=(C,S)=>{s.close({success(){S&&S(C)}})};let w=l.destroy;return l.destroy=(C,S)=>(l.destroy=w,setTimeout(()=>{s.close({fail(){l._destroy(C,S)}})},0),l),d(),l};i.default=p}),i2=Rt(i=>{_t(),Et(),St(),Object.defineProperty(i,"__esModule",{value:!0});var e=(ni(),dr(ti)),t=jl(),n=gb(),s,a,l,u=!1;function c(){let v=new t.Transform;return v._write=(b,y,w)=>{s.sendSocketMessage({data:b.buffer,success(){w()},fail(){w(new Error)}})},v._flush=b=>{s.closeSocket({success(){b()}})},v}function f(v){v.hostname||(v.hostname="localhost"),v.path||(v.path="/"),v.wsOptions||(v.wsOptions={})}function d(v,b){let y=v.protocol==="alis"?"wss":"ws",w=`${y}://${v.hostname}${v.path}`;return v.port&&v.port!==80&&v.port!==443&&(w=`${y}://${v.hostname}:${v.port}${v.path}`),typeof v.transformWsUrl=="function"&&(w=v.transformWsUrl(w,v,b)),w}function p(){u||(u=!0,s.onSocketOpen(()=>{l.socketReady()}),s.onSocketMessage(v=>{if(typeof v.data=="string"){let b=e.Buffer.from(v.data,"base64");a.push(b)}else{let b=new FileReader;b.addEventListener("load",()=>{if(b.result instanceof ArrayBuffer){a.push(e.Buffer.from(b.result));return}a.push(e.Buffer.from(b.result,"utf-8"))}),b.readAsArrayBuffer(v.data)}}),s.onSocketClose(()=>{l.end(),l.destroy()}),s.onSocketError(v=>{l.destroy(v)}))}var m=(v,b)=>{if(b.hostname=b.hostname||b.host,!b.hostname)throw new Error("Could not determine host. Specify host manually.");let y=b.protocolId==="MQIsdp"&&b.protocolVersion===3?"mqttv3.1":"mqtt";f(b);let w=d(b,v);return s=b.my,s.connectSocket({url:w,protocols:y}),a=c(),l=new n.BufferedDuplex(b,a,s),p(),l};i.default=m}),x8=Rt(i=>{_t(),Et(),St();var e=i&&i.__importDefault||function(p){return p&&p.__esModule?p:{default:p}};Object.defineProperty(i,"__esModule",{value:!0}),i.connectAsync=d;var t=e(Ro()),n=e((b8(),dr(JE))),s=e(jm()),a=e(Sd());typeof vr?.nextTick!="function"&&(vr.nextTick=setImmediate);var l=(0,t.default)("mqttjs"),u=null;function c(p){let m;if(p.auth)if(m=p.auth.match(/^(.+):(.+)$/),m){let[,v,b]=m;p.username=v,p.password=b}else p.username=p.auth}function f(p,m){if(l("connecting to an MQTT broker..."),typeof p=="object"&&!m&&(m=p,p=""),m=m||{},p&&typeof p=="string"){let y=n.default.parse(p,!0),w={};if(y.port!=null&&(w.port=Number(y.port)),w.host=y.hostname,w.query=y.query,w.auth=y.auth,w.protocol=y.protocol,w.path=y.path,m={...w,...m},!m.protocol)throw new Error("Missing protocol");m.protocol=m.protocol.replace(/:$/,"")}if(m.unixSocket=m.unixSocket||m.protocol?.includes("+unix"),m.unixSocket?m.protocol=m.protocol.replace("+unix",""):!m.protocol?.startsWith("ws")&&!m.protocol?.startsWith("wx")&&delete m.path,c(m),m.query&&typeof m.query.clientId=="string"&&(m.clientId=m.query.clientId),a.default||m.unixSocket?m.socksProxy=void 0:m.socksProxy===void 0&&typeof vr<"u"&&(m.socksProxy=vr.env.MQTTJS_SOCKS_PROXY),m.cert&&m.key)if(m.protocol){if(["mqtts","wss","wxs","alis"].indexOf(m.protocol)===-1)switch(m.protocol){case"mqtt":m.protocol="mqtts";break;case"ws":m.protocol="wss";break;case"wx":m.protocol="wxs";break;case"ali":m.protocol="alis";break;default:throw new Error(`Unknown protocol for secure connection: "${m.protocol}"!`)}}else throw new Error("Missing secure protocol key");if(u||(u={},!a.default&&!m.forceNativeWebSocket?(u.ws=rh().streamBuilder,u.wss=rh().streamBuilder,u.mqtt=t2().default,u.tcp=t2().default,u.ssl=n2().default,u.tls=u.ssl,u.mqtts=n2().default):(u.ws=rh().browserStreamBuilder,u.wss=rh().browserStreamBuilder,u.wx=r2().default,u.wxs=r2().default,u.ali=i2().default,u.alis=i2().default)),!u[m.protocol]){let y=["mqtts","wss"].indexOf(m.protocol)!==-1;m.protocol=["mqtt","mqtts","ws","wss","wx","wxs","ali","alis"].filter((w,C)=>y&&C%2===0?!1:typeof u[w]=="function")[0]}if(m.clean===!1&&!m.clientId)throw new Error("Missing clientId for unclean clients");m.protocol&&(m.defaultProtocol=m.protocol);function v(y){return m.servers&&((!y._reconnectCount||y._reconnectCount===m.servers.length)&&(y._reconnectCount=0),m.host=m.servers[y._reconnectCount].host,m.port=m.servers[y._reconnectCount].port,m.protocol=m.servers[y._reconnectCount].protocol?m.servers[y._reconnectCount].protocol:m.defaultProtocol,m.hostname=m.host,y._reconnectCount++),l("calling streambuilder for",m.protocol),u[m.protocol](y,m)}let b=new s.default(v,m);return b.on("error",()=>{}),b}function d(p,m,v=!0){return new Promise((b,y)=>{let w=f(p,m),C={connect:x=>{S(),b(w)},end:()=>{S(),b(w)},error:x=>{S(),w.end(),y(x)}};v===!1&&(C.close=()=>{C.error(new Error("Couldn't connect to server"))});function S(){Object.keys(C).forEach(x=>{w.off(x,C[x])})}Object.keys(C).forEach(x=>{w.on(x,C[x])})})}i.default=f}),s2=Rt(i=>{_t(),Et(),St();var e=i&&i.__createBinding||(Object.create?function(v,b,y,w){w===void 0&&(w=y);var C=Object.getOwnPropertyDescriptor(b,y);(!C||("get"in C?!b.__esModule:C.writable||C.configurable))&&(C={enumerable:!0,get:function(){return b[y]}}),Object.defineProperty(v,w,C)}:function(v,b,y,w){w===void 0&&(w=y),v[w]=b[y]}),t=i&&i.__setModuleDefault||(Object.create?function(v,b){Object.defineProperty(v,"default",{enumerable:!0,value:b})}:function(v,b){v.default=b}),n=i&&i.__importStar||(function(){var v=function(b){return v=Object.getOwnPropertyNames||function(y){var w=[];for(var C in y)Object.prototype.hasOwnProperty.call(y,C)&&(w[w.length]=C);return w},v(b)};return function(b){if(b&&b.__esModule)return b;var y={};if(b!=null)for(var w=v(b),C=0;C<w.length;C++)w[C]!=="default"&&e(y,b,w[C]);return t(y,b),y}})(),s=i&&i.__exportStar||function(v,b){for(var y in v)y!=="default"&&!Object.prototype.hasOwnProperty.call(b,y)&&e(b,v,y)},a=i&&i.__importDefault||function(v){return v&&v.__esModule?v:{default:v}};Object.defineProperty(i,"__esModule",{value:!0}),i.ReasonCodes=i.KeepaliveManager=i.UniqueMessageIdProvider=i.DefaultMessageIdProvider=i.Store=i.MqttClient=i.connectAsync=i.connect=i.Client=void 0;var l=a(jm());i.MqttClient=l.default;var u=a(LE());i.DefaultMessageIdProvider=u.default;var c=a(N5());i.UniqueMessageIdProvider=c.default;var f=a(xE());i.Store=f.default;var d=n(x8());i.connect=d.default,Object.defineProperty(i,"connectAsync",{enumerable:!0,get:function(){return d.connectAsync}});var p=a(KE());i.KeepaliveManager=p.default,i.Client=l.default,s(jm(),i),s(Pc(),i);var m=xd();Object.defineProperty(i,"ReasonCodes",{enumerable:!0,get:function(){return m.ReasonCodes}})}),_8=Rt(i=>{_t(),Et(),St();var e=i&&i.__createBinding||(Object.create?function(l,u,c,f){f===void 0&&(f=c);var d=Object.getOwnPropertyDescriptor(u,c);(!d||("get"in d?!u.__esModule:d.writable||d.configurable))&&(d={enumerable:!0,get:function(){return u[c]}}),Object.defineProperty(l,f,d)}:function(l,u,c,f){f===void 0&&(f=c),l[f]=u[c]}),t=i&&i.__setModuleDefault||(Object.create?function(l,u){Object.defineProperty(l,"default",{enumerable:!0,value:u})}:function(l,u){l.default=u}),n=i&&i.__importStar||(function(){var l=function(u){return l=Object.getOwnPropertyNames||function(c){var f=[];for(var d in c)Object.prototype.hasOwnProperty.call(c,d)&&(f[f.length]=d);return f},l(u)};return function(u){if(u&&u.__esModule)return u;var c={};if(u!=null)for(var f=l(u),d=0;d<f.length;d++)f[d]!=="default"&&e(c,u,f[d]);return t(c,u),c}})(),s=i&&i.__exportStar||function(l,u){for(var c in l)c!=="default"&&!Object.prototype.hasOwnProperty.call(u,c)&&e(u,l,c)};Object.defineProperty(i,"__esModule",{value:!0});var a=n(s2());i.default=a,s(s2(),i)});const S8=_8();const E8=["wss://broker.emqx.io:8084/mqtt","wss://broker.hivemq.com:8884/mqtt"];class C8{name="MQTT";client=null;userIdHash=null;handshakeCallbacks=new Set;customSignalCallbacks=new Set;connected=!1;messageCounter=0;brokers;currentBrokerIndex=0;processedMessageIds=new Set;messageIdCleanupInterval=null;constructor(e=E8){this.brokers=e}async initialize(e){this.userIdHash=e,await this.connectToBroker(),this.messageIdCleanupInterval=setInterval(()=>{this.cleanupProcessedMessageIds()},6e4),console.log(`[${this.name}] Initialized for user:`,e.substring(0,8)+"...")}async connectToBroker(){return new Promise((e,t)=>{const n=this.brokers[this.currentBrokerIndex];console.log(`[${this.name}] Connecting to ${n}...`);const s=`adun-${this.userIdHash.substring(0,12)}-${Date.now().toString(36)}`;this.client=S8.connect(n,{clientId:s,clean:!0,connectTimeout:1e4,reconnectPeriod:5e3,keepalive:30});const a=setTimeout(()=>{this.connected||(this.client?.end(!0),this.currentBrokerIndex<this.brokers.length-1?(this.currentBrokerIndex++,this.connectToBroker().then(e).catch(t)):t(new Error("Failed to connect to any MQTT broker")))},1e4);this.client.on("connect",()=>{clearTimeout(a),this.connected=!0,console.log(`[${this.name}] Connected to ${n}`),this.subscribeToInbox(),e()}),this.client.on("error",l=>{console.error(`[${this.name}] Connection error:`,l)}),this.client.on("close",()=>{console.log(`[${this.name}] Connection closed`),this.connected=!1}),this.client.on("reconnect",()=>{console.log(`[${this.name}] Reconnecting...`)}),this.client.on("message",(l,u)=>{this.handleIncomingMessage(l,u)})})}subscribeToInbox(){if(!this.client||!this.userIdHash)return;const e=`adun/signals/${this.userIdHash}`;this.client.subscribe(e,{qos:1},t=>{t?console.error(`[${this.name}] Failed to subscribe:`,t):console.log(`[${this.name}] Subscribed to inbox:`,e)})}handleIncomingMessage(e,t){try{const n=JSON.parse(t.toString());if(this.processedMessageIds.has(n.id))return;this.processedMessageIds.add(n.id),this.processIncomingMessage(n)}catch(n){console.error(`[${this.name}] Failed to parse message:`,n)}}processIncomingMessage(e){!e.from||!e.type||(e.type==="handshake"&&e.message?(console.log(`[${this.name}] Received handshake from:`,e.from.substring(0,8)),this.handshakeCallbacks.forEach(t=>{t(e.from,e.message)})):e.type==="custom"&&e.signal&&(console.log(`[${this.name}] Received custom signal from:`,e.from.substring(0,8)),this.customSignalCallbacks.forEach(t=>{t(e.from,e.signal)})))}cleanupProcessedMessageIds(){const e=Date.now()-3e5,t=new Set;this.processedMessageIds.forEach(n=>{parseInt(n.split("-")[0],10)>e&&t.add(n)}),this.processedMessageIds=t}generateMessageId(){return this.messageCounter++,`${Date.now()}-${this.messageCounter}-${Math.random().toString(36).substring(2,8)}`}async sendMessage(e,t){if(!this.client||!this.userIdHash||!this.connected)throw new Error("Not initialized or not connected");const n=this.generateMessageId(),s={...t,from:this.userIdHash,timestamp:Date.now(),id:n},a=`adun/signals/${e}`;return new Promise((l,u)=>{this.client.publish(a,JSON.stringify(s),{qos:1},c=>{c?u(c):l()})})}async sendHandshakeMessage(e,t){await this.sendMessage(e,{type:"handshake",message:t}),console.log(`[${this.name}] Sent handshake to:`,e.substring(0,8))}async sendCustomSignal(e,t){await this.sendMessage(e,{type:"custom",signal:t}),console.log(`[${this.name}] Sent custom signal to:`,e.substring(0,8))}onHandshakeMessage(e){return this.handshakeCallbacks.add(e),()=>{this.handshakeCallbacks.delete(e)}}onCustomSignal(e){return this.customSignalCallbacks.add(e),()=>{this.customSignalCallbacks.delete(e)}}isConnected(){return this.connected&&this.client!==null&&this.client.connected}destroy(){this.messageIdCleanupInterval&&(clearInterval(this.messageIdCleanupInterval),this.messageIdCleanupInterval=null),this.client&&(this.client.end(!0),this.client=null),this.handshakeCallbacks.clear(),this.customSignalCallbacks.clear(),this.processedMessageIds.clear(),this.connected=!1,this.userIdHash=null,console.log(`[${this.name}] Destroyed`)}}function o2(i){if(!Number.isSafeInteger(i)||i<0)throw new Error(`Wrong positive integer: ${i}`)}function SC(i,...e){if(!(i instanceof Uint8Array))throw new Error("Expected Uint8Array");if(e.length>0&&!e.includes(i.length))throw new Error(`Expected Uint8Array of length ${e}, not of length=${i.length}`)}function A8(i){if(typeof i!="function"||typeof i.create!="function")throw new Error("Hash should be wrapped by utils.wrapConstructor");o2(i.outputLen),o2(i.blockLen)}function od(i,e=!0){if(i.destroyed)throw new Error("Hash instance has been destroyed");if(e&&i.finished)throw new Error("Hash#digest() has already been called")}function k8(i,e){SC(i);const t=e.outputLen;if(i.length<t)throw new Error(`digestInto() expects output buffer of length at least ${t}`)}const Kg=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;const EC=i=>i instanceof Uint8Array,Vg=i=>new DataView(i.buffer,i.byteOffset,i.byteLength),Ls=(i,e)=>i<<32-e|i>>>e,T8=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;if(!T8)throw new Error("Non little-endian hardware is not supported");function M8(i){if(typeof i!="string")throw new Error(`utf8ToBytes expected string, got ${typeof i}`);return new Uint8Array(new TextEncoder().encode(i))}function yb(i){if(typeof i=="string"&&(i=M8(i)),!EC(i))throw new Error(`expected Uint8Array, got ${typeof i}`);return i}function I8(...i){const e=new Uint8Array(i.reduce((n,s)=>n+s.length,0));let t=0;return i.forEach(n=>{if(!EC(n))throw new Error("Uint8Array expected");e.set(n,t),t+=n.length}),e}let CC=class{clone(){return this._cloneInto()}};function R8(i){const e=n=>i().update(yb(n)).digest(),t=i();return e.outputLen=t.outputLen,e.blockLen=t.blockLen,e.create=()=>i(),e}function AC(i=32){if(Kg&&typeof Kg.getRandomValues=="function")return Kg.getRandomValues(new Uint8Array(i));throw new Error("crypto.getRandomValues must be defined")}function O8(i,e,t,n){if(typeof i.setBigUint64=="function")return i.setBigUint64(e,t,n);const s=BigInt(32),a=BigInt(4294967295),l=Number(t>>s&a),u=Number(t&a),c=n?4:0,f=n?0:4;i.setUint32(e+c,l,n),i.setUint32(e+f,u,n)}let N8=class extends CC{constructor(e,t,n,s){super(),this.blockLen=e,this.outputLen=t,this.padOffset=n,this.isLE=s,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(e),this.view=Vg(this.buffer)}update(e){od(this);const{view:t,buffer:n,blockLen:s}=this;e=yb(e);const a=e.length;for(let l=0;l<a;){const u=Math.min(s-this.pos,a-l);if(u===s){const c=Vg(e);for(;s<=a-l;l+=s)this.process(c,l);continue}n.set(e.subarray(l,l+u),this.pos),this.pos+=u,l+=u,this.pos===s&&(this.process(t,0),this.pos=0)}return this.length+=e.length,this.roundClean(),this}digestInto(e){od(this),k8(e,this),this.finished=!0;const{buffer:t,view:n,blockLen:s,isLE:a}=this;let{pos:l}=this;t[l++]=128,this.buffer.subarray(l).fill(0),this.padOffset>s-l&&(this.process(n,0),l=0);for(let p=l;p<s;p++)t[p]=0;O8(n,s-8,BigInt(this.length*8),a),this.process(n,0);const u=Vg(e),c=this.outputLen;if(c%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const f=c/4,d=this.get();if(f>d.length)throw new Error("_sha2: outputLen bigger than state");for(let p=0;p<f;p++)u.setUint32(4*p,d[p],a)}digest(){const{buffer:e,outputLen:t}=this;this.digestInto(e);const n=e.slice(0,t);return this.destroy(),n}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());const{blockLen:t,buffer:n,length:s,finished:a,destroyed:l,pos:u}=this;return e.length=s,e.pos=u,e.finished=a,e.destroyed=l,s%t&&e.buffer.set(n),e}};const B8=(i,e,t)=>i&e^~i&t,j8=(i,e,t)=>i&e^i&t^e&t,D8=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),Aa=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),ka=new Uint32Array(64);let P8=class extends N8{constructor(){super(64,32,8,!1),this.A=Aa[0]|0,this.B=Aa[1]|0,this.C=Aa[2]|0,this.D=Aa[3]|0,this.E=Aa[4]|0,this.F=Aa[5]|0,this.G=Aa[6]|0,this.H=Aa[7]|0}get(){const{A:e,B:t,C:n,D:s,E:a,F:l,G:u,H:c}=this;return[e,t,n,s,a,l,u,c]}set(e,t,n,s,a,l,u,c){this.A=e|0,this.B=t|0,this.C=n|0,this.D=s|0,this.E=a|0,this.F=l|0,this.G=u|0,this.H=c|0}process(e,t){for(let p=0;p<16;p++,t+=4)ka[p]=e.getUint32(t,!1);for(let p=16;p<64;p++){const m=ka[p-15],v=ka[p-2],b=Ls(m,7)^Ls(m,18)^m>>>3,y=Ls(v,17)^Ls(v,19)^v>>>10;ka[p]=y+ka[p-7]+b+ka[p-16]|0}let{A:n,B:s,C:a,D:l,E:u,F:c,G:f,H:d}=this;for(let p=0;p<64;p++){const m=Ls(u,6)^Ls(u,11)^Ls(u,25),v=d+m+B8(u,c,f)+D8[p]+ka[p]|0,y=(Ls(n,2)^Ls(n,13)^Ls(n,22))+j8(n,s,a)|0;d=f,f=c,c=u,u=l+v|0,l=a,a=s,s=n,n=v+y|0}n=n+this.A|0,s=s+this.B|0,a=a+this.C|0,l=l+this.D|0,u=u+this.E|0,c=c+this.F|0,f=f+this.G|0,d=d+this.H|0,this.set(n,s,a,l,u,c,f,d)}roundClean(){ka.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}};const Sy=R8(()=>new P8);const kC=BigInt(0),Ed=BigInt(1),L8=BigInt(2),Cd=i=>i instanceof Uint8Array,U8=Array.from({length:256},(i,e)=>e.toString(16).padStart(2,"0"));function Rc(i){if(!Cd(i))throw new Error("Uint8Array expected");let e="";for(let t=0;t<i.length;t++)e+=U8[i[t]];return e}function TC(i){const e=i.toString(16);return e.length&1?`0${e}`:e}function bb(i){if(typeof i!="string")throw new Error("hex string expected, got "+typeof i);return BigInt(i===""?"0":`0x${i}`)}function Oc(i){if(typeof i!="string")throw new Error("hex string expected, got "+typeof i);const e=i.length;if(e%2)throw new Error("padded hex string expected, got unpadded hex of length "+e);const t=new Uint8Array(e/2);for(let n=0;n<t.length;n++){const s=n*2,a=i.slice(s,s+2),l=Number.parseInt(a,16);if(Number.isNaN(l)||l<0)throw new Error("Invalid byte sequence");t[n]=l}return t}function Ui(i){return bb(Rc(i))}function vb(i){if(!Cd(i))throw new Error("Uint8Array expected");return bb(Rc(Uint8Array.from(i).reverse()))}function Ua(i,e){return Oc(i.toString(16).padStart(e*2,"0"))}function wb(i,e){return Ua(i,e).reverse()}function q8(i){return Oc(TC(i))}function yi(i,e,t){let n;if(typeof e=="string")try{n=Oc(e)}catch(a){throw new Error(`${i} must be valid hex string, got "${e}". Cause: ${a}`)}else if(Cd(e))n=Uint8Array.from(e);else throw new Error(`${i} must be hex string or Uint8Array`);const s=n.length;if(typeof t=="number"&&s!==t)throw new Error(`${i} expected ${t} bytes, got ${s}`);return n}function kl(...i){const e=new Uint8Array(i.reduce((n,s)=>n+s.length,0));let t=0;return i.forEach(n=>{if(!Cd(n))throw new Error("Uint8Array expected");e.set(n,t),t+=n.length}),e}function F8(i,e){if(i.length!==e.length)return!1;for(let t=0;t<i.length;t++)if(i[t]!==e[t])return!1;return!0}function H8(i){if(typeof i!="string")throw new Error(`utf8ToBytes expected string, got ${typeof i}`);return new Uint8Array(new TextEncoder().encode(i))}function z8(i){let e;for(e=0;i>kC;i>>=Ed,e+=1);return e}function G8(i,e){return i>>BigInt(e)&Ed}const K8=(i,e,t)=>i|(t?Ed:kC)<<BigInt(e),xb=i=>(L8<<BigInt(i-1))-Ed,$g=i=>new Uint8Array(i),a2=i=>Uint8Array.from(i);function MC(i,e,t){if(typeof i!="number"||i<2)throw new Error("hashLen must be a number");if(typeof e!="number"||e<2)throw new Error("qByteLen must be a number");if(typeof t!="function")throw new Error("hmacFn must be a function");let n=$g(i),s=$g(i),a=0;const l=()=>{n.fill(1),s.fill(0),a=0},u=(...p)=>t(s,n,...p),c=(p=$g())=>{s=u(a2([0]),p),n=u(),p.length!==0&&(s=u(a2([1]),p),n=u())},f=()=>{if(a++>=1e3)throw new Error("drbg: tried 1000 values");let p=0;const m=[];for(;p<e;){n=u();const v=n.slice();m.push(v),p+=n.length}return kl(...m)};return(p,m)=>{l(),c(p);let v;for(;!(v=m(f()));)c();return l(),v}}const V8={bigint:i=>typeof i=="bigint",function:i=>typeof i=="function",boolean:i=>typeof i=="boolean",string:i=>typeof i=="string",stringOrUint8Array:i=>typeof i=="string"||i instanceof Uint8Array,isSafeInteger:i=>Number.isSafeInteger(i),array:i=>Array.isArray(i),field:(i,e)=>e.Fp.isValid(i),hash:i=>typeof i=="function"&&Number.isSafeInteger(i.outputLen)};function Xu(i,e,t={}){const n=(s,a,l)=>{const u=V8[a];if(typeof u!="function")throw new Error(`Invalid validator "${a}", expected function`);const c=i[s];if(!(l&&c===void 0)&&!u(c,i))throw new Error(`Invalid param ${String(s)}=${c} (${typeof c}), expected ${a}`)};for(const[s,a]of Object.entries(e))n(s,a,!1);for(const[s,a]of Object.entries(t))n(s,a,!0);return i}const $8=Object.freeze(Object.defineProperty({__proto__:null,bitGet:G8,bitLen:z8,bitMask:xb,bitSet:K8,bytesToHex:Rc,bytesToNumberBE:Ui,bytesToNumberLE:vb,concatBytes:kl,createHmacDrbg:MC,ensureBytes:yi,equalBytes:F8,hexToBytes:Oc,hexToNumber:bb,numberToBytesBE:Ua,numberToBytesLE:wb,numberToHexUnpadded:TC,numberToVarBytesBE:q8,utf8ToBytes:H8,validateObject:Xu},Symbol.toStringTag,{value:"Module"}));const ei=BigInt(0),Hr=BigInt(1),bl=BigInt(2),Y8=BigInt(3),Ey=BigInt(4),l2=BigInt(5),c2=BigInt(8);BigInt(9);BigInt(16);function ci(i,e){const t=i%e;return t>=ei?t:e+t}function W8(i,e,t){if(t<=ei||e<ei)throw new Error("Expected power/modulo > 0");if(t===Hr)return ei;let n=Hr;for(;e>ei;)e&Hr&&(n=n*i%t),i=i*i%t,e>>=Hr;return n}function rs(i,e,t){let n=i;for(;e-- >ei;)n*=n,n%=t;return n}function Cy(i,e){if(i===ei||e<=ei)throw new Error(`invert: expected positive integers, got n=${i} mod=${e}`);let t=ci(i,e),n=e,s=ei,a=Hr;for(;t!==ei;){const u=n/t,c=n%t,f=s-a*u;n=t,t=c,s=a,a=f}if(n!==Hr)throw new Error("invert: does not exist");return ci(s,e)}function Q8(i){const e=(i-Hr)/bl;let t,n,s;for(t=i-Hr,n=0;t%bl===ei;t/=bl,n++);for(s=bl;s<i&&W8(s,e,i)!==i-Hr;s++);if(n===1){const l=(i+Hr)/Ey;return function(c,f){const d=c.pow(f,l);if(!c.eql(c.sqr(d),f))throw new Error("Cannot find square root");return d}}const a=(t+Hr)/bl;return function(u,c){if(u.pow(c,e)===u.neg(u.ONE))throw new Error("Cannot find square root");let f=n,d=u.pow(u.mul(u.ONE,s),t),p=u.pow(c,a),m=u.pow(c,t);for(;!u.eql(m,u.ONE);){if(u.eql(m,u.ZERO))return u.ZERO;let v=1;for(let y=u.sqr(m);v<f&&!u.eql(y,u.ONE);v++)y=u.sqr(y);const b=u.pow(d,Hr<<BigInt(f-v-1));d=u.sqr(b),p=u.mul(p,b),m=u.mul(m,d),f=v}return p}}function J8(i){if(i%Ey===Y8){const e=(i+Hr)/Ey;return function(n,s){const a=n.pow(s,e);if(!n.eql(n.sqr(a),s))throw new Error("Cannot find square root");return a}}if(i%c2===l2){const e=(i-l2)/c2;return function(n,s){const a=n.mul(s,bl),l=n.pow(a,e),u=n.mul(s,l),c=n.mul(n.mul(u,bl),l),f=n.mul(u,n.sub(c,n.ONE));if(!n.eql(n.sqr(f),s))throw new Error("Cannot find square root");return f}}return Q8(i)}const Z8=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function X8(i){const e={ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"},t=Z8.reduce((n,s)=>(n[s]="function",n),e);return Xu(i,t)}function eM(i,e,t){if(t<ei)throw new Error("Expected power > 0");if(t===ei)return i.ONE;if(t===Hr)return e;let n=i.ONE,s=e;for(;t>ei;)t&Hr&&(n=i.mul(n,s)),s=i.sqr(s),t>>=Hr;return n}function tM(i,e){const t=new Array(e.length),n=e.reduce((a,l,u)=>i.is0(l)?a:(t[u]=a,i.mul(a,l)),i.ONE),s=i.inv(n);return e.reduceRight((a,l,u)=>i.is0(l)?a:(t[u]=i.mul(a,t[u]),i.mul(a,l)),s),t}function IC(i,e){const t=e!==void 0?e:i.toString(2).length,n=Math.ceil(t/8);return{nBitLength:t,nByteLength:n}}function nM(i,e,t=!1,n={}){if(i<=ei)throw new Error(`Expected Field ORDER > 0, got ${i}`);const{nBitLength:s,nByteLength:a}=IC(i,e);if(a>2048)throw new Error("Field lengths over 2048 bytes are not supported");const l=J8(i),u=Object.freeze({ORDER:i,BITS:s,BYTES:a,MASK:xb(s),ZERO:ei,ONE:Hr,create:c=>ci(c,i),isValid:c=>{if(typeof c!="bigint")throw new Error(`Invalid field element: expected bigint, got ${typeof c}`);return ei<=c&&c<i},is0:c=>c===ei,isOdd:c=>(c&Hr)===Hr,neg:c=>ci(-c,i),eql:(c,f)=>c===f,sqr:c=>ci(c*c,i),add:(c,f)=>ci(c+f,i),sub:(c,f)=>ci(c-f,i),mul:(c,f)=>ci(c*f,i),pow:(c,f)=>eM(u,c,f),div:(c,f)=>ci(c*Cy(f,i),i),sqrN:c=>c*c,addN:(c,f)=>c+f,subN:(c,f)=>c-f,mulN:(c,f)=>c*f,inv:c=>Cy(c,i),sqrt:n.sqrt||(c=>l(u,c)),invertBatch:c=>tM(u,c),cmov:(c,f,d)=>d?f:c,toBytes:c=>t?wb(c,a):Ua(c,a),fromBytes:c=>{if(c.length!==a)throw new Error(`Fp.fromBytes: expected ${a}, got ${c.length}`);return t?vb(c):Ui(c)}});return Object.freeze(u)}function RC(i){if(typeof i!="bigint")throw new Error("field order must be bigint");const e=i.toString(2).length;return Math.ceil(e/8)}function OC(i){const e=RC(i);return e+Math.ceil(e/2)}function rM(i,e,t=!1){const n=i.length,s=RC(e),a=OC(e);if(n<16||n<a||n>1024)throw new Error(`expected ${a}-1024 bytes of input, got ${n}`);const l=t?Ui(i):vb(i),u=ci(l,e-Hr)+Hr;return t?wb(u,s):Ua(u,s)}const iM=BigInt(0),Yg=BigInt(1);function sM(i,e){const t=(s,a)=>{const l=a.negate();return s?l:a},n=s=>{const a=Math.ceil(e/s)+1,l=2**(s-1);return{windows:a,windowSize:l}};return{constTimeNegate:t,unsafeLadder(s,a){let l=i.ZERO,u=s;for(;a>iM;)a&Yg&&(l=l.add(u)),u=u.double(),a>>=Yg;return l},precomputeWindow(s,a){const{windows:l,windowSize:u}=n(a),c=[];let f=s,d=f;for(let p=0;p<l;p++){d=f,c.push(d);for(let m=1;m<u;m++)d=d.add(f),c.push(d);f=d.double()}return c},wNAF(s,a,l){const{windows:u,windowSize:c}=n(s);let f=i.ZERO,d=i.BASE;const p=BigInt(2**s-1),m=2**s,v=BigInt(s);for(let b=0;b<u;b++){const y=b*c;let w=Number(l&p);l>>=v,w>c&&(w-=m,l+=Yg);const C=y,S=y+Math.abs(w)-1,x=b%2!==0,k=w<0;w===0?d=d.add(t(x,a[C])):f=f.add(t(k,a[S]))}return{p:f,f:d}},wNAFCached(s,a,l,u){const c=s._WINDOW_SIZE||1;let f=a.get(s);return f||(f=this.precomputeWindow(s,c),c!==1&&a.set(s,u(f))),this.wNAF(c,f,l)}}}function NC(i){return X8(i.Fp),Xu(i,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...IC(i.n,i.nBitLength),...i,p:i.Fp.ORDER})}function oM(i){const e=NC(i);Xu(e,{a:"field",b:"field"},{allowedPrivateKeyLengths:"array",wrapPrivateKey:"boolean",isTorsionFree:"function",clearCofactor:"function",allowInfinityPoint:"boolean",fromBytes:"function",toBytes:"function"});const{endo:t,Fp:n,a:s}=e;if(t){if(!n.eql(s,n.ZERO))throw new Error("Endomorphism can only be defined for Koblitz curves that have a=0");if(typeof t!="object"||typeof t.beta!="bigint"||typeof t.splitScalar!="function")throw new Error("Expected endomorphism with beta: bigint and splitScalar: function")}return Object.freeze({...e})}const{bytesToNumberBE:aM,hexToBytes:lM}=$8,_l={Err:class extends Error{constructor(e=""){super(e)}},_parseInt(i){const{Err:e}=_l;if(i.length<2||i[0]!==2)throw new e("Invalid signature integer tag");const t=i[1],n=i.subarray(2,t+2);if(!t||n.length!==t)throw new e("Invalid signature integer: wrong length");if(n[0]&128)throw new e("Invalid signature integer: negative");if(n[0]===0&&!(n[1]&128))throw new e("Invalid signature integer: unnecessary leading zero");return{d:aM(n),l:i.subarray(t+2)}},toSig(i){const{Err:e}=_l,t=typeof i=="string"?lM(i):i;if(!(t instanceof Uint8Array))throw new Error("ui8a expected");let n=t.length;if(n<2||t[0]!=48)throw new e("Invalid signature tag");if(t[1]!==n-2)throw new e("Invalid signature: incorrect length");const{d:s,l:a}=_l._parseInt(t.subarray(2)),{d:l,l:u}=_l._parseInt(a);if(u.length)throw new e("Invalid signature: left bytes after parsing");return{r:s,s:l}},hexFromSig(i){const e=f=>Number.parseInt(f[0],16)&8?"00"+f:f,t=f=>{const d=f.toString(16);return d.length&1?`0${d}`:d},n=e(t(i.s)),s=e(t(i.r)),a=n.length/2,l=s.length/2,u=t(a),c=t(l);return`30${t(l+a+4)}02${c}${s}02${u}${n}`}},Ao=BigInt(0),ss=BigInt(1);BigInt(2);const u2=BigInt(3);BigInt(4);function cM(i){const e=oM(i),{Fp:t}=e,n=e.toBytes||((b,y,w)=>{const C=y.toAffine();return kl(Uint8Array.from([4]),t.toBytes(C.x),t.toBytes(C.y))}),s=e.fromBytes||(b=>{const y=b.subarray(1),w=t.fromBytes(y.subarray(0,t.BYTES)),C=t.fromBytes(y.subarray(t.BYTES,2*t.BYTES));return{x:w,y:C}});function a(b){const{a:y,b:w}=e,C=t.sqr(b),S=t.mul(C,b);return t.add(t.add(S,t.mul(b,y)),w)}if(!t.eql(t.sqr(e.Gy),a(e.Gx)))throw new Error("bad generator point: equation left != right");function l(b){return typeof b=="bigint"&&Ao<b&&b<e.n}function u(b){if(!l(b))throw new Error("Expected valid bigint: 0 < bigint < curve.n")}function c(b){const{allowedPrivateKeyLengths:y,nByteLength:w,wrapPrivateKey:C,n:S}=e;if(y&&typeof b!="bigint"){if(b instanceof Uint8Array&&(b=Rc(b)),typeof b!="string"||!y.includes(b.length))throw new Error("Invalid key");b=b.padStart(w*2,"0")}let x;try{x=typeof b=="bigint"?b:Ui(yi("private key",b,w))}catch{throw new Error(`private key must be ${w} bytes, hex or bigint, not ${typeof b}`)}return C&&(x=ci(x,S)),u(x),x}const f=new Map;function d(b){if(!(b instanceof p))throw new Error("ProjectivePoint expected")}class p{constructor(y,w,C){if(this.px=y,this.py=w,this.pz=C,y==null||!t.isValid(y))throw new Error("x required");if(w==null||!t.isValid(w))throw new Error("y required");if(C==null||!t.isValid(C))throw new Error("z required")}static fromAffine(y){const{x:w,y:C}=y||{};if(!y||!t.isValid(w)||!t.isValid(C))throw new Error("invalid affine point");if(y instanceof p)throw new Error("projective point not allowed");const S=x=>t.eql(x,t.ZERO);return S(w)&&S(C)?p.ZERO:new p(w,C,t.ONE)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static normalizeZ(y){const w=t.invertBatch(y.map(C=>C.pz));return y.map((C,S)=>C.toAffine(w[S])).map(p.fromAffine)}static fromHex(y){const w=p.fromAffine(s(yi("pointHex",y)));return w.assertValidity(),w}static fromPrivateKey(y){return p.BASE.multiply(c(y))}_setWindowSize(y){this._WINDOW_SIZE=y,f.delete(this)}assertValidity(){if(this.is0()){if(e.allowInfinityPoint&&!t.is0(this.py))return;throw new Error("bad point: ZERO")}const{x:y,y:w}=this.toAffine();if(!t.isValid(y)||!t.isValid(w))throw new Error("bad point: x or y not FE");const C=t.sqr(w),S=a(y);if(!t.eql(C,S))throw new Error("bad point: equation left != right");if(!this.isTorsionFree())throw new Error("bad point: not in prime-order subgroup")}hasEvenY(){const{y}=this.toAffine();if(t.isOdd)return!t.isOdd(y);throw new Error("Field doesn't support isOdd")}equals(y){d(y);const{px:w,py:C,pz:S}=this,{px:x,py:k,pz:A}=y,R=t.eql(t.mul(w,A),t.mul(x,S)),I=t.eql(t.mul(C,A),t.mul(k,S));return R&&I}negate(){return new p(this.px,t.neg(this.py),this.pz)}double(){const{a:y,b:w}=e,C=t.mul(w,u2),{px:S,py:x,pz:k}=this;let A=t.ZERO,R=t.ZERO,I=t.ZERO,U=t.mul(S,S),te=t.mul(x,x),G=t.mul(k,k),Y=t.mul(S,x);return Y=t.add(Y,Y),I=t.mul(S,k),I=t.add(I,I),A=t.mul(y,I),R=t.mul(C,G),R=t.add(A,R),A=t.sub(te,R),R=t.add(te,R),R=t.mul(A,R),A=t.mul(Y,A),I=t.mul(C,I),G=t.mul(y,G),Y=t.sub(U,G),Y=t.mul(y,Y),Y=t.add(Y,I),I=t.add(U,U),U=t.add(I,U),U=t.add(U,G),U=t.mul(U,Y),R=t.add(R,U),G=t.mul(x,k),G=t.add(G,G),U=t.mul(G,Y),A=t.sub(A,U),I=t.mul(G,te),I=t.add(I,I),I=t.add(I,I),new p(A,R,I)}add(y){d(y);const{px:w,py:C,pz:S}=this,{px:x,py:k,pz:A}=y;let R=t.ZERO,I=t.ZERO,U=t.ZERO;const te=e.a,G=t.mul(e.b,u2);let Y=t.mul(w,x),O=t.mul(C,k),N=t.mul(S,A),Q=t.add(w,C),q=t.add(x,k);Q=t.mul(Q,q),q=t.add(Y,O),Q=t.sub(Q,q),q=t.add(w,S);let ee=t.add(x,A);return q=t.mul(q,ee),ee=t.add(Y,N),q=t.sub(q,ee),ee=t.add(C,S),R=t.add(k,A),ee=t.mul(ee,R),R=t.add(O,N),ee=t.sub(ee,R),U=t.mul(te,q),R=t.mul(G,N),U=t.add(R,U),R=t.sub(O,U),U=t.add(O,U),I=t.mul(R,U),O=t.add(Y,Y),O=t.add(O,Y),N=t.mul(te,N),q=t.mul(G,q),O=t.add(O,N),N=t.sub(Y,N),N=t.mul(te,N),q=t.add(q,N),Y=t.mul(O,q),I=t.add(I,Y),Y=t.mul(ee,q),R=t.mul(Q,R),R=t.sub(R,Y),Y=t.mul(Q,O),U=t.mul(ee,U),U=t.add(U,Y),new p(R,I,U)}subtract(y){return this.add(y.negate())}is0(){return this.equals(p.ZERO)}wNAF(y){return v.wNAFCached(this,f,y,w=>{const C=t.invertBatch(w.map(S=>S.pz));return w.map((S,x)=>S.toAffine(C[x])).map(p.fromAffine)})}multiplyUnsafe(y){const w=p.ZERO;if(y===Ao)return w;if(u(y),y===ss)return this;const{endo:C}=e;if(!C)return v.unsafeLadder(this,y);let{k1neg:S,k1:x,k2neg:k,k2:A}=C.splitScalar(y),R=w,I=w,U=this;for(;x>Ao||A>Ao;)x&ss&&(R=R.add(U)),A&ss&&(I=I.add(U)),U=U.double(),x>>=ss,A>>=ss;return S&&(R=R.negate()),k&&(I=I.negate()),I=new p(t.mul(I.px,C.beta),I.py,I.pz),R.add(I)}multiply(y){u(y);let w=y,C,S;const{endo:x}=e;if(x){const{k1neg:k,k1:A,k2neg:R,k2:I}=x.splitScalar(w);let{p:U,f:te}=this.wNAF(A),{p:G,f:Y}=this.wNAF(I);U=v.constTimeNegate(k,U),G=v.constTimeNegate(R,G),G=new p(t.mul(G.px,x.beta),G.py,G.pz),C=U.add(G),S=te.add(Y)}else{const{p:k,f:A}=this.wNAF(w);C=k,S=A}return p.normalizeZ([C,S])[0]}multiplyAndAddUnsafe(y,w,C){const S=p.BASE,x=(A,R)=>R===Ao||R===ss||!A.equals(S)?A.multiplyUnsafe(R):A.multiply(R),k=x(this,w).add(x(y,C));return k.is0()?void 0:k}toAffine(y){const{px:w,py:C,pz:S}=this,x=this.is0();y==null&&(y=x?t.ONE:t.inv(S));const k=t.mul(w,y),A=t.mul(C,y),R=t.mul(S,y);if(x)return{x:t.ZERO,y:t.ZERO};if(!t.eql(R,t.ONE))throw new Error("invZ was invalid");return{x:k,y:A}}isTorsionFree(){const{h:y,isTorsionFree:w}=e;if(y===ss)return!0;if(w)return w(p,this);throw new Error("isTorsionFree() has not been declared for the elliptic curve")}clearCofactor(){const{h:y,clearCofactor:w}=e;return y===ss?this:w?w(p,this):this.multiplyUnsafe(e.h)}toRawBytes(y=!0){return this.assertValidity(),n(p,this,y)}toHex(y=!0){return Rc(this.toRawBytes(y))}}p.BASE=new p(e.Gx,e.Gy,t.ONE),p.ZERO=new p(t.ZERO,t.ONE,t.ZERO);const m=e.nBitLength,v=sM(p,e.endo?Math.ceil(m/2):m);return{CURVE:e,ProjectivePoint:p,normPrivateKeyToScalar:c,weierstrassEquation:a,isWithinCurveOrder:l}}function uM(i){const e=NC(i);return Xu(e,{hash:"hash",hmac:"function",randomBytes:"function"},{bits2int:"function",bits2int_modN:"function",lowS:"boolean"}),Object.freeze({lowS:!0,...e})}function fM(i){const e=uM(i),{Fp:t,n}=e,s=t.BYTES+1,a=2*t.BYTES+1;function l(q){return Ao<q&&q<t.ORDER}function u(q){return ci(q,n)}function c(q){return Cy(q,n)}const{ProjectivePoint:f,normPrivateKeyToScalar:d,weierstrassEquation:p,isWithinCurveOrder:m}=cM({...e,toBytes(q,ee,ne){const B=ee.toAffine(),z=t.toBytes(B.x),$=kl;return ne?$(Uint8Array.from([ee.hasEvenY()?2:3]),z):$(Uint8Array.from([4]),z,t.toBytes(B.y))},fromBytes(q){const ee=q.length,ne=q[0],B=q.subarray(1);if(ee===s&&(ne===2||ne===3)){const z=Ui(B);if(!l(z))throw new Error("Point is not on curve");const $=p(z);let V=t.sqrt($);const Z=(V&ss)===ss;return(ne&1)===1!==Z&&(V=t.neg(V)),{x:z,y:V}}else if(ee===a&&ne===4){const z=t.fromBytes(B.subarray(0,t.BYTES)),$=t.fromBytes(B.subarray(t.BYTES,2*t.BYTES));return{x:z,y:$}}else throw new Error(`Point of length ${ee} was invalid. Expected ${s} compressed bytes or ${a} uncompressed bytes`)}}),v=q=>Rc(Ua(q,e.nByteLength));function b(q){const ee=n>>ss;return q>ee}function y(q){return b(q)?u(-q):q}const w=(q,ee,ne)=>Ui(q.slice(ee,ne));class C{constructor(ee,ne,B){this.r=ee,this.s=ne,this.recovery=B,this.assertValidity()}static fromCompact(ee){const ne=e.nByteLength;return ee=yi("compactSignature",ee,ne*2),new C(w(ee,0,ne),w(ee,ne,2*ne))}static fromDER(ee){const{r:ne,s:B}=_l.toSig(yi("DER",ee));return new C(ne,B)}assertValidity(){if(!m(this.r))throw new Error("r must be 0 < r < CURVE.n");if(!m(this.s))throw new Error("s must be 0 < s < CURVE.n")}addRecoveryBit(ee){return new C(this.r,this.s,ee)}recoverPublicKey(ee){const{r:ne,s:B,recovery:z}=this,$=I(yi("msgHash",ee));if(z==null||![0,1,2,3].includes(z))throw new Error("recovery id invalid");const V=z===2||z===3?ne+e.n:ne;if(V>=t.ORDER)throw new Error("recovery id 2 or 3 invalid");const Z=(z&1)===0?"02":"03",ae=f.fromHex(Z+v(V)),Ae=c(V),be=u(-$*Ae),Ge=u(B*Ae),Te=f.BASE.multiplyAndAddUnsafe(ae,be,Ge);if(!Te)throw new Error("point at infinify");return Te.assertValidity(),Te}hasHighS(){return b(this.s)}normalizeS(){return this.hasHighS()?new C(this.r,u(-this.s),this.recovery):this}toDERRawBytes(){return Oc(this.toDERHex())}toDERHex(){return _l.hexFromSig({r:this.r,s:this.s})}toCompactRawBytes(){return Oc(this.toCompactHex())}toCompactHex(){return v(this.r)+v(this.s)}}const S={isValidPrivateKey(q){try{return d(q),!0}catch{return!1}},normPrivateKeyToScalar:d,randomPrivateKey:()=>{const q=OC(e.n);return rM(e.randomBytes(q),e.n)},precompute(q=8,ee=f.BASE){return ee._setWindowSize(q),ee.multiply(BigInt(3)),ee}};function x(q,ee=!0){return f.fromPrivateKey(q).toRawBytes(ee)}function k(q){const ee=q instanceof Uint8Array,ne=typeof q=="string",B=(ee||ne)&&q.length;return ee?B===s||B===a:ne?B===2*s||B===2*a:q instanceof f}function A(q,ee,ne=!0){if(k(q))throw new Error("first arg must be private key");if(!k(ee))throw new Error("second arg must be public key");return f.fromHex(ee).multiply(d(q)).toRawBytes(ne)}const R=e.bits2int||function(q){const ee=Ui(q),ne=q.length*8-e.nBitLength;return ne>0?ee>>BigInt(ne):ee},I=e.bits2int_modN||function(q){return u(R(q))},U=xb(e.nBitLength);function te(q){if(typeof q!="bigint")throw new Error("bigint expected");if(!(Ao<=q&&q<U))throw new Error(`bigint expected < 2^${e.nBitLength}`);return Ua(q,e.nByteLength)}function G(q,ee,ne=Y){if(["recovered","canonical"].some(ke=>ke in ne))throw new Error("sign() legacy options not supported");const{hash:B,randomBytes:z}=e;let{lowS:$,prehash:V,extraEntropy:Z}=ne;$==null&&($=!0),q=yi("msgHash",q),V&&(q=yi("prehashed msgHash",B(q)));const ae=I(q),Ae=d(ee),be=[te(Ae),te(ae)];if(Z!=null){const ke=Z===!0?z(t.BYTES):Z;be.push(yi("extraEntropy",ke))}const Ge=kl(...be),Te=ae;function ve(ke){const Me=R(ke);if(!m(Me))return;const Ie=c(Me),Ce=f.BASE.multiply(Me).toAffine(),ot=u(Ce.x);if(ot===Ao)return;const et=u(Ie*u(Te+ot*Ae));if(et===Ao)return;let me=(Ce.x===ot?0:2)|Number(Ce.y&ss),de=et;return $&&b(et)&&(de=y(et),me^=1),new C(ot,de,me)}return{seed:Ge,k2sig:ve}}const Y={lowS:e.lowS,prehash:!1},O={lowS:e.lowS,prehash:!1};function N(q,ee,ne=Y){const{seed:B,k2sig:z}=G(q,ee,ne),$=e;return MC($.hash.outputLen,$.nByteLength,$.hmac)(B,z)}f.BASE._setWindowSize(8);function Q(q,ee,ne,B=O){const z=q;if(ee=yi("msgHash",ee),ne=yi("publicKey",ne),"strict"in B)throw new Error("options.strict was renamed to lowS");const{lowS:$,prehash:V}=B;let Z,ae;try{if(typeof z=="string"||z instanceof Uint8Array)try{Z=C.fromDER(z)}catch(Ce){if(!(Ce instanceof _l.Err))throw Ce;Z=C.fromCompact(z)}else if(typeof z=="object"&&typeof z.r=="bigint"&&typeof z.s=="bigint"){const{r:Ce,s:ot}=z;Z=new C(Ce,ot)}else throw new Error("PARSE");ae=f.fromHex(ne)}catch(Ce){if(Ce.message==="PARSE")throw new Error("signature must be Signature instance, Uint8Array or hex string");return!1}if($&&Z.hasHighS())return!1;V&&(ee=e.hash(ee));const{r:Ae,s:be}=Z,Ge=I(ee),Te=c(be),ve=u(Ge*Te),ke=u(Ae*Te),Me=f.BASE.multiplyAndAddUnsafe(ae,ve,ke)?.toAffine();return Me?u(Me.x)===Ae:!1}return{CURVE:e,getPublicKey:x,getSharedSecret:A,sign:N,verify:Q,ProjectivePoint:f,Signature:C,utils:S}}let BC=class extends CC{constructor(e,t){super(),this.finished=!1,this.destroyed=!1,A8(e);const n=yb(t);if(this.iHash=e.create(),typeof this.iHash.update!="function")throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const s=this.blockLen,a=new Uint8Array(s);a.set(n.length>s?e.create().update(n).digest():n);for(let l=0;l<a.length;l++)a[l]^=54;this.iHash.update(a),this.oHash=e.create();for(let l=0;l<a.length;l++)a[l]^=106;this.oHash.update(a),a.fill(0)}update(e){return od(this),this.iHash.update(e),this}digestInto(e){od(this),SC(e,this.outputLen),this.finished=!0,this.iHash.digestInto(e),this.oHash.update(e),this.oHash.digestInto(e),this.destroy()}digest(){const e=new Uint8Array(this.oHash.outputLen);return this.digestInto(e),e}_cloneInto(e){e||(e=Object.create(Object.getPrototypeOf(this),{}));const{oHash:t,iHash:n,finished:s,destroyed:a,blockLen:l,outputLen:u}=this;return e=e,e.finished=s,e.destroyed=a,e.blockLen=l,e.outputLen=u,e.oHash=t._cloneInto(e.oHash),e.iHash=n._cloneInto(e.iHash),e}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}};const jC=(i,e,t)=>new BC(i,e).update(t).digest();jC.create=(i,e)=>new BC(i,e);function hM(i){return{hash:i,hmac:(e,...t)=>jC(i,e,I8(...t)),randomBytes:AC}}function dM(i,e){const t=n=>fM({...i,...hM(n)});return Object.freeze({...t(e),create:t})}const Ad=BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),ad=BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),DC=BigInt(1),ld=BigInt(2),f2=(i,e)=>(i+e/ld)/e;function PC(i){const e=Ad,t=BigInt(3),n=BigInt(6),s=BigInt(11),a=BigInt(22),l=BigInt(23),u=BigInt(44),c=BigInt(88),f=i*i*i%e,d=f*f*i%e,p=rs(d,t,e)*d%e,m=rs(p,t,e)*d%e,v=rs(m,ld,e)*f%e,b=rs(v,s,e)*v%e,y=rs(b,a,e)*b%e,w=rs(y,u,e)*y%e,C=rs(w,c,e)*w%e,S=rs(C,u,e)*y%e,x=rs(S,t,e)*d%e,k=rs(x,l,e)*b%e,A=rs(k,n,e)*f%e,R=rs(A,ld,e);if(!Ay.eql(Ay.sqr(R),i))throw new Error("Cannot find square root");return R}const Ay=nM(Ad,void 0,void 0,{sqrt:PC}),Uc=dM({a:BigInt(0),b:BigInt(7),Fp:Ay,n:ad,Gx:BigInt("55066263022277343669578718895168534326250603453777594175500187360389116729240"),Gy:BigInt("32670510020758816978083085130507043184471273380659243275938904335757337482424"),h:BigInt(1),lowS:!0,endo:{beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),splitScalar:i=>{const e=ad,t=BigInt("0x3086d221a7d46bcde86c90e49284eb15"),n=-DC*BigInt("0xe4437ed6010e88286f547fa90abfe4c3"),s=BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),a=t,l=BigInt("0x100000000000000000000000000000000"),u=f2(a*i,e),c=f2(-n*i,e);let f=ci(i-u*t-c*s,e),d=ci(-u*n-c*a,e);const p=f>l,m=d>l;if(p&&(f=e-f),m&&(d=e-d),f>l||d>l)throw new Error("splitScalar: Endomorphism failed, k="+i);return{k1neg:p,k1:f,k2neg:m,k2:d}}}},Sy),kd=BigInt(0),LC=i=>typeof i=="bigint"&&kd<i&&i<Ad,pM=i=>typeof i=="bigint"&&kd<i&&i<ad,h2={};function cd(i,...e){let t=h2[i];if(t===void 0){const n=Sy(Uint8Array.from(i,s=>s.charCodeAt(0)));t=kl(n,n),h2[i]=t}return Sy(kl(t,...e))}const _b=i=>i.toRawBytes(!0).slice(1),ky=i=>Ua(i,32),Wg=i=>ci(i,Ad),$u=i=>ci(i,ad),Sb=Uc.ProjectivePoint,gM=(i,e,t)=>Sb.BASE.multiplyAndAddUnsafe(i,e,t);function Ty(i){let e=Uc.utils.normPrivateKeyToScalar(i),t=Sb.fromPrivateKey(e);return{scalar:t.hasEvenY()?e:$u(-e),bytes:_b(t)}}function UC(i){if(!LC(i))throw new Error("bad x: need 0 < x < p");const e=Wg(i*i),t=Wg(e*i+BigInt(7));let n=PC(t);n%ld!==kd&&(n=Wg(-n));const s=new Sb(i,n,DC);return s.assertValidity(),s}function qC(...i){return $u(Ui(cd("BIP0340/challenge",...i)))}function mM(i){return Ty(i).bytes}function yM(i,e,t=AC(32)){const n=yi("message",i),{bytes:s,scalar:a}=Ty(e),l=yi("auxRand",t,32),u=ky(a^Ui(cd("BIP0340/aux",l))),c=cd("BIP0340/nonce",u,s,n),f=$u(Ui(c));if(f===kd)throw new Error("sign failed: k is zero");const{bytes:d,scalar:p}=Ty(f),m=qC(d,s,n),v=new Uint8Array(64);if(v.set(d,0),v.set(ky($u(p+m*a)),32),!FC(v,n,s))throw new Error("sign: Invalid signature produced");return v}function FC(i,e,t){const n=yi("signature",i,64),s=yi("message",e),a=yi("publicKey",t,32);try{const l=UC(Ui(a)),u=Ui(n.subarray(0,32));if(!LC(u))return!1;const c=Ui(n.subarray(32,64));if(!pM(c))return!1;const f=qC(ky(u),_b(l),s),d=gM(l,c,$u(-f));return!(!d||!d.hasEvenY()||d.toAffine().x!==u)}catch{return!1}}const Ou={getPublicKey:mM,sign:yM,verify:FC,utils:{randomPrivateKey:Uc.utils.randomPrivateKey,lift_x:UC,pointToBytes:_b,numberToBytesBE:Ua,bytesToNumberBE:Ui,taggedHash:cd,mod:ci}},Qg=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;const Eb=i=>i instanceof Uint8Array,Jg=i=>new DataView(i.buffer,i.byteOffset,i.byteLength),Us=(i,e)=>i<<32-e|i>>>e,bM=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;if(!bM)throw new Error("Non little-endian hardware is not supported");const vM=Array.from({length:256},(i,e)=>e.toString(16).padStart(2,"0"));function vi(i){if(!Eb(i))throw new Error("Uint8Array expected");let e="";for(let t=0;t<i.length;t++)e+=vM[i[t]];return e}function Tl(i){if(typeof i!="string")throw new Error("hex string expected, got "+typeof i);const e=i.length;if(e%2)throw new Error("padded hex string expected, got unpadded hex of length "+e);const t=new Uint8Array(e/2);for(let n=0;n<t.length;n++){const s=n*2,a=i.slice(s,s+2),l=Number.parseInt(a,16);if(Number.isNaN(l)||l<0)throw new Error("Invalid byte sequence");t[n]=l}return t}function wM(i){if(typeof i!="string")throw new Error(`utf8ToBytes expected string, got ${typeof i}`);return new Uint8Array(new TextEncoder().encode(i))}function Yu(i){if(typeof i=="string"&&(i=wM(i)),!Eb(i))throw new Error(`expected Uint8Array, got ${typeof i}`);return i}function Td(...i){const e=new Uint8Array(i.reduce((n,s)=>n+s.length,0));let t=0;return i.forEach(n=>{if(!Eb(n))throw new Error("Uint8Array expected");e.set(n,t),t+=n.length}),e}class HC{clone(){return this._cloneInto()}}function zC(i){const e=n=>i().update(Yu(n)).digest(),t=i();return e.outputLen=t.outputLen,e.blockLen=t.blockLen,e.create=()=>i(),e}function GC(i=32){if(Qg&&typeof Qg.getRandomValues=="function")return Qg.getRandomValues(new Uint8Array(i));throw new Error("crypto.getRandomValues must be defined")}function My(i){if(!Number.isSafeInteger(i)||i<0)throw new Error(`Wrong positive integer: ${i}`)}function xM(i){if(typeof i!="boolean")throw new Error(`Expected boolean, not ${i}`)}function KC(i,...e){if(!(i instanceof Uint8Array))throw new Error("Expected Uint8Array");if(e.length>0&&!e.includes(i.length))throw new Error(`Expected Uint8Array of length ${e}, not of length=${i.length}`)}function _M(i){if(typeof i!="function"||typeof i.create!="function")throw new Error("Hash should be wrapped by utils.wrapConstructor");My(i.outputLen),My(i.blockLen)}function SM(i,e=!0){if(i.destroyed)throw new Error("Hash instance has been destroyed");if(e&&i.finished)throw new Error("Hash#digest() has already been called")}function EM(i,e){KC(i);const t=e.outputLen;if(i.length<t)throw new Error(`digestInto() expects output buffer of length at least ${t}`)}const Gs={number:My,bool:xM,bytes:KC,hash:_M,exists:SM,output:EM};function CM(i,e,t,n){if(typeof i.setBigUint64=="function")return i.setBigUint64(e,t,n);const s=BigInt(32),a=BigInt(4294967295),l=Number(t>>s&a),u=Number(t&a),c=n?4:0,f=n?0:4;i.setUint32(e+c,l,n),i.setUint32(e+f,u,n)}class AM extends HC{constructor(e,t,n,s){super(),this.blockLen=e,this.outputLen=t,this.padOffset=n,this.isLE=s,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(e),this.view=Jg(this.buffer)}update(e){Gs.exists(this);const{view:t,buffer:n,blockLen:s}=this;e=Yu(e);const a=e.length;for(let l=0;l<a;){const u=Math.min(s-this.pos,a-l);if(u===s){const c=Jg(e);for(;s<=a-l;l+=s)this.process(c,l);continue}n.set(e.subarray(l,l+u),this.pos),this.pos+=u,l+=u,this.pos===s&&(this.process(t,0),this.pos=0)}return this.length+=e.length,this.roundClean(),this}digestInto(e){Gs.exists(this),Gs.output(e,this),this.finished=!0;const{buffer:t,view:n,blockLen:s,isLE:a}=this;let{pos:l}=this;t[l++]=128,this.buffer.subarray(l).fill(0),this.padOffset>s-l&&(this.process(n,0),l=0);for(let p=l;p<s;p++)t[p]=0;CM(n,s-8,BigInt(this.length*8),a),this.process(n,0);const u=Jg(e),c=this.outputLen;if(c%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const f=c/4,d=this.get();if(f>d.length)throw new Error("_sha2: outputLen bigger than state");for(let p=0;p<f;p++)u.setUint32(4*p,d[p],a)}digest(){const{buffer:e,outputLen:t}=this;this.digestInto(e);const n=e.slice(0,t);return this.destroy(),n}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());const{blockLen:t,buffer:n,length:s,finished:a,destroyed:l,pos:u}=this;return e.length=s,e.pos=u,e.finished=a,e.destroyed=l,s%t&&e.buffer.set(n),e}}const kM=(i,e,t)=>i&e^~i&t,TM=(i,e,t)=>i&e^i&t^e&t,MM=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),Ta=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),Ma=new Uint32Array(64);class VC extends AM{constructor(){super(64,32,8,!1),this.A=Ta[0]|0,this.B=Ta[1]|0,this.C=Ta[2]|0,this.D=Ta[3]|0,this.E=Ta[4]|0,this.F=Ta[5]|0,this.G=Ta[6]|0,this.H=Ta[7]|0}get(){const{A:e,B:t,C:n,D:s,E:a,F:l,G:u,H:c}=this;return[e,t,n,s,a,l,u,c]}set(e,t,n,s,a,l,u,c){this.A=e|0,this.B=t|0,this.C=n|0,this.D=s|0,this.E=a|0,this.F=l|0,this.G=u|0,this.H=c|0}process(e,t){for(let p=0;p<16;p++,t+=4)Ma[p]=e.getUint32(t,!1);for(let p=16;p<64;p++){const m=Ma[p-15],v=Ma[p-2],b=Us(m,7)^Us(m,18)^m>>>3,y=Us(v,17)^Us(v,19)^v>>>10;Ma[p]=y+Ma[p-7]+b+Ma[p-16]|0}let{A:n,B:s,C:a,D:l,E:u,F:c,G:f,H:d}=this;for(let p=0;p<64;p++){const m=Us(u,6)^Us(u,11)^Us(u,25),v=d+m+kM(u,c,f)+MM[p]+Ma[p]|0,y=(Us(n,2)^Us(n,13)^Us(n,22))+TM(n,s,a)|0;d=f,f=c,c=u,u=l+v|0,l=a,a=s,s=n,n=v+y|0}n=n+this.A|0,s=s+this.B|0,a=a+this.C|0,l=l+this.D|0,u=u+this.E|0,c=c+this.F|0,f=f+this.G|0,d=d+this.H|0,this.set(n,s,a,l,u,c,f,d)}roundClean(){Ma.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}}class IM extends VC{constructor(){super(),this.A=-1056596264,this.B=914150663,this.C=812702999,this.D=-150054599,this.E=-4191439,this.F=1750603025,this.G=1694076839,this.H=-1090891868,this.outputLen=28}}const Dl=zC(()=>new VC);zC(()=>new IM);function qc(i){if(!Number.isSafeInteger(i))throw new Error(`Wrong integer: ${i}`)}function Po(...i){const e=(s,a)=>l=>s(a(l)),t=Array.from(i).reverse().reduce((s,a)=>s?e(s,a.encode):a.encode,void 0),n=i.reduce((s,a)=>s?e(s,a.decode):a.decode,void 0);return{encode:t,decode:n}}function Lo(i){return{encode:e=>{if(!Array.isArray(e)||e.length&&typeof e[0]!="number")throw new Error("alphabet.encode input should be an array of numbers");return e.map(t=>{if(qc(t),t<0||t>=i.length)throw new Error(`Digit index outside alphabet: ${t} (alphabet: ${i.length})`);return i[t]})},decode:e=>{if(!Array.isArray(e)||e.length&&typeof e[0]!="string")throw new Error("alphabet.decode input should be array of strings");return e.map(t=>{if(typeof t!="string")throw new Error(`alphabet.decode: not string element=${t}`);const n=i.indexOf(t);if(n===-1)throw new Error(`Unknown letter: "${t}". Allowed: ${i}`);return n})}}}function Uo(i=""){if(typeof i!="string")throw new Error("join separator should be string");return{encode:e=>{if(!Array.isArray(e)||e.length&&typeof e[0]!="string")throw new Error("join.encode input should be array of strings");for(let t of e)if(typeof t!="string")throw new Error(`join.encode: non-string input=${t}`);return e.join(i)},decode:e=>{if(typeof e!="string")throw new Error("join.decode input should be string");return e.split(i)}}}function Md(i,e="="){if(qc(i),typeof e!="string")throw new Error("padding chr should be string");return{encode(t){if(!Array.isArray(t)||t.length&&typeof t[0]!="string")throw new Error("padding.encode input should be array of strings");for(let n of t)if(typeof n!="string")throw new Error(`padding.encode: non-string input=${n}`);for(;t.length*i%8;)t.push(e);return t},decode(t){if(!Array.isArray(t)||t.length&&typeof t[0]!="string")throw new Error("padding.encode input should be array of strings");for(let s of t)if(typeof s!="string")throw new Error(`padding.decode: non-string input=${s}`);let n=t.length;if(n*i%8)throw new Error("Invalid padding: string should have whole number of bytes");for(;n>0&&t[n-1]===e;n--)if(!((n-1)*i%8))throw new Error("Invalid padding: string has too much padding");return t.slice(0,n)}}}function $C(i){if(typeof i!="function")throw new Error("normalize fn should be function");return{encode:e=>e,decode:e=>i(e)}}function d2(i,e,t){if(e<2)throw new Error(`convertRadix: wrong from=${e}, base cannot be less than 2`);if(t<2)throw new Error(`convertRadix: wrong to=${t}, base cannot be less than 2`);if(!Array.isArray(i))throw new Error("convertRadix: data should be array");if(!i.length)return[];let n=0;const s=[],a=Array.from(i);for(a.forEach(l=>{if(qc(l),l<0||l>=e)throw new Error(`Wrong integer: ${l}`)});;){let l=0,u=!0;for(let c=n;c<a.length;c++){const f=a[c],d=e*l+f;if(!Number.isSafeInteger(d)||e*l/e!==l||d-f!==e*l)throw new Error("convertRadix: carry overflow");if(l=d%t,a[c]=Math.floor(d/t),!Number.isSafeInteger(a[c])||a[c]*t+l!==d)throw new Error("convertRadix: carry overflow");if(u)a[c]?u=!1:n=c;else continue}if(s.push(l),u)break}for(let l=0;l<i.length-1&&i[l]===0;l++)s.push(0);return s.reverse()}const YC=(i,e)=>e?YC(e,i%e):i,ud=(i,e)=>i+(e-YC(i,e));function Iy(i,e,t,n){if(!Array.isArray(i))throw new Error("convertRadix2: data should be array");if(e<=0||e>32)throw new Error(`convertRadix2: wrong from=${e}`);if(t<=0||t>32)throw new Error(`convertRadix2: wrong to=${t}`);if(ud(e,t)>32)throw new Error(`convertRadix2: carry overflow from=${e} to=${t} carryBits=${ud(e,t)}`);let s=0,a=0;const l=2**t-1,u=[];for(const c of i){if(qc(c),c>=2**e)throw new Error(`convertRadix2: invalid data word=${c} from=${e}`);if(s=s<<e|c,a+e>32)throw new Error(`convertRadix2: carry overflow pos=${a} from=${e}`);for(a+=e;a>=t;a-=t)u.push((s>>a-t&l)>>>0);s&=2**a-1}if(s=s<<t-a&l,!n&&a>=e)throw new Error("Excess padding");if(!n&&s)throw new Error(`Non-zero padding: ${s}`);return n&&a>0&&u.push(s>>>0),u}function RM(i){return qc(i),{encode:e=>{if(!(e instanceof Uint8Array))throw new Error("radix.encode input should be Uint8Array");return d2(Array.from(e),2**8,i)},decode:e=>{if(!Array.isArray(e)||e.length&&typeof e[0]!="number")throw new Error("radix.decode input should be array of strings");return Uint8Array.from(d2(e,i,2**8))}}}function Ha(i,e=!1){if(qc(i),i<=0||i>32)throw new Error("radix2: bits should be in (0..32]");if(ud(8,i)>32||ud(i,8)>32)throw new Error("radix2: carry overflow");return{encode:t=>{if(!(t instanceof Uint8Array))throw new Error("radix2.encode input should be Uint8Array");return Iy(Array.from(t),8,i,!e)},decode:t=>{if(!Array.isArray(t)||t.length&&typeof t[0]!="number")throw new Error("radix2.decode input should be array of strings");return Uint8Array.from(Iy(t,i,8,e))}}}function p2(i){if(typeof i!="function")throw new Error("unsafeWrapper fn should be function");return function(...e){try{return i.apply(null,e)}catch{}}}const OM=Po(Ha(4),Lo("0123456789ABCDEF"),Uo("")),NM=Po(Ha(5),Lo("ABCDEFGHIJKLMNOPQRSTUVWXYZ234567"),Md(5),Uo(""));Po(Ha(5),Lo("0123456789ABCDEFGHIJKLMNOPQRSTUV"),Md(5),Uo(""));Po(Ha(5),Lo("0123456789ABCDEFGHJKMNPQRSTVWXYZ"),Uo(""),$C(i=>i.toUpperCase().replace(/O/g,"0").replace(/[IL]/g,"1")));const Oo=Po(Ha(6),Lo("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"),Md(6),Uo("")),BM=Po(Ha(6),Lo("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_"),Md(6),Uo("")),Cb=i=>Po(RM(58),Lo(i),Uo("")),Ry=Cb("123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz");Cb("123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ");Cb("rpshnaf39wBUDNEGHJKLM4PQRST7VWXYZ2bcdeCg65jkm8oFqi1tuvAxyz");const g2=[0,2,3,5,6,7,9,10,11],jM={encode(i){let e="";for(let t=0;t<i.length;t+=8){const n=i.subarray(t,t+8);e+=Ry.encode(n).padStart(g2[n.length],"1")}return e},decode(i){let e=[];for(let t=0;t<i.length;t+=11){const n=i.slice(t,t+11),s=g2.indexOf(n.length),a=Ry.decode(n);for(let l=0;l<a.length-s;l++)if(a[l]!==0)throw new Error("base58xmr: wrong padding");e=e.concat(Array.from(a.slice(a.length-s)))}return Uint8Array.from(e)}},Oy=Po(Lo("qpzry9x8gf2tvdw0s3jn54khce6mua7l"),Uo("")),m2=[996825010,642813549,513874426,1027748829,705979059];function Nu(i){const e=i>>25;let t=(i&33554431)<<5;for(let n=0;n<m2.length;n++)(e>>n&1)===1&&(t^=m2[n]);return t}function y2(i,e,t=1){const n=i.length;let s=1;for(let a=0;a<n;a++){const l=i.charCodeAt(a);if(l<33||l>126)throw new Error(`Invalid prefix (${i})`);s=Nu(s)^l>>5}s=Nu(s);for(let a=0;a<n;a++)s=Nu(s)^i.charCodeAt(a)&31;for(let a of e)s=Nu(s)^a;for(let a=0;a<6;a++)s=Nu(s);return s^=t,Oy.encode(Iy([s%2**30],30,5,!1))}function WC(i){const e=i==="bech32"?1:734539939,t=Ha(5),n=t.decode,s=t.encode,a=p2(n);function l(d,p,m=90){if(typeof d!="string")throw new Error(`bech32.encode prefix should be string, not ${typeof d}`);if(!Array.isArray(p)||p.length&&typeof p[0]!="number")throw new Error(`bech32.encode words should be array of numbers, not ${typeof p}`);const v=d.length+7+p.length;if(m!==!1&&v>m)throw new TypeError(`Length ${v} exceeds limit ${m}`);return d=d.toLowerCase(),`${d}1${Oy.encode(p)}${y2(d,p,e)}`}function u(d,p=90){if(typeof d!="string")throw new Error(`bech32.decode input should be string, not ${typeof d}`);if(d.length<8||p!==!1&&d.length>p)throw new TypeError(`Wrong string length: ${d.length} (${d}). Expected (8..${p})`);const m=d.toLowerCase();if(d!==m&&d!==d.toUpperCase())throw new Error("String must be lowercase or uppercase");d=m;const v=d.lastIndexOf("1");if(v===0||v===-1)throw new Error('Letter "1" must be present between prefix and data only');const b=d.slice(0,v),y=d.slice(v+1);if(y.length<6)throw new Error("Data must be at least 6 characters long");const w=Oy.decode(y).slice(0,-6),C=y2(b,w,e);if(!y.endsWith(C))throw new Error(`Invalid checksum in ${d}: expected "${C}"`);return{prefix:b,words:w}}const c=p2(u);function f(d){const{prefix:p,words:m}=u(d,!1);return{prefix:p,words:m,bytes:n(m)}}return{encode:l,decode:u,decodeToBytes:f,decodeUnsafe:c,fromWords:n,fromWordsUnsafe:a,toWords:s}}const Nc=WC("bech32");WC("bech32m");const DM={encode:i=>new TextDecoder().decode(i),decode:i=>new TextEncoder().encode(i)},PM=Po(Ha(4),Lo("0123456789abcdef"),Uo(""),$C(i=>{if(typeof i!="string"||i.length%2)throw new TypeError(`hex.decode: expected string, got ${typeof i} with length ${i.length}`);return i.toLowerCase()})),LM={utf8:DM,hex:PM,base16:OM,base32:NM,base64:Oo,base64url:BM,base58:Ry,base58xmr:jM};`${Object.keys(LM).join(", ")}`;function Zg(i){if(!Number.isSafeInteger(i)||i<0)throw new Error(`positive integer expected, not ${i}`)}function b2(i){if(typeof i!="boolean")throw new Error(`boolean expected, not ${i}`)}function UM(i){return i instanceof Uint8Array||i!=null&&typeof i=="object"&&i.constructor.name==="Uint8Array"}function Ks(i,...e){if(!UM(i))throw new Error("Uint8Array expected");if(e.length>0&&!e.includes(i.length))throw new Error(`Uint8Array expected of length ${e}, not of length=${i.length}`)}const wi=i=>new Uint32Array(i.buffer,i.byteOffset,Math.floor(i.byteLength/4)),qM=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;if(!qM)throw new Error("Non little-endian hardware is not supported");const FM=Array.from({length:256},(i,e)=>e.toString(16).padStart(2,"0"));function wc(i){Ks(i);let e="";for(let t=0;t<i.length;t++)e+=FM[i[t]];return e}const bo={_0:48,_9:57,_A:65,_F:70,_a:97,_f:102};function v2(i){if(i>=bo._0&&i<=bo._9)return i-bo._0;if(i>=bo._A&&i<=bo._F)return i-(bo._A-10);if(i>=bo._a&&i<=bo._f)return i-(bo._a-10)}function QC(i){if(typeof i!="string")throw new Error("hex string expected, got "+typeof i);const e=i.length,t=e/2;if(e%2)throw new Error("padded hex string expected, got unpadded hex of length "+e);const n=new Uint8Array(t);for(let s=0,a=0;s<t;s++,a+=2){const l=v2(i.charCodeAt(a)),u=v2(i.charCodeAt(a+1));if(l===void 0||u===void 0){const c=i[a]+i[a+1];throw new Error('hex string expected, got non-hex character "'+c+'" at index '+a)}n[s]=l*16+u}return n}function HM(i,e){if(e==null||typeof e!="object")throw new Error("options must be defined");return Object.assign(i,e)}function zM(i,e){if(i.length!==e.length)return!1;let t=0;for(let n=0;n<i.length;n++)t|=i[n]^e[n];return t===0}const GM=(i,e)=>(Object.assign(e,i),e),La=16,KM=283;function Ab(i){return i<<1^KM&-(i>>7)}function Ec(i,e){let t=0;for(;e>0;e>>=1)t^=i&-(e&1),i=Ab(i);return t}const Ny=(()=>{let i=new Uint8Array(256);for(let t=0,n=1;t<256;t++,n^=Ab(n))i[t]=n;const e=new Uint8Array(256);e[0]=99;for(let t=0;t<255;t++){let n=i[255-t];n|=n<<8,e[i[t]]=(n^n>>4^n>>5^n>>6^n>>7^99)&255}return e})(),VM=Ny.map((i,e)=>Ny.indexOf(e)),$M=i=>i<<24|i>>>8,Xg=i=>i<<8|i>>>24;function JC(i,e){if(i.length!==256)throw new Error("Wrong sbox length");const t=new Uint32Array(256).map((f,d)=>e(i[d])),n=t.map(Xg),s=n.map(Xg),a=s.map(Xg),l=new Uint32Array(256*256),u=new Uint32Array(256*256),c=new Uint16Array(256*256);for(let f=0;f<256;f++)for(let d=0;d<256;d++){const p=f*256+d;l[p]=t[f]^n[d],u[p]=s[f]^a[d],c[p]=i[f]<<8|i[d]}return{sbox:i,sbox2:c,T0:t,T1:n,T2:s,T3:a,T01:l,T23:u}}const kb=JC(Ny,i=>Ec(i,3)<<24|i<<16|i<<8|Ec(i,2)),ZC=JC(VM,i=>Ec(i,11)<<24|Ec(i,13)<<16|Ec(i,9)<<8|Ec(i,14)),YM=(()=>{const i=new Uint8Array(16);for(let e=0,t=1;e<16;e++,t=Ab(t))i[e]=t;return i})();function XC(i){Ks(i);const e=i.length;if(![16,24,32].includes(e))throw new Error(`aes: wrong key size: should be 16, 24 or 32, got: ${e}`);const{sbox2:t}=kb,n=wi(i),s=n.length,a=u=>Vs(t,u,u,u,u),l=new Uint32Array(e+28);l.set(n);for(let u=s;u<l.length;u++){let c=l[u-1];u%s===0?c=a($M(c))^YM[u/s-1]:s>6&&u%s===4&&(c=a(c)),l[u]=l[u-s]^c}return l}function WM(i){const e=XC(i),t=e.slice(),n=e.length,{sbox2:s}=kb,{T0:a,T1:l,T2:u,T3:c}=ZC;for(let f=0;f<n;f+=4)for(let d=0;d<4;d++)t[f+d]=e[n-f-4+d];e.fill(0);for(let f=4;f<n-4;f++){const d=t[f],p=Vs(s,d,d,d,d);t[f]=a[p&255]^l[p>>>8&255]^u[p>>>16&255]^c[p>>>24]}return t}function ja(i,e,t,n,s,a){return i[t<<8&65280|n>>>8&255]^e[s>>>8&65280|a>>>24&255]}function Vs(i,e,t,n,s){return i[e&255|t&65280]|i[n>>>16&255|s>>>16&65280]<<16}function w2(i,e,t,n,s){const{sbox2:a,T01:l,T23:u}=kb;let c=0;e^=i[c++],t^=i[c++],n^=i[c++],s^=i[c++];const f=i.length/4-2;for(let b=0;b<f;b++){const y=i[c++]^ja(l,u,e,t,n,s),w=i[c++]^ja(l,u,t,n,s,e),C=i[c++]^ja(l,u,n,s,e,t),S=i[c++]^ja(l,u,s,e,t,n);e=y,t=w,n=C,s=S}const d=i[c++]^Vs(a,e,t,n,s),p=i[c++]^Vs(a,t,n,s,e),m=i[c++]^Vs(a,n,s,e,t),v=i[c++]^Vs(a,s,e,t,n);return{s0:d,s1:p,s2:m,s3:v}}function QM(i,e,t,n,s){const{sbox2:a,T01:l,T23:u}=ZC;let c=0;e^=i[c++],t^=i[c++],n^=i[c++],s^=i[c++];const f=i.length/4-2;for(let b=0;b<f;b++){const y=i[c++]^ja(l,u,e,s,n,t),w=i[c++]^ja(l,u,t,e,s,n),C=i[c++]^ja(l,u,n,t,e,s),S=i[c++]^ja(l,u,s,n,t,e);e=y,t=w,n=C,s=S}const d=i[c++]^Vs(a,e,s,n,t),p=i[c++]^Vs(a,t,e,s,n),m=i[c++]^Vs(a,n,t,e,s),v=i[c++]^Vs(a,s,n,t,e);return{s0:d,s1:p,s2:m,s3:v}}function eA(i,e){if(!e)return new Uint8Array(i);if(Ks(e),e.length<i)throw new Error(`aes: wrong destination length, expected at least ${i}, got: ${e.length}`);return e}function JM(i){if(Ks(i),i.length%La!==0)throw new Error(`aes/(cbc-ecb).decrypt ciphertext should consist of blocks with size ${La}`)}function ZM(i,e,t){let n=i.length;const s=n%La;if(!e&&s!==0)throw new Error("aec/(cbc-ecb): unpadded plaintext with disabled padding");const a=wi(i);if(e){let c=La-s;c||(c=La),n=n+c}const l=eA(n,t),u=wi(l);return{b:a,o:u,out:l}}function XM(i,e){if(!e)return i;const t=i.length;if(!t)throw new Error("aes/pcks5: empty ciphertext not allowed");const n=i[t-1];if(n<=0||n>16)throw new Error(`aes/pcks5: wrong padding byte: ${n}`);const s=i.subarray(0,-n);for(let a=0;a<n;a++)if(i[t-a-1]!==n)throw new Error("aes/pcks5: wrong padding");return s}function eI(i){const e=new Uint8Array(16),t=wi(e);e.set(i);const n=La-i.length;for(let s=La-n;s<La;s++)e[s]=n;return t}const tA=GM({blockSize:16,nonceLength:16},function(e,t,n={}){Ks(e),Ks(t,16);const s=!n.disablePadding;return{encrypt:(a,l)=>{const u=XC(e),{b:c,o:f,out:d}=ZM(a,s,l),p=wi(t);let m=p[0],v=p[1],b=p[2],y=p[3],w=0;for(;w+4<=c.length;)m^=c[w+0],v^=c[w+1],b^=c[w+2],y^=c[w+3],{s0:m,s1:v,s2:b,s3:y}=w2(u,m,v,b,y),f[w++]=m,f[w++]=v,f[w++]=b,f[w++]=y;if(s){const C=eI(a.subarray(w*4));m^=C[0],v^=C[1],b^=C[2],y^=C[3],{s0:m,s1:v,s2:b,s3:y}=w2(u,m,v,b,y),f[w++]=m,f[w++]=v,f[w++]=b,f[w++]=y}return u.fill(0),d},decrypt:(a,l)=>{JM(a);const u=WM(e),c=wi(t),f=eA(a.length,l),d=wi(a),p=wi(f);let m=c[0],v=c[1],b=c[2],y=c[3];for(let w=0;w+4<=d.length;){const C=m,S=v,x=b,k=y;m=d[w+0],v=d[w+1],b=d[w+2],y=d[w+3];const{s0:A,s1:R,s2:I,s3:U}=QM(u,m,v,b,y);p[w++]=A^C,p[w++]=R^S,p[w++]=I^x,p[w++]=U^k}return u.fill(0),XM(f,s)}}}),nA=i=>Uint8Array.from(i.split("").map(e=>e.charCodeAt(0))),tI=nA("expand 16-byte k"),nI=nA("expand 32-byte k"),rI=wi(tI),rA=wi(nI);rA.slice();function nr(i,e){return i<<e|i>>>32-e}function By(i){return i.byteOffset%4===0}const ih=64,iI=16,iA=2**32-1,x2=new Uint32Array;function sI(i,e,t,n,s,a,l,u){const c=s.length,f=new Uint8Array(ih),d=wi(f),p=By(s)&&By(a),m=p?wi(s):x2,v=p?wi(a):x2;for(let b=0;b<c;l++){if(i(e,t,n,d,l,u),l>=iA)throw new Error("arx: counter overflow");const y=Math.min(ih,c-b);if(p&&y===ih){const w=b/4;if(b%4!==0)throw new Error("arx: invalid block position");for(let C=0,S;C<iI;C++)S=w+C,v[S]=m[S]^d[C];b+=ih;continue}for(let w=0,C;w<y;w++)C=b+w,a[C]=s[C]^f[w];b+=y}}function oI(i,e){const{allowShortKeys:t,extendNonceFn:n,counterLength:s,counterRight:a,rounds:l}=HM({allowShortKeys:!1,counterLength:8,counterRight:!1,rounds:20},e);if(typeof i!="function")throw new Error("core must be a function");return Zg(s),Zg(l),b2(a),b2(t),(u,c,f,d,p=0)=>{Ks(u),Ks(c),Ks(f);const m=f.length;if(d||(d=new Uint8Array(m)),Ks(d),Zg(p),p<0||p>=iA)throw new Error("arx: counter overflow");if(d.length<m)throw new Error(`arx: output (${d.length}) is shorter than data (${m})`);const v=[];let b=u.length,y,w;if(b===32)y=u.slice(),v.push(y),w=rA;else if(b===16&&t)y=new Uint8Array(32),y.set(u),y.set(u,16),w=rI,v.push(y);else throw new Error(`arx: invalid 32-byte key, got length=${b}`);By(c)||(c=c.slice(),v.push(c));const C=wi(y);if(n){if(c.length!==24)throw new Error("arx: extended nonce must be 24 bytes");n(w,C,wi(c.subarray(0,16)),C),c=c.subarray(16)}const S=16-s;if(S!==c.length)throw new Error(`arx: nonce must be ${S} or 16 bytes`);if(S!==12){const k=new Uint8Array(12);k.set(c,a?0:12-c.length),c=k,v.push(c)}const x=wi(c);for(sI(i,w,C,x,f,d,p,l);v.length>0;)v.pop().fill(0);return d}}function aI(i,e,t,n,s,a=20){let l=i[0],u=i[1],c=i[2],f=i[3],d=e[0],p=e[1],m=e[2],v=e[3],b=e[4],y=e[5],w=e[6],C=e[7],S=s,x=t[0],k=t[1],A=t[2],R=l,I=u,U=c,te=f,G=d,Y=p,O=m,N=v,Q=b,q=y,ee=w,ne=C,B=S,z=x,$=k,V=A;for(let ae=0;ae<a;ae+=2)R=R+G|0,B=nr(B^R,16),Q=Q+B|0,G=nr(G^Q,12),R=R+G|0,B=nr(B^R,8),Q=Q+B|0,G=nr(G^Q,7),I=I+Y|0,z=nr(z^I,16),q=q+z|0,Y=nr(Y^q,12),I=I+Y|0,z=nr(z^I,8),q=q+z|0,Y=nr(Y^q,7),U=U+O|0,$=nr($^U,16),ee=ee+$|0,O=nr(O^ee,12),U=U+O|0,$=nr($^U,8),ee=ee+$|0,O=nr(O^ee,7),te=te+N|0,V=nr(V^te,16),ne=ne+V|0,N=nr(N^ne,12),te=te+N|0,V=nr(V^te,8),ne=ne+V|0,N=nr(N^ne,7),R=R+Y|0,V=nr(V^R,16),ee=ee+V|0,Y=nr(Y^ee,12),R=R+Y|0,V=nr(V^R,8),ee=ee+V|0,Y=nr(Y^ee,7),I=I+O|0,B=nr(B^I,16),ne=ne+B|0,O=nr(O^ne,12),I=I+O|0,B=nr(B^I,8),ne=ne+B|0,O=nr(O^ne,7),U=U+N|0,z=nr(z^U,16),Q=Q+z|0,N=nr(N^Q,12),U=U+N|0,z=nr(z^U,8),Q=Q+z|0,N=nr(N^Q,7),te=te+G|0,$=nr($^te,16),q=q+$|0,G=nr(G^q,12),te=te+G|0,$=nr($^te,8),q=q+$|0,G=nr(G^q,7);let Z=0;n[Z++]=l+R|0,n[Z++]=u+I|0,n[Z++]=c+U|0,n[Z++]=f+te|0,n[Z++]=d+G|0,n[Z++]=p+Y|0,n[Z++]=m+O|0,n[Z++]=v+N|0,n[Z++]=b+Q|0,n[Z++]=y+q|0,n[Z++]=w+ee|0,n[Z++]=C+ne|0,n[Z++]=S+B|0,n[Z++]=x+z|0,n[Z++]=k+$|0,n[Z++]=A+V|0}const sA=oI(aI,{counterRight:!1,counterLength:4,allowShortKeys:!1});class oA extends HC{constructor(e,t){super(),this.finished=!1,this.destroyed=!1,Gs.hash(e);const n=Yu(t);if(this.iHash=e.create(),typeof this.iHash.update!="function")throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const s=this.blockLen,a=new Uint8Array(s);a.set(n.length>s?e.create().update(n).digest():n);for(let l=0;l<a.length;l++)a[l]^=54;this.iHash.update(a),this.oHash=e.create();for(let l=0;l<a.length;l++)a[l]^=106;this.oHash.update(a),a.fill(0)}update(e){return Gs.exists(this),this.iHash.update(e),this}digestInto(e){Gs.exists(this),Gs.bytes(e,this.outputLen),this.finished=!0,this.iHash.digestInto(e),this.oHash.update(e),this.oHash.digestInto(e),this.destroy()}digest(){const e=new Uint8Array(this.oHash.outputLen);return this.digestInto(e),e}_cloneInto(e){e||(e=Object.create(Object.getPrototypeOf(this),{}));const{oHash:t,iHash:n,finished:s,destroyed:a,blockLen:l,outputLen:u}=this;return e=e,e.finished=s,e.destroyed=a,e.blockLen=l,e.outputLen=u,e.oHash=t._cloneInto(e.oHash),e.iHash=n._cloneInto(e.iHash),e}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}}const Id=(i,e,t)=>new oA(i,e).update(t).digest();Id.create=(i,e)=>new oA(i,e);function lI(i,e,t){return Gs.hash(i),Id(i,Yu(t),Yu(e))}const e0=new Uint8Array([0]),_2=new Uint8Array;function cI(i,e,t,n=32){if(Gs.hash(i),Gs.number(n),n>255*i.outputLen)throw new Error("Length should be <= 255*HashLen");const s=Math.ceil(n/i.outputLen);t===void 0&&(t=_2);const a=new Uint8Array(s*i.outputLen),l=Id.create(i,e),u=l._cloneInto(),c=new Uint8Array(l.outputLen);for(let f=0;f<s;f++)e0[0]=f+1,u.update(f===0?_2:c).update(t).update(e0).digestInto(c),a.set(c,i.outputLen*f),l._cloneInto(u);return l.destroy(),u.destroy(),c.fill(0),e0.fill(0),a.slice(0,n)}var uI=Object.defineProperty,Ar=(i,e)=>{for(var t in e)uI(i,t,{get:e[t],enumerable:!0})},yl=Symbol("verified"),fI=i=>i instanceof Object;function Tb(i){if(!fI(i)||typeof i.kind!="number"||typeof i.content!="string"||typeof i.created_at!="number"||typeof i.pubkey!="string"||!i.pubkey.match(/^[a-f0-9]{64}$/)||!Array.isArray(i.tags))return!1;for(let e=0;e<i.tags.length;e++){let t=i.tags[e];if(!Array.isArray(t))return!1;for(let n=0;n<t.length;n++)if(typeof t[n]!="string")return!1}return!0}var hI={};Ar(hI,{Queue:()=>lA,QueueNode:()=>aA,binarySearch:()=>Mb,bytesToHex:()=>vi,hexToBytes:()=>Tl,insertEventIntoAscendingList:()=>pI,insertEventIntoDescendingList:()=>dI,normalizeURL:()=>vl,utf8Decoder:()=>To,utf8Encoder:()=>_s});var To=new TextDecoder("utf-8"),_s=new TextEncoder;function vl(i){try{i.indexOf("://")===-1&&(i="wss://"+i);let e=new URL(i);return e.protocol==="http:"?e.protocol="ws:":e.protocol==="https:"&&(e.protocol="wss:"),e.pathname=e.pathname.replace(/\/+/g,"/"),e.pathname.endsWith("/")&&(e.pathname=e.pathname.slice(0,-1)),(e.port==="80"&&e.protocol==="ws:"||e.port==="443"&&e.protocol==="wss:")&&(e.port=""),e.searchParams.sort(),e.hash="",e.toString()}catch{throw new Error(`Invalid URL: ${i}`)}}function dI(i,e){const[t,n]=Mb(i,s=>e.id===s.id?0:e.created_at===s.created_at?-1:s.created_at-e.created_at);return n||i.splice(t,0,e),i}function pI(i,e){const[t,n]=Mb(i,s=>e.id===s.id?0:e.created_at===s.created_at?-1:e.created_at-s.created_at);return n||i.splice(t,0,e),i}function Mb(i,e){let t=0,n=i.length-1;for(;t<=n;){const s=Math.floor((t+n)/2),a=e(i[s]);if(a===0)return[s,!0];a<0?n=s-1:t=s+1}return[t,!1]}var aA=class{value;next=null;prev=null;constructor(i){this.value=i}},lA=class{first;last;constructor(){this.first=null,this.last=null}enqueue(i){const e=new aA(i);return this.last?this.last===this.first?(this.last=e,this.last.prev=this.first,this.first.next=e):(e.prev=this.last,this.last.next=e,this.last=e):(this.first=e,this.last=e),!0}dequeue(){if(!this.first)return null;if(this.first===this.last){const e=this.first;return this.first=null,this.last=null,e.value}const i=this.first;return this.first=i.next,this.first&&(this.first.prev=null),i.value}},gI=class{generateSecretKey(){return Ou.utils.randomPrivateKey()}getPublicKey(i){return vi(Ou.getPublicKey(i))}finalizeEvent(i,e){const t=i;return t.pubkey=vi(Ou.getPublicKey(e)),t.id=Gh(t),t.sig=vi(Ou.sign(Gh(t),e)),t[yl]=!0,t}verifyEvent(i){if(typeof i[yl]=="boolean")return i[yl];const e=Gh(i);if(e!==i.id)return i[yl]=!1,!1;try{const t=Ou.verify(i.sig,e,i.pubkey);return i[yl]=t,t}catch{return i[yl]=!1,!1}}};function mI(i){if(!Tb(i))throw new Error("can't serialize event with wrong or missing properties");return JSON.stringify([0,i.pubkey,i.created_at,i.kind,i.tags,i.content])}function Gh(i){let e=Dl(_s.encode(mI(i)));return vi(e)}var Rd=new gI,yI=Rd.generateSecretKey,Ib=Rd.getPublicKey,Es=Rd.finalizeEvent,Od=Rd.verifyEvent,bI={};Ar(bI,{Application:()=>yR,BadgeAward:()=>AI,BadgeDefinition:()=>uR,BlockedRelaysList:()=>YI,BookmarkList:()=>KI,Bookmarksets:()=>aR,Calendar:()=>ER,CalendarEventRSVP:()=>CR,ChannelCreation:()=>pA,ChannelHideMessage:()=>yA,ChannelMessage:()=>mA,ChannelMetadata:()=>gA,ChannelMuteUser:()=>bA,ClassifiedListing:()=>wR,ClientAuth:()=>wA,CommunitiesList:()=>VI,CommunityDefinition:()=>TR,CommunityPostApproval:()=>BI,Contacts:()=>SI,CreateOrUpdateProduct:()=>dR,CreateOrUpdateStall:()=>hR,Curationsets:()=>lR,Date:()=>_R,DirectMessageRelaysList:()=>ZI,DraftClassifiedListing:()=>xR,DraftLong:()=>gR,Emojisets:()=>mR,EncryptedDirectMessage:()=>EI,EventDeletion:()=>CI,FileMetadata:()=>TI,FileServerPreference:()=>XI,Followsets:()=>iR,GenericRepost:()=>jb,Genericlists:()=>sR,GiftWrap:()=>vA,HTTPAuth:()=>Db,Handlerinformation:()=>kR,Handlerrecommendation:()=>AR,Highlights:()=>FI,InterestsList:()=>QI,Interestsets:()=>fR,JobFeedback:()=>PI,JobRequest:()=>jI,JobResult:()=>DI,Label:()=>NI,LightningPubRPC:()=>tR,LiveChatMessage:()=>MI,LiveEvent:()=>bR,LongFormArticle:()=>pR,Metadata:()=>xI,Mutelist:()=>HI,NWCWalletInfo:()=>eR,NWCWalletRequest:()=>xA,NWCWalletResponse:()=>nR,NostrConnect:()=>rR,OpenTimestamps:()=>kI,Pinlist:()=>zI,PrivateDirectMessage:()=>dA,ProblemTracker:()=>II,ProfileBadges:()=>cR,PublicChatsList:()=>$I,Reaction:()=>Bb,RecommendRelay:()=>_I,RelayList:()=>GI,Relaysets:()=>oR,Report:()=>RI,Reporting:()=>OI,Repost:()=>Nb,Seal:()=>hA,SearchRelaysList:()=>WI,ShortTextNote:()=>fA,Time:()=>SR,UserEmojiList:()=>JI,UserStatuses:()=>vR,Zap:()=>qI,ZapGoal:()=>LI,ZapRequest:()=>UI,classifyKind:()=>vI,isAddressableKind:()=>Ob,isEphemeralKind:()=>uA,isKind:()=>wI,isRegularKind:()=>cA,isReplaceableKind:()=>Rb});function cA(i){return i<1e4&&i!==0&&i!==3}function Rb(i){return i===0||i===3||1e4<=i&&i<2e4}function uA(i){return 2e4<=i&&i<3e4}function Ob(i){return 3e4<=i&&i<4e4}function vI(i){return cA(i)?"regular":Rb(i)?"replaceable":uA(i)?"ephemeral":Ob(i)?"parameterized":"unknown"}function wI(i,e){const t=e instanceof Array?e:[e];return Tb(i)&&t.includes(i.kind)||!1}var xI=0,fA=1,_I=2,SI=3,EI=4,CI=5,Nb=6,Bb=7,AI=8,hA=13,dA=14,jb=16,pA=40,gA=41,mA=42,yA=43,bA=44,kI=1040,vA=1059,TI=1063,MI=1311,II=1971,RI=1984,OI=1984,NI=1985,BI=4550,jI=5999,DI=6999,PI=7e3,LI=9041,UI=9734,qI=9735,FI=9802,HI=1e4,zI=10001,GI=10002,KI=10003,VI=10004,$I=10005,YI=10006,WI=10007,QI=10015,JI=10030,ZI=10050,XI=10096,eR=13194,tR=21e3,wA=22242,xA=23194,nR=23195,rR=24133,Db=27235,iR=3e4,sR=30001,oR=30002,aR=30003,lR=30004,cR=30008,uR=30009,fR=30015,hR=30017,dR=30018,pR=30023,gR=30024,mR=30030,yR=30078,bR=30311,vR=30315,wR=30402,xR=30403,_R=31922,SR=31923,ER=31924,CR=31925,AR=31989,kR=31990,TR=34550;function MR(i,e){if(i.ids&&i.ids.indexOf(e.id)===-1||i.kinds&&i.kinds.indexOf(e.kind)===-1||i.authors&&i.authors.indexOf(e.pubkey)===-1)return!1;for(let t in i)if(t[0]==="#"){let n=t.slice(1),s=i[`#${n}`];if(s&&!e.tags.find(([a,l])=>a===t.slice(1)&&s.indexOf(l)!==-1))return!1}return!(i.since&&e.created_at<i.since||i.until&&e.created_at>i.until)}function IR(i,e){for(let t=0;t<i.length;t++)if(MR(i[t],e))return!0;return!1}var RR={};Ar(RR,{getHex64:()=>Nd,getInt:()=>_A,getSubscriptionId:()=>SA,matchEventId:()=>OR,matchEventKind:()=>BR,matchEventPubkey:()=>NR});function Nd(i,e){let t=e.length+3,n=i.indexOf(`"${e}":`)+t,s=i.slice(n).indexOf('"')+n+1;return i.slice(s,s+64)}function _A(i,e){let t=e.length,n=i.indexOf(`"${e}":`)+t+3,s=i.slice(n),a=Math.min(s.indexOf(","),s.indexOf("}"));return parseInt(s.slice(0,a),10)}function SA(i){let e=i.slice(0,22).indexOf('"EVENT"');if(e===-1)return null;let t=i.slice(e+7+1).indexOf('"');if(t===-1)return null;let n=e+7+1+t,s=i.slice(n+1,80).indexOf('"');if(s===-1)return null;let a=n+1+s;return i.slice(n+1,a)}function OR(i,e){return e===Nd(i,"id")}function NR(i,e){return e===Nd(i,"pubkey")}function BR(i,e){return e===_A(i,"kind")}var jR={};Ar(jR,{makeAuthEvent:()=>EA});function EA(i,e){return{kind:wA,created_at:Math.floor(Date.now()/1e3),tags:[["relay",i],["challenge",e]],content:""}}async function DR(){return new Promise((i,e)=>{try{if(typeof MessageChannel<"u"){const t=new MessageChannel,n=()=>{t.port1.removeEventListener("message",n),i()};t.port1.addEventListener("message",n),t.port2.postMessage(0),t.port1.start()}else typeof setImmediate<"u"?setImmediate(i):typeof setTimeout<"u"?setTimeout(i,0):i()}catch(t){console.error("during yield: ",t),e(t)}})}var PR=i=>(i[yl]=!0,!0),CA=class extends Error{constructor(i,e){super(`Tried to send message '${i} on a closed connection to ${e}.`),this.name="SendingOnClosedConnection"}},AA=class{url;_connected=!1;onclose=null;onnotice=i=>console.debug(`NOTICE from ${this.url}: ${i}`);onauth;baseEoseTimeout=4400;connectionTimeout=4400;publishTimeout=4400;pingFrequency=29e3;pingTimeout=2e4;resubscribeBackoff=[1e4,1e4,1e4,2e4,2e4,3e4,6e4];openSubs=new Map;enablePing;enableReconnect;connectionTimeoutHandle;reconnectTimeoutHandle;pingIntervalHandle;reconnectAttempts=0;closedIntentionally=!1;connectionPromise;openCountRequests=new Map;openEventPublishes=new Map;ws;incomingMessageQueue=new lA;queueRunning=!1;challenge;authPromise;serial=0;verifyEvent;_WebSocket;constructor(i,e){this.url=vl(i),this.verifyEvent=e.verifyEvent,this._WebSocket=e.websocketImplementation||WebSocket,this.enablePing=e.enablePing,this.enableReconnect=e.enableReconnect||!1}static async connect(i,e){const t=new AA(i,e);return await t.connect(),t}closeAllSubscriptions(i){for(let[e,t]of this.openSubs)t.close(i);this.openSubs.clear();for(let[e,t]of this.openEventPublishes)t.reject(new Error(i));this.openEventPublishes.clear();for(let[e,t]of this.openCountRequests)t.reject(new Error(i));this.openCountRequests.clear()}get connected(){return this._connected}async reconnect(){const i=this.resubscribeBackoff[Math.min(this.reconnectAttempts,this.resubscribeBackoff.length-1)];this.reconnectAttempts++,this.reconnectTimeoutHandle=setTimeout(async()=>{try{await this.connect()}catch{}},i)}handleHardClose(i){this.pingIntervalHandle&&(clearInterval(this.pingIntervalHandle),this.pingIntervalHandle=void 0),this._connected=!1,this.connectionPromise=void 0;const e=this.closedIntentionally;this.closedIntentionally=!1,this.onclose?.(),this.enableReconnect&&!e?this.reconnect():this.closeAllSubscriptions(i)}async connect(){return this.connectionPromise?this.connectionPromise:(this.challenge=void 0,this.authPromise=void 0,this.connectionPromise=new Promise((i,e)=>{this.connectionTimeoutHandle=setTimeout(()=>{e("connection timed out"),this.connectionPromise=void 0,this.onclose?.(),this.closeAllSubscriptions("relay connection timed out")},this.connectionTimeout);try{this.ws=new this._WebSocket(this.url)}catch(t){clearTimeout(this.connectionTimeoutHandle),e(t);return}this.ws.onopen=()=>{this.reconnectTimeoutHandle&&(clearTimeout(this.reconnectTimeoutHandle),this.reconnectTimeoutHandle=void 0),clearTimeout(this.connectionTimeoutHandle),this._connected=!0;const t=this.reconnectAttempts>0;this.reconnectAttempts=0;for(const n of this.openSubs.values()){if(n.eosed=!1,t)for(let s=0;s<n.filters.length;s++)n.lastEmitted&&(n.filters[s].since=n.lastEmitted+1);n.fire()}this.enablePing&&(this.pingIntervalHandle=setInterval(()=>this.pingpong(),this.pingFrequency)),i()},this.ws.onerror=t=>{clearTimeout(this.connectionTimeoutHandle),e(t.message||"websocket error"),this.handleHardClose("relay connection errored")},this.ws.onclose=t=>{clearTimeout(this.connectionTimeoutHandle),e(t.message||"websocket closed"),this.handleHardClose("relay connection closed")},this.ws.onmessage=this._onmessage.bind(this)}),this.connectionPromise)}waitForPingPong(){return new Promise(i=>{this.ws.once("pong",()=>i(!0)),this.ws.ping()})}waitForDummyReq(){return new Promise((i,e)=>{if(!this.connectionPromise)return e(new Error(`no connection to ${this.url}, can't ping`));try{const t=this.subscribe([{ids:["aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa"],limit:0}],{oneose:()=>{i(!0),t.close()},onclose(){i(!0)},eoseTimeout:this.pingTimeout+1e3})}catch(t){e(t)}})}async pingpong(){this.ws?.readyState===1&&(await Promise.any([this.ws&&this.ws.ping&&this.ws.once?this.waitForPingPong():this.waitForDummyReq(),new Promise(e=>setTimeout(()=>e(!1),this.pingTimeout))])||this.ws?.readyState===this._WebSocket.OPEN&&this.ws?.close())}async runQueue(){for(this.queueRunning=!0;this.handleNext()!==!1;)await DR();this.queueRunning=!1}handleNext(){const i=this.incomingMessageQueue.dequeue();if(!i)return!1;const e=SA(i);if(e){const t=this.openSubs.get(e);if(!t)return;const n=Nd(i,"id"),s=t.alreadyHaveEvent?.(n);if(t.receivedEvent?.(this,n),s)return}try{let t=JSON.parse(i);switch(t[0]){case"EVENT":{const n=this.openSubs.get(t[1]),s=t[2];this.verifyEvent(s)&&IR(n.filters,s)&&n.onevent(s),(!n.lastEmitted||n.lastEmitted<s.created_at)&&(n.lastEmitted=s.created_at);return}case"COUNT":{const n=t[1],s=t[2],a=this.openCountRequests.get(n);a&&(a.resolve(s.count),this.openCountRequests.delete(n));return}case"EOSE":{const n=this.openSubs.get(t[1]);if(!n)return;n.receivedEose();return}case"OK":{const n=t[1],s=t[2],a=t[3],l=this.openEventPublishes.get(n);l&&(clearTimeout(l.timeout),s?l.resolve(a):l.reject(new Error(a)),this.openEventPublishes.delete(n));return}case"CLOSED":{const n=t[1],s=this.openSubs.get(n);if(!s)return;s.closed=!0,s.close(t[2]);return}case"NOTICE":{this.onnotice(t[1]);return}case"AUTH":{this.challenge=t[1],this.onauth&&this.auth(this.onauth);return}default:{this.openSubs.get(t[1])?.oncustom?.(t);return}}}catch{return}}async send(i){if(!this.connectionPromise)throw new CA(i,this.url);this.connectionPromise.then(()=>{this.ws?.send(i)})}async auth(i){const e=this.challenge;if(!e)throw new Error("can't perform auth, no challenge was received");return this.authPromise?this.authPromise:(this.authPromise=new Promise(async(t,n)=>{try{let s=await i(EA(this.url,e)),a=setTimeout(()=>{let l=this.openEventPublishes.get(s.id);l&&(l.reject(new Error("auth timed out")),this.openEventPublishes.delete(s.id))},this.publishTimeout);this.openEventPublishes.set(s.id,{resolve:t,reject:n,timeout:a}),this.send('["AUTH",'+JSON.stringify(s)+"]")}catch(s){console.warn("subscribe auth function failed:",s)}}),this.authPromise)}async publish(i){const e=new Promise((t,n)=>{const s=setTimeout(()=>{const a=this.openEventPublishes.get(i.id);a&&(a.reject(new Error("publish timed out")),this.openEventPublishes.delete(i.id))},this.publishTimeout);this.openEventPublishes.set(i.id,{resolve:t,reject:n,timeout:s})});return this.send('["EVENT",'+JSON.stringify(i)+"]"),e}async count(i,e){this.serial++;const t=e?.id||"count:"+this.serial,n=new Promise((s,a)=>{this.openCountRequests.set(t,{resolve:s,reject:a})});return this.send('["COUNT","'+t+'",'+JSON.stringify(i).substring(1)),n}subscribe(i,e){const t=this.prepareSubscription(i,e);return t.fire(),t}prepareSubscription(i,e){this.serial++;const t=e.id||(e.label?e.label+":":"sub:")+this.serial,n=new LR(this,t,i,e);return this.openSubs.set(t,n),n}close(){this.closedIntentionally=!0,this.reconnectTimeoutHandle&&(clearTimeout(this.reconnectTimeoutHandle),this.reconnectTimeoutHandle=void 0),this.pingIntervalHandle&&(clearInterval(this.pingIntervalHandle),this.pingIntervalHandle=void 0),this.closeAllSubscriptions("relay connection closed by us"),this._connected=!1,this.onclose?.(),this.ws?.readyState===this._WebSocket.OPEN&&this.ws?.close()}_onmessage(i){this.incomingMessageQueue.enqueue(i.data),this.queueRunning||this.runQueue()}},LR=class{relay;id;lastEmitted;closed=!1;eosed=!1;filters;alreadyHaveEvent;receivedEvent;onevent;oneose;onclose;oncustom;eoseTimeout;eoseTimeoutHandle;constructor(i,e,t,n){if(t.length===0)throw new Error("subscription can't be created with zero filters");this.relay=i,this.filters=t,this.id=e,this.alreadyHaveEvent=n.alreadyHaveEvent,this.receivedEvent=n.receivedEvent,this.eoseTimeout=n.eoseTimeout||i.baseEoseTimeout,this.oneose=n.oneose,this.onclose=n.onclose,this.onevent=n.onevent||(s=>{console.warn(`onevent() callback not defined for subscription '${this.id}' in relay ${this.relay.url}. event received:`,s)})}fire(){this.relay.send('["REQ","'+this.id+'",'+JSON.stringify(this.filters).substring(1)),this.eoseTimeoutHandle=setTimeout(this.receivedEose.bind(this),this.eoseTimeout)}receivedEose(){this.eosed||(clearTimeout(this.eoseTimeoutHandle),this.eosed=!0,this.oneose?.())}close(i="closed by caller"){if(!this.closed&&this.relay.connected){try{this.relay.send('["CLOSE",'+JSON.stringify(this.id)+"]")}catch(e){if(!(e instanceof CA))throw e}this.closed=!0}this.relay.openSubs.delete(this.id),this.onclose?.(i)}},UR;try{UR=WebSocket}catch{}var qR=class{relays=new Map;seenOn=new Map;trackRelays=!1;verifyEvent;enablePing;enableReconnect;automaticallyAuth;trustedRelayURLs=new Set;_WebSocket;constructor(i){this.verifyEvent=i.verifyEvent,this._WebSocket=i.websocketImplementation,this.enablePing=i.enablePing,this.enableReconnect=i.enableReconnect||!1,this.automaticallyAuth=i.automaticallyAuth}async ensureRelay(i,e){i=vl(i);let t=this.relays.get(i);if(t||(t=new AA(i,{verifyEvent:this.trustedRelayURLs.has(i)?PR:this.verifyEvent,websocketImplementation:this._WebSocket,enablePing:this.enablePing,enableReconnect:this.enableReconnect}),t.onclose=()=>{t&&!t.enableReconnect&&this.relays.delete(i)},e?.connectionTimeout&&(t.connectionTimeout=e.connectionTimeout),this.relays.set(i,t)),this.automaticallyAuth){const n=this.automaticallyAuth(i);n&&(t.onauth=n)}return await t.connect(),t}close(i){i.map(vl).forEach(e=>{this.relays.get(e)?.close(),this.relays.delete(e)})}subscribe(i,e,t){const n=[];for(let s=0;s<i.length;s++){const a=vl(i[s]);n.find(l=>l.url===a)||n.push({url:a,filter:e})}return this.subscribeMap(n,t)}subscribeMany(i,e,t){const n=[],s=[];for(let a=0;a<i.length;a++){const l=vl(i[a]);s.indexOf(l)===-1&&(s.push(l),n.push({url:l,filter:e}))}return this.subscribeMap(n,t)}subscribeMap(i,e){const t=new Map;for(const m of i){const{url:v,filter:b}=m;t.has(v)||t.set(v,[]),t.get(v).push(b)}const n=Array.from(t.entries()).map(([m,v])=>({url:m,filters:v}));this.trackRelays&&(e.receivedEvent=(m,v)=>{let b=this.seenOn.get(v);b||(b=new Set,this.seenOn.set(v,b)),b.add(m)});const s=new Set,a=[],l=[];let u=m=>{l[m]||(l[m]=!0,l.filter(v=>v).length===n.length&&(e.oneose?.(),u=()=>{}))};const c=[];let f=(m,v)=>{c[m]||(u(m),c[m]=v,c.filter(b=>b).length===n.length&&(e.onclose?.(c),f=()=>{}))};const d=m=>{if(e.alreadyHaveEvent?.(m))return!0;const v=s.has(m);return s.add(m),v},p=Promise.all(n.map(async({url:m,filters:v},b)=>{let y;try{y=await this.ensureRelay(m,{connectionTimeout:e.maxWait?Math.max(e.maxWait*.8,e.maxWait-1e3):void 0})}catch(C){f(b,C?.message||String(C));return}let w=y.subscribe(v,{...e,oneose:()=>u(b),onclose:C=>{C.startsWith("auth-required: ")&&e.onauth?y.auth(e.onauth).then(()=>{y.subscribe(v,{...e,oneose:()=>u(b),onclose:S=>{f(b,S)},alreadyHaveEvent:d,eoseTimeout:e.maxWait})}).catch(S=>{f(b,`auth was required and attempted, but failed with: ${S}`)}):f(b,C)},alreadyHaveEvent:d,eoseTimeout:e.maxWait});a.push(w)}));return{async close(m){await p,a.forEach(v=>{v.close(m)})}}}subscribeEose(i,e,t){const n=this.subscribe(i,e,{...t,oneose(){n.close("closed automatically on eose")}});return n}subscribeManyEose(i,e,t){const n=this.subscribeMany(i,e,{...t,oneose(){n.close("closed automatically on eose")}});return n}async querySync(i,e,t){return new Promise(async n=>{const s=[];this.subscribeEose(i,e,{...t,onevent(a){s.push(a)},onclose(a){n(s)}})})}async get(i,e,t){e.limit=1;const n=await this.querySync(i,e,t);return n.sort((s,a)=>a.created_at-s.created_at),n[0]||null}publish(i,e,t){return i.map(vl).map(async(n,s,a)=>{if(a.indexOf(n)!==s)return Promise.reject("duplicate url");let l=await this.ensureRelay(n);return l.publish(e).catch(async u=>{if(u instanceof Error&&u.message.startsWith("auth-required: ")&&t?.onauth)return await l.auth(t.onauth),l.publish(e);throw u}).then(u=>{if(this.trackRelays){let c=this.seenOn.get(e.id);c||(c=new Set,this.seenOn.set(e.id,c)),c.add(l)}return u})})}listConnectionStatus(){const i=new Map;return this.relays.forEach((e,t)=>i.set(t,e.connected)),i}destroy(){this.relays.forEach(i=>i.close()),this.relays=new Map}},kA;try{kA=WebSocket}catch{}var FR=class extends qR{constructor(i){super({verifyEvent:Od,websocketImplementation:kA,...i})}},HR={};Ar(HR,{BECH32_REGEX:()=>TA,Bech32MaxSize:()=>Pb,NostrTypeGuard:()=>zR,decode:()=>Bd,decodeNostrURI:()=>KR,encodeBytes:()=>Dd,naddrEncode:()=>JR,neventEncode:()=>QR,noteEncode:()=>YR,nprofileEncode:()=>WR,npubEncode:()=>$R,nsecEncode:()=>VR});var zR={isNProfile:i=>/^nprofile1[a-z\d]+$/.test(i||""),isNEvent:i=>/^nevent1[a-z\d]+$/.test(i||""),isNAddr:i=>/^naddr1[a-z\d]+$/.test(i||""),isNSec:i=>/^nsec1[a-z\d]{58}$/.test(i||""),isNPub:i=>/^npub1[a-z\d]{58}$/.test(i||""),isNote:i=>/^note1[a-z\d]+$/.test(i||""),isNcryptsec:i=>/^ncryptsec1[a-z\d]+$/.test(i||"")},Pb=5e3,TA=/[\x21-\x7E]{1,83}1[023456789acdefghjklmnpqrstuvwxyz]{6,}/;function GR(i){const e=new Uint8Array(4);return e[0]=i>>24&255,e[1]=i>>16&255,e[2]=i>>8&255,e[3]=i&255,e}function KR(i){try{return i.startsWith("nostr:")&&(i=i.substring(6)),Bd(i)}catch{return{type:"invalid",data:null}}}function Bd(i){let{prefix:e,words:t}=Nc.decode(i,Pb),n=new Uint8Array(Nc.fromWords(t));switch(e){case"nprofile":{let s=t0(n);if(!s[0]?.[0])throw new Error("missing TLV 0 for nprofile");if(s[0][0].length!==32)throw new Error("TLV 0 should be 32 bytes");return{type:"nprofile",data:{pubkey:vi(s[0][0]),relays:s[1]?s[1].map(a=>To.decode(a)):[]}}}case"nevent":{let s=t0(n);if(!s[0]?.[0])throw new Error("missing TLV 0 for nevent");if(s[0][0].length!==32)throw new Error("TLV 0 should be 32 bytes");if(s[2]&&s[2][0].length!==32)throw new Error("TLV 2 should be 32 bytes");if(s[3]&&s[3][0].length!==4)throw new Error("TLV 3 should be 4 bytes");return{type:"nevent",data:{id:vi(s[0][0]),relays:s[1]?s[1].map(a=>To.decode(a)):[],author:s[2]?.[0]?vi(s[2][0]):void 0,kind:s[3]?.[0]?parseInt(vi(s[3][0]),16):void 0}}}case"naddr":{let s=t0(n);if(!s[0]?.[0])throw new Error("missing TLV 0 for naddr");if(!s[2]?.[0])throw new Error("missing TLV 2 for naddr");if(s[2][0].length!==32)throw new Error("TLV 2 should be 32 bytes");if(!s[3]?.[0])throw new Error("missing TLV 3 for naddr");if(s[3][0].length!==4)throw new Error("TLV 3 should be 4 bytes");return{type:"naddr",data:{identifier:To.decode(s[0][0]),pubkey:vi(s[2][0]),kind:parseInt(vi(s[3][0]),16),relays:s[1]?s[1].map(a=>To.decode(a)):[]}}}case"nsec":return{type:e,data:n};case"npub":case"note":return{type:e,data:vi(n)};default:throw new Error(`unknown prefix ${e}`)}}function t0(i){let e={},t=i;for(;t.length>0;){let n=t[0],s=t[1],a=t.slice(2,2+s);if(t=t.slice(2+s),a.length<s)throw new Error(`not enough data to read on TLV ${n}`);e[n]=e[n]||[],e[n].push(a)}return e}function VR(i){return Dd("nsec",i)}function $R(i){return Dd("npub",Tl(i))}function YR(i){return Dd("note",Tl(i))}function jd(i,e){let t=Nc.toWords(e);return Nc.encode(i,t,Pb)}function Dd(i,e){return jd(i,e)}function WR(i){let e=Lb({0:[Tl(i.pubkey)],1:(i.relays||[]).map(t=>_s.encode(t))});return jd("nprofile",e)}function QR(i){let e;i.kind!==void 0&&(e=GR(i.kind));let t=Lb({0:[Tl(i.id)],1:(i.relays||[]).map(n=>_s.encode(n)),2:i.author?[Tl(i.author)]:[],3:e?[new Uint8Array(e)]:[]});return jd("nevent",t)}function JR(i){let e=new ArrayBuffer(4);new DataView(e).setUint32(0,i.kind,!1);let t=Lb({0:[_s.encode(i.identifier)],1:(i.relays||[]).map(n=>_s.encode(n)),2:[Tl(i.pubkey)],3:[new Uint8Array(e)]});return jd("naddr",t)}function Lb(i){let e=[];return Object.entries(i).reverse().forEach(([t,n])=>{n.forEach(s=>{let a=new Uint8Array(s.length+2);a.set([parseInt(t)],0),a.set([s.length],1),a.set(s,2),e.push(a)})}),Td(...e)}var ZR={};Ar(ZR,{decrypt:()=>XR,encrypt:()=>MA});function MA(i,e,t){const n=i instanceof Uint8Array?vi(i):i,s=Uc.getSharedSecret(n,"02"+e),a=IA(s);let l=Uint8Array.from(GC(16)),u=_s.encode(t),c=tA(a,l).encrypt(u),f=Oo.encode(new Uint8Array(c)),d=Oo.encode(new Uint8Array(l.buffer));return`${f}?iv=${d}`}function XR(i,e,t){const n=i instanceof Uint8Array?vi(i):i;let[s,a]=t.split("?iv="),l=Uc.getSharedSecret(n,"02"+e),u=IA(l),c=Oo.decode(a),f=Oo.decode(s),d=tA(u,c).decrypt(f);return To.decode(d)}function IA(i){return i.slice(1,33)}var eO={};Ar(eO,{NIP05_REGEX:()=>Ub,isNip05:()=>tO,isValid:()=>iO,queryProfile:()=>RA,searchDomain:()=>rO,useFetchImplementation:()=>nO});var Ub=/^(?:([\w.+-]+)@)?([\w_-]+(\.[\w_-]+)+)$/,tO=i=>Ub.test(i||""),Pd;try{Pd=fetch}catch{}function nO(i){Pd=i}async function rO(i,e=""){try{const t=`https://${i}/.well-known/nostr.json?name=${e}`,n=await Pd(t,{redirect:"manual"});if(n.status!==200)throw Error("Wrong response code");return(await n.json()).names}catch{return{}}}async function RA(i){const e=i.match(Ub);if(!e)return null;const[,t="_",n]=e;try{const s=`https://${n}/.well-known/nostr.json?name=${t}`,a=await Pd(s,{redirect:"manual"});if(a.status!==200)throw Error("Wrong response code");const l=await a.json(),u=l.names[t];return u?{pubkey:u,relays:l.relays?.[u]}:null}catch{return null}}async function iO(i,e){const t=await RA(e);return t?t.pubkey===i:!1}var sO={};Ar(sO,{parse:()=>oO});function oO(i){const e={reply:void 0,root:void 0,mentions:[],profiles:[],quotes:[]};let t,n;for(let s=i.tags.length-1;s>=0;s--){const a=i.tags[s];if(a[0]==="e"&&a[1]){const[l,u,c,f,d]=a,p={id:u,relays:c?[c]:[],author:d};if(f==="root"){e.root=p;continue}if(f==="reply"){e.reply=p;continue}if(f==="mention"){e.mentions.push(p);continue}t?n=p:t=p,e.mentions.push(p);continue}if(a[0]==="q"&&a[1]){const[l,u,c]=a;e.quotes.push({id:u,relays:c?[c]:[]})}if(a[0]==="p"&&a[1]){e.profiles.push({pubkey:a[1],relays:a[2]?[a[2]]:[]});continue}}return e.root||(e.root=n||t||e.reply),e.reply||(e.reply=t||e.root),[e.reply,e.root].forEach(s=>{if(!s)return;let a=e.mentions.indexOf(s);if(a!==-1&&e.mentions.splice(a,1),s.author){let l=e.profiles.find(u=>u.pubkey===s.author);l&&l.relays&&(s.relays||(s.relays=[]),l.relays.forEach(u=>{s.relays?.indexOf(u)===-1&&s.relays.push(u)}),l.relays=s.relays)}}),e.mentions.forEach(s=>{if(s.author){let a=e.profiles.find(l=>l.pubkey===s.author);a&&a.relays&&(s.relays||(s.relays=[]),a.relays.forEach(l=>{s.relays.indexOf(l)===-1&&s.relays.push(l)}),a.relays=s.relays)}}),e}var aO={};Ar(aO,{fetchRelayInformation:()=>cO,useFetchImplementation:()=>lO});var OA;try{OA=fetch}catch{}function lO(i){OA=i}async function cO(i){return await(await fetch(i.replace("ws://","http://").replace("wss://","https://"),{headers:{Accept:"application/nostr+json"}})).json()}var uO={};Ar(uO,{fastEventHash:()=>BA,getPow:()=>NA,minePow:()=>fO});function NA(i){let e=0;for(let t=0;t<64;t+=8){const n=parseInt(i.substring(t,t+8),16);if(n===0)e+=32;else{e+=Math.clz32(n);break}}return e}function fO(i,e){let t=0;const n=i,s=["nonce",t.toString(),e.toString()];for(n.tags.push(s);;){const a=Math.floor(new Date().getTime()/1e3);if(a!==n.created_at&&(t=0,n.created_at=a),s[1]=(++t).toString(),n.id=BA(n),NA(n.id)>=e)break}return n}function BA(i){return vi(Dl(_s.encode(JSON.stringify([0,i.pubkey,i.created_at,i.kind,i.tags,i.content]))))}var hO={};Ar(hO,{unwrapEvent:()=>EO,unwrapManyEvents:()=>CO,wrapEvent:()=>$A,wrapManyEvents:()=>SO});var dO={};Ar(dO,{createRumor:()=>zA,createSeal:()=>GA,createWrap:()=>KA,unwrapEvent:()=>Gb,unwrapManyEvents:()=>VA,wrapEvent:()=>fd,wrapManyEvents:()=>xO});var pO={};Ar(pO,{decrypt:()=>zb,encrypt:()=>Hb,getConversationKey:()=>qb,v2:()=>vO});var jA=1,DA=65535;function qb(i,e){const t=Uc.getSharedSecret(i,"02"+e).subarray(1,33);return lI(Dl,t,"nip44-v2")}function PA(i,e){const t=cI(Dl,i,e,76);return{chacha_key:t.subarray(0,32),chacha_nonce:t.subarray(32,44),hmac_key:t.subarray(44,76)}}function Fb(i){if(!Number.isSafeInteger(i)||i<1)throw new Error("expected positive integer");if(i<=32)return 32;const e=1<<Math.floor(Math.log2(i-1))+1,t=e<=256?32:e/8;return t*(Math.floor((i-1)/t)+1)}function gO(i){if(!Number.isSafeInteger(i)||i<jA||i>DA)throw new Error("invalid plaintext size: must be between 1 and 65535 bytes");const e=new Uint8Array(2);return new DataView(e.buffer).setUint16(0,i,!1),e}function mO(i){const e=_s.encode(i),t=e.length,n=gO(t),s=new Uint8Array(Fb(t)-t);return Td(n,e,s)}function yO(i){const e=new DataView(i.buffer).getUint16(0),t=i.subarray(2,2+e);if(e<jA||e>DA||t.length!==e||i.length!==2+Fb(e))throw new Error("invalid padding");return To.decode(t)}function LA(i,e,t){if(t.length!==32)throw new Error("AAD associated data must be 32 bytes");const n=Td(t,e);return Id(Dl,i,n)}function bO(i){if(typeof i!="string")throw new Error("payload must be a valid string");const e=i.length;if(e<132||e>87472)throw new Error("invalid payload length: "+e);if(i[0]==="#")throw new Error("unknown encryption version");let t;try{t=Oo.decode(i)}catch(a){throw new Error("invalid base64: "+a.message)}const n=t.length;if(n<99||n>65603)throw new Error("invalid data length: "+n);const s=t[0];if(s!==2)throw new Error("unknown encryption version "+s);return{nonce:t.subarray(1,33),ciphertext:t.subarray(33,-32),mac:t.subarray(-32)}}function Hb(i,e,t=GC(32)){const{chacha_key:n,chacha_nonce:s,hmac_key:a}=PA(e,t),l=mO(i),u=sA(n,s,l),c=LA(a,u,t);return Oo.encode(Td(new Uint8Array([2]),t,u,c))}function zb(i,e){const{nonce:t,ciphertext:n,mac:s}=bO(i),{chacha_key:a,chacha_nonce:l,hmac_key:u}=PA(e,t),c=LA(u,n,t);if(!zM(c,s))throw new Error("invalid MAC");const f=sA(a,l,n);return yO(f)}var vO={utils:{getConversationKey:qb,calcPaddedLen:Fb},encrypt:Hb,decrypt:zb},wO=2880*60,UA=()=>Math.round(Date.now()/1e3),qA=()=>Math.round(UA()-Math.random()*wO),FA=(i,e)=>qb(i,e),HA=(i,e,t)=>Hb(JSON.stringify(i),FA(e,t)),S2=(i,e)=>JSON.parse(zb(i.content,FA(e,i.pubkey)));function zA(i,e){const t={created_at:UA(),content:"",tags:[],...i,pubkey:Ib(e)};return t.id=Gh(t),t}function GA(i,e,t){return Es({kind:hA,content:HA(i,e,t),created_at:qA(),tags:[]},e)}function KA(i,e){const t=yI();return Es({kind:vA,content:HA(i,t,e),created_at:qA(),tags:[["p",e]]},t)}function fd(i,e,t){const n=zA(i,e),s=GA(n,e,t);return KA(s,t)}function xO(i,e,t){if(!t||t.length===0)throw new Error("At least one recipient is required.");const n=Ib(e),s=[fd(i,e,n)];return t.forEach(a=>{s.push(fd(i,e,a))}),s}function Gb(i,e){const t=S2(i,e);return S2(t,e)}function VA(i,e){let t=[];return i.forEach(n=>{t.push(Gb(n,e))}),t.sort((n,s)=>n.created_at-s.created_at),t}function _O(i,e,t,n){const s={created_at:Math.ceil(Date.now()/1e3),kind:dA,tags:[],content:e};return(Array.isArray(i)?i:[i]).forEach(({publicKey:l,relayUrl:u})=>{s.tags.push(u?["p",l,u]:["p",l])}),n&&s.tags.push(["e",n.eventId,n.relayUrl||"","reply"]),t&&s.tags.push(["subject",t]),s}function $A(i,e,t,n,s){const a=_O(e,t,n,s);return fd(a,i,e.publicKey)}function SO(i,e,t,n,s){if(!e||e.length===0)throw new Error("At least one recipient is required.");return[{publicKey:Ib(i)},...e].map(l=>$A(i,l,t,n,s))}var EO=Gb,CO=VA,AO={};Ar(AO,{finishRepostEvent:()=>kO,getRepostedEvent:()=>TO,getRepostedEventPointer:()=>YA});function kO(i,e,t,n){let s;const a=[...i.tags??[],["e",e.id,t],["p",e.pubkey]];return e.kind===fA?s=Nb:(s=jb,a.push(["k",String(e.kind)])),Es({kind:s,tags:a,content:i.content===""||e.tags?.find(l=>l[0]==="-")?"":JSON.stringify(e),created_at:i.created_at},n)}function YA(i){if(![Nb,jb].includes(i.kind))return;let e,t;for(let n=i.tags.length-1;n>=0&&(e===void 0||t===void 0);n--){const s=i.tags[n];s.length>=2&&(s[0]==="e"&&e===void 0?e=s:s[0]==="p"&&t===void 0&&(t=s))}if(e!==void 0)return{id:e[1],relays:[e[2],t?.[2]].filter(n=>typeof n=="string"),author:t?.[1]}}function TO(i,{skipVerification:e}={}){const t=YA(i);if(t===void 0||i.content==="")return;let n;try{n=JSON.parse(i.content)}catch{return}if(n.id===t.id&&!(!e&&!Od(n)))return n}var MO={};Ar(MO,{NOSTR_URI_REGEX:()=>Kb,parse:()=>RO,test:()=>IO});var Kb=new RegExp(`nostr:(${TA.source})`);function IO(i){return typeof i=="string"&&new RegExp(`^${Kb.source}$`).test(i)}function RO(i){const e=i.match(new RegExp(`^${Kb.source}$`));if(!e)throw new Error(`Invalid Nostr URI: ${i}`);return{uri:e[0],value:e[1],decoded:Bd(e[1])}}var OO={};Ar(OO,{finishReactionEvent:()=>NO,getReactedEventPointer:()=>BO});function NO(i,e,t){const n=e.tags.filter(s=>s.length>=2&&(s[0]==="e"||s[0]==="p"));return Es({...i,kind:Bb,tags:[...i.tags??[],...n,["e",e.id],["p",e.pubkey]],content:i.content??"+"},t)}function BO(i){if(i.kind!==Bb)return;let e,t;for(let n=i.tags.length-1;n>=0&&(e===void 0||t===void 0);n--){const s=i.tags[n];s.length>=2&&(s[0]==="e"&&e===void 0?e=s:s[0]==="p"&&t===void 0&&(t=s))}if(!(e===void 0||t===void 0))return{id:e[1],relays:[e[2],t[2]].filter(n=>n!==void 0),author:t[1]}}var jO={};Ar(jO,{parse:()=>PO});var E2=/\W/m,C2=/\W |\W$|$|,| /m,DO=42;function*PO(i){let e=[];if(typeof i!="string"){for(let a=0;a<i.tags.length;a++){const l=i.tags[a];l[0]==="emoji"&&l.length>=3&&e.push({type:"emoji",shortcode:l[1],url:l[2]})}i=i.content}const t=i.length;let n=0,s=0;e:for(;s<t;){const a=i.indexOf(":",s),l=i.indexOf("#",s);if(a===-1&&l===-1)break e;if(a===-1||l>=0&&l<a){if(l===0||i[l-1]===" "){const u=i.slice(l+1,l+DO).match(E2),c=u?l+1+u.index:t;yield{type:"text",text:i.slice(n,l)},yield{type:"hashtag",value:i.slice(l+1,c)},s=c,n=s;continue e}s=l+1;continue e}if(i.slice(a-5,a)==="nostr"){const u=i.slice(a+60).match(E2),c=u?a+60+u.index:t;try{let f,{data:d,type:p}=Bd(i.slice(a+1,c));switch(p){case"npub":f={pubkey:d};break;case"nsec":case"note":s=c+1;continue;default:f=d}n!==a-5&&(yield{type:"text",text:i.slice(n,a-5)}),yield{type:"reference",pointer:f},s=c,n=s;continue e}catch{s=a+1;continue e}}else if(i.slice(a-5,a)==="https"||i.slice(a-4,a)==="http"){const u=i.slice(a+4).match(C2),c=u?a+4+u.index:t,f=i[a-1]==="s"?5:4;try{let d=new URL(i.slice(a-f,c));if(d.hostname.indexOf(".")===-1)throw new Error("invalid url");if(n!==a-f&&(yield{type:"text",text:i.slice(n,a-f)}),/\.(png|jpe?g|gif|webp|heic|svg)$/i.test(d.pathname)){yield{type:"image",url:d.toString()},s=c,n=s;continue e}if(/\.(mp4|avi|webm|mkv|mov)$/i.test(d.pathname)){yield{type:"video",url:d.toString()},s=c,n=s;continue e}if(/\.(mp3|aac|ogg|opus|wav|flac)$/i.test(d.pathname)){yield{type:"audio",url:d.toString()},s=c,n=s;continue e}yield{type:"url",url:d.toString()},s=c,n=s;continue e}catch{s=c+1;continue e}}else if(i.slice(a-3,a)==="wss"||i.slice(a-2,a)==="ws"){const u=i.slice(a+4).match(C2),c=u?a+4+u.index:t,f=i[a-1]==="s"?3:2;try{let d=new URL(i.slice(a-f,c));if(d.hostname.indexOf(".")===-1)throw new Error("invalid ws url");n!==a-f&&(yield{type:"text",text:i.slice(n,a-f)}),yield{type:"relay",url:d.toString()},s=c,n=s;continue e}catch{s=c+1;continue e}}else{for(let u=0;u<e.length;u++){const c=e[u];if(i[a+c.shortcode.length+1]===":"&&i.slice(a+1,a+c.shortcode.length+1)===c.shortcode){n!==a&&(yield{type:"text",text:i.slice(n,a)}),yield c,s=a+c.shortcode.length+2,n=s;continue e}}s=a+1;continue e}}n!==t&&(yield{type:"text",text:i.slice(n)})}var LO={};Ar(LO,{channelCreateEvent:()=>UO,channelHideMessageEvent:()=>HO,channelMessageEvent:()=>FO,channelMetadataEvent:()=>qO,channelMuteUserEvent:()=>zO});var UO=(i,e)=>{let t;if(typeof i.content=="object")t=JSON.stringify(i.content);else if(typeof i.content=="string")t=i.content;else return;return Es({kind:pA,tags:[...i.tags??[]],content:t,created_at:i.created_at},e)},qO=(i,e)=>{let t;if(typeof i.content=="object")t=JSON.stringify(i.content);else if(typeof i.content=="string")t=i.content;else return;return Es({kind:gA,tags:[["e",i.channel_create_event_id],...i.tags??[]],content:t,created_at:i.created_at},e)},FO=(i,e)=>{const t=[["e",i.channel_create_event_id,i.relay_url,"root"]];return i.reply_to_channel_message_event_id&&t.push(["e",i.reply_to_channel_message_event_id,i.relay_url,"reply"]),Es({kind:mA,tags:[...t,...i.tags??[]],content:i.content,created_at:i.created_at},e)},HO=(i,e)=>{let t;if(typeof i.content=="object")t=JSON.stringify(i.content);else if(typeof i.content=="string")t=i.content;else return;return Es({kind:yA,tags:[["e",i.channel_message_event_id],...i.tags??[]],content:t,created_at:i.created_at},e)},zO=(i,e)=>{let t;if(typeof i.content=="object")t=JSON.stringify(i.content);else if(typeof i.content=="string")t=i.content;else return;return Es({kind:bA,tags:[["p",i.pubkey_to_mute],...i.tags??[]],content:t,created_at:i.created_at},e)},GO={};Ar(GO,{EMOJI_SHORTCODE_REGEX:()=>WA,matchAll:()=>KO,regex:()=>Vb,replaceAll:()=>VO});var WA=/:(\w+):/,Vb=()=>new RegExp(`\\B${WA.source}\\B`,"g");function*KO(i){const e=i.matchAll(Vb());for(const t of e)try{const[n,s]=t;yield{shortcode:n,name:s,start:t.index,end:t.index+n.length}}catch{}}function VO(i,e){return i.replaceAll(Vb(),(t,n)=>e({shortcode:t,name:n}))}var $O={};Ar($O,{useFetchImplementation:()=>YO,validateGithub:()=>WO});var $b;try{$b=fetch}catch{}function YO(i){$b=i}async function WO(i,e,t){try{return await(await $b(`https://gist.github.com/${e}/${t}/raw`)).text()===`Verifying that I control the following Nostr public key: ${i}`}catch{return!1}}var QO={};Ar(QO,{makeNwcRequestEvent:()=>ZO,parseConnectionString:()=>JO});function JO(i){const{host:e,pathname:t,searchParams:n}=new URL(i),s=t||e,a=n.get("relay"),l=n.get("secret");if(!s||!a||!l)throw new Error("invalid connection string");return{pubkey:s,relay:a,secret:l}}async function ZO(i,e,t){const s=MA(e,i,JSON.stringify({method:"pay_invoice",params:{invoice:t}})),a={kind:xA,created_at:Math.round(Date.now()/1e3),content:s,tags:[["p",i]]};return Es(a,e)}var XO={};Ar(XO,{normalizeIdentifier:()=>eN});function eN(i){return i=i.trim().toLowerCase(),i=i.normalize("NFKC"),Array.from(i).map(e=>new RegExp("\\p{Letter}","u").test(e)||new RegExp("\\p{Number}","u").test(e)?e:"-").join("")}var tN={};Ar(tN,{getSatoshisAmountFromBolt11:()=>aN,getZapEndpoint:()=>rN,makeZapReceipt:()=>oN,makeZapRequest:()=>iN,useFetchImplementation:()=>nN,validateZapRequest:()=>sN});var Yb;try{Yb=fetch}catch{}function nN(i){Yb=i}async function rN(i){try{let e="",{lud06:t,lud16:n}=JSON.parse(i.content);if(n){let[l,u]=n.split("@");e=new URL(`/.well-known/lnurlp/${l}`,`https://${u}`).toString()}else if(t){let{words:l}=Nc.decode(t,1e3),u=Nc.fromWords(l);e=To.decode(u)}else return null;let a=await(await Yb(e)).json();if(a.allowsNostr&&a.nostrPubkey)return a.callback}catch{}return null}function iN(i){let e={kind:9734,created_at:Math.round(Date.now()/1e3),content:i.comment||"",tags:[["p","pubkey"in i?i.pubkey:i.event.pubkey],["amount",i.amount.toString()],["relays",...i.relays]]};if("event"in i){if(e.tags.push(["e",i.event.id]),Rb(i.event.kind)){const t=["a",`${i.event.kind}:${i.event.pubkey}:`];e.tags.push(t)}else if(Ob(i.event.kind)){let t=i.event.tags.find(([s,a])=>s==="d"&&a);if(!t)throw new Error("d tag not found or is empty");const n=["a",`${i.event.kind}:${i.event.pubkey}:${t[1]}`];e.tags.push(n)}e.tags.push(["k",i.event.kind.toString()])}return e}function sN(i){let e;try{e=JSON.parse(i)}catch{return"Invalid zap request JSON."}if(!Tb(e))return"Zap request is not a valid Nostr event.";if(!Od(e))return"Invalid signature on zap request.";let t=e.tags.find(([a,l])=>a==="p"&&l);if(!t)return"Zap request doesn't have a 'p' tag.";if(!t[1].match(/^[a-f0-9]{64}$/))return"Zap request 'p' tag is not valid hex.";let n=e.tags.find(([a,l])=>a==="e"&&l);return n&&!n[1].match(/^[a-f0-9]{64}$/)?"Zap request 'e' tag is not valid hex.":e.tags.find(([a,l])=>a==="relays"&&l)?null:"Zap request doesn't have a 'relays' tag."}function oN({zapRequest:i,preimage:e,bolt11:t,paidAt:n}){let s=JSON.parse(i),a=s.tags.filter(([u])=>u==="e"||u==="p"||u==="a"),l={kind:9735,created_at:Math.round(n.getTime()/1e3),content:"",tags:[...a,["P",s.pubkey],["bolt11",t],["description",i]]};return e&&l.tags.push(["preimage",e]),l}function aN(i){if(i.length<50)return 0;i=i.substring(0,50);const e=i.lastIndexOf("1");if(e===-1)return 0;const t=i.substring(0,e);if(!t.startsWith("lnbc"))return 0;const n=t.substring(4);if(n.length<1)return 0;const s=n[n.length-1],a=s.charCodeAt(0)-48,l=a>=0&&a<=9;let u=n.length-1;if(l&&u++,u<1)return 0;const c=parseInt(n.substring(0,u));switch(s){case"m":return c*1e5;case"u":return c*100;case"n":return c/10;case"p":return c/1e4;default:return c*1e8}}var lN={};Ar(lN,{Negentropy:()=>JA,NegentropyStorageVector:()=>fN,NegentropySync:()=>hN});var n0=97,Tc=32,QA=16,ml={Skip:0,Fingerprint:1,IdList:2},ko=class{_raw;length;constructor(i){typeof i=="number"?(this._raw=new Uint8Array(i),this.length=0):i instanceof Uint8Array?(this._raw=new Uint8Array(i),this.length=i.length):(this._raw=new Uint8Array(512),this.length=0)}unwrap(){return this._raw.subarray(0,this.length)}get capacity(){return this._raw.byteLength}extend(i){if(i instanceof ko&&(i=i.unwrap()),typeof i.length!="number")throw Error("bad length");const e=i.length+this.length;if(this.capacity<e){const t=this._raw,n=Math.max(this.capacity*2,e);this._raw=new Uint8Array(n),this._raw.set(t)}this._raw.set(i,this.length),this.length+=i.length}shift(){const i=this._raw[0];return this._raw=this._raw.subarray(1),this.length--,i}shiftN(i=1){const e=this._raw.subarray(0,i);return this._raw=this._raw.subarray(i),this.length-=i,e}};function sh(i){let e=0;for(;;){if(i.length===0)throw Error("parse ends prematurely");let t=i.shift();if(e=e<<7|t&127,(t&128)===0)break}return e}function _o(i){if(i===0)return new ko(new Uint8Array([0]));let e=[];for(;i!==0;)e.push(i&127),i>>>=7;e.reverse();for(let t=0;t<e.length-1;t++)e[t]|=128;return new ko(new Uint8Array(e))}function cN(i){return Kh(i,1)[0]}function Kh(i,e){if(i.length<e)throw Error("parse ends prematurely");return i.shiftN(e)}var uN=class{buf;constructor(){this.setToZero()}setToZero(){this.buf=new Uint8Array(Tc)}add(i){let e=0,t=0,n=new DataView(this.buf.buffer),s=new DataView(i.buffer);for(let a=0;a<8;a++){let l=a*4,u=n.getUint32(l,!0),c=s.getUint32(l,!0),f=u;f+=e,f+=c,f>4294967295&&(t=1),n.setUint32(l,f&4294967295,!0),e=t,t=0}}negate(){let i=new DataView(this.buf.buffer);for(let t=0;t<8;t++){let n=t*4;i.setUint32(n,~i.getUint32(n,!0))}let e=new Uint8Array(Tc);e[0]=1,this.add(e)}getFingerprint(i){let e=new ko;return e.extend(this.buf),e.extend(_o(i)),Dl(e.unwrap()).subarray(0,QA)}},fN=class{items;sealed;constructor(){this.items=[],this.sealed=!1}insert(i,e){if(this.sealed)throw Error("already sealed");const t=QC(e);if(t.byteLength!==Tc)throw Error("bad id size for added item");this.items.push({timestamp:i,id:t})}seal(){if(this.sealed)throw Error("already sealed");this.sealed=!0,this.items.sort(r0);for(let i=1;i<this.items.length;i++)if(r0(this.items[i-1],this.items[i])===0)throw Error("duplicate item inserted")}unseal(){this.sealed=!1}size(){return this._checkSealed(),this.items.length}getItem(i){if(this._checkSealed(),i>=this.items.length)throw Error("out of range");return this.items[i]}iterate(i,e,t){this._checkSealed(),this._checkBounds(i,e);for(let n=i;n<e&&t(this.items[n],n);++n);}findLowerBound(i,e,t){return this._checkSealed(),this._checkBounds(i,e),this._binarySearch(this.items,i,e,n=>r0(n,t)<0)}fingerprint(i,e){let t=new uN;return t.setToZero(),this.iterate(i,e,n=>(t.add(n.id),!0)),t.getFingerprint(e-i)}_checkSealed(){if(!this.sealed)throw Error("not sealed")}_checkBounds(i,e){if(i>e||e>this.items.length)throw Error("bad range")}_binarySearch(i,e,t,n){let s=t-e;for(;s>0;){let a=e,l=Math.floor(s/2);a+=l,n(i[a])?(e=++a,s-=l+1):s=l}return e}},JA=class{storage;frameSizeLimit;lastTimestampIn;lastTimestampOut;constructor(i,e=6e4){if(e<4096)throw Error("frameSizeLimit too small");this.storage=i,this.frameSizeLimit=e,this.lastTimestampIn=0,this.lastTimestampOut=0}_bound(i,e){return{timestamp:i,id:e||new Uint8Array(0)}}initiate(){let i=new ko;return i.extend(new Uint8Array([n0])),this.splitRange(0,this.storage.size(),this._bound(Number.MAX_VALUE),i),wc(i.unwrap())}reconcile(i,e,t){const n=new ko(QC(i));this.lastTimestampIn=this.lastTimestampOut=0;let s=new ko;s.extend(new Uint8Array([n0]));let a=cN(n);if(a<96||a>111)throw Error("invalid negentropy protocol version byte");if(a!==n0)throw Error("unsupported negentropy protocol version requested: "+(a-96));let l=this.storage.size(),u=this._bound(0),c=0,f=!1;for(;n.length!==0;){let d=new ko,p=()=>{f&&(f=!1,d.extend(this.encodeBound(u)),d.extend(_o(ml.Skip)))},m=this.decodeBound(n),v=sh(n),b=c,y=this.storage.findLowerBound(c,l,m);if(v===ml.Skip)f=!0;else if(v===ml.Fingerprint){let w=Kh(n,QA),C=this.storage.fingerprint(b,y);ZA(w,C)!==0?(p(),this.splitRange(b,y,m,d)):f=!0}else if(v===ml.IdList){let w=sh(n),C={};for(let S=0;S<w;S++){let x=Kh(n,Tc);C[wc(x)]=x}if(f=!0,this.storage.iterate(b,y,S=>{let x=S.id;const k=wc(x);return C[k]?delete C[wc(x)]:e?.(k),!0}),t)for(let S of Object.values(C))t(wc(S))}else throw Error("unexpected mode");if(this.exceededFrameSizeLimit(s.length+d.length)){let w=this.storage.fingerprint(y,l);s.extend(this.encodeBound(this._bound(Number.MAX_VALUE))),s.extend(_o(ml.Fingerprint)),s.extend(w);break}else s.extend(d);c=y,u=m}return s.length===1?null:wc(s.unwrap())}splitRange(i,e,t,n){let s=e-i,a=16;if(s<a*2)n.extend(this.encodeBound(t)),n.extend(_o(ml.IdList)),n.extend(_o(s)),this.storage.iterate(i,e,l=>(n.extend(l.id),!0));else{let l=Math.floor(s/a),u=s%a,c=i;for(let f=0;f<a;f++){let d=l+(f<u?1:0),p=this.storage.fingerprint(c,c+d);c+=d;let m;if(c===e)m=t;else{let v,b;this.storage.iterate(c-1,c+1,(y,w)=>(w===c-1?v=y:b=y,!0)),m=this.getMinimalBound(v,b)}n.extend(this.encodeBound(m)),n.extend(_o(ml.Fingerprint)),n.extend(p)}}}exceededFrameSizeLimit(i){return i>this.frameSizeLimit-200}decodeTimestampIn(i){let e=sh(i);return e=e===0?Number.MAX_VALUE:e-1,this.lastTimestampIn===Number.MAX_VALUE||e===Number.MAX_VALUE?(this.lastTimestampIn=Number.MAX_VALUE,Number.MAX_VALUE):(e+=this.lastTimestampIn,this.lastTimestampIn=e,e)}decodeBound(i){let e=this.decodeTimestampIn(i),t=sh(i);if(t>Tc)throw Error("bound key too long");let n=Kh(i,t);return{timestamp:e,id:n}}encodeTimestampOut(i){if(i===Number.MAX_VALUE)return this.lastTimestampOut=Number.MAX_VALUE,_o(0);let e=i;return i-=this.lastTimestampOut,this.lastTimestampOut=e,_o(i+1)}encodeBound(i){let e=new ko;return e.extend(this.encodeTimestampOut(i.timestamp)),e.extend(_o(i.id.length)),e.extend(i.id),e}getMinimalBound(i,e){if(e.timestamp!==i.timestamp)return this._bound(e.timestamp);{let t=0,n=e.id,s=i.id;for(let a=0;a<Tc&&n[a]===s[a];a++)t++;return this._bound(e.timestamp,e.id.subarray(0,t+1))}}};function ZA(i,e){for(let t=0;t<i.byteLength;t++){if(i[t]<e[t])return-1;if(i[t]>e[t])return 1}return i.byteLength>e.byteLength?1:i.byteLength<e.byteLength?-1:0}function r0(i,e){return i.timestamp===e.timestamp?ZA(i.id,e.id):i.timestamp-e.timestamp}var hN=class{relay;storage;neg;filter;subscription;onhave;onneed;constructor(i,e,t,n={}){this.relay=i,this.storage=e,this.neg=new JA(e),this.onhave=n.onhave,this.onneed=n.onneed,this.filter=t,this.subscription=this.relay.prepareSubscription([{}],{label:n.label||"negentropy"}),this.subscription.oncustom=s=>{switch(s[0]){case"NEG-MSG":{s.length<3&&console.warn(`got invalid NEG-MSG from ${this.relay.url}: ${s}`);try{const a=this.neg.reconcile(s[2],this.onhave,this.onneed);a?this.relay.send(`["NEG-MSG", "${this.subscription.id}", "${a}"]`):(this.close(),n.onclose?.())}catch(a){console.error("negentropy reconcile error:",a),n?.onclose?.(`reconcile error: ${a}`)}break}case"NEG-CLOSE":{const a=s[2];console.warn("negentropy error:",a),n.onclose?.(a);break}case"NEG-ERR":n.onclose?.()}}}async start(){const i=this.neg.initiate();this.relay.send(`["NEG-OPEN","${this.subscription.id}",${JSON.stringify(this.filter)},"${i}"]`)}close(){this.relay.send(`["NEG-CLOSE","${this.subscription.id}"]`),this.subscription.close()}},dN={};Ar(dN,{getToken:()=>pN,hashPayload:()=>Wb,unpackEventFromToken:()=>ek,validateEvent:()=>ok,validateEventKind:()=>nk,validateEventMethodTag:()=>ik,validateEventPayloadTag:()=>sk,validateEventTimestamp:()=>tk,validateEventUrlTag:()=>rk,validateToken:()=>gN});var XA="Nostr ";async function pN(i,e,t,n=!1,s){const a={kind:Db,tags:[["u",i],["method",e]],created_at:Math.round(new Date().getTime()/1e3),content:""};s&&a.tags.push(["payload",Wb(s)]);const l=await t(a);return(n?XA:"")+Oo.encode(_s.encode(JSON.stringify(l)))}async function gN(i,e,t){const n=await ek(i).catch(a=>{throw a});return await ok(n,e,t).catch(a=>{throw a})}async function ek(i){if(!i)throw new Error("Missing token");i=i.replace(XA,"");const e=To.decode(Oo.decode(i));if(!e||e.length===0||!e.startsWith("{"))throw new Error("Invalid token");return JSON.parse(e)}function tk(i){return i.created_at?Math.round(new Date().getTime()/1e3)-i.created_at<60:!1}function nk(i){return i.kind===Db}function rk(i,e){const t=i.tags.find(n=>n[0]==="u");return t?t.length>0&&t[1]===e:!1}function ik(i,e){const t=i.tags.find(n=>n[0]==="method");return t?t.length>0&&t[1].toLowerCase()===e.toLowerCase():!1}function Wb(i){const e=Dl(_s.encode(JSON.stringify(i)));return vi(e)}function sk(i,e){const t=i.tags.find(s=>s[0]==="payload");if(!t)return!1;const n=Wb(e);return t.length>0&&t[1]===n}async function ok(i,e,t,n){if(!Od(i))throw new Error("Invalid nostr event, signature invalid");if(!nk(i))throw new Error("Invalid nostr event, kind invalid");if(!tk(i))throw new Error("Invalid nostr event, created_at timestamp invalid");if(!rk(i,e))throw new Error("Invalid nostr event, url tag invalid");if(!ik(i,t))throw new Error("Invalid nostr event, method tag invalid");if(n&&typeof n=="object"&&Object.keys(n).length>0&&!sk(i,n))throw new Error("Invalid nostr event, payload tag does not match request body hash");return!0}const mN=["wss://relay.damus.io","wss://nos.lol","wss://relay.nostr.band"],A2=20001,k2="adun-signal";class yN{name="Nostr";pool=null;userIdHash=null;secretKey=null;handshakeCallbacks=new Set;customSignalCallbacks=new Set;connected=!1;messageCounter=0;relays;subscriptionCloser=null;processedEventIds=new Set;eventIdCleanupInterval=null;constructor(e=mN){this.relays=e}async initialize(e){this.userIdHash=e,this.secretKey=this.deriveSecretKey(e),this.pool=new FR,await this.subscribeToInbox(),this.connected=!0,this.eventIdCleanupInterval=setInterval(()=>{this.cleanupProcessedEventIds()},6e4),console.log(`[${this.name}] Initialized for user:`,e.substring(0,8)+"...")}deriveSecretKey(e){const t=e.padEnd(64,"0").substring(0,64),n=new Uint8Array(32);for(let s=0;s<32;s++)n[s]=parseInt(t.substring(s*2,s*2+2),16);return n}async subscribeToInbox(){if(!this.pool||!this.userIdHash)return;const e={kinds:[A2],"#t":[k2],"#d":[this.userIdHash],since:Math.floor(Date.now()/1e3)-60};console.log(`[${this.name}] Subscribing to relay events...`),this.subscriptionCloser=this.pool.subscribeMany(this.relays,e,{onevent:t=>{this.handleIncomingEvent(t)},oneose:()=>{console.log(`[${this.name}] End of stored events`)}})}handleIncomingEvent(e){try{if(this.processedEventIds.has(e.id))return;this.processedEventIds.add(e.id);const t=JSON.parse(e.content);this.processIncomingMessage(t)}catch(t){console.error(`[${this.name}] Failed to parse event:`,t)}}processIncomingMessage(e){!e.from||!e.type||e.from!==this.userIdHash&&(e.type==="handshake"&&e.message?(console.log(`[${this.name}] Received handshake from:`,e.from.substring(0,8)),this.handshakeCallbacks.forEach(t=>{t(e.from,e.message)})):e.type==="custom"&&e.signal&&(console.log(`[${this.name}] Received custom signal from:`,e.from.substring(0,8)),this.customSignalCallbacks.forEach(t=>{t(e.from,e.signal)})))}cleanupProcessedEventIds(){if(this.processedEventIds.size>1e3){const e=Array.from(this.processedEventIds);this.processedEventIds=new Set(e.slice(-500))}}generateMessageId(){return this.messageCounter++,`${Date.now()}-${this.messageCounter}-${Math.random().toString(36).substring(2,8)}`}async sendMessage(e,t){if(!this.pool||!this.userIdHash||!this.secretKey)throw new Error("Not initialized");const n=this.generateMessageId(),s={...t,from:this.userIdHash,timestamp:Date.now(),id:n},a={kind:A2,created_at:Math.floor(Date.now()/1e3),tags:[["t",k2],["d",e]],content:JSON.stringify(s)},l=Es(a,this.secretKey),u=this.pool.publish(this.relays,l);try{await Promise.any(u)}catch{throw new Error("Failed to publish to any relay")}}async sendHandshakeMessage(e,t){await this.sendMessage(e,{type:"handshake",message:t}),console.log(`[${this.name}] Sent handshake to:`,e.substring(0,8))}async sendCustomSignal(e,t){await this.sendMessage(e,{type:"custom",signal:t}),console.log(`[${this.name}] Sent custom signal to:`,e.substring(0,8))}onHandshakeMessage(e){return this.handshakeCallbacks.add(e),()=>{this.handshakeCallbacks.delete(e)}}onCustomSignal(e){return this.customSignalCallbacks.add(e),()=>{this.customSignalCallbacks.delete(e)}}isConnected(){return this.connected&&this.pool!==null}destroy(){this.eventIdCleanupInterval&&(clearInterval(this.eventIdCleanupInterval),this.eventIdCleanupInterval=null),this.subscriptionCloser&&(this.subscriptionCloser.close(),this.subscriptionCloser=null),this.pool&&(this.pool.close(this.relays),this.pool=null),this.handshakeCallbacks.clear(),this.customSignalCallbacks.clear(),this.processedEventIds.clear(),this.connected=!1,this.userIdHash=null,this.secretKey=null,console.log(`[${this.name}] Destroyed`)}}function bN(i,e){switch(i){case ui.PeerJS:return new i4(e);case ui.WebTorrent:return new p6(e);case ui.Nostr:return new yN(e);case ui.Gun:return new u4(e);case ui.MQTT:return new C8(e)}}class vN{services=[];handshakeMessageCallbacks=new Set;customSignalCallbacks=new Set;initializedUserId=null;initializationPromise=null;async initialize(e,t=O3){if(this.initializedUserId===e&&this.services.length>0){console.log("[SignalingManager] Already initialized for this user, skipping");return}if(this.initializationPromise)return console.log("[SignalingManager] Initialization already in progress, waiting..."),this.initializationPromise;this.initializedUserId&&this.initializedUserId!==e&&(console.log("[SignalingManager] Switching users, cleaning up old signaling"),this.destroyInternal()),this.initializedUserId=e;const n=[];for(const s of Object.values(ui)){const a=t[s];if(!a?.enabled)continue;const l=bN(s,a.servers);n.push(l.initialize(e).then(()=>{this.services.push(l),this.setupServiceListeners(l),console.log(`[SignalingManager]  ${l.name} enabled`)}).catch(u=>{console.warn(`[SignalingManager] ${l.name} failed:`,u)}))}this.initializationPromise=Promise.allSettled(n).then(()=>{if(this.services.length===0)throw this.initializedUserId=null,this.initializationPromise=null,new Error("No signaling services available");console.log(`[SignalingManager]  Initialized with ${this.services.length} service(s) for user:`,e.substring(0,8)),this.initializationPromise=null}),await this.initializationPromise}async sendHandshakeMessage(e,t){if(this.services.length===0)throw new Error("No signaling services available");const n=this.services.map(l=>l.sendHandshakeMessage(e,t).then(()=>(console.log(`[SignalingManager]  Sent handshake via ${l.name}`),!0)).catch(u=>(console.warn(`[SignalingManager] Failed to send handshake via ${l.name}:`,u),!1))),a=(await Promise.all(n)).filter(Boolean).length;if(a===0)throw new Error("Failed to send handshake through any service");console.log(`[SignalingManager] Handshake sent via ${a}/${this.services.length} service(s)`)}async sendCustomSignal(e,t){if(this.services.length===0)throw new Error("No signaling services available");const n=this.services.map(l=>l.sendCustomSignal(e,t).then(()=>(console.log(`[SignalingManager]  Sent custom signal via ${l.name}`),!0)).catch(u=>(console.warn(`[SignalingManager] Failed to send custom signal via ${l.name}:`,u),!1))),a=(await Promise.all(n)).filter(Boolean).length;if(a===0)throw new Error("Failed to send custom signal through any service");console.log(`[SignalingManager] Custom signal sent via ${a}/${this.services.length} service(s)`)}onCustomSignal(e){return this.customSignalCallbacks.add(e),()=>{this.customSignalCallbacks.delete(e)}}onHandshakeMessage(e){return this.handshakeMessageCallbacks.add(e),()=>{this.handshakeMessageCallbacks.delete(e)}}getActiveServices(){return this.services.filter(e=>e.isConnected()).map(e=>e.name)}isConnected(){return this.services.some(e=>e.isConnected())}isInitializedForUser(e){return this.initializedUserId===e&&this.services.length>0}destroy(){console.log("[SignalingManager] Destroy called - cleaning up signaling"),this.destroyInternal()}setupServiceListeners(e){e.onHandshakeMessage((t,n)=>{console.log(`[SignalingManager] Handshake received from ${t.substring(0,8)} via ${e.name}`),this.handshakeMessageCallbacks.forEach(s=>{s(t,n)})}),e.onCustomSignal((t,n)=>{console.log(`[SignalingManager] Custom signal received from ${t.substring(0,8)} via ${e.name}`),this.customSignalCallbacks.forEach(s=>{s(t,n)})})}destroyInternal(){this.services.forEach(e=>{e.destroy()}),this.services=[],this.handshakeMessageCallbacks.clear(),this.customSignalCallbacks.clear(),this.initializedUserId=null,this.initializationPromise=null}}var i0={exports:{}};const wN={},xN=Object.freeze(Object.defineProperty({__proto__:null,default:wN},Symbol.toStringTag,{value:"Module"})),_N=u3(xN);var T2;function ak(){return T2||(T2=1,(function(i){(function(e){var t=function(K){var oe,ce=new Float64Array(16);if(K)for(oe=0;oe<K.length;oe++)ce[oe]=K[oe];return ce},n=function(){throw new Error("no PRNG")},s=new Uint8Array(16),a=new Uint8Array(32);a[0]=9;var l=t(),u=t([1]),c=t([56129,1]),f=t([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),d=t([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),p=t([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),m=t([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),v=t([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function b(K,oe,ce,D){K[oe]=ce>>24&255,K[oe+1]=ce>>16&255,K[oe+2]=ce>>8&255,K[oe+3]=ce&255,K[oe+4]=D>>24&255,K[oe+5]=D>>16&255,K[oe+6]=D>>8&255,K[oe+7]=D&255}function y(K,oe,ce,D,ge){var $e,ze=0;for($e=0;$e<ge;$e++)ze|=K[oe+$e]^ce[D+$e];return(1&ze-1>>>8)-1}function w(K,oe,ce,D){return y(K,oe,ce,D,16)}function C(K,oe,ce,D){return y(K,oe,ce,D,32)}function S(K,oe,ce,D){for(var ge=D[0]&255|(D[1]&255)<<8|(D[2]&255)<<16|(D[3]&255)<<24,$e=ce[0]&255|(ce[1]&255)<<8|(ce[2]&255)<<16|(ce[3]&255)<<24,ze=ce[4]&255|(ce[5]&255)<<8|(ce[6]&255)<<16|(ce[7]&255)<<24,vt=ce[8]&255|(ce[9]&255)<<8|(ce[10]&255)<<16|(ce[11]&255)<<24,Nt=ce[12]&255|(ce[13]&255)<<8|(ce[14]&255)<<16|(ce[15]&255)<<24,Yt=D[4]&255|(D[5]&255)<<8|(D[6]&255)<<16|(D[7]&255)<<24,Kt=oe[0]&255|(oe[1]&255)<<8|(oe[2]&255)<<16|(oe[3]&255)<<24,vn=oe[4]&255|(oe[5]&255)<<8|(oe[6]&255)<<16|(oe[7]&255)<<24,$t=oe[8]&255|(oe[9]&255)<<8|(oe[10]&255)<<16|(oe[11]&255)<<24,sn=oe[12]&255|(oe[13]&255)<<8|(oe[14]&255)<<16|(oe[15]&255)<<24,wn=D[8]&255|(D[9]&255)<<8|(D[10]&255)<<16|(D[11]&255)<<24,xn=ce[16]&255|(ce[17]&255)<<8|(ce[18]&255)<<16|(ce[19]&255)<<24,tn=ce[20]&255|(ce[21]&255)<<8|(ce[22]&255)<<16|(ce[23]&255)<<24,dn=ce[24]&255|(ce[25]&255)<<8|(ce[26]&255)<<16|(ce[27]&255)<<24,cn=ce[28]&255|(ce[29]&255)<<8|(ce[30]&255)<<16|(ce[31]&255)<<24,on=D[12]&255|(D[13]&255)<<8|(D[14]&255)<<16|(D[15]&255)<<24,Xt=ge,ln=$e,Wt=ze,en=vt,nn=Nt,Jt=Yt,ht=Kt,yt=vn,bt=$t,kt=sn,Ct=wn,Pt=xn,pn=tn,Qt=dn,An=cn,kn=on,Ee,Tn=0;Tn<20;Tn+=2)Ee=Xt+pn|0,nn^=Ee<<7|Ee>>>25,Ee=nn+Xt|0,bt^=Ee<<9|Ee>>>23,Ee=bt+nn|0,pn^=Ee<<13|Ee>>>19,Ee=pn+bt|0,Xt^=Ee<<18|Ee>>>14,Ee=Jt+ln|0,kt^=Ee<<7|Ee>>>25,Ee=kt+Jt|0,Qt^=Ee<<9|Ee>>>23,Ee=Qt+kt|0,ln^=Ee<<13|Ee>>>19,Ee=ln+Qt|0,Jt^=Ee<<18|Ee>>>14,Ee=Ct+ht|0,An^=Ee<<7|Ee>>>25,Ee=An+Ct|0,Wt^=Ee<<9|Ee>>>23,Ee=Wt+An|0,ht^=Ee<<13|Ee>>>19,Ee=ht+Wt|0,Ct^=Ee<<18|Ee>>>14,Ee=kn+Pt|0,en^=Ee<<7|Ee>>>25,Ee=en+kn|0,yt^=Ee<<9|Ee>>>23,Ee=yt+en|0,Pt^=Ee<<13|Ee>>>19,Ee=Pt+yt|0,kn^=Ee<<18|Ee>>>14,Ee=Xt+en|0,ln^=Ee<<7|Ee>>>25,Ee=ln+Xt|0,Wt^=Ee<<9|Ee>>>23,Ee=Wt+ln|0,en^=Ee<<13|Ee>>>19,Ee=en+Wt|0,Xt^=Ee<<18|Ee>>>14,Ee=Jt+nn|0,ht^=Ee<<7|Ee>>>25,Ee=ht+Jt|0,yt^=Ee<<9|Ee>>>23,Ee=yt+ht|0,nn^=Ee<<13|Ee>>>19,Ee=nn+yt|0,Jt^=Ee<<18|Ee>>>14,Ee=Ct+kt|0,Pt^=Ee<<7|Ee>>>25,Ee=Pt+Ct|0,bt^=Ee<<9|Ee>>>23,Ee=bt+Pt|0,kt^=Ee<<13|Ee>>>19,Ee=kt+bt|0,Ct^=Ee<<18|Ee>>>14,Ee=kn+An|0,pn^=Ee<<7|Ee>>>25,Ee=pn+kn|0,Qt^=Ee<<9|Ee>>>23,Ee=Qt+pn|0,An^=Ee<<13|Ee>>>19,Ee=An+Qt|0,kn^=Ee<<18|Ee>>>14;Xt=Xt+ge|0,ln=ln+$e|0,Wt=Wt+ze|0,en=en+vt|0,nn=nn+Nt|0,Jt=Jt+Yt|0,ht=ht+Kt|0,yt=yt+vn|0,bt=bt+$t|0,kt=kt+sn|0,Ct=Ct+wn|0,Pt=Pt+xn|0,pn=pn+tn|0,Qt=Qt+dn|0,An=An+cn|0,kn=kn+on|0,K[0]=Xt>>>0&255,K[1]=Xt>>>8&255,K[2]=Xt>>>16&255,K[3]=Xt>>>24&255,K[4]=ln>>>0&255,K[5]=ln>>>8&255,K[6]=ln>>>16&255,K[7]=ln>>>24&255,K[8]=Wt>>>0&255,K[9]=Wt>>>8&255,K[10]=Wt>>>16&255,K[11]=Wt>>>24&255,K[12]=en>>>0&255,K[13]=en>>>8&255,K[14]=en>>>16&255,K[15]=en>>>24&255,K[16]=nn>>>0&255,K[17]=nn>>>8&255,K[18]=nn>>>16&255,K[19]=nn>>>24&255,K[20]=Jt>>>0&255,K[21]=Jt>>>8&255,K[22]=Jt>>>16&255,K[23]=Jt>>>24&255,K[24]=ht>>>0&255,K[25]=ht>>>8&255,K[26]=ht>>>16&255,K[27]=ht>>>24&255,K[28]=yt>>>0&255,K[29]=yt>>>8&255,K[30]=yt>>>16&255,K[31]=yt>>>24&255,K[32]=bt>>>0&255,K[33]=bt>>>8&255,K[34]=bt>>>16&255,K[35]=bt>>>24&255,K[36]=kt>>>0&255,K[37]=kt>>>8&255,K[38]=kt>>>16&255,K[39]=kt>>>24&255,K[40]=Ct>>>0&255,K[41]=Ct>>>8&255,K[42]=Ct>>>16&255,K[43]=Ct>>>24&255,K[44]=Pt>>>0&255,K[45]=Pt>>>8&255,K[46]=Pt>>>16&255,K[47]=Pt>>>24&255,K[48]=pn>>>0&255,K[49]=pn>>>8&255,K[50]=pn>>>16&255,K[51]=pn>>>24&255,K[52]=Qt>>>0&255,K[53]=Qt>>>8&255,K[54]=Qt>>>16&255,K[55]=Qt>>>24&255,K[56]=An>>>0&255,K[57]=An>>>8&255,K[58]=An>>>16&255,K[59]=An>>>24&255,K[60]=kn>>>0&255,K[61]=kn>>>8&255,K[62]=kn>>>16&255,K[63]=kn>>>24&255}function x(K,oe,ce,D){for(var ge=D[0]&255|(D[1]&255)<<8|(D[2]&255)<<16|(D[3]&255)<<24,$e=ce[0]&255|(ce[1]&255)<<8|(ce[2]&255)<<16|(ce[3]&255)<<24,ze=ce[4]&255|(ce[5]&255)<<8|(ce[6]&255)<<16|(ce[7]&255)<<24,vt=ce[8]&255|(ce[9]&255)<<8|(ce[10]&255)<<16|(ce[11]&255)<<24,Nt=ce[12]&255|(ce[13]&255)<<8|(ce[14]&255)<<16|(ce[15]&255)<<24,Yt=D[4]&255|(D[5]&255)<<8|(D[6]&255)<<16|(D[7]&255)<<24,Kt=oe[0]&255|(oe[1]&255)<<8|(oe[2]&255)<<16|(oe[3]&255)<<24,vn=oe[4]&255|(oe[5]&255)<<8|(oe[6]&255)<<16|(oe[7]&255)<<24,$t=oe[8]&255|(oe[9]&255)<<8|(oe[10]&255)<<16|(oe[11]&255)<<24,sn=oe[12]&255|(oe[13]&255)<<8|(oe[14]&255)<<16|(oe[15]&255)<<24,wn=D[8]&255|(D[9]&255)<<8|(D[10]&255)<<16|(D[11]&255)<<24,xn=ce[16]&255|(ce[17]&255)<<8|(ce[18]&255)<<16|(ce[19]&255)<<24,tn=ce[20]&255|(ce[21]&255)<<8|(ce[22]&255)<<16|(ce[23]&255)<<24,dn=ce[24]&255|(ce[25]&255)<<8|(ce[26]&255)<<16|(ce[27]&255)<<24,cn=ce[28]&255|(ce[29]&255)<<8|(ce[30]&255)<<16|(ce[31]&255)<<24,on=D[12]&255|(D[13]&255)<<8|(D[14]&255)<<16|(D[15]&255)<<24,Xt=ge,ln=$e,Wt=ze,en=vt,nn=Nt,Jt=Yt,ht=Kt,yt=vn,bt=$t,kt=sn,Ct=wn,Pt=xn,pn=tn,Qt=dn,An=cn,kn=on,Ee,Tn=0;Tn<20;Tn+=2)Ee=Xt+pn|0,nn^=Ee<<7|Ee>>>25,Ee=nn+Xt|0,bt^=Ee<<9|Ee>>>23,Ee=bt+nn|0,pn^=Ee<<13|Ee>>>19,Ee=pn+bt|0,Xt^=Ee<<18|Ee>>>14,Ee=Jt+ln|0,kt^=Ee<<7|Ee>>>25,Ee=kt+Jt|0,Qt^=Ee<<9|Ee>>>23,Ee=Qt+kt|0,ln^=Ee<<13|Ee>>>19,Ee=ln+Qt|0,Jt^=Ee<<18|Ee>>>14,Ee=Ct+ht|0,An^=Ee<<7|Ee>>>25,Ee=An+Ct|0,Wt^=Ee<<9|Ee>>>23,Ee=Wt+An|0,ht^=Ee<<13|Ee>>>19,Ee=ht+Wt|0,Ct^=Ee<<18|Ee>>>14,Ee=kn+Pt|0,en^=Ee<<7|Ee>>>25,Ee=en+kn|0,yt^=Ee<<9|Ee>>>23,Ee=yt+en|0,Pt^=Ee<<13|Ee>>>19,Ee=Pt+yt|0,kn^=Ee<<18|Ee>>>14,Ee=Xt+en|0,ln^=Ee<<7|Ee>>>25,Ee=ln+Xt|0,Wt^=Ee<<9|Ee>>>23,Ee=Wt+ln|0,en^=Ee<<13|Ee>>>19,Ee=en+Wt|0,Xt^=Ee<<18|Ee>>>14,Ee=Jt+nn|0,ht^=Ee<<7|Ee>>>25,Ee=ht+Jt|0,yt^=Ee<<9|Ee>>>23,Ee=yt+ht|0,nn^=Ee<<13|Ee>>>19,Ee=nn+yt|0,Jt^=Ee<<18|Ee>>>14,Ee=Ct+kt|0,Pt^=Ee<<7|Ee>>>25,Ee=Pt+Ct|0,bt^=Ee<<9|Ee>>>23,Ee=bt+Pt|0,kt^=Ee<<13|Ee>>>19,Ee=kt+bt|0,Ct^=Ee<<18|Ee>>>14,Ee=kn+An|0,pn^=Ee<<7|Ee>>>25,Ee=pn+kn|0,Qt^=Ee<<9|Ee>>>23,Ee=Qt+pn|0,An^=Ee<<13|Ee>>>19,Ee=An+Qt|0,kn^=Ee<<18|Ee>>>14;K[0]=Xt>>>0&255,K[1]=Xt>>>8&255,K[2]=Xt>>>16&255,K[3]=Xt>>>24&255,K[4]=Jt>>>0&255,K[5]=Jt>>>8&255,K[6]=Jt>>>16&255,K[7]=Jt>>>24&255,K[8]=Ct>>>0&255,K[9]=Ct>>>8&255,K[10]=Ct>>>16&255,K[11]=Ct>>>24&255,K[12]=kn>>>0&255,K[13]=kn>>>8&255,K[14]=kn>>>16&255,K[15]=kn>>>24&255,K[16]=ht>>>0&255,K[17]=ht>>>8&255,K[18]=ht>>>16&255,K[19]=ht>>>24&255,K[20]=yt>>>0&255,K[21]=yt>>>8&255,K[22]=yt>>>16&255,K[23]=yt>>>24&255,K[24]=bt>>>0&255,K[25]=bt>>>8&255,K[26]=bt>>>16&255,K[27]=bt>>>24&255,K[28]=kt>>>0&255,K[29]=kt>>>8&255,K[30]=kt>>>16&255,K[31]=kt>>>24&255}function k(K,oe,ce,D){S(K,oe,ce,D)}function A(K,oe,ce,D){x(K,oe,ce,D)}var R=new Uint8Array([101,120,112,97,110,100,32,51,50,45,98,121,116,101,32,107]);function I(K,oe,ce,D,ge,$e,ze){var vt=new Uint8Array(16),Nt=new Uint8Array(64),Yt,Kt;for(Kt=0;Kt<16;Kt++)vt[Kt]=0;for(Kt=0;Kt<8;Kt++)vt[Kt]=$e[Kt];for(;ge>=64;){for(k(Nt,vt,ze,R),Kt=0;Kt<64;Kt++)K[oe+Kt]=ce[D+Kt]^Nt[Kt];for(Yt=1,Kt=8;Kt<16;Kt++)Yt=Yt+(vt[Kt]&255)|0,vt[Kt]=Yt&255,Yt>>>=8;ge-=64,oe+=64,D+=64}if(ge>0)for(k(Nt,vt,ze,R),Kt=0;Kt<ge;Kt++)K[oe+Kt]=ce[D+Kt]^Nt[Kt];return 0}function U(K,oe,ce,D,ge){var $e=new Uint8Array(16),ze=new Uint8Array(64),vt,Nt;for(Nt=0;Nt<16;Nt++)$e[Nt]=0;for(Nt=0;Nt<8;Nt++)$e[Nt]=D[Nt];for(;ce>=64;){for(k(ze,$e,ge,R),Nt=0;Nt<64;Nt++)K[oe+Nt]=ze[Nt];for(vt=1,Nt=8;Nt<16;Nt++)vt=vt+($e[Nt]&255)|0,$e[Nt]=vt&255,vt>>>=8;ce-=64,oe+=64}if(ce>0)for(k(ze,$e,ge,R),Nt=0;Nt<ce;Nt++)K[oe+Nt]=ze[Nt];return 0}function te(K,oe,ce,D,ge){var $e=new Uint8Array(32);A($e,D,ge,R);for(var ze=new Uint8Array(8),vt=0;vt<8;vt++)ze[vt]=D[vt+16];return U(K,oe,ce,ze,$e)}function G(K,oe,ce,D,ge,$e,ze){var vt=new Uint8Array(32);A(vt,$e,ze,R);for(var Nt=new Uint8Array(8),Yt=0;Yt<8;Yt++)Nt[Yt]=$e[Yt+16];return I(K,oe,ce,D,ge,Nt,vt)}var Y=function(K){this.buffer=new Uint8Array(16),this.r=new Uint16Array(10),this.h=new Uint16Array(10),this.pad=new Uint16Array(8),this.leftover=0,this.fin=0;var oe,ce,D,ge,$e,ze,vt,Nt;oe=K[0]&255|(K[1]&255)<<8,this.r[0]=oe&8191,ce=K[2]&255|(K[3]&255)<<8,this.r[1]=(oe>>>13|ce<<3)&8191,D=K[4]&255|(K[5]&255)<<8,this.r[2]=(ce>>>10|D<<6)&7939,ge=K[6]&255|(K[7]&255)<<8,this.r[3]=(D>>>7|ge<<9)&8191,$e=K[8]&255|(K[9]&255)<<8,this.r[4]=(ge>>>4|$e<<12)&255,this.r[5]=$e>>>1&8190,ze=K[10]&255|(K[11]&255)<<8,this.r[6]=($e>>>14|ze<<2)&8191,vt=K[12]&255|(K[13]&255)<<8,this.r[7]=(ze>>>11|vt<<5)&8065,Nt=K[14]&255|(K[15]&255)<<8,this.r[8]=(vt>>>8|Nt<<8)&8191,this.r[9]=Nt>>>5&127,this.pad[0]=K[16]&255|(K[17]&255)<<8,this.pad[1]=K[18]&255|(K[19]&255)<<8,this.pad[2]=K[20]&255|(K[21]&255)<<8,this.pad[3]=K[22]&255|(K[23]&255)<<8,this.pad[4]=K[24]&255|(K[25]&255)<<8,this.pad[5]=K[26]&255|(K[27]&255)<<8,this.pad[6]=K[28]&255|(K[29]&255)<<8,this.pad[7]=K[30]&255|(K[31]&255)<<8};Y.prototype.blocks=function(K,oe,ce){for(var D=this.fin?0:2048,ge,$e,ze,vt,Nt,Yt,Kt,vn,$t,sn,wn,xn,tn,dn,cn,on,Xt,ln,Wt,en=this.h[0],nn=this.h[1],Jt=this.h[2],ht=this.h[3],yt=this.h[4],bt=this.h[5],kt=this.h[6],Ct=this.h[7],Pt=this.h[8],pn=this.h[9],Qt=this.r[0],An=this.r[1],kn=this.r[2],Ee=this.r[3],Tn=this.r[4],_n=this.r[5],Mn=this.r[6],In=this.r[7],On=this.r[8],Rn=this.r[9];ce>=16;)ge=K[oe+0]&255|(K[oe+1]&255)<<8,en+=ge&8191,$e=K[oe+2]&255|(K[oe+3]&255)<<8,nn+=(ge>>>13|$e<<3)&8191,ze=K[oe+4]&255|(K[oe+5]&255)<<8,Jt+=($e>>>10|ze<<6)&8191,vt=K[oe+6]&255|(K[oe+7]&255)<<8,ht+=(ze>>>7|vt<<9)&8191,Nt=K[oe+8]&255|(K[oe+9]&255)<<8,yt+=(vt>>>4|Nt<<12)&8191,bt+=Nt>>>1&8191,Yt=K[oe+10]&255|(K[oe+11]&255)<<8,kt+=(Nt>>>14|Yt<<2)&8191,Kt=K[oe+12]&255|(K[oe+13]&255)<<8,Ct+=(Yt>>>11|Kt<<5)&8191,vn=K[oe+14]&255|(K[oe+15]&255)<<8,Pt+=(Kt>>>8|vn<<8)&8191,pn+=vn>>>5|D,$t=0,sn=$t,sn+=en*Qt,sn+=nn*(5*Rn),sn+=Jt*(5*On),sn+=ht*(5*In),sn+=yt*(5*Mn),$t=sn>>>13,sn&=8191,sn+=bt*(5*_n),sn+=kt*(5*Tn),sn+=Ct*(5*Ee),sn+=Pt*(5*kn),sn+=pn*(5*An),$t+=sn>>>13,sn&=8191,wn=$t,wn+=en*An,wn+=nn*Qt,wn+=Jt*(5*Rn),wn+=ht*(5*On),wn+=yt*(5*In),$t=wn>>>13,wn&=8191,wn+=bt*(5*Mn),wn+=kt*(5*_n),wn+=Ct*(5*Tn),wn+=Pt*(5*Ee),wn+=pn*(5*kn),$t+=wn>>>13,wn&=8191,xn=$t,xn+=en*kn,xn+=nn*An,xn+=Jt*Qt,xn+=ht*(5*Rn),xn+=yt*(5*On),$t=xn>>>13,xn&=8191,xn+=bt*(5*In),xn+=kt*(5*Mn),xn+=Ct*(5*_n),xn+=Pt*(5*Tn),xn+=pn*(5*Ee),$t+=xn>>>13,xn&=8191,tn=$t,tn+=en*Ee,tn+=nn*kn,tn+=Jt*An,tn+=ht*Qt,tn+=yt*(5*Rn),$t=tn>>>13,tn&=8191,tn+=bt*(5*On),tn+=kt*(5*In),tn+=Ct*(5*Mn),tn+=Pt*(5*_n),tn+=pn*(5*Tn),$t+=tn>>>13,tn&=8191,dn=$t,dn+=en*Tn,dn+=nn*Ee,dn+=Jt*kn,dn+=ht*An,dn+=yt*Qt,$t=dn>>>13,dn&=8191,dn+=bt*(5*Rn),dn+=kt*(5*On),dn+=Ct*(5*In),dn+=Pt*(5*Mn),dn+=pn*(5*_n),$t+=dn>>>13,dn&=8191,cn=$t,cn+=en*_n,cn+=nn*Tn,cn+=Jt*Ee,cn+=ht*kn,cn+=yt*An,$t=cn>>>13,cn&=8191,cn+=bt*Qt,cn+=kt*(5*Rn),cn+=Ct*(5*On),cn+=Pt*(5*In),cn+=pn*(5*Mn),$t+=cn>>>13,cn&=8191,on=$t,on+=en*Mn,on+=nn*_n,on+=Jt*Tn,on+=ht*Ee,on+=yt*kn,$t=on>>>13,on&=8191,on+=bt*An,on+=kt*Qt,on+=Ct*(5*Rn),on+=Pt*(5*On),on+=pn*(5*In),$t+=on>>>13,on&=8191,Xt=$t,Xt+=en*In,Xt+=nn*Mn,Xt+=Jt*_n,Xt+=ht*Tn,Xt+=yt*Ee,$t=Xt>>>13,Xt&=8191,Xt+=bt*kn,Xt+=kt*An,Xt+=Ct*Qt,Xt+=Pt*(5*Rn),Xt+=pn*(5*On),$t+=Xt>>>13,Xt&=8191,ln=$t,ln+=en*On,ln+=nn*In,ln+=Jt*Mn,ln+=ht*_n,ln+=yt*Tn,$t=ln>>>13,ln&=8191,ln+=bt*Ee,ln+=kt*kn,ln+=Ct*An,ln+=Pt*Qt,ln+=pn*(5*Rn),$t+=ln>>>13,ln&=8191,Wt=$t,Wt+=en*Rn,Wt+=nn*On,Wt+=Jt*In,Wt+=ht*Mn,Wt+=yt*_n,$t=Wt>>>13,Wt&=8191,Wt+=bt*Tn,Wt+=kt*Ee,Wt+=Ct*kn,Wt+=Pt*An,Wt+=pn*Qt,$t+=Wt>>>13,Wt&=8191,$t=($t<<2)+$t|0,$t=$t+sn|0,sn=$t&8191,$t=$t>>>13,wn+=$t,en=sn,nn=wn,Jt=xn,ht=tn,yt=dn,bt=cn,kt=on,Ct=Xt,Pt=ln,pn=Wt,oe+=16,ce-=16;this.h[0]=en,this.h[1]=nn,this.h[2]=Jt,this.h[3]=ht,this.h[4]=yt,this.h[5]=bt,this.h[6]=kt,this.h[7]=Ct,this.h[8]=Pt,this.h[9]=pn},Y.prototype.finish=function(K,oe){var ce=new Uint16Array(10),D,ge,$e,ze;if(this.leftover){for(ze=this.leftover,this.buffer[ze++]=1;ze<16;ze++)this.buffer[ze]=0;this.fin=1,this.blocks(this.buffer,0,16)}for(D=this.h[1]>>>13,this.h[1]&=8191,ze=2;ze<10;ze++)this.h[ze]+=D,D=this.h[ze]>>>13,this.h[ze]&=8191;for(this.h[0]+=D*5,D=this.h[0]>>>13,this.h[0]&=8191,this.h[1]+=D,D=this.h[1]>>>13,this.h[1]&=8191,this.h[2]+=D,ce[0]=this.h[0]+5,D=ce[0]>>>13,ce[0]&=8191,ze=1;ze<10;ze++)ce[ze]=this.h[ze]+D,D=ce[ze]>>>13,ce[ze]&=8191;for(ce[9]-=8192,ge=(D^1)-1,ze=0;ze<10;ze++)ce[ze]&=ge;for(ge=~ge,ze=0;ze<10;ze++)this.h[ze]=this.h[ze]&ge|ce[ze];for(this.h[0]=(this.h[0]|this.h[1]<<13)&65535,this.h[1]=(this.h[1]>>>3|this.h[2]<<10)&65535,this.h[2]=(this.h[2]>>>6|this.h[3]<<7)&65535,this.h[3]=(this.h[3]>>>9|this.h[4]<<4)&65535,this.h[4]=(this.h[4]>>>12|this.h[5]<<1|this.h[6]<<14)&65535,this.h[5]=(this.h[6]>>>2|this.h[7]<<11)&65535,this.h[6]=(this.h[7]>>>5|this.h[8]<<8)&65535,this.h[7]=(this.h[8]>>>8|this.h[9]<<5)&65535,$e=this.h[0]+this.pad[0],this.h[0]=$e&65535,ze=1;ze<8;ze++)$e=(this.h[ze]+this.pad[ze]|0)+($e>>>16)|0,this.h[ze]=$e&65535;K[oe+0]=this.h[0]>>>0&255,K[oe+1]=this.h[0]>>>8&255,K[oe+2]=this.h[1]>>>0&255,K[oe+3]=this.h[1]>>>8&255,K[oe+4]=this.h[2]>>>0&255,K[oe+5]=this.h[2]>>>8&255,K[oe+6]=this.h[3]>>>0&255,K[oe+7]=this.h[3]>>>8&255,K[oe+8]=this.h[4]>>>0&255,K[oe+9]=this.h[4]>>>8&255,K[oe+10]=this.h[5]>>>0&255,K[oe+11]=this.h[5]>>>8&255,K[oe+12]=this.h[6]>>>0&255,K[oe+13]=this.h[6]>>>8&255,K[oe+14]=this.h[7]>>>0&255,K[oe+15]=this.h[7]>>>8&255},Y.prototype.update=function(K,oe,ce){var D,ge;if(this.leftover){for(ge=16-this.leftover,ge>ce&&(ge=ce),D=0;D<ge;D++)this.buffer[this.leftover+D]=K[oe+D];if(ce-=ge,oe+=ge,this.leftover+=ge,this.leftover<16)return;this.blocks(this.buffer,0,16),this.leftover=0}if(ce>=16&&(ge=ce-ce%16,this.blocks(K,oe,ge),oe+=ge,ce-=ge),ce){for(D=0;D<ce;D++)this.buffer[this.leftover+D]=K[oe+D];this.leftover+=ce}};function O(K,oe,ce,D,ge,$e){var ze=new Y($e);return ze.update(ce,D,ge),ze.finish(K,oe),0}function N(K,oe,ce,D,ge,$e){var ze=new Uint8Array(16);return O(ze,0,ce,D,ge,$e),w(K,oe,ze,0)}function Q(K,oe,ce,D,ge){var $e;if(ce<32)return-1;for(G(K,0,oe,0,ce,D,ge),O(K,16,K,32,ce-32,K),$e=0;$e<16;$e++)K[$e]=0;return 0}function q(K,oe,ce,D,ge){var $e,ze=new Uint8Array(32);if(ce<32||(te(ze,0,32,D,ge),N(oe,16,oe,32,ce-32,ze)!==0))return-1;for(G(K,0,oe,0,ce,D,ge),$e=0;$e<32;$e++)K[$e]=0;return 0}function ee(K,oe){var ce;for(ce=0;ce<16;ce++)K[ce]=oe[ce]|0}function ne(K){var oe,ce,D=1;for(oe=0;oe<16;oe++)ce=K[oe]+D+65535,D=Math.floor(ce/65536),K[oe]=ce-D*65536;K[0]+=D-1+37*(D-1)}function B(K,oe,ce){for(var D,ge=~(ce-1),$e=0;$e<16;$e++)D=ge&(K[$e]^oe[$e]),K[$e]^=D,oe[$e]^=D}function z(K,oe){var ce,D,ge,$e=t(),ze=t();for(ce=0;ce<16;ce++)ze[ce]=oe[ce];for(ne(ze),ne(ze),ne(ze),D=0;D<2;D++){for($e[0]=ze[0]-65517,ce=1;ce<15;ce++)$e[ce]=ze[ce]-65535-($e[ce-1]>>16&1),$e[ce-1]&=65535;$e[15]=ze[15]-32767-($e[14]>>16&1),ge=$e[15]>>16&1,$e[14]&=65535,B(ze,$e,1-ge)}for(ce=0;ce<16;ce++)K[2*ce]=ze[ce]&255,K[2*ce+1]=ze[ce]>>8}function $(K,oe){var ce=new Uint8Array(32),D=new Uint8Array(32);return z(ce,K),z(D,oe),C(ce,0,D,0)}function V(K){var oe=new Uint8Array(32);return z(oe,K),oe[0]&1}function Z(K,oe){var ce;for(ce=0;ce<16;ce++)K[ce]=oe[2*ce]+(oe[2*ce+1]<<8);K[15]&=32767}function ae(K,oe,ce){for(var D=0;D<16;D++)K[D]=oe[D]+ce[D]}function Ae(K,oe,ce){for(var D=0;D<16;D++)K[D]=oe[D]-ce[D]}function be(K,oe,ce){var D,ge,$e=0,ze=0,vt=0,Nt=0,Yt=0,Kt=0,vn=0,$t=0,sn=0,wn=0,xn=0,tn=0,dn=0,cn=0,on=0,Xt=0,ln=0,Wt=0,en=0,nn=0,Jt=0,ht=0,yt=0,bt=0,kt=0,Ct=0,Pt=0,pn=0,Qt=0,An=0,kn=0,Ee=ce[0],Tn=ce[1],_n=ce[2],Mn=ce[3],In=ce[4],On=ce[5],Rn=ce[6],rr=ce[7],qn=ce[8],Vn=ce[9],cr=ce[10],mn=ce[11],Jn=ce[12],br=ce[13],sr=ce[14],$n=ce[15];D=oe[0],$e+=D*Ee,ze+=D*Tn,vt+=D*_n,Nt+=D*Mn,Yt+=D*In,Kt+=D*On,vn+=D*Rn,$t+=D*rr,sn+=D*qn,wn+=D*Vn,xn+=D*cr,tn+=D*mn,dn+=D*Jn,cn+=D*br,on+=D*sr,Xt+=D*$n,D=oe[1],ze+=D*Ee,vt+=D*Tn,Nt+=D*_n,Yt+=D*Mn,Kt+=D*In,vn+=D*On,$t+=D*Rn,sn+=D*rr,wn+=D*qn,xn+=D*Vn,tn+=D*cr,dn+=D*mn,cn+=D*Jn,on+=D*br,Xt+=D*sr,ln+=D*$n,D=oe[2],vt+=D*Ee,Nt+=D*Tn,Yt+=D*_n,Kt+=D*Mn,vn+=D*In,$t+=D*On,sn+=D*Rn,wn+=D*rr,xn+=D*qn,tn+=D*Vn,dn+=D*cr,cn+=D*mn,on+=D*Jn,Xt+=D*br,ln+=D*sr,Wt+=D*$n,D=oe[3],Nt+=D*Ee,Yt+=D*Tn,Kt+=D*_n,vn+=D*Mn,$t+=D*In,sn+=D*On,wn+=D*Rn,xn+=D*rr,tn+=D*qn,dn+=D*Vn,cn+=D*cr,on+=D*mn,Xt+=D*Jn,ln+=D*br,Wt+=D*sr,en+=D*$n,D=oe[4],Yt+=D*Ee,Kt+=D*Tn,vn+=D*_n,$t+=D*Mn,sn+=D*In,wn+=D*On,xn+=D*Rn,tn+=D*rr,dn+=D*qn,cn+=D*Vn,on+=D*cr,Xt+=D*mn,ln+=D*Jn,Wt+=D*br,en+=D*sr,nn+=D*$n,D=oe[5],Kt+=D*Ee,vn+=D*Tn,$t+=D*_n,sn+=D*Mn,wn+=D*In,xn+=D*On,tn+=D*Rn,dn+=D*rr,cn+=D*qn,on+=D*Vn,Xt+=D*cr,ln+=D*mn,Wt+=D*Jn,en+=D*br,nn+=D*sr,Jt+=D*$n,D=oe[6],vn+=D*Ee,$t+=D*Tn,sn+=D*_n,wn+=D*Mn,xn+=D*In,tn+=D*On,dn+=D*Rn,cn+=D*rr,on+=D*qn,Xt+=D*Vn,ln+=D*cr,Wt+=D*mn,en+=D*Jn,nn+=D*br,Jt+=D*sr,ht+=D*$n,D=oe[7],$t+=D*Ee,sn+=D*Tn,wn+=D*_n,xn+=D*Mn,tn+=D*In,dn+=D*On,cn+=D*Rn,on+=D*rr,Xt+=D*qn,ln+=D*Vn,Wt+=D*cr,en+=D*mn,nn+=D*Jn,Jt+=D*br,ht+=D*sr,yt+=D*$n,D=oe[8],sn+=D*Ee,wn+=D*Tn,xn+=D*_n,tn+=D*Mn,dn+=D*In,cn+=D*On,on+=D*Rn,Xt+=D*rr,ln+=D*qn,Wt+=D*Vn,en+=D*cr,nn+=D*mn,Jt+=D*Jn,ht+=D*br,yt+=D*sr,bt+=D*$n,D=oe[9],wn+=D*Ee,xn+=D*Tn,tn+=D*_n,dn+=D*Mn,cn+=D*In,on+=D*On,Xt+=D*Rn,ln+=D*rr,Wt+=D*qn,en+=D*Vn,nn+=D*cr,Jt+=D*mn,ht+=D*Jn,yt+=D*br,bt+=D*sr,kt+=D*$n,D=oe[10],xn+=D*Ee,tn+=D*Tn,dn+=D*_n,cn+=D*Mn,on+=D*In,Xt+=D*On,ln+=D*Rn,Wt+=D*rr,en+=D*qn,nn+=D*Vn,Jt+=D*cr,ht+=D*mn,yt+=D*Jn,bt+=D*br,kt+=D*sr,Ct+=D*$n,D=oe[11],tn+=D*Ee,dn+=D*Tn,cn+=D*_n,on+=D*Mn,Xt+=D*In,ln+=D*On,Wt+=D*Rn,en+=D*rr,nn+=D*qn,Jt+=D*Vn,ht+=D*cr,yt+=D*mn,bt+=D*Jn,kt+=D*br,Ct+=D*sr,Pt+=D*$n,D=oe[12],dn+=D*Ee,cn+=D*Tn,on+=D*_n,Xt+=D*Mn,ln+=D*In,Wt+=D*On,en+=D*Rn,nn+=D*rr,Jt+=D*qn,ht+=D*Vn,yt+=D*cr,bt+=D*mn,kt+=D*Jn,Ct+=D*br,Pt+=D*sr,pn+=D*$n,D=oe[13],cn+=D*Ee,on+=D*Tn,Xt+=D*_n,ln+=D*Mn,Wt+=D*In,en+=D*On,nn+=D*Rn,Jt+=D*rr,ht+=D*qn,yt+=D*Vn,bt+=D*cr,kt+=D*mn,Ct+=D*Jn,Pt+=D*br,pn+=D*sr,Qt+=D*$n,D=oe[14],on+=D*Ee,Xt+=D*Tn,ln+=D*_n,Wt+=D*Mn,en+=D*In,nn+=D*On,Jt+=D*Rn,ht+=D*rr,yt+=D*qn,bt+=D*Vn,kt+=D*cr,Ct+=D*mn,Pt+=D*Jn,pn+=D*br,Qt+=D*sr,An+=D*$n,D=oe[15],Xt+=D*Ee,ln+=D*Tn,Wt+=D*_n,en+=D*Mn,nn+=D*In,Jt+=D*On,ht+=D*Rn,yt+=D*rr,bt+=D*qn,kt+=D*Vn,Ct+=D*cr,Pt+=D*mn,pn+=D*Jn,Qt+=D*br,An+=D*sr,kn+=D*$n,$e+=38*ln,ze+=38*Wt,vt+=38*en,Nt+=38*nn,Yt+=38*Jt,Kt+=38*ht,vn+=38*yt,$t+=38*bt,sn+=38*kt,wn+=38*Ct,xn+=38*Pt,tn+=38*pn,dn+=38*Qt,cn+=38*An,on+=38*kn,ge=1,D=$e+ge+65535,ge=Math.floor(D/65536),$e=D-ge*65536,D=ze+ge+65535,ge=Math.floor(D/65536),ze=D-ge*65536,D=vt+ge+65535,ge=Math.floor(D/65536),vt=D-ge*65536,D=Nt+ge+65535,ge=Math.floor(D/65536),Nt=D-ge*65536,D=Yt+ge+65535,ge=Math.floor(D/65536),Yt=D-ge*65536,D=Kt+ge+65535,ge=Math.floor(D/65536),Kt=D-ge*65536,D=vn+ge+65535,ge=Math.floor(D/65536),vn=D-ge*65536,D=$t+ge+65535,ge=Math.floor(D/65536),$t=D-ge*65536,D=sn+ge+65535,ge=Math.floor(D/65536),sn=D-ge*65536,D=wn+ge+65535,ge=Math.floor(D/65536),wn=D-ge*65536,D=xn+ge+65535,ge=Math.floor(D/65536),xn=D-ge*65536,D=tn+ge+65535,ge=Math.floor(D/65536),tn=D-ge*65536,D=dn+ge+65535,ge=Math.floor(D/65536),dn=D-ge*65536,D=cn+ge+65535,ge=Math.floor(D/65536),cn=D-ge*65536,D=on+ge+65535,ge=Math.floor(D/65536),on=D-ge*65536,D=Xt+ge+65535,ge=Math.floor(D/65536),Xt=D-ge*65536,$e+=ge-1+37*(ge-1),ge=1,D=$e+ge+65535,ge=Math.floor(D/65536),$e=D-ge*65536,D=ze+ge+65535,ge=Math.floor(D/65536),ze=D-ge*65536,D=vt+ge+65535,ge=Math.floor(D/65536),vt=D-ge*65536,D=Nt+ge+65535,ge=Math.floor(D/65536),Nt=D-ge*65536,D=Yt+ge+65535,ge=Math.floor(D/65536),Yt=D-ge*65536,D=Kt+ge+65535,ge=Math.floor(D/65536),Kt=D-ge*65536,D=vn+ge+65535,ge=Math.floor(D/65536),vn=D-ge*65536,D=$t+ge+65535,ge=Math.floor(D/65536),$t=D-ge*65536,D=sn+ge+65535,ge=Math.floor(D/65536),sn=D-ge*65536,D=wn+ge+65535,ge=Math.floor(D/65536),wn=D-ge*65536,D=xn+ge+65535,ge=Math.floor(D/65536),xn=D-ge*65536,D=tn+ge+65535,ge=Math.floor(D/65536),tn=D-ge*65536,D=dn+ge+65535,ge=Math.floor(D/65536),dn=D-ge*65536,D=cn+ge+65535,ge=Math.floor(D/65536),cn=D-ge*65536,D=on+ge+65535,ge=Math.floor(D/65536),on=D-ge*65536,D=Xt+ge+65535,ge=Math.floor(D/65536),Xt=D-ge*65536,$e+=ge-1+37*(ge-1),K[0]=$e,K[1]=ze,K[2]=vt,K[3]=Nt,K[4]=Yt,K[5]=Kt,K[6]=vn,K[7]=$t,K[8]=sn,K[9]=wn,K[10]=xn,K[11]=tn,K[12]=dn,K[13]=cn,K[14]=on,K[15]=Xt}function Ge(K,oe){be(K,oe,oe)}function Te(K,oe){var ce=t(),D;for(D=0;D<16;D++)ce[D]=oe[D];for(D=253;D>=0;D--)Ge(ce,ce),D!==2&&D!==4&&be(ce,ce,oe);for(D=0;D<16;D++)K[D]=ce[D]}function ve(K,oe){var ce=t(),D;for(D=0;D<16;D++)ce[D]=oe[D];for(D=250;D>=0;D--)Ge(ce,ce),D!==1&&be(ce,ce,oe);for(D=0;D<16;D++)K[D]=ce[D]}function ke(K,oe,ce){var D=new Uint8Array(32),ge=new Float64Array(80),$e,ze,vt=t(),Nt=t(),Yt=t(),Kt=t(),vn=t(),$t=t();for(ze=0;ze<31;ze++)D[ze]=oe[ze];for(D[31]=oe[31]&127|64,D[0]&=248,Z(ge,ce),ze=0;ze<16;ze++)Nt[ze]=ge[ze],Kt[ze]=vt[ze]=Yt[ze]=0;for(vt[0]=Kt[0]=1,ze=254;ze>=0;--ze)$e=D[ze>>>3]>>>(ze&7)&1,B(vt,Nt,$e),B(Yt,Kt,$e),ae(vn,vt,Yt),Ae(vt,vt,Yt),ae(Yt,Nt,Kt),Ae(Nt,Nt,Kt),Ge(Kt,vn),Ge($t,vt),be(vt,Yt,vt),be(Yt,Nt,vn),ae(vn,vt,Yt),Ae(vt,vt,Yt),Ge(Nt,vt),Ae(Yt,Kt,$t),be(vt,Yt,c),ae(vt,vt,Kt),be(Yt,Yt,vt),be(vt,Kt,$t),be(Kt,Nt,ge),Ge(Nt,vn),B(vt,Nt,$e),B(Yt,Kt,$e);for(ze=0;ze<16;ze++)ge[ze+16]=vt[ze],ge[ze+32]=Yt[ze],ge[ze+48]=Nt[ze],ge[ze+64]=Kt[ze];var sn=ge.subarray(32),wn=ge.subarray(16);return Te(sn,sn),be(wn,wn,sn),z(K,wn),0}function Me(K,oe){return ke(K,oe,a)}function Ie(K,oe){return n(oe,32),Me(K,oe)}function Ce(K,oe,ce){var D=new Uint8Array(32);return ke(D,ce,oe),A(K,s,D,R)}var ot=Q,et=q;function me(K,oe,ce,D,ge,$e){var ze=new Uint8Array(32);return Ce(ze,ge,$e),ot(K,oe,ce,D,ze)}function de(K,oe,ce,D,ge,$e){var ze=new Uint8Array(32);return Ce(ze,ge,$e),et(K,oe,ce,D,ze)}var Be=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591];function Je(K,oe,ce,D){for(var ge=new Int32Array(16),$e=new Int32Array(16),ze,vt,Nt,Yt,Kt,vn,$t,sn,wn,xn,tn,dn,cn,on,Xt,ln,Wt,en,nn,Jt,ht,yt,bt,kt,Ct,Pt,pn=K[0],Qt=K[1],An=K[2],kn=K[3],Ee=K[4],Tn=K[5],_n=K[6],Mn=K[7],In=oe[0],On=oe[1],Rn=oe[2],rr=oe[3],qn=oe[4],Vn=oe[5],cr=oe[6],mn=oe[7],Jn=0;D>=128;){for(nn=0;nn<16;nn++)Jt=8*nn+Jn,ge[nn]=ce[Jt+0]<<24|ce[Jt+1]<<16|ce[Jt+2]<<8|ce[Jt+3],$e[nn]=ce[Jt+4]<<24|ce[Jt+5]<<16|ce[Jt+6]<<8|ce[Jt+7];for(nn=0;nn<80;nn++)if(ze=pn,vt=Qt,Nt=An,Yt=kn,Kt=Ee,vn=Tn,$t=_n,sn=Mn,wn=In,xn=On,tn=Rn,dn=rr,cn=qn,on=Vn,Xt=cr,ln=mn,ht=Mn,yt=mn,bt=yt&65535,kt=yt>>>16,Ct=ht&65535,Pt=ht>>>16,ht=(Ee>>>14|qn<<18)^(Ee>>>18|qn<<14)^(qn>>>9|Ee<<23),yt=(qn>>>14|Ee<<18)^(qn>>>18|Ee<<14)^(Ee>>>9|qn<<23),bt+=yt&65535,kt+=yt>>>16,Ct+=ht&65535,Pt+=ht>>>16,ht=Ee&Tn^~Ee&_n,yt=qn&Vn^~qn&cr,bt+=yt&65535,kt+=yt>>>16,Ct+=ht&65535,Pt+=ht>>>16,ht=Be[nn*2],yt=Be[nn*2+1],bt+=yt&65535,kt+=yt>>>16,Ct+=ht&65535,Pt+=ht>>>16,ht=ge[nn%16],yt=$e[nn%16],bt+=yt&65535,kt+=yt>>>16,Ct+=ht&65535,Pt+=ht>>>16,kt+=bt>>>16,Ct+=kt>>>16,Pt+=Ct>>>16,Wt=Ct&65535|Pt<<16,en=bt&65535|kt<<16,ht=Wt,yt=en,bt=yt&65535,kt=yt>>>16,Ct=ht&65535,Pt=ht>>>16,ht=(pn>>>28|In<<4)^(In>>>2|pn<<30)^(In>>>7|pn<<25),yt=(In>>>28|pn<<4)^(pn>>>2|In<<30)^(pn>>>7|In<<25),bt+=yt&65535,kt+=yt>>>16,Ct+=ht&65535,Pt+=ht>>>16,ht=pn&Qt^pn&An^Qt&An,yt=In&On^In&Rn^On&Rn,bt+=yt&65535,kt+=yt>>>16,Ct+=ht&65535,Pt+=ht>>>16,kt+=bt>>>16,Ct+=kt>>>16,Pt+=Ct>>>16,sn=Ct&65535|Pt<<16,ln=bt&65535|kt<<16,ht=Yt,yt=dn,bt=yt&65535,kt=yt>>>16,Ct=ht&65535,Pt=ht>>>16,ht=Wt,yt=en,bt+=yt&65535,kt+=yt>>>16,Ct+=ht&65535,Pt+=ht>>>16,kt+=bt>>>16,Ct+=kt>>>16,Pt+=Ct>>>16,Yt=Ct&65535|Pt<<16,dn=bt&65535|kt<<16,Qt=ze,An=vt,kn=Nt,Ee=Yt,Tn=Kt,_n=vn,Mn=$t,pn=sn,On=wn,Rn=xn,rr=tn,qn=dn,Vn=cn,cr=on,mn=Xt,In=ln,nn%16===15)for(Jt=0;Jt<16;Jt++)ht=ge[Jt],yt=$e[Jt],bt=yt&65535,kt=yt>>>16,Ct=ht&65535,Pt=ht>>>16,ht=ge[(Jt+9)%16],yt=$e[(Jt+9)%16],bt+=yt&65535,kt+=yt>>>16,Ct+=ht&65535,Pt+=ht>>>16,Wt=ge[(Jt+1)%16],en=$e[(Jt+1)%16],ht=(Wt>>>1|en<<31)^(Wt>>>8|en<<24)^Wt>>>7,yt=(en>>>1|Wt<<31)^(en>>>8|Wt<<24)^(en>>>7|Wt<<25),bt+=yt&65535,kt+=yt>>>16,Ct+=ht&65535,Pt+=ht>>>16,Wt=ge[(Jt+14)%16],en=$e[(Jt+14)%16],ht=(Wt>>>19|en<<13)^(en>>>29|Wt<<3)^Wt>>>6,yt=(en>>>19|Wt<<13)^(Wt>>>29|en<<3)^(en>>>6|Wt<<26),bt+=yt&65535,kt+=yt>>>16,Ct+=ht&65535,Pt+=ht>>>16,kt+=bt>>>16,Ct+=kt>>>16,Pt+=Ct>>>16,ge[Jt]=Ct&65535|Pt<<16,$e[Jt]=bt&65535|kt<<16;ht=pn,yt=In,bt=yt&65535,kt=yt>>>16,Ct=ht&65535,Pt=ht>>>16,ht=K[0],yt=oe[0],bt+=yt&65535,kt+=yt>>>16,Ct+=ht&65535,Pt+=ht>>>16,kt+=bt>>>16,Ct+=kt>>>16,Pt+=Ct>>>16,K[0]=pn=Ct&65535|Pt<<16,oe[0]=In=bt&65535|kt<<16,ht=Qt,yt=On,bt=yt&65535,kt=yt>>>16,Ct=ht&65535,Pt=ht>>>16,ht=K[1],yt=oe[1],bt+=yt&65535,kt+=yt>>>16,Ct+=ht&65535,Pt+=ht>>>16,kt+=bt>>>16,Ct+=kt>>>16,Pt+=Ct>>>16,K[1]=Qt=Ct&65535|Pt<<16,oe[1]=On=bt&65535|kt<<16,ht=An,yt=Rn,bt=yt&65535,kt=yt>>>16,Ct=ht&65535,Pt=ht>>>16,ht=K[2],yt=oe[2],bt+=yt&65535,kt+=yt>>>16,Ct+=ht&65535,Pt+=ht>>>16,kt+=bt>>>16,Ct+=kt>>>16,Pt+=Ct>>>16,K[2]=An=Ct&65535|Pt<<16,oe[2]=Rn=bt&65535|kt<<16,ht=kn,yt=rr,bt=yt&65535,kt=yt>>>16,Ct=ht&65535,Pt=ht>>>16,ht=K[3],yt=oe[3],bt+=yt&65535,kt+=yt>>>16,Ct+=ht&65535,Pt+=ht>>>16,kt+=bt>>>16,Ct+=kt>>>16,Pt+=Ct>>>16,K[3]=kn=Ct&65535|Pt<<16,oe[3]=rr=bt&65535|kt<<16,ht=Ee,yt=qn,bt=yt&65535,kt=yt>>>16,Ct=ht&65535,Pt=ht>>>16,ht=K[4],yt=oe[4],bt+=yt&65535,kt+=yt>>>16,Ct+=ht&65535,Pt+=ht>>>16,kt+=bt>>>16,Ct+=kt>>>16,Pt+=Ct>>>16,K[4]=Ee=Ct&65535|Pt<<16,oe[4]=qn=bt&65535|kt<<16,ht=Tn,yt=Vn,bt=yt&65535,kt=yt>>>16,Ct=ht&65535,Pt=ht>>>16,ht=K[5],yt=oe[5],bt+=yt&65535,kt+=yt>>>16,Ct+=ht&65535,Pt+=ht>>>16,kt+=bt>>>16,Ct+=kt>>>16,Pt+=Ct>>>16,K[5]=Tn=Ct&65535|Pt<<16,oe[5]=Vn=bt&65535|kt<<16,ht=_n,yt=cr,bt=yt&65535,kt=yt>>>16,Ct=ht&65535,Pt=ht>>>16,ht=K[6],yt=oe[6],bt+=yt&65535,kt+=yt>>>16,Ct+=ht&65535,Pt+=ht>>>16,kt+=bt>>>16,Ct+=kt>>>16,Pt+=Ct>>>16,K[6]=_n=Ct&65535|Pt<<16,oe[6]=cr=bt&65535|kt<<16,ht=Mn,yt=mn,bt=yt&65535,kt=yt>>>16,Ct=ht&65535,Pt=ht>>>16,ht=K[7],yt=oe[7],bt+=yt&65535,kt+=yt>>>16,Ct+=ht&65535,Pt+=ht>>>16,kt+=bt>>>16,Ct+=kt>>>16,Pt+=Ct>>>16,K[7]=Mn=Ct&65535|Pt<<16,oe[7]=mn=bt&65535|kt<<16,Jn+=128,D-=128}return D}function rt(K,oe,ce){var D=new Int32Array(8),ge=new Int32Array(8),$e=new Uint8Array(256),ze,vt=ce;for(D[0]=1779033703,D[1]=3144134277,D[2]=1013904242,D[3]=2773480762,D[4]=1359893119,D[5]=2600822924,D[6]=528734635,D[7]=1541459225,ge[0]=4089235720,ge[1]=2227873595,ge[2]=4271175723,ge[3]=1595750129,ge[4]=2917565137,ge[5]=725511199,ge[6]=4215389547,ge[7]=327033209,Je(D,ge,oe,ce),ce%=128,ze=0;ze<ce;ze++)$e[ze]=oe[vt-ce+ze];for($e[ce]=128,ce=256-128*(ce<112?1:0),$e[ce-9]=0,b($e,ce-8,vt/536870912|0,vt<<3),Je(D,ge,$e,ce),ze=0;ze<8;ze++)b(K,8*ze,D[ze],ge[ze]);return 0}function at(K,oe){var ce=t(),D=t(),ge=t(),$e=t(),ze=t(),vt=t(),Nt=t(),Yt=t(),Kt=t();Ae(ce,K[1],K[0]),Ae(Kt,oe[1],oe[0]),be(ce,ce,Kt),ae(D,K[0],K[1]),ae(Kt,oe[0],oe[1]),be(D,D,Kt),be(ge,K[3],oe[3]),be(ge,ge,d),be($e,K[2],oe[2]),ae($e,$e,$e),Ae(ze,D,ce),Ae(vt,$e,ge),ae(Nt,$e,ge),ae(Yt,D,ce),be(K[0],ze,vt),be(K[1],Yt,Nt),be(K[2],Nt,vt),be(K[3],ze,Yt)}function ye(K,oe,ce){var D;for(D=0;D<4;D++)B(K[D],oe[D],ce)}function it(K,oe){var ce=t(),D=t(),ge=t();Te(ge,oe[2]),be(ce,oe[0],ge),be(D,oe[1],ge),z(K,D),K[31]^=V(ce)<<7}function Mt(K,oe,ce){var D,ge;for(ee(K[0],l),ee(K[1],u),ee(K[2],u),ee(K[3],l),ge=255;ge>=0;--ge)D=ce[ge/8|0]>>(ge&7)&1,ye(K,oe,D),at(oe,K),at(K,K),ye(K,oe,D)}function nt(K,oe){var ce=[t(),t(),t(),t()];ee(ce[0],p),ee(ce[1],m),ee(ce[2],u),be(ce[3],p,m),Mt(K,ce,oe)}function Zt(K,oe,ce){var D=new Uint8Array(64),ge=[t(),t(),t(),t()],$e;for(ce||n(oe,32),rt(D,oe,32),D[0]&=248,D[31]&=127,D[31]|=64,nt(ge,D),it(K,ge),$e=0;$e<32;$e++)oe[$e+32]=K[$e];return 0}var j=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]);function W(K,oe){var ce,D,ge,$e;for(D=63;D>=32;--D){for(ce=0,ge=D-32,$e=D-12;ge<$e;++ge)oe[ge]+=ce-16*oe[D]*j[ge-(D-32)],ce=Math.floor((oe[ge]+128)/256),oe[ge]-=ce*256;oe[ge]+=ce,oe[D]=0}for(ce=0,ge=0;ge<32;ge++)oe[ge]+=ce-(oe[31]>>4)*j[ge],ce=oe[ge]>>8,oe[ge]&=255;for(ge=0;ge<32;ge++)oe[ge]-=ce*j[ge];for(D=0;D<32;D++)oe[D+1]+=oe[D]>>8,K[D]=oe[D]&255}function se(K){var oe=new Float64Array(64),ce;for(ce=0;ce<64;ce++)oe[ce]=K[ce];for(ce=0;ce<64;ce++)K[ce]=0;W(K,oe)}function Oe(K,oe,ce,D){var ge=new Uint8Array(64),$e=new Uint8Array(64),ze=new Uint8Array(64),vt,Nt,Yt=new Float64Array(64),Kt=[t(),t(),t(),t()];rt(ge,D,32),ge[0]&=248,ge[31]&=127,ge[31]|=64;var vn=ce+64;for(vt=0;vt<ce;vt++)K[64+vt]=oe[vt];for(vt=0;vt<32;vt++)K[32+vt]=ge[32+vt];for(rt(ze,K.subarray(32),ce+32),se(ze),nt(Kt,ze),it(K,Kt),vt=32;vt<64;vt++)K[vt]=D[vt];for(rt($e,K,ce+64),se($e),vt=0;vt<64;vt++)Yt[vt]=0;for(vt=0;vt<32;vt++)Yt[vt]=ze[vt];for(vt=0;vt<32;vt++)for(Nt=0;Nt<32;Nt++)Yt[vt+Nt]+=$e[vt]*ge[Nt];return W(K.subarray(32),Yt),vn}function Ke(K,oe){var ce=t(),D=t(),ge=t(),$e=t(),ze=t(),vt=t(),Nt=t();return ee(K[2],u),Z(K[1],oe),Ge(ge,K[1]),be($e,ge,f),Ae(ge,ge,K[2]),ae($e,K[2],$e),Ge(ze,$e),Ge(vt,ze),be(Nt,vt,ze),be(ce,Nt,ge),be(ce,ce,$e),ve(ce,ce),be(ce,ce,ge),be(ce,ce,$e),be(ce,ce,$e),be(K[0],ce,$e),Ge(D,K[0]),be(D,D,$e),$(D,ge)&&be(K[0],K[0],v),Ge(D,K[0]),be(D,D,$e),$(D,ge)?-1:(V(K[0])===oe[31]>>7&&Ae(K[0],l,K[0]),be(K[3],K[0],K[1]),0)}function gt(K,oe,ce,D){var ge,$e=new Uint8Array(32),ze=new Uint8Array(64),vt=[t(),t(),t(),t()],Nt=[t(),t(),t(),t()];if(ce<64||Ke(Nt,D))return-1;for(ge=0;ge<ce;ge++)K[ge]=oe[ge];for(ge=0;ge<32;ge++)K[ge+32]=D[ge];if(rt(ze,K,ce),se(ze),Mt(vt,Nt,ze),nt(Nt,oe.subarray(32)),at(vt,Nt),it($e,vt),ce-=64,C(oe,0,$e,0)){for(ge=0;ge<ce;ge++)K[ge]=0;return-1}for(ge=0;ge<ce;ge++)K[ge]=oe[ge+64];return ce}var Ut=32,Le=24,Xe=32,zt=16,mt=32,an=32,hn=32,pr=32,Ft=32,Bn=Le,xr=Xe,_r=zt,Zn=64,Ht=32,pe=64,Ot=32,qt=64;e.lowlevel={crypto_core_hsalsa20:A,crypto_stream_xor:G,crypto_stream:te,crypto_stream_salsa20_xor:I,crypto_stream_salsa20:U,crypto_onetimeauth:O,crypto_onetimeauth_verify:N,crypto_verify_16:w,crypto_verify_32:C,crypto_secretbox:Q,crypto_secretbox_open:q,crypto_scalarmult:ke,crypto_scalarmult_base:Me,crypto_box_beforenm:Ce,crypto_box_afternm:ot,crypto_box:me,crypto_box_open:de,crypto_box_keypair:Ie,crypto_hash:rt,crypto_sign:Oe,crypto_sign_keypair:Zt,crypto_sign_open:gt,crypto_secretbox_KEYBYTES:Ut,crypto_secretbox_NONCEBYTES:Le,crypto_secretbox_ZEROBYTES:Xe,crypto_secretbox_BOXZEROBYTES:zt,crypto_scalarmult_BYTES:mt,crypto_scalarmult_SCALARBYTES:an,crypto_box_PUBLICKEYBYTES:hn,crypto_box_SECRETKEYBYTES:pr,crypto_box_BEFORENMBYTES:Ft,crypto_box_NONCEBYTES:Bn,crypto_box_ZEROBYTES:xr,crypto_box_BOXZEROBYTES:_r,crypto_sign_BYTES:Zn,crypto_sign_PUBLICKEYBYTES:Ht,crypto_sign_SECRETKEYBYTES:pe,crypto_sign_SEEDBYTES:Ot,crypto_hash_BYTES:qt,gf:t,D:f,L:j,pack25519:z,unpack25519:Z,M:be,A:ae,S:Ge,Z:Ae,pow2523:ve,add:at,set25519:ee,modL:W,scalarmult:Mt,scalarbase:nt};function fe(K,oe){if(K.length!==Ut)throw new Error("bad key size");if(oe.length!==Le)throw new Error("bad nonce size")}function we(K,oe){if(K.length!==hn)throw new Error("bad public key size");if(oe.length!==pr)throw new Error("bad secret key size")}function pt(){for(var K=0;K<arguments.length;K++)if(!(arguments[K]instanceof Uint8Array))throw new TypeError("unexpected type, use Uint8Array")}function At(K){for(var oe=0;oe<K.length;oe++)K[oe]=0}e.randomBytes=function(K){var oe=new Uint8Array(K);return n(oe,K),oe},e.secretbox=function(K,oe,ce){pt(K,oe,ce),fe(ce,oe);for(var D=new Uint8Array(Xe+K.length),ge=new Uint8Array(D.length),$e=0;$e<K.length;$e++)D[$e+Xe]=K[$e];return Q(ge,D,D.length,oe,ce),ge.subarray(zt)},e.secretbox.open=function(K,oe,ce){pt(K,oe,ce),fe(ce,oe);for(var D=new Uint8Array(zt+K.length),ge=new Uint8Array(D.length),$e=0;$e<K.length;$e++)D[$e+zt]=K[$e];return D.length<32||q(ge,D,D.length,oe,ce)!==0?null:ge.subarray(Xe)},e.secretbox.keyLength=Ut,e.secretbox.nonceLength=Le,e.secretbox.overheadLength=zt,e.scalarMult=function(K,oe){if(pt(K,oe),K.length!==an)throw new Error("bad n size");if(oe.length!==mt)throw new Error("bad p size");var ce=new Uint8Array(mt);return ke(ce,K,oe),ce},e.scalarMult.base=function(K){if(pt(K),K.length!==an)throw new Error("bad n size");var oe=new Uint8Array(mt);return Me(oe,K),oe},e.scalarMult.scalarLength=an,e.scalarMult.groupElementLength=mt,e.box=function(K,oe,ce,D){var ge=e.box.before(ce,D);return e.secretbox(K,oe,ge)},e.box.before=function(K,oe){pt(K,oe),we(K,oe);var ce=new Uint8Array(Ft);return Ce(ce,K,oe),ce},e.box.after=e.secretbox,e.box.open=function(K,oe,ce,D){var ge=e.box.before(ce,D);return e.secretbox.open(K,oe,ge)},e.box.open.after=e.secretbox.open,e.box.keyPair=function(){var K=new Uint8Array(hn),oe=new Uint8Array(pr);return Ie(K,oe),{publicKey:K,secretKey:oe}},e.box.keyPair.fromSecretKey=function(K){if(pt(K),K.length!==pr)throw new Error("bad secret key size");var oe=new Uint8Array(hn);return Me(oe,K),{publicKey:oe,secretKey:new Uint8Array(K)}},e.box.publicKeyLength=hn,e.box.secretKeyLength=pr,e.box.sharedKeyLength=Ft,e.box.nonceLength=Bn,e.box.overheadLength=e.secretbox.overheadLength,e.sign=function(K,oe){if(pt(K,oe),oe.length!==pe)throw new Error("bad secret key size");var ce=new Uint8Array(Zn+K.length);return Oe(ce,K,K.length,oe),ce},e.sign.open=function(K,oe){if(pt(K,oe),oe.length!==Ht)throw new Error("bad public key size");var ce=new Uint8Array(K.length),D=gt(ce,K,K.length,oe);if(D<0)return null;for(var ge=new Uint8Array(D),$e=0;$e<ge.length;$e++)ge[$e]=ce[$e];return ge},e.sign.detached=function(K,oe){for(var ce=e.sign(K,oe),D=new Uint8Array(Zn),ge=0;ge<D.length;ge++)D[ge]=ce[ge];return D},e.sign.detached.verify=function(K,oe,ce){if(pt(K,oe,ce),oe.length!==Zn)throw new Error("bad signature size");if(ce.length!==Ht)throw new Error("bad public key size");var D=new Uint8Array(Zn+K.length),ge=new Uint8Array(Zn+K.length),$e;for($e=0;$e<Zn;$e++)D[$e]=oe[$e];for($e=0;$e<K.length;$e++)D[$e+Zn]=K[$e];return gt(ge,D,D.length,ce)>=0},e.sign.keyPair=function(){var K=new Uint8Array(Ht),oe=new Uint8Array(pe);return Zt(K,oe),{publicKey:K,secretKey:oe}},e.sign.keyPair.fromSecretKey=function(K){if(pt(K),K.length!==pe)throw new Error("bad secret key size");for(var oe=new Uint8Array(Ht),ce=0;ce<oe.length;ce++)oe[ce]=K[32+ce];return{publicKey:oe,secretKey:new Uint8Array(K)}},e.sign.keyPair.fromSeed=function(K){if(pt(K),K.length!==Ot)throw new Error("bad seed size");for(var oe=new Uint8Array(Ht),ce=new Uint8Array(pe),D=0;D<32;D++)ce[D]=K[D];return Zt(oe,ce,!0),{publicKey:oe,secretKey:ce}},e.sign.publicKeyLength=Ht,e.sign.secretKeyLength=pe,e.sign.seedLength=Ot,e.sign.signatureLength=Zn,e.hash=function(K){pt(K);var oe=new Uint8Array(qt);return rt(oe,K,K.length),oe},e.hash.hashLength=qt,e.verify=function(K,oe){return pt(K,oe),K.length===0||oe.length===0||K.length!==oe.length?!1:y(K,0,oe,0,K.length)===0},e.setPRNG=function(K){n=K},(function(){var K=typeof self<"u"?self.crypto||self.msCrypto:null;if(K&&K.getRandomValues){var oe=65536;e.setPRNG(function(ce,D){var ge,$e=new Uint8Array(D);for(ge=0;ge<D;ge+=oe)K.getRandomValues($e.subarray(ge,ge+Math.min(D-ge,oe)));for(ge=0;ge<D;ge++)ce[ge]=$e[ge];At($e)})}else typeof OS<"u"&&(K=_N,K&&K.randomBytes&&e.setPRNG(function(ce,D){var ge,$e=K.randomBytes(D);for(ge=0;ge<D;ge++)ce[ge]=$e[ge];At($e)}))})()})(i.exports?i.exports:self.nacl=self.nacl||{})})(i0)),i0.exports}var SN=ak();const or=Bc(SN);var Vh={exports:{}},EN=Vh.exports,M2;function CN(){return M2||(M2=1,(function(i){(function(e,t){i.exports?i.exports=t():(e.nacl||(e.nacl={}),e.nacl.util=t())})(EN,function(){var e={};function t(n){if(!/^(?:[A-Za-z0-9+\/]{2}[A-Za-z0-9+\/]{2})*(?:[A-Za-z0-9+\/]{2}==|[A-Za-z0-9+\/]{3}=)?$/.test(n))throw new TypeError("invalid encoding")}return e.decodeUTF8=function(n){if(typeof n!="string")throw new TypeError("expected string");var s,a=unescape(encodeURIComponent(n)),l=new Uint8Array(a.length);for(s=0;s<a.length;s++)l[s]=a.charCodeAt(s);return l},e.encodeUTF8=function(n){var s,a=[];for(s=0;s<n.length;s++)a.push(String.fromCharCode(n[s]));return decodeURIComponent(escape(a.join("")))},typeof atob>"u"?typeof Buffer.from<"u"?(e.encodeBase64=function(n){return Buffer.from(n).toString("base64")},e.decodeBase64=function(n){return t(n),new Uint8Array(Array.prototype.slice.call(Buffer.from(n,"base64"),0))}):(e.encodeBase64=function(n){return new Buffer(n).toString("base64")},e.decodeBase64=function(n){return t(n),new Uint8Array(Array.prototype.slice.call(new Buffer(n,"base64"),0))}):(e.encodeBase64=function(n){var s,a=[],l=n.length;for(s=0;s<l;s++)a.push(String.fromCharCode(n[s]));return btoa(a.join(""))},e.decodeBase64=function(n){t(n);var s,a=atob(n),l=new Uint8Array(a.length);for(s=0;s<a.length;s++)l[s]=a.charCodeAt(s);return l}),e})})(Vh)),Vh.exports}var Pn=CN();function jy(){return or.randomBytes(24)}function I2(i,e,t,n,s,a){const l=new Uint8Array(n.length+i.length);l.set(n,0),l.set(i,n.length);const u=or.box(l,n,t,e),c={type:"handshake-intro",nonce:Pn.encodeBase64(n),payload:Pn.encodeBase64(u)};return s&&(c.pk=Pn.encodeBase64(s)),a&&(c.ack=!0),c}function R2(i,e,t){try{const n=Pn.decodeBase64(i.nonce),s=Pn.decodeBase64(i.payload),a=or.box.open(s,n,t,e);if(!a)return console.error("[Handshake] Failed to decrypt intro payload"),null;const l=a.slice(0,24),u=a.slice(24);return TN(l,n)?u.length!==32?(console.error("[Handshake] Invalid ephemeral public key length"),null):{nonce:l,ephemeralPublicKey:u}:(console.error("[Handshake] Nonce mismatch in intro"),null)}catch(n){return console.error("[Handshake] Error validating intro:",n),null}}function AN(i,e){const t=jy(),n={type:"connected",timestamp:Date.now()},s=new TextEncoder().encode(JSON.stringify(n)),a=or.secretbox(s,t,i),l=new Uint8Array(t.length+a.length);return l.set(t,0),l.set(a,t.length),{type:"handshake-connected",nonce:e,payload:Pn.encodeBase64(l)}}function kN(i,e){try{const t=Pn.decodeBase64(i.payload),n=t.slice(0,24),s=t.slice(24),a=or.secretbox.open(s,n,e);if(!a)return console.error("[Handshake] Failed to decrypt connected payload"),null;const l=new TextDecoder().decode(a),u=JSON.parse(l);if(u.type!=="connected"||typeof u.timestamp!="number")return console.error("[Handshake] Invalid connected message structure"),null;const c=Date.now();return Math.abs(c-u.timestamp)>60*1e3?(console.error("[Handshake] Connected message timestamp too old or in future"),null):u}catch(t){return console.error("[Handshake] Error validating connected:",t),null}}function TN(i,e){if(i.length!==e.length)return!1;for(let t=0;t<i.length;t++)if(i[t]!==e[t])return!1;return!0}function O2(i,e,t,n,s){const a=s?Pn.decodeBase64(s):or.randomBytes(24),l=or.randomBytes(24),u={invite_id:e},c=new TextEncoder().encode(JSON.stringify(u)),f=or.box(c,l,t,n),d=new Uint8Array(24+f.length);return d.set(l,0),d.set(f,24),{invitingId:i,nonce:Pn.encodeBase64(a),payload:Pn.encodeBase64(d)}}function MN(i,e,t){try{const n=Pn.decodeBase64(i);if(n.length<=36)return console.error("[Handshake] PSI payload too short"),null;const s=n.slice(0,24),a=n.slice(24),l=or.box.open(a,s,e,t);if(!l)return console.error("[Handshake] Failed to decrypt PSI payload"),null;const u=new TextDecoder().decode(l),c=JSON.parse(u);return typeof c.invite_id!="string"?(console.error("[Handshake] Invalid PSI payload structure"),null):{inviteId:c.invite_id}}catch(n){return console.error("[Handshake] Error decrypting PSI payload:",n),null}}function lk(i){return or.hash(i).slice(0,32)}const ck=or.hash(new TextEncoder().encode("chat-invite-pk-encryption")).slice(0,24);function uk(i,e){return or.secretbox(i,ck,e)}function N2(i,e){try{const t=or.secretbox.open(i,ck,e);return t?t.length!==32?(console.error("[Handshake] Invalid decrypted identity PK length:",t.length),null):t:(console.error("[Handshake] Failed to decrypt identity PK"),null)}catch(t){return console.error("[Handshake] Error decrypting identity PK:",t),null}}function IN(i,e){const t=new Uint8Array(i.length+e.length);return t.set(i,0),t.set(e,i.length),or.hash(t).slice(0,24)}function RN(i,e,t,n){const s=uk(t,n);return{type:"handshake-invite",nonce:Pn.encodeBase64(i),payload:e,pk:Pn.encodeBase64(s)}}function ON(i){return{type:"handshake-invite",nonce:"",payload:i}}var $h={exports:{}},NN=$h.exports,B2;function BN(){return B2||(B2=1,(function(i){(function(e,t){i.exports?i.exports=t(ak()):e.ed2curve=t(e.nacl)})(NN,function(e){if(!e)throw new Error("tweetnacl not loaded");var t=function(G){var Y,O=new Float64Array(16);if(G)for(Y=0;Y<G.length;Y++)O[Y]=G[Y];return O},n=t(),s=t([1]),a=t([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),l=t([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function u(G){var Y,O;for(O=0;O<16;O++)G[O]+=65536,Y=Math.floor(G[O]/65536),G[(O+1)*(O<15?1:0)]+=Y-1+37*(Y-1)*(O===15?1:0),G[O]-=Y*65536}function c(G,Y,O){for(var N,Q=~(O-1),q=0;q<16;q++)N=Q&(G[q]^Y[q]),G[q]^=N,Y[q]^=N}function f(G,Y){var O;for(O=0;O<16;O++)G[O]=Y[2*O]+(Y[2*O+1]<<8);G[15]&=32767}function d(G,Y,O){var N;for(N=0;N<16;N++)G[N]=Y[N]+O[N]|0}function p(G,Y,O){var N;for(N=0;N<16;N++)G[N]=Y[N]-O[N]|0}function m(G,Y,O){var N,Q,q=new Float64Array(31);for(N=0;N<31;N++)q[N]=0;for(N=0;N<16;N++)for(Q=0;Q<16;Q++)q[N+Q]+=Y[N]*O[Q];for(N=0;N<15;N++)q[N]+=38*q[N+16];for(N=0;N<16;N++)G[N]=q[N];u(G),u(G)}function v(G,Y){m(G,Y,Y)}function b(G,Y){var O=t(),N;for(N=0;N<16;N++)O[N]=Y[N];for(N=253;N>=0;N--)v(O,O),N!==2&&N!==4&&m(O,O,Y);for(N=0;N<16;N++)G[N]=O[N]}function y(G,Y){var O,N,Q,q=t(),ee=t();for(O=0;O<16;O++)ee[O]=Y[O];for(u(ee),u(ee),u(ee),N=0;N<2;N++){for(q[0]=ee[0]-65517,O=1;O<15;O++)q[O]=ee[O]-65535-(q[O-1]>>16&1),q[O-1]&=65535;q[15]=ee[15]-32767-(q[14]>>16&1),Q=q[15]>>16&1,q[14]&=65535,c(ee,q,1-Q)}for(O=0;O<16;O++)G[2*O]=ee[O]&255,G[2*O+1]=ee[O]>>8}function w(G){var Y=new Uint8Array(32);return y(Y,G),Y[0]&1}function C(G,Y,O,N,Q){var q,ee=0;for(q=0;q<Q;q++)ee|=G[Y+q]^O[N+q];return(1&ee-1>>>8)-1}function S(G,Y,O,N){return C(G,Y,O,N,32)}function x(G,Y){var O=new Uint8Array(32),N=new Uint8Array(32);return y(O,G),y(N,Y),S(O,0,N,0)}function k(G,Y){var O=t(),N;for(N=0;N<16;N++)O[N]=Y[N];for(N=250;N>=0;N--)v(O,O),N!==1&&m(O,O,Y);for(N=0;N<16;N++)G[N]=O[N]}function A(G,Y){var O;for(O=0;O<16;O++)G[O]=Y[O]|0}function R(G,Y){var O=t(),N=t(),Q=t(),q=t(),ee=t(),ne=t(),B=t();return A(G[2],s),f(G[1],Y),v(Q,G[1]),m(q,Q,a),p(Q,Q,G[2]),d(q,G[2],q),v(ee,q),v(ne,ee),m(B,ne,ee),m(O,B,Q),m(O,O,q),k(O,O),m(O,O,Q),m(O,O,q),m(O,O,q),m(G[0],O,q),v(N,G[0]),m(N,N,q),x(N,Q)&&m(G[0],G[0],l),v(N,G[0]),m(N,N,q),x(N,Q)?-1:(w(G[0])===Y[31]>>7&&p(G[0],n,G[0]),m(G[3],G[0],G[1]),0)}function I(G){var Y=new Uint8Array(32),O=[t(),t(),t(),t()],N=t(),Q=t();if(R(O,G))return null;var q=O[1];return d(N,s,q),p(Q,s,q),b(Q,Q),m(N,N,Q),y(Y,N),Y}function U(G){var Y=new Uint8Array(64),O=new Uint8Array(32),N;for(e.lowlevel.crypto_hash(Y,G,32),Y[0]&=248,Y[31]&=127,Y[31]|=64,N=0;N<32;N++)O[N]=Y[N];for(N=0;N<64;N++)Y[N]=0;return O}function te(G){var Y=I(G.publicKey);return Y?{publicKey:Y,secretKey:U(G.secretKey)}:null}return{convertPublicKey:I,convertSecretKey:U,convertKeyPair:te}})})($h)),$h.exports}var jN=BN();const fk=Bc(jN);class hd{identityKeypair;constructor(e){this.identityKeypair=e}static generate(){const e=or.sign.keyPair();return new hd(e)}static fromPrivateKey(e){const t=Pn.decodeBase64(e);if(t.length!==64)throw new Error("Invalid identity private key length");const n=or.sign.keyPair.fromSecretKey(t);return new hd(n)}get publicKey(){return Pn.encodeBase64(this.identityKeypair.publicKey)}get secretKey(){return Pn.encodeBase64(this.identityKeypair.secretKey)}get userId(){const e=or.hash(this.identityKeypair.publicKey);return Array.from(e.slice(0,8)).map(t=>t.toString(16).padStart(2,"0")).join("")}export(){return{userId:this.userId,publicKey:this.publicKey,secretKey:this.secretKey,profile:{}}}sign(e){return or.sign.detached(e,this.identityKeypair.secretKey)}static verify(e,t,n){return or.sign.detached.verify(e,t,n)}exportForSharing(){return JSON.stringify({version:1,publicKey:this.publicKey})}}function hk(i){const e=Pn.decodeBase64(i),t=or.hash(e);return Array.from(t.slice(0,8)).map(n=>n.toString(16).padStart(2,"0")).join("")}function Dy(i,e){return hk(e)===i}function Cc(i){const e=fk.convertPublicKey(i);if(!e)throw new Error("Failed to derive encryption public key");return e}function Py(i){const e=fk.convertSecretKey(i);if(!e)throw new Error("Failed to derive encryption secret key");return e}class s0{inviteId;introNonce;inviteeNonceStr;symmetricKey;isInvitedParty;isExistingContact;peerIdentityPK;constructor(e,t,n,s,a=!1){this.inviteId=e,this.symmetricKey=lk(t),this.introNonce=IN(n,t),this.inviteeNonceStr=Pn.encodeBase64(n),this.isInvitedParty=s,this.isExistingContact=a}deriveIntroNonce(){return this.introNonce}deriveSymmetricKey(){return this.symmetricKey}destroy(){this.symmetricKey.fill(0),this.introNonce.fill(0),this.peerIdentityPK&&this.peerIdentityPK.fill(0)}}class DN{handshakeStates=new Map;completedSessionNonce=new Map;myIdentity=null;thisEncryptionSK=null;signalSender=null;onHandshakeComplete=null;onHandshakeStatus=null;getPeerPublicKey=null;getInviteCallback=null;markInviteUsedCallback=null;createContactFromInviteCallback=null;onInviteRejectedCallback=null;thisIdentityPK=null;thisEncryptionPK=null;timeoutMs;sessionExpiryMs;constructor(e,t){this.timeoutMs=e,this.sessionExpiryMs=t}createState(e,t,n){const s=Pn.decodeBase64(t),a=Cc(s);return{peerId:e,peerIdentityPK:t,sentIntro:!1,receivedIntro:!1,sentConnected:!1,receivedConnected:!1,nonce:n,startedAt:Date.now(),session:{thisEphemeral:or.box.keyPair(),peerEphemeral:null,sessionKey:new Uint8Array(32),expiresAt:0,thisEncryptionSK:this.thisEncryptionSK,peerEncryptionPK:a}}}checkAndHandleTimeout(e){const t=this.handshakeStates.get(e);return t&&Date.now()>t.startedAt+this.timeoutMs?(this.handleHandshakeTimeout(e),!0):!1}initialize(e){this.myIdentity=e;const t=Pn.decodeBase64(e.secretKey),n=Pn.decodeBase64(e.publicKey);this.thisEncryptionSK=Py(t),this.thisEncryptionPK=Cc(n),this.thisIdentityPK=n,console.log("[HandshakeCoordinator] Initialized for user:",e.userId.substring(0,8))}setSignalSender(e){this.signalSender=e}setOnHandshakeComplete(e){this.onHandshakeComplete=e}setOnHandshakeStatus(e){this.onHandshakeStatus=e}setGetPeerPublicKey(e){this.getPeerPublicKey=e}setGetInviteCallback(e){this.getInviteCallback=e}setMarkInviteUsedCallback(e){this.markInviteUsedCallback=e}setCreateContactFromInviteCallback(e){this.createContactFromInviteCallback=e}setOnInviteRejectedCallback(e){this.onInviteRejectedCallback=e}isHandshakeInProgress(e){return this.handshakeStates.has(e)}async initiateHandshakeIfNotRunning(e,t){this.isHandshakeInProgress(e)&&!this.checkAndHandleTimeout(e)||await this.initiateHandshake(e,t)}async initiateHandshake(e,t){if(!this.myIdentity){console.error("[HandshakeCoordinator] Not initialized");return}if(!this.signalSender){console.error("[HandshakeCoordinator] No signal sender configured");return}console.log("[HandshakeCoordinator] Initiating handshake with:",e.substring(0,8)),this.clearHandshakeState(e),this.completedSessionNonce.delete(e),this.onHandshakeStatus?.(e,"started");const n=this.createState(e,t);this.handshakeStates.set(e,n),await this.sendIntroMessage(e)}async sendIntroMessage(e,t){if(!this.myIdentity||!this.signalSender)return;const n=this.handshakeStates.get(e);if(n)try{n.nonce||(n.nonce=Pn.encodeBase64(jy()));const s=I2(n.session.thisEphemeral.publicKey,n.session.thisEncryptionSK,n.session.peerEncryptionPK,Pn.decodeBase64(n.nonce),void 0,t);await this.signalSender(e,s),n.sentIntro=!0,console.log("[HandshakeCoordinator] Sent handshake-intro to:",e.substring(0,8),"with nonce:",n.nonce.substring(0,8),t?"(ack)":"")}catch(s){console.error("[HandshakeCoordinator] Failed to send intro:",s)}}async sendConnectedMessage(e){if(!this.myIdentity||!this.signalSender)return;const t=this.handshakeStates.get(e);if(t)try{const n=AN(t.session.sessionKey,t.nonce);await this.signalSender(e,n),t.sentConnected=!0,console.log("[HandshakeCoordinator] Sent handshake-connected to:",e.substring(0,8),"with nonce:",t.nonce?.substring(0,8))}catch(n){console.error("[HandshakeCoordinator] Failed to send connected:",n)}}async handleHandshakeMessage(e,t){if(!this.myIdentity){console.error("[HandshakeCoordinator] Not initialized");return}t.type==="handshake-invite"?t.nonce===""?this.handleInviteRejection(e,t.payload):await this.handleInviteMessage(e,t):t.type==="handshake-intro"?await this.handleIntroMessage(e,t):t.type==="handshake-connected"&&await this.handleConnectedMessage(e,t)}async initiateFromPSI(e){if(!this.myIdentity||!this.signalSender||!this.thisIdentityPK){console.error("[HandshakeCoordinator] Not initialized for invite");return}const t=e.invitingId;console.log("[HandshakeCoordinator] Initiating handshake from PSI to:",t.substring(0,8)),this.clearHandshakeState(t),this.completedSessionNonce.delete(t);const n=Pn.decodeBase64(e.nonce),s=jy(),a=new s0("",n,s,!0),l={peerId:t,peerIdentityPK:"",sentIntro:!1,receivedIntro:!1,sentConnected:!1,receivedConnected:!1,startedAt:Date.now(),session:{thisEphemeral:or.box.keyPair(),peerEphemeral:null,sessionKey:new Uint8Array(32),expiresAt:0,thisEncryptionSK:this.thisEncryptionSK,peerEncryptionPK:new Uint8Array(32)},invite:a};this.handshakeStates.set(t,l),this.onHandshakeStatus?.(t,"started");const u=a.deriveSymmetricKey(),c=RN(s,e.payload,this.thisIdentityPK,u);try{await this.signalSender(t,c),console.log("[HandshakeCoordinator] Sent handshake-invite to:",t.substring(0,8))}catch(f){console.error("[HandshakeCoordinator] Failed to send handshake-invite:",f),this.handleHandshakeFailed(t)}}async handleInviteMessage(e,t){if(!this.myIdentity||!this.signalSender||!this.thisEncryptionSK||!this.thisEncryptionPK||!this.thisIdentityPK){console.error("[HandshakeCoordinator] Not initialized for invite handling");return}console.log("[HandshakeCoordinator] Received handshake-invite from:",e.substring(0,8));const n=this.handshakeStates.get(e);if(n?.invite){if(n.invite.inviteeNonceStr===t.nonce){n.invite.isInvitedParty?console.log("[HandshakeCoordinator] Invitee nonce collision, invited flow takes over (already processing)"):(console.log("[HandshakeCoordinator] Resending intro for existing invite session"),await this.sendInviteIntroMessage(e));return}console.log("[HandshakeCoordinator] New invite nonce, resetting session"),this.clearHandshakeState(e)}const s=Pn.decodeBase64(t.nonce),a=t.payload,l=t.pk?Pn.decodeBase64(t.pk):null;if(!l){console.error("[HandshakeCoordinator] Invite message missing pk field"),await this.sendInviteRejection(e,"Missing identity key");return}const u=MN(a,this.thisEncryptionPK,this.thisEncryptionSK);if(!u){console.error("[HandshakeCoordinator] Failed to decrypt invite payload"),await this.sendInviteRejection(e,"Invalid invite");return}const c=u.inviteId;if(console.log("[HandshakeCoordinator] Decrypted invite ID:",c),!this.getInviteCallback){console.error("[HandshakeCoordinator] No getInviteCallback configured"),await this.sendInviteRejection(e,"Server error");return}const f=await this.getInviteCallback(c,e);if(typeof f=="string"){console.log("[HandshakeCoordinator] Peer is existing contact, skipping invite validation");const S=f,x=new s0("",new Uint8Array(24),s,!1,!0),k=this.createState(e,S,Pn.encodeBase64(s));k.invite=x,this.handshakeStates.set(e,k),this.onHandshakeStatus?.(e,"started"),await this.sendIntroMessage(e);return}if(!f){console.error("[HandshakeCoordinator] Invite not found:",c),await this.sendInviteRejection(e,"Invalid invite");return}const d=f,p=Pn.decodeBase64(d.nonce);if(!d.valid){console.log("[HandshakeCoordinator] Invite is invalidated"),await this.sendInviteRejection(e,"Invite no longer valid");return}if(d.expiry&&Date.now()>d.expiry){console.log("[HandshakeCoordinator] Invite has expired"),await this.sendInviteRejection(e,"Invite expired");return}if(d.useLimit!==void 0&&d.useCount>=d.useLimit){console.log("[HandshakeCoordinator] Invite use limit exceeded"),await this.sendInviteRejection(e,"Invite use limit reached");return}const m=lk(p),v=N2(l,m);if(!v){console.error("[HandshakeCoordinator] Failed to decrypt peer identity PK"),await this.sendInviteRejection(e,"Decryption error");return}const b=Pn.encodeBase64(v);if(!Dy(e,b)){console.error("[HandshakeCoordinator] Peer identity mismatch: userId does not match publicKey"),await this.sendInviteRejection(e,"Identity verification failed");return}const y=Cc(v);console.log("[HandshakeCoordinator] Invite validated, peer identity:",b.substring(0,16));const w=new s0(d.inviteId,p,s,!1);w.peerIdentityPK=v;const C={peerId:e,peerIdentityPK:b,sentIntro:!1,receivedIntro:!1,sentConnected:!1,receivedConnected:!1,startedAt:Date.now(),session:{thisEphemeral:or.box.keyPair(),peerEphemeral:null,sessionKey:new Uint8Array(32),expiresAt:0,thisEncryptionSK:this.thisEncryptionSK,peerEncryptionPK:y},invite:w};C.nonce=Pn.encodeBase64(w.deriveIntroNonce()),this.handshakeStates.set(e,C),this.onHandshakeStatus?.(e,"started"),await this.sendInviteIntroMessage(e)}async sendInviteIntroMessage(e){if(!this.myIdentity||!this.signalSender||!this.thisIdentityPK)return;const t=this.handshakeStates.get(e);if(!(!t||!t.invite))try{const n=t.invite.deriveIntroNonce(),s=t.invite.deriveSymmetricKey(),a=uk(this.thisIdentityPK,s),l=I2(t.session.thisEphemeral.publicKey,t.session.thisEncryptionSK,t.session.peerEncryptionPK,n,a);await this.signalSender(e,l),t.sentIntro=!0,t.nonce=Pn.encodeBase64(n),console.log("[HandshakeCoordinator] Sent invite handshake-intro to:",e.substring(0,8),"with derived nonce")}catch(n){console.error("[HandshakeCoordinator] Failed to send invite intro:",n)}}async sendInviteRejection(e,t){if(this.signalSender)try{const n=ON(t);await this.signalSender(e,n),console.log("[HandshakeCoordinator] Sent invite rejection to:",e.substring(0,8),"reason:",t)}catch(n){console.error("[HandshakeCoordinator] Failed to send rejection:",n)}}handleInviteRejection(e,t){console.log("[HandshakeCoordinator] Invite rejected by:",e.substring(0,8),"reason:",t),this.handshakeStates.get(e)?.invite?.isInvitedParty&&this.onInviteRejectedCallback?.(e,t),this.completedSessionNonce.delete(e),this.clearHandshakeState(e),this.onHandshakeStatus?.(e,"failed",t)}async handleIntroMessage(e,t){if(!this.myIdentity||!this.signalSender)return;if(console.log("[HandshakeCoordinator] Received handshake-intro from:",e.substring(0,8),"nonce:",t.nonce?.substring(0,8),t.ack?"(ack)":""),t.ack){console.log("[HandshakeCoordinator] Received ack intro, peer already connected - not responding");return}this.checkAndHandleTimeout(e);const n=this.handshakeStates.get(e),s=t.nonce,a=n?.nonce,l=this.completedSessionNonce.get(e);if(n?.invite?.isInvitedParty&&!n.peerIdentityPK){await this.handleInviteIntroAsInvitedParty(e,t,n);return}let c=this.getPeerPublicKey?.(e);if(!c&&n?.invite&&!n.invite.isInvitedParty&&(c=n.peerIdentityPK),!c){console.error("[HandshakeCoordinator] Peer public key not found for:",e.substring(0,8));return}if(!a&&l&&s===l){console.log("[HandshakeCoordinator] Ignoring stale intro from completed session. Nonce:",s.substring(0,8));return}const f=n?.invite!==void 0;if(!(!a||s===a||s>a||f)){console.log("[HandshakeCoordinator] Ignoring intro with lower nonce. My nonce:",a?.substring(0,8),"Peer nonce:",s.substring(0,8));return}a&&s!==a&&!f&&n&&(console.log("[HandshakeCoordinator] Adopting higher nonce. My nonce:",a?.substring(0,8),"-> Peer nonce:",s.substring(0,8)),n.nonce=s,n.sentIntro=!1,n.sentConnected=!1,n.receivedConnected=!1);let m=this.handshakeStates.get(e);m||(m=this.createState(e,c,s),this.handshakeStates.set(e,m),this.onHandshakeStatus?.(e,"started"));const v=R2(t,m.session.thisEncryptionSK,m.session.peerEncryptionPK);if(!v){console.error("[HandshakeCoordinator] Failed to validate intro"),this.handleHandshakeFailed(e);return}if(m.receivedIntro=!0,!m.session.peerEphemeral)try{const y=or.box.before(v.ephemeralPublicKey,m.session.thisEphemeral.secretKey);m.session.sessionKey=y,m.session.peerEphemeral=v.ephemeralPublicKey,m.session.expiresAt=Date.now()+this.sessionExpiryMs,console.log("[HandshakeCoordinator] Session key derived for:",e.substring(0,8))}catch(y){console.error("[HandshakeCoordinator] Failed to derive session key:",y),this.handleHandshakeFailed(e);return}const b=m.receivedConnected;(!m.sentIntro||b)&&(m.invite&&!m.invite.isInvitedParty&&!m.invite.isExistingContact?await this.sendInviteIntroMessage(e):await this.sendIntroMessage(e,b)),await this.sendConnectedMessage(e),this.checkHandshakeComplete(e)}async handleInviteIntroAsInvitedParty(e,t,n){if(!this.myIdentity||!this.signalSender||!n.invite)return;console.log("[HandshakeCoordinator] Processing invite intro as invited party from:",e.substring(0,8));const s=n.invite.deriveIntroNonce(),a=Pn.decodeBase64(t.nonce);let l=s.length===a.length;if(l){for(let v=0;v<s.length;v++)if(s[v]!==a[v]){l=!1;break}}if(!l){console.error("[HandshakeCoordinator] Derived nonce mismatch in invite flow"),this.handleHandshakeFailed(e);return}if(!t.pk){console.error("[HandshakeCoordinator] Invite intro missing pk field"),this.handleHandshakeFailed(e);return}const u=Pn.decodeBase64(t.pk),c=n.invite.deriveSymmetricKey(),f=N2(u,c);if(!f){console.error("[HandshakeCoordinator] Failed to decrypt inviting party identity PK"),this.handleHandshakeFailed(e);return}const d=Pn.encodeBase64(f);if(!Dy(e,d)){console.error("[HandshakeCoordinator] Peer identity mismatch: userId does not match publicKey"),this.handleHandshakeFailed(e);return}const p=Cc(f);n.peerIdentityPK=d,n.session.peerEncryptionPK=p,n.invite.peerIdentityPK=f,n.nonce=t.nonce,console.log("[HandshakeCoordinator] Learned inviting party identity:",d.substring(0,16));const m=R2(t,n.session.thisEncryptionSK,p);if(!m){console.error("[HandshakeCoordinator] Failed to validate invite intro payload"),this.handleHandshakeFailed(e);return}if(n.receivedIntro=!0,!n.session.peerEphemeral)try{const v=or.box.before(m.ephemeralPublicKey,n.session.thisEphemeral.secretKey);n.session.sessionKey=v,n.session.peerEphemeral=m.ephemeralPublicKey,n.session.expiresAt=Date.now()+this.sessionExpiryMs,console.log("[HandshakeCoordinator] Session key derived (invite) for:",e.substring(0,8))}catch(v){console.error("[HandshakeCoordinator] Failed to derive session key:",v),this.handleHandshakeFailed(e);return}n.sentIntro||await this.sendInviteIntroMessage(e),await this.sendConnectedMessage(e),this.checkHandshakeComplete(e)}async handleConnectedMessage(e,t){if(!this.myIdentity||!this.signalSender)return;console.log("[HandshakeCoordinator] Received handshake-connected from:",e.substring(0,8),"with nonce:",t.nonce?.substring(0,8));const n=t.nonce,s=this.completedSessionNonce.get(e),a=this.handshakeStates.get(e);if(!a){s&&n===s?console.log("[HandshakeCoordinator] Ignoring stale connected from completed session. Nonce:",n?.substring(0,8)):console.log("[HandshakeCoordinator] No handshake state found - likely from old handshake, ignoring");return}if(!n||n!==a.nonce){console.log("[HandshakeCoordinator] Nonce mismatch - message from old handshake. Expected:",a.nonce?.substring(0,8),"Got:",n?.substring(0,8));return}if(!kN(t,a.session.sessionKey)){console.error("[HandshakeCoordinator] Failed to validate connected message"),this.handleHandshakeFailed(e);return}a.receivedConnected=!0,a.sentConnected||await this.sendConnectedMessage(e),this.checkHandshakeComplete(e)}async checkHandshakeComplete(e){const t=this.handshakeStates.get(e);!t?.receivedIntro||!t.receivedConnected||(t.nonce&&this.completedSessionNonce.set(e,t.nonce),console.log("[HandshakeCoordinator]  Handshake complete with:",e.substring(0,8)),t.invite&&!t.invite.isExistingContact&&await this.handleInviteCompletion(e,t),this.onHandshakeComplete?.(e,t.session.sessionKey,t.session.expiresAt),this.onHandshakeStatus?.(e,"complete"),this.clearHandshakeState(e))}async handleInviteCompletion(e,t){if(!t.invite)return;const n=t.invite,s=t.peerIdentityPK;if(console.log("[HandshakeCoordinator] Completing invite handshake, isInvitedParty:",n.isInvitedParty),this.createContactFromInviteCallback&&s)try{await this.createContactFromInviteCallback(e,s,n.inviteId,n.isInvitedParty),console.log("[HandshakeCoordinator] Contact created from invite for:",e.substring(0,8))}catch(a){console.error("[HandshakeCoordinator] Failed to create contact from invite:",a)}if(!n.isInvitedParty&&n.inviteId&&this.markInviteUsedCallback)try{await this.markInviteUsedCallback(n.inviteId),console.log("[HandshakeCoordinator] Invite use count incremented:",n.inviteId)}catch(a){console.error("[HandshakeCoordinator] Failed to increment invite use count:",a)}}clearHandshakeState(e){const t=this.handshakeStates.get(e);t&&(t.session.sessionKey.fill(0),t.session.thisEphemeral.secretKey.fill(0),t.invite&&t.invite.destroy()),this.handshakeStates.delete(e)}handleHandshakeTimeout(e){console.error("[HandshakeCoordinator] Handshake timeout for:",e.substring(0,8)),this.completedSessionNonce.delete(e),this.clearHandshakeState(e),this.onHandshakeStatus?.(e,"timeout")}handleHandshakeFailed(e){console.error("[HandshakeCoordinator] Handshake failed for:",e.substring(0,8)),this.completedSessionNonce.delete(e),this.clearHandshakeState(e),this.onHandshakeStatus?.(e,"failed")}cancelHandshake(e){this.handshakeStates.has(e)&&(console.log("[HandshakeCoordinator] Cancelling handshake for:",e.substring(0,8)),this.completedSessionNonce.delete(e),this.clearHandshakeState(e))}destroy(){this.handshakeStates.forEach((e,t)=>{this.clearHandshakeState(t)}),this.completedSessionNonce.clear(),this.thisEncryptionSK&&(this.thisEncryptionSK.fill(0),this.thisEncryptionSK=null),this.thisEncryptionPK&&(this.thisEncryptionPK.fill(0),this.thisEncryptionPK=null),this.thisIdentityPK&&(this.thisIdentityPK.fill(0),this.thisIdentityPK=null),this.onHandshakeComplete=null,this.onHandshakeStatus=null,this.getPeerPublicKey=null,this.getInviteCallback=null,this.markInviteUsedCallback=null,this.createContactFromInviteCallback=null,this.onInviteRejectedCallback=null}}class PN{sessionKey;sendCounter;receiveCounter;constructor(e){this.sessionKey=e,this.sendCounter=0,this.receiveCounter=0}encrypt(e){const t=new TextEncoder().encode(e),n=this.generateNonce(),s=or.secretbox(t,n,this.sessionKey);return this.sendCounter++,{ciphertext:Pn.encodeBase64(s),nonce:Pn.encodeBase64(n),timestamp:Date.now()}}decrypt(e){const t=Pn.decodeBase64(e.ciphertext),n=Pn.decodeBase64(e.nonce),s=or.secretbox.open(t,n,this.sessionKey);if(!s)throw new Error("Decryption failed - message may be tampered or session key invalid");return this.receiveCounter++,new TextDecoder().decode(s)}encryptBytes(e){const t=this.generateNonce(),n=or.secretbox(e,t,this.sessionKey);this.sendCounter++;const s=new Uint8Array(t.length+n.length);return s.set(t,0),s.set(n,t.length),s}decryptBytes(e){if(e.length<24)throw new Error("Data too short - missing nonce");const t=e.slice(0,24),n=e.slice(24),s=or.secretbox.open(n,t,this.sessionKey);if(!s)throw new Error("Decryption failed - message may be tampered or session key invalid");return this.receiveCounter++,s}generateNonce(){return or.randomBytes(24)}getSendCounter(){return this.sendCounter}getReceiveCounter(){return this.receiveCounter}destroy(){this.sessionKey.fill(0)}}class Yh extends Error{code="SESSION_EXPIRED";peerId;constructor(e){super(`Session expired for peer: ${e}`),this.name="SessionExpiredError",this.peerId=e}}class Wh extends Error{code="NO_SESSION";peerId;constructor(e){super(`No session for peer: ${e}`),this.name="NoSessionError",this.peerId=e}}class dk extends Error{code="TRANSPORT_DISCONNECTED";peerId;constructor(e){super(`Transport disconnected for peer: ${e}`),this.name="TransportDisconnectedError",this.peerId=e}}class Ly extends Error{code="CORRUPTED_PAYLOAD";peerId;cause;constructor(e,t){super(`Corrupted signal payload from peer: ${e}`),this.name="CorruptedPayloadError",this.peerId=e,this.cause=t}}class Uy extends Error{code="INCORRECT_SESSION_KEY";peerId;cause;constructor(e,t){super(`Cannot parse signal from peer ${e} - possible session key mismatch`),this.name="IncorrectSessionKeyError",this.peerId=e,this.cause=t}}const LN=[{urls:"stun:stun.l.google.com:19302"},{urls:"stun:stun1.l.google.com:19302"},{urls:"stun:global.stun.twilio.com:3478"},{urls:"stun:stun.cloudflare.com:3478"}];class UN{connection;msgChannel;pendingIceCandidates=[];callbacks;destroyed=!1;constructor(e){this.callbacks=e,this.connection=new RTCPeerConnection({iceServers:LN}),this.setupConnectionHandlers(),this.msgChannel=this.connection.createDataChannel("messages",{ordered:!0,negotiated:!0,id:1}),this.setupMessageChannel()}setState(e){this.callbacks.onStateChange(e)}setupConnectionHandlers(){this.connection.onconnectionstatechange=()=>{if(this.destroyed)return;const e=this.connection.connectionState;console.log("[WebRtcConnection] connectionState:",e),(e==="failed"||e==="disconnected")&&this.setState("disconnected")},this.connection.onsignalingstatechange=()=>{this.destroyed||console.log("[WebRtcConnection] signalingState:",this.connection.signalingState)},this.connection.oniceconnectionstatechange=()=>{if(this.destroyed)return;const e=this.connection.iceConnectionState;console.log("[WebRtcConnection] iceConnectionState:",e),e==="failed"&&this.setState("failed")},this.connection.onicegatheringstatechange=()=>{this.destroyed||console.log("[WebRtcConnection] iceGatheringState:",this.connection.iceGatheringState)},this.connection.onicecandidate=e=>{this.destroyed||(e.candidate?(console.log("[WebRtcConnection]  ICE candidate:",e.candidate.candidate?.substring(0,50)),this.callbacks.onSignal({ice:e.candidate.toJSON()})):console.log("[WebRtcConnection] ICE gathering complete"))},this.connection.ondatachannel=e=>{this.destroyed||console.log("[WebRtcConnection] Received data channel:",e.channel.label)}}setupMessageChannel(){const e=this.msgChannel;e.binaryType="arraybuffer",e.onopen=()=>{this.destroyed||(console.log("[WebRtcConnection] Message channel opened"),this.setState("connected"))},e.onclose=()=>{this.destroyed||(console.log("[WebRtcConnection] Message channel closed"),this.setState("disconnected"))},e.onerror=t=>{this.destroyed||(console.error("[WebRtcConnection] Message channel error:",t),this.setState("failed"))},e.onmessage=t=>{if(this.destroyed)return;const n=new Uint8Array(t.data);this.callbacks.onData(n)}}async initiateConnection(){if(this.destroyed)throw new Error("Connection destroyed");console.log("[WebRtcConnection] Initiating connection (creating offer)");const e=await this.connection.createOffer();await this.connection.setLocalDescription(e),this.callbacks.onSignal({offer:e})}async handleSignal(e){if(this.destroyed){console.warn("[WebRtcConnection] Ignoring signal - connection destroyed");return}const t=this.connection.signalingState;try{if(e.offer){console.log("[WebRtcConnection]  Received offer, signalingState:",t),await this.connection.setRemoteDescription(e.offer),await this.processQueuedIceCandidates();const n=await this.connection.createAnswer();await this.connection.setLocalDescription(n),this.callbacks.onSignal({answer:n}),console.log("[WebRtcConnection]  Sent answer")}else if(e.answer){if(console.log("[WebRtcConnection]  Received answer, signalingState:",t),t!=="have-local-offer"){console.log("[WebRtcConnection] Ignoring answer - not in have-local-offer state");return}await this.connection.setRemoteDescription(e.answer),await this.processQueuedIceCandidates(),console.log("[WebRtcConnection]  Answer processed, signalingState:",this.connection.signalingState)}else if(e.ice){if(!this.connection.remoteDescription){console.log("[WebRtcConnection] Queuing ICE candidate (no remote description yet), pending:",this.pendingIceCandidates.length+1),this.pendingIceCandidates.push(e.ice);return}await this.connection.addIceCandidate(e.ice),console.log("[WebRtcConnection]  Added ICE candidate")}}catch(n){throw console.error("[WebRtcConnection] Failed to handle signal, signalingState was:",t,"error:",n),n}}async processQueuedIceCandidates(){this.pendingIceCandidates.length>0&&console.log("[WebRtcConnection] Processing",this.pendingIceCandidates.length,"queued ICE candidates");for(const e of this.pendingIceCandidates)try{await this.connection.addIceCandidate(e)}catch(t){console.warn("[WebRtcConnection] Failed to add queued ICE candidate:",t)}this.pendingIceCandidates=[]}sendMessage(e){if(this.destroyed)throw new Error("Connection destroyed");if(!this.msgChannel||this.msgChannel.readyState!=="open")throw new Error("Message channel not open");this.msgChannel.send(e)}destroy(){this.destroyed||(console.log("[WebRtcConnection] Destroying"),this.destroyed=!0,this.msgChannel.close(),this.connection.close(),this.pendingIceCandidates=[])}}class qN{peerId;identityPK;sessionExpiry=0;encryption=null;webrtc=null;_state="offline";manager;constructor(e,t,n){this.peerId=e,this.identityPK=t,this.manager=n,console.log("[DataTransport] Created for peer:",e.substring(0,8))}get state(){return this._state}get isConnected(){return this.state=="online"}get hasSession(){return this.encryption!==null}get isSessionValid(){return this.hasSession&&Date.now()<this.sessionExpiry}get sessionExpiresAt(){return this.sessionExpiry}updateState(e){const t=this._state;if(this.webrtc)switch(e){case"offline":this.webrtc.destroy(),this.webrtc=null;break}else switch(e){case"offline":break;case"connecting":this.webrtc=new UN({onSignal:n=>this.handleOutgoingSignal("webrtc",n),onData:n=>this.handleIncomingMessage(n),onStateChange:n=>this.handleWebRtcStateChange(n)});break;case"online":throw new Error("Invalid state transition: no-WebRTC -> online")}this._state=e,t!=e&&(console.log(`[DataTransport] State: ${t} -> ${e} for:`,this.peerId.substring(0,8)),this.manager.updatePeerStatus(this.peerId,e))}setSession(e,t){this.encryption?.destroy(),this.encryption=new PN(e),this.sessionExpiry=t,console.log("[DataTransport]  Session set for:",this.peerId.substring(0,8),"expires:",new Date(t).toISOString())}async initiateConnection(){if(!this.isSessionValid){console.log("[DataTransport] Skipping connection initiation - session is invalid or no session exists");return}if(this.state!=="offline"){console.log("[DataTransport] Skipping connection initiation - already connected or connecting");return}this.updateState("connecting"),await this.webrtc.initiateConnection()}handleOutgoingSignal(e,t){if(!this.encryption){console.error("[DataTransport] Cannot encrypt signal - no session");return}const s=JSON.stringify({type:e,payload:t}),a=this.encryption.encrypt(s),l=JSON.stringify(a);console.log("[DataTransport]  Sending encrypted signal:",e),this.manager.sendCustomSignal(this.peerId,l)}handleEncryptedSignal(e){if(!this.hasSession)throw new Wh(this.peerId);if(!this.isSessionValid)throw new Yh(this.peerId);let t;try{const a=JSON.parse(e);t=this.encryption.decrypt(a)}catch(a){throw new Ly(this.peerId,a instanceof Error?a:void 0)}let n;try{n=JSON.parse(t)}catch(a){throw new Uy(this.peerId,a instanceof Error?a:void 0)}const s=n;if(!s||typeof s.type!="string"){console.warn("[DataTransport] Invalid signal envelope structure:",n);return}switch(console.log("[DataTransport]  Received encrypted signal:",s.type),s.type){case"webrtc":this.handleWebRtcSignal(s.payload);break;default:console.warn("[DataTransport] Unknown signal type:",s.type)}}handleWebRtcSignal(e){var t="unknown";if(e.answer?t="answer":e.offer?t="offer":e.ice&&(t="ice"),!this.webrtc){if(!e.offer){console.warn("[DataTransport] No WebRTC connection to handle signal:",t);return}console.log("[DataTransport] Creating WebRTC connection for incoming offer"),this.updateState("connecting")}console.log("[DataTransport]  Handling WebRTC signal:",t),this.webrtc.handleSignal(e).catch(n=>{console.error("[DataTransport] Failed to handle WebRTC signal:",t,", error:",n)})}handleWebRtcStateChange(e){switch(console.log("[DataTransport] WebRTC state:",e,"for:",this.peerId.substring(0,8)),e){case"connecting":this.updateState("connecting");break;case"connected":this.updateState("online");break;default:this.updateState("offline");break}}handleIncomingMessage(e){console.log("[DataTransport]  Encrypted message received from:",this.peerId.substring(0,8));let t;try{if(!this.hasSession)throw new Wh(this.peerId);if(!this.isSessionValid)throw new Yh(this.peerId);let n;try{n=this.encryption.decryptBytes(e)}catch(s){throw new Ly(this.peerId,s)}try{const s=new TextDecoder().decode(n);t=JSON.parse(s)}catch(s){throw new Uy(this.peerId,s)}}catch(n){console.error("[DataTransport] Failed to process message:",n),n instanceof Error&&this.manager.reportPeerError(this.peerId,n);return}this.manager.onWireMessage(this.peerId,t)}async sendMessage(e){if(!this.hasSession)throw new Wh(this.peerId);if(!this.isSessionValid)throw new Yh(this.peerId);if(!this.isConnected)throw new dk(this.peerId);const t=new TextEncoder().encode(JSON.stringify(e)),n=this.encryption.encryptBytes(t);this.webrtc.sendMessage(n),console.log("[DataTransport]  Message sent to:",this.peerId.substring(0,8))}clearSessionAndConnection(){this.updateState("offline"),this.clearSession()}clearSession(){console.log("[DataTransport] Clearing session for:",this.peerId.substring(0,8)),this.sessionExpiry=0,this.encryption?.destroy(),this.encryption=null}destroy(){this.updateState("offline"),this.clearSession(),console.log("[DataTransport] Destroyed for:",this.peerId.substring(0,8))}}var Qh={exports:{}},FN=Qh.exports,j2;function HN(){return j2||(j2=1,(function(i,e){(function(t,n){i.exports=n()})(FN,function(){var t=function(_,T){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(L,J){L.__proto__=J}||function(L,J){for(var re in J)Object.prototype.hasOwnProperty.call(J,re)&&(L[re]=J[re])})(_,T)},n=function(){return(n=Object.assign||function(_){for(var T,L=1,J=arguments.length;L<J;L++)for(var re in T=arguments[L])Object.prototype.hasOwnProperty.call(T,re)&&(_[re]=T[re]);return _}).apply(this,arguments)};function s(_,T,L){for(var J,re=0,le=T.length;re<le;re++)!J&&re in T||((J=J||Array.prototype.slice.call(T,0,re))[re]=T[re]);return _.concat(J||Array.prototype.slice.call(T))}var a=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:c3,l=Object.keys,u=Array.isArray;function c(_,T){return typeof T!="object"||l(T).forEach(function(L){_[L]=T[L]}),_}typeof Promise>"u"||a.Promise||(a.Promise=Promise);var f=Object.getPrototypeOf,d={}.hasOwnProperty;function p(_,T){return d.call(_,T)}function m(_,T){typeof T=="function"&&(T=T(f(_))),(typeof Reflect>"u"?l:Reflect.ownKeys)(T).forEach(function(L){b(_,L,T[L])})}var v=Object.defineProperty;function b(_,T,L,J){v(_,T,c(L&&p(L,"get")&&typeof L.get=="function"?{get:L.get,set:L.set,configurable:!0}:{value:L,configurable:!0,writable:!0},J))}function y(_){return{from:function(T){return _.prototype=Object.create(T.prototype),b(_.prototype,"constructor",_),{extend:m.bind(null,_.prototype)}}}}var w=Object.getOwnPropertyDescriptor,C=[].slice;function S(_,T,L){return C.call(_,T,L)}function x(_,T){return T(_)}function k(_){if(!_)throw new Error("Assertion Failed")}function A(_){a.setImmediate?setImmediate(_):setTimeout(_,0)}function R(_,T){if(typeof T=="string"&&p(_,T))return _[T];if(!T)return _;if(typeof T!="string"){for(var L=[],J=0,re=T.length;J<re;++J){var le=R(_,T[J]);L.push(le)}return L}var _e=T.indexOf(".");if(_e!==-1){var Re=_[T.substr(0,_e)];return Re==null?void 0:R(Re,T.substr(_e+1))}}function I(_,T,L){if(_&&T!==void 0&&!("isFrozen"in Object&&Object.isFrozen(_)))if(typeof T!="string"&&"length"in T){k(typeof L!="string"&&"length"in L);for(var J=0,re=T.length;J<re;++J)I(_,T[J],L[J])}else{var le,_e,Re=T.indexOf(".");Re!==-1?(le=T.substr(0,Re),(_e=T.substr(Re+1))===""?L===void 0?u(_)&&!isNaN(parseInt(le))?_.splice(le,1):delete _[le]:_[le]=L:I(Re=!(Re=_[le])||!p(_,le)?_[le]={}:Re,_e,L)):L===void 0?u(_)&&!isNaN(parseInt(T))?_.splice(T,1):delete _[T]:_[T]=L}}function U(_){var T,L={};for(T in _)p(_,T)&&(L[T]=_[T]);return L}var te=[].concat;function G(_){return te.apply([],_)}var j="BigUint64Array,BigInt64Array,Array,Boolean,String,Date,RegExp,Blob,File,FileList,FileSystemFileHandle,FileSystemDirectoryHandle,ArrayBuffer,DataView,Uint8ClampedArray,ImageBitmap,ImageData,Map,Set,CryptoKey".split(",").concat(G([8,16,32,64].map(function(_){return["Int","Uint","Float"].map(function(T){return T+_+"Array"})}))).filter(function(_){return a[_]}),Y=new Set(j.map(function(_){return a[_]})),O=null;function N(_){return O=new WeakMap,_=(function T(L){if(!L||typeof L!="object")return L;var J=O.get(L);if(J)return J;if(u(L)){J=[],O.set(L,J);for(var re=0,le=L.length;re<le;++re)J.push(T(L[re]))}else if(Y.has(L.constructor))J=L;else{var _e,Re=f(L);for(_e in J=Re===Object.prototype?{}:Object.create(Re),O.set(L,J),L)p(L,_e)&&(J[_e]=T(L[_e]))}return J})(_),O=null,_}var Q={}.toString;function q(_){return Q.call(_).slice(8,-1)}var ee=typeof Symbol<"u"?Symbol.iterator:"@@iterator",ne=typeof ee=="symbol"?function(_){var T;return _!=null&&(T=_[ee])&&T.apply(_)}:function(){return null};function B(_,T){return T=_.indexOf(T),0<=T&&_.splice(T,1),0<=T}var z={};function $(_){var T,L,J,re;if(arguments.length===1){if(u(_))return _.slice();if(this===z&&typeof _=="string")return[_];if(re=ne(_)){for(L=[];!(J=re.next()).done;)L.push(J.value);return L}if(_==null)return[_];if(typeof(T=_.length)!="number")return[_];for(L=new Array(T);T--;)L[T]=_[T];return L}for(T=arguments.length,L=new Array(T);T--;)L[T]=arguments[T];return L}var V=typeof Symbol<"u"?function(_){return _[Symbol.toStringTag]==="AsyncFunction"}:function(){return!1},Zt=["Unknown","Constraint","Data","TransactionInactive","ReadOnly","Version","NotFound","InvalidState","InvalidAccess","Abort","Timeout","QuotaExceeded","Syntax","DataClone"],ri=["Modify","Bulk","OpenFailed","VersionChange","Schema","Upgrade","InvalidTable","MissingAPI","NoSuchDatabase","InvalidArgument","SubTransaction","Unsupported","Internal","DatabaseClosed","PrematureCommit","ForeignAwait"].concat(Zt),Z={VersionChanged:"Database version changed by other database connection",DatabaseClosed:"Database has been closed",Abort:"Transaction aborted",TransactionInactive:"Transaction has already completed or failed",MissingAPI:"IndexedDB API missing. Please visit https://tinyurl.com/y2uuvskb"};function ae(_,T){this.name=_,this.message=T}function Ae(_,T){return _+". Errors: "+Object.keys(T).map(function(L){return T[L].toString()}).filter(function(L,J,re){return re.indexOf(L)===J}).join(`
`)}function be(_,T,L,J){this.failures=T,this.failedKeys=J,this.successCount=L,this.message=Ae(_,T)}function Ge(_,T){this.name="BulkError",this.failures=Object.keys(T).map(function(L){return T[L]}),this.failuresByPos=T,this.message=Ae(_,this.failures)}y(ae).from(Error).extend({toString:function(){return this.name+": "+this.message}}),y(be).from(ae),y(Ge).from(ae);var Te=ri.reduce(function(_,T){return _[T]=T+"Error",_},{}),ve=ae,ke=ri.reduce(function(_,T){var L=T+"Error";function J(re,le){this.name=L,re?typeof re=="string"?(this.message="".concat(re).concat(le?`
 `+le:""),this.inner=le||null):typeof re=="object"&&(this.message="".concat(re.name," ").concat(re.message),this.inner=re):(this.message=Z[T]||L,this.inner=null)}return y(J).from(ve),_[T]=J,_},{});ke.Syntax=SyntaxError,ke.Type=TypeError,ke.Range=RangeError;var Me=Zt.reduce(function(_,T){return _[T+"Error"]=ke[T],_},{}),Ie=ri.reduce(function(_,T){return["Syntax","Type","Range"].indexOf(T)===-1&&(_[T+"Error"]=ke[T]),_},{});function Ce(){}function ot(_){return _}function et(_,T){return _==null||_===ot?T:function(L){return T(_(L))}}function me(_,T){return function(){_.apply(this,arguments),T.apply(this,arguments)}}function de(_,T){return _===Ce?T:function(){var L=_.apply(this,arguments);L!==void 0&&(arguments[0]=L);var J=this.onsuccess,re=this.onerror;this.onsuccess=null,this.onerror=null;var le=T.apply(this,arguments);return J&&(this.onsuccess=this.onsuccess?me(J,this.onsuccess):J),re&&(this.onerror=this.onerror?me(re,this.onerror):re),le!==void 0?le:L}}function Be(_,T){return _===Ce?T:function(){_.apply(this,arguments);var L=this.onsuccess,J=this.onerror;this.onsuccess=this.onerror=null,T.apply(this,arguments),L&&(this.onsuccess=this.onsuccess?me(L,this.onsuccess):L),J&&(this.onerror=this.onerror?me(J,this.onerror):J)}}function Je(_,T){return _===Ce?T:function(L){var J=_.apply(this,arguments);c(L,J);var re=this.onsuccess,le=this.onerror;return this.onsuccess=null,this.onerror=null,L=T.apply(this,arguments),re&&(this.onsuccess=this.onsuccess?me(re,this.onsuccess):re),le&&(this.onerror=this.onerror?me(le,this.onerror):le),J===void 0?L===void 0?void 0:L:c(J,L)}}function rt(_,T){return _===Ce?T:function(){return T.apply(this,arguments)!==!1&&_.apply(this,arguments)}}function at(_,T){return _===Ce?T:function(){var L=_.apply(this,arguments);if(L&&typeof L.then=="function"){for(var J=this,re=arguments.length,le=new Array(re);re--;)le[re]=arguments[re];return L.then(function(){return T.apply(J,le)})}return T.apply(this,arguments)}}Ie.ModifyError=be,Ie.DexieError=ae,Ie.BulkError=Ge;var ye=typeof location<"u"&&/^(http|https):\/\/(localhost|127\.0\.0\.1)/.test(location.href);function it(_){ye=_}var Mt={},nt=100,j=typeof Promise>"u"?[]:(function(){var _=Promise.resolve();if(typeof crypto>"u"||!crypto.subtle)return[_,f(_),_];var T=crypto.subtle.digest("SHA-512",new Uint8Array([0]));return[T,f(T),_]})(),Zt=j[0],ri=j[1],j=j[2],ri=ri&&ri.then,W=Zt&&Zt.constructor,se=!!j,Oe=function(_,T){an.push([_,T]),gt&&(queueMicrotask(Ot),gt=!1)},Ke=!0,gt=!0,Ut=[],Le=[],Xe=ot,zt={id:"global",global:!0,ref:0,unhandleds:[],onunhandled:Ce,pgp:!1,env:{},finalize:Ce},mt=zt,an=[],hn=0,pr=[];function Ft(_){if(typeof this!="object")throw new TypeError("Promises must be constructed via new");this._listeners=[],this._lib=!1;var T=this._PSD=mt;if(typeof _!="function"){if(_!==Mt)throw new TypeError("Not a function");return this._state=arguments[1],this._value=arguments[2],void(this._state===!1&&_r(this,this._value))}this._state=null,this._value=null,++T.ref,(function L(J,re){try{re(function(le){if(J._state===null){if(le===J)throw new TypeError("A promise cannot be resolved with itself.");var _e=J._lib&&qt();le&&typeof le.then=="function"?L(J,function(Re,Ue){le instanceof Ft?le._then(Re,Ue):le.then(Re,Ue)}):(J._state=!0,J._value=le,Zn(J)),_e&&fe()}},_r.bind(null,J))}catch(le){_r(J,le)}})(this,_)}var Bn={get:function(){var _=mt,T=ge;function L(J,re){var le=this,_e=!_.global&&(_!==mt||T!==ge),Re=_e&&!Nt(),Ue=new Ft(function(qe,We){Ht(le,new xr(wn(J,_,_e,Re),wn(re,_,_e,Re),qe,We,_))});return this._consoleTask&&(Ue._consoleTask=this._consoleTask),Ue}return L.prototype=Mt,L},set:function(_){b(this,"then",_&&_.prototype===Mt?Bn:{get:function(){return _},set:Bn.set})}};function xr(_,T,L,J,re){this.onFulfilled=typeof _=="function"?_:null,this.onRejected=typeof T=="function"?T:null,this.resolve=L,this.reject=J,this.psd=re}function _r(_,T){var L,J;Le.push(T),_._state===null&&(L=_._lib&&qt(),T=Xe(T),_._state=!1,_._value=T,J=_,Ut.some(function(re){return re._value===J._value})||Ut.push(J),Zn(_),L&&fe())}function Zn(_){var T=_._listeners;_._listeners=[];for(var L=0,J=T.length;L<J;++L)Ht(_,T[L]);var re=_._PSD;--re.ref||re.finalize(),hn===0&&(++hn,Oe(function(){--hn==0&&we()},[]))}function Ht(_,T){if(_._state!==null){var L=_._state?T.onFulfilled:T.onRejected;if(L===null)return(_._state?T.resolve:T.reject)(_._value);++T.psd.ref,++hn,Oe(pe,[L,_,T])}else _._listeners.push(T)}function pe(_,T,L){try{var J,re=T._value;!T._state&&Le.length&&(Le=[]),J=ye&&T._consoleTask?T._consoleTask.run(function(){return _(re)}):_(re),T._state||Le.indexOf(re)!==-1||(function(le){for(var _e=Ut.length;_e;)if(Ut[--_e]._value===le._value)return Ut.splice(_e,1)})(T),L.resolve(J)}catch(le){L.reject(le)}finally{--hn==0&&we(),--L.psd.ref||L.psd.finalize()}}function Ot(){sn(zt,function(){qt()&&fe()})}function qt(){var _=Ke;return gt=Ke=!1,_}function fe(){var _,T,L;do for(;0<an.length;)for(_=an,an=[],L=_.length,T=0;T<L;++T){var J=_[T];J[0].apply(null,J[1])}while(0<an.length);gt=Ke=!0}function we(){var _=Ut;Ut=[],_.forEach(function(J){J._PSD.onunhandled.call(null,J._value,J)});for(var T=pr.slice(0),L=T.length;L;)T[--L]()}function pt(_){return new Ft(Mt,!1,_)}function At(_,T){var L=mt;return function(){var J=qt(),re=mt;try{return vn(L,!0),_.apply(this,arguments)}catch(le){T&&T(le)}finally{vn(re,!1),J&&fe()}}}m(Ft.prototype,{then:Bn,_then:function(_,T){Ht(this,new xr(null,null,_,T,mt))},catch:function(_){if(arguments.length===1)return this.then(null,_);var T=_,L=arguments[1];return typeof T=="function"?this.then(null,function(J){return(J instanceof T?L:pt)(J)}):this.then(null,function(J){return(J&&J.name===T?L:pt)(J)})},finally:function(_){return this.then(function(T){return Ft.resolve(_()).then(function(){return T})},function(T){return Ft.resolve(_()).then(function(){return pt(T)})})},timeout:function(_,T){var L=this;return _<1/0?new Ft(function(J,re){var le=setTimeout(function(){return re(new ke.Timeout(T))},_);L.then(J,re).finally(clearTimeout.bind(null,le))}):this}}),typeof Symbol<"u"&&Symbol.toStringTag&&b(Ft.prototype,Symbol.toStringTag,"Dexie.Promise"),zt.env=$t(),m(Ft,{all:function(){var _=$.apply(null,arguments).map(Yt);return new Ft(function(T,L){_.length===0&&T([]);var J=_.length;_.forEach(function(re,le){return Ft.resolve(re).then(function(_e){_[le]=_e,--J||T(_)},L)})})},resolve:function(_){return _ instanceof Ft?_:_&&typeof _.then=="function"?new Ft(function(T,L){_.then(T,L)}):new Ft(Mt,!0,_)},reject:pt,race:function(){var _=$.apply(null,arguments).map(Yt);return new Ft(function(T,L){_.map(function(J){return Ft.resolve(J).then(T,L)})})},PSD:{get:function(){return mt},set:function(_){return mt=_}},totalEchoes:{get:function(){return ge}},newPSD:ze,usePSD:sn,scheduler:{get:function(){return Oe},set:function(_){Oe=_}},rejectionMapper:{get:function(){return Xe},set:function(_){Xe=_}},follow:function(_,T){return new Ft(function(L,J){return ze(function(re,le){var _e=mt;_e.unhandleds=[],_e.onunhandled=le,_e.finalize=me(function(){var Re,Ue=this;Re=function(){Ue.unhandleds.length===0?re():le(Ue.unhandleds[0])},pr.push(function qe(){Re(),pr.splice(pr.indexOf(qe),1)}),++hn,Oe(function(){--hn==0&&we()},[])},_e.finalize),_()},T,L,J)})}}),W&&(W.allSettled&&b(Ft,"allSettled",function(){var _=$.apply(null,arguments).map(Yt);return new Ft(function(T){_.length===0&&T([]);var L=_.length,J=new Array(L);_.forEach(function(re,le){return Ft.resolve(re).then(function(_e){return J[le]={status:"fulfilled",value:_e}},function(_e){return J[le]={status:"rejected",reason:_e}}).then(function(){return--L||T(J)})})})}),W.any&&typeof AggregateError<"u"&&b(Ft,"any",function(){var _=$.apply(null,arguments).map(Yt);return new Ft(function(T,L){_.length===0&&L(new AggregateError([]));var J=_.length,re=new Array(J);_.forEach(function(le,_e){return Ft.resolve(le).then(function(Re){return T(Re)},function(Re){re[_e]=Re,--J||L(new AggregateError(re))})})})}),W.withResolvers&&(Ft.withResolvers=W.withResolvers));var K={awaits:0,echoes:0,id:0},oe=0,ce=[],D=0,ge=0,$e=0;function ze(_,T,L,J){var re=mt,le=Object.create(re);return le.parent=re,le.ref=0,le.global=!1,le.id=++$e,zt.env,le.env=se?{Promise:Ft,PromiseProp:{value:Ft,configurable:!0,writable:!0},all:Ft.all,race:Ft.race,allSettled:Ft.allSettled,any:Ft.any,resolve:Ft.resolve,reject:Ft.reject}:{},T&&c(le,T),++re.ref,le.finalize=function(){--this.parent.ref||this.parent.finalize()},J=sn(le,_,L,J),le.ref===0&&le.finalize(),J}function vt(){return K.id||(K.id=++oe),++K.awaits,K.echoes+=nt,K.id}function Nt(){return!!K.awaits&&(--K.awaits==0&&(K.id=0),K.echoes=K.awaits*nt,!0)}function Yt(_){return K.echoes&&_&&_.constructor===W?(vt(),_.then(function(T){return Nt(),T},function(T){return Nt(),tn(T)})):_}function Kt(){var _=ce[ce.length-1];ce.pop(),vn(_,!1)}function vn(_,T){var L,J=mt;(T?!K.echoes||D++&&_===mt:!D||--D&&_===mt)||queueMicrotask(T?(function(re){++ge,K.echoes&&--K.echoes!=0||(K.echoes=K.awaits=K.id=0),ce.push(mt),vn(re,!0)}).bind(null,_):Kt),_!==mt&&(mt=_,J===zt&&(zt.env=$t()),se&&(L=zt.env.Promise,T=_.env,(J.global||_.global)&&(Object.defineProperty(a,"Promise",T.PromiseProp),L.all=T.all,L.race=T.race,L.resolve=T.resolve,L.reject=T.reject,T.allSettled&&(L.allSettled=T.allSettled),T.any&&(L.any=T.any))))}function $t(){var _=a.Promise;return se?{Promise:_,PromiseProp:Object.getOwnPropertyDescriptor(a,"Promise"),all:_.all,race:_.race,allSettled:_.allSettled,any:_.any,resolve:_.resolve,reject:_.reject}:{}}function sn(_,T,L,J,re){var le=mt;try{return vn(_,!0),T(L,J,re)}finally{vn(le,!1)}}function wn(_,T,L,J){return typeof _!="function"?_:function(){var re=mt;L&&vt(),vn(T,!0);try{return _.apply(this,arguments)}finally{vn(re,!1),J&&queueMicrotask(Nt)}}}function xn(_){Promise===W&&K.echoes===0?D===0?_():enqueueNativeMicroTask(_):setTimeout(_,0)}(""+ri).indexOf("[native code]")===-1&&(vt=Nt=Ce);var tn=Ft.reject,dn="",cn="Invalid key provided. Keys must be of type string, number, Date or Array<string | number | Date>.",on="String expected.",Xt=[],ln="__dbnames",Wt="readonly",en="readwrite";function nn(_,T){return _?T?function(){return _.apply(this,arguments)&&T.apply(this,arguments)}:_:T}var Jt={type:3,lower:-1/0,lowerOpen:!1,upper:[[]],upperOpen:!1};function ht(_){return typeof _!="string"||/\./.test(_)?function(T){return T}:function(T){return T[_]===void 0&&_ in T&&delete(T=N(T))[_],T}}function yt(){throw ke.Type("Entity instances must never be new:ed. Instances are generated by the framework bypassing the constructor.")}function bt(_,T){try{var L=kt(_),J=kt(T);if(L!==J)return L==="Array"?1:J==="Array"?-1:L==="binary"?1:J==="binary"?-1:L==="string"?1:J==="string"?-1:L==="Date"?1:J!=="Date"?NaN:-1;switch(L){case"number":case"Date":case"string":return T<_?1:_<T?-1:0;case"binary":return(function(re,le){for(var _e=re.length,Re=le.length,Ue=_e<Re?_e:Re,qe=0;qe<Ue;++qe)if(re[qe]!==le[qe])return re[qe]<le[qe]?-1:1;return _e===Re?0:_e<Re?-1:1})(Ct(_),Ct(T));case"Array":return(function(re,le){for(var _e=re.length,Re=le.length,Ue=_e<Re?_e:Re,qe=0;qe<Ue;++qe){var We=bt(re[qe],le[qe]);if(We!==0)return We}return _e===Re?0:_e<Re?-1:1})(_,T)}}catch{}return NaN}function kt(_){var T=typeof _;return T!="object"?T:ArrayBuffer.isView(_)?"binary":(_=q(_),_==="ArrayBuffer"?"binary":_)}function Ct(_){return _ instanceof Uint8Array?_:ArrayBuffer.isView(_)?new Uint8Array(_.buffer,_.byteOffset,_.byteLength):new Uint8Array(_)}function Pt(_,T,L){var J=_.schema.yProps;return J?(T&&0<L.numFailures&&(T=T.filter(function(re,le){return!L.failures[le]})),Promise.all(J.map(function(re){return re=re.updatesTable,T?_.db.table(re).where("k").anyOf(T).delete():_.db.table(re).clear()})).then(function(){return L})):L}var pn=(Qt.prototype.execute=function(_){var T=this["@@propmod"];if(T.add!==void 0){var L=T.add;if(u(L))return s(s([],u(_)?_:[],!0),L).sort();if(typeof L=="number")return(Number(_)||0)+L;if(typeof L=="bigint")try{return BigInt(_)+L}catch{return BigInt(0)+L}throw new TypeError("Invalid term ".concat(L))}if(T.remove!==void 0){var J=T.remove;if(u(J))return u(_)?_.filter(function(re){return!J.includes(re)}).sort():[];if(typeof J=="number")return Number(_)-J;if(typeof J=="bigint")try{return BigInt(_)-J}catch{return BigInt(0)-J}throw new TypeError("Invalid subtrahend ".concat(J))}return L=(L=T.replacePrefix)===null||L===void 0?void 0:L[0],L&&typeof _=="string"&&_.startsWith(L)?T.replacePrefix[1]+_.substring(L.length):_},Qt);function Qt(_){this["@@propmod"]=_}function An(_,T){for(var L=l(T),J=L.length,re=!1,le=0;le<J;++le){var _e=L[le],Re=T[_e],Ue=R(_,_e);Re instanceof pn?(I(_,_e,Re.execute(Ue)),re=!0):Ue!==Re&&(I(_,_e,Re),re=!0)}return re}var kn=(Ee.prototype._trans=function(_,T,L){var J=this._tx||mt.trans,re=this.name,le=ye&&typeof console<"u"&&console.createTask&&console.createTask("Dexie: ".concat(_==="readonly"?"read":"write"," ").concat(this.name));function _e(qe,We,je){if(!je.schema[re])throw new ke.NotFound("Table "+re+" not part of transaction");return T(je.idbtrans,je)}var Re=qt();try{var Ue=J&&J.db._novip===this.db._novip?J===mt.trans?J._promise(_,_e,L):ze(function(){return J._promise(_,_e,L)},{trans:J,transless:mt.transless||mt}):(function qe(We,je,Ze,Fe){if(We.idbdb&&(We._state.openComplete||mt.letThrough||We._vip)){var Ve=We._createTransaction(je,Ze,We._dbSchema);try{Ve.create(),We._state.PR1398_maxLoop=3}catch(Ye){return Ye.name===Te.InvalidState&&We.isOpen()&&0<--We._state.PR1398_maxLoop?(console.warn("Dexie: Need to reopen db"),We.close({disableAutoOpen:!1}),We.open().then(function(){return qe(We,je,Ze,Fe)})):tn(Ye)}return Ve._promise(je,function(Ye,Qe){return ze(function(){return mt.trans=Ve,Fe(Ye,Qe,Ve)})}).then(function(Ye){if(je==="readwrite")try{Ve.idbtrans.commit()}catch{}return je==="readonly"?Ye:Ve._completion.then(function(){return Ye})})}if(We._state.openComplete)return tn(new ke.DatabaseClosed(We._state.dbOpenError));if(!We._state.isBeingOpened){if(!We._state.autoOpen)return tn(new ke.DatabaseClosed);We.open().catch(Ce)}return We._state.dbReadyPromise.then(function(){return qe(We,je,Ze,Fe)})})(this.db,_,[this.name],_e);return le&&(Ue._consoleTask=le,Ue=Ue.catch(function(qe){return console.trace(qe),tn(qe)})),Ue}finally{Re&&fe()}},Ee.prototype.get=function(_,T){var L=this;return _&&_.constructor===Object?this.where(_).first(T):_==null?tn(new ke.Type("Invalid argument to Table.get()")):this._trans("readonly",function(J){return L.core.get({trans:J,key:_}).then(function(re){return L.hook.reading.fire(re)})}).then(T)},Ee.prototype.where=function(_){if(typeof _=="string")return new this.db.WhereClause(this,_);if(u(_))return new this.db.WhereClause(this,"[".concat(_.join("+"),"]"));var T=l(_);if(T.length===1)return this.where(T[0]).equals(_[T[0]]);var L=this.schema.indexes.concat(this.schema.primKey).filter(function(Re){if(Re.compound&&T.every(function(qe){return 0<=Re.keyPath.indexOf(qe)})){for(var Ue=0;Ue<T.length;++Ue)if(T.indexOf(Re.keyPath[Ue])===-1)return!1;return!0}return!1}).sort(function(Re,Ue){return Re.keyPath.length-Ue.keyPath.length})[0];if(L&&this.db._maxKey!==dn){var le=L.keyPath.slice(0,T.length);return this.where(le).equals(le.map(function(Ue){return _[Ue]}))}!L&&ye&&console.warn("The query ".concat(JSON.stringify(_)," on ").concat(this.name," would benefit from a ")+"compound index [".concat(T.join("+"),"]"));var J=this.schema.idxByName;function re(Re,Ue){return bt(Re,Ue)===0}var _e=T.reduce(function(je,Ue){var qe=je[0],We=je[1],je=J[Ue],Ze=_[Ue];return[qe||je,qe||!je?nn(We,je&&je.multi?function(Fe){return Fe=R(Fe,Ue),u(Fe)&&Fe.some(function(Ve){return re(Ze,Ve)})}:function(Fe){return re(Ze,R(Fe,Ue))}):We]},[null,null]),le=_e[0],_e=_e[1];return le?this.where(le.name).equals(_[le.keyPath]).filter(_e):L?this.filter(_e):this.where(T).equals("")},Ee.prototype.filter=function(_){return this.toCollection().and(_)},Ee.prototype.count=function(_){return this.toCollection().count(_)},Ee.prototype.offset=function(_){return this.toCollection().offset(_)},Ee.prototype.limit=function(_){return this.toCollection().limit(_)},Ee.prototype.each=function(_){return this.toCollection().each(_)},Ee.prototype.toArray=function(_){return this.toCollection().toArray(_)},Ee.prototype.toCollection=function(){return new this.db.Collection(new this.db.WhereClause(this))},Ee.prototype.orderBy=function(_){return new this.db.Collection(new this.db.WhereClause(this,u(_)?"[".concat(_.join("+"),"]"):_))},Ee.prototype.reverse=function(){return this.toCollection().reverse()},Ee.prototype.mapToClass=function(_){var T,L=this.db,J=this.name;function re(){return T!==null&&T.apply(this,arguments)||this}(this.schema.mappedClass=_).prototype instanceof yt&&((function(Ue,qe){if(typeof qe!="function"&&qe!==null)throw new TypeError("Class extends value "+String(qe)+" is not a constructor or null");function We(){this.constructor=Ue}t(Ue,qe),Ue.prototype=qe===null?Object.create(qe):(We.prototype=qe.prototype,new We)})(re,T=_),Object.defineProperty(re.prototype,"db",{get:function(){return L},enumerable:!1,configurable:!0}),re.prototype.table=function(){return J},_=re);for(var le=new Set,_e=_.prototype;_e;_e=f(_e))Object.getOwnPropertyNames(_e).forEach(function(Ue){return le.add(Ue)});function Re(Ue){if(!Ue)return Ue;var qe,We=Object.create(_.prototype);for(qe in Ue)if(!le.has(qe))try{We[qe]=Ue[qe]}catch{}return We}return this.schema.readHook&&this.hook.reading.unsubscribe(this.schema.readHook),this.schema.readHook=Re,this.hook("reading",Re),_},Ee.prototype.defineClass=function(){return this.mapToClass(function(_){c(this,_)})},Ee.prototype.add=function(_,T){var L=this,J=this.schema.primKey,re=J.auto,le=J.keyPath,_e=_;return le&&re&&(_e=ht(le)(_)),this._trans("readwrite",function(Re){return L.core.mutate({trans:Re,type:"add",keys:T!=null?[T]:null,values:[_e]})}).then(function(Re){return Re.numFailures?Ft.reject(Re.failures[0]):Re.lastResult}).then(function(Re){if(le)try{I(_,le,Re)}catch{}return Re})},Ee.prototype.upsert=function(_,T){var L=this,J=this.schema.primKey.keyPath;return this._trans("readwrite",function(re){return L.core.get({trans:re,key:_}).then(function(le){var _e=le??{};return An(_e,T),J&&I(_e,J,_),L.core.mutate({trans:re,type:"put",values:[_e],keys:[_],upsert:!0,updates:{keys:[_],changeSpecs:[T]}}).then(function(Re){return Re.numFailures?Ft.reject(Re.failures[0]):!!le})})})},Ee.prototype.update=function(_,T){return typeof _!="object"||u(_)?this.where(":id").equals(_).modify(T):(_=R(_,this.schema.primKey.keyPath),_===void 0?tn(new ke.InvalidArgument("Given object does not contain its primary key")):this.where(":id").equals(_).modify(T))},Ee.prototype.put=function(_,T){var L=this,J=this.schema.primKey,re=J.auto,le=J.keyPath,_e=_;return le&&re&&(_e=ht(le)(_)),this._trans("readwrite",function(Re){return L.core.mutate({trans:Re,type:"put",values:[_e],keys:T!=null?[T]:null})}).then(function(Re){return Re.numFailures?Ft.reject(Re.failures[0]):Re.lastResult}).then(function(Re){if(le)try{I(_,le,Re)}catch{}return Re})},Ee.prototype.delete=function(_){var T=this;return this._trans("readwrite",function(L){return T.core.mutate({trans:L,type:"delete",keys:[_]}).then(function(J){return Pt(T,[_],J)}).then(function(J){return J.numFailures?Ft.reject(J.failures[0]):void 0})})},Ee.prototype.clear=function(){var _=this;return this._trans("readwrite",function(T){return _.core.mutate({trans:T,type:"deleteRange",range:Jt}).then(function(L){return Pt(_,null,L)})}).then(function(T){return T.numFailures?Ft.reject(T.failures[0]):void 0})},Ee.prototype.bulkGet=function(_){var T=this;return this._trans("readonly",function(L){return T.core.getMany({keys:_,trans:L}).then(function(J){return J.map(function(re){return T.hook.reading.fire(re)})})})},Ee.prototype.bulkAdd=function(_,T,L){var J=this,re=Array.isArray(T)?T:void 0,le=(L=L||(re?void 0:T))?L.allKeys:void 0;return this._trans("readwrite",function(_e){var qe=J.schema.primKey,Re=qe.auto,qe=qe.keyPath;if(qe&&re)throw new ke.InvalidArgument("bulkAdd(): keys argument invalid on tables with inbound keys");if(re&&re.length!==_.length)throw new ke.InvalidArgument("Arguments objects and keys must have the same length");var Ue=_.length,qe=qe&&Re?_.map(ht(qe)):_;return J.core.mutate({trans:_e,type:"add",keys:re,values:qe,wantResults:le}).then(function(Ve){var je=Ve.numFailures,Ze=Ve.results,Fe=Ve.lastResult,Ve=Ve.failures;if(je===0)return le?Ze:Fe;throw new Ge("".concat(J.name,".bulkAdd(): ").concat(je," of ").concat(Ue," operations failed"),Ve)})})},Ee.prototype.bulkPut=function(_,T,L){var J=this,re=Array.isArray(T)?T:void 0,le=(L=L||(re?void 0:T))?L.allKeys:void 0;return this._trans("readwrite",function(_e){var qe=J.schema.primKey,Re=qe.auto,qe=qe.keyPath;if(qe&&re)throw new ke.InvalidArgument("bulkPut(): keys argument invalid on tables with inbound keys");if(re&&re.length!==_.length)throw new ke.InvalidArgument("Arguments objects and keys must have the same length");var Ue=_.length,qe=qe&&Re?_.map(ht(qe)):_;return J.core.mutate({trans:_e,type:"put",keys:re,values:qe,wantResults:le}).then(function(Ve){var je=Ve.numFailures,Ze=Ve.results,Fe=Ve.lastResult,Ve=Ve.failures;if(je===0)return le?Ze:Fe;throw new Ge("".concat(J.name,".bulkPut(): ").concat(je," of ").concat(Ue," operations failed"),Ve)})})},Ee.prototype.bulkUpdate=function(_){var T=this,L=this.core,J=_.map(function(_e){return _e.key}),re=_.map(function(_e){return _e.changes}),le=[];return this._trans("readwrite",function(_e){return L.getMany({trans:_e,keys:J,cache:"clone"}).then(function(Re){var Ue=[],qe=[];_.forEach(function(je,Ze){var Fe=je.key,Ve=je.changes,Ye=Re[Ze];if(Ye){for(var Qe=0,st=Object.keys(Ve);Qe<st.length;Qe++){var ft=st[Qe],xt=Ve[ft];if(ft===T.schema.primKey.keyPath){if(bt(xt,Fe)!==0)throw new ke.Constraint("Cannot update primary key in bulkUpdate()")}else I(Ye,ft,xt)}le.push(Ze),Ue.push(Fe),qe.push(Ye)}});var We=Ue.length;return L.mutate({trans:_e,type:"put",keys:Ue,values:qe,updates:{keys:J,changeSpecs:re}}).then(function(je){var Ze=je.numFailures,Fe=je.failures;if(Ze===0)return We;for(var Ve=0,Ye=Object.keys(Fe);Ve<Ye.length;Ve++){var Qe,st=Ye[Ve],ft=le[Number(st)];ft!=null&&(Qe=Fe[st],delete Fe[st],Fe[ft]=Qe)}throw new Ge("".concat(T.name,".bulkUpdate(): ").concat(Ze," of ").concat(We," operations failed"),Fe)})})})},Ee.prototype.bulkDelete=function(_){var T=this,L=_.length;return this._trans("readwrite",function(J){return T.core.mutate({trans:J,type:"delete",keys:_}).then(function(re){return Pt(T,_,re)})}).then(function(_e){var re=_e.numFailures,le=_e.lastResult,_e=_e.failures;if(re===0)return le;throw new Ge("".concat(T.name,".bulkDelete(): ").concat(re," of ").concat(L," operations failed"),_e)})},Ee);function Ee(){}function Tn(_){function T(_e,Re){if(Re){for(var Ue=arguments.length,qe=new Array(Ue-1);--Ue;)qe[Ue-1]=arguments[Ue];return L[_e].subscribe.apply(null,qe),_}if(typeof _e=="string")return L[_e]}var L={};T.addEventType=le;for(var J=1,re=arguments.length;J<re;++J)le(arguments[J]);return T;function le(_e,Re,Ue){if(typeof _e!="object"){var qe;Re=Re||rt;var We={subscribers:[],fire:Ue=Ue||Ce,subscribe:function(je){We.subscribers.indexOf(je)===-1&&(We.subscribers.push(je),We.fire=Re(We.fire,je))},unsubscribe:function(je){We.subscribers=We.subscribers.filter(function(Ze){return Ze!==je}),We.fire=We.subscribers.reduce(Re,Ue)}};return L[_e]=T[_e]=We}l(qe=_e).forEach(function(je){var Ze=qe[je];if(u(Ze))le(je,qe[je][0],qe[je][1]);else{if(Ze!=="asap")throw new ke.InvalidArgument("Invalid event config");var Fe=le(je,ot,function(){for(var Ve=arguments.length,Ye=new Array(Ve);Ve--;)Ye[Ve]=arguments[Ve];Fe.subscribers.forEach(function(Qe){A(function(){Qe.apply(null,Ye)})})})}})}}function _n(_,T){return y(T).from({prototype:_}),T}function Mn(_,T){return!(_.filter||_.algorithm||_.or)&&(T?_.justLimit:!_.replayFilter)}function In(_,T){_.filter=nn(_.filter,T)}function On(_,T,L){var J=_.replayFilter;_.replayFilter=J?function(){return nn(J(),T())}:T,_.justLimit=L&&!J}function Rn(_,T){if(_.isPrimKey)return T.primaryKey;var L=T.getIndexByKeyPath(_.index);if(!L)throw new ke.Schema("KeyPath "+_.index+" on object store "+T.name+" is not indexed");return L}function rr(_,T,L){var J=Rn(_,T.schema);return T.openCursor({trans:L,values:!_.keysOnly,reverse:_.dir==="prev",unique:!!_.unique,query:{index:J,range:_.range}})}function qn(_,T,L,J){var re=_.replayFilter?nn(_.filter,_.replayFilter()):_.filter;if(_.or){var le={},_e=function(Re,Ue,qe){var We,je;re&&!re(Ue,qe,function(Ze){return Ue.stop(Ze)},function(Ze){return Ue.fail(Ze)})||((je=""+(We=Ue.primaryKey))=="[object ArrayBuffer]"&&(je=""+new Uint8Array(We)),p(le,je)||(le[je]=!0,T(Re,Ue,qe)))};return Promise.all([_.or._iterate(_e,L),Vn(rr(_,J,L),_.algorithm,_e,!_.keysOnly&&_.valueMapper)])}return Vn(rr(_,J,L),nn(_.algorithm,re),T,!_.keysOnly&&_.valueMapper)}function Vn(_,T,L,J){var re=At(J?function(le,_e,Re){return L(J(le),_e,Re)}:L);return _.then(function(le){if(le)return le.start(function(){var _e=function(){return le.continue()};T&&!T(le,function(Re){return _e=Re},function(Re){le.stop(Re),_e=Ce},function(Re){le.fail(Re),_e=Ce})||re(le.value,le,function(Re){return _e=Re}),_e()})})}var cr=(mn.prototype._read=function(_,T){var L=this._ctx;return L.error?L.table._trans(null,tn.bind(null,L.error)):L.table._trans("readonly",_).then(T)},mn.prototype._write=function(_){var T=this._ctx;return T.error?T.table._trans(null,tn.bind(null,T.error)):T.table._trans("readwrite",_,"locked")},mn.prototype._addAlgorithm=function(_){var T=this._ctx;T.algorithm=nn(T.algorithm,_)},mn.prototype._iterate=function(_,T){return qn(this._ctx,_,T,this._ctx.table.core)},mn.prototype.clone=function(_){var T=Object.create(this.constructor.prototype),L=Object.create(this._ctx);return _&&c(L,_),T._ctx=L,T},mn.prototype.raw=function(){return this._ctx.valueMapper=null,this},mn.prototype.each=function(_){var T=this._ctx;return this._read(function(L){return qn(T,_,L,T.table.core)})},mn.prototype.count=function(_){var T=this;return this._read(function(L){var J=T._ctx,re=J.table.core;if(Mn(J,!0))return re.count({trans:L,query:{index:Rn(J,re.schema),range:J.range}}).then(function(_e){return Math.min(_e,J.limit)});var le=0;return qn(J,function(){return++le,!1},L,re).then(function(){return le})}).then(_)},mn.prototype.sortBy=function(_,T){var L=_.split(".").reverse(),J=L[0],re=L.length-1;function le(Ue,qe){return qe?le(Ue[L[qe]],qe-1):Ue[J]}var _e=this._ctx.dir==="next"?1:-1;function Re(Ue,qe){return bt(le(Ue,re),le(qe,re))*_e}return this.toArray(function(Ue){return Ue.sort(Re)}).then(T)},mn.prototype.toArray=function(_){var T=this;return this._read(function(L){var J=T._ctx;if(J.dir==="next"&&Mn(J,!0)&&0<J.limit){var re=J.valueMapper,le=Rn(J,J.table.core.schema);return J.table.core.query({trans:L,limit:J.limit,values:!0,query:{index:le,range:J.range}}).then(function(Re){return Re=Re.result,re?Re.map(re):Re})}var _e=[];return qn(J,function(Re){return _e.push(Re)},L,J.table.core).then(function(){return _e})},_)},mn.prototype.offset=function(_){var T=this._ctx;return _<=0||(T.offset+=_,Mn(T)?On(T,function(){var L=_;return function(J,re){return L===0||(L===1?--L:re(function(){J.advance(L),L=0}),!1)}}):On(T,function(){var L=_;return function(){return--L<0}})),this},mn.prototype.limit=function(_){return this._ctx.limit=Math.min(this._ctx.limit,_),On(this._ctx,function(){var T=_;return function(L,J,re){return--T<=0&&J(re),0<=T}},!0),this},mn.prototype.until=function(_,T){return In(this._ctx,function(L,J,re){return!_(L.value)||(J(re),T)}),this},mn.prototype.first=function(_){return this.limit(1).toArray(function(T){return T[0]}).then(_)},mn.prototype.last=function(_){return this.reverse().first(_)},mn.prototype.filter=function(_){var T;return In(this._ctx,function(L){return _(L.value)}),(T=this._ctx).isMatch=nn(T.isMatch,_),this},mn.prototype.and=function(_){return this.filter(_)},mn.prototype.or=function(_){return new this.db.WhereClause(this._ctx.table,_,this)},mn.prototype.reverse=function(){return this._ctx.dir=this._ctx.dir==="prev"?"next":"prev",this._ondirectionchange&&this._ondirectionchange(this._ctx.dir),this},mn.prototype.desc=function(){return this.reverse()},mn.prototype.eachKey=function(_){var T=this._ctx;return T.keysOnly=!T.isMatch,this.each(function(L,J){_(J.key,J)})},mn.prototype.eachUniqueKey=function(_){return this._ctx.unique="unique",this.eachKey(_)},mn.prototype.eachPrimaryKey=function(_){var T=this._ctx;return T.keysOnly=!T.isMatch,this.each(function(L,J){_(J.primaryKey,J)})},mn.prototype.keys=function(_){var T=this._ctx;T.keysOnly=!T.isMatch;var L=[];return this.each(function(J,re){L.push(re.key)}).then(function(){return L}).then(_)},mn.prototype.primaryKeys=function(_){var T=this._ctx;if(T.dir==="next"&&Mn(T,!0)&&0<T.limit)return this._read(function(J){var re=Rn(T,T.table.core.schema);return T.table.core.query({trans:J,values:!1,limit:T.limit,query:{index:re,range:T.range}})}).then(function(J){return J.result}).then(_);T.keysOnly=!T.isMatch;var L=[];return this.each(function(J,re){L.push(re.primaryKey)}).then(function(){return L}).then(_)},mn.prototype.uniqueKeys=function(_){return this._ctx.unique="unique",this.keys(_)},mn.prototype.firstKey=function(_){return this.limit(1).keys(function(T){return T[0]}).then(_)},mn.prototype.lastKey=function(_){return this.reverse().firstKey(_)},mn.prototype.distinct=function(){var _=this._ctx,_=_.index&&_.table.schema.idxByName[_.index];if(!_||!_.multi)return this;var T={};return In(this._ctx,function(re){var J=re.primaryKey.toString(),re=p(T,J);return T[J]=!0,!re}),this},mn.prototype.modify=function(_){var T=this,L=this._ctx;return this._write(function(J){var re=typeof _=="function"?_:function(Ye){return An(Ye,_)},le=L.table.core,qe=le.schema.primaryKey,_e=qe.outbound,Re=qe.extractKey,Ue=200,qe=T.db._options.modifyChunkSize;qe&&(Ue=typeof qe=="object"?qe[le.name]||qe["*"]||200:qe);function We(Ye,ft){var st=ft.failures,ft=ft.numFailures;Ze+=Ye-ft;for(var xt=0,Dt=l(st);xt<Dt.length;xt++){var H=Dt[xt];je.push(st[H])}}var je=[],Ze=0,Fe=[],Ve=_===Jn;return T.clone().primaryKeys().then(function(Ye){function Qe(ft){var xt=Math.min(Ue,Ye.length-ft),Dt=Ye.slice(ft,ft+xt);return(Ve?Promise.resolve([]):le.getMany({trans:J,keys:Dt,cache:"immutable"})).then(function(H){var F=[],ie=[],he=_e?[]:null,xe=Ve?Dt:[];if(!Ve)for(var Se=0;Se<xt;++Se){var Ne=H[Se],Pe={value:N(Ne),primKey:Ye[ft+Se]};re.call(Pe,Pe.value,Pe)!==!1&&(Pe.value==null?xe.push(Ye[ft+Se]):_e||bt(Re(Ne),Re(Pe.value))===0?(ie.push(Pe.value),_e&&he.push(Ye[ft+Se])):(xe.push(Ye[ft+Se]),F.push(Pe.value)))}return Promise.resolve(0<F.length&&le.mutate({trans:J,type:"add",values:F}).then(function(lt){for(var It in lt.failures)xe.splice(parseInt(It),1);We(F.length,lt)})).then(function(){return(0<ie.length||st&&typeof _=="object")&&le.mutate({trans:J,type:"put",keys:he,values:ie,criteria:st,changeSpec:typeof _!="function"&&_,isAdditionalChunk:0<ft}).then(function(lt){return We(ie.length,lt)})}).then(function(){return(0<xe.length||st&&Ve)&&le.mutate({trans:J,type:"delete",keys:xe,criteria:st,isAdditionalChunk:0<ft}).then(function(lt){return Pt(L.table,xe,lt)}).then(function(lt){return We(xe.length,lt)})}).then(function(){return Ye.length>ft+xt&&Qe(ft+Ue)})})}var st=Mn(L)&&L.limit===1/0&&(typeof _!="function"||Ve)&&{index:L.index,range:L.range};return Qe(0).then(function(){if(0<je.length)throw new be("Error modifying one or more objects",je,Ze,Fe);return Ye.length})})})},mn.prototype.delete=function(){var _=this._ctx,T=_.range;return!Mn(_)||_.table.schema.yProps||!_.isPrimKey&&T.type!==3?this.modify(Jn):this._write(function(L){var J=_.table.core.schema.primaryKey,re=T;return _.table.core.count({trans:L,query:{index:J,range:re}}).then(function(le){return _.table.core.mutate({trans:L,type:"deleteRange",range:re}).then(function(Ue){var Re=Ue.failures,Ue=Ue.numFailures;if(Ue)throw new be("Could not delete some values",Object.keys(Re).map(function(qe){return Re[qe]}),le-Ue);return le-Ue})})})},mn);function mn(){}var Jn=function(_,T){return T.value=null};function br(_,T){return _<T?-1:_===T?0:1}function sr(_,T){return T<_?-1:_===T?0:1}function $n(_,T,L){return _=_ instanceof as?new _.Collection(_):_,_._ctx.error=new(L||TypeError)(T),_}function Fi(_){return new _.Collection(_,function(){return qo("")}).limit(0)}function fi(_,T,L,J){var re,le,_e,Re,Ue,qe,We,je=L.length;if(!L.every(function(Ve){return typeof Ve=="string"}))return $n(_,on);function Ze(Ve){re=Ve==="next"?function(Qe){return Qe.toUpperCase()}:function(Qe){return Qe.toLowerCase()},le=Ve==="next"?function(Qe){return Qe.toLowerCase()}:function(Qe){return Qe.toUpperCase()},_e=Ve==="next"?br:sr;var Ye=L.map(function(Qe){return{lower:le(Qe),upper:re(Qe)}}).sort(function(Qe,st){return _e(Qe.lower,st.lower)});Re=Ye.map(function(Qe){return Qe.upper}),Ue=Ye.map(function(Qe){return Qe.lower}),We=(qe=Ve)==="next"?"":J}Ze("next"),_=new _.Collection(_,function(){return Mi(Re[0],Ue[je-1]+J)}),_._ondirectionchange=function(Ve){Ze(Ve)};var Fe=0;return _._addAlgorithm(function(Ve,Ye,Qe){var st=Ve.key;if(typeof st!="string")return!1;var ft=le(st);if(T(ft,Ue,Fe))return!0;for(var xt=null,Dt=Fe;Dt<je;++Dt){var H=(function(F,ie,he,xe,Se,Ne){for(var Pe=Math.min(F.length,xe.length),lt=-1,It=0;It<Pe;++It){var Vt=ie[It];if(Vt!==xe[It])return Se(F[It],he[It])<0?F.substr(0,It)+he[It]+he.substr(It+1):Se(F[It],xe[It])<0?F.substr(0,It)+xe[It]+he.substr(It+1):0<=lt?F.substr(0,lt)+ie[lt]+he.substr(lt+1):null;Se(F[It],Vt)<0&&(lt=It)}return Pe<xe.length&&Ne==="next"?F+he.substr(F.length):Pe<F.length&&Ne==="prev"?F.substr(0,he.length):lt<0?null:F.substr(0,lt)+xe[lt]+he.substr(lt+1)})(st,ft,Re[Dt],Ue[Dt],_e,qe);H===null&&xt===null?Fe=Dt+1:(xt===null||0<_e(xt,H))&&(xt=H)}return Ye(xt!==null?function(){Ve.continue(xt+We)}:Qe),!1}),_}function Mi(_,T,L,J){return{type:2,lower:_,upper:T,lowerOpen:L,upperOpen:J}}function qo(_){return{type:1,lower:_,upper:_}}var as=(Object.defineProperty(gr.prototype,"Collection",{get:function(){return this._ctx.table.db.Collection},enumerable:!1,configurable:!0}),gr.prototype.between=function(_,T,L,J){L=L!==!1,J=J===!0;try{return 0<this._cmp(_,T)||this._cmp(_,T)===0&&(L||J)&&(!L||!J)?Fi(this):new this.Collection(this,function(){return Mi(_,T,!L,!J)})}catch{return $n(this,cn)}},gr.prototype.equals=function(_){return _==null?$n(this,cn):new this.Collection(this,function(){return qo(_)})},gr.prototype.above=function(_){return _==null?$n(this,cn):new this.Collection(this,function(){return Mi(_,void 0,!0)})},gr.prototype.aboveOrEqual=function(_){return _==null?$n(this,cn):new this.Collection(this,function(){return Mi(_,void 0,!1)})},gr.prototype.below=function(_){return _==null?$n(this,cn):new this.Collection(this,function(){return Mi(void 0,_,!1,!0)})},gr.prototype.belowOrEqual=function(_){return _==null?$n(this,cn):new this.Collection(this,function(){return Mi(void 0,_)})},gr.prototype.startsWith=function(_){return typeof _!="string"?$n(this,on):this.between(_,_+dn,!0,!0)},gr.prototype.startsWithIgnoreCase=function(_){return _===""?this.startsWith(_):fi(this,function(T,L){return T.indexOf(L[0])===0},[_],dn)},gr.prototype.equalsIgnoreCase=function(_){return fi(this,function(T,L){return T===L[0]},[_],"")},gr.prototype.anyOfIgnoreCase=function(){var _=$.apply(z,arguments);return _.length===0?Fi(this):fi(this,function(T,L){return L.indexOf(T)!==-1},_,"")},gr.prototype.startsWithAnyOfIgnoreCase=function(){var _=$.apply(z,arguments);return _.length===0?Fi(this):fi(this,function(T,L){return L.some(function(J){return T.indexOf(J)===0})},_,dn)},gr.prototype.anyOf=function(){var _=this,T=$.apply(z,arguments),L=this._cmp;try{T.sort(L)}catch{return $n(this,cn)}if(T.length===0)return Fi(this);var J=new this.Collection(this,function(){return Mi(T[0],T[T.length-1])});J._ondirectionchange=function(le){L=le==="next"?_._ascending:_._descending,T.sort(L)};var re=0;return J._addAlgorithm(function(le,_e,Re){for(var Ue=le.key;0<L(Ue,T[re]);)if(++re===T.length)return _e(Re),!1;return L(Ue,T[re])===0||(_e(function(){le.continue(T[re])}),!1)}),J},gr.prototype.notEqual=function(_){return this.inAnyRange([[-1/0,_],[_,this.db._maxKey]],{includeLowers:!1,includeUppers:!1})},gr.prototype.noneOf=function(){var _=$.apply(z,arguments);if(_.length===0)return new this.Collection(this);try{_.sort(this._ascending)}catch{return $n(this,cn)}var T=_.reduce(function(L,J){return L?L.concat([[L[L.length-1][1],J]]):[[-1/0,J]]},null);return T.push([_[_.length-1],this.db._maxKey]),this.inAnyRange(T,{includeLowers:!1,includeUppers:!1})},gr.prototype.inAnyRange=function(st,T){var L=this,J=this._cmp,re=this._ascending,le=this._descending,_e=this._min,Re=this._max;if(st.length===0)return Fi(this);if(!st.every(function(ft){return ft[0]!==void 0&&ft[1]!==void 0&&re(ft[0],ft[1])<=0}))return $n(this,"First argument to inAnyRange() must be an Array of two-value Arrays [lower,upper] where upper must not be lower than lower",ke.InvalidArgument);var Ue=!T||T.includeLowers!==!1,qe=T&&T.includeUppers===!0,We,je=re;function Ze(ft,xt){return je(ft[0],xt[0])}try{(We=st.reduce(function(ft,xt){for(var Dt=0,H=ft.length;Dt<H;++Dt){var F=ft[Dt];if(J(xt[0],F[1])<0&&0<J(xt[1],F[0])){F[0]=_e(F[0],xt[0]),F[1]=Re(F[1],xt[1]);break}}return Dt===H&&ft.push(xt),ft},[])).sort(Ze)}catch{return $n(this,cn)}var Fe=0,Ve=qe?function(ft){return 0<re(ft,We[Fe][1])}:function(ft){return 0<=re(ft,We[Fe][1])},Ye=Ue?function(ft){return 0<le(ft,We[Fe][0])}:function(ft){return 0<=le(ft,We[Fe][0])},Qe=Ve,st=new this.Collection(this,function(){return Mi(We[0][0],We[We.length-1][1],!Ue,!qe)});return st._ondirectionchange=function(ft){je=ft==="next"?(Qe=Ve,re):(Qe=Ye,le),We.sort(Ze)},st._addAlgorithm(function(ft,xt,Dt){for(var H,F=ft.key;Qe(F);)if(++Fe===We.length)return xt(Dt),!1;return!Ve(H=F)&&!Ye(H)||(L._cmp(F,We[Fe][1])===0||L._cmp(F,We[Fe][0])===0||xt(function(){je===re?ft.continue(We[Fe][0]):ft.continue(We[Fe][1])}),!1)}),st},gr.prototype.startsWithAnyOf=function(){var _=$.apply(z,arguments);return _.every(function(T){return typeof T=="string"})?_.length===0?Fi(this):this.inAnyRange(_.map(function(T){return[T,T+dn]})):$n(this,"startsWithAnyOf() only works with strings")},gr);function gr(){}function _i(_){return At(function(T){return ls(T),_(T.target.error),!1})}function ls(_){_.stopPropagation&&_.stopPropagation(),_.preventDefault&&_.preventDefault()}var Cs="storagemutated",cs="x-storagemutated-1",Sr=Tn(null,Cs),Fo=(Wr.prototype._lock=function(){return k(!mt.global),++this._reculock,this._reculock!==1||mt.global||(mt.lockOwnerFor=this),this},Wr.prototype._unlock=function(){if(k(!mt.global),--this._reculock==0)for(mt.global||(mt.lockOwnerFor=null);0<this._blockedFuncs.length&&!this._locked();){var _=this._blockedFuncs.shift();try{sn(_[1],_[0])}catch{}}return this},Wr.prototype._locked=function(){return this._reculock&&mt.lockOwnerFor!==this},Wr.prototype.create=function(_){var T=this;if(!this.mode)return this;var L=this.db.idbdb,J=this.db._state.dbOpenError;if(k(!this.idbtrans),!_&&!L)switch(J&&J.name){case"DatabaseClosedError":throw new ke.DatabaseClosed(J);case"MissingAPIError":throw new ke.MissingAPI(J.message,J);default:throw new ke.OpenFailed(J)}if(!this.active)throw new ke.TransactionInactive;return k(this._completion._state===null),(_=this.idbtrans=_||(this.db.core||L).transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability})).onerror=At(function(re){ls(re),T._reject(_.error)}),_.onabort=At(function(re){ls(re),T.active&&T._reject(new ke.Abort(_.error)),T.active=!1,T.on("abort").fire(re)}),_.oncomplete=At(function(){T.active=!1,T._resolve(),"mutatedParts"in _&&Sr.storagemutated.fire(_.mutatedParts)}),this},Wr.prototype._promise=function(_,T,L){var J=this;if(_==="readwrite"&&this.mode!=="readwrite")return tn(new ke.ReadOnly("Transaction is readonly"));if(!this.active)return tn(new ke.TransactionInactive);if(this._locked())return new Ft(function(le,_e){J._blockedFuncs.push([function(){J._promise(_,T,L).then(le,_e)},mt])});if(L)return ze(function(){var le=new Ft(function(_e,Re){J._lock();var Ue=T(_e,Re,J);Ue&&Ue.then&&Ue.then(_e,Re)});return le.finally(function(){return J._unlock()}),le._lib=!0,le});var re=new Ft(function(le,_e){var Re=T(le,_e,J);Re&&Re.then&&Re.then(le,_e)});return re._lib=!0,re},Wr.prototype._root=function(){return this.parent?this.parent._root():this},Wr.prototype.waitFor=function(_){var T,L=this._root(),J=Ft.resolve(_);L._waitingFor?L._waitingFor=L._waitingFor.then(function(){return J}):(L._waitingFor=J,L._waitingQueue=[],T=L.idbtrans.objectStore(L.storeNames[0]),(function le(){for(++L._spinCount;L._waitingQueue.length;)L._waitingQueue.shift()();L._waitingFor&&(T.get(-1/0).onsuccess=le)})());var re=L._waitingFor;return new Ft(function(le,_e){J.then(function(Re){return L._waitingQueue.push(At(le.bind(null,Re)))},function(Re){return L._waitingQueue.push(At(_e.bind(null,Re)))}).finally(function(){L._waitingFor===re&&(L._waitingFor=null)})})},Wr.prototype.abort=function(){this.active&&(this.active=!1,this.idbtrans&&this.idbtrans.abort(),this._reject(new ke.Abort))},Wr.prototype.table=function(_){var T=this._memoizedTables||(this._memoizedTables={});if(p(T,_))return T[_];var L=this.schema[_];if(!L)throw new ke.NotFound("Table "+_+" not part of transaction");return L=new this.db.Table(_,L,this),L.core=this.db.core.table(_),T[_]=L},Wr);function Wr(){}function Si(_,T,L,J,re,le,_e,Re){return{name:_,keyPath:T,unique:L,multi:J,auto:re,compound:le,src:(L&&!_e?"&":"")+(J?"*":"")+(re?"++":"")+Ho(T),type:Re}}function Ho(_){return typeof _=="string"?_:_?"["+[].join.call(_,"+")+"]":""}function As(_,T,L){return{name:_,primKey:T,indexes:L,mappedClass:null,idxByName:(J=function(re){return[re.name,re]},L.reduce(function(re,le,_e){return _e=J(le,_e),_e&&(re[_e[0]]=_e[1]),re},{}))};var J}var us=function(_){try{return _.only([[]]),us=function(){return[[]]},[[]]}catch{return us=function(){return dn},dn}};function ks(_){return _==null?function(){}:typeof _=="string"?(T=_).split(".").length===1?function(L){return L[T]}:function(L){return R(L,T)}:function(L){return R(L,_)};var T}function $s(_){return[].slice.call(_)}var Pl=0;function Br(_){return _==null?":id":typeof _=="string"?_:"[".concat(_.join("+"),"]")}function fs(_,T,Ue){function J(Qe){if(Qe.type===3)return null;if(Qe.type===4)throw new Error("Cannot convert never type to IDBKeyRange");var Fe=Qe.lower,Ve=Qe.upper,Ye=Qe.lowerOpen,Qe=Qe.upperOpen;return Fe===void 0?Ve===void 0?null:T.upperBound(Ve,!!Qe):Ve===void 0?T.lowerBound(Fe,!!Ye):T.bound(Fe,Ve,!!Ye,!!Qe)}function re(Ze){var Fe,Ve=Ze.name;return{name:Ve,schema:Ze,mutate:function(Ye){var Qe=Ye.trans,st=Ye.type,ft=Ye.keys,xt=Ye.values,Dt=Ye.range;return new Promise(function(H,F){H=At(H);var ie=Qe.objectStore(Ve),he=ie.keyPath==null,xe=st==="put"||st==="add";if(!xe&&st!=="delete"&&st!=="deleteRange")throw new Error("Invalid operation type: "+st);var Se,Ne=(ft||xt||{length:1}).length;if(ft&&xt&&ft.length!==xt.length)throw new Error("Given keys array must have same length as given values array.");if(Ne===0)return H({numFailures:0,failures:{},results:[],lastResult:void 0});function Pe(Un){++Vt,ls(Un)}var lt=[],It=[],Vt=0;if(st==="deleteRange"){if(Dt.type===4)return H({numFailures:Vt,failures:It,results:[],lastResult:void 0});Dt.type===3?lt.push(Se=ie.clear()):lt.push(Se=ie.delete(J(Dt)))}else{var he=xe?he?[xt,ft]:[xt,null]:[ft,null],Gt=he[0],En=he[1];if(xe)for(var bn=0;bn<Ne;++bn)lt.push(Se=En&&En[bn]!==void 0?ie[st](Gt[bn],En[bn]):ie[st](Gt[bn])),Se.onerror=Pe;else for(bn=0;bn<Ne;++bn)lt.push(Se=ie[st](Gt[bn])),Se.onerror=Pe}function Xn(Un){Un=Un.target.result,lt.forEach(function(Wn,kr){return Wn.error!=null&&(It[kr]=Wn.error)}),H({numFailures:Vt,failures:It,results:st==="delete"?ft:lt.map(function(Wn){return Wn.result}),lastResult:Un})}Se.onerror=function(Un){Pe(Un),Xn(Un)},Se.onsuccess=Xn})},getMany:function(Ye){var Qe=Ye.trans,st=Ye.keys;return new Promise(function(ft,xt){ft=At(ft);for(var Dt,H=Qe.objectStore(Ve),F=st.length,ie=new Array(F),he=0,xe=0,Se=function(lt){lt=lt.target,ie[lt._pos]=lt.result,++xe===he&&ft(ie)},Ne=_i(xt),Pe=0;Pe<F;++Pe)st[Pe]!=null&&((Dt=H.get(st[Pe]))._pos=Pe,Dt.onsuccess=Se,Dt.onerror=Ne,++he);he===0&&ft(ie)})},get:function(Ye){var Qe=Ye.trans,st=Ye.key;return new Promise(function(ft,xt){ft=At(ft);var Dt=Qe.objectStore(Ve).get(st);Dt.onsuccess=function(H){return ft(H.target.result)},Dt.onerror=_i(xt)})},query:(Fe=qe,function(Ye){return new Promise(function(Qe,st){Qe=At(Qe);var ft,xt,Dt,he=Ye.trans,H=Ye.values,F=Ye.limit,Se=Ye.query,ie=F===1/0?void 0:F,xe=Se.index,Se=Se.range,he=he.objectStore(Ve),xe=xe.isPrimaryKey?he:he.index(xe.name),Se=J(Se);if(F===0)return Qe({result:[]});Fe?((ie=H?xe.getAll(Se,ie):xe.getAllKeys(Se,ie)).onsuccess=function(Ne){return Qe({result:Ne.target.result})},ie.onerror=_i(st)):(ft=0,xt=!H&&"openKeyCursor"in xe?xe.openKeyCursor(Se):xe.openCursor(Se),Dt=[],xt.onsuccess=function(Ne){var Pe=xt.result;return Pe?(Dt.push(H?Pe.value:Pe.primaryKey),++ft===F?Qe({result:Dt}):void Pe.continue()):Qe({result:Dt})},xt.onerror=_i(st))})}),openCursor:function(Ye){var Qe=Ye.trans,st=Ye.values,ft=Ye.query,xt=Ye.reverse,Dt=Ye.unique;return new Promise(function(H,F){H=At(H);var xe=ft.index,ie=ft.range,he=Qe.objectStore(Ve),he=xe.isPrimaryKey?he:he.index(xe.name),xe=xt?Dt?"prevunique":"prev":Dt?"nextunique":"next",Se=!st&&"openKeyCursor"in he?he.openKeyCursor(J(ie),xe):he.openCursor(J(ie),xe);Se.onerror=_i(F),Se.onsuccess=At(function(Ne){var Pe,lt,It,Vt,Gt=Se.result;Gt?(Gt.___id=++Pl,Gt.done=!1,Pe=Gt.continue.bind(Gt),lt=(lt=Gt.continuePrimaryKey)&&lt.bind(Gt),It=Gt.advance.bind(Gt),Vt=function(){throw new Error("Cursor not stopped")},Gt.trans=Qe,Gt.stop=Gt.continue=Gt.continuePrimaryKey=Gt.advance=function(){throw new Error("Cursor not started")},Gt.fail=At(F),Gt.next=function(){var En=this,bn=1;return this.start(function(){return bn--?En.continue():En.stop()}).then(function(){return En})},Gt.start=function(En){function bn(){if(Se.result)try{En()}catch(Un){Gt.fail(Un)}else Gt.done=!0,Gt.start=function(){throw new Error("Cursor behind last entry")},Gt.stop()}var Xn=new Promise(function(Un,Wn){Un=At(Un),Se.onerror=_i(Wn),Gt.fail=Wn,Gt.stop=function(kr){Gt.stop=Gt.continue=Gt.continuePrimaryKey=Gt.advance=Vt,Un(kr)}});return Se.onsuccess=At(function(Un){Se.onsuccess=bn,bn()}),Gt.continue=Pe,Gt.continuePrimaryKey=lt,Gt.advance=It,bn(),Xn},H(Gt)):H(null)},F)})},count:function(Ye){var Qe=Ye.query,st=Ye.trans,ft=Qe.index,xt=Qe.range;return new Promise(function(Dt,H){var F=st.objectStore(Ve),ie=ft.isPrimaryKey?F:F.index(ft.name),F=J(xt),ie=F?ie.count(F):ie.count();ie.onsuccess=At(function(he){return Dt(he.target.result)}),ie.onerror=_i(H)})}}}var le,_e,Re,We=(_e=Ue,Re=$s((le=_).objectStoreNames),{schema:{name:le.name,tables:Re.map(function(Ze){return _e.objectStore(Ze)}).map(function(Ze){var Fe=Ze.keyPath,Qe=Ze.autoIncrement,Ve=u(Fe),Ye={},Qe={name:Ze.name,primaryKey:{name:null,isPrimaryKey:!0,outbound:Fe==null,compound:Ve,keyPath:Fe,autoIncrement:Qe,unique:!0,extractKey:ks(Fe)},indexes:$s(Ze.indexNames).map(function(st){return Ze.index(st)}).map(function(Dt){var ft=Dt.name,xt=Dt.unique,H=Dt.multiEntry,Dt=Dt.keyPath,H={name:ft,compound:u(Dt),keyPath:Dt,unique:xt,multiEntry:H,extractKey:ks(Dt)};return Ye[Br(Dt)]=H}),getIndexByKeyPath:function(st){return Ye[Br(st)]}};return Ye[":id"]=Qe.primaryKey,Fe!=null&&(Ye[Br(Fe)]=Qe.primaryKey),Qe})},hasGetAll:0<Re.length&&"getAll"in _e.objectStore(Re[0])&&!(typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604)}),Ue=We.schema,qe=We.hasGetAll,We=Ue.tables.map(re),je={};return We.forEach(function(Ze){return je[Ze.name]=Ze}),{stack:"dbcore",transaction:_.transaction.bind(_),table:function(Ze){if(!je[Ze])throw new Error("Table '".concat(Ze,"' not found"));return je[Ze]},MIN_KEY:-1/0,MAX_KEY:us(T),schema:Ue}}function zo(_,T,L,J){var re=L.IDBKeyRange;return L.indexedDB,{dbcore:(J=fs(T,re,J),_.dbcore.reduce(function(le,_e){return _e=_e.create,n(n({},le),_e(le))},J))}}function $i(_,J){var L=J.db,J=zo(_._middlewares,L,_._deps,J);_.core=J.dbcore,_.tables.forEach(function(re){var le=re.name;_.core.schema.tables.some(function(_e){return _e.name===le})&&(re.core=_.core.table(le),_[le]instanceof _.Table&&(_[le].core=re.core))})}function Go(_,T,L,J){L.forEach(function(re){var le=J[re];T.forEach(function(_e){var Re=(function Ue(qe,We){return w(qe,We)||(qe=f(qe))&&Ue(qe,We)})(_e,re);(!Re||"value"in Re&&Re.value===void 0)&&(_e===_.Transaction.prototype||_e instanceof _.Transaction?b(_e,re,{get:function(){return this.table(re)},set:function(Ue){v(this,re,{value:Ue,writable:!0,configurable:!0,enumerable:!0})}}):_e[re]=new _.Table(re,le))})})}function Ys(_,T){T.forEach(function(L){for(var J in L)L[J]instanceof _.Table&&delete L[J]})}function za(_,T){return _._cfg.version-T._cfg.version}function hs(_,T,L,J){var re=_._dbSchema;L.objectStoreNames.contains("$meta")&&!re.$meta&&(re.$meta=As("$meta",Ll("")[0],[]),_._storeNames.push("$meta"));var le=_._createTransaction("readwrite",_._storeNames,re);le.create(L),le._completion.catch(J);var _e=le._reject.bind(le),Re=mt.transless||mt;ze(function(){return mt.trans=le,mt.transless=Re,T!==0?($i(_,L),qe=T,((Ue=le).storeNames.includes("$meta")?Ue.table("$meta").get("version").then(function(We){return We??qe}):Ft.resolve(qe)).then(function(We){return Ze=We,Fe=le,Ve=L,Ye=[],We=(je=_)._versions,Qe=je._dbSchema=Ts(0,je.idbdb,Ve),(We=We.filter(function(st){return st._cfg.version>=Ze})).length!==0?(We.forEach(function(st){Ye.push(function(){var ft=Qe,xt=st._cfg.dbschema;Ws(je,ft,Ve),Ws(je,xt,Ve),Qe=je._dbSchema=xt;var Dt=Vo(ft,xt);Dt.add.forEach(function(xe){Ga(Ve,xe[0],xe[1].primKey,xe[1].indexes)}),Dt.change.forEach(function(xe){if(xe.recreate)throw new ke.Upgrade("Not yet support for changing primary key");var Se=Ve.objectStore(xe.name);xe.add.forEach(function(Ne){return $o(Se,Ne)}),xe.change.forEach(function(Ne){Se.deleteIndex(Ne.name),$o(Se,Ne)}),xe.del.forEach(function(Ne){return Se.deleteIndex(Ne)})});var H=st._cfg.contentUpgrade;if(H&&st._cfg.version>Ze){$i(je,Ve),Fe._memoizedTables={};var F=U(xt);Dt.del.forEach(function(xe){F[xe]=ft[xe]}),Ys(je,[je.Transaction.prototype]),Go(je,[je.Transaction.prototype],l(F),F),Fe.schema=F;var ie,he=V(H);return he&&vt(),Dt=Ft.follow(function(){var xe;(ie=H(Fe))&&he&&(xe=Nt.bind(null,null),ie.then(xe,xe))}),ie&&typeof ie.then=="function"?Ft.resolve(ie):Dt.then(function(){return ie})}}),Ye.push(function(ft){var xt,Dt,H=st._cfg.dbschema;xt=H,Dt=ft,[].slice.call(Dt.db.objectStoreNames).forEach(function(F){return xt[F]==null&&Dt.db.deleteObjectStore(F)}),Ys(je,[je.Transaction.prototype]),Go(je,[je.Transaction.prototype],je._storeNames,je._dbSchema),Fe.schema=je._dbSchema}),Ye.push(function(ft){je.idbdb.objectStoreNames.contains("$meta")&&(Math.ceil(je.idbdb.version/10)===st._cfg.version?(je.idbdb.deleteObjectStore("$meta"),delete je._dbSchema.$meta,je._storeNames=je._storeNames.filter(function(xt){return xt!=="$meta"})):ft.objectStore("$meta").put(st._cfg.version,"version"))})}),(function st(){return Ye.length?Ft.resolve(Ye.shift()(Fe.idbtrans)).then(st):Ft.resolve()})().then(function(){Ka(Qe,Ve)})):Ft.resolve();var je,Ze,Fe,Ve,Ye,Qe}).catch(_e)):(l(re).forEach(function(We){Ga(L,We,re[We].primKey,re[We].indexes)}),$i(_,L),void Ft.follow(function(){return _.on.populate.fire(le)}).catch(_e));var Ue,qe})}function Ko(_,T){Ka(_._dbSchema,T),T.db.version%10!=0||T.objectStoreNames.contains("$meta")||T.db.createObjectStore("$meta").add(Math.ceil(T.db.version/10-1),"version");var L=Ts(0,_.idbdb,T);Ws(_,_._dbSchema,T);for(var J=0,re=Vo(L,_._dbSchema).change;J<re.length;J++){var le=(function(_e){if(_e.change.length||_e.recreate)return console.warn("Unable to patch indexes of table ".concat(_e.name," because it has changes on the type of index or primary key.")),{value:void 0};var Re=T.objectStore(_e.name);_e.add.forEach(function(Ue){ye&&console.debug("Dexie upgrade patch: Creating missing index ".concat(_e.name,".").concat(Ue.src)),$o(Re,Ue)})})(re[J]);if(typeof le=="object")return le.value}}function Vo(_,T){var L,J={del:[],add:[],change:[]};for(L in _)T[L]||J.del.push(L);for(L in T){var re=_[L],le=T[L];if(re){var _e={name:L,def:le,recreate:!1,del:[],add:[],change:[]};if(""+(re.primKey.keyPath||"")!=""+(le.primKey.keyPath||"")||re.primKey.auto!==le.primKey.auto)_e.recreate=!0,J.change.push(_e);else{var Re=re.idxByName,Ue=le.idxByName,qe=void 0;for(qe in Re)Ue[qe]||_e.del.push(qe);for(qe in Ue){var We=Re[qe],je=Ue[qe];We?We.src!==je.src&&_e.change.push(je):_e.add.push(je)}(0<_e.del.length||0<_e.add.length||0<_e.change.length)&&J.change.push(_e)}}else J.add.push([L,le])}return J}function Ga(_,T,L,J){var re=_.db.createObjectStore(T,L.keyPath?{keyPath:L.keyPath,autoIncrement:L.auto}:{autoIncrement:L.auto});return J.forEach(function(le){return $o(re,le)}),re}function Ka(_,T){l(_).forEach(function(L){T.db.objectStoreNames.contains(L)||(ye&&console.debug("Dexie: Creating missing table",L),Ga(T,L,_[L].primKey,_[L].indexes))})}function $o(_,T){_.createIndex(T.name,T.keyPath,{unique:T.unique,multiEntry:T.multi})}function Ts(_,T,L){var J={};return S(T.objectStoreNames,0).forEach(function(re){for(var le=L.objectStore(re),_e=Si(Ho(qe=le.keyPath),qe||"",!0,!1,!!le.autoIncrement,qe&&typeof qe!="string",!0),Re=[],Ue=0;Ue<le.indexNames.length;++Ue){var We=le.index(le.indexNames[Ue]),qe=We.keyPath,We=Si(We.name,qe,!!We.unique,!!We.multiEntry,!1,qe&&typeof qe!="string",!1);Re.push(We)}J[re]=As(re,_e,Re)}),J}function Ws(_,T,L){for(var J=L.db.objectStoreNames,re=0;re<J.length;++re){var le=J[re],_e=L.objectStore(le);_._hasGetAll="getAll"in _e;for(var Re=0;Re<_e.indexNames.length;++Re){var Ue=_e.indexNames[Re],qe=_e.index(Ue).keyPath,We=typeof qe=="string"?qe:"["+S(qe).join("+")+"]";!T[le]||(qe=T[le].idxByName[We])&&(qe.name=Ue,delete T[le].idxByName[We],T[le].idxByName[Ue]=qe)}}typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&a.WorkerGlobalScope&&a instanceof a.WorkerGlobalScope&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604&&(_._hasGetAll=!1)}function Ll(_){return _.split(",").map(function(T,L){var le=T.split(":"),J=(re=le[1])===null||re===void 0?void 0:re.trim(),re=(T=le[0].trim()).replace(/([&*]|\+\+)/g,""),le=/^\[/.test(re)?re.match(/^\[(.*)\]$/)[1].split("+"):re;return Si(re,le||null,/\&/.test(T),/\*/.test(T),/\+\+/.test(T),u(le),L===0,J)})}var Fc=(Ms.prototype._createTableSchema=As,Ms.prototype._parseIndexSyntax=Ll,Ms.prototype._parseStoresSpec=function(_,T){var L=this;l(_).forEach(function(J){if(_[J]!==null){var re=L._parseIndexSyntax(_[J]),le=re.shift();if(!le)throw new ke.Schema("Invalid schema for table "+J+": "+_[J]);if(le.unique=!0,le.multi)throw new ke.Schema("Primary key cannot be multiEntry*");re.forEach(function(_e){if(_e.auto)throw new ke.Schema("Only primary key can be marked as autoIncrement (++)");if(!_e.keyPath)throw new ke.Schema("Index must have a name and cannot be an empty string")}),re=L._createTableSchema(J,le,re),T[J]=re}})},Ms.prototype.stores=function(L){var T=this.db;this._cfg.storesSource=this._cfg.storesSource?c(this._cfg.storesSource,L):L;var L=T._versions,J={},re={};return L.forEach(function(le){c(J,le._cfg.storesSource),re=le._cfg.dbschema={},le._parseStoresSpec(J,re)}),T._dbSchema=re,Ys(T,[T._allTables,T,T.Transaction.prototype]),Go(T,[T._allTables,T,T.Transaction.prototype,this._cfg.tables],l(re),re),T._storeNames=l(re),this},Ms.prototype.upgrade=function(_){return this._cfg.contentUpgrade=at(this._cfg.contentUpgrade||Ce,_),this},Ms);function Ms(){}function Va(_,T){var L=_._dbNamesDB;return L||(L=_._dbNamesDB=new Ri(ln,{addons:[],indexedDB:_,IDBKeyRange:T})).version(1).stores({dbnames:"name"}),L.table("dbnames")}function Yo(_){return _&&typeof _.databases=="function"}function $a(_){return ze(function(){return mt.letThrough=!0,_()})}function Ya(_){return!("from"in _)}var zr=function(_,T){if(!this){var L=new zr;return _&&"d"in _&&c(L,_),L}c(this,arguments.length?{d:1,from:_,to:1<arguments.length?T:_}:{d:0})};function Qs(_,T,L){var J=bt(T,L);if(!isNaN(J)){if(0<J)throw RangeError();if(Ya(_))return c(_,{from:T,to:L,d:1});var re=_.l,J=_.r;if(bt(L,_.from)<0)return re?Qs(re,T,L):_.l={from:T,to:L,d:1,l:null,r:null},Qo(_);if(0<bt(T,_.to))return J?Qs(J,T,L):_.r={from:T,to:L,d:1,l:null,r:null},Qo(_);bt(T,_.from)<0&&(_.from=T,_.l=null,_.d=J?J.d+1:1),0<bt(L,_.to)&&(_.to=L,_.r=null,_.d=_.l?_.l.d+1:1),L=!_.r,re&&!_.l&&ds(_,re),J&&L&&ds(_,J)}}function ds(_,T){Ya(T)||(function L(J,Ue){var le=Ue.from,_e=Ue.to,Re=Ue.l,Ue=Ue.r;Qs(J,le,_e),Re&&L(J,Re),Ue&&L(J,Ue)})(_,T)}function Ul(_,T){var L=Wo(T),J=L.next();if(J.done)return!1;for(var re=J.value,le=Wo(_),_e=le.next(re.from),Re=_e.value;!J.done&&!_e.done;){if(bt(Re.from,re.to)<=0&&0<=bt(Re.to,re.from))return!0;bt(re.from,Re.from)<0?re=(J=L.next(Re.from)).value:Re=(_e=le.next(re.from)).value}return!1}function Wo(_){var T=Ya(_)?null:{s:0,n:_};return{next:function(L){for(var J=0<arguments.length;T;)switch(T.s){case 0:if(T.s=1,J)for(;T.n.l&&bt(L,T.n.from)<0;)T={up:T,n:T.n.l,s:1};else for(;T.n.l;)T={up:T,n:T.n.l,s:1};case 1:if(T.s=2,!J||bt(L,T.n.to)<=0)return{value:T.n,done:!1};case 2:if(T.n.r){T.s=3,T={up:T,n:T.n.r,s:0};continue}case 3:T=T.up}return{done:!0}}}}function Qo(_){var T,L,J=(((T=_.r)===null||T===void 0?void 0:T.d)||0)-(((L=_.l)===null||L===void 0?void 0:L.d)||0),re=1<J?"r":J<-1?"l":"";re&&(T=re=="r"?"l":"r",L=n({},_),J=_[re],_.from=J.from,_.to=J.to,_[re]=J[re],L[re]=J[T],(_[T]=L).d=Wa(L)),_.d=Wa(_)}function Wa(L){var T=L.r,L=L.l;return(T?L?Math.max(T.d,L.d):T.d:L?L.d:0)+1}function Yi(_,T){return l(T).forEach(function(L){_[L]?ds(_[L],T[L]):_[L]=(function J(re){var le,_e,Re={};for(le in re)p(re,le)&&(_e=re[le],Re[le]=!_e||typeof _e!="object"||Y.has(_e.constructor)?_e:J(_e));return Re})(T[L])}),_}function Qa(_,T){return _.all||T.all||Object.keys(_).some(function(L){return T[L]&&Ul(T[L],_[L])})}m(zr.prototype,((ri={add:function(_){return ds(this,_),this},addKey:function(_){return Qs(this,_,_),this},addKeys:function(_){var T=this;return _.forEach(function(L){return Qs(T,L,L)}),this},hasKey:function(_){var T=Wo(this).next(_).value;return T&&bt(T.from,_)<=0&&0<=bt(T.to,_)}})[ee]=function(){return Wo(this)},ri));var ps={},Ja={},Za=!1;function Jo(_){Yi(Ja,_),Za||(Za=!0,setTimeout(function(){Za=!1,Xa(Ja,!(Ja={}))},0))}function Xa(_,T){T===void 0&&(T=!1);var L=new Set;if(_.all)for(var J=0,re=Object.values(ps);J<re.length;J++)ql(_e=re[J],_,L,T);else for(var le in _){var _e,Re=/^idb\:\/\/(.*)\/(.*)\//.exec(le);Re&&(le=Re[1],Re=Re[2],(_e=ps["idb://".concat(le,"/").concat(Re)])&&ql(_e,_,L,T))}L.forEach(function(Ue){return Ue()})}function ql(_,T,L,J){for(var re=[],le=0,_e=Object.entries(_.queries.query);le<_e.length;le++){for(var Re=_e[le],Ue=Re[0],qe=[],We=0,je=Re[1];We<je.length;We++){var Ze=je[We];Qa(T,Ze.obsSet)?Ze.subscribers.forEach(function(Qe){return L.add(Qe)}):J&&qe.push(Ze)}J&&re.push([Ue,qe])}if(J)for(var Fe=0,Ve=re;Fe<Ve.length;Fe++){var Ye=Ve[Fe],Ue=Ye[0],qe=Ye[1];_.queries.query[Ue]=qe}}function Hc(_){var T=_._state,L=_._deps.indexedDB;if(T.isBeingOpened||_.idbdb)return T.dbReadyPromise.then(function(){return T.dbOpenError?tn(T.dbOpenError):_});T.isBeingOpened=!0,T.dbOpenError=null,T.openComplete=!1;var J=T.openCanceller,re=Math.round(10*_.verno),le=!1;function _e(){if(T.openCanceller!==J)throw new ke.DatabaseClosed("db.open() was cancelled")}function Re(){return new Ft(function(Ze,Fe){if(_e(),!L)throw new ke.MissingAPI;var Ve=_.name,Ye=T.autoSchema||!re?L.open(Ve):L.open(Ve,re);if(!Ye)throw new ke.MissingAPI;Ye.onerror=_i(Fe),Ye.onblocked=At(_._fireOnBlocked),Ye.onupgradeneeded=At(function(Qe){var st;We=Ye.transaction,T.autoSchema&&!_._options.allowEmptyDB?(Ye.onerror=ls,We.abort(),Ye.result.close(),(st=L.deleteDatabase(Ve)).onsuccess=st.onerror=At(function(){Fe(new ke.NoSuchDatabase("Database ".concat(Ve," doesnt exist")))})):(We.onerror=_i(Fe),Qe=Qe.oldVersion>Math.pow(2,62)?0:Qe.oldVersion,je=Qe<1,_.idbdb=Ye.result,le&&Ko(_,We),hs(_,Qe/10,We,Fe))},Fe),Ye.onsuccess=At(function(){We=null;var Qe,st,ft,xt,Dt,H=_.idbdb=Ye.result,F=S(H.objectStoreNames);if(0<F.length)try{var ie=H.transaction((xt=F).length===1?xt[0]:xt,"readonly");if(T.autoSchema)st=H,ft=ie,(Qe=_).verno=st.version/10,ft=Qe._dbSchema=Ts(0,st,ft),Qe._storeNames=S(st.objectStoreNames,0),Go(Qe,[Qe._allTables],l(ft),ft);else if(Ws(_,_._dbSchema,ie),((Dt=Vo(Ts(0,(Dt=_).idbdb,ie),Dt._dbSchema)).add.length||Dt.change.some(function(he){return he.add.length||he.change.length}))&&!le)return console.warn("Dexie SchemaDiff: Schema was extended without increasing the number passed to db.version(). Dexie will add missing parts and increment native version number to workaround this."),H.close(),re=H.version+1,le=!0,Ze(Re());$i(_,ie)}catch{}Xt.push(_),H.onversionchange=At(function(he){T.vcFired=!0,_.on("versionchange").fire(he)}),H.onclose=At(function(){_.close({disableAutoOpen:!1})}),je&&(Dt=_._deps,ie=Ve,H=Dt.indexedDB,Dt=Dt.IDBKeyRange,Yo(H)||ie===ln||Va(H,Dt).put({name:ie}).catch(Ce)),Ze()},Fe)}).catch(function(Ze){switch(Ze?.name){case"UnknownError":if(0<T.PR1398_maxLoop)return T.PR1398_maxLoop--,console.warn("Dexie: Workaround for Chrome UnknownError on open()"),Re();break;case"VersionError":if(0<re)return re=0,Re()}return Ft.reject(Ze)})}var Ue,qe=T.dbReadyResolve,We=null,je=!1;return Ft.race([J,(typeof navigator>"u"?Ft.resolve():!navigator.userAgentData&&/Safari\//.test(navigator.userAgent)&&!/Chrom(e|ium)\//.test(navigator.userAgent)&&indexedDB.databases?new Promise(function(Ze){function Fe(){return indexedDB.databases().finally(Ze)}Ue=setInterval(Fe,100),Fe()}).finally(function(){return clearInterval(Ue)}):Promise.resolve()).then(Re)]).then(function(){return _e(),T.onReadyBeingFired=[],Ft.resolve($a(function(){return _.on.ready.fire(_.vip)})).then(function Ze(){if(0<T.onReadyBeingFired.length){var Fe=T.onReadyBeingFired.reduce(at,Ce);return T.onReadyBeingFired=[],Ft.resolve($a(function(){return Fe(_.vip)})).then(Ze)}})}).finally(function(){T.openCanceller===J&&(T.onReadyBeingFired=null,T.isBeingOpened=!1)}).catch(function(Ze){T.dbOpenError=Ze;try{We&&We.abort()}catch{}return J===T.openCanceller&&_._close(),tn(Ze)}).finally(function(){T.openComplete=!0,qe()}).then(function(){var Ze;return je&&(Ze={},_.tables.forEach(function(Fe){Fe.schema.indexes.forEach(function(Ve){Ve.name&&(Ze["idb://".concat(_.name,"/").concat(Fe.name,"/").concat(Ve.name)]=new zr(-1/0,[[[]]]))}),Ze["idb://".concat(_.name,"/").concat(Fe.name,"/")]=Ze["idb://".concat(_.name,"/").concat(Fe.name,"/:dels")]=new zr(-1/0,[[[]]])}),Sr(Cs).fire(Ze),Xa(Ze,!0)),_})}function Js(_){function T(le){return _.next(le)}var L=re(T),J=re(function(le){return _.throw(le)});function re(le){return function(Ue){var Re=le(Ue),Ue=Re.value;return Re.done?Ue:Ue&&typeof Ue.then=="function"?Ue.then(L,J):u(Ue)?Promise.all(Ue).then(L,J):L(Ue)}}return re(T)()}function Yn(_,T,L){for(var J=u(_)?_.slice():[_],re=0;re<L;++re)J.push(T);return J}var zc={stack:"dbcore",name:"VirtualIndexMiddleware",level:1,create:function(_){return n(n({},_),{table:function(T){var L=_.table(T),J=L.schema,re={},le=[];function _e(je,Ze,Fe){var Ve=Br(je),Ye=re[Ve]=re[Ve]||[],Qe=je==null?0:typeof je=="string"?1:je.length,st=0<Ze,st=n(n({},Fe),{name:st?"".concat(Ve,"(virtual-from:").concat(Fe.name,")"):Fe.name,lowLevelIndex:Fe,isVirtual:st,keyTail:Ze,keyLength:Qe,extractKey:ks(je),unique:!st&&Fe.unique});return Ye.push(st),st.isPrimaryKey||le.push(st),1<Qe&&_e(Qe===2?je[0]:je.slice(0,Qe-1),Ze+1,Fe),Ye.sort(function(ft,xt){return ft.keyTail-xt.keyTail}),st}T=_e(J.primaryKey.keyPath,0,J.primaryKey),re[":id"]=[T];for(var Re=0,Ue=J.indexes;Re<Ue.length;Re++){var qe=Ue[Re];_e(qe.keyPath,0,qe)}function We(je){var Ze,Fe=je.query.index;return Fe.isVirtual?n(n({},je),{query:{index:Fe.lowLevelIndex,range:(Ze=je.query.range,Fe=Fe.keyTail,{type:Ze.type===1?2:Ze.type,lower:Yn(Ze.lower,Ze.lowerOpen?_.MAX_KEY:_.MIN_KEY,Fe),lowerOpen:!0,upper:Yn(Ze.upper,Ze.upperOpen?_.MIN_KEY:_.MAX_KEY,Fe),upperOpen:!0})}}):je}return n(n({},L),{schema:n(n({},J),{primaryKey:T,indexes:le,getIndexByKeyPath:function(je){return(je=re[Br(je)])&&je[0]}}),count:function(je){return L.count(We(je))},query:function(je){return L.query(We(je))},openCursor:function(je){var Ze=je.query.index,Fe=Ze.keyTail,Ve=Ze.isVirtual,Ye=Ze.keyLength;return Ve?L.openCursor(We(je)).then(function(st){return st&&Qe(st)}):L.openCursor(je);function Qe(st){return Object.create(st,{continue:{value:function(ft){ft!=null?st.continue(Yn(ft,je.reverse?_.MAX_KEY:_.MIN_KEY,Fe)):je.unique?st.continue(st.key.slice(0,Ye).concat(je.reverse?_.MIN_KEY:_.MAX_KEY,Fe)):st.continue()}},continuePrimaryKey:{value:function(ft,xt){st.continuePrimaryKey(Yn(ft,_.MAX_KEY,Fe),xt)}},primaryKey:{get:function(){return st.primaryKey}},key:{get:function(){var ft=st.key;return Ye===1?ft[0]:ft.slice(0,Ye)}},value:{get:function(){return st.value}}})}}})}})}};function Ii(_,T,L,J){return L=L||{},J=J||"",l(_).forEach(function(re){var le,_e,Re;p(T,re)?(le=_[re],_e=T[re],typeof le=="object"&&typeof _e=="object"&&le&&_e?(Re=q(le))!==q(_e)?L[J+re]=T[re]:Re==="Object"?Ii(le,_e,L,J+re+"."):le!==_e&&(L[J+re]=T[re]):le!==_e&&(L[J+re]=T[re])):L[J+re]=void 0}),l(T).forEach(function(re){p(_,re)||(L[J+re]=T[re])}),L}function Zs(_,T){return T.type==="delete"?T.keys:T.keys||T.values.map(_.extractKey)}var Fl={stack:"dbcore",name:"HooksMiddleware",level:2,create:function(_){return n(n({},_),{table:function(T){var L=_.table(T),J=L.schema.primaryKey;return n(n({},L),{mutate:function(re){var le=mt.trans,_e=le.table(T).hook,Re=_e.deleting,Ue=_e.creating,qe=_e.updating;switch(re.type){case"add":if(Ue.fire===Ce)break;return le._promise("readwrite",function(){return We(re)},!0);case"put":if(Ue.fire===Ce&&qe.fire===Ce)break;return le._promise("readwrite",function(){return We(re)},!0);case"delete":if(Re.fire===Ce)break;return le._promise("readwrite",function(){return We(re)},!0);case"deleteRange":if(Re.fire===Ce)break;return le._promise("readwrite",function(){return(function je(Ze,Fe,Ve){return L.query({trans:Ze,values:!1,query:{index:J,range:Fe},limit:Ve}).then(function(Ye){var Qe=Ye.result;return We({type:"delete",keys:Qe,trans:Ze}).then(function(st){return 0<st.numFailures?Promise.reject(st.failures[0]):Qe.length<Ve?{failures:[],numFailures:0,lastResult:void 0}:je(Ze,n(n({},Fe),{lower:Qe[Qe.length-1],lowerOpen:!0}),Ve)})})})(re.trans,re.range,1e4)},!0)}return L.mutate(re);function We(je){var Ze,Fe,Ve,Ye=mt.trans,Qe=je.keys||Zs(J,je);if(!Qe)throw new Error("Keys missing");return(je=je.type==="add"||je.type==="put"?n(n({},je),{keys:Qe}):n({},je)).type!=="delete"&&(je.values=s([],je.values)),je.keys&&(je.keys=s([],je.keys)),Ze=L,Ve=Qe,((Fe=je).type==="add"?Promise.resolve([]):Ze.getMany({trans:Fe.trans,keys:Ve,cache:"immutable"})).then(function(st){var ft=Qe.map(function(xt,Dt){var H,F,ie,he=st[Dt],xe={onerror:null,onsuccess:null};return je.type==="delete"?Re.fire.call(xe,xt,he,Ye):je.type==="add"||he===void 0?(H=Ue.fire.call(xe,xt,je.values[Dt],Ye),xt==null&&H!=null&&(je.keys[Dt]=xt=H,J.outbound||I(je.values[Dt],J.keyPath,xt))):(H=Ii(he,je.values[Dt]),(F=qe.fire.call(xe,H,xt,he,Ye))&&(ie=je.values[Dt],Object.keys(F).forEach(function(Se){p(ie,Se)?ie[Se]=F[Se]:I(ie,Se,F[Se])}))),xe});return L.mutate(je).then(function(xt){for(var Dt=xt.failures,H=xt.results,F=xt.numFailures,xt=xt.lastResult,ie=0;ie<Qe.length;++ie){var he=(H||Qe)[ie],xe=ft[ie];he==null?xe.onerror&&xe.onerror(Dt[ie]):xe.onsuccess&&xe.onsuccess(je.type==="put"&&st[ie]?je.values[ie]:he)}return{failures:Dt,results:H,numFailures:F,lastResult:xt}}).catch(function(xt){return ft.forEach(function(Dt){return Dt.onerror&&Dt.onerror(xt)}),Promise.reject(xt)})})}}})}})}};function jn(_,T,L){try{if(!T||T.keys.length<_.length)return null;for(var J=[],re=0,le=0;re<T.keys.length&&le<_.length;++re)bt(T.keys[re],_[le])===0&&(J.push(L?N(T.values[re]):T.values[re]),++le);return J.length===_.length?J:null}catch{return null}}var Hl={stack:"dbcore",level:-1,create:function(_){return{table:function(T){var L=_.table(T);return n(n({},L),{getMany:function(J){if(!J.cache)return L.getMany(J);var re=jn(J.keys,J.trans._cache,J.cache==="clone");return re?Ft.resolve(re):L.getMany(J).then(function(le){return J.trans._cache={keys:J.keys,values:J.cache==="clone"?N(le):le},le})},mutate:function(J){return J.type!=="add"&&(J.trans._cache=null),L.mutate(J)}})}}}};function gs(_,T){return _.trans.mode==="readonly"&&!!_.subscr&&!_.trans.explicit&&_.trans.db._options.cache!=="disabled"&&!T.schema.primaryKey.outbound}function zl(_,T){switch(_){case"query":return T.values&&!T.unique;case"get":case"getMany":case"count":case"openCursor":return!1}}var Gc={stack:"dbcore",level:0,name:"Observability",create:function(_){var T=_.schema.name,L=new zr(_.MIN_KEY,_.MAX_KEY);return n(n({},_),{transaction:function(J,re,le){if(mt.subscr&&re!=="readonly")throw new ke.ReadOnly("Readwrite transaction in liveQuery context. Querier source: ".concat(mt.querier));return _.transaction(J,re,le)},table:function(J){var re=_.table(J),le=re.schema,_e=le.primaryKey,je=le.indexes,Re=_e.extractKey,Ue=_e.outbound,qe=_e.autoIncrement&&je.filter(function(Fe){return Fe.compound&&Fe.keyPath.includes(_e.keyPath)}),We=n(n({},re),{mutate:function(Fe){function Ve(Se){return Se="idb://".concat(T,"/").concat(J,"/").concat(Se),xt[Se]||(xt[Se]=new zr)}var Ye,Qe,st,ft=Fe.trans,xt=Fe.mutatedParts||(Fe.mutatedParts={}),Dt=Ve(""),H=Ve(":dels"),F=Fe.type,xe=Fe.type==="deleteRange"?[Fe.range]:Fe.type==="delete"?[Fe.keys]:Fe.values.length<50?[Zs(_e,Fe).filter(function(Se){return Se}),Fe.values]:[],ie=xe[0],he=xe[1],xe=Fe.trans._cache;return u(ie)?(Dt.addKeys(ie),(xe=F==="delete"||ie.length===he.length?jn(ie,xe):null)||H.addKeys(ie),(xe||he)&&(Ye=Ve,Qe=xe,st=he,le.indexes.forEach(function(Se){var Ne=Ye(Se.name||"");function Pe(It){return It!=null?Se.extractKey(It):null}function lt(It){return Se.multiEntry&&u(It)?It.forEach(function(Vt){return Ne.addKey(Vt)}):Ne.addKey(It)}(Qe||st).forEach(function(It,En){var Gt=Qe&&Pe(Qe[En]),En=st&&Pe(st[En]);bt(Gt,En)!==0&&(Gt!=null&&lt(Gt),En!=null&&lt(En))})}))):ie?(he={from:(he=ie.lower)!==null&&he!==void 0?he:_.MIN_KEY,to:(he=ie.upper)!==null&&he!==void 0?he:_.MAX_KEY},H.add(he),Dt.add(he)):(Dt.add(L),H.add(L),le.indexes.forEach(function(Se){return Ve(Se.name).add(L)})),re.mutate(Fe).then(function(Se){return!ie||Fe.type!=="add"&&Fe.type!=="put"||(Dt.addKeys(Se.results),qe&&qe.forEach(function(Ne){for(var Pe=Fe.values.map(function(Gt){return Ne.extractKey(Gt)}),lt=Ne.keyPath.findIndex(function(Gt){return Gt===_e.keyPath}),It=0,Vt=Se.results.length;It<Vt;++It)Pe[It][lt]=Se.results[It];Ve(Ne.name).addKeys(Pe)})),ft.mutatedParts=Yi(ft.mutatedParts||{},xt),Se})}}),je=function(Ve){var Ye=Ve.query,Ve=Ye.index,Ye=Ye.range;return[Ve,new zr((Ve=Ye.lower)!==null&&Ve!==void 0?Ve:_.MIN_KEY,(Ye=Ye.upper)!==null&&Ye!==void 0?Ye:_.MAX_KEY)]},Ze={get:function(Fe){return[_e,new zr(Fe.key)]},getMany:function(Fe){return[_e,new zr().addKeys(Fe.keys)]},count:je,query:je,openCursor:je};return l(Ze).forEach(function(Fe){We[Fe]=function(Ve){var Ye=mt.subscr,Qe=!!Ye,st=gs(mt,re)&&zl(Fe,Ve)?Ve.obsSet={}:Ye;if(Qe){var ft=function(he){return he="idb://".concat(T,"/").concat(J,"/").concat(he),st[he]||(st[he]=new zr)},xt=ft(""),Dt=ft(":dels"),Ye=Ze[Fe](Ve),Qe=Ye[0],Ye=Ye[1];if((Fe==="query"&&Qe.isPrimaryKey&&!Ve.values?Dt:ft(Qe.name||"")).add(Ye),!Qe.isPrimaryKey){if(Fe!=="count"){var H=Fe==="query"&&Ue&&Ve.values&&re.query(n(n({},Ve),{values:!1}));return re[Fe].apply(this,arguments).then(function(he){if(Fe==="query"){if(Ue&&Ve.values)return H.then(function(Pe){return Pe=Pe.result,xt.addKeys(Pe),he});var xe=Ve.values?he.result.map(Re):he.result;(Ve.values?xt:Dt).addKeys(xe)}else if(Fe==="openCursor"){var Se=he,Ne=Ve.values;return Se&&Object.create(Se,{key:{get:function(){return Dt.addKey(Se.primaryKey),Se.key}},primaryKey:{get:function(){var Pe=Se.primaryKey;return Dt.addKey(Pe),Pe}},value:{get:function(){return Ne&&xt.addKey(Se.primaryKey),Se.value}}})}return he})}Dt.add(L)}}return re[Fe].apply(this,arguments)}}),We}})}};function Gl(_,T,L){if(L.numFailures===0)return T;if(T.type==="deleteRange")return null;var J=T.keys?T.keys.length:"values"in T&&T.values?T.values.length:1;return L.numFailures===J?null:(T=n({},T),u(T.keys)&&(T.keys=T.keys.filter(function(re,le){return!(le in L.failures)})),"values"in T&&u(T.values)&&(T.values=T.values.filter(function(re,le){return!(le in L.failures)})),T)}function Zo(_,T){return L=_,((J=T).lower===void 0||(J.lowerOpen?0<bt(L,J.lower):0<=bt(L,J.lower)))&&(_=_,(T=T).upper===void 0||(T.upperOpen?bt(_,T.upper)<0:bt(_,T.upper)<=0));var L,J}function el(_,T,Ze,J,re,le){if(!Ze||Ze.length===0)return _;var _e=T.query.index,Re=_e.multiEntry,Ue=T.query.range,qe=J.schema.primaryKey.extractKey,We=_e.extractKey,je=(_e.lowLevelIndex||_e).extractKey,Ze=Ze.reduce(function(Fe,Ve){var Ye=Fe,Qe=[];if(Ve.type==="add"||Ve.type==="put")for(var st=new zr,ft=Ve.values.length-1;0<=ft;--ft){var xt,Dt=Ve.values[ft],H=qe(Dt);st.hasKey(H)||(xt=We(Dt),(Re&&u(xt)?xt.some(function(Se){return Zo(Se,Ue)}):Zo(xt,Ue))&&(st.addKey(H),Qe.push(Dt)))}switch(Ve.type){case"add":var F=new zr().addKeys(T.values?Fe.map(function(Ne){return qe(Ne)}):Fe),Ye=Fe.concat(T.values?Qe.filter(function(Ne){return Ne=qe(Ne),!F.hasKey(Ne)&&(F.addKey(Ne),!0)}):Qe.map(function(Ne){return qe(Ne)}).filter(function(Ne){return!F.hasKey(Ne)&&(F.addKey(Ne),!0)}));break;case"put":var ie=new zr().addKeys(Ve.values.map(function(Ne){return qe(Ne)}));Ye=Fe.filter(function(Ne){return!ie.hasKey(T.values?qe(Ne):Ne)}).concat(T.values?Qe:Qe.map(function(Ne){return qe(Ne)}));break;case"delete":var he=new zr().addKeys(Ve.keys);Ye=Fe.filter(function(Ne){return!he.hasKey(T.values?qe(Ne):Ne)});break;case"deleteRange":var xe=Ve.range;Ye=Fe.filter(function(Ne){return!Zo(qe(Ne),xe)})}return Ye},_);return Ze===_?_:(Ze.sort(function(Fe,Ve){return bt(je(Fe),je(Ve))||bt(qe(Fe),qe(Ve))}),T.limit&&T.limit<1/0&&(Ze.length>T.limit?Ze.length=T.limit:_.length===T.limit&&Ze.length<T.limit&&(re.dirty=!0)),le?Object.freeze(Ze):Ze)}function Is(_,T){return bt(_.lower,T.lower)===0&&bt(_.upper,T.upper)===0&&!!_.lowerOpen==!!T.lowerOpen&&!!_.upperOpen==!!T.upperOpen}function Xs(_,T){return(function(L,J,re,le){if(L===void 0)return J!==void 0?-1:0;if(J===void 0)return 1;if((J=bt(L,J))===0){if(re&&le)return 0;if(re)return 1;if(le)return-1}return J})(_.lower,T.lower,_.lowerOpen,T.lowerOpen)<=0&&0<=(function(L,J,re,le){if(L===void 0)return J!==void 0?1:0;if(J===void 0)return-1;if((J=bt(L,J))===0){if(re&&le)return 0;if(re)return-1;if(le)return 1}return J})(_.upper,T.upper,_.upperOpen,T.upperOpen)}function Kc(_,T,L,J){_.subscribers.add(L),J.addEventListener("abort",function(){var re,le;_.subscribers.delete(L),_.subscribers.size===0&&(re=_,le=T,setTimeout(function(){re.subscribers.size===0&&B(le,re)},3e3))})}var Xo={stack:"dbcore",level:0,name:"Cache",create:function(_){var T=_.schema.name;return n(n({},_),{transaction:function(L,J,re){var le,_e,Re=_.transaction(L,J,re);return J==="readwrite"&&(_e=(le=new AbortController).signal,re=function(Ue){return function(){if(le.abort(),J==="readwrite"){for(var qe=new Set,We=0,je=L;We<je.length;We++){var Ze=je[We],Fe=ps["idb://".concat(T,"/").concat(Ze)];if(Fe){var Ve=_.table(Ze),Ye=Fe.optimisticOps.filter(function(Ne){return Ne.trans===Re});if(Re._explicit&&Ue&&Re.mutatedParts)for(var Qe=0,st=Object.values(Fe.queries.query);Qe<st.length;Qe++)for(var ft=0,xt=(F=st[Qe]).slice();ft<xt.length;ft++)Qa((ie=xt[ft]).obsSet,Re.mutatedParts)&&(B(F,ie),ie.subscribers.forEach(function(Ne){return qe.add(Ne)}));else if(0<Ye.length){Fe.optimisticOps=Fe.optimisticOps.filter(function(Ne){return Ne.trans!==Re});for(var Dt=0,H=Object.values(Fe.queries.query);Dt<H.length;Dt++)for(var F,ie,he,xe=0,Se=(F=H[Dt]).slice();xe<Se.length;xe++)(ie=Se[xe]).res!=null&&Re.mutatedParts&&(Ue&&!ie.dirty?(he=Object.isFrozen(ie.res),he=el(ie.res,ie.req,Ye,Ve,ie,he),ie.dirty?(B(F,ie),ie.subscribers.forEach(function(Ne){return qe.add(Ne)})):he!==ie.res&&(ie.res=he,ie.promise=Ft.resolve({result:he}))):(ie.dirty&&B(F,ie),ie.subscribers.forEach(function(Ne){return qe.add(Ne)})))}}}qe.forEach(function(Ne){return Ne()})}}},Re.addEventListener("abort",re(!1),{signal:_e}),Re.addEventListener("error",re(!1),{signal:_e}),Re.addEventListener("complete",re(!0),{signal:_e})),Re},table:function(L){var J=_.table(L),re=J.schema.primaryKey;return n(n({},J),{mutate:function(le){var _e=mt.trans;if(re.outbound||_e.db._options.cache==="disabled"||_e.explicit||_e.idbtrans.mode!=="readwrite")return J.mutate(le);var Re=ps["idb://".concat(T,"/").concat(L)];return Re?(_e=J.mutate(le),le.type!=="add"&&le.type!=="put"||!(50<=le.values.length||Zs(re,le).some(function(Ue){return Ue==null}))?(Re.optimisticOps.push(le),le.mutatedParts&&Jo(le.mutatedParts),_e.then(function(Ue){0<Ue.numFailures&&(B(Re.optimisticOps,le),(Ue=Gl(0,le,Ue))&&Re.optimisticOps.push(Ue),le.mutatedParts&&Jo(le.mutatedParts))}),_e.catch(function(){B(Re.optimisticOps,le),le.mutatedParts&&Jo(le.mutatedParts)})):_e.then(function(Ue){var qe=Gl(0,n(n({},le),{values:le.values.map(function(We,je){var Ze;return Ue.failures[je]?We:(We=(Ze=re.keyPath)!==null&&Ze!==void 0&&Ze.includes(".")?N(We):n({},We),I(We,re.keyPath,Ue.results[je]),We)})}),Ue);Re.optimisticOps.push(qe),queueMicrotask(function(){return le.mutatedParts&&Jo(le.mutatedParts)})}),_e):J.mutate(le)},query:function(le){if(!gs(mt,J)||!zl("query",le))return J.query(le);var _e=((qe=mt.trans)===null||qe===void 0?void 0:qe.db._options.cache)==="immutable",je=mt,Re=je.requery,Ue=je.signal,qe=(function(Ve,Ye,Qe,st){var ft=ps["idb://".concat(Ve,"/").concat(Ye)];if(!ft)return[];if(!(Ye=ft.queries[Qe]))return[null,!1,ft,null];var xt=Ye[(st.query?st.query.index.name:null)||""];if(!xt)return[null,!1,ft,null];switch(Qe){case"query":var Dt=xt.find(function(H){return H.req.limit===st.limit&&H.req.values===st.values&&Is(H.req.query.range,st.query.range)});return Dt?[Dt,!0,ft,xt]:[xt.find(function(H){return("limit"in H.req?H.req.limit:1/0)>=st.limit&&(!st.values||H.req.values)&&Xs(H.req.query.range,st.query.range)}),!1,ft,xt];case"count":return Dt=xt.find(function(H){return Is(H.req.query.range,st.query.range)}),[Dt,!!Dt,ft,xt]}})(T,L,"query",le),We=qe[0],je=qe[1],Ze=qe[2],Fe=qe[3];return We&&je?We.obsSet=le.obsSet:(je=J.query(le).then(function(Ve){var Ye=Ve.result;if(We&&(We.res=Ye),_e){for(var Qe=0,st=Ye.length;Qe<st;++Qe)Object.freeze(Ye[Qe]);Object.freeze(Ye)}else Ve.result=N(Ye);return Ve}).catch(function(Ve){return Fe&&We&&B(Fe,We),Promise.reject(Ve)}),We={obsSet:le.obsSet,promise:je,subscribers:new Set,type:"query",req:le,dirty:!1},Fe?Fe.push(We):(Fe=[We],(Ze=Ze||(ps["idb://".concat(T,"/").concat(L)]={queries:{query:{},count:{}},objs:new Map,optimisticOps:[],unsignaledParts:{}})).queries.query[le.query.index.name||""]=Fe)),Kc(We,Fe,Re,Ue),We.promise.then(function(Ve){return{result:el(Ve.result,le,Ze?.optimisticOps,J,We,_e)}})}})}})}};function eo(_,T){return new Proxy(_,{get:function(L,J,re){return J==="db"?T:Reflect.get(L,J,re)}})}var Ri=(mr.prototype.version=function(_){if(isNaN(_)||_<.1)throw new ke.Type("Given version is not a positive number");if(_=Math.round(10*_)/10,this.idbdb||this._state.isBeingOpened)throw new ke.Schema("Cannot add version when database is open");this.verno=Math.max(this.verno,_);var T=this._versions,L=T.filter(function(J){return J._cfg.version===_})[0];return L||(L=new this.Version(_),T.push(L),T.sort(za),L.stores({}),this._state.autoSchema=!1,L)},mr.prototype._whenReady=function(_){var T=this;return this.idbdb&&(this._state.openComplete||mt.letThrough||this._vip)?_():new Ft(function(L,J){if(T._state.openComplete)return J(new ke.DatabaseClosed(T._state.dbOpenError));if(!T._state.isBeingOpened){if(!T._state.autoOpen)return void J(new ke.DatabaseClosed);T.open().catch(Ce)}T._state.dbReadyPromise.then(L,J)}).then(_)},mr.prototype.use=function(_){var T=_.stack,L=_.create,J=_.level,re=_.name;return re&&this.unuse({stack:T,name:re}),_=this._middlewares[T]||(this._middlewares[T]=[]),_.push({stack:T,create:L,level:J??10,name:re}),_.sort(function(le,_e){return le.level-_e.level}),this},mr.prototype.unuse=function(_){var T=_.stack,L=_.name,J=_.create;return T&&this._middlewares[T]&&(this._middlewares[T]=this._middlewares[T].filter(function(re){return J?re.create!==J:!!L&&re.name!==L})),this},mr.prototype.open=function(){var _=this;return sn(zt,function(){return Hc(_)})},mr.prototype._close=function(){this.on.close.fire(new CustomEvent("close"));var _=this._state,T=Xt.indexOf(this);if(0<=T&&Xt.splice(T,1),this.idbdb){try{this.idbdb.close()}catch{}this.idbdb=null}_.isBeingOpened||(_.dbReadyPromise=new Ft(function(L){_.dbReadyResolve=L}),_.openCanceller=new Ft(function(L,J){_.cancelOpen=J}))},mr.prototype.close=function(L){var T=(L===void 0?{disableAutoOpen:!0}:L).disableAutoOpen,L=this._state;T?(L.isBeingOpened&&L.cancelOpen(new ke.DatabaseClosed),this._close(),L.autoOpen=!1,L.dbOpenError=new ke.DatabaseClosed):(this._close(),L.autoOpen=this._options.autoOpen||L.isBeingOpened,L.openComplete=!1,L.dbOpenError=null)},mr.prototype.delete=function(_){var T=this;_===void 0&&(_={disableAutoOpen:!0});var L=0<arguments.length&&typeof arguments[0]!="object",J=this._state;return new Ft(function(re,le){function _e(){T.close(_);var Re=T._deps.indexedDB.deleteDatabase(T.name);Re.onsuccess=At(function(){var Ue,qe,We;Ue=T._deps,qe=T.name,We=Ue.indexedDB,Ue=Ue.IDBKeyRange,Yo(We)||qe===ln||Va(We,Ue).delete(qe).catch(Ce),re()}),Re.onerror=_i(le),Re.onblocked=T._fireOnBlocked}if(L)throw new ke.InvalidArgument("Invalid closeOptions argument to db.delete()");J.isBeingOpened?J.dbReadyPromise.then(_e):_e()})},mr.prototype.backendDB=function(){return this.idbdb},mr.prototype.isOpen=function(){return this.idbdb!==null},mr.prototype.hasBeenClosed=function(){var _=this._state.dbOpenError;return _&&_.name==="DatabaseClosed"},mr.prototype.hasFailed=function(){return this._state.dbOpenError!==null},mr.prototype.dynamicallyOpened=function(){return this._state.autoSchema},Object.defineProperty(mr.prototype,"tables",{get:function(){var _=this;return l(this._allTables).map(function(T){return _._allTables[T]})},enumerable:!1,configurable:!0}),mr.prototype.transaction=function(){var _=(function(T,L,J){var re=arguments.length;if(re<2)throw new ke.InvalidArgument("Too few arguments");for(var le=new Array(re-1);--re;)le[re-1]=arguments[re];return J=le.pop(),[T,G(le),J]}).apply(this,arguments);return this._transaction.apply(this,_)},mr.prototype._transaction=function(_,T,L){var J=this,re=mt.trans;re&&re.db===this&&_.indexOf("!")===-1||(re=null);var le,_e,Re=_.indexOf("?")!==-1;_=_.replace("!","").replace("?","");try{if(_e=T.map(function(qe){if(qe=qe instanceof J.Table?qe.name:qe,typeof qe!="string")throw new TypeError("Invalid table argument to Dexie.transaction(). Only Table or String are allowed");return qe}),_=="r"||_===Wt)le=Wt;else{if(_!="rw"&&_!=en)throw new ke.InvalidArgument("Invalid transaction mode: "+_);le=en}if(re){if(re.mode===Wt&&le===en){if(!Re)throw new ke.SubTransaction("Cannot enter a sub-transaction with READWRITE mode when parent transaction is READONLY");re=null}re&&_e.forEach(function(qe){if(re&&re.storeNames.indexOf(qe)===-1){if(!Re)throw new ke.SubTransaction("Table "+qe+" not included in parent transaction.");re=null}}),Re&&re&&!re.active&&(re=null)}}catch(qe){return re?re._promise(null,function(We,je){je(qe)}):tn(qe)}var Ue=(function qe(We,je,Ze,Fe,Ve){return Ft.resolve().then(function(){var Ye=mt.transless||mt,Qe=We._createTransaction(je,Ze,We._dbSchema,Fe);if(Qe.explicit=!0,Ye={trans:Qe,transless:Ye},Fe)Qe.idbtrans=Fe.idbtrans;else try{Qe.create(),Qe.idbtrans._explicit=!0,We._state.PR1398_maxLoop=3}catch(xt){return xt.name===Te.InvalidState&&We.isOpen()&&0<--We._state.PR1398_maxLoop?(console.warn("Dexie: Need to reopen db"),We.close({disableAutoOpen:!1}),We.open().then(function(){return qe(We,je,Ze,null,Ve)})):tn(xt)}var st,ft=V(Ve);return ft&&vt(),Ye=Ft.follow(function(){var xt;(st=Ve.call(Qe,Qe))&&(ft?(xt=Nt.bind(null,null),st.then(xt,xt)):typeof st.next=="function"&&typeof st.throw=="function"&&(st=Js(st)))},Ye),(st&&typeof st.then=="function"?Ft.resolve(st).then(function(xt){return Qe.active?xt:tn(new ke.PrematureCommit("Transaction committed too early. See http://bit.ly/2kdckMn"))}):Ye.then(function(){return st})).then(function(xt){return Fe&&Qe._resolve(),Qe._completion.then(function(){return xt})}).catch(function(xt){return Qe._reject(xt),tn(xt)})})}).bind(null,this,le,_e,re,L);return re?re._promise(le,Ue,"lock"):mt.trans?sn(mt.transless,function(){return J._whenReady(Ue)}):this._whenReady(Ue)},mr.prototype.table=function(_){if(!p(this._allTables,_))throw new ke.InvalidTable("Table ".concat(_," does not exist"));return this._allTables[_]},mr);function mr(_,T){var L=this;this._middlewares={},this.verno=0;var J=mr.dependencies;this._options=T=n({addons:mr.addons,autoOpen:!0,indexedDB:J.indexedDB,IDBKeyRange:J.IDBKeyRange,cache:"cloned"},T),this._deps={indexedDB:T.indexedDB,IDBKeyRange:T.IDBKeyRange},J=T.addons,this._dbSchema={},this._versions=[],this._storeNames=[],this._allTables={},this.idbdb=null,this._novip=this;var re,le,_e,Re,Ue,qe={dbOpenError:null,isBeingOpened:!1,onReadyBeingFired:null,openComplete:!1,dbReadyResolve:Ce,dbReadyPromise:null,cancelOpen:Ce,openCanceller:null,autoSchema:!0,PR1398_maxLoop:3,autoOpen:T.autoOpen};qe.dbReadyPromise=new Ft(function(je){qe.dbReadyResolve=je}),qe.openCanceller=new Ft(function(je,Ze){qe.cancelOpen=Ze}),this._state=qe,this.name=_,this.on=Tn(this,"populate","blocked","versionchange","close",{ready:[at,Ce]}),this.once=function(je,Ze){var Fe=function(){for(var Ve=[],Ye=0;Ye<arguments.length;Ye++)Ve[Ye]=arguments[Ye];L.on(je).unsubscribe(Fe),Ze.apply(L,Ve)};return L.on(je,Fe)},this.on.ready.subscribe=x(this.on.ready.subscribe,function(je){return function(Ze,Fe){mr.vip(function(){var Ve,Ye=L._state;Ye.openComplete?(Ye.dbOpenError||Ft.resolve().then(Ze),Fe&&je(Ze)):Ye.onReadyBeingFired?(Ye.onReadyBeingFired.push(Ze),Fe&&je(Ze)):(je(Ze),Ve=L,Fe||je(function Qe(){Ve.on.ready.unsubscribe(Ze),Ve.on.ready.unsubscribe(Qe)}))})}}),this.Collection=(re=this,_n(cr.prototype,function(st,Qe){this.db=re;var Fe=Jt,Ve=null;if(Qe)try{Fe=Qe()}catch(ft){Ve=ft}var Ye=st._ctx,Qe=Ye.table,st=Qe.hook.reading.fire;this._ctx={table:Qe,index:Ye.index,isPrimKey:!Ye.index||Qe.schema.primKey.keyPath&&Ye.index===Qe.schema.primKey.name,range:Fe,keysOnly:!1,dir:"next",unique:"",algorithm:null,filter:null,replayFilter:null,justLimit:!0,isMatch:null,offset:0,limit:1/0,error:Ve,or:Ye.or,valueMapper:st!==ot?st:null}})),this.Table=(le=this,_n(kn.prototype,function(je,Ze,Fe){this.db=le,this._tx=Fe,this.name=je,this.schema=Ze,this.hook=le._allTables[je]?le._allTables[je].hook:Tn(null,{creating:[de,Ce],reading:[et,ot],updating:[Je,Ce],deleting:[Be,Ce]})})),this.Transaction=(_e=this,_n(Fo.prototype,function(je,Ze,Fe,Ve,Ye){var Qe=this;je!=="readonly"&&Ze.forEach(function(st){st=(st=Fe[st])===null||st===void 0?void 0:st.yProps,st&&(Ze=Ze.concat(st.map(function(ft){return ft.updatesTable})))}),this.db=_e,this.mode=je,this.storeNames=Ze,this.schema=Fe,this.chromeTransactionDurability=Ve,this.idbtrans=null,this.on=Tn(this,"complete","error","abort"),this.parent=Ye||null,this.active=!0,this._reculock=0,this._blockedFuncs=[],this._resolve=null,this._reject=null,this._waitingFor=null,this._waitingQueue=null,this._spinCount=0,this._completion=new Ft(function(st,ft){Qe._resolve=st,Qe._reject=ft}),this._completion.then(function(){Qe.active=!1,Qe.on.complete.fire()},function(st){var ft=Qe.active;return Qe.active=!1,Qe.on.error.fire(st),Qe.parent?Qe.parent._reject(st):ft&&Qe.idbtrans&&Qe.idbtrans.abort(),tn(st)})})),this.Version=(Re=this,_n(Fc.prototype,function(je){this.db=Re,this._cfg={version:je,storesSource:null,dbschema:{},tables:{},contentUpgrade:null}})),this.WhereClause=(Ue=this,_n(as.prototype,function(je,Ze,Fe){if(this.db=Ue,this._ctx={table:je,index:Ze===":id"?null:Ze,or:Fe},this._cmp=this._ascending=bt,this._descending=function(Ve,Ye){return bt(Ye,Ve)},this._max=function(Ve,Ye){return 0<bt(Ve,Ye)?Ve:Ye},this._min=function(Ve,Ye){return bt(Ve,Ye)<0?Ve:Ye},this._IDBKeyRange=Ue._deps.IDBKeyRange,!this._IDBKeyRange)throw new ke.MissingAPI})),this.on("versionchange",function(je){0<je.newVersion?console.warn("Another connection wants to upgrade database '".concat(L.name,"'. Closing db now to resume the upgrade.")):console.warn("Another connection wants to delete database '".concat(L.name,"'. Closing db now to resume the delete request.")),L.close({disableAutoOpen:!1})}),this.on("blocked",function(je){!je.newVersion||je.newVersion<je.oldVersion?console.warn("Dexie.delete('".concat(L.name,"') was blocked")):console.warn("Upgrade '".concat(L.name,"' blocked by other connection holding version ").concat(je.oldVersion/10))}),this._maxKey=us(T.IDBKeyRange),this._createTransaction=function(je,Ze,Fe,Ve){return new L.Transaction(je,Ze,Fe,L._options.chromeTransactionDurability,Ve)},this._fireOnBlocked=function(je){L.on("blocked").fire(je),Xt.filter(function(Ze){return Ze.name===L.name&&Ze!==L&&!Ze._state.vcFired}).map(function(Ze){return Ze.on("versionchange").fire(je)})},this.use(Hl),this.use(Xo),this.use(Gc),this.use(zc),this.use(Fl);var We=new Proxy(this,{get:function(je,Ze,Fe){if(Ze==="_vip")return!0;if(Ze==="table")return function(Ye){return eo(L.table(Ye),We)};var Ve=Reflect.get(je,Ze,Fe);return Ve instanceof kn?eo(Ve,We):Ze==="tables"?Ve.map(function(Ye){return eo(Ye,We)}):Ze==="_createTransaction"?function(){return eo(Ve.apply(this,arguments),We)}:Ve}});this.vip=We,J.forEach(function(je){return je(L)})}var Rs,ri=typeof Symbol<"u"&&"observable"in Symbol?Symbol.observable:"@@observable",Kl=(ea.prototype.subscribe=function(_,T,L){return this._subscribe(_&&typeof _!="function"?_:{next:_,error:T,complete:L})},ea.prototype[ri]=function(){return this},ea);function ea(_){this._subscribe=_}try{Rs={indexedDB:a.indexedDB||a.mozIndexedDB||a.webkitIndexedDB||a.msIndexedDB,IDBKeyRange:a.IDBKeyRange||a.webkitIDBKeyRange}}catch{Rs={indexedDB:null,IDBKeyRange:null}}function Vl(_){var T,L=!1,J=new Kl(function(re){var le=V(_),_e,Re=!1,Ue={},qe={},We={get closed(){return Re},unsubscribe:function(){Re||(Re=!0,_e&&_e.abort(),je&&Sr.storagemutated.unsubscribe(Fe))}};re.start&&re.start(We);var je=!1,Ze=function(){return xn(Ve)},Fe=function(Ye){Yi(Ue,Ye),Qa(qe,Ue)&&Ze()},Ve=function(){var Ye,Qe,st;!Re&&Rs.indexedDB&&(Ue={},Ye={},_e&&_e.abort(),_e=new AbortController,st=(function(ft){var xt=qt();try{le&&vt();var Dt=ze(_,ft);return Dt=le?Dt.finally(Nt):Dt}finally{xt&&fe()}})(Qe={subscr:Ye,signal:_e.signal,requery:Ze,querier:_,trans:null}),Promise.resolve(st).then(function(ft){L=!0,T=ft,Re||Qe.signal.aborted||(Ue={},(function(xt){for(var Dt in xt)if(p(xt,Dt))return;return 1})(qe=Ye)||je||(Sr(Cs,Fe),je=!0),xn(function(){return!Re&&re.next&&re.next(ft)}))},function(ft){L=!1,["DatabaseClosedError","AbortError"].includes(ft?.name)||Re||xn(function(){Re||re.error&&re.error(ft)})}))};return setTimeout(Ze,0),We});return J.hasValue=function(){return L},J.getValue=function(){return T},J}var ms=Ri;function tl(_){var T=Wi;try{Wi=!0,Sr.storagemutated.fire(_),Xa(_,!0)}finally{Wi=T}}m(ms,n(n({},Ie),{delete:function(_){return new ms(_,{addons:[]}).delete()},exists:function(_){return new ms(_,{addons:[]}).open().then(function(T){return T.close(),!0}).catch("NoSuchDatabaseError",function(){return!1})},getDatabaseNames:function(_){try{return T=ms.dependencies,L=T.indexedDB,T=T.IDBKeyRange,(Yo(L)?Promise.resolve(L.databases()).then(function(J){return J.map(function(re){return re.name}).filter(function(re){return re!==ln})}):Va(L,T).toCollection().primaryKeys()).then(_)}catch{return tn(new ke.MissingAPI)}var T,L},defineClass:function(){return function(_){c(this,_)}},ignoreTransaction:function(_){return mt.trans?sn(mt.transless,_):_()},vip:$a,async:function(_){return function(){try{var T=Js(_.apply(this,arguments));return T&&typeof T.then=="function"?T:Ft.resolve(T)}catch(L){return tn(L)}}},spawn:function(_,T,L){try{var J=Js(_.apply(L,T||[]));return J&&typeof J.then=="function"?J:Ft.resolve(J)}catch(re){return tn(re)}},currentTransaction:{get:function(){return mt.trans||null}},waitFor:function(_,T){return T=Ft.resolve(typeof _=="function"?ms.ignoreTransaction(_):_).timeout(T||6e4),mt.trans?mt.trans.waitFor(T):T},Promise:Ft,debug:{get:function(){return ye},set:function(_){it(_)}},derive:y,extend:c,props:m,override:x,Events:Tn,on:Sr,liveQuery:Vl,extendObservabilitySet:Yi,getByKeyPath:R,setByKeyPath:I,delByKeyPath:function(_,T){typeof T=="string"?I(_,T,void 0):"length"in T&&[].map.call(T,function(L){I(_,L,void 0)})},shallowClone:U,deepClone:N,getObjectDiff:Ii,cmp:bt,asap:A,minKey:-1/0,addons:[],connections:Xt,errnames:Te,dependencies:Rs,cache:ps,semVer:"4.2.1",version:"4.2.1".split(".").map(function(_){return parseInt(_)}).reduce(function(_,T,L){return _+T/Math.pow(10,2*L)})})),ms.maxKey=us(ms.dependencies.IDBKeyRange),typeof dispatchEvent<"u"&&typeof addEventListener<"u"&&(Sr(Cs,function(_){Wi||(_=new CustomEvent(cs,{detail:_}),Wi=!0,dispatchEvent(_),Wi=!1)}),addEventListener(cs,function(_){_=_.detail,Wi||tl(_)}));var Os,Wi=!1,Jr=function(){};return typeof BroadcastChannel<"u"&&((Jr=function(){(Os=new BroadcastChannel(cs)).onmessage=function(_){return _.data&&tl(_.data)}})(),typeof Os.unref=="function"&&Os.unref(),Sr(Cs,function(_){Wi||Os.postMessage(_)})),typeof addEventListener<"u"&&(addEventListener("pagehide",function(_){if(!Ri.disableBfCache&&_.persisted){ye&&console.debug("Dexie: handling persisted pagehide"),Os?.close();for(var T=0,L=Xt;T<L.length;T++)L[T].close({disableAutoOpen:!1})}}),addEventListener("pageshow",function(_){!Ri.disableBfCache&&_.persisted&&(ye&&console.debug("Dexie: handling persisted pageshow"),Jr(),tl({all:new zr(-1/0,[[]])}))})),Ft.rejectionMapper=function(_,T){return!_||_ instanceof ae||_ instanceof TypeError||_ instanceof SyntaxError||!_.name||!Me[_.name]?_:(T=new Me[_.name](T||_.message,_),"stack"in _&&b(T,"stack",{get:function(){return this.inner.stack}}),T)},it(ye),n(Ri,Object.freeze({__proto__:null,Dexie:Ri,liveQuery:Vl,Entity:yt,cmp:bt,PropModification:pn,replacePrefix:function(_,T){return new pn({replacePrefix:[_,T]})},add:function(_){return new pn({add:_})},remove:function(_){return new pn({remove:_})},default:Ri,RangeSet:zr,mergeRanges:ds,rangesOverlap:Ul}),{default:Ri}),Ri})})(Qh)),Qh.exports}var zN=HN();const qy=Bc(zN),D2=Symbol.for("Dexie"),Mc=globalThis[D2]||(globalThis[D2]=qy);if(qy.semVer!==Mc.semVer)throw new Error(`Two different versions of Dexie loaded in the same app: ${qy.semVer} and ${Mc.semVer}`);const{liveQuery:Yj,mergeRanges:Wj,rangesOverlap:Qj,RangeSet:Jj,cmp:Zj,Entity:Xj,PropModification:eD,replacePrefix:tD,add:nD,remove:rD,DexieYProvider:iD}=Mc;class GN extends Mc{messages;contacts;invites;constructor(){super("AdunChatDB_v2"),this.version(1).stores({messages:"++msg_id, &msg_uuid, conversationId, from, timestamp, delivered, [conversationId+msg_id]",contacts:"userId, addedAt"}),this.version(2).stores({messages:"++msg_id, &msg_uuid, conversationId, from, [conversationId+msg_id]",invites:"inviteId"})}async addMessage(e){return await this.messages.put(e)}async getMessageByUuid(e){return await this.messages.where("msg_uuid").equals(e).first()}async getMessages(e){return await this.messages.where("conversationId").equals(e).sortBy("msg_id")}async getRecentMessages(e,t){return await this.messages.where("[conversationId+msg_id]").between([e,Mc.minKey],[e,Mc.maxKey]).reverse().limit(t).toArray().then(n=>n.reverse())}async getMessagesBefore(e,t,n){return await this.messages.where("[conversationId+msg_id]").between([e,0],[e,t],!0,!1).reverse().limit(n).toArray().then(s=>s.reverse())}async updateMessageDelivery(e,t,n=!1,s){const a={delivered:t,showAsFailedInUI:n};return s!==void 0&&(a.firstAttemptTimestamp=s),await this.messages.update(e,a)}async deleteConversation(e){return await this.messages.where("conversationId").equals(e).delete()}async deleteMessage(e){await this.messages.delete(e)}async clearAllMessages(){await this.messages.clear()}async getMessageCount(e){return await this.messages.where("conversationId").equals(e).count()}async searchMessages(e,t){const n=await this.getMessages(e),s=t.toLowerCase();return n.filter(a=>a.content.toLowerCase().includes(s))}async addContact(e){const t={userId:e.userId,publicKey:e.publicKey,addedAt:e.addedAt,status:"offline",byInviteId:e.byInviteId,peerProfile:e.peerProfile,localProfile:e.localProfile??{}};return await this.contacts.put(t)}async updateLocalProfile(e,t){return await this.contacts.update(e,{localProfile:t})}async updatePeerProfile(e,t){return await this.contacts.update(e,{peerProfile:t})}async getContacts(){return await this.contacts.toArray()}async getContact(e){return await this.contacts.get(e)}async updateContact(e,t){return await this.contacts.update(e,t)}async removeContact(e){await this.contacts.delete(e)}async clearAllContacts(){await this.contacts.clear()}async addInvite(e){return await this.invites.put(e)}async getInvite(e){return await this.invites.get(e)}async getInvites(){return await this.invites.toArray()}async getValidInvites(){return await this.invites.where("valid").equals(1).toArray()}async updateInvite(e,t){return await this.invites.update(e,t)}async incrementInviteUseCount(e){await this.invites.where("inviteId").equals(e).modify(t=>{t.useCount=(t.useCount||0)+1})}async invalidateInvite(e){return await this.invites.update(e,{valid:!1})}async deleteInvite(e){await this.invites.delete(e)}async clearAllInvites(){await this.invites.clear()}}const wr=new GN,KN=new Set;function VN(i,e){KN.forEach(t=>{try{t(i,e)}catch(n){console.error("[ContactStore] Error in status change callback:",n)}})}let o0=!1;const $N=()=>Wy()((i,e)=>({contacts:[],loaded:!1,loadContacts:async()=>{if(e().loaded){console.log("[ContactStore] Contacts already loaded, skipping");return}if(o0){console.log("[ContactStore] Load already in progress, skipping");return}o0=!0,console.log("[ContactStore] ========== LOADING CONTACTS FROM INDEXEDDB ==========");try{const t=await wr.getContacts();console.log("[ContactStore]  Loaded",t.length,"contacts from IndexedDB"),t.length>0&&t.forEach(a=>{console.log("[ContactStore]   - Contact:",a.userId.substring(0,8),"key:",a.publicKey.substring(0,16))}),i({contacts:t,loaded:!0}),console.log("[ContactStore]  Contacts loaded into store");let n=0;for(;!Ir.isReady()&&n<50;)await new Promise(a=>setTimeout(a,100)),n++;if(!Ir.isReady()){console.error("[ContactStore]  Transport not ready after 5 seconds");return}console.log("[ContactStore] Registering",t.length,"contacts with transport...");const s=os.getState().identity?.userId;for(const a of t)try{console.log("[ContactStore]  Adding peer to transport:",a.userId.substring(0,8));let l=!1;if(s){const u=[s,a.userId].sort().join("-"),c=await wr.getMessages(u),f=c.filter(d=>!d.delivered&&d.from===s);l=f.length>0,console.log("[ContactStore] Checking undelivered for:",a.userId.substring(0,8),"conversationId:",u.substring(0,16),"total:",c.length,"undelivered:",f.length)}else console.log("[ContactStore] No myUserId available for undelivered check");Ir.addPeer(a.userId,a.publicKey,l),console.log("[ContactStore]  Contact registered:",a.userId.substring(0,8),"hasUndelivered:",l)}catch(l){console.error("[ContactStore]  Failed to register contact:",a.userId.substring(0,8),l)}console.log("[ContactStore] ========== ALL CONTACTS REGISTERED ==========")}catch(t){console.error("[ContactStore]  Failed to load contacts from IndexedDB:",t),i({loaded:!0})}finally{o0=!1}},addContact:(t,n=!1)=>{const s=e();if(s.contacts.some(l=>l.userId===t.userId)){console.warn("Contact already exists:",t.userId);return}i({contacts:[...s.contacts,t]}),(async()=>{try{await wr.addContact(t),console.log("[ContactStore]  Contact saved to IndexedDB:",t.userId.substring(0,8));let l=0;for(;!Ir.isReady()&&l<50;)await new Promise(u=>setTimeout(u,100)),l++;if(!Ir.isReady()){console.error("[ContactStore] Transport not ready after 5 seconds for:",t.userId);return}console.log("[ContactStore] Registering contact with transport:",t.userId.substring(0,8)),Ir.addPeer(t.userId,t.publicKey,n),console.log("[ContactStore]  Contact registered:",t.userId.substring(0,8))}catch(l){console.error("[ContactStore] Failed to save/register contact:",l)}})()},updateContact:(t,n)=>i(s=>({contacts:s.contacts.map(a=>a.userId===t?{...a,...n}:a)})),updateLocalProfile:async(t,n)=>{i(s=>({contacts:s.contacts.map(a=>a.userId===t?{...a,localProfile:n}:a)}));try{await wr.updateLocalProfile(t,n),console.log("[ContactStore]  Local profile updated:",t.substring(0,8),n)}catch(s){throw console.error("[ContactStore] Failed to update local profile:",s),s}},updatePeerProfile:async(t,n)=>{i(s=>({contacts:s.contacts.map(a=>a.userId===t?{...a,peerProfile:n}:a)}));try{await wr.updatePeerProfile(t,n),console.log("[ContactStore]  Peer profile updated:",t.substring(0,8),n)}catch(s){throw console.error("[ContactStore] Failed to update peer profile:",s),s}},removeContact:t=>{i(n=>({contacts:n.contacts.filter(s=>s.userId!==t)})),wr.removeContact(t).catch(n=>{console.error("[ContactStore] Failed to remove contact from IndexedDB:",n)})},getContact:t=>e().contacts.find(n=>n.userId===t),getAllContacts:()=>e().contacts,setPeerStatus:(t,n,s)=>{e().contacts.some(l=>l.userId===t)||console.warn("[ContactStore] setPeerStatus: Contact not found:",t.substring(0,16),"(known:",e().contacts.length,")"),VN(t,n),i(l=>({contacts:l.contacts.map(u=>u.userId===t?{...u,status:n,sessionExpiry:s,handshakeStartedAt:n==="handshake"?u.handshakeStartedAt:void 0,lastSeen:n==="online"?Date.now():u.lastSeen,online:n==="online"}:u)}))},setHandshakeStarted:t=>i(n=>({contacts:n.contacts.map(s=>s.userId===t?{...s,status:"handshake",handshakeStartedAt:Date.now()}:s)})),clearHandshakeTimeout:t=>i(n=>({contacts:n.contacts.map(s=>s.userId===t?{...s,handshakeStartedAt:void 0}:s)})),retryHandshake:t=>{if(!e().getContact(t)){console.warn("[ContactStore] Cannot retry handshake: contact not found");return}i(s=>({contacts:s.contacts.map(a=>a.userId===t?{...a,status:"offline",handshakeStartedAt:void 0,sessionExpiry:void 0}:a)})),console.log("[ContactStore] Retry handshake requested for:",t),Ir.retryHandshake(t)},incrementUnread:t=>{i(s=>({contacts:s.contacts.map(a=>a.userId===t?{...a,unreadCount:Math.max(0,a.unreadCount||0)+1}:a)}));const n=e().getContact(t);n&&wr.updateContact(t,{unreadCount:n.unreadCount}).catch(s=>{console.error("[ContactStore] Failed to persist unreadCount:",s)})},clearUnread:t=>{i(n=>({contacts:n.contacts.map(s=>s.userId===t?{...s,unreadCount:0}:s)})),wr.updateContact(t,{unreadCount:0}).catch(n=>{console.error("[ContactStore] Failed to clear unreadCount:",n)})}})),mi=(()=>{const i="__contactStore__";return globalThis[i]||(globalThis[i]=$N()),globalThis[i]})(),P2=Object.freeze(Object.defineProperty({__proto__:null,useContactStore:mi},Symbol.toStringTag,{value:"Module"})),pk=()=>typeof window<"u"&&window.__TEST_MODE__===!0,YN=()=>pk()?3e3:15e3,WN=()=>pk()?5e3:3e4,QN=1440*60*1e3;class JN{messageHandlers=new Set;peerOnlineHandlers=new Set;initializedUserId=null;currentIdentity=null;transports=new Map;pendingOutboundPeers=new Map;handshakeRetryTimer=null;signalingManager=new vN;handshakeCoordinator=new DN(WN(),QN);updatePeerStatus(e,t){console.log(`[TransportManager] DataTransport status update: ${e.substring(0,8)} -> ${t}`);const n=t==="online"?"online":t==="connecting"?"connecting":"offline";mi.getState().setPeerStatus(e,n),t==="online"?(this.pendingOutboundPeers.delete(e)&&console.log("[TransportManager] Removed from pendingOutboundPeers (now online):",e.substring(0,8)),console.log("[TransportManager] Notifying",this.peerOnlineHandlers.size,"onPeerOnline handlers (online)"),this.peerOnlineHandlers.forEach(s=>s(e,!0))):t==="offline"&&(console.log("[TransportManager] Notifying",this.peerOnlineHandlers.size,"onPeerOnline handlers (offline)"),this.peerOnlineHandlers.forEach(s=>s(e,!1)))}reportPeerError(e,t){const n=this.transports.get(e);if(t instanceof dk)console.log("[TransportManager] Initiating reconnection due to error:",t.name),this.addPendingConnection(n,!1);else if(t instanceof Yh||t instanceof Wh){const s=n.isConnected;console.log("[TransportManager] Initiating handshake due to error:",t.name,"handshakeOnly:",s),this.addPendingConnection(n,s)}else t instanceof Ly||(t instanceof Uy?(n.clearSessionAndConnection(),console.log("[TransportManager] Initiating handshake due to error:",t.name),this.addPendingConnection(n,!1)):console.log(`[TransportManager] Other error from ${e}:`,t))}onWireMessage(e,t){console.log("[TransportManager]  Message via P2P from:",e.substring(0,8)),this.messageHandlers.forEach(n=>n(e,t))}sendCustomSignal(e,t){this.signalingManager.sendCustomSignal(e,{type:"dt-signal",data:t}).catch(n=>{console.error("[TransportManager] Failed to send custom signal:",n)})}async initialize(e,t){const n=e.userId;if(this.initializedUserId===n&&this.signalingManager.isInitializedForUser(n)){console.log("[TransportManager] Already initialized for this user, skipping");return}this.initializedUserId&&this.initializedUserId!==n&&(console.log("[TransportManager] Switching users, cleaning up old transports"),this.cleanupTransports());try{await this.signalingManager.initialize(n,t),this.signalingManager.onCustomSignal((s,a)=>{this.handleIncomingSignal(s,a)}),this.signalingManager.onHandshakeMessage((s,a)=>{this.handshakeCoordinator.handleHandshakeMessage(s,a)}),this.handshakeCoordinator.initialize({userId:e.userId,publicKey:e.publicKey,secretKey:e.secretKey}),this.handshakeCoordinator.setSignalSender((s,a)=>this.signalingManager.sendHandshakeMessage(s,a)),this.handshakeCoordinator.setOnHandshakeComplete((s,a,l)=>{this.handleHandshakeComplete(s,a,l)}),this.handshakeCoordinator.setOnHandshakeStatus((s,a)=>{this.handleHandshakeStatus(s,a)}),this.handshakeCoordinator.setGetPeerPublicKey(s=>this.transports.get(s)?.identityPK||null),this.handshakeCoordinator.setGetInviteCallback((s,a)=>this.getInviteForHandshake(s,a)),this.handshakeCoordinator.setMarkInviteUsedCallback(s=>this.markInviteUsed(s)),this.handshakeCoordinator.setCreateContactFromInviteCallback((s,a,l,u)=>this.createContactFromInvite(s,a,l,u)),this.handshakeCoordinator.setOnInviteRejectedCallback((s,a)=>{console.log("[TransportManager] Invite rejected by:",s.substring(0,8),"reason:",a)}),this.initializedUserId=n,this.currentIdentity=e,console.log("[TransportManager]  Initialized for user:",n.substring(0,8))}catch(s){throw console.error("[TransportManager] Initialization failed:",s),this.initializedUserId=null,this.currentIdentity=null,new Error("Failed to initialize transport.")}}async reloadSignaling(e){if(!this.currentIdentity)throw new Error("Not initialized");console.log("[TransportManager] Reloading signaling with new settings..."),this.signalingManager.destroy();const t=Wu(e);await this.signalingManager.initialize(this.currentIdentity.userId,t),this.signalingManager.onCustomSignal((n,s)=>{this.handleIncomingSignal(n,s)}),this.signalingManager.onHandshakeMessage((n,s)=>{this.handshakeCoordinator.handleHandshakeMessage(n,s)}),console.log("[TransportManager]  Signaling reloaded")}addPeer(e,t,n=!1){let s=this.transports.get(e);s||(s=this.createTransport(e,t)),console.log("[TransportManager]  Peer added:",e.substring(0,8),"hasUndelivered:",n),n&&this.addPendingConnection(s)}addPendingConnection(e,t=!1){const n=e.peerId;this.startHandshakeRetryTimer(),t&&this.pendingOutboundPeers.get(n)!=="connection"?this.pendingOutboundPeers.set(n,"handshake"):(this.pendingOutboundPeers.set(n,"connection"),t=!1),this.retryPendingConnection(e,t)}retryPendingConnection(e,t){if(!t&&e.isSessionValid){this.initiatePoliteConnection(e);return}this._startPendingHandshake(e)}_startPendingHandshake(e){const t=e.peerId;console.log("[TransportManager] Retry handshake for pending peer:",t.substring(0,8)),this.handshakeCoordinator.initiateHandshakeIfNotRunning(t,e.identityPK)}async sendMessage(e,t){console.log("[TransportManager] ========== SEND MESSAGE =========="),console.log("[TransportManager] To:",e.substring(0,8)),console.log("[TransportManager] Message ID:",t.id);const n=this.transports.get(e);if(!n)throw console.error("[TransportManager]  No DataTransport for peer"),new Error("No transport available");try{console.log("[TransportManager]  Sending via P2P..."),await n.sendMessage(t),console.log("[TransportManager]  Sent via P2P");return}catch(s){throw console.warn("[TransportManager]  P2P send failed:",s),this.reportPeerError(e,s),s}}getTransport(e){return this.transports.get(e)}onMessage(e){return this.messageHandlers.add(e),()=>this.messageHandlers.delete(e)}onPeerOnline(e){return this.peerOnlineHandlers.add(e),()=>this.peerOnlineHandlers.delete(e)}isReady(){return this.initializedUserId!==null}getConnectionStatus(e){return this.transports.get(e)?.isConnected?"connected":"disconnected"}getActiveSignalingServices(){return this.signalingManager.getActiveServices()}retryHandshake(e){const t=this.transports.get(e);if(!t){console.error("[TransportManager] Cannot retry handshake - no transport for:",e.substring(0,8));return}this.addPendingConnection(t)}removePeer(e){console.log("[TransportManager] Removing peer:",e.substring(0,8)),this.pendingOutboundPeers.delete(e);const t=this.transports.get(e);t&&(t.destroy(),this.transports.delete(e)),this.peerOnlineHandlers.forEach(n=>n(e,!1)),this.handshakeCoordinator.cancelHandshake(e),console.log("[TransportManager] Peer removed:",e.substring(0,8))}destroy(){console.log("[TransportManager] Component unmount - nothing destroyed (persistence)")}destroyAll(){console.log("[TransportManager] Destroying all (identity deleted)"),this.cleanupTransports(),this.signalingManager.destroy(),this.initializedUserId=null}createTransport(e,t){const n=new qN(e,t,this);return this.transports.set(e,n),console.log("[TransportManager] Created DataTransport for:",e.substring(0,8)),n}handleIncomingSignal(e,t){const n=this.transports.get(e);if(n)console.log("[TransportManager] Received signal:",t.type,"from:",e.substring(0,8));else{console.warn("[TransportManager] Received signal:",t.type,"from unknown peer:",e.substring(0,8));return}if(t.type==="pull-connection"){console.log("[TransportManager] Initiating connection after pull-connection:",e.substring(0,8)),this.addPendingConnection(n);return}if(t.type==="dt-signal"){try{n.handleEncryptedSignal(t.data)}catch(s){console.error("[TransportManager] Failed to handle signal:",s),this.reportPeerError(e,s)}return}console.log("[TransportManager] Unknown signal type:",t.type)}handleHandshakeComplete(e,t,n){const s=this.transports.get(e);if(!s){console.error("[TransportManager] Peer not found for handshake:",e);return}s.setSession(t,n)}initiatePoliteConnection(e){if(this.initializedUserId>e.peerId){if(console.log("[TransportManager] We are impolite, initiating connection"),e.isSessionValid)return e.initiateConnection().catch(n=>{console.error("[TransportManager] Failed to initiate connection:",n)}),!0;console.log("[TransportManager] No valid session available, skipping connection initiation")}else console.log("[TransportManager] We are polite, sending pull-connection"),this.signalingManager.sendCustomSignal(e.peerId,{type:"pull-connection",data:""}).catch(n=>{console.error("[TransportManager] Failed to send pull-connection:",n)});return!1}handleHandshakeStatus(e,t){const n=this.pendingOutboundPeers.has(e);switch(console.log("[TransportManager] ========== HANDSHAKE STATUS =========="),console.log("[TransportManager] Peer:",e.substring(0,8),"initiatedByUs:",n),t){case"started":const s=mi.getState().getContact(e);(!s||s.status==="offline")&&mi.getState().setPeerStatus(e,"handshake");break;case"complete":if(this.pendingOutboundPeers.get(e)==="connection"){const l=this.transports.get(e);if(l){this.initiatePoliteConnection(l);return}}this.pendingOutboundPeers.delete(e),mi.getState().setPeerStatus(e,"offline");break;case"failed":case"timeout":mi.getState().getContact(e)?.status==="handshake"&&mi.getState().setPeerStatus(e,"offline");break}}startHandshakeRetryTimer(){if(this.handshakeRetryTimer)return;const e=YN();console.log("[TransportManager] Starting handshake retry timer, interval:",e,"ms"),this.handshakeRetryTimer=setInterval(()=>{this.retryPendingHandshakes()},e)}retryPendingHandshakes(){for(const[e,t]of this.pendingOutboundPeers){const n=this.transports.get(e);n?this.retryPendingConnection(n,t==="handshake"):this.pendingOutboundPeers.delete(e)}this.pendingOutboundPeers.size===0&&this.handshakeRetryTimer&&(console.log("[TransportManager] No pending peers, stopping retry timer"),clearInterval(this.handshakeRetryTimer),this.handshakeRetryTimer=null)}async initiateInviteHandshake(e){if(!this.currentIdentity)throw new Error("Transport not initialized");console.log("[TransportManager] Initiating invite handshake to:",e.invitingId.substring(0,8)),await this.handshakeCoordinator.initiateFromPSI(e)}async getInviteForHandshake(e,t){const n=mi.getState().getContact(t);return n?(console.log("[TransportManager] Peer is existing contact:",t.substring(0,8)),n.publicKey):await wr.getInvite(e)}async markInviteUsed(e){console.log("[TransportManager] Incrementing invite use count:",e),await wr.incrementInviteUseCount(e)}async createContactFromInvite(e,t,n,s){if(!Dy(e,t)){console.error("[TransportManager] Invalid peer: userId does not match publicKey:",e.substring(0,8));return}if(mi.getState().getContact(e)){console.log("[TransportManager] Contact already exists:",e.substring(0,8));return}let l;if(n){const c=await wr.getInvite(n);c?.name&&(l=c.name)}const u={userId:e,publicKey:t,addedAt:Date.now(),status:"offline",byInviteId:n||void 0,displayName:l,localProfile:{}};if(n){const c=await wr.getInvite(n);c?.name&&(c.useLimit===1?u.localProfile.name=c.name:u.localProfile.group=c.name)}console.log("[TransportManager] Creating contact from invite:",e.substring(0,8),"isInvitedParty:",s),mi.getState().addContact(u)}cleanupTransports(){this.handshakeRetryTimer&&(clearInterval(this.handshakeRetryTimer),this.handshakeRetryTimer=null),this.pendingOutboundPeers.clear(),this.transports.forEach(e=>e.destroy()),this.transports.clear(),this.handshakeCoordinator.destroy(),this.messageHandlers.clear(),this.peerOnlineHandlers.clear(),this.initializedUserId=null,this.currentIdentity=null}}const ZN=()=>{const i="__transportManager__";return globalThis[i]||(globalThis[i]=new JN),globalThis[i]},Ir=ZN();function XN(){const{setIdentity:i,setActiveView:e}=os(),[t,n]=jt.useState(!1),[s,a]=jt.useState(null),l=()=>{try{const c=hd.generate().export();El.save(c),i(c),e("contacts")}catch(c){a("Failed to generate identity. Please try again."),console.error(c)}},u=async c=>{const f=c.target.files?.[0];if(f)try{const d=await f.text(),p=El.importFromJSON(d);El.save(p),i(p),e("contacts")}catch(d){a("Invalid identity file. Please check and try again."),console.error(d)}};return P.jsxs("div",{className:"min-h-screen bg-[var(--color-bg-dark)] flex items-center justify-center p-4 animate-fade-in relative overflow-hidden",children:[P.jsxs("div",{className:"absolute top-0 left-0 w-full h-full overflow-hidden z-0 pointer-events-none",children:[P.jsx("div",{className:"absolute -top-[20%] -left-[10%] w-[50%] h-[50%] bg-indigo-500/10 rounded-full blur-[100px]"}),P.jsx("div",{className:"absolute top-[20%] -right-[10%] w-[40%] h-[40%] bg-purple-500/10 rounded-full blur-[100px]"}),P.jsx("div",{className:"absolute -bottom-[10%] left-[20%] w-[60%] h-[60%] bg-blue-500/10 rounded-full blur-[100px]"})]}),P.jsxs("div",{className:"max-w-md w-full relative z-10",children:[P.jsxs("div",{className:"bg-[var(--color-bg-card)] backdrop-blur-xl border border-slate-700/50 rounded-3xl shadow-2xl p-8 md:p-10",children:[P.jsxs("div",{className:"text-center mb-10",children:[P.jsx("div",{className:"w-20 h-20 bg-gradient-to-br from-indigo-500 to-purple-600 rounded-2xl flex items-center justify-center mx-auto mb-6 shadow-lg shadow-indigo-500/30 transform rotate-3 hover:rotate-0 transition-transform duration-300",children:P.jsx("svg",{className:"w-10 h-10 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:P.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"})})}),P.jsx("h1",{className:"text-4xl font-bold text-white mb-3 tracking-tight",children:"Private Chat"}),P.jsx("p",{className:"text-slate-400 text-lg",children:"Secure, encrypted peer-to-peer messaging"})]}),s&&P.jsxs("div",{className:"mb-8 p-4 bg-red-500/10 border border-red-500/20 rounded-xl flex items-start space-x-3",children:[P.jsx("svg",{className:"w-5 h-5 text-red-400 mt-0.5 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:P.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),P.jsx("p",{className:"text-sm text-red-200",children:s})]}),P.jsx("div",{className:"space-y-5",children:t?P.jsxs("div",{className:"animate-fade-in",children:[P.jsxs("div",{className:"border-2 border-dashed border-slate-700 hover:border-indigo-500/50 rounded-2xl p-8 text-center transition-colors group cursor-pointer bg-slate-900/30",children:[P.jsx("input",{type:"file",accept:".json",onChange:u,className:"hidden",id:"identity-import"}),P.jsxs("label",{htmlFor:"identity-import",className:"cursor-pointer flex flex-col items-center w-full h-full",children:[P.jsx("div",{className:"w-16 h-16 bg-slate-800 rounded-full flex items-center justify-center mb-4 group-hover:scale-110 transition-transform duration-300",children:P.jsx("svg",{className:"w-8 h-8 text-slate-400 group-hover:text-indigo-400 transition-colors",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:P.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"})})}),P.jsx("span",{className:"text-base font-medium text-slate-200 group-hover:text-white transition-colors",children:"Click to select identity file"}),P.jsx("span",{className:"text-sm text-slate-500 mt-2",children:"JSON file only"})]})]}),P.jsx("button",{onClick:()=>{n(!1),a(null)},className:"w-full mt-4 bg-transparent text-slate-400 font-medium py-3 px-4 rounded-xl hover:text-white hover:bg-slate-800/50 transition-all duration-200",children:"Cancel"})]}):P.jsxs(P.Fragment,{children:[P.jsxs("button",{onClick:l,className:"w-full group relative overflow-hidden bg-indigo-600 hover:bg-indigo-500 text-white font-semibold py-4 px-6 rounded-xl transition-all duration-300 shadow-lg shadow-indigo-500/25 hover:shadow-indigo-500/40 hover:-translate-y-0.5",children:[P.jsx("div",{className:"absolute inset-0 w-full h-full bg-gradient-to-r from-transparent via-white/10 to-transparent -translate-x-full group-hover:animate-shimmer"}),P.jsxs("span",{className:"relative flex items-center justify-center gap-2",children:[P.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:P.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),"Generate New Identity"]})]}),P.jsx("button",{onClick:()=>n(!0),className:"w-full bg-slate-800/50 hover:bg-slate-800 text-slate-300 font-semibold py-4 px-6 rounded-xl border border-slate-700 hover:border-slate-600 transition-all duration-300 hover:-translate-y-0.5",children:"Import Existing Identity"})]})}),P.jsx("div",{className:"mt-10 pt-8 border-t border-slate-700/50",children:P.jsxs("div",{className:"space-y-4",children:[P.jsx(a0,{icon:P.jsx("svg",{className:"w-5 h-5 text-emerald-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:P.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"})}),text:"End-to-end encrypted messages"}),P.jsx(a0,{icon:P.jsx("svg",{className:"w-5 h-5 text-amber-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:P.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 7a2 2 0 012 2m4 0a6 6 0 01-7.743 5.743L11.536 19.464a3 3 0 01-.879.879l-4.243 1.061a1 1 0 01-1.213-1.213l1.061-4.243a3 3 0 01.879-.879l7.536-7.536A6 6 0 0120 8zm-4 7a2 2 0 00-2-2"})}),text:"Your keys never leave your device"}),P.jsx(a0,{icon:P.jsx("svg",{className:"w-5 h-5 text-blue-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:P.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 12a9 9 0 01-9 9m9-9a9 9 0 00-9-9m9 9H3m9 9a9 9 0 01-9-9m9 9c1.657 0 3-4.03 3-9s-1.343-9-3-9m0 18c-1.657 0-3-4.03-3-9s1.343-9 3-9m-9 9a9 9 0 019-9"})}),text:"Works without central servers"})]})})]}),P.jsx("p",{className:"text-center text-xs text-slate-500 mt-8 font-medium tracking-wide uppercase opacity-60",children:"No account required  Fully open source"})]})]})}function a0({icon:i,text:e}){return P.jsxs("div",{className:"flex items-center space-x-4 p-3 rounded-xl hover:bg-slate-800/30 transition-colors",children:[P.jsx("div",{className:"flex-shrink-0 bg-slate-800/50 p-2 rounded-lg",children:i}),P.jsx("span",{className:"text-sm text-slate-300 font-medium",children:e})]})}const Ic=Wy((i,e)=>({messages:{},addMessage:(t,n)=>i(s=>{const a=s.messages[t]||[];return a.some(l=>l.msg_uuid===n.msg_uuid)?s:{messages:{...s.messages,[t]:[...a,n]}}}),prependMessages:(t,n)=>i(s=>{const a=s.messages[t]||[],l=new Set(a.map(c=>c.msg_uuid)),u=n.filter(c=>!l.has(c.msg_uuid));return u.length===0?s:{messages:{...s.messages,[t]:[...u,...a]}}}),updateMessageDelivery:(t,n,s=!1,a)=>i(l=>{const u={...l.messages};for(const c in u){const f=u[c],d=f.findIndex(p=>p.msg_id===t);if(d!==-1){const p={...f[d],delivered:n,showAsFailedInUI:s};a!==void 0&&(p.firstAttemptTimestamp=a),u[c]=[...f.slice(0,d),p,...f.slice(d+1)];break}}return{messages:u}}),getMessage:t=>{const n=e();for(const s in n.messages){const a=n.messages[s].find(l=>l.msg_uuid===t);if(a)return a}},getMessages:t=>e().messages[t]||[],getUndeliveredMessages:t=>{const n=e(),s=[];for(const a in n.messages)if(a.includes(t)){const u=n.messages[a].filter(c=>!c.delivered&&c.from!==t);s.push(...u)}return s.sort((a,l)=>(a.msg_id??0)-(l.msg_id??0))},setMessages:(t,n)=>i(s=>({messages:{...s.messages,[t]:n}})),deleteMessage:t=>i(n=>{const s={...n.messages};for(const a in s)s[a]=s[a].filter(l=>l.msg_id!==t);return{messages:s}}),clearMessages:t=>i(n=>{const{[t]:s,...a}=n.messages;return{messages:a}}),clearAllMessages:()=>i({messages:{}})}));var eB=Object.defineProperty,dd=Object.getOwnPropertySymbols,gk=Object.prototype.hasOwnProperty,mk=Object.prototype.propertyIsEnumerable,L2=(i,e,t)=>e in i?eB(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t,Fy=(i,e)=>{for(var t in e||(e={}))gk.call(e,t)&&L2(i,t,e[t]);if(dd)for(var t of dd(e))mk.call(e,t)&&L2(i,t,e[t]);return i},Hy=(i,e)=>{var t={};for(var n in i)gk.call(i,n)&&e.indexOf(n)<0&&(t[n]=i[n]);if(i!=null&&dd)for(var n of dd(i))e.indexOf(n)<0&&mk.call(i,n)&&(t[n]=i[n]);return t};var Ml;(i=>{const e=class zn{constructor(c,f,d,p){if(this.version=c,this.errorCorrectionLevel=f,this.modules=[],this.isFunction=[],c<zn.MIN_VERSION||c>zn.MAX_VERSION)throw new RangeError("Version value out of range");if(p<-1||p>7)throw new RangeError("Mask value out of range");this.size=c*4+17;let m=[];for(let b=0;b<this.size;b++)m.push(!1);for(let b=0;b<this.size;b++)this.modules.push(m.slice()),this.isFunction.push(m.slice());this.drawFunctionPatterns();const v=this.addEccAndInterleave(d);if(this.drawCodewords(v),p==-1){let b=1e9;for(let y=0;y<8;y++){this.applyMask(y),this.drawFormatBits(y);const w=this.getPenaltyScore();w<b&&(p=y,b=w),this.applyMask(y)}}s(0<=p&&p<=7),this.mask=p,this.applyMask(p),this.drawFormatBits(p),this.isFunction=[]}static encodeText(c,f){const d=i.QrSegment.makeSegments(c);return zn.encodeSegments(d,f)}static encodeBinary(c,f){const d=i.QrSegment.makeBytes(c);return zn.encodeSegments([d],f)}static encodeSegments(c,f,d=1,p=40,m=-1,v=!0){if(!(zn.MIN_VERSION<=d&&d<=p&&p<=zn.MAX_VERSION)||m<-1||m>7)throw new RangeError("Invalid value");let b,y;for(b=d;;b++){const x=zn.getNumDataCodewords(b,f)*8,k=l.getTotalBits(c,b);if(k<=x){y=k;break}if(b>=p)throw new RangeError("Data too long")}for(const x of[zn.Ecc.MEDIUM,zn.Ecc.QUARTILE,zn.Ecc.HIGH])v&&y<=zn.getNumDataCodewords(b,x)*8&&(f=x);let w=[];for(const x of c){t(x.mode.modeBits,4,w),t(x.numChars,x.mode.numCharCountBits(b),w);for(const k of x.getData())w.push(k)}s(w.length==y);const C=zn.getNumDataCodewords(b,f)*8;s(w.length<=C),t(0,Math.min(4,C-w.length),w),t(0,(8-w.length%8)%8,w),s(w.length%8==0);for(let x=236;w.length<C;x^=253)t(x,8,w);let S=[];for(;S.length*8<w.length;)S.push(0);return w.forEach((x,k)=>S[k>>>3]|=x<<7-(k&7)),new zn(b,f,S,m)}getModule(c,f){return 0<=c&&c<this.size&&0<=f&&f<this.size&&this.modules[f][c]}getModules(){return this.modules}drawFunctionPatterns(){for(let d=0;d<this.size;d++)this.setFunctionModule(6,d,d%2==0),this.setFunctionModule(d,6,d%2==0);this.drawFinderPattern(3,3),this.drawFinderPattern(this.size-4,3),this.drawFinderPattern(3,this.size-4);const c=this.getAlignmentPatternPositions(),f=c.length;for(let d=0;d<f;d++)for(let p=0;p<f;p++)d==0&&p==0||d==0&&p==f-1||d==f-1&&p==0||this.drawAlignmentPattern(c[d],c[p]);this.drawFormatBits(0),this.drawVersion()}drawFormatBits(c){const f=this.errorCorrectionLevel.formatBits<<3|c;let d=f;for(let m=0;m<10;m++)d=d<<1^(d>>>9)*1335;const p=(f<<10|d)^21522;s(p>>>15==0);for(let m=0;m<=5;m++)this.setFunctionModule(8,m,n(p,m));this.setFunctionModule(8,7,n(p,6)),this.setFunctionModule(8,8,n(p,7)),this.setFunctionModule(7,8,n(p,8));for(let m=9;m<15;m++)this.setFunctionModule(14-m,8,n(p,m));for(let m=0;m<8;m++)this.setFunctionModule(this.size-1-m,8,n(p,m));for(let m=8;m<15;m++)this.setFunctionModule(8,this.size-15+m,n(p,m));this.setFunctionModule(8,this.size-8,!0)}drawVersion(){if(this.version<7)return;let c=this.version;for(let d=0;d<12;d++)c=c<<1^(c>>>11)*7973;const f=this.version<<12|c;s(f>>>18==0);for(let d=0;d<18;d++){const p=n(f,d),m=this.size-11+d%3,v=Math.floor(d/3);this.setFunctionModule(m,v,p),this.setFunctionModule(v,m,p)}}drawFinderPattern(c,f){for(let d=-4;d<=4;d++)for(let p=-4;p<=4;p++){const m=Math.max(Math.abs(p),Math.abs(d)),v=c+p,b=f+d;0<=v&&v<this.size&&0<=b&&b<this.size&&this.setFunctionModule(v,b,m!=2&&m!=4)}}drawAlignmentPattern(c,f){for(let d=-2;d<=2;d++)for(let p=-2;p<=2;p++)this.setFunctionModule(c+p,f+d,Math.max(Math.abs(p),Math.abs(d))!=1)}setFunctionModule(c,f,d){this.modules[f][c]=d,this.isFunction[f][c]=!0}addEccAndInterleave(c){const f=this.version,d=this.errorCorrectionLevel;if(c.length!=zn.getNumDataCodewords(f,d))throw new RangeError("Invalid argument");const p=zn.NUM_ERROR_CORRECTION_BLOCKS[d.ordinal][f],m=zn.ECC_CODEWORDS_PER_BLOCK[d.ordinal][f],v=Math.floor(zn.getNumRawDataModules(f)/8),b=p-v%p,y=Math.floor(v/p);let w=[];const C=zn.reedSolomonComputeDivisor(m);for(let x=0,k=0;x<p;x++){let A=c.slice(k,k+y-m+(x<b?0:1));k+=A.length;const R=zn.reedSolomonComputeRemainder(A,C);x<b&&A.push(0),w.push(A.concat(R))}let S=[];for(let x=0;x<w[0].length;x++)w.forEach((k,A)=>{(x!=y-m||A>=b)&&S.push(k[x])});return s(S.length==v),S}drawCodewords(c){if(c.length!=Math.floor(zn.getNumRawDataModules(this.version)/8))throw new RangeError("Invalid argument");let f=0;for(let d=this.size-1;d>=1;d-=2){d==6&&(d=5);for(let p=0;p<this.size;p++)for(let m=0;m<2;m++){const v=d-m,y=(d+1&2)==0?this.size-1-p:p;!this.isFunction[y][v]&&f<c.length*8&&(this.modules[y][v]=n(c[f>>>3],7-(f&7)),f++)}}s(f==c.length*8)}applyMask(c){if(c<0||c>7)throw new RangeError("Mask value out of range");for(let f=0;f<this.size;f++)for(let d=0;d<this.size;d++){let p;switch(c){case 0:p=(d+f)%2==0;break;case 1:p=f%2==0;break;case 2:p=d%3==0;break;case 3:p=(d+f)%3==0;break;case 4:p=(Math.floor(d/3)+Math.floor(f/2))%2==0;break;case 5:p=d*f%2+d*f%3==0;break;case 6:p=(d*f%2+d*f%3)%2==0;break;case 7:p=((d+f)%2+d*f%3)%2==0;break;default:throw new Error("Unreachable")}!this.isFunction[f][d]&&p&&(this.modules[f][d]=!this.modules[f][d])}}getPenaltyScore(){let c=0;for(let m=0;m<this.size;m++){let v=!1,b=0,y=[0,0,0,0,0,0,0];for(let w=0;w<this.size;w++)this.modules[m][w]==v?(b++,b==5?c+=zn.PENALTY_N1:b>5&&c++):(this.finderPenaltyAddHistory(b,y),v||(c+=this.finderPenaltyCountPatterns(y)*zn.PENALTY_N3),v=this.modules[m][w],b=1);c+=this.finderPenaltyTerminateAndCount(v,b,y)*zn.PENALTY_N3}for(let m=0;m<this.size;m++){let v=!1,b=0,y=[0,0,0,0,0,0,0];for(let w=0;w<this.size;w++)this.modules[w][m]==v?(b++,b==5?c+=zn.PENALTY_N1:b>5&&c++):(this.finderPenaltyAddHistory(b,y),v||(c+=this.finderPenaltyCountPatterns(y)*zn.PENALTY_N3),v=this.modules[w][m],b=1);c+=this.finderPenaltyTerminateAndCount(v,b,y)*zn.PENALTY_N3}for(let m=0;m<this.size-1;m++)for(let v=0;v<this.size-1;v++){const b=this.modules[m][v];b==this.modules[m][v+1]&&b==this.modules[m+1][v]&&b==this.modules[m+1][v+1]&&(c+=zn.PENALTY_N2)}let f=0;for(const m of this.modules)f=m.reduce((v,b)=>v+(b?1:0),f);const d=this.size*this.size,p=Math.ceil(Math.abs(f*20-d*10)/d)-1;return s(0<=p&&p<=9),c+=p*zn.PENALTY_N4,s(0<=c&&c<=2568888),c}getAlignmentPatternPositions(){if(this.version==1)return[];{const c=Math.floor(this.version/7)+2,f=this.version==32?26:Math.ceil((this.version*4+4)/(c*2-2))*2;let d=[6];for(let p=this.size-7;d.length<c;p-=f)d.splice(1,0,p);return d}}static getNumRawDataModules(c){if(c<zn.MIN_VERSION||c>zn.MAX_VERSION)throw new RangeError("Version number out of range");let f=(16*c+128)*c+64;if(c>=2){const d=Math.floor(c/7)+2;f-=(25*d-10)*d-55,c>=7&&(f-=36)}return s(208<=f&&f<=29648),f}static getNumDataCodewords(c,f){return Math.floor(zn.getNumRawDataModules(c)/8)-zn.ECC_CODEWORDS_PER_BLOCK[f.ordinal][c]*zn.NUM_ERROR_CORRECTION_BLOCKS[f.ordinal][c]}static reedSolomonComputeDivisor(c){if(c<1||c>255)throw new RangeError("Degree out of range");let f=[];for(let p=0;p<c-1;p++)f.push(0);f.push(1);let d=1;for(let p=0;p<c;p++){for(let m=0;m<f.length;m++)f[m]=zn.reedSolomonMultiply(f[m],d),m+1<f.length&&(f[m]^=f[m+1]);d=zn.reedSolomonMultiply(d,2)}return f}static reedSolomonComputeRemainder(c,f){let d=f.map(p=>0);for(const p of c){const m=p^d.shift();d.push(0),f.forEach((v,b)=>d[b]^=zn.reedSolomonMultiply(v,m))}return d}static reedSolomonMultiply(c,f){if(c>>>8||f>>>8)throw new RangeError("Byte out of range");let d=0;for(let p=7;p>=0;p--)d=d<<1^(d>>>7)*285,d^=(f>>>p&1)*c;return s(d>>>8==0),d}finderPenaltyCountPatterns(c){const f=c[1];s(f<=this.size*3);const d=f>0&&c[2]==f&&c[3]==f*3&&c[4]==f&&c[5]==f;return(d&&c[0]>=f*4&&c[6]>=f?1:0)+(d&&c[6]>=f*4&&c[0]>=f?1:0)}finderPenaltyTerminateAndCount(c,f,d){return c&&(this.finderPenaltyAddHistory(f,d),f=0),f+=this.size,this.finderPenaltyAddHistory(f,d),this.finderPenaltyCountPatterns(d)}finderPenaltyAddHistory(c,f){f[0]==0&&(c+=this.size),f.pop(),f.unshift(c)}};e.MIN_VERSION=1,e.MAX_VERSION=40,e.PENALTY_N1=3,e.PENALTY_N2=3,e.PENALTY_N3=40,e.PENALTY_N4=10,e.ECC_CODEWORDS_PER_BLOCK=[[-1,7,10,15,20,26,18,20,24,30,18,20,24,26,30,22,24,28,30,28,28,28,28,30,30,26,28,30,30,30,30,30,30,30,30,30,30,30,30,30,30],[-1,10,16,26,18,24,16,18,22,22,26,30,22,22,24,24,28,28,26,26,26,26,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28],[-1,13,22,18,26,18,24,18,22,20,24,28,26,24,20,30,24,28,28,26,30,28,30,30,30,30,28,30,30,30,30,30,30,30,30,30,30,30,30,30,30],[-1,17,28,22,16,22,28,26,26,24,28,24,28,22,24,24,30,28,28,26,28,30,24,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30]],e.NUM_ERROR_CORRECTION_BLOCKS=[[-1,1,1,1,1,1,2,2,2,2,4,4,4,4,4,6,6,6,6,7,8,8,9,9,10,12,12,12,13,14,15,16,17,18,19,19,20,21,22,24,25],[-1,1,1,1,2,2,4,4,4,5,5,5,8,9,9,10,10,11,13,14,16,17,17,18,20,21,23,25,26,28,29,31,33,35,37,38,40,43,45,47,49],[-1,1,1,2,2,4,4,6,6,8,8,8,10,12,16,12,17,16,18,21,20,23,23,25,27,29,34,34,35,38,40,43,45,48,51,53,56,59,62,65,68],[-1,1,1,2,4,4,4,5,6,8,8,11,11,16,16,18,16,19,21,25,25,25,34,30,32,35,37,40,42,45,48,51,54,57,60,63,66,70,74,77,81]],i.QrCode=e;function t(u,c,f){if(c<0||c>31||u>>>c)throw new RangeError("Value out of range");for(let d=c-1;d>=0;d--)f.push(u>>>d&1)}function n(u,c){return(u>>>c&1)!=0}function s(u){if(!u)throw new Error("Assertion error")}const a=class Ur{constructor(c,f,d){if(this.mode=c,this.numChars=f,this.bitData=d,f<0)throw new RangeError("Invalid argument");this.bitData=d.slice()}static makeBytes(c){let f=[];for(const d of c)t(d,8,f);return new Ur(Ur.Mode.BYTE,c.length,f)}static makeNumeric(c){if(!Ur.isNumeric(c))throw new RangeError("String contains non-numeric characters");let f=[];for(let d=0;d<c.length;){const p=Math.min(c.length-d,3);t(parseInt(c.substring(d,d+p),10),p*3+1,f),d+=p}return new Ur(Ur.Mode.NUMERIC,c.length,f)}static makeAlphanumeric(c){if(!Ur.isAlphanumeric(c))throw new RangeError("String contains unencodable characters in alphanumeric mode");let f=[],d;for(d=0;d+2<=c.length;d+=2){let p=Ur.ALPHANUMERIC_CHARSET.indexOf(c.charAt(d))*45;p+=Ur.ALPHANUMERIC_CHARSET.indexOf(c.charAt(d+1)),t(p,11,f)}return d<c.length&&t(Ur.ALPHANUMERIC_CHARSET.indexOf(c.charAt(d)),6,f),new Ur(Ur.Mode.ALPHANUMERIC,c.length,f)}static makeSegments(c){return c==""?[]:Ur.isNumeric(c)?[Ur.makeNumeric(c)]:Ur.isAlphanumeric(c)?[Ur.makeAlphanumeric(c)]:[Ur.makeBytes(Ur.toUtf8ByteArray(c))]}static makeEci(c){let f=[];if(c<0)throw new RangeError("ECI assignment value out of range");if(c<128)t(c,8,f);else if(c<16384)t(2,2,f),t(c,14,f);else if(c<1e6)t(6,3,f),t(c,21,f);else throw new RangeError("ECI assignment value out of range");return new Ur(Ur.Mode.ECI,0,f)}static isNumeric(c){return Ur.NUMERIC_REGEX.test(c)}static isAlphanumeric(c){return Ur.ALPHANUMERIC_REGEX.test(c)}getData(){return this.bitData.slice()}static getTotalBits(c,f){let d=0;for(const p of c){const m=p.mode.numCharCountBits(f);if(p.numChars>=1<<m)return 1/0;d+=4+m+p.bitData.length}return d}static toUtf8ByteArray(c){c=encodeURI(c);let f=[];for(let d=0;d<c.length;d++)c.charAt(d)!="%"?f.push(c.charCodeAt(d)):(f.push(parseInt(c.substring(d+1,d+3),16)),d+=2);return f}};a.NUMERIC_REGEX=/^[0-9]*$/,a.ALPHANUMERIC_REGEX=/^[A-Z0-9 $%*+.\/:-]*$/,a.ALPHANUMERIC_CHARSET="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ $%*+-./:";let l=a;i.QrSegment=a})(Ml||(Ml={}));(i=>{(e=>{const t=class{constructor(s,a){this.ordinal=s,this.formatBits=a}};t.LOW=new t(0,1),t.MEDIUM=new t(1,0),t.QUARTILE=new t(2,3),t.HIGH=new t(3,2),e.Ecc=t})(i.QrCode||(i.QrCode={}))})(Ml||(Ml={}));(i=>{(e=>{const t=class{constructor(s,a){this.modeBits=s,this.numBitsCharCount=a}numCharCountBits(s){return this.numBitsCharCount[Math.floor((s+7)/17)]}};t.NUMERIC=new t(1,[10,12,14]),t.ALPHANUMERIC=new t(2,[9,11,13]),t.BYTE=new t(4,[8,16,16]),t.KANJI=new t(8,[8,10,12]),t.ECI=new t(7,[0,0,0]),e.Mode=t})(i.QrSegment||(i.QrSegment={}))})(Ml||(Ml={}));var Ac=Ml;var tB={L:Ac.QrCode.Ecc.LOW,M:Ac.QrCode.Ecc.MEDIUM,Q:Ac.QrCode.Ecc.QUARTILE,H:Ac.QrCode.Ecc.HIGH},yk=128,bk="L",vk="#FFFFFF",wk="#000000",xk=!1,_k=1,nB=4,rB=0,iB=.1;function Sk(i,e=0){const t=[];return i.forEach(function(n,s){let a=null;n.forEach(function(l,u){if(!l&&a!==null){t.push(`M${a+e} ${s+e}h${u-a}v1H${a+e}z`),a=null;return}if(u===n.length-1){if(!l)return;a===null?t.push(`M${u+e},${s+e} h1v1H${u+e}z`):t.push(`M${a+e},${s+e} h${u+1-a}v1H${a+e}z`);return}l&&a===null&&(a=u)})}),t.join("")}function Ek(i,e){return i.slice().map((t,n)=>n<e.y||n>=e.y+e.h?t:t.map((s,a)=>a<e.x||a>=e.x+e.w?s:!1))}function sB(i,e,t,n){if(n==null)return null;const s=i.length+t*2,a=Math.floor(e*iB),l=s/e,u=(n.width||a)*l,c=(n.height||a)*l,f=n.x==null?i.length/2-u/2:n.x*l,d=n.y==null?i.length/2-c/2:n.y*l,p=n.opacity==null?1:n.opacity;let m=null;if(n.excavate){let b=Math.floor(f),y=Math.floor(d),w=Math.ceil(u+f-b),C=Math.ceil(c+d-y);m={x:b,y,w,h:C}}const v=n.crossOrigin;return{x:f,y:d,h:c,w:u,excavation:m,opacity:p,crossOrigin:v}}function oB(i,e){return e!=null?Math.max(Math.floor(e),0):i?nB:rB}function Ck({value:i,level:e,minVersion:t,includeMargin:n,marginSize:s,imageSettings:a,size:l,boostLevel:u}){let c=Or.useMemo(()=>{const b=(Array.isArray(i)?i:[i]).reduce((y,w)=>(y.push(...Ac.QrSegment.makeSegments(w)),y),[]);return Ac.QrCode.encodeSegments(b,tB[e],t,void 0,void 0,u)},[i,e,t,u]);const{cells:f,margin:d,numCells:p,calculatedImageSettings:m}=Or.useMemo(()=>{let v=c.getModules();const b=oB(n,s),y=v.length+b*2,w=sB(v,l,b,a);return{cells:v,margin:b,numCells:y,calculatedImageSettings:w}},[c,l,a,n,s]);return{qrcode:c,margin:d,cells:f,numCells:p,calculatedImageSettings:m}}var aB=(function(){try{new Path2D().addPath(new Path2D)}catch{return!1}return!0})(),lB=Or.forwardRef(function(e,t){const n=e,{value:s,size:a=yk,level:l=bk,bgColor:u=vk,fgColor:c=wk,includeMargin:f=xk,minVersion:d=_k,boostLevel:p,marginSize:m,imageSettings:v}=n,y=Hy(n,["value","size","level","bgColor","fgColor","includeMargin","minVersion","boostLevel","marginSize","imageSettings"]),{style:w}=y,C=Hy(y,["style"]),S=v?.src,x=Or.useRef(null),k=Or.useRef(null),A=Or.useCallback(Q=>{x.current=Q,typeof t=="function"?t(Q):t&&(t.current=Q)},[t]),[R,I]=Or.useState(!1),{margin:U,cells:te,numCells:G,calculatedImageSettings:Y}=Ck({value:s,level:l,minVersion:d,boostLevel:p,includeMargin:f,marginSize:m,imageSettings:v,size:a});Or.useEffect(()=>{if(x.current!=null){const Q=x.current,q=Q.getContext("2d");if(!q)return;let ee=te;const ne=k.current,B=Y!=null&&ne!==null&&ne.complete&&ne.naturalHeight!==0&&ne.naturalWidth!==0;B&&Y.excavation!=null&&(ee=Ek(te,Y.excavation));const z=window.devicePixelRatio||1;Q.height=Q.width=a*z;const $=a/G*z;q.scale($,$),q.fillStyle=u,q.fillRect(0,0,G,G),q.fillStyle=c,aB?q.fill(new Path2D(Sk(ee,U))):te.forEach(function(V,Z){V.forEach(function(ae,Ae){ae&&q.fillRect(Ae+U,Z+U,1,1)})}),Y&&(q.globalAlpha=Y.opacity),B&&q.drawImage(ne,Y.x+U,Y.y+U,Y.w,Y.h)}}),Or.useEffect(()=>{I(!1)},[S]);const O=Fy({height:a,width:a},w);let N=null;return S!=null&&(N=Or.createElement("img",{src:S,key:S,style:{display:"none"},onLoad:()=>{I(!0)},ref:k,crossOrigin:Y?.crossOrigin})),Or.createElement(Or.Fragment,null,Or.createElement("canvas",Fy({style:O,height:a,width:a,ref:A,role:"img"},C)),N)});lB.displayName="QRCodeCanvas";var Jh=Or.forwardRef(function(e,t){const n=e,{value:s,size:a=yk,level:l=bk,bgColor:u=vk,fgColor:c=wk,includeMargin:f=xk,minVersion:d=_k,boostLevel:p,title:m,marginSize:v,imageSettings:b}=n,y=Hy(n,["value","size","level","bgColor","fgColor","includeMargin","minVersion","boostLevel","title","marginSize","imageSettings"]),{margin:w,cells:C,numCells:S,calculatedImageSettings:x}=Ck({value:s,level:l,minVersion:d,boostLevel:p,includeMargin:f,marginSize:v,imageSettings:b,size:a});let k=C,A=null;b!=null&&x!=null&&(x.excavation!=null&&(k=Ek(C,x.excavation)),A=Or.createElement("image",{href:b.src,height:x.h,width:x.w,x:x.x+w,y:x.y+w,preserveAspectRatio:"none",opacity:x.opacity,crossOrigin:x.crossOrigin}));const R=Sk(k,w);return Or.createElement("svg",Fy({height:a,width:a,viewBox:`0 0 ${S} ${S}`,ref:t,role:"img"},y),!!m&&Or.createElement("title",null,m),Or.createElement("path",{fill:u,d:`M0,0 h${S}v${S}H0z`,shapeRendering:"crispEdges"}),Or.createElement("path",{fill:c,d:R,shapeRendering:"crispEdges"}),A)});Jh.displayName="QRCodeSVG";var Ak=i=>{throw TypeError(i)},kk=(i,e,t)=>e.has(i)||Ak("Cannot "+t),cB=(i,e,t)=>(kk(i,e,"read from private field"),t?t.call(i):e.get(i)),uB=(i,e,t)=>e.has(i)?Ak("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(i):e.set(i,t),fB=(i,e,t,n)=>(kk(i,e,"write to private field"),e.set(i,t),t);const Ld=[["Aztec","M"],["Codabar","L"],["Code39","L"],["Code93","L"],["Code128","L"],["DataBar","L"],["DataBarExpanded","L"],["DataMatrix","M"],["EAN-8","L"],["EAN-13","L"],["ITF","L"],["MaxiCode","M"],["PDF417","M"],["QRCode","M"],["UPC-A","L"],["UPC-E","L"],["MicroQRCode","M"],["rMQRCode","M"],["DXFilmEdge","L"],["DataBarLimited","L"]],Ud=Ld.map(([i])=>i),hB=Ud.filter((i,e)=>Ld[e][1]==="L"),dB=Ud.filter((i,e)=>Ld[e][1]==="M");function zy(i){switch(i){case"Linear-Codes":return hB.reduce((e,t)=>e|zy(t),0);case"Matrix-Codes":return dB.reduce((e,t)=>e|zy(t),0);case"Any":return(1<<Ld.length)-1;case"None":return 0;default:return 1<<Ud.indexOf(i)}}function pB(i){if(i===0)return"None";const e=31-Math.clz32(i);return Ud[e]}function gB(i){return i.reduce((e,t)=>e|zy(t),0)}const mB=["LocalAverage","GlobalHistogram","FixedThreshold","BoolCast"];function yB(i){return mB.indexOf(i)}const U2=["Unknown","ASCII","ISO8859_1","ISO8859_2","ISO8859_3","ISO8859_4","ISO8859_5","ISO8859_6","ISO8859_7","ISO8859_8","ISO8859_9","ISO8859_10","ISO8859_11","ISO8859_13","ISO8859_14","ISO8859_15","ISO8859_16","Cp437","Cp1250","Cp1251","Cp1252","Cp1256","Shift_JIS","Big5","GB2312","GB18030","EUC_JP","EUC_KR","UTF16BE","UTF16BE","UTF8","UTF16LE","UTF32BE","UTF32LE","BINARY"];function bB(i){return i==="UnicodeBig"?U2.indexOf("UTF16BE"):U2.indexOf(i)}const vB=["Text","Binary","Mixed","GS1","ISO15434","UnknownECI"];function wB(i){return vB[i]}const xB=["Ignore","Read","Require"];function _B(i){return xB.indexOf(i)}const SB=["Plain","ECI","HRI","Hex","Escaped"];function EB(i){return SB.indexOf(i)}const pd={formats:[],tryHarder:!0,tryRotate:!0,tryInvert:!0,tryDownscale:!0,tryDenoise:!1,binarizer:"LocalAverage",isPure:!1,downscaleFactor:3,downscaleThreshold:500,minLineCount:2,maxNumberOfSymbols:255,tryCode39ExtendedMode:!0,returnErrors:!1,eanAddOnSymbol:"Ignore",textMode:"HRI",characterSet:"Unknown"};function q2(i){return{...i,formats:gB(i.formats),binarizer:yB(i.binarizer),eanAddOnSymbol:_B(i.eanAddOnSymbol),textMode:EB(i.textMode),characterSet:bB(i.characterSet)}}function CB(i){return{...i,format:pB(i.format),contentType:wB(i.contentType),eccLevel:i.ecLevel}}const AB={locateFile:(i,e)=>{const t=i.match(/_(.+?)\.wasm$/);return t?`https://fastly.jsdelivr.net/npm/zxing-wasm@2.2.2/dist/${t[1]}/${i}`:e+i}},l0=new WeakMap;function kB(i,e){return Object.is(i,e)||Object.keys(i).length===Object.keys(e).length&&Object.keys(i).every(t=>Object.hasOwn(e,t)&&i[t]===e[t])}function Tk(i,{overrides:e,equalityFn:t=kB,fireImmediately:n=!1}={}){var s;const[a,l]=(s=l0.get(i))!=null?s:[AB],u=e??a;let c;if(n){if(l&&(c=t(a,u)))return l;const f=i({...u});return l0.set(i,[u,f]),f}(c??t(a,u))||l0.set(i,[u])}async function TB(i,e,t=pd){const n={...pd,...t},s=await Tk(i,{fireImmediately:!0});let a,l;if("width"in e&&"height"in e&&"data"in e){const{data:c,data:{byteLength:f},width:d,height:p}=e;l=s._malloc(f),s.HEAPU8.set(c,l),a=s.readBarcodesFromPixmap(l,d,p,q2(n))}else{let c,f;if("buffer"in e)[c,f]=[e.byteLength,e];else if("byteLength"in e)[c,f]=[e.byteLength,new Uint8Array(e)];else if("size"in e)[c,f]=[e.size,new Uint8Array(await e.arrayBuffer())];else throw new TypeError("Invalid input type");l=s._malloc(c),s.HEAPU8.set(f,l),a=s.readBarcodesFromImage(l,c,q2(n))}s._free(l);const u=[];for(let c=0;c<a.size();++c)u.push(CB(a.get(c)));return u}({...pd,formats:[...pd.formats]});var Mk=async function(i={}){var e,t,n=i,s,a,l=new Promise((H,F)=>{s=H,a=F}),u=typeof window=="object",c=typeof Bun<"u",f=typeof WorkerGlobalScope<"u";typeof process=="object"&&!((t=process.versions)===null||t===void 0)&&t.node&&process.type!="renderer";var d="./this.program",p,m="";function v(H){return n.locateFile?n.locateFile(H,m):m+H}var b,y;if(u||f||c){try{m=new URL(".",p).href}catch{}f&&(y=H=>{var F=new XMLHttpRequest;return F.open("GET",H,!1),F.responseType="arraybuffer",F.send(null),new Uint8Array(F.response)}),b=async H=>{var F=await fetch(H,{credentials:"same-origin"});if(F.ok)return F.arrayBuffer();throw new Error(F.status+" : "+F.url)}}var w=console.log.bind(console),C=console.error.bind(console),S,x,k=!1,A,R,I,U,te,G,Y,O;function N(){var H=x.buffer;A=new Int8Array(H),I=new Int16Array(H),n.HEAPU8=R=new Uint8Array(H),U=new Uint16Array(H),te=new Int32Array(H),G=new Uint32Array(H),Y=new Float32Array(H),O=new Float64Array(H)}function Q(){if(n.preRun)for(typeof n.preRun=="function"&&(n.preRun=[n.preRun]);n.preRun.length;)et(n.preRun.shift());Me(ot)}function q(){Yn.ya()}function ee(){if(n.postRun)for(typeof n.postRun=="function"&&(n.postRun=[n.postRun]);n.postRun.length;)Ce(n.postRun.shift());Me(Ie)}var ne=0,B=null;function z(H){var F;ne++,(F=n.monitorRunDependencies)===null||F===void 0||F.call(n,ne)}function $(H){var F;if(ne--,(F=n.monitorRunDependencies)===null||F===void 0||F.call(n,ne),ne==0&&B){var ie=B;B=null,ie()}}function V(H){var F;(F=n.onAbort)===null||F===void 0||F.call(n,H),H="Aborted("+H+")",C(H),k=!0,H+=". Build with -sASSERTIONS for more info.";var ie=new WebAssembly.RuntimeError(H);throw a(ie),ie}var Z;function ae(){return v("zxing_reader.wasm")}function Ae(H){if(H==Z&&S)return new Uint8Array(S);if(y)return y(H);throw"both async and sync fetching of the wasm failed"}async function be(H){if(!S)try{var F=await b(H);return new Uint8Array(F)}catch{}return Ae(H)}async function Ge(H,F){try{var ie=await be(H),he=await WebAssembly.instantiate(ie,F);return he}catch(xe){C(`failed to asynchronously prepare wasm: ${xe}`),V(xe)}}async function Te(H,F,ie){if(!H&&typeof WebAssembly.instantiateStreaming=="function")try{var he=fetch(F,{credentials:"same-origin"}),xe=await WebAssembly.instantiateStreaming(he,ie);return xe}catch(Se){C(`wasm streaming compile failed: ${Se}`),C("falling back to ArrayBuffer instantiation")}return Ge(F,ie)}function ve(){return{a:Js}}async function ke(){function H(Se,Ne){return Yn=Se.exports,x=Yn.xa,N(),pn=Yn.Ba,$(),Yn}z();function F(Se){return H(Se.instance)}var ie=ve();if(n.instantiateWasm)return new Promise((Se,Ne)=>{n.instantiateWasm(ie,(Pe,lt)=>{Se(H(Pe))})});Z!=null||(Z=ae());try{var he=await Te(S,Z,ie),xe=F(he);return xe}catch(Se){return a(Se),Promise.reject(Se)}}var Me=H=>{for(;H.length>0;)H.shift()(n)},Ie=[],Ce=H=>Ie.push(H),ot=[],et=H=>ot.push(H),me=H=>gs(H),de=()=>zl(),Be=[],Je=0,rt=H=>{var F=new it(H);return F.get_caught()||(F.set_caught(!0),Je--),F.set_rethrown(!1),Be.push(F),Gl(H),Fl(H)},at=0,ye=()=>{jn(0,0);var H=Be.pop();Gc(H.excPtr),at=0};class it{constructor(F){this.excPtr=F,this.ptr=F-24}set_type(F){G[this.ptr+4>>2]=F}get_type(){return G[this.ptr+4>>2]}set_destructor(F){G[this.ptr+8>>2]=F}get_destructor(){return G[this.ptr+8>>2]}set_caught(F){F=F?1:0,A[this.ptr+12]=F}get_caught(){return A[this.ptr+12]!=0}set_rethrown(F){F=F?1:0,A[this.ptr+13]=F}get_rethrown(){return A[this.ptr+13]!=0}init(F,ie){this.set_adjusted_ptr(0),this.set_type(F),this.set_destructor(ie)}set_adjusted_ptr(F){G[this.ptr+16>>2]=F}get_adjusted_ptr(){return G[this.ptr+16>>2]}}var Mt=H=>Hl(H),nt=H=>{var F=at;if(!F)return Mt(0),0;var ie=new it(F);ie.set_adjusted_ptr(F);var he=ie.get_type();if(!he)return Mt(0),F;for(var xe of H){if(xe===0||xe===he)break;var Se=ie.ptr+16;if(Zo(xe,he,Se))return Mt(xe),F}return Mt(he),F},Zt=()=>nt([]),j=H=>nt([H]),W=(H,F)=>nt([H,F]),se=()=>{var H=Be.pop();H||V("no exception to throw");var F=H.excPtr;throw H.get_rethrown()||(Be.push(H),H.set_rethrown(!0),H.set_caught(!1),Je++),at=F,at},Oe=(H,F,ie)=>{var he=new it(H);throw he.init(F,ie),at=H,Je++,at},Ke=()=>Je,gt=H=>{throw at||(at=H),at},Ut=()=>V(""),Le={},Xe=H=>{for(;H.length;){var F=H.pop(),ie=H.pop();ie(F)}};function zt(H){return this.fromWireType(G[H>>2])}var mt={},an={},hn={},pr=class extends Error{constructor(H){super(H),this.name="InternalError"}},Ft=H=>{throw new pr(H)},Bn=(H,F,ie)=>{H.forEach(Pe=>hn[Pe]=F);function he(Pe){var lt=ie(Pe);lt.length!==H.length&&Ft("Mismatched type converter count");for(var It=0;It<H.length;++It)we(H[It],lt[It])}var xe=new Array(F.length),Se=[],Ne=0;F.forEach((Pe,lt)=>{an.hasOwnProperty(Pe)?xe[lt]=an[Pe]:(Se.push(Pe),mt.hasOwnProperty(Pe)||(mt[Pe]=[]),mt[Pe].push(()=>{xe[lt]=an[Pe],++Ne,Ne===Se.length&&he(xe)}))}),Se.length===0&&he(xe)},xr=H=>{var F=Le[H];delete Le[H];var ie=F.rawConstructor,he=F.rawDestructor,xe=F.fields,Se=xe.map(Ne=>Ne.getterReturnType).concat(xe.map(Ne=>Ne.setterArgumentType));Bn([H],Se,Ne=>{var Pe={};return xe.forEach((lt,It)=>{var Vt=lt.fieldName,Gt=Ne[It],En=Ne[It].optional,bn=lt.getter,Xn=lt.getterContext,Un=Ne[It+xe.length],Wn=lt.setter,kr=lt.setterContext;Pe[Vt]={read:Rr=>Gt.fromWireType(bn(Xn,Rr)),write:(Rr,Zr)=>{var jr=[];Wn(kr,Rr,Un.toWireType(jr,Zr)),Xe(jr)},optional:En}}),[{name:F.name,fromWireType:lt=>{var It={};for(var Vt in Pe)It[Vt]=Pe[Vt].read(lt);return he(lt),It},toWireType:(lt,It)=>{for(var Vt in Pe)if(!(Vt in It)&&!Pe[Vt].optional)throw new TypeError(`Missing field: "${Vt}"`);var Gt=ie();for(Vt in Pe)Pe[Vt].write(Gt,It[Vt]);return lt!==null&&lt.push(he,Gt),Gt},argPackAdvance:pt,readValueFromPointer:zt,destructorFunction:he}]})},_r=(H,F,ie,he,xe)=>{},Zn=()=>{for(var H=new Array(256),F=0;F<256;++F)H[F]=String.fromCharCode(F);Ht=H},Ht,pe=H=>{for(var F="",ie=H;R[ie];)F+=Ht[R[ie++]];return F},Ot=class extends Error{constructor(H){super(H),this.name="BindingError"}},qt=H=>{throw new Ot(H)};function fe(H,F){let ie=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};var he=F.name;if(H||qt(`type "${he}" must have a positive integer typeid pointer`),an.hasOwnProperty(H)){if(ie.ignoreDuplicateRegistrations)return;qt(`Cannot register type '${he}' twice`)}if(an[H]=F,delete hn[H],mt.hasOwnProperty(H)){var xe=mt[H];delete mt[H],xe.forEach(Se=>Se())}}function we(H,F){let ie=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return fe(H,F,ie)}var pt=8,At=(H,F,ie,he)=>{F=pe(F),we(H,{name:F,fromWireType:function(xe){return!!xe},toWireType:function(xe,Se){return Se?ie:he},argPackAdvance:pt,readValueFromPointer:function(xe){return this.fromWireType(R[xe])},destructorFunction:null})},K=H=>({count:H.count,deleteScheduled:H.deleteScheduled,preservePointerOnDelete:H.preservePointerOnDelete,ptr:H.ptr,ptrType:H.ptrType,smartPtr:H.smartPtr,smartPtrType:H.smartPtrType}),oe=H=>{function F(ie){return ie.$$.ptrType.registeredClass.name}qt(F(H)+" instance already deleted")},ce=!1,D=H=>{},ge=H=>{H.smartPtr?H.smartPtrType.rawDestructor(H.smartPtr):H.ptrType.registeredClass.rawDestructor(H.ptr)},$e=H=>{H.count.value-=1;var F=H.count.value===0;F&&ge(H)},ze=H=>typeof FinalizationRegistry>"u"?(ze=F=>F,H):(ce=new FinalizationRegistry(F=>{$e(F.$$)}),ze=F=>{var ie=F.$$,he=!!ie.smartPtr;if(he){var xe={$$:ie};ce.register(F,xe,F)}return F},D=F=>ce.unregister(F),ze(H)),vt=()=>{let H=Nt.prototype;Object.assign(H,{isAliasOf(ie){if(!(this instanceof Nt)||!(ie instanceof Nt))return!1;var he=this.$$.ptrType.registeredClass,xe=this.$$.ptr;ie.$$=ie.$$;for(var Se=ie.$$.ptrType.registeredClass,Ne=ie.$$.ptr;he.baseClass;)xe=he.upcast(xe),he=he.baseClass;for(;Se.baseClass;)Ne=Se.upcast(Ne),Se=Se.baseClass;return he===Se&&xe===Ne},clone(){if(this.$$.ptr||oe(this),this.$$.preservePointerOnDelete)return this.$$.count.value+=1,this;var ie=ze(Object.create(Object.getPrototypeOf(this),{$$:{value:K(this.$$)}}));return ie.$$.count.value+=1,ie.$$.deleteScheduled=!1,ie},delete(){this.$$.ptr||oe(this),this.$$.deleteScheduled&&!this.$$.preservePointerOnDelete&&qt("Object already scheduled for deletion"),D(this),$e(this.$$),this.$$.preservePointerOnDelete||(this.$$.smartPtr=void 0,this.$$.ptr=void 0)},isDeleted(){return!this.$$.ptr},deleteLater(){return this.$$.ptr||oe(this),this.$$.deleteScheduled&&!this.$$.preservePointerOnDelete&&qt("Object already scheduled for deletion"),this.$$.deleteScheduled=!0,this}});const F=Symbol.dispose;F&&(H[F]=H.delete)};function Nt(){}var Yt=(H,F)=>Object.defineProperty(F,"name",{value:H}),Kt={},vn=(H,F,ie)=>{if(H[F].overloadTable===void 0){var he=H[F];H[F]=function(){for(var xe=arguments.length,Se=new Array(xe),Ne=0;Ne<xe;Ne++)Se[Ne]=arguments[Ne];return H[F].overloadTable.hasOwnProperty(Se.length)||qt(`Function '${ie}' called with an invalid number of arguments (${Se.length}) - expects one of (${H[F].overloadTable})!`),H[F].overloadTable[Se.length].apply(this,Se)},H[F].overloadTable=[],H[F].overloadTable[he.argCount]=he}},$t=(H,F,ie)=>{n.hasOwnProperty(H)?((ie===void 0||n[H].overloadTable!==void 0&&n[H].overloadTable[ie]!==void 0)&&qt(`Cannot register public name '${H}' twice`),vn(n,H,H),n[H].overloadTable.hasOwnProperty(ie)&&qt(`Cannot register multiple overloads of a function with the same number of arguments (${ie})!`),n[H].overloadTable[ie]=F):(n[H]=F,n[H].argCount=ie)},sn=48,wn=57,xn=H=>{H=H.replace(/[^a-zA-Z0-9_]/g,"$");var F=H.charCodeAt(0);return F>=sn&&F<=wn?`_${H}`:H};function tn(H,F,ie,he,xe,Se,Ne,Pe){this.name=H,this.constructor=F,this.instancePrototype=ie,this.rawDestructor=he,this.baseClass=xe,this.getActualType=Se,this.upcast=Ne,this.downcast=Pe,this.pureVirtualFunctions=[]}var dn=(H,F,ie)=>{for(;F!==ie;)F.upcast||qt(`Expected null or instance of ${ie.name}, got an instance of ${F.name}`),H=F.upcast(H),F=F.baseClass;return H},cn=H=>{if(H===null)return"null";var F=typeof H;return F==="object"||F==="array"||F==="function"?H.toString():""+H};function on(H,F){if(F===null)return this.isReference&&qt(`null is not a valid ${this.name}`),0;F.$$||qt(`Cannot pass "${cn(F)}" as a ${this.name}`),F.$$.ptr||qt(`Cannot pass deleted object as a pointer of type ${this.name}`);var ie=F.$$.ptrType.registeredClass,he=dn(F.$$.ptr,ie,this.registeredClass);return he}function Xt(H,F){var ie;if(F===null)return this.isReference&&qt(`null is not a valid ${this.name}`),this.isSmartPointer?(ie=this.rawConstructor(),H!==null&&H.push(this.rawDestructor,ie),ie):0;(!F||!F.$$)&&qt(`Cannot pass "${cn(F)}" as a ${this.name}`),F.$$.ptr||qt(`Cannot pass deleted object as a pointer of type ${this.name}`),!this.isConst&&F.$$.ptrType.isConst&&qt(`Cannot convert argument of type ${F.$$.smartPtrType?F.$$.smartPtrType.name:F.$$.ptrType.name} to parameter type ${this.name}`);var he=F.$$.ptrType.registeredClass;if(ie=dn(F.$$.ptr,he,this.registeredClass),this.isSmartPointer)switch(F.$$.smartPtr===void 0&&qt("Passing raw pointer to smart pointer is illegal"),this.sharingPolicy){case 0:F.$$.smartPtrType===this?ie=F.$$.smartPtr:qt(`Cannot convert argument of type ${F.$$.smartPtrType?F.$$.smartPtrType.name:F.$$.ptrType.name} to parameter type ${this.name}`);break;case 1:ie=F.$$.smartPtr;break;case 2:if(F.$$.smartPtrType===this)ie=F.$$.smartPtr;else{var xe=F.clone();ie=this.rawShare(ie,sr.toHandle(()=>xe.delete())),H!==null&&H.push(this.rawDestructor,ie)}break;default:qt("Unsupporting sharing policy")}return ie}function ln(H,F){if(F===null)return this.isReference&&qt(`null is not a valid ${this.name}`),0;F.$$||qt(`Cannot pass "${cn(F)}" as a ${this.name}`),F.$$.ptr||qt(`Cannot pass deleted object as a pointer of type ${this.name}`),F.$$.ptrType.isConst&&qt(`Cannot convert argument of type ${F.$$.ptrType.name} to parameter type ${this.name}`);var ie=F.$$.ptrType.registeredClass,he=dn(F.$$.ptr,ie,this.registeredClass);return he}var Wt=(H,F,ie)=>{if(F===ie)return H;if(ie.baseClass===void 0)return null;var he=Wt(H,F,ie.baseClass);return he===null?null:ie.downcast(he)},en={},nn=(H,F)=>{for(F===void 0&&qt("ptr should not be undefined");H.baseClass;)F=H.upcast(F),H=H.baseClass;return F},Jt=(H,F)=>(F=nn(H,F),en[F]),ht=(H,F)=>{(!F.ptrType||!F.ptr)&&Ft("makeClassHandle requires ptr and ptrType");var ie=!!F.smartPtrType,he=!!F.smartPtr;return ie!==he&&Ft("Both smartPtrType and smartPtr must be specified"),F.count={value:1},ze(Object.create(H,{$$:{value:F,writable:!0}}))};function yt(H){var F=this.getPointee(H);if(!F)return this.destructor(H),null;var ie=Jt(this.registeredClass,F);if(ie!==void 0){if(ie.$$.count.value===0)return ie.$$.ptr=F,ie.$$.smartPtr=H,ie.clone();var he=ie.clone();return this.destructor(H),he}function xe(){return this.isSmartPointer?ht(this.registeredClass.instancePrototype,{ptrType:this.pointeeType,ptr:F,smartPtrType:this,smartPtr:H}):ht(this.registeredClass.instancePrototype,{ptrType:this,ptr:H})}var Se=this.registeredClass.getActualType(F),Ne=Kt[Se];if(!Ne)return xe.call(this);var Pe;this.isConst?Pe=Ne.constPointerType:Pe=Ne.pointerType;var lt=Wt(F,this.registeredClass,Pe.registeredClass);return lt===null?xe.call(this):this.isSmartPointer?ht(Pe.registeredClass.instancePrototype,{ptrType:Pe,ptr:lt,smartPtrType:this,smartPtr:H}):ht(Pe.registeredClass.instancePrototype,{ptrType:Pe,ptr:lt})}var bt=()=>{Object.assign(kt.prototype,{getPointee(H){return this.rawGetPointee&&(H=this.rawGetPointee(H)),H},destructor(H){var F;(F=this.rawDestructor)===null||F===void 0||F.call(this,H)},argPackAdvance:pt,readValueFromPointer:zt,fromWireType:yt})};function kt(H,F,ie,he,xe,Se,Ne,Pe,lt,It,Vt){this.name=H,this.registeredClass=F,this.isReference=ie,this.isConst=he,this.isSmartPointer=xe,this.pointeeType=Se,this.sharingPolicy=Ne,this.rawGetPointee=Pe,this.rawConstructor=lt,this.rawShare=It,this.rawDestructor=Vt,!xe&&F.baseClass===void 0?he?(this.toWireType=on,this.destructorFunction=null):(this.toWireType=ln,this.destructorFunction=null):this.toWireType=Xt}var Ct=(H,F,ie)=>{n.hasOwnProperty(H)||Ft("Replacing nonexistent public symbol"),n[H].overloadTable!==void 0&&ie!==void 0?n[H].overloadTable[ie]=F:(n[H]=F,n[H].argCount=ie)},Pt=[],pn,Qt=H=>{var F=Pt[H];return F||(Pt[H]=F=pn.get(H)),F},An=function(H,F){let ie=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];if(H.includes("j"))return dynCallLegacy(H,F,ie);var he=Qt(F),xe=he(...ie);return xe},kn=function(H,F){let ie=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;return function(){for(var he=arguments.length,xe=new Array(he),Se=0;Se<he;Se++)xe[Se]=arguments[Se];return An(H,F,xe,ie)}},Ee=function(H,F){H=pe(H);function ie(){if(H.includes("j"))return kn(H,F);var xe=Qt(F);return xe}var he=ie();return typeof he!="function"&&qt(`unknown function pointer with signature ${H}: ${F}`),he};class Tn extends Error{}var _n=H=>{var F=zc(H),ie=pe(F);return Ii(F),ie},Mn=(H,F)=>{var ie=[],he={};function xe(Se){if(!he[Se]&&!an[Se]){if(hn[Se]){hn[Se].forEach(xe);return}ie.push(Se),he[Se]=!0}}throw F.forEach(xe),new Tn(`${H}: `+ie.map(_n).join([", "]))},In=(H,F,ie,he,xe,Se,Ne,Pe,lt,It,Vt,Gt,En)=>{Vt=pe(Vt),Se=Ee(xe,Se),Pe&&(Pe=Ee(Ne,Pe)),It&&(It=Ee(lt,It)),En=Ee(Gt,En);var bn=xn(Vt);$t(bn,function(){Mn(`Cannot construct ${Vt} due to unbound types`,[he])}),Bn([H,F,ie],he?[he]:[],Xn=>{Xn=Xn[0];var Un,Wn;he?(Un=Xn.registeredClass,Wn=Un.instancePrototype):Wn=Nt.prototype;var kr=Yt(Vt,function(){if(Object.getPrototypeOf(this)!==Rr)throw new Ot(`Use 'new' to construct ${Vt}`);if(Zr.constructor_body===void 0)throw new Ot(`${Vt} has no accessible constructor`);for(var Vc=arguments.length,ta=new Array(Vc),rl=0;rl<Vc;rl++)ta[rl]=arguments[rl];var Ei=Zr.constructor_body[ta.length];if(Ei===void 0)throw new Ot(`Tried to invoke ctor of ${Vt} with invalid number of parameters (${ta.length}) - expected (${Object.keys(Zr.constructor_body).toString()}) parameters instead!`);return Ei.apply(this,ta)}),Rr=Object.create(Wn,{constructor:{value:kr}});kr.prototype=Rr;var Zr=new tn(Vt,kr,Rr,En,Un,Se,Pe,It);if(Zr.baseClass){var jr,nl;(nl=(jr=Zr.baseClass).__derivedClasses)!==null&&nl!==void 0||(jr.__derivedClasses=[]),Zr.baseClass.__derivedClasses.push(Zr)}var $l=new kt(Vt,Zr,!0,!1,!1),Ns=new kt(Vt+"*",Zr,!1,!1,!1),Yl=new kt(Vt+" const*",Zr,!1,!0,!1);return Kt[H]={pointerType:Ns,constPointerType:Yl},Ct(bn,kr),[$l,Ns,Yl]})},On=(H,F)=>{for(var ie=[],he=0;he<H;he++)ie.push(G[F+he*4>>2]);return ie};function Rn(H){for(var F=1;F<H.length;++F)if(H[F]!==null&&H[F].destructorFunction===void 0)return!0;return!1}function rr(H,F,ie,he,xe,Se){var Ne=F.length;Ne<2&&qt("argTypes array size mismatch! Must at least get return value and 'this' types!");var Pe=F[1]!==null&&ie!==null,lt=Rn(F),It=F[0].name!=="void",Vt=Ne-2,Gt=new Array(Vt),En=[],bn=[],Xn=function(){bn.length=0;var Un;En.length=Pe?2:1,En[0]=xe,Pe&&(Un=F[1].toWireType(bn,this),En[1]=Un);for(var Wn=0;Wn<Vt;++Wn)Gt[Wn]=F[Wn+2].toWireType(bn,Wn<0||arguments.length<=Wn?void 0:arguments[Wn]),En.push(Gt[Wn]);var kr=he(...En);function Rr(Zr){if(lt)Xe(bn);else for(var jr=Pe?1:2;jr<F.length;jr++){var nl=jr===1?Un:Gt[jr-2];F[jr].destructorFunction!==null&&F[jr].destructorFunction(nl)}if(It)return F[0].fromWireType(Zr)}return Rr(kr)};return Yt(H,Xn)}var qn=(H,F,ie,he,xe,Se)=>{var Ne=On(F,ie);xe=Ee(he,xe),Bn([],[H],Pe=>{Pe=Pe[0];var lt=`constructor ${Pe.name}`;if(Pe.registeredClass.constructor_body===void 0&&(Pe.registeredClass.constructor_body=[]),Pe.registeredClass.constructor_body[F-1]!==void 0)throw new Ot(`Cannot register multiple constructors with identical number of parameters (${F-1}) for class '${Pe.name}'! Overload resolution is currently only performed using the parameter count, not actual type info!`);return Pe.registeredClass.constructor_body[F-1]=()=>{Mn(`Cannot construct ${Pe.name} due to unbound types`,Ne)},Bn([],Ne,It=>(It.splice(1,0,null),Pe.registeredClass.constructor_body[F-1]=rr(lt,It,null,xe,Se),[])),[]})},Vn=H=>{H=H.trim();const F=H.indexOf("(");return F===-1?H:H.slice(0,F)},cr=(H,F,ie,he,xe,Se,Ne,Pe,lt,It)=>{var Vt=On(ie,he);F=pe(F),F=Vn(F),Se=Ee(xe,Se),Bn([],[H],Gt=>{Gt=Gt[0];var En=`${Gt.name}.${F}`;F.startsWith("@@")&&(F=Symbol[F.substring(2)]),Pe&&Gt.registeredClass.pureVirtualFunctions.push(F);function bn(){Mn(`Cannot call ${En} due to unbound types`,Vt)}var Xn=Gt.registeredClass.instancePrototype,Un=Xn[F];return Un===void 0||Un.overloadTable===void 0&&Un.className!==Gt.name&&Un.argCount===ie-2?(bn.argCount=ie-2,bn.className=Gt.name,Xn[F]=bn):(vn(Xn,F,En),Xn[F].overloadTable[ie-2]=bn),Bn([],Vt,Wn=>{var kr=rr(En,Wn,Gt,Se,Ne);return Xn[F].overloadTable===void 0?(kr.argCount=ie-2,Xn[F]=kr):Xn[F].overloadTable[ie-2]=kr,[]}),[]})},mn=[],Jn=[0,1,,1,null,1,!0,1,!1,1],br=H=>{H>9&&--Jn[H+1]===0&&(Jn[H]=void 0,mn.push(H))},sr={toValue:H=>(H||qt(`Cannot use deleted val. handle = ${H}`),Jn[H]),toHandle:H=>{switch(H){case void 0:return 2;case null:return 4;case!0:return 6;case!1:return 8;default:{const F=mn.pop()||Jn.length;return Jn[F]=H,Jn[F+1]=1,F}}}},$n={name:"emscripten::val",fromWireType:H=>{var F=sr.toValue(H);return br(H),F},toWireType:(H,F)=>sr.toHandle(F),argPackAdvance:pt,readValueFromPointer:zt,destructorFunction:null},Fi=H=>we(H,$n),fi=(H,F)=>{switch(F){case 4:return function(ie){return this.fromWireType(Y[ie>>2])};case 8:return function(ie){return this.fromWireType(O[ie>>3])};default:throw new TypeError(`invalid float width (${F}): ${H}`)}},Mi=(H,F,ie)=>{F=pe(F),we(H,{name:F,fromWireType:he=>he,toWireType:(he,xe)=>xe,argPackAdvance:pt,readValueFromPointer:fi(F,ie),destructorFunction:null})},qo=(H,F,ie,he,xe,Se,Ne,Pe)=>{var lt=On(F,ie);H=pe(H),H=Vn(H),xe=Ee(he,xe),$t(H,function(){Mn(`Cannot call ${H} due to unbound types`,lt)},F-1),Bn([],lt,It=>{var Vt=[It[0],null].concat(It.slice(1));return Ct(H,rr(H,Vt,null,xe,Se),F-1),[]})},as=(H,F,ie)=>{switch(F){case 1:return ie?he=>A[he]:he=>R[he];case 2:return ie?he=>I[he>>1]:he=>U[he>>1];case 4:return ie?he=>te[he>>2]:he=>G[he>>2];default:throw new TypeError(`invalid integer width (${F}): ${H}`)}},gr=(H,F,ie,he,xe)=>{F=pe(F);const Se=he===0;let Ne=lt=>lt;if(Se){var Pe=32-8*ie;Ne=lt=>lt<<Pe>>>Pe,xe=Ne(xe)}we(H,{name:F,fromWireType:Ne,toWireType:(lt,It)=>It,argPackAdvance:pt,readValueFromPointer:as(F,ie,he!==0),destructorFunction:null})},_i=(H,F,ie)=>{var he=[Int8Array,Uint8Array,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array],xe=he[F];function Se(Ne){var Pe=G[Ne>>2],lt=G[Ne+4>>2];return new xe(A.buffer,lt,Pe)}ie=pe(ie),we(H,{name:ie,fromWireType:Se,argPackAdvance:pt,readValueFromPointer:Se},{ignoreDuplicateRegistrations:!0})},ls=Object.assign({optional:!0},$n),Cs=(H,F)=>{we(H,ls)},cs=(H,F,ie,he)=>{if(!(he>0))return 0;for(var xe=ie,Se=ie+he-1,Ne=0;Ne<H.length;++Ne){var Pe=H.charCodeAt(Ne);if(Pe>=55296&&Pe<=57343){var lt=H.charCodeAt(++Ne);Pe=65536+((Pe&1023)<<10)|lt&1023}if(Pe<=127){if(ie>=Se)break;F[ie++]=Pe}else if(Pe<=2047){if(ie+1>=Se)break;F[ie++]=192|Pe>>6,F[ie++]=128|Pe&63}else if(Pe<=65535){if(ie+2>=Se)break;F[ie++]=224|Pe>>12,F[ie++]=128|Pe>>6&63,F[ie++]=128|Pe&63}else{if(ie+3>=Se)break;F[ie++]=240|Pe>>18,F[ie++]=128|Pe>>12&63,F[ie++]=128|Pe>>6&63,F[ie++]=128|Pe&63}}return F[ie]=0,ie-xe},Sr=(H,F,ie)=>cs(H,R,F,ie),Fo=H=>{for(var F=0,ie=0;ie<H.length;++ie){var he=H.charCodeAt(ie);he<=127?F++:he<=2047?F+=2:he>=55296&&he<=57343?(F+=4,++ie):F+=3}return F},Wr=typeof TextDecoder<"u"?new TextDecoder:void 0,Si=function(H){let F=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,ie=arguments.length>2&&arguments[2]!==void 0?arguments[2]:NaN;for(var he=F+ie,xe=F;H[xe]&&!(xe>=he);)++xe;if(xe-F>16&&H.buffer&&Wr)return Wr.decode(H.subarray(F,xe));for(var Se="";F<xe;){var Ne=H[F++];if(!(Ne&128)){Se+=String.fromCharCode(Ne);continue}var Pe=H[F++]&63;if((Ne&224)==192){Se+=String.fromCharCode((Ne&31)<<6|Pe);continue}var lt=H[F++]&63;if((Ne&240)==224?Ne=(Ne&15)<<12|Pe<<6|lt:Ne=(Ne&7)<<18|Pe<<12|lt<<6|H[F++]&63,Ne<65536)Se+=String.fromCharCode(Ne);else{var It=Ne-65536;Se+=String.fromCharCode(55296|It>>10,56320|It&1023)}}return Se},Ho=(H,F)=>H?Si(R,H,F):"",As=(H,F)=>{F=pe(F),we(H,{name:F,fromWireType(ie){for(var he=G[ie>>2],xe=ie+4,Se,Pe,Ne=xe,Pe=0;Pe<=he;++Pe){var lt=xe+Pe;if(Pe==he||R[lt]==0){var It=lt-Ne,Vt=Ho(Ne,It);Se===void 0?Se=Vt:(Se+="\0",Se+=Vt),Ne=lt+1}}return Ii(ie),Se},toWireType(ie,he){he instanceof ArrayBuffer&&(he=new Uint8Array(he));var xe,Se=typeof he=="string";Se||ArrayBuffer.isView(he)&&he.BYTES_PER_ELEMENT==1||qt("Cannot pass non-string to std::string"),Se?xe=Fo(he):xe=he.length;var Ne=Zs(4+xe+1),Pe=Ne+4;return G[Ne>>2]=xe,Se?Sr(he,Pe,xe+1):R.set(he,Pe),ie!==null&&ie.push(Ii,Ne),Ne},argPackAdvance:pt,readValueFromPointer:zt,destructorFunction(ie){Ii(ie)}})},us=typeof TextDecoder<"u"?new TextDecoder("utf-16le"):void 0,ks=(H,F)=>{for(var ie=H>>1,he=ie+F/2,xe=ie;!(xe>=he)&&U[xe];)++xe;if(xe-ie>16&&us)return us.decode(U.subarray(ie,xe));for(var Se="",Ne=ie;!(Ne>=he);++Ne){var Pe=U[Ne];if(Pe==0)break;Se+=String.fromCharCode(Pe)}return Se},$s=(H,F,ie)=>{if(ie!=null||(ie=2147483647),ie<2)return 0;ie-=2;for(var he=F,xe=ie<H.length*2?ie/2:H.length,Se=0;Se<xe;++Se){var Ne=H.charCodeAt(Se);I[F>>1]=Ne,F+=2}return I[F>>1]=0,F-he},Pl=H=>H.length*2,Br=(H,F)=>{for(var ie=0,he="";!(ie>=F/4);){var xe=te[H+ie*4>>2];if(xe==0)break;if(++ie,xe>=65536){var Se=xe-65536;he+=String.fromCharCode(55296|Se>>10,56320|Se&1023)}else he+=String.fromCharCode(xe)}return he},fs=(H,F,ie)=>{if(ie!=null||(ie=2147483647),ie<4)return 0;for(var he=F,xe=he+ie-4,Se=0;Se<H.length;++Se){var Ne=H.charCodeAt(Se);if(Ne>=55296&&Ne<=57343){var Pe=H.charCodeAt(++Se);Ne=65536+((Ne&1023)<<10)|Pe&1023}if(te[F>>2]=Ne,F+=4,F+4>xe)break}return te[F>>2]=0,F-he},zo=H=>{for(var F=0,ie=0;ie<H.length;++ie){var he=H.charCodeAt(ie);he>=55296&&he<=57343&&++ie,F+=4}return F},$i=(H,F,ie)=>{ie=pe(ie);var he,xe,Se,Ne;F===2?(he=ks,xe=$s,Ne=Pl,Se=Pe=>U[Pe>>1]):F===4&&(he=Br,xe=fs,Ne=zo,Se=Pe=>G[Pe>>2]),we(H,{name:ie,fromWireType:Pe=>{for(var lt=G[Pe>>2],It,Vt=Pe+4,Gt=0;Gt<=lt;++Gt){var En=Pe+4+Gt*F;if(Gt==lt||Se(En)==0){var bn=En-Vt,Xn=he(Vt,bn);It===void 0?It=Xn:(It+="\0",It+=Xn),Vt=En+F}}return Ii(Pe),It},toWireType:(Pe,lt)=>{typeof lt!="string"&&qt(`Cannot pass non-string to C++ string type ${ie}`);var It=Ne(lt),Vt=Zs(4+It+F);return G[Vt>>2]=It/F,xe(lt,Vt+4,It+F),Pe!==null&&Pe.push(Ii,Vt),Vt},argPackAdvance:pt,readValueFromPointer:zt,destructorFunction(Pe){Ii(Pe)}})},Go=(H,F,ie,he,xe,Se)=>{Le[H]={name:pe(F),rawConstructor:Ee(ie,he),rawDestructor:Ee(xe,Se),fields:[]}},Ys=(H,F,ie,he,xe,Se,Ne,Pe,lt,It)=>{Le[H].fields.push({fieldName:pe(F),getterReturnType:ie,getter:Ee(he,xe),getterContext:Se,setterArgumentType:Ne,setter:Ee(Pe,lt),setterContext:It})},za=(H,F)=>{F=pe(F),we(H,{isVoid:!0,name:F,argPackAdvance:0,fromWireType:()=>{},toWireType:(ie,he)=>{}})},hs=[],Ko=(H,F,ie,he)=>(H=hs[H],F=sr.toValue(F),H(null,F,ie,he)),Vo={},Ga=H=>{var F=Vo[H];return F===void 0?pe(H):F},Ka=()=>{if(typeof globalThis=="object")return globalThis;function H(F){F.$$$embind_global$$$=F;var ie=typeof $$$embind_global$$$=="object"&&F.$$$embind_global$$$==F;return ie||delete F.$$$embind_global$$$,ie}if(typeof $$$embind_global$$$=="object"||(typeof global=="object"&&H(global)?$$$embind_global$$$=global:typeof self=="object"&&H(self)&&($$$embind_global$$$=self),typeof $$$embind_global$$$=="object"))return $$$embind_global$$$;throw Error("unable to get global object.")},$o=H=>H===0?sr.toHandle(Ka()):(H=Ga(H),sr.toHandle(Ka()[H])),Ts=H=>{var F=hs.length;return hs.push(H),F},Ws=(H,F)=>{var ie=an[H];return ie===void 0&&qt(`${F} has unknown type ${_n(H)}`),ie},Ll=(H,F)=>{for(var ie=new Array(H),he=0;he<H;++he)ie[he]=Ws(G[F+he*4>>2],`parameter ${he}`);return ie},Fc=(H,F,ie)=>{var he=[],xe=H.toWireType(he,ie);return he.length&&(G[F>>2]=sr.toHandle(he)),xe},Ms=Reflect.construct,Va=(H,F,ie)=>{var he=Ll(H,F),xe=he.shift();H--;var Se=new Array(H),Ne=(lt,It,Vt,Gt)=>{for(var En=0,bn=0;bn<H;++bn)Se[bn]=he[bn].readValueFromPointer(Gt+En),En+=he[bn].argPackAdvance;var Xn=ie===1?Ms(It,Se):It.apply(lt,Se);return Fc(xe,Vt,Xn)},Pe=`methodCaller<(${he.map(lt=>lt.name).join(", ")}) => ${xe.name}>`;return Ts(Yt(Pe,Ne))},Yo=H=>{H>9&&(Jn[H+1]+=1)},$a=H=>{var F=sr.toValue(H);Xe(F),br(H)},Ya=(H,F)=>{H=Ws(H,"_emval_take_value");var ie=H.readValueFromPointer(F);return sr.toHandle(ie)},zr=(H,F,ie,he)=>{var xe=new Date().getFullYear(),Se=new Date(xe,0,1),Ne=new Date(xe,6,1),Pe=Se.getTimezoneOffset(),lt=Ne.getTimezoneOffset(),It=Math.max(Pe,lt);G[H>>2]=It*60,te[F>>2]=+(Pe!=lt);var Vt=bn=>{var Xn=bn>=0?"-":"+",Un=Math.abs(bn),Wn=String(Math.floor(Un/60)).padStart(2,"0"),kr=String(Un%60).padStart(2,"0");return`UTC${Xn}${Wn}${kr}`},Gt=Vt(Pe),En=Vt(lt);lt<Pe?(Sr(Gt,ie,17),Sr(En,he,17)):(Sr(Gt,he,17),Sr(En,ie,17))},Qs=()=>2147483648,ds=(H,F)=>Math.ceil(H/F)*F,Ul=H=>{var F=x.buffer,ie=(H-F.byteLength+65535)/65536|0;try{return x.grow(ie),N(),1}catch{}},Wo=H=>{var F=R.length;H>>>=0;var ie=Qs();if(H>ie)return!1;for(var he=1;he<=4;he*=2){var xe=F*(1+.2/he);xe=Math.min(xe,H+100663296);var Se=Math.min(ie,ds(Math.max(H,xe),65536)),Ne=Ul(Se);if(Ne)return!0}return!1},Qo={},Wa=()=>d||"./this.program",Yi=()=>{if(!Yi.strings){var H=(typeof navigator=="object"&&navigator.languages&&navigator.languages[0]||"C").replace("-","_")+".UTF-8",F={USER:"web_user",LOGNAME:"web_user",PATH:"/",PWD:"/",HOME:"/home/web_user",LANG:H,_:Wa()};for(var ie in Qo)Qo[ie]===void 0?delete F[ie]:F[ie]=Qo[ie];var he=[];for(var ie in F)he.push(`${ie}=${F[ie]}`);Yi.strings=he}return Yi.strings},Qa=(H,F)=>{var ie=0,he=0;for(var xe of Yi()){var Se=F+ie;G[H+he>>2]=Se,ie+=Sr(xe,Se,1/0)+1,he+=4}return 0},ps=(H,F)=>{var ie=Yi();G[H>>2]=ie.length;var he=0;for(var xe of ie)he+=Fo(xe)+1;return G[F>>2]=he,0},Ja=H=>52;function Za(H,F,ie,he,xe){return 70}var Jo=[null,[],[]],Xa=(H,F)=>{var ie=Jo[H];F===0||F===10?((H===1?w:C)(Si(ie)),ie.length=0):ie.push(F)},ql=(H,F,ie,he)=>{for(var xe=0,Se=0;Se<ie;Se++){var Ne=G[F>>2],Pe=G[F+4>>2];F+=8;for(var lt=0;lt<Pe;lt++)Xa(H,R[Ne+lt]);xe+=Pe}return G[he>>2]=xe,0},Hc=H=>H;Zn(),vt(),bt(),n.noExitRuntime&&n.noExitRuntime,n.print&&(w=n.print),n.printErr&&(C=n.printErr),n.wasmBinary&&(S=n.wasmBinary),n.arguments&&n.arguments,n.thisProgram&&(d=n.thisProgram);var Js={s:rt,w:ye,a:Zt,j,m:W,P:se,p:Oe,ga:Ke,d:gt,ba:Ut,ua:xr,aa:_r,pa:At,sa:In,ra:qn,H:cr,na:Fi,V:Mi,W:qo,x:gr,t:_i,ta:Cs,oa:As,Q:$i,I:Go,va:Ys,qa:za,da:Ko,wa:br,D:$o,ma:Va,X:Yo,Y:$a,U:Ya,ca:zr,ha:Wo,ea:Qa,fa:ps,ia:Ja,_:Za,S:ql,K:Re,C:qe,M:Xo,R:Ye,q:J,b:mr,E:_e,ka:je,c:Rs,ja:Ze,h:Kc,i:Vl,r:Wi,O:le,v:_,F:L,L:re,z:We,J:Qe,$:st,Z:ft,k:ri,f:Xs,e:Ri,g:eo,N:Ve,l:ea,la:Ue,o:Jr,B:ms,u:T,T:Os,A:Fe,n:Kl,G:tl,y:Hc},Yn=await ke();Yn.ya;var zc=Yn.za,Ii=n._free=Yn.Aa,Zs=n._malloc=Yn.Ca,Fl=Yn.Da,jn=Yn.Ea,Hl=Yn.Fa,gs=Yn.Ga,zl=Yn.Ha,Gc=Yn.Ia,Gl=Yn.Ja,Zo=Yn.Ka;n.dynCall_viijii=Yn.La;var el=n.dynCall_iiijj=Yn.Ma;n.dynCall_jiji=Yn.Na;var Is=n.dynCall_jiiii=Yn.Oa;n.dynCall_iiiiij=Yn.Pa,n.dynCall_iiiiijj=Yn.Qa,n.dynCall_iiiiiijj=Yn.Ra;function Xs(H,F){var ie=de();try{Qt(H)(F)}catch(he){if(me(ie),he!==he+0)throw he;jn(1,0)}}function Kc(H,F,ie,he){var xe=de();try{return Qt(H)(F,ie,he)}catch(Se){if(me(xe),Se!==Se+0)throw Se;jn(1,0)}}function Xo(H,F,ie,he,xe){var Se=de();try{return Qt(H)(F,ie,he,xe)}catch(Ne){if(me(Se),Ne!==Ne+0)throw Ne;jn(1,0)}}function eo(H,F,ie,he){var xe=de();try{Qt(H)(F,ie,he)}catch(Se){if(me(xe),Se!==Se+0)throw Se;jn(1,0)}}function Ri(H,F,ie){var he=de();try{Qt(H)(F,ie)}catch(xe){if(me(he),xe!==xe+0)throw xe;jn(1,0)}}function mr(H,F){var ie=de();try{return Qt(H)(F)}catch(he){if(me(ie),he!==he+0)throw he;jn(1,0)}}function Rs(H,F,ie){var he=de();try{return Qt(H)(F,ie)}catch(xe){if(me(he),xe!==xe+0)throw xe;jn(1,0)}}function ri(H){var F=de();try{Qt(H)()}catch(ie){if(me(F),ie!==ie+0)throw ie;jn(1,0)}}function Kl(H,F,ie,he,xe,Se,Ne,Pe,lt,It,Vt){var Gt=de();try{Qt(H)(F,ie,he,xe,Se,Ne,Pe,lt,It,Vt)}catch(En){if(me(Gt),En!==En+0)throw En;jn(1,0)}}function ea(H,F,ie,he,xe){var Se=de();try{Qt(H)(F,ie,he,xe)}catch(Ne){if(me(Se),Ne!==Ne+0)throw Ne;jn(1,0)}}function Vl(H,F,ie,he,xe){var Se=de();try{return Qt(H)(F,ie,he,xe)}catch(Ne){if(me(Se),Ne!==Ne+0)throw Ne;jn(1,0)}}function ms(H,F,ie,he,xe,Se,Ne){var Pe=de();try{Qt(H)(F,ie,he,xe,Se,Ne)}catch(lt){if(me(Pe),lt!==lt+0)throw lt;jn(1,0)}}function tl(H,F,ie,he,xe,Se,Ne,Pe,lt,It,Vt,Gt,En,bn,Xn,Un){var Wn=de();try{Qt(H)(F,ie,he,xe,Se,Ne,Pe,lt,It,Vt,Gt,En,bn,Xn,Un)}catch(kr){if(me(Wn),kr!==kr+0)throw kr;jn(1,0)}}function Os(H,F,ie,he,xe,Se,Ne,Pe,lt){var It=de();try{Qt(H)(F,ie,he,xe,Se,Ne,Pe,lt)}catch(Vt){if(me(It),Vt!==Vt+0)throw Vt;jn(1,0)}}function Wi(H,F,ie,he,xe,Se){var Ne=de();try{return Qt(H)(F,ie,he,xe,Se)}catch(Pe){if(me(Ne),Pe!==Pe+0)throw Pe;jn(1,0)}}function Jr(H,F,ie,he,xe,Se){var Ne=de();try{Qt(H)(F,ie,he,xe,Se)}catch(Pe){if(me(Ne),Pe!==Pe+0)throw Pe;jn(1,0)}}function _(H,F,ie,he,xe,Se,Ne){var Pe=de();try{return Qt(H)(F,ie,he,xe,Se,Ne)}catch(lt){if(me(Pe),lt!==lt+0)throw lt;jn(1,0)}}function T(H,F,ie,he,xe,Se,Ne,Pe){var lt=de();try{Qt(H)(F,ie,he,xe,Se,Ne,Pe)}catch(It){if(me(lt),It!==It+0)throw It;jn(1,0)}}function L(H,F,ie,he,xe,Se,Ne,Pe){var lt=de();try{return Qt(H)(F,ie,he,xe,Se,Ne,Pe)}catch(It){if(me(lt),It!==It+0)throw It;jn(1,0)}}function J(H){var F=de();try{return Qt(H)()}catch(ie){if(me(F),ie!==ie+0)throw ie;jn(1,0)}}function re(H,F,ie,he,xe,Se,Ne,Pe,lt){var It=de();try{return Qt(H)(F,ie,he,xe,Se,Ne,Pe,lt)}catch(Vt){if(me(It),Vt!==Vt+0)throw Vt;jn(1,0)}}function le(H,F,ie,he,xe,Se,Ne){var Pe=de();try{return Qt(H)(F,ie,he,xe,Se,Ne)}catch(lt){if(me(Pe),lt!==lt+0)throw lt;jn(1,0)}}function _e(H,F,ie,he){var xe=de();try{return Qt(H)(F,ie,he)}catch(Se){if(me(xe),Se!==Se+0)throw Se;jn(1,0)}}function Re(H,F,ie,he){var xe=de();try{return Qt(H)(F,ie,he)}catch(Se){if(me(xe),Se!==Se+0)throw Se;jn(1,0)}}function Ue(H,F,ie,he,xe,Se,Ne,Pe){var lt=de();try{Qt(H)(F,ie,he,xe,Se,Ne,Pe)}catch(It){if(me(lt),It!==It+0)throw It;jn(1,0)}}function qe(H,F,ie,he,xe,Se){var Ne=de();try{return Qt(H)(F,ie,he,xe,Se)}catch(Pe){if(me(Ne),Pe!==Pe+0)throw Pe;jn(1,0)}}function We(H,F,ie,he,xe,Se,Ne,Pe,lt,It){var Vt=de();try{return Qt(H)(F,ie,he,xe,Se,Ne,Pe,lt,It)}catch(Gt){if(me(Vt),Gt!==Gt+0)throw Gt;jn(1,0)}}function je(H,F,ie){var he=de();try{return Qt(H)(F,ie)}catch(xe){if(me(he),xe!==xe+0)throw xe;jn(1,0)}}function Ze(H,F,ie,he,xe){var Se=de();try{return Qt(H)(F,ie,he,xe)}catch(Ne){if(me(Se),Ne!==Ne+0)throw Ne;jn(1,0)}}function Fe(H,F,ie,he,xe,Se,Ne,Pe,lt,It){var Vt=de();try{Qt(H)(F,ie,he,xe,Se,Ne,Pe,lt,It)}catch(Gt){if(me(Vt),Gt!==Gt+0)throw Gt;jn(1,0)}}function Ve(H,F,ie,he,xe,Se,Ne){var Pe=de();try{Qt(H)(F,ie,he,xe,Se,Ne)}catch(lt){if(me(Pe),lt!==lt+0)throw lt;jn(1,0)}}function Ye(H,F,ie,he){var xe=de();try{return Qt(H)(F,ie,he)}catch(Se){if(me(xe),Se!==Se+0)throw Se;jn(1,0)}}function Qe(H,F,ie,he,xe,Se,Ne,Pe,lt,It,Vt,Gt){var En=de();try{return Qt(H)(F,ie,he,xe,Se,Ne,Pe,lt,It,Vt,Gt)}catch(bn){if(me(En),bn!==bn+0)throw bn;jn(1,0)}}function st(H,F,ie,he,xe,Se,Ne){var Pe=de();try{return el(H,F,ie,he,xe,Se,Ne)}catch(lt){if(me(Pe),lt!==lt+0)throw lt;jn(1,0)}}function ft(H,F,ie,he,xe){var Se=de();try{return Is(H,F,ie,he,xe)}catch(Ne){if(me(Se),Ne!==Ne+0)throw Ne;jn(1,0)}}function xt(){if(ne>0){B=xt;return}if(Q(),ne>0){B=xt;return}function H(){var F;n.calledRun=!0,!k&&(q(),s(n),(F=n.onRuntimeInitialized)===null||F===void 0||F.call(n),ee())}n.setStatus?(n.setStatus("Running..."),setTimeout(()=>{setTimeout(()=>n.setStatus(""),1),H()},1)):H()}function Dt(){if(n.preInit)for(typeof n.preInit=="function"&&(n.preInit=[n.preInit]);n.preInit.length>0;)n.preInit.shift()()}return Dt(),xt(),e=l,e};function MB(i){return Tk(Mk,i)}async function IB(i,e){return TB(Mk,i,e)}const Ik=[["aztec","Aztec"],["code_128","Code128"],["code_39","Code39"],["code_93","Code93"],["codabar","Codabar"],["databar","DataBar"],["databar_expanded","DataBarExpanded"],["databar_limited","DataBarLimited"],["data_matrix","DataMatrix"],["dx_film_edge","DXFilmEdge"],["ean_13","EAN-13"],["ean_8","EAN-8"],["itf","ITF"],["maxi_code","MaxiCode"],["micro_qr_code","MicroQRCode"],["pdf417","PDF417"],["qr_code","QRCode"],["rm_qr_code","rMQRCode"],["upc_a","UPC-A"],["upc_e","UPC-E"],["linear_codes","Linear-Codes"],["matrix_codes","Matrix-Codes"],["any","Any"]],RB=[...Ik,["unknown"]].map(i=>i[0]),Gy=new Map(Ik);function OB(i){for(const[e,t]of Gy)if(i===t)return e;return"unknown"}function NB(i){if(Rk(i))return{width:i.naturalWidth,height:i.naturalHeight};if(Ok(i))return{width:i.width.baseVal.value,height:i.height.baseVal.value};if(Nk(i))return{width:i.videoWidth,height:i.videoHeight};if(jk(i))return{width:i.width,height:i.height};if(Pk(i))return{width:i.displayWidth,height:i.displayHeight};if(Bk(i))return{width:i.width,height:i.height};if(Dk(i))return{width:i.width,height:i.height};throw new TypeError("The provided value is not of type '(Blob or HTMLCanvasElement or HTMLImageElement or HTMLVideoElement or ImageBitmap or ImageData or OffscreenCanvas or SVGImageElement or VideoFrame)'.")}function Rk(i){var e,t;try{return i instanceof((t=(e=i?.ownerDocument)==null?void 0:e.defaultView)==null?void 0:t.HTMLImageElement)}catch{return!1}}function Ok(i){var e,t;try{return i instanceof((t=(e=i?.ownerDocument)==null?void 0:e.defaultView)==null?void 0:t.SVGImageElement)}catch{return!1}}function Nk(i){var e,t;try{return i instanceof((t=(e=i?.ownerDocument)==null?void 0:e.defaultView)==null?void 0:t.HTMLVideoElement)}catch{return!1}}function Bk(i){var e,t;try{return i instanceof((t=(e=i?.ownerDocument)==null?void 0:e.defaultView)==null?void 0:t.HTMLCanvasElement)}catch{return!1}}function jk(i){try{return i instanceof ImageBitmap||Object.prototype.toString.call(i)==="[object ImageBitmap]"}catch{return!1}}function Dk(i){try{return i instanceof OffscreenCanvas||Object.prototype.toString.call(i)==="[object OffscreenCanvas]"}catch{return!1}}function Pk(i){try{return i instanceof VideoFrame||Object.prototype.toString.call(i)==="[object VideoFrame]"}catch{return!1}}function BB(i){try{return i instanceof Blob||Object.prototype.toString.call(i)==="[object Blob]"}catch{return!1}}function jB(i){try{return i instanceof ImageData||Object.prototype.toString.call(i)==="[object ImageData]"}catch{return!1}}function DB(i,e){try{const t=new OffscreenCanvas(i,e);if(t.getContext("2d")instanceof OffscreenCanvasRenderingContext2D)return t;throw void 0}catch{const t=document.createElement("canvas");return t.width=i,t.height=e,t}}async function Lk(i){if(Rk(i)&&!await qB(i))throw new DOMException("Failed to load or decode HTMLImageElement.","InvalidStateError");if(Ok(i)&&!await FB(i))throw new DOMException("Failed to load or decode SVGImageElement.","InvalidStateError");if(Pk(i)&&HB(i))throw new DOMException("VideoFrame is closed.","InvalidStateError");if(Nk(i)&&(i.readyState===0||i.readyState===1))throw new DOMException("Invalid element or state.","InvalidStateError");if(jk(i)&&GB(i))throw new DOMException("The image source is detached.","InvalidStateError");const{width:e,height:t}=NB(i);if(e===0||t===0)return null;const n=DB(e,t).getContext("2d");n.drawImage(i,0,0);try{return n.getImageData(0,0,e,t)}catch{throw new DOMException("Source would taint origin.","SecurityError")}}async function PB(i){let e;try{e=await createImageBitmap(i)}catch{try{if(globalThis.Image){e=new Image;let t="";try{t=URL.createObjectURL(i),e.src=t,await e.decode()}finally{URL.revokeObjectURL(t)}}else return i}catch{throw new DOMException("Failed to load or decode Blob.","InvalidStateError")}}return await Lk(e)}function LB(i){const{width:e,height:t}=i;if(e===0||t===0)return null;const n=i.getContext("2d");try{return n.getImageData(0,0,e,t)}catch{throw new DOMException("Source would taint origin.","SecurityError")}}async function UB(i){if(BB(i))return await PB(i);if(jB(i)){if(zB(i))throw new DOMException("The image data has been detached.","InvalidStateError");return i}return Bk(i)||Dk(i)?LB(i):await Lk(i)}async function qB(i){try{return await i.decode(),!0}catch{return!1}}async function FB(i){var e;try{return await((e=i.decode)==null?void 0:e.call(i)),!0}catch{return!1}}function HB(i){return i.format===null}function zB(i){return i.data.buffer.byteLength===0}function GB(i){return i.width===0&&i.height===0}function F2(i,e){return KB(i)?new DOMException(`${e}: ${i.message}`,i.name):VB(i)?new i.constructor(`${e}: ${i.message}`):new Error(`${e}: ${i}`)}function KB(i){return i instanceof DOMException||Object.prototype.toString.call(i)==="[object DOMException]"}function VB(i){return i instanceof Error||Object.prototype.toString.call(i)==="[object Error]"}var Zh;class Ky{constructor(e={}){uB(this,Zh);var t;try{const n=(t=e?.formats)==null?void 0:t.filter(s=>s!=="unknown");if(n?.length===0)throw new TypeError("Hint option provided, but is empty.");for(const s of n??[])if(!Gy.has(s))throw new TypeError(`Failed to read the 'formats' property from 'BarcodeDetectorOptions': The provided value '${s}' is not a valid enum value of type BarcodeFormat.`);fB(this,Zh,n??[]),MB({fireImmediately:!0}).catch(()=>{})}catch(n){throw F2(n,"Failed to construct 'BarcodeDetector'")}}static async getSupportedFormats(){return RB.filter(e=>e!=="unknown")}async detect(e){try{const t=await UB(e);if(t===null)return[];let n;const s={tryCode39ExtendedMode:!1,textMode:"Plain",formats:cB(this,Zh).map(a=>Gy.get(a))};try{n=await IB(t,s)}catch(a){throw console.error(a),new DOMException("Barcode detection service unavailable.","NotSupportedError")}return n.map(a=>{const{topLeft:{x:l,y:u},topRight:{x:c,y:f},bottomLeft:{x:d,y:p},bottomRight:{x:m,y:v}}=a.position,b=Math.min(l,c,d,m),y=Math.min(u,f,p,v),w=Math.max(l,c,d,m),C=Math.max(u,f,p,v);return{boundingBox:new DOMRectReadOnly(b,y,w-b,C-y),rawValue:a.text,format:OB(a.format),cornerPoints:[{x:l,y:u},{x:c,y:f},{x:m,y:v},{x:d,y:p}]}})}catch(t){throw F2(t,"Failed to execute 'detect' on 'BarcodeDetector'")}}}Zh=new WeakMap;globalThis.BarcodeDetector!=null||(globalThis.BarcodeDetector=Ky);const $B={finder:!0,torch:!0,tracker:void 0,onOff:!1,zoom:!1},YB={facingMode:"environment",width:{min:640,ideal:720,max:1920},height:{min:640,ideal:720,max:1080}},WB={width:"100%",height:"100%",position:"relative",display:"flex",alignItems:"center",justifyContent:"center",overflow:"hidden",aspectRatio:"1/1"},QB={width:"100%",height:"100%",objectFit:"cover",overflow:"hidden"};var qu=i=>i instanceof Date,Uk=i=>i==null;const qk=i=>typeof i=="object";var H2=i=>!Uk(i)&&!Array.isArray(i)&&qk(i)&&!qu(i),z2=i=>Uk(i)||!qk(i);function Fk(i,e){if(z2(i)||z2(e))return i===e;if(qu(i)&&qu(e))return i.getTime()===e.getTime();const t=i,n=e,s=Object.keys(t),a=Object.keys(n);if(s.length!==a.length)return!1;for(const l of s){const u=t[l];if(!a.includes(l))return!1;if(l!=="ref"){const c=n[l];if(qu(u)&&qu(c)||H2(u)&&H2(c)||Array.isArray(u)&&Array.isArray(c)?!Fk(u,c):u!==c)return!1}}return!0}function JB(i){const{onClick:e,disabled:t,className:n}=i,s={cursor:t?"default":"pointer",stroke:t?"grey":"yellow",strokeLineJoin:"round",strokeLineCap:"round",strokeWidth:1.5,...i.style};return P.jsxs("svg",{onClick:t?void 0:e,className:n,style:s,width:"28px",height:"28px",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[P.jsx("title",{children:"Camera Off"}),P.jsx("path",{d:"M3 3L6.00007 6.00007M21 21L19.8455 19.8221M9.74194 4.06811C9.83646 4.04279 9.93334 4.02428 10.0319 4.01299C10.1453 4 10.2683 4 10.5141 4H13.5327C13.7786 4 13.9015 4 14.015 4.01299C14.6068 4.08078 15.1375 4.40882 15.4628 4.90782C15.5252 5.00345 15.5802 5.11345 15.6901 5.33333C15.7451 5.44329 15.7726 5.49827 15.8037 5.54609C15.9664 5.79559 16.2318 5.95961 16.5277 5.9935C16.5844 6 16.6459 6 16.7688 6H17.8234C18.9435 6 19.5036 6 19.9314 6.21799C20.3077 6.40973 20.6137 6.71569 20.8055 7.09202C21.0234 7.51984 21.0234 8.0799 21.0234 9.2V15.3496M19.8455 19.8221C19.4278 20 18.8702 20 17.8234 20H6.22344C5.10333 20 4.54328 20 4.11546 19.782C3.73913 19.5903 3.43317 19.2843 3.24142 18.908C3.02344 18.4802 3.02344 17.9201 3.02344 16.8V9.2C3.02344 8.0799 3.02344 7.51984 3.24142 7.09202C3.43317 6.71569 3.73913 6.40973 4.11546 6.21799C4.51385 6.015 5.0269 6.00103 6.00007 6.00007M19.8455 19.8221L14.5619 14.5619M14.5619 14.5619C14.0349 15.4243 13.0847 16 12 16C10.3431 16 9 14.6569 9 13C9 11.9153 9.57566 10.9651 10.4381 10.4381M14.5619 14.5619L10.4381 10.4381M10.4381 10.4381L6.00007 6.00007"})]})}function ZB(i){const{onClick:e,disabled:t,className:n}=i,s={cursor:t?"default":"pointer",stroke:t?"grey":"yellow",strokeLineJoin:"round",strokeLineCap:"round",strokeWidth:1.5,...i.style};return P.jsxs("svg",{onClick:t?void 0:e,className:n,style:s,width:"28px",height:"28px",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[P.jsx("title",{children:"Camera On"}),P.jsx("path",{d:"M12 16C13.6569 16 15 14.6569 15 13C15 11.3431 13.6569 10 12 10C10.3431 10 9 11.3431 9 13C9 14.6569 10.3431 16 12 16Z"}),P.jsx("path",{d:"M3 16.8V9.2C3 8.0799 3 7.51984 3.21799 7.09202C3.40973 6.71569 3.71569 6.40973 4.09202 6.21799C4.51984 6 5.0799 6 6.2 6H7.25464C7.37758 6 7.43905 6 7.49576 5.9935C7.79166 5.95961 8.05705 5.79559 8.21969 5.54609C8.25086 5.49827 8.27836 5.44328 8.33333 5.33333C8.44329 5.11342 8.49827 5.00346 8.56062 4.90782C8.8859 4.40882 9.41668 4.08078 10.0085 4.01299C10.1219 4 10.2448 4 10.4907 4H13.5093C13.7552 4 13.8781 4 13.9915 4.01299C14.5833 4.08078 15.1141 4.40882 15.4394 4.90782C15.5017 5.00345 15.5567 5.11345 15.6667 5.33333C15.7216 5.44329 15.7491 5.49827 15.7803 5.54609C15.943 5.79559 16.2083 5.95961 16.5042 5.9935C16.561 6 16.6224 6 16.7454 6H17.8C18.9201 6 19.4802 6 19.908 6.21799C20.2843 6.40973 20.5903 6.71569 20.782 7.09202C21 7.51984 21 8.0799 21 9.2V16.8C21 17.9201 21 18.4802 20.782 18.908C20.5903 19.2843 20.2843 19.5903 19.908 19.782C19.4802 20 18.9201 20 17.8 20H6.2C5.0799 20 4.51984 20 4.09202 19.782C3.71569 19.5903 3.40973 19.2843 3.21799 18.908C3 18.4802 3 17.9201 3 16.8Z"})]})}function XB(i){const{scanning:e,startScanning:t,stopScanning:n}=i,[s,a]=jt.useState(!1);function l(){a(!0),e?n():t(),setTimeout(()=>a(!1),1e3)}return P.jsx("div",{style:{bottom:85,right:8,position:"absolute",zIndex:2,cursor:s?"default":"pointer"},children:P.jsx(e?JB:ZB,{disabled:s,onClick:l})})}function ej(i){const{onClick:e,className:t,style:n}=i;return P.jsxs("svg",{onClick:e,width:"30px",height:"30px",viewBox:"0 0 24 24",className:t,style:n,xmlns:"http://www.w3.org/2000/svg",children:[P.jsx("title",{children:"Torch Off"}),P.jsx("path",{strokeWidth:.2,stroke:"yellow",fill:"yellow",d:"M14.516 15.158l.714.714-4.595 6.14-.75-.364L12.337 13H6.978L8.22 8.861l.803.803L8.322 12h3.036l1.793 1.792-1.475 5.16zm5.984 4.05L4.793 3.5l.707-.707 3.492 3.492L10.278 2h7.972l-5.025 7h7.149l-3.71 4.957 4.543 4.543zM12.707 10l3.243 3.243L18.376 10zM9.795 7.088l2.079 2.079L16.3 3h-5.278z"})]})}function tj(i){const{onClick:e,className:t,style:n}=i;return P.jsxs("svg",{onClick:e,width:"30px",height:"30px",viewBox:"0 0 24 24",className:t,style:n,xmlns:"http://www.w3.org/2000/svg",children:[P.jsx("title",{children:"Torch On"}),P.jsx("path",{strokeWidth:.2,stroke:"yellow",fill:"yellow",d:"M13.225 9l5.025-7h-7.972l-3.3 11h5.359l-2.452 8.648.75.364L20.374 9zm.438 3H8.322l2.7-9H16.3l-5.025 7h7.101l-6.7 8.953z"})]})}function nj(i){const{status:e,scanning:t,torchToggle:n}=i;function s(a){n(a)}return t&&n?P.jsx("div",{style:{bottom:35,right:8,position:"absolute",zIndex:2,cursor:"pointer"},children:e?P.jsx(ej,{onClick:()=>s(!1)}):P.jsx(tj,{onClick:()=>s(!0)})}):null}function rj(i){const{onClick:e,className:t,disabled:n=!1}=i,s={cursor:n?"default":"pointer",stroke:n?"grey":"yellow",fill:n?"grey":"yellow",...i.style};return P.jsxs("svg",{onClick:n?void 0:e,width:"30px",height:"30px",viewBox:"0 0 24 24",className:t,style:s,xmlns:"http://www.w3.org/2000/svg",children:[P.jsx("title",{children:"Zoom In"}),P.jsx("path",{strokeWidth:.3,d:"M16.279,17.039c-1.396,1.209 -3.216,1.941 -5.206,1.941c-4.393,0 -7.96,-3.567 -7.96,-7.96c-0,-4.393 3.567,-7.96 7.96,-7.96c4.393,0 7.96,3.567 7.96,7.96c-0,2.044 -0.772,3.909 -2.04,5.319l0.165,0.165c1.194,1.194 2.388,2.388 3.583,3.582c0.455,0.456 -0.252,1.163 -0.707,0.708l-3.755,-3.755Zm1.754,-6.019c-0,-3.841 -3.119,-6.96 -6.96,-6.96c-3.842,0 -6.96,3.119 -6.96,6.96c-0,3.841 3.118,6.96 6.96,6.96c3.841,0 6.96,-3.119 6.96,-6.96Zm-7.46,0.5l-1.5,0c-0.645,0 -0.643,-1 -0,-1l1.5,0l-0,-1.5c-0,-0.645 1,-0.643 1,0l-0,1.5l1.5,0c0.645,0 0.643,1 -0,1l-1.5,0l-0,1.5c-0,0.645 -1,0.643 -1,0l-0,-1.5Z"})]})}function ij(i){const{onClick:e,className:t,disabled:n=!1}=i,s={cursor:n?"default":"pointer",stroke:n?"grey":"yellow",fill:n?"grey":"yellow",...i.style};return P.jsxs("svg",{onClick:n?void 0:e,width:"30px",height:"30px",viewBox:"0 0 24 24",className:t,style:s,xmlns:"http://www.w3.org/2000/svg",children:[P.jsx("title",{children:"Zoom Out"}),P.jsx("path",{strokeWidth:.3,d:"M16.279,17.039c-1.396,1.209 -3.216,1.941 -5.206,1.941c-4.393,0 -7.96,-3.567 -7.96,-7.96c-0,-4.393 3.567,-7.96 7.96,-7.96c4.393,0 7.96,3.567 7.96,7.96c-0,2.044 -0.772,3.909 -2.04,5.319l0.165,0.165c1.194,1.194 2.388,2.388 3.583,3.582c0.455,0.456 -0.252,1.163 -0.707,0.708l-3.755,-3.755Zm1.754,-6.019c-0,-3.841 -3.119,-6.96 -6.96,-6.96c-3.842,0 -6.96,3.119 -6.96,6.96c-0,3.841 3.118,6.96 6.96,6.96c3.841,0 6.96,-3.119 6.96,-6.96Zm-4.96,-0.5c0.645,0 0.643,1 -0,1l-4,0c-0.645,0 -0.643,-1 -0,-1l4,0Z"})]})}function sj(i){const{scanning:e,capabilities:t,onZoom:n,value:s}=i;if(!e||!n)return null;const a=(t.max-t.min)/3;return P.jsxs(jt.Fragment,{children:[P.jsx("div",{style:{bottom:130,right:8,position:"absolute",zIndex:2,cursor:"pointer"},children:P.jsx(ij,{disabled:s<=t.min,onClick:function(){n(Math.max(s-a,t.min))}})}),P.jsx("div",{style:{bottom:180,right:8,position:"absolute",zIndex:2,cursor:"pointer"},children:P.jsx(rj,{disabled:s>=t.max,onClick:function(){n(Math.min(s+a,t.max))}})})]})}const Ia={fullContainer:{width:"100%",height:"100%",position:"relative",display:"flex",alignItems:"center",justifyContent:"center",overflow:"hidden"},innerContainer:{width:"100%",height:"100%",display:"flex",alignItems:"center",justifyContent:"center",position:"relative"},overlay:{position:"absolute",top:0,right:0,bottom:0,left:0,pointerEvents:"none",display:"flex",alignItems:"center",justifyContent:"center"},borderBox:{position:"relative",width:"70%",aspectRatio:"1 / 1",border:"2px dashed rgba(239, 68, 68, 0.4)",borderRadius:"0.5rem"},cornerTopLeft:{position:"absolute",width:"15%",height:"15%",border:"4px solid #ef4444",top:0,left:0,borderBottomColor:"transparent",borderRightColor:"transparent",borderTopLeftRadius:"0.5rem"},cornerTopRight:{position:"absolute",width:"15%",height:"15%",border:"4px solid #ef4444",top:0,right:0,borderBottomColor:"transparent",borderLeftColor:"transparent",borderTopRightRadius:"0.5rem"},cornerBottomLeft:{position:"absolute",width:"15%",height:"15%",border:"4px solid #ef4444",bottom:0,left:0,borderTopColor:"transparent",borderRightColor:"transparent",borderBottomLeftRadius:"0.5rem"},cornerBottomRight:{position:"absolute",width:"15%",height:"15%",border:"4px solid #ef4444",bottom:0,right:0,borderTopColor:"transparent",borderLeftColor:"transparent",borderBottomRightRadius:"0.5rem"}};function oj(i){const{scanning:e,capabilities:t,onOff:n,torch:s,zoom:a,startScanning:l,stopScanning:u}=i;return P.jsx("div",{style:Ia.fullContainer,children:P.jsxs("div",{style:Ia.innerContainer,children:[P.jsx("div",{style:Ia.overlay,children:P.jsxs("div",{style:Ia.borderBox,children:[P.jsx("div",{style:Ia.cornerTopLeft}),P.jsx("div",{style:Ia.cornerTopRight}),P.jsx("div",{style:Ia.cornerBottomLeft}),P.jsx("div",{style:Ia.cornerBottomRight})]})}),n&&P.jsx(XB,{scanning:e,startScanning:l,stopScanning:u}),s&&t.torch&&P.jsx(nj,{scanning:e,status:s.status,torchToggle:s.toggle}),a&&t.zoom&&P.jsx(sj,{scanning:e,capabilities:t.zoom,value:a.value,onZoom:a.onChange})]})})}function oh(i){if(i===null)throw new Error("Canvas should always be defined when component is mounted.");const e=i.getContext("2d");if(e===null)throw new Error("Canvas 2D context should be non-null");e.clearRect(0,0,i.width,i.height)}function aj(i){const{onScan:e,constraints:t,formats:n=["any"],paused:s=!1,components:a,children:l,styles:u,classNames:c,allowMultiple:f,scanDelay:d,onError:p,sound:m}=i,v=jt.useRef(null),b=jt.useRef(null),y=jt.useRef(null),w=jt.useMemo(()=>({...YB,...t}),[t]),C=jt.useMemo(()=>({...$B,...a}),[a]),[S,x]=jt.useState(!1),[k,A]=jt.useState(!0),[R,I]=jt.useState(w),U=(function(){const B=jt.useRef(Promise.resolve({type:"stop",data:{}})),z=jt.useRef(null),$=jt.useRef(null),[V,Z]=jt.useState({}),[ae,Ae]=jt.useState({}),be=jt.useCallback(async(Me,Ie)=>{if(!window.isSecureContext)throw new Error("camera access is only permitted in secure context. Use HTTPS or localhost rather than HTTP.");if(navigator?.mediaDevices?.getUserMedia===void 0)throw new Error("this browser has no Stream API support");const Ce=await navigator.mediaDevices.getUserMedia({audio:!1,video:Ie});Me.srcObject!==void 0?Me.srcObject=Ce:Me.mozSrcObject!==void 0?Me.mozSrcObject=Ce:window.URL.createObjectURL?Me.src=window.URL.createObjectURL(Ce):window.webkitURL?Me.src=window.webkitURL.createObjectURL(Ce):Me.src=Ce.id,await Promise.race([Me.play(),new Promise(et=>setTimeout(et,3e3)).then(()=>{throw new Error("Loading camera stream timed out after 3 seconds.")})]),await new Promise(et=>setTimeout(et,500));const[ot]=Ce.getVideoTracks();return Ae(ot.getSettings()),Z(ot?.getCapabilities?.()??{}),z.current=Ce,$.current=ot,{type:"start",data:{videoEl:Me,stream:Ce,constraints:Ie}}},[]),Ge=jt.useCallback(async(Me,Ie)=>{Me.src="",Me.srcObject=null,Me.load();for(const Ce of Ie.getTracks())Ie.removeTrack(Ce),Ce.stop();return z.current=null,$.current=null,Ae({}),{type:"stop",data:{}}},[]),Te=jt.useCallback(async(Me,{constraints:Ie,restart:Ce=!1})=>{if(B.current=B.current.then(ot=>{if(ot.type==="start"){const{data:{videoEl:et,stream:me,constraints:de}}=ot;return Ce||Me!==et||Ie!==de?Ge(et,me).then(()=>be(Me,Ie)):ot}return be(Me,Ie)}),(await B.current).type==="stop")throw new Error("Something went wrong with the camera task queue (start task).")},[be,Ge]),ve=jt.useCallback(async()=>{if(B.current=B.current.then(Me=>{if(Me.type==="stop")return Me;const{data:{videoEl:Ie,stream:Ce}}=Me;return Ge(Ie,Ce)}),(await B.current).type==="start")throw new Error("Something went wrong with the camera task queue (stop task).")},[Ge]),ke=jt.useCallback(async Me=>{const Ie=$.current;if(!Ie)throw new Error("No active video track found.");{Me.advanced?.[0].zoom&&Ie.getCapabilities().torch&&await Ie.applyConstraints({advanced:[{torch:!1}]}),await Ie.applyConstraints(Me);const Ce=Ie.getCapabilities(),ot=Ie.getSettings();Z(Ce),Ae(ot)}},[]);return jt.useEffect(()=>()=>{(async()=>await ve())()},[ve]),{capabilities:V,settings:ae,startCamera:Te,stopCamera:ve,updateConstraints:ke}})(),te=jt.useRef(U),G=jt.useRef(p),Y=jt.useRef(C.tracker);jt.useEffect(()=>{te.current=U},[U]),jt.useEffect(()=>{G.current=p},[p]),jt.useEffect(()=>{Y.current=C.tracker},[C.tracker]);const O=jt.useCallback(B=>{(function(z,$,V,Z){const ae=V;if(ae==null)throw new Error("onFound handler should only be called when component is mounted. Thus tracking canvas is always defined.");const Ae=$;if(Ae==null)throw new Error("onFound handler should only be called when component is mounted. Thus video element is always defined.");if(z.length===0||Z===void 0)oh(ae);else{const be=Ae.offsetWidth,Ge=Ae.offsetHeight,Te=Ae.videoWidth,ve=Ae.videoHeight,ke=Math.max(be/Te,Ge/ve),Me=Te*ke,Ie=ve*ke,Ce=Me/Te,ot=Ie/ve,et=(be-Me)/2,me=(Ge-Ie)/2,de=({x:at,y:ye})=>({x:Math.floor(at*Ce),y:Math.floor(ye*ot)}),Be=({x:at,y:ye})=>({x:Math.floor(at+et),y:Math.floor(ye+me)}),Je=z.map(at=>{const{boundingBox:ye,cornerPoints:it}=at,{x:Mt,y:nt}=Be(de({x:ye.x,y:ye.y})),{x:Zt,y:j}=de({x:ye.width,y:ye.height});return{...at,cornerPoints:it.map(W=>Be(de(W))),boundingBox:DOMRectReadOnly.fromRect({x:Mt,y:nt,width:Zt,height:j})}});ae.width=Ae.offsetWidth,ae.height=Ae.offsetHeight;const rt=ae.getContext("2d");if(rt===null)throw new Error("onFound handler should only be called when component is mounted. Thus tracking canvas 2D context is always defined.");Z(Je,rt)}})(B,v.current,y.current,Y.current)},[]),{startScanning:N,stopScanning:Q}=(function(B){const{videoElementRef:z,onScan:$,onFound:V,retryDelay:Z=100,scanDelay:ae=0,formats:Ae=[],allowMultiple:be=!1,sound:Ge=!0}=B,Te=jt.useRef(new Ky({formats:Ae})),ve=jt.useRef(null),ke=jt.useRef(null);jt.useEffect(()=>{Te.current=new Ky({formats:Ae})},[Ae]),jt.useEffect(()=>{typeof window<"u"&&Ge&&(ve.current=new Audio(typeof Ge=="string"?Ge:"data:audio/mp3;base64,//PkZAAhghE0AKToAJra/n0FQygAAAGIkYJgmCYXBMAAGCTJz3zhCEM//z//1hz//8MMMMN08ssV6e5DDWIQreAgCvFKy8bXgIKMkUDDBgzJwIBtkRMQAocxIFdxghQGKDoEziAzQxOBOdH92i/iGi+zDCAEIX46a73HrSybZw1x3JZjXp7dSNy/P68rjcbt7p7fakMP5LVMyzCaj1pjvejYYAIDgDGzECjEAk1Jl3559HIon8hzlfPVTCvGJZzfcKSxXfyMWM88//9VKSxXdtnb9vomOuuRyiWVYbf+X8zp6fKGHIdycuWMMMMMMKSnp+6wsYc/9f/7z7rPPWHN556p6fP8MMMP///PPP/7+GHK9PT6p7f/unldP2np7YeHjweiYA4GLNAgAiI7u57n5//oc5/yfk6znOcPhwOBwggHCMpA4HA4KEyHOc5znO+hPIc5//+fqJh8XQPh90JU5xQinOf//87/zvP+ggAYuhCKHxdA+Hxd0EA4KKHA4ciB3kOXfXB/gmf8p/B96lAMKAgAADU+BujARHgwdisgHMfAUHAiceBg4ASBgZBiBIBH4ZaHOJsLhf8R+HYEciIgYSwj/+Bi7EqBh+AcBn5P6Bh4TuBmrAMBiZH7gaLEWgew//PkZFMlyek60MpYAShzqqZhm6gCUWeEUWAewEWYGN4X4GDEPwGE8S4GDoOIGAYKgIQOkz//gGARAUB+CwGxTwMAACAEgyAwdAlAxKhzAxXiZ///AxcEwAwJjDAziCAAwQgdAwRgdAsJQDAmAcGzYDwAhZIAKAcIQB4GT9TQMJ9/4Gi1Fv/AcAYUqKBAwGgNAwVBAAwGhwAwdBlAxFg1AwlgzAwNBuAkJQDBgEEDEqGECgChFgBgL//CIswYYH//+HKCpk4K0C9AaKKCAOBeMcR4X9C44BwABCgGAsGYCgTwHAcAwXAiAwSAQV///CJP9lwMBQAwAAAWGo5lVLCcaeneVhJAVGai3//ioaUEf//gaTAYGCj8BnEwfrIqDcsIQb/vmhU/8fAs0G8YGGwKST8Igj4GCATipksVzY8p//90FWJwh45AkX//4fCF9wMEgkL3uQc+gbGJ8t4MBAMBP/hEXf9FRuWBcAfIFjYzQdoLCBwh7IWVlxaX/w8oMCP/+EQT5poGB1Ir90DhiV6af/jFYBpT2BgoQyyt2M0ToBdEaZyzt8nTo3xdNDCTSd//o6F06CjooxRr4jVF/0bOKD6OMUNDRxiMUVFR0FFQPhGXRjDpr4MAEA4wIQUhYOIw//PkZE4nrg08sOx4ACQ0CopD2aAAlwTTBxQeMcwd8w8gZTAgABXwGABOkzpI0wAQAExnWfP4x8ZjKunWdZ1o1Qe6lFGKCNULORQCELAAPnRUf/GIx/0FHGfo3SdZ0qP2cukXKLlRtBKFgAQwCkwJgFRYBEEATmDsLSY2QiQYCEnEra+UZo6F1aKMRr6GhoaP/+j//ov+i+hjLqBgMkYoqChoo1GqCjoY06TpRqjjLOYzRRmMuizmgdKhdF8kjTAAAPMCwGswzglgwAJfzqxmioKH/////////////+ijLOAwFmN0f/////////Q///8ZjP/9DGYyFwIDBeB3MA4AlBWidKM5spykAUAQOCakK+udGqN8VDYjTRuN//0bVX//6Kio4xQFv//nf//kKOoAEIB6SY6hcxenp85///4/DEPf/84Xvl4vF4dwtxfEJgCYQHMSgKCROp4+fn////L4tQf0unz89OecLxeL0ul09y6enzp4dIhKAQFA5hKfLu1nU7/Wr71rRKJUBQSUVt////l08GUPVWgAAYAeNKsxbQNAAhQx3/oKGMM6dZ1Yy6sajMbfKio7lNcv0sScZ47lNcw32ekVFMP9fp/f+mklI6at6u/dBMQuW6y+C5BcgwAA//PkZEomGg1HYGe0riWsCqbEwiY0BJFJMxrCcxGgQ2VK8xxCF1wsABgQBBgQBAYAFCkYCgALkK4fJ00E5ctJN1Uxy5au3XoGcM4dSN0EYZwzhW0WCh1PZwzhnFFQxtnbO2d0Kt6CdXbruggkTEX5Rs4TEQUVsdVXaCcuWXIBQUGmwmgoAGcJiM4dSioHQdBnEY+hjcbov//jcb/43G43G/jCRibfxugdBnDqULO2duvQumztncbo4xGKKNxugooxGIxQULoOgFgUMTA/jbrxiMDmETL+eLhcPThzOeeOZfL5fIcBYuXD/OHv8t//LJFxjxQYHHKDGFkZMtlmKM0RgQfbVtxFIHbQBDRuzRguEI1c9XZ/rWmrZfVU3Oc/9utNNygRQkCoHlAYstNN6DJ1IINpoINppv+WG/+g2mmnUmmmpBAoJIJhnwB5xkymn606Df/t000xhU03UXC5Ol8uFyXy+Xy/l8v5w4cLk4XAvwAYUvl/QL5fTdlKZkEEEEGumaKaX00zIOemf6CH///ywI3LKpiQ2Ef4xYWMSDyI0XwzikpL0ajVHZ3j9DGIjeuXcNfjn96/S/TUz/X/vX////5K/r+v7Jn+LlAoGZOIQIwMKBQM/yppKYURmhGZkR2b//PkZE0mHg1HEG8wyiD7mlwAyDU8nJHi5htakZmZGNiRcpkJhBmUmZYQcM1VDEEBggNDV/ASEZRYKFZIhkXKLlKmk7IVTKmZNJ5KhiqVUqpX+k7+qlVKyV/ZIqZDFDWTJlFyi5TJpKhiXKBQyZzIS5JhBoayV/AQWVpGWkcYTV5O/rIVSv8/0nkr+v6/vyR/X9f1/ZN8kf5/n99/n+f5/lTKmf9/mRP8yFUqpWSv4yJUqpX9kj/MmZNJ5K/z/P9J5P/v6yFUz/CEoywgUMqZkz/FssECIsVq0aPRrRRatFFFykQZJ2Ukl///5KjmksOaA7ALROJLDnEsLbq3GTMVrwb/0dGzmM0DlfBlHQOmrdR0MYi92TX6b/cmDHLclyUVYO/4O8sFTKFTKFf8yhUyhUyhXzKlDKlCsr/+ZUoVlSsr/+ZQqZUoZUoceMfcoZUoZUoVlfOPGcmDHKcpynKg9yXJcr3JclyXJclyYO+DXJclyfgxFZVb3KcqD/g2MxzsY72L9LubPR0dCyf5K5NNd+Tv9GXRdV0XJclyfcl/n+k8kf6SX/iVynvXf///4Mg/1OkxguYzmM5jMcLHMxwwGhgNCwXMLAcwMXTLi1MD7w7tmTdBvMmE0xQFzCwHMDAd//PkZGMpigkmAGOUvCfTgcgAuC+ITswMFzC4oMLhYMByn0xvU+p9Tr0xUxf/0xv///1PBYDhgNTFTFTGTGTGTGTGTGTGTGC4GTFMDAcLAdMVMVMULAcMBpgYDhcDGFwsYXFBikLGFwMGA4MBxgcDKfTEMUoAx2BisD+mKp5Tv1OkxkxkxkxkxkxkxkxlO0xVPJi/6nv////U7CwHTFTFTGTGTGTGU+p71PpjJipihYDpipi/6n1Ov//C4GC4GTGTGTGTFU8WBSZdLhWB//yKlotyLZFiLf8tyyRUipFSKkVGRBZQMiWC3yx//wxUGKsSvDFQGHUAL3QMsHDFIYpCYy2Bmagy6BjLgy6Bh3od58DCLAizBgRb+EQiyEQiwGBFuDAi3/////20QqSBJf/qcumv/////wMZdGXAYMu1gYy6MuBEZdBgy4BjLgy6BjLgy6BjLgy6BjLQy6DBlz2cJDLgRGXAMZdGXAYMuhMZcCIy6sJGaoGMuppwNRl3WBjLgy63wiEWAwIt/+EQi0IhFsDCLAi0GBFkGBFgMJCqaqYAgAYIhBBvwf7kwcqRq7V3IctacvlN6NxqgooxRRuNRiijEZjMGRuMvz9FGozQ+1X2qe1T1S//+VhaWAtKwtML//PkZEIkbgcaAHc1xCJrjeAAtfuUAtLAWf///mWePH95ZFgsyssvM88+jzO6K+z7OM48sH+WDiweZx5YOK+zxWLGJWsa6xadAv02fTZLSpsFpvLSga0tMgWgUgWmwgUmyWl8tMgWWmLSoFJsoFlpSwsmyBg4HhEdgwHAYPBwGDgeBg8HwMHg4DB4PBgOAwcOwMHLwDn5lAwcDgiDgYDwMHA/4MB3//+EQeDAdwiDwYLPhEWQYLODBYERZBgt8Ii34GLBaB5pfAZ0FvEAQ/UfwxULlx+IXx+8f5CELH8fxKhAIDFoHBEDRc3////gwHgaRXgMHYMB2EU/gwZ/gYbw3gY3QbgYNgbgYiAbgwN3/+EQbBEG4MBuDAbAwG4RBtAwbg2////+B9B6F//////////hEdD//////////8DRahEQGCInMNg3LBElgNjDciCwG/lgNiwGxWG///mG4bf/+WA3Kw3KyIMNw2Kw3MNg3MNg3MNiIMiQ2OK0xMiA3KyJLAEZgRARmBEDEYFwBBgEgEeomowol5YAJKwCDAIAJ8sAE+gGBgCJYAQUZ/13LubMu5dyiYOAhKwEFGf9AOoz/g4CFAIol/lgAjysAgsAElYBP////lgJksBM//lgRUxF//PkZGApggsIAHt2wiNLoggAqCz8RFSwIqYioipkjEjHCCSN/+WJg5iYOYmPK5krmTmZk5mZ8sTJYmf8yJiNiIisi/ywRmRkZkZGZGRmRERkREZERGRERkREZERGxEf///hETIMEyBiZEyBiZEzwiJgDEwU4DV2gQGFOBgmP8GAiAwRAiBgIgYCIGAi/4MBHAwRgjAwRgjwMEQIgMcgY8DBGCMDBGCMDEyJn///+BiYQIBlObj4eYLIwsjAOBGFkYBoEQ84eULIw88LIA88PKHnw8sPKFkeHlANAiAaFUDAiMYPIHmDzBZBhZB///8GBOA1sH/Awni7AwnhPCITwYE/CKzBgt8Ig8GA4Ig6EQdww4Yb+F1sIgtwYCwGAsAwWAsBgLAYCwDBYCwDBaHUDF+VEDKgC2BgtBaDAWgYLQW////gYLAWQMFgLAMFoLcGAt////4RMABmBSj4NgwMOGHBsHhdcLrwbB4XXC6+F14YcLrww4Ng8MOGHBsHww4Ng8AUC4AoMQMC4fgw3wutV4QIsAgFYIBWCCVgHeVgHeWABCwAIVgH+YBwB5aRAstKgV6Ba1oMg9avtUVN/qdLWciD/cqD3Jg6DFPuTB/////lYAn//mC8C+YLwL5gvgvGC//PkZFEpLgMKYXt2xB5LogAArbdc+C8VgvlYL/mC8C+YLwL5YBfMNgNkwXixDWoHPMc4VUxVA2TBeDZPYXzXl815fK14sLxYXvK1//NeXzXl815fMtdDLSw3UsMtLCstMtLDLSwsFhWWlgt//8sFhW6f/////+WF7zXl8sL5ry+Vrxry+WF/wMLwX4MC+EQv/AwvBfAxsjYAyqpKA0lpLAwvBfBgXv///4RA2DANAYGgNgYGgNgYGwN+EQvf/BgXwYF//8DC+F4Dd6NgGBf4AgFwbB0MMF1wuuDYMBsGwusDYOBsHA2Dvg2DQuuDYOhdcMMF14YYDGYDEGwfhhgbB0MN///4RBaEQWgZByoYRWYMFvwiDsGwaF1gbB34GDwdC64XW/w1aKxDVgatir4YcLrQbBwNg7////////////+ESfgZPyff/////////4MFmBvvMAERZ8CC5adNj02E2S0qbCBSBZaYtN///oFlpU2QMXIFAYuQK9AtAo7IxLTpsIFJs/5aZRxQawaxGfIg9CsrI+PUqkWdOHp7ODsOl6cOHZ4dsulfLI9/8BAAgMBACsBLACVgBjoAWAE5OTM6WDAR0zodMdHCsJLASWAjzCQgsBJhASWAjysI8wkJMICU//PkZFkeqgcaYDd1th6DogAAqCuIxQwtDA5MdMULgyY6YqnXqdep5TpMdMVRNRL/UT9AN6jCiSjKAZRNRhAMomgFQDfCIJwYCQiCAiCMGAkGAgDBJUA3eVAMEgj////8SrDFIYqh5g8kPMHkDzB5OFkYeYPJ+HlDzB5+AYVQDibCyIPLLEZIsjIliWS0WywWyyWuWCyWJaLZbLJYDHgLAItFvy3///4eYPKBlQTh5QYEODBb//hhoNg7/C62DYPFUKwKsVgNWBq8VkVcVkVUVYrH//hGff/8Iz8GT7//////wiX4ML3gwvgwvf4ML3gZeqoHVGyBl4vgZfL2F1oNg4Lrg2DcLrg2DQw0Lrhh8Lr4YcMNBsGhdcGBcMOGGAFGAGMQsF1guuGG4XXV/4uQXOLmF1kL/8lCXkuSk4O8/FzHzuP0hIucf/CIFAMCgFPgYFAKAwCgGBQCgGHYO4GBVM4GgQI4RCMEQKQOtQjUI1CNcI14MqDKwDIAGQDzh5wsjDyw8uHmDzYeUPN+DEYRRhFEIowYgDQgIhWDApgwKAwKQYFAYFQMKkYDOxHAzsRgMKBUGBX/h5v+Hm4ecPNh5A8wBwjhZHhZAHlDzBZAFkAeQPKHnCyILIAsih5QsgDz//PkZLQgIgsMAFp1xCGLogAAA2rkB5w8oeYLIQ8kPMHkCyGHnAMKoGmAgFkUPMHmDYAtfHPHNkr/JYl8c8lCWHPHMkqSo5onMAkBDnfJX//8IgDBgBhEdAaxSQMHUGAEIgAV4risCcipBOMVRVBO////hEvAxsAwvf////8MPDDww4XWC64XXDDww4YcMPC6wYb/wYGgiGwMplMDYhTCIaCIaBga/////8GA+EQdgYPB4MB4GDwdhEH8Ig8Ig8GA6EQcEQf8DBxlBjoAweDuFwgCQXiL//iLiKCKCL4XCiKRFwEgoRT4iqpMQU1FMy4xMDCqqqqqqqr////xuDd8fv/DVwrArEIg6EQdhEHAYPBwMB+ERYBi0WAwWAZ0FoGLYOB+JfgZ0FoGdBaDBYbn+WHm9xW7/Nzzc83PLDzc8reWlA7S0oHamx//6BflpU2C0qbBaf/8yk/ysn+VkMhTKQrKVk8yE8rIVkKyYsAn/5WC+YICmCApWCGTkxtKMcVWlgFMEBTBAX////0C0C0C/////////LTFpvTZLTlpv/0Ci0xaYtOgWmymyWkAxcWmTZTYTY8tMmygUWmLTIFpsFpv9NnywLmLCx2RgWmQKTZ98UjnzZ1/++D4M6/////3//PkZOgjIg8IAFcbxCaTogAAoCuIzfJ8vfJ8Wcs5fBnD5//++L5f////////6nCKv//+o0o0FUYwqDNGCwgUMKC0VVGkVv//4Yf8LrxVCriqDVoasDVuKsNWw1bisBqwVkVkVX//gy/4YYMMGGhhgwwNg4LrhdcLrAYWGAA0zBsH4Ng3C6/////4MAoGBQIDAKBgUCAwCgYEAsDAoEAwKBAYBYMAoGBQIBgUCYGBQIBgUCwiBAYBYMAoRAgRAoGBBMBooCAYFAkIgTEUxFv/EWxFxFhFoi0LhQuFiLCL/EWqTEFNRTMuMTAwqqqq//////8TWJriV/hERAwRgYiEYGIhGBmIRgYiEYMEQMEcDMSiA1GYwMR+UDMTkA7KIgMRGIGGM0SIrRGjRlhEV4jxov8rR/5YRFhEdQSViCsR5iRJWIKxPlgQYgSViSsR5WJMQJLC78IiKERF4REeERGEREERHwMRGOBmIRhERhERAwRAYiEQGIhGBmIRAajkgG5TEEREDBHwYIwYI4REXCIV/4MCmDArgwKAYUO/gYVCkGBUGBTgYUCsGBUIhUDCoUCIVBgVBgVBgUhEKQMKhUDCoUBgVAwoFAYFcGBQDI6oA5+qQiFAMjBUGBXCyEPIFkOH//PkZPMj6gr6AFdVwifkBdwAoC2Ilh5/8PPh5Qsih5IeUA0TAZrE8PP////wMRiIIqID8piAxEIwMxCMDEQjCIj//BiIDRo8Iogii/4MKwYVhEoESkDEiIGJEgYlfBgmDBIMEAYgSBiBIREAwSERH/8I7wPfuCO4I7v/8GBvAw3Bv/////gwN34RBuBg2BuBg2BuBg2BuEQbhEG+EQbAwG4MBtwiDaDAbhEGwMBuDAbAwG4GDYG8DBsDcDBuNwDRWDcIg2AwbA34RBv///CINvCINgMRIN/////wiG4DDeG+TEFNRTMuMTAwqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqq/zB4OLAP8rBxWDisHlYOKxb5WLTFgsMWiw18LDOnjPxZoxadDOgsLAtLAbKymVhsrDZWG/LAb8w2GywGysNlgNFgNGFwuBQuWnTZLToFFpisLJsFp0Cy0voFAQLFZkMCAQwIBCsC/5WBCwBCwBCwBCsCeVgUwIBCwBDEwEMCAQrAhgUClgCFgTlgCGJgJ5gQTGJwKWAKYFApgQTGBQL5kY0HMjQYnAhWJvKwIWAIVgQrApYAhWBPBgECIEBgE/8IgXhECQiBAMCkcDEwEwMCAQGAQIhoIhsGBsIhvgwN//PkZN4irgr2AAOVqiUThegAnCtMgwNwiG/8IhuDA1hENhENgYbKYHb2IBhoNhENAwN////8IhsDKZS////8IhuBhspgc0KQRDWEQ3///CNf4GAIMDAwgAwAAwhAwAwYAIgwiHBgAMAYGAAGHv///CIBqBqESDEIgRYGoGHBiDEIgGoGgMAYgxgwgxCIETwYFYMCoMCuDApBgU8DCoU//gY3G//wYFOBhUKBEKQYFfBgV8IhSEQoBkYK8IhT/wMKhXBgUCIU4RCoRCvgYVCsDCp3A1SqAYFAiFP////gY3G1TEFNRTMuMTAwVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVgwCAwCBEC///////8IgUIgWEQIBgUCAwTQMCAQDAoEhECAYFIwGaRMBotWAasdwH/KqBmhFgaKI4GRgKVpjCBTCBPMJHNMFMIFKwnlgJ5hUxhUwGWlpAMuMuWLTFpvQKQLQKLTIFJsoFIFFZb/8woQwoT///MIF8rC+WAphAphAppgpYClgsmwBC6bHoFFpUCi0wGXFguWCwFLgUsgX6BZaVNj0Ci03//+EQKEQKEQLCIFAxMBcDAgFAwIBQYBODAKBgUCAYEAuDAKBgUCAYFAgRAngwCgwCwiBIRAmE//PkZN4iogj2AFdVxiUrhewAhOkwQIBgQ0gbOI4GRhOBiYCgYEAv////CIFAyMBQYBf///CIF8IgUDAgFBgEAwIRwMCCcDEwFAwIBf///CIEQGMDGEXCKBpCIDCEQDCAsYInDFQMMAuYSoTQMVfBlf//+DKfBgAiGDAQMIMIgCIQYADAEGAgwP////8ItgNu2/8DAAAiABgHhECBgQGEQARA8GAeEQIMABECEQIMAwYBBgCDAARA4GAAgYACDAARAwiAgwDhED4RABEBCIGBgDoH2dgZwCBgAP//BhX/+DCiTEFNRTMuMTAwqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqF1ww////////hdeGGDDBhwjeF102E2fTYAowMLjE0zTDfyyMYjEDJTwMLSwFi0/gQLoFIFpsegWmyBQsWlQL9ApNgtIWn8tMgX6BaBX+WmQL9Nn02f9NktIgUgWmwWl9Avy06bCBSbJaUtImyWkQKLTIFgYWoFFpAKFwMLzZgwAwvLTIFlpU2fQLQK///4Yf4YaF1sLrg2DAuuDYNDDQw4NgwLrhh4XXC64Ng3C60MNwbB4XWC64YcMODYPCJYDlMQBlwRLg2DOF1v/////PkZM0eKgz0AE+UuCnLFfAAk3Fsg2DAYX/ww//4YaGGDDhdbDDACFwMuXA2DADlygusDYOBsGhhv//wNU/CKQusF1oXX+F1wuuGGC6wXWDDBdbC6wXXhHv//4AHIFgC0BZAA4Ba4FkADwFsC3AtQAOcC0BYAtgAcAA9+BYAsgW4FvgWOABwC1oq+it4RT0VVG0VFGkVywo1/RWU4U59TlFb1GvRX////QK9Nj/9AtNn02fTY9NhNlAr/QK//TYTZLSJsIFemx///oF/5aZNj02U2C0yBaBfoFAS6bKBfoFVTEFNRTMuMTAwVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVQiA8GAO/4RAf//////wYA4GAO+EQHAwB4GDoB4GA4HQRB0BhlDIBpEAcBgPDIBgPAeDAHIFAYuLTpspsJsFpi0haRApAtAstIYKClgF/ysF/ysE/ysF//LAJ6plTlYC1ZUypmqtWVK1VqyplSFgBaqqcwAAVIqcrEBAAKmMBERCQhwD5iICIQEyABMAABBVGXF4gIA4DLAAWAEQgLVSsBaq1ZUv+YKClgELAJ////5YBP//LAL5WC+Vgn+WAX/LT+gW//PkZMIhLgrsAFt1yiD7FiB6A9qwmwViybCbCbCBSBabCBSBabPpsegWmwWn9ApApApNgCGBmEwWlLSpsf////hEHgYOB3////4GDkiBxMHhEdgYOB4GDwcBg4HW23gooFYHd/+BnAz8O8Vv//FaBm4rBWh38es2zbAtD1m2PVBqBrBqBrAF7AF3/5el84MkuHTgyy+dL0dRnEajMIyOn8RsZ5HGG/kbIpHIkYUiD0y2WctlZaWSwrKx6FZbxnL54ul04eLhw9Ol84dl86cOHT3Ipb5Z8qKpVx6/j0EkLctVTEFNRTMuMTAwgWQLQAHgLf/////4Fn+EQESEcIgInCIRW9TkrCzH0YIjjWtI+YeCD0woLCBQwsKRWUaRVCBZFZRtRtFRTlTlThRtAr0C0C//02E2fTZQK/0Ck2f9TlFRTlTlFT/9TlFVFRFb/9ThThynIQbWkAREue5S11rKdlkDEVABh61ExYPU+tOD4MQgcn4iwigivxFRFoXDcRQLhoiwioXCeAkFBcNiL8RURQBIKEVEWiLBcKIqIpEXC4QReIoIpCIKAQMxFAFAsIuIr/4YYLr//ww4XWBgwC64XX/hhgw3hhwuv8MNhhguvhdcAUYgaYTAAoWDDg2DQbBg//PkZPYe6gzuADd1uDKsBhBAe89cYYdGjtDT2hDmlD2leaOv9oX0OX/0NNLplNf8ewakNWGrTfTRpphNJtfaeh7T1/tStdtTpqN532lpX/1/kmQ5eaf2hoaV9paGleJAvd0rer2pWu1ar2vk56vVrV5Hj1Nop+/lfv5Zpkem5kX/2vtata2rq783nbvtbW6VjW6a2rq13+rO6VysV58K7tbp0ru6Vrtqa1a67tr6sau1ulYrnfa2v927Vrt21NSuN5X927/D4diAQANh4gEIfxB+IQG/D/4gDw/iGIRD+HRATEFNRTMuMTAwqqqqqqqqqqqqqqqqqiIEK/ititFX///8VcVuK38VsVhXBOQTpq/qm8QCAcBmIxgdfFZCHECpxFBFAuFEUC4cLhsRTEVEUDVoDQD+KrFYirFX+KwKoVgVUVUVeKwGrhWRWBViqFYDV4rMViKyGroauBg/A0YThVgNAEVQqw1fisis4quKxxWYrAatxWIqoqg1dFYxVxWIrAavAaAArIrAqoqhWYrIqvxWMVYrARCADhcKoVYavDVgqhV4qorIrHFWKuKxFViscVUVYasAaAfFY/4YcMNhdfwuuGGC64YfDDA2DwusANygbBwAxhAECwNg8MOF1hD4//PkZOkc4g7yBjd1sDNkDhgqYwtcYoUyiQ0NCkxQ0NCQkSIbGKIyRGEo5mUaNEhGKEHMmaGhI0UokORvMmZmZSZSiMZQkRnKKZkzRoSNCQpQ0NEZoaNFJkhh3KOUJEhIcoSJCQkIzlDlEjMDMyMpQ0JCQzNCRGaNCRISEZoZihoaIwlEHKNGiMzFEjRmSIwlHMyZmcyiGyMxRyhIkIxRSZokSEYGBkiRojAPESNGjQxvKHMmMoSKTJCQkIwlFKLDYWGhoZhYWAAUGBsAwsMDYUAcK4XDPhQVwwLAH/DfgHC6TEFNRaqqBgjwYI//wYI/8GCL///+DBFhERgwRcIiPAzGYgMRKIDcskBgjAxEIwYI4GiRwNEjhFH4MRwYjA0aOEUf8Io/BiLgxGEUYRRQij/BiKDEYMR+DBGBiMRQiIgYIwiIwYIgiIgMRGIDUSjhEReEREBiIRAwR/wYI/8IiP4MEcGCIIiOERH8GCIIiMIiIIiODBHBgjBgjwiIoREcIiOEREDBFCKiAxHJcIiMGCMGCLwYI8IiPhERgwRAwRAYjEUIiIGCP/AxGIgiIsGCL//4REYMEXhERBERhExhExAzyAZiEWDBGERGeKsVsVRVFcVwTnFcVxVgnYqipFUV//PkZPkcfgzeAFaVxDgUBgAgatvIYrgnYqgnQJyK4riqK4rwTsVor4rQAjABAgnQritFSKoqQTsE5C1haxfF7F4XQtULSFqC1i4LwWkXIWkXRdF+LwqAnME4iqCdwToVuK+HAERWAkAlgJB0OB3Doc8OYc8VCsVgIB3DuHAERUAkAkHMOBwOAIisO4dwEAEAEg6AkAl4CeHA4AkKhXioBIOiv8OB3F+LgWkXxeF8XouxcF0XBeF8XBdF8XhdAdouC8AEsXYWsXOKsVBU/FaKmK/FTxXFbFUVPiv/8VfxXitVTEFNRTMuMTAwVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVAXX/8MN/wwwYf//DDBh4Yf/+DYODDfCIFAwKBQiaANFgUDAgFAwIBcADwFuBY/At8C1wLfgAdAtwLGBawLcC3AsgWeBYwLX4XW8LrBhgiFgMlhYLrhh4XWhdb8MOGGhdcMP4YaF1gw8LrwuvhhoYYLrYXWDDBdcGwfC60MN/ww8GwZ4XXC64GZQsF1wbBnDD4XXg2DcLrBdaDYPhhgusF1uGGC64YfhhoNg0LrQwwYcMNC62F1/g2DYXW4XXC6+GH8DTIW4YeB/wR/wjwR+DP/y06bJaRAtAtAtAs//PkZNwY2grqBFW1xDhTRegABLBstL6BRaVAstN5aYtN/psIFf5aQtIgWgUWk8tImyWkQL9Avy0qbKbKbJaf02f/0CkCy05adAsC3K7+mx5aVAv0C/TZ8tOmymwB2pspsFpPLSlpy0qbCBSBXlpk2E2E2C0paUtP6Bfpslp0CkCy0ibJaZAosWQLLTJsemwgUmz6BZaYtOgUWmLTpsJsoFJslpPLT+mwmz//6Bfpsf6BSBSbCBXoFeWk9NhNhAr0Cy0/+WnTZ8tJ/oFf6bP+myWn//8tMmz/lpf//////8sPTEFNRTMuMTAwVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVBgJwiCYMBP//gwE//////wiCAMEgkIggIqIDKpUCIIgwE8IzA4j+EYhGAZMIyDJA5gGRhGcIyDIhEQiIGAgwIRDwiAGAAwYMHBghGAZMGRCMhGYRgGRA5gIyDIwZPBk/wZIRmEY/gyOBxIMgIzCMgcTgwRBgjwYJBgngwTwYJhEQBiBGERMIrwOouAxAgGCQYIhERhEQDBGDBAREgwTCIgGCQYJgwSDBHwiI4MEAwSBiRHCIkGCYGJEQiI/Bgn4REYREeBiBIH6XhERhETwogoy04mpZibFmJuWYmx8n//PkZN4ZrgrkAFZUyDcjofgAA9qc0HafZ8HwNrjaG3xtjaDtJwTo+D55Ow7fxNRNSyLPlqJsAr/lmA/FmWYm5acTQVgTkVQTnBOQTgVxVBOBVFWK4J3FUE7gBABOwToVQTsVhUFcVRXBOhUBORWiuKkVYrCqK+KoqgnQrAnEV+K8E7FQE5xWBOQToVQTsVRW8V4qRUFYVgTsVhXioKgrCqKwqAnYqCtBOhUioK+CcisK8VRUFSKnirFQVBVFcE6FcVoJwKoqCrFXFUE7gnAqiuCcQTsE7xU8VP8VYrgnYrCuTEFNRTMuMTAwqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqn3/l/J/8vHL5f/BhwCETgGpIDOATgEIOFoDcHzgEIDgC+pG7eve1S/6tat7rXupDXSStWoIpGS4TSMQNIySMwpIyAaRkkZ8GJGdBtbwYkZ63tCKRkoIpGWDEjLCKRmEkjOvsEUjJOsIpGa6bOrgxIzsEkjIGJGYUkZVKCKRmqoDkgEjMJJGSYMSMAikZJ3qhp0dq9ru3X1I36FujPbXuxwKbr//waABfg0AC6DUDUDXBqBoAmQawJiGrhqDUGoN//PkZL8USgKcAAblrroTgfQAbhtQAag1QawaYNIAuQa12Lv9si7F2NnXa2Vsi7i/DZl2tlL9l+vL8tlUTUTUTUYQDIBlGUAyifqJKJqJ+p5Mf/U7TETEU7CxkxVO1PKdqeU8u4vq2ddnrsbM2Zs/tl9s67V2NlbIu5sgaA1Q14ExAmAaA0BrDVDXhpgTPDQGuBMA0gTKGgCYgTHDQGrDUGgNcNQaw1hoAmcNIaRIAtALVEgC1gteI8FpBaBIAtcRwkAWgFpBaILVBaIkAWgRwjhIiPEeDXwa/4NUGr+DRwaKBgX/8IhP//wiF8GBMGBP/wYEhEKEQmEQuDAoGFTAwLgwLhG/4MvCM8GSDJCNwZQOXg2DwbB8MPDDhhuGGBsHhh8Lrf4MCQYFCIUGJgiE8GBQMIFhELDDhdaGHhdYGwaGGDDhhuDYMBsHg2D8MMGHBsH8GwYDYMhEKEQgMCeDAsIhAiFBgQIhAYFhEKDAkGBMIhYGEC4GFCBELgYUKDAuEQsGBQMKEwiEBgUGBcIhQYFwYFAwgWDAoRC8GBAYE4RCgwKEQvhEJgYUIBhQkIhAiECIUGBIMC4RCgwJCIUGBAiFgaYLwiEA5cGXCNhGBGwZAw4Ng0MPBkqNqcoqorlh//PkZP8cygrkAFI0wjo7lfAAjhq4SnPor//psoFemygWmwWm/0C0Ci05adApNn/TZQLU5RU9FRFVFdTn1OFG1Gywv/UbUa9Ff0VoFgCwBbAtQLUCzAtgAchHAN8ImAbgBvwDd4RwjQDeAN8I0ImEQEQAbwRgiQjBHhHAN0A3vgG6Ab/CIhEgG5AN6EQESAbmEYI4RABvYRoRABuYRgDehEQiAiIRABvcA3QiQDfwjwDfCICPCJCJCJ4RwiYRwjBEwDehEYRgDfCNCOEQEQEcI+BagAd4FrAscCxAswLfwLAFgC1wLNVMQU1FMy4xMDBVVVVVVVVVBlBkwO3wZAZMIz//////+DJwO0IwI0DsA7cGUI34Rn4RgMuEZgywZQjAZP/hGAcmDKEYDIB28GQGQGXhGgcgRoMgRoHYBywZAZYMmBygyQYFCIUDChQYE4MCgaYJ/gwKEQsGBAiEBgXAwgQLrhdcGwcGHBsGA2Dgw4YYGwZC6/hdYMMF14YcLrYYcMPDDhdYGweF1oYb4MCwYEwYEgwJBgTCIQGBIRC/BgQDCBcIhAMKFhEKDAsGBQYFAwgTgwKDAoMCQiEgwIBhAnCIUGBQiFwiEBicIhAiFhEIgIoBooGieDPA+4GeDPCP//PkZOobXgrkAEY0jjazieQgBKKIBGgyBGhGhGgyAdoMmEaDIB2gyhGwZYMsI0GSDIEaDKB2QOWEaDKB2hGgygcoHYBygdkDtgygcngyAyhG4MgMgRgRmDJCNBkA7QjAZIRoRoMuByhGgyAyAyhGwZYHKByAcgMgRoHIEbCNCNA7fCNA7AZAO0GSEYEaDLA7cDthGgyAyAyQjAOwGUIyDKEYEaEYEYEaEbA5AZQZAZAZIMgRkGXBlBkCMgyAyQZYMngcmEb8GUGQIyDIBywZAZOEZhGBGwO2EbwjcI3hGYMqTEFNRTMuMTAwqqqqqqqqqqqqqqqqqqqqquDqz8GMDQIvBj///+DGDEGAMAifBj8IuEThFCIEQGPCLwiQYBFCKESDCETBhhGAZGEZ4MjgcSEY4GoRQigxCIEQGPCKBiBrgxwiBEwMIRAY4MQNMIkImDEGIRYMIRYRAYhFBjwYwNQYgwBgBh4GAMQiwYgxA0gahFBgBjgYBFhFhFCKEWBgEWEUGEIgMQYQMYRAMQigxhFBh4GkIgRIRYRAY4RIMQYgYhFA18IoMQYQihFhEgwhFCIDEGIRQieBiEUIoRQYhEwYDAFwGrBog0waAaQawacGsGiDQp9MZMVT3piJjJjK//PkZOYZBgjoaUJQ0DprofQgbhq0dep71PqeU69TpMdMVT6n1OlPKdJjpiKdFZkxlPKdJiJj+mKp/0xFPBoAmYaw0BpwJhDSBMQ1BqAmIEzDSGgNXDRDRhp+GsNMNAEyAmYagJkBMA1BpDXAmECZhoDXhqAmYawJjgTICZBrDSGsNAExDVDQGqGgNHDWBMIaQ0BrAmcCYgTHAmIEzDWGgNYaOBMw0BqDSBMYaA04aA1hqwJhw0ATKGqBM8NYEz4aQJkGoNMNIag1+GsCY+BMQJlDVw0cCYfDXw1ho4aQ0gTCTEFNRTMuMTAwqqoD37wjuhHf/////hGf////hHf/gycEZwRn4MnYMncIzsGTwOdOA507A507hGeEZ8GTuDJ4Rn4HPn4Mn4RnhGcDJwM3YM3gzdBm6DNwR3QjvA927Bm//Bm7Bm/Bm8GbgZvBm4GboR3gzeEd+DN8GbvBm6EZ+Bzp4Mn4HOnBGfA588IzsDnTgZPCM8Iz+EZ/CM4DnTgOdPBk8Iz4RJwGTidBi7AycTgiT4RJ8GE6ESdhEngZPJwGTieDCcESfwYToMJ3AycTwiTsDJ5OhEnwibwYb+ETdwibwibvCJuwYb/4RN/Btf/jYGyNv8bHLUtSzE0/LQBW//PkZPQcHgjQAFKVrjfDmgAge1eMLITcshNy1LX8si0LUTQtCyLQTUteWQmvLItSz4mgmnTJops0umEymDSPsnR9HwfB8k7Pvn0fAvwtcLXF/F+L4vQtQWuFoC0BaReF7AeBfwtcXBdF4XheFwXAtAui9C1haRdi6LwvirgnUE6FcVBVisKgrCvioK+KoqiqAhh3AQFXhwVYrFYCWHMOioVAI4dFWHPDgCAdDgdDmHcBIBEO+HRWAiKsBMO4dFQCAdATw6HBWHBWAgHBUHMOf/gICsOCoV4qw7+KxWHA6KhVTEFNRTMuMTAwVVVVVVVVVVVVVVVVVVVVC11Fz1+NP+/Xkqpr9OfuhQ6lZNWf+XsZc/si+KNoOj/Ntai9j7IISgZAklTqQhjToNTeQoreRdaSDODWvYAVFaWWkQmVuZPP8bRUzq896vc+XS6mm5gnnW7JLnV4z9N5XnW4k86x+uyHyxnWkmdborzraff2SvOtvljOtjd/5XRW8MivOsry/K3gUzrFPS1eFTOttTsul1+lLGdbV3c53h51mdbK7xPOr1SpnWlM63kedZnV4XPK86onnW7myrnWTmRTOqascoabXd/L+yuzS95dv1efjhl92ntYyTuIb6wuWRZFmWRa//PkZOcb/gqMACDf1LTLofggA9qc/gKRZiblqWYm3E24moSQnR9BJj6JwfBaFqWZZFoWvLUshNPxNuWn6bTZHgozRTSaNAY5oGjFQVgTkE6FUVorioK8VBXBO8VRUioAhxVioK4qAnIrYrCqKsVRVBORXBORVFcVcVwTgVBUBORUisK4rCoKwrxXFYE4FYVATjFcVhX4rcVBVFQV4rxVFSKwqCpFcV+K8VhXFYV4qivFUE4FaCdivBORUBOfBOgToE6FUVYqisKgqCtxWFbFQVxXisKgqRU4qioKuKwqCvxVBkH/4Mgf4Rg4RgfgxZBizhFYEVuDFvhFbBi3CKyEVsGLf/4MgAxaDFoGsWYMWgaxYBrFngxaDFnCKwIrAYswNas+DFgRWYGtWYMWBFZgxbgaxbgxZCKwGLIRWgxZCK2EVmDFmDFgMW4GtW8IrAYtBi3Bi0GLAYsCK0IrQit4MWeEVgRW+DFsI9cDW9AYtgxZhFaBrVgMWgxaDFvCKwIrIGtWhFaBrFuEVvBi3hFZA1i0IrYMWYMWAxaEVkGLAisCKzBizCK0DWrIRg+EYIRgQjABkHwODABkDhGDwODBgyAEYIRoRvww4YcKILYKILfhRg5htjY4OQbQ2hNAH8su//PkZP8cRgjWAFAUYjwDofQAi9pcJry1E1LUsuWvE2E0LQTcB+E2LMTctQFEEcWnFYVwTkAI4rRWFYE6BOhWwToBBAQgnIrisETANwIiAb/COEQEbgG+EcA38A3wjhGCMEeEaEeKoJwK4J2KoARBVBOIJ1FWKoJ0CcCuCdRWFcV4rioK4rAnYJ2K0V8VYr8E4xWFUVBVFQE6FXBORWFSKorxVFcVwToE5wTvBOoqwToVIJziuKwJxAQgnUVBUgnAqQCaCdxWirFaKwrRWFcE7FfFeK4rgnIrAnYrCoKoqgnAqCrip4qgnCr/////8Iu8BjvP4Ry5/8Izggc4Zw4RnD/hGcP8GThBk4eDJwgycIMnDwjOD4MnBA3eu9hF3kGO8gx3vBjvAN3jvMGO8CLvAY72DHeAbvXe+DHehF3kGO8gbvHeBF3oG713gG713vgx3oMd5BjvAi7wGO9A3eu8BjvMDd470Iu9wN3jvQY7wGO9wN3jvIRd4Bu9d6Bu9d6DHeAbvHewi7yEXecGO9BjvQN3rvIG7zykGO9A3eO9CLvYMd6EXegx3gG7x3kDd470Dd472DHewY7yDHeAKomwmhZFkAof8tCy4m5aCbcTUswFYsy0/LQTX9NBqBgJgYaY//PkZPcaTdCuAFgWlkI0DfQAe9r8Jxz6CShr8++JsArgjxNBNC0LQsyyLMsgRxallyyLIsi0LUTUtS0AVwFPia8si0LMTXiacsxNizLMTYTcsi1LMsy0E2LUsuJqJvxNyy/E1LMteWgm4mpZlkJuWRZFmWnLQTfgncVATkVcVQTsVIqQToVxWFeK4rwTmATCsCcAnQJyKoriqKwrxWiqKoqwToVRWBORWBOBVFSKgq4qAnAqAnArRVgnIJ3FYVQAgCriqK4qYqivBOsVoJwKgJ3FYVBWFfBOIqCoCcivipxUFSCd4qRV4rCvFaCc/BOhW8VxWFUVhX4r1eX/+DHgaYMOEX/CJgwwYQY8GODH/wYf4RAiQiAxCKBj4GAMYRQiwYcGEGMIoMfhECIBgEXAwCJhEA1BjhF+BhCIDEGARYGoRAYgxCLwYeESEUGMDEIoGAMAiAwBiBrCJ8GMGGEWEUGIRYMAYAxCKBiBgBqDDA1wiBEBiDAIsGIMANANMIoMAYhEBh4GMGMGARfAxBj8GAMANYRAYBFAwCIBhgYhEwNQMYGIRAMAiwNYRQi4RQYwYgahEBiBqBgESEUIqa6Z6bTBpGkmUwmkwaZpJlNCkifmkaaaBymgm0wmRPxSDTTa//PkZOYYTgboZUAQIkCEFgAAe898YTZpJtMJhNilphNdMJhMGgmemDSNJNmkaX6aNJN9MJhMc0E2mzSNJMpg0umU2mDS5oJlNJtNJnpg0DSTBoml0wmzTE8TRpGgm00mkzzRNNMJg0jQTSb/NFNdNGl02KTzRTfTPTSbTKZNLphNJpNmgmUymkwaaaTKZ/TSYTBoJr/ifptMpr9MJlNptMpg0kymumEwmf+mEwmOmkymTT5ppv80eaHTCYTHTSaNBNJtN80/0yaBoJo0k2aPTPNA0OaSaTJoplMJv9MgBAB4MBUGwbwVwUBkFAYDAU4NBoMBqhAELk//h/y1/vz6/6zMnEglwqnIsVSHBzAMMIqXiLgxS8ucoLCKl7VwipeupwYpeAxS8Z22hSl4U+qE1L2goKUva1GUJqXqwkpeAxS81IQpS8smBqXql6E1LyEVLxdEJqXoSUvAmpeJhFS8rpH3CKl6EVLxPWFKXgDUvVL1LCal4kuDFL2EVLxFlPClLyEVL2FKXhdwYpeswGpeqXkGKXqLAxS8wYpeqWk8KUvATUvQYpehJS9Bil6yoUpegipeZT2x1vN5NR2X3KrRuXjFmaS0AUCyE1BHflmWZacTYsvy05ZgAIs+WQCqJoWZ//PkZOwZ+gaYBgbm6EQMAfQAe9r8ZCbiaFkWv5ZibialoArlryyDtCSnyfR8hrE7PpNmiaIxDTGKafTJalqJoJoWQm4mnLUtSzE1LUsxNyy4mpZlqJpy14mgD8WpagKvLIEcJuWnLItBNhNhNxNgH8tSyLMTflmA/iaCaFqJqWf4mxZFmCdCvFWKwqivgnQJzFfwToAIwqgnOKgqCoK4J2KwqisKwJwKwqCqKgJwK4rYqirgnIJ2K8VhVwTmKorYrioK4JwKwrRWFQE5FUE6BOwTgV4qYqiuCdAnYqAnMVBVFUVATkVBVirioKoqCviuK8VwTjxWFfivFUVxXBOcVuKvFaKoqiuCdeEW3Bjb/gxvhFvCLYGN8GNwi3CLf8DbtuEW//CM7+DG+EW+DG8DbNgi3CLfA2zYItwY3gbZuDG8GT/Bk+DJ+DJ/hGdCM+EZwMnQZP8GT8GToRngc6dBk4IzwZOBk8GTvhGdBk+DG8Dbt8DbtgY2CLbBjYGNwi2A2zYDbN4RbhFtA2zcDbNwNu3CLaEW4RbeEW2DG8DbNwY3BjYDbNgY3A2zYItwi3CLbgbdvA27YGN/CLaDG4RbgxsDG4Rb8ItsI7oR3cGb00m0wmTT6aTZoJgUpMc0kwaa//PkZNcYqeLUAAAUHjw8DgQAe88cYTXTXNBpXiQdfLVpLJoaCSJs0TQNAbRpJpDWleaGlDmlfQ9fQ7tBZoa0IeOw3Ccq44TcHgrufDVzQNA0Om0wmDTNE0EymkymumU2mU0aSY6ZE8NFMmiaaYNDptMGn+aJpdNptNps0OmU0J50wNtMGmmEz/zQTJpppNplMJlM9M8FAYCoKAAApgqDIMACwAQbBsAMGQAQaCkGg0GgyCkGeCgNABwAAUgrwA+CoAQNAeHCAOAeAyIQHBwgDg4QYDAGgMEEOEAeA0Q4DxAHh0PEMGYMBsFQYDPgoDMGQV4NBqryAZfhGfwjMDl4Rv/wjcGT/4R/CPBH//hH4H3gzv4M7A+/gzoR4GdBnAf+DPBnwj4M7BnwivA1QIpCKcIpgaqDFgaqBogMWBqgGqgxQinA0XBi8IqEUCKBFcD7/CPwj0I+DPA/8GfBnQZ8I+EeCPwZ4R6EfhGcI0GSDIDJCNCMBkgdsIwGQDkBk4HIEZgy4RoHZwZQjcDtCMgcoRgRoRgHKDJBl4RgHIDKDIEYEaEZgyYMoRsIwGQGQIwGUGUI3A5AZMI2EaDLBlwjQZQjAjAZQoqIqqN+pypx/qNIqoqqNKNKcqchwGrCAPqN//PkZOsaCgjiBUZRnkhEBfAgw9tw+iu1RUqp2qNUNalOVG1GkV/U58sLU48sLLCiwFU4hAYA+qQQgasVhVIYQNWKwmAKpvasNoHIDm4OQHIDlGwNgbH4D+JuWQm4mhZFoJsWgm4I4TcbA2xtA5ODnGyNoHJ+NgHKDl/LMBXLUtS04mvLQteAqCaCbFoWQmha8bQ2Acg2ht8bI2RsjaGyNrjYGwNvjbByja/GxFYE4ipBOIrwTiK4J2KuK8BAK4rAnAJwKkE4FYE7FUVgEIqgIRVBO4qRXFQVBVBOMVwCcE5itBOoqAnQqCpBOIrxVBOoJ0KwJxgnQrCuKsVBXioCcCqCdAnYJyKsVYqipBOgjwiAj/8InhH4RMIkIioAC4RiJCMRP////CNk//Blkv4M6F8I9C/8GWT/8I2SwjZOEbJQZZIGWShGyYMsnwj0P///CPQ/hGyQRsn8I2SCNkgOyVkoMsnhGyQMslCNkoMsl4MsnhGyXCNk4MsmEbJ/wZZP8I2SA7JWTgyyQMiKDIieEYiAcRIihGIkIxFwZEUIxEA4iREgcRYihGIoHESIkDiJEUIxFwjEQIxEwZEWDIihGIoRiKEYiHcYJRIr9kzDmO5cIaApXE/NA0TTTKZGym/0//PkZMQWjdCsAwAWCsQ8Cfwoe89cyaXTKZACgKxsmybQFQCyPQPUbRtA9x6QAoegHKmRtClpk0RSkwaCYE/GyaaZ6ZFJTaaTCbTabTBomgmk2mxS0x0waSaTI2gcgOcT0T5MiedM9M9NCfCeGgNhMJlNJoT1MdNJhMjaNPptNGkmhtpnmgmv+KQmRSE0aaY6ZTKZTRoJg0U0aBopg0emU1/xPzTTaa5o80DRTZoJs0TRNEUhMikJs0P0x0wmkwmUymkwaKb5pppNJg0OaInhpGgmeaSbTBp9N/ptNJo0DTNAbOCkGAwGABgA4NgwAAAMAPBgAQKAyDAZgoCkFINAABWAEDAUBTAABgMBTgqACDcGAAQYDAUqLUlVt///+Bj4MIRcGH/hE//hEwY/wi8GPBj8GH8IgRcIv4RYMQi+DAIsIsIn8GHCLCJCJ/BhBgBpgwwifhFhEhF/gwCIDAGIMIMAMQYBFhFBgDH4GAMQiQNAYAwwYBECIAMIAMAAiHBgAMIAiAIg4MABgABhADAhEAGAARCBhCEQhEIMABh6EQAwIMABgCEQwMAQYD4MDCIcGACIQiHwYGDAhEOEQ4MAENB8hJD7PsnXJ0fZ98+D6LItQR3PgnZHmgPYYRopk0xj//PkZMkU/gLsKkITrkL0CfzIetvgJtNdNGkmkwCPLITf8s+WpaFmApAjgFUsyz49jSTCaGMmkyaRZlkJsWpaiagKBZlmWomh8c+CdcnROj4Pk+Akh9E6DsJ0fJ8c+OTs+idk4J2Tg+j7Pr8nB9nwfAa59k7598+D74Sk+eEkFQdDmKsOhwBEVYCeAiAmAiHcBEV4CYCIWmCHF6FqC0haRcF4XYvxfF2LwvC+FqC0xcC0C/FwLSFoF0XBfi7C0xei8LwvcLQLoWoXheC0BaIWoXBdiNiMY6cZ8RkZxnjqOojAz4zx0HUdBGozjoMw6iMjpxdi+L4uC5F/xd/haIui/bZ/+DGBp4RYMQYgw8Ivgw/CJ4RfBh/hECKBgEUGODH8InhFwY4GoMcIgRIMcInCIBrBhCIESESBp+DEGARfhEA1gxBjBj4RAYQYgxgYwiYRcIgMAiAwBjCJgYAawYYRQMQMAYhFgagYhEA0AxA1A1CJBhBgEXwMQNAihFhFAxwYAwgaYMPCJA1hEBiBrwYQiwYwiBFwYhFgxgawihFCLA0gYAwCKESBoBpCJ4MIRcGOEVB9ALR8BJj7/PonB9HyEoJwfZ9E4Dt5OeTnlqJtxNAH7nwfHPonJ8E759E6PoJI//PkZOAWKgjoZUAQYka0Ffgge9VcfZOCdE7J0To+Cc8JWTo+D7J0EqPoO0+T5PsJSfJ9n0TkJUfJOeTknPPo+z6J2Ts+ycE759/k7Pg+z5J2TonBOeTkJUTg+T5DtJ0Tvk5Pjk5DXPg+idH2HYfR9E6PgnR9k5JyfZ9cnR9cNYJSfROidE6Ps+Cdn0fB8E6DtPs+CdHwfH5OAlR8nyfB98+SdE4J0ff5OidH2TknfPkJMfYSg+Cd8+D6PsnP/JwTk++fYSQO0+D5J0fZ8HwTjn2AWDgdAL8ApALQCkO8GACwMgyAVBiAVhzwY4BeDIMgFMOh0ArDgc4BeAV4cgFsOhz/wP225HGw7wCsO4M8AqHP/+DEGQ7/8OgzgFoM4Bf4MhwO4BT4cDmHcGfDnw78GcVhUFTFXFeKoqYJ3isKuKkVgTsVoqCsKwrCoKsVQTqKorYWoXhfxeF/xdi58XOL4WmLnFYVQToE4FXiuK0VwTnFQVRVFcVhU4JzFfDgdhzBnDuHfALgyDAMQZBgGQCgBUAoDAMh3BkAsDMGcGAYgxBn+HAC0ArwCwMAS5adAry0yBSBfoFBVaKqKwVUVrRXUa9FUOEqVUjV3ySPLkvkzlNlNn02E2S06pvVKWACECpW//PkZN8VDgj+zymq5krb1ewAxJvkqe1XysDVFSqlVIo2o0ispyFVoqKNIrKcqNKcKcFhSjaKiKyKhYWiv6nCnCKijajSnPorKNKcKcqcIrqNoqKNqcKNoqKNKNqNKcIqKN//orf6BSbKbKBSBXlp0CvQKTYTZ/0C/LTxFxFoigioigCLC4cRYRWItEXC4cRcI0IoFwwXCiKwjQXC8LhRFcRcRQRSFwoikRcLhxFRFguHiKRF8E7FYVhVBOgCYVRUACKKgqgE0E6ACJFYVoJ0CcgnQrAnMVwTgE6ioKoRwDdhHhG4RARgDcCMEaEYIiAbwRIRuESEcIwRwiYRwjQjBEgWoFuBa4FngWkIQQigwhEwigx/CL/4RfCKEQGP/wYiEUwYHwYGDAwYAGA4RCEQBEGB0rCNcGU4RrBlcIsGGDCESBiEWDCBhCIEWBiDAGHCKEUGEGEGMIgMAiwigxCIDADQGIRfCIEQDXgYYRfBgBoESEXwY/CJCKEQIsGIRODEGIRQYgw8IgRYMMGAGGDEDGDAIoMcDQIkGMGGBrgwCKDAIsIkDUDWDGDDA1hE4RQMQYgwBhhFBhBh4MAMYRMIoRAiAxBjhF4mhZFpxNBNy0LQTUTXhKglR9FqWpaAP5Zi//PkZNYXkgTkGEJwlkXcDfQAe9r8bCa/k5JwTriacsizBHE6CSH1w7efHLPgjuJqWnLITYTX8tRNAH/ialqJuJuWZaFkCO4m5aE7J2TonB8E559nyEnJyfB8FmJrxNxNhNS1E3LT8sxNC0E0LTlqJuWQm3E15ZiaFqWRZiaCagP5aCblkKoqCsCdioKoqwToE6FcVwAhRWBOIrCpFbgnEVRVFUVIJ2K4rAnIqioKgrcV4riuK0E4FcVQTsVxUBOoJ3FUE7itFYE7FYVRXFUVwTkVoqAnYJxBO4rReF4XYWsLWLoui4LwuC9AdsLQL0LQA9C8Lgvi6LguBahfFwXAtIvQQ4vCqKwrxX/8E5xXit4JwKzBnwj+DF+F1guvBiQYkDRIR8I/gz8Gd4R/wYsGLBi8I8DPBneDPBnwZ/8I8DP8I8B/0Gd+DPA+8I/+Ef+DOgzvwj4R/hHoM+Ee4M4D74M+Ef/A/7gfcDPBn4R7BnfCPgz4M7Bngf8DPwjwR6B/3CPwj0Gfgz+EfBnhH8GfwioRQGIBqgRUDVAYoGiBFcIoBqoMWEUA1UDRYRUIqEUA1WBooGiAaqBogRUGJwigM8I/gz+DOCPwj/Bnwj3BnBHgZ4M4I+DOhHhNCz5aiaCb//PkZM0YugrgAAASBEUEBfQAe9rclmWompZ8shNyzLMsy1LMBUAfhNxNicBJCcE5J0JpyyLMTcBVLXloCO5aCagKACiAqflqWYmvE3E3BHlmArFnxNRNC1LUBS5aFoWhZFmWR8k5CTnxz4PonZ8E5Pg+j4LUshNQH4TYtSzLMshNBNhNSyAViyE0FQE4FYVoJ0CcRUgnYqisKoJxFWAhiuKgrCtFUE7FQE5iqKgqRVFWKorwTsVxVFYE7FTFTBOxVgnAqRXBOPisK4BOK0VoriuK0E5BOxUivFcE5FYE5FQVBXFQE6FQVBVFYVxWioCcCoLovi4LoWiL0LSL+LouBaIvBahdi6LoWgEMFoC1hacXxdC14uipiqKn8VPFbiqKsVb//Bm/+EXgx4RdhFb///hE1/8GLP//CKwIrQjoGa/wPewZqEdYM1wZqDNAetgzWEd8GagzYM2DN4M1wjoI7Bm+DNhHcD3rA9awZuEdwZvCOwjsGaA964M1A978I7hHQR0DNge98I6hHYR1wZrBmwPWgPWwZsI7wjqB63COvgzQR3BmwZsGaget8D3rCOgZoGa4R1gzYM0EdwZsI6CO+DN4R1wZsD3oGaBmwjqEdAzXCO/4R0DNAzYR0WgI8TQT//PkZL4XFgTcAE6Tekf8EfQAe9t8YTXiagKwCsJuWXLMTUtC1LMTT8TYTUJP+fAdomomoD8JuWoCgWoI7iaFkJqJqfZ8hrk4CSE5Pk+Cdk5PgnBOT7JwTg+uWZaiaCbcsgFAsy0LPlmJsWYmom5ZFmWpaibiaAjy15ZFkWQm5Zll+JsJqJvy1E0CThJz65OQlJ8H2TknZOT759k6J3z4PgTQTcsy0LITflmWfLUsiyLITYTcTT8syzLQsi0LMEcWZa8tSyE1LTibibFqWYI/8shNCyE1LQsy1LUTUBTLLloWXLUsiyLUtBN+JqJvy1E05Z8TcsxNeWn/LTnxydHwfZ9n1ydk4PsnHJyfR9E4JwTgnB8k4588nB9cnR8c+D7PjxV4q4r8VsVgTgE4/itFShX/xV4rirxVFWKoq4qfxX8E6xVxUBOYrCtwTvwTj/xV8E5/irBOsVuKwqRXFTFQVorCrFf/xWioKwrCtioCcxUFUVAToE4FUVxWFQVhUBO4rgnUVIJyKkVgToE4ipFUVoq4qisKsE64qCoCdxUFUVxXFUE78VxWFQV4qiuKgqiuK4CCK2KoqirBOATsE4FWK4qxVFUVhVFYE4gnIriuCcQTiK4rCoCdCtirBORUiqK2//PkZLAWsgzuADQNNkZj/fjIe9r8K/FXFUVwSE5aiaAKgmhaFpxNQkp8n3z5PsJOGsffLQsyyE1LItS1E1Af+CPLMTUTfibFmJoWQmxanzydHwTsnASknBaCalqWom5ZcsxNyc8nASsnHDt59BrhJgkpOicBKg7D7JyfZ8E5Pk+Cd8EeWXE0LQsiyLQtSyLIsi0LUTYsy0E3LITQshNiyLUsiy4I78shNy0LMVcE6ipgnArRVgncE4wTsVIrCqCcCtBOYrwTgE7iuKwqCoKwrcE7BOQTqKgqiqFpBEC1gPYD3F0X4WoLTF0Xxei6FqC0BaAtQWgXxdwtWFqC0haBW/FQVRUBOBUFcE6ioCcAnEVRX4rYrxWFUVBViuLsXgtAuC6FoBDBaYvi7F8XxexdF8XhcFyI//gx//CJBhgxhEwY/+EXwYgx8ImDH8GPhE8GPhEwigwhFwNQNQNfhE+DGDAGHCIBrhEhEBh4RQMAY/gYBFBhhEAxCIDCEUDEDHBiEUIoRQY+DCBp4McGEIgGgMcGIGMGIGIGgRQYgxCKBiBjBgDGESDADWBgEUDEIuDADWBpBiEUDEDDgYgwBgDEDQDUGIGgRAYQYAxCKBhCKEThEBgBiEUGIRQMQiQiwNAY//PkZKwWNgjoZUAQREakFfQAe9t8YMfwi4GBaFoJsWpaFlyyBHctCzE25ZiaFoAocsy1E24Sk+idk6LMTYTYTQsyyLUtCyLQTUswFYJMGuTg+CdHwErPotAFAsuJtxNCz4m4mvBHiafloWZZ8YppBqzTNI0jTNBMpg0jTTZZFqWfE3Af/xNf+WomhZ8suWZZCb8tC1LQtS14m/LQtBNhNOfR8hKCc8nHJ2EqCUE5CSHxydk6Pg+D7Ps+Sdk6LUTQTcTcTctSz4mwmha8TXlmJvyy5ZiaFl+WpZFoWZa8TQshNCz4mhalmJsWfLQsuWRactBNRNC1E1LLlly0E2PgJWfR8h2H2fJOSdnx+fXPs+T5PgNbnzz6Po+T7JwTk+z4PonROglJ84qCvxXxUirFX4q4qeCd1f8InCI/4R/CP//4RMI/CMEYI4RAR8I8IjCJ4REI/gG8ESEfCOERCP4R/+EaERCPCNCNCI4BvQjYRMHINobIOfjZBzDZG3xtja42gcw2PwcvG2Nng5+NgbY2wcn42htDYGwNrjYGwNsbX42vxscbI2gc3Bzg5Qcg2uNvjaGwNgbI2+Dl4OUbI2Qc42RsjbBy//g5eAboR4RwjQDeCP+EcI8IwBuwjwjBEBEA//PkZKoZMgrqADXt9EV8FfQAe9scG+EThEBGCMESESEbhEQjwjwjwjBHCIwiQDcCNCI/hHE0/LQBSLITf/lqWoSvk7LT8BWLMtRNAk58E7Po+CyLQTcsyyLUsi0Afi1LUTUTUtBNS05aFkWpZHzwkoSgnB9HwfQSsTYsizLQtRNRNgFf/8NcJWEmAWCdn0To+T4CUHyGtxNiyLT/lmJqJqJqWgmpZFqJsWgmwmwmwmv5ZiaibiactBNv/yyLTiaFkWZagKgCmJqWQmgmom3E0LTibAKfE0LLiuKgrYqipBO4JzFUE5BORXBOhVioKwqRWBOYJyKkE6BOIrYqCqCcxVxVFUV8E4FSCdcVgAgCuKkLTBDC6CHi+LwuRfha4uC+FpF8XQtAWgB2wtAWoXBchaBfwtQWnFSCdxVxXFUVhUFYV4rgnOK3wTiKir//1eDCsf//7/+wOYd///ei/f6lmiqGXpyOlCSRm+yP3UtDhFIzqBhwCFHAGFHABYGcAnAAMOAAYcAAw4BYKOAIROANgicAQYcABE4AAzgE4B+1wmcAwYcAK+sDOADgFLCJwAlWBnABwABnABwDWraETgEDOADgDBiRkgoJpGaP+64RSMoRSMGBiRkkwMSMlq7AxIy4//PkZJUYEgieBFw3fkL8FgAied8AROAAicA8DOATgAGHAAROAFwM4BOAGBhwADDgAGHANQUcAgicAYROAfgw4AIkbPNNNpo0TSNBNJgUs0l7lomEwmRSOaRp80zQFK4nvTInnTEGgwGwAwYmOmkyaInppJpMJg0k1+KUaaaTCb42U0mBsGiaSaNNNpo0OaKZNE0jTTSY5oGmaZpJrphM9MGkmDQTCZBzpg0OKR+mBtdMJobfTSbTfG2KSaBpGgaZomiaBomn02mOmkwmjSNPpjmmaKZNA0zSNFNCeClJkT40DTTCY5oJk0kyaJpdMppMdMdN80TR6ZTXTfNJNmimumem+aKZTKaTaaTRops0kwaZppk0+aSa6ZTKYTfTfTPTHTKa5omgmEyaJo9NmkaRp/pnmmaf6aNNMplMplMdMpv8TxMJlNplNJn9MdM1OM6hWa/EjiRiRiO/xIcSP+GgCZQ1+GvDRDV//4aP///4I8EwTwTBLwS/4AHgnBHBHgiwR4JgAgS4IwAYPA8ADg+AAAAFwfB4L4WADC2AGAGFwsFwuD2FgAcAPC+F/B8L4X/B7B4L4WwuD+AGDwXACAAC2D2AEFgfCwAAAAXB8LhcLeDwXCwPYPA+ACACD+AH4XwA//PkZJMVIgb2ejVLxkBMEgTIe898vwv4X/ACB/C4WwtgBg/gA4PA9gBeFhLRTXTRomkmP0yJ6J+mPy0NA0OvibNDQmfzTNNMjaFKNATxMiemiaRoGkmE2mkwmTRTHNBMGiaCZTSZTZomh0PaV9fX2hoX14kzSmOaCY5pJr80U0aPTfNFMps0jSNJMmiaSaTKb6aTKYNLphMpg0eaJoGkJ8aBoppMppMJg00xzTTabNFNJpNJpNpnpg0DT6bTRoppoJMWrSh/690NQ5paV5D2le/LND2hoQxDF/rzR1/r/aWhfaWleQxfXmheaevNDS0tLQ0ryGoch/X15D+vLy+0oc0ry/19DUOXuvIc0oav9oXkNX1/r3X18QCGHQGQHB8PiAPAaHgPDsBgcH+Hqv//+DJ0GNuEW4MbQY2wZO4Rn///4R34R3Qjv//8Gbv//8GbgZuwZvCO4GbsD37+Ed3A586DJ4Rn8DnToRn8GTsGT8GToRn4HOngyf4HOnBGeDJ0IzgjOCM8DnTwjOgydwOdP4RnYMncDbtwY2A27cItgNs3CLeDGwMbwY3CLaEWwRbQi3A27eDG0GN4G2bBFvA2zcItgY3A27YGN4G2bAxtA58/gc6eDJwHOnAyfCM7A588//PkZLMYngTSAFAUhEYcDfggw9V8DnzwOdOBk8IzuEZ4MnAyfgychsy7F3oE13Nl9sy7myrsL6qqOU5anCqkHqNDI3KVUTEU8GNU7U6gxyHKchyVV/Xa2Zspfds3rubK2VsjZmztk9djZi/TZV2NnXYu0vsm0yaBoDZNEbA2k0aKZNjmwbH/Nvm2bRtGyBVArD1G0bQPUevg9h6/+PRzZNkCrzZNgesegesermyPQPXzbHpNvm0PQPUPSbJs82TaHqAtj082h6DaNn8eo2DbHrHpNjj1m1zYHqNo2jYNnmwbPNgek2ja5sj0D1m0bJs80xtJlMdMCeps0U0meaaa6b5p/mmmU3zRTfNFN/pgHPzQNPmkaaaTXTKbTRoJk0zS6b/NBNdNJlNGj02aH6Z4IgAEEYJ4I+CMEQJcEUEXBOpHDX/w1Q0Q1Q1cNWGvw0Q0/hp/AmIaA0cCYhow0w1/w0hoDRhpw1w1BrgTLDXw1BrhrDQGgNQEzAmOGuGiGgNfgTHDQGoCZw1w0BrDWBMIEzDVDTDUGgNfAFwGjBrg1A1YNcGsAXAaQaABcBqg1g1QagaINYaoEyw1Bow1YaA1hoDSBMw1gTICYQJkGrDQGoNGGmGsNcNQawJkGuBM4aIa//PkZKAYngTsATQNQkKMFgDifh7AYagJkGsCZ+GkNWGiGsNAaYaOGgCYgTENQaw0Yaw1Q1Q0/hqw1BkAfmkaCb6ZTCY6bNBNLwmqGA5fzSTCb/lgwXOmMmMmTQ5pmkmUwmkymfzRTaZFJ6aNM002NrppMpg0kwKQmE2m0yKUaKaE95o9MJj9N9NJk0UymOaSaE/TabNNNmmmk2mU2aHTKZTCaNDjaTJoGimkyNvpk0TRTHTf6bTRopg001+mU0aXNBMjYNA0k2mjR5pfps0U100mUz0ym02mDRTHTaaTRpplMc0kz0ySA000mDSTKbNI002mzQTHTaYTf//NA0zQTBodNJk0UyKSaaZNJMprmkaP5oGmKUmEymUyaCbTHNBMJlN80DRNBMmkm/00mUwaZpprplNpvmiaJo80+aSa//TaY/6ZaH//wY4ReEX4RIMfwiAxBh/BhCJ/+ESDDwYcIn+EQIoMAiQYAw8IsGIGGETBj4MP4MQiAxhEAwAxAxBjBiEUIgMIMcDCDAGIMcGMDEGGBgEUDTwNfAx4MAiwiQYgwBgEUIgMIRAiQYhFwYAwBhA1CKDEIoGoGgMQi4MeDADGEQIkIgGMDCDAIoMAiQiAYwYYMQNQigwCJBiDEGAR//PkZJwV+gzoZUAQRkZsCfQAe9tcQYgx8GEGIMQiwMAY4MANAMcIoMSyE1E1/LMTUtCz5OD5PkJJz5Pk+uA/FqWRaib8TUTUTQtC05alqWYm4momgI8TYsxNCzE3LUtQFEsgFM+z6J0fB8nz+TsNcnB9BK+Tk+g7CdhJT6LTiaFqWYI7lqWoCvy05ZlnxNy0/LUshNBNvwR4moCj+Wv5ZlkJqWpalkCOE1E1LQsiyLITUBULLlqWZZlmJsWhZcsi1/4CiWpalkJqJuWvLXlkJsJpyy4mwm5ZlmJuWXLUTQteWgmgmwCsJoWfE3LMsiyLP8TTlkJuAolqJryzE1LTibCbloJuWhZFoWYmxZ8TcXIvxeC0i+FrF0B2i4L8LSL4uBaIDyCHF8XRfF6FqgiwtIuYWoXIrYqAncVvxVip8VIqCvUxPqtFbFf/4q/8V/8V/iririr8VATjxXipxWgnYq+KwqfFTFQVoq+KsVBW8VhUisKuK0VRXivFYE4FTBOhVFcVRV4riuCdCuCdCtwTiCcCqCcgnYqxWFcVIJwKsVxWisK8VxVgnArYqRWFeK0V4qgnQrgnYrfBOoqAnAq4J0CciqKviuK3BOoJyKsE4FUVoqisK2KwrAnArgBAFSK4//PkZJ0VagjyJgGtbkOkFfwAbh4AqRViuK4J0KgrCrFUVxVjOEeDQgjlcT4T40xtjaNI0uaI2QciGNJIl4kJZtCGIaSckIm6GL3TQ2zRTY2UwmjSNE0fxS02aY2BsJs0/+mzSE8TQpHTKZTaaG0aQpApZp/mmm+aHTfTCZGwNgUk0E0aRp/ilJlNJgT5MmkJ9zQNA0TQTH6ZG2mk0mk0mk3zQTKY/G3zQTHTabTBpGgmU0aKaTJpJpNJtMphNjYTfNE0emkymE2mEyaCbNBNfmkaJpdNJnpg0k0mDTTCbTaZTBp80k2aCbTfNE00yaCb6bTZoplMmmaKZTKaTJpmiaHTXNJNdMDbTab6Y6Z6ZNNMJhMJhN9NJrmim02m0ymU300aPTSa6Y//5pJpNdN/9NppxWxU4Jx/xWxU/xU4qcV/ipiuKwqxWFbioK/8VIqivFTwTkVgTkVor4JxFXxX8VcVxUFQE4FaCcwTvBOIqwToVuKwqCtFUVYqxXxWFeK0E7FQVYrwTnwTsV4rCqCcfFaCcRVFQE5gnAr4JyK4r4Jz4J0Koqip4rCvisKoJ3xWBOME7iuKgriuKgrAnAqgnArxXiqCcgnYJzFQVQTmAEIVYrwToAIYrwTiKkVQTkE5//PkZK4XGgzsADQNAkIcCfwAe898FXFTFYVxXxUFQVkzzS5oilg5TTTY2kyaJpJtNGgJ8aKaTQ2k2aCaNI0eaSYNJM/tKHEiQxfJG09MmgaSYTRppg0TRNNMJlMptMCfppNprmiaA2jQNLmmaRppk0jRFLNP9NJhMGmaQpZpJhNCkGkmE0J+mxSk0m0x02mjRTKbTCZ42EwaQpJpptNprmgaRpmim00J4mzSNM0kymkyKWmE0muaKYGwNjmgafTPNE0U0mUwJ7+mem01+J8mhSk2mjRTSb6aTCbNBM9MpjpjppMpk0E2mE2mE2mjSTfTaZ6YNFMcT1MpnprptNmim0wmE100aSaTRo9MGjzTTHTaaTfTSaNLpoFMAAFYNBQGwAvwAYM4NgqqkjaAN3d3d3etERNK5CZ/3Ctf8AaiAc/u7vaIn/+8XPv//+GDKv8W1/+AC8K4Yw+94xe940jgceOBwOcRaxGwH4EuNIjBfxazB8HhkwVjIAII/vDkjG/wAcJPeF5e98hNgSYLWMFvhZ73pX06aoehpmh01hMJtM9K3TKY9E10x+memvlIpZM9MUTCbShbUrtM+n5ophNZuXK+0wmemumMCemkmvc0Uwm/lJJlLe5oJZI0SyW6R0mE//PkZLcXlgrzECFvrEmMEfgAfh7k2aORpbTYUo9SBNsekGYNVKgqg6hrUXK4Q42DOwPWbILEzBSumEgkWJPU8S72G5wUuGDwguEKa1Q0UykS3Bn7FJNgg5qoEgpsGabBtGabZt7NrKCNgLYes1idmabBtm2bZsBRm0PQbF9mwPSPUBbMwzB6QojYM42ePTzbMwzR6TaNs1eBVNv81yDUJ2QYhJtD0m0PVe+x6T2M8HsbFwsh6B6D7HpugT2uZhO6HqZhmE7ISZhhkFNcghtmybBnnsD1Ho49ZtG2bZs5PVBc2EEepCaEHNjj1EJHq5smabZtmwbNEEPR+bJse9z2PY2T1SN0rdNJq6yXI06COvNJj9MGmkkGmUj7pI0TToNGlEsNEnCW10ymi5FtNFKpvps0kz0uW3aaTF00mTSzdNJu0KFYz1KjaGAhyoQCFGM//zFARgIUZ/oZpdCttay6M5drW1joSj6Ekk1b7J7R7aoQNlPrWBKLTTzOsGT5yYxLrtHTy2iUxEkES0HIBVD066VjGj31odPkkSjJtbWs6OIjKmlXHR9K5MTv5pdZolE10kk2lly74TFx5KTXeTGLrS6ExiucvJSSDUdXZm3NLn1rtYBCUEoRj77WOhCPc+g5//PkZJ8XPgzoAABMTrz8BfQyY9ONGxJULutaa1TE5LHxWEo+XecmMa3p0kqBCR6qOFaFUGpNJIIjqVi0ylBqJIkiSJIkmJj605EkSRJPetWAyVacmodBUVhGfrAZPF0AUrgRLNiqDU4VHo8h6HRObJJNdqlRBMFT0qdNE0WZhmay2tCuOY6oieWieianCnVSbzjd7SGhrLi6eUSeLcZTWqdML5PM50uOGJms9VqtYU6hrgrm4V0frUzTvYsiegR2FOkqUxSKdVCpmRCSkIAUZ4VPhqEKgFDU2VhUiIhUaIg0RAkTBYEjYBUbBMuCJgLAkCUBUinABgBE3/9EQqFRM0s0qzktk9ZFqqFC6RULE11JVDkd8Y1vVFOx9oUIpZ8Vnq5klkxBTUUzLjEwMKqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqq"))},[Ge]);const Me=jt.useCallback(Ie=>async Ce=>{if(z.current!==null&&z.current.readyState>1){const{lastScan:ot,contentBefore:et,lastScanHadContent:me}=Ie;if(Ce-ot<Z)ke.current=window.requestAnimationFrame(Me(Ie));else{const de=await Te.current.detect(z.current),Be=de.some(ye=>!et.includes(ye.rawValue)),Je=de.length>0;let rt=Ie.lastOnScan;(Be||be&&Je&&Ce-rt>=ae)&&(Ge&&ve.current&&ve.current.paused&&ve.current.play().catch(ye=>console.error("Error playing the sound",ye)),rt=Ce,$(de)),Je&&V(de),!Je&&me&&V(de);const at={lastScan:Ce,lastOnScan:rt,lastScanHadContent:Je,contentBefore:Be?de.map(ye=>ye.rawValue):et};ke.current=window.requestAnimationFrame(Me(at))}}},[z.current,$,V,Z,be,ae,Ge]);return{startScanning:jt.useCallback(()=>{const Ie=performance.now(),Ce={lastScan:Ie,lastOnScan:Ie,contentBefore:[],lastScanHadContent:!1};ke.current=window.requestAnimationFrame(Me(Ce))},[Me]),stopScanning:jt.useCallback(()=>{ke.current!==null&&(window.cancelAnimationFrame(ke.current),ke.current=null)},[])}})({videoElementRef:v,onScan:e,onFound:O,formats:n,retryDelay:C.tracker===void 0?500:10,scanDelay:d,allowMultiple:f,sound:m});jt.useEffect(()=>(x(!0),()=>{x(!1)}),[]),jt.useEffect(()=>{S&&(Q(),N())},[S,N,Q]),jt.useEffect(()=>{if(!Fk(w,R)){const B=w;t?.deviceId&&delete B.facingMode,I(B)}},[t,w,R]);const q=jt.useMemo(()=>({constraints:R,shouldStream:S&&!s}),[R,S,s]),ee=jt.useCallback(async()=>{const B=v.current;if(B==null)throw new Error("Video should be defined when component is mounted.");const z=b.current;if(z==null)throw new Error("Canvas should be defined when component is mounted.");const $=z.getContext("2d");if($==null)throw new Error("Canvas should be defined when component is mounted.");if(q.shouldStream){await te.current.stopCamera(),A(!1);try{await te.current.startCamera(B,q),B?A(!0):await te.current.stopCamera()}catch(V){G.current?.(V),console.error("error",V)}}else z.width=B.videoWidth,z.height=B.videoHeight,$.drawImage(B,0,0,B.videoWidth,B.videoHeight),await te.current.stopCamera(),A(!1)},[q]);jt.useEffect(()=>{(async()=>await ee())()},[ee]);const ne=jt.useMemo(()=>q.shouldStream&&k,[q.shouldStream,k]);return jt.useEffect(()=>{if(ne){if(b.current===void 0)throw new Error("shouldScan effect should only be triggered when component is mounted. Thus pause frame canvas is defined");if(oh(b.current),y.current===void 0)throw new Error("shouldScan effect should only be triggered when component is mounted. Thus tracking canvas is defined");if(oh(y.current),v.current==null)throw new Error("shouldScan effect should only be triggered when component is mounted. Thus video element is defined");N()}},[ne,N]),P.jsxs("div",{style:{...WB,...u?.container},className:c?.container,children:[P.jsx("video",{ref:v,style:{...QB,...u?.video,visibility:s?"hidden":"visible"},className:c?.video,autoPlay:!0,muted:!0,playsInline:!0}),P.jsx("canvas",{ref:b,style:{display:s?"block":"none",position:"absolute",width:"100%",height:"100%"}}),P.jsx("canvas",{ref:y,style:{position:"absolute",width:"100%",height:"100%"}}),P.jsxs("div",{style:{position:"absolute",width:"100%",height:"100%"},children:[C.finder&&P.jsx(oj,{scanning:k,capabilities:U.capabilities,onOff:C.onOff,zoom:C.zoom&&U.settings.zoom?{value:U.settings.zoom,onChange:async B=>{const z={...R,advanced:[{zoom:B}]};await U.updateConstraints(z)}}:void 0,torch:C.torch?{status:U.settings.torch??!1,toggle:async B=>{const z={...R,advanced:[{torch:B}]};await U.updateConstraints(z)}}:void 0,startScanning:async()=>await ee(),stopScanning:async()=>{await U.stopCamera(),oh(y.current),A(!1)}}),l]})]})}const li=[];for(let i=0;i<256;++i)li.push((i+256).toString(16).slice(1));function lj(i,e=0){return(li[i[e+0]]+li[i[e+1]]+li[i[e+2]]+li[i[e+3]]+"-"+li[i[e+4]]+li[i[e+5]]+"-"+li[i[e+6]]+li[i[e+7]]+"-"+li[i[e+8]]+li[i[e+9]]+"-"+li[i[e+10]]+li[i[e+11]]+li[i[e+12]]+li[i[e+13]]+li[i[e+14]]+li[i[e+15]]).toLowerCase()}let c0;const cj=new Uint8Array(16);function uj(){if(!c0){if(typeof crypto>"u"||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");c0=crypto.getRandomValues.bind(crypto)}return c0(cj)}const fj=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),G2={randomUUID:fj};function hj(i,e,t){i=i||{};const n=i.random??i.rng?.()??uj();if(n.length<16)throw new Error("Random bytes length must be >= 16");return n[6]=n[6]&15|64,n[8]=n[8]&63|128,lj(n)}function Hk(i,e,t){return G2.randomUUID&&!i?G2.randomUUID():hj(i)}function Vy(i){return btoa(i).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}function dj(i){let e=i.replace(/-/g,"+").replace(/_/g,"/");const t=e.length%4;return t&&(e+="=".repeat(4-t)),atob(e)}class Sl{static async createInvite(e,t=1,n,s){const a=os.getState().identity;if(!a)throw new Error("No identity found");const l=Hk(),u=Pn.decodeBase64(a.secretKey),c=Cc(Pn.decodeBase64(a.publicKey)),f=Py(u),d=O2(a.userId,l,c,f),p={inviteId:l,nonce:d.nonce,valid:!0,useCount:0,useLimit:t>0?t:void 0,name:e,note:s,expiry:n,createdAt:Date.now()};t<=0&&delete p.useLimit,await wr.addInvite(p);const m=`adun-app://invite?data=${Vy(JSON.stringify(d))}`;return{invite:p,link:m,psi:d}}static async getInvites(){return await wr.getInvites()}static async revokeInvite(e){await wr.invalidateInvite(e)}static async deleteInvite(e){await wr.deleteInvite(e)}static getInviteLink(e){const t=os.getState().identity;if(!t)throw new Error("No identity found");const n=Pn.decodeBase64(t.secretKey),s=Cc(Pn.decodeBase64(t.publicKey)),a=Py(n),l=O2(t.userId,e.inviteId,s,a,e.nonce);return`adun-app://invite?data=${Vy(JSON.stringify(l))}`}static parseInviteLink(e){try{const t=e.match(/^(?:adun-app|p2pchat):\/\/(\w+)\?data=(.+)$/);if(!t)return console.error("Failed to parse invite link: URL format not recognized"),null;const[,n,s]=t,a=JSON.parse(dj(s));return n==="add"?{type:"identity",data:a}:n==="invite"?{type:"invite",data:a}:(console.error("Failed to parse invite link: Unknown host type:",n),null)}catch(t){return console.error("Failed to parse invite link:",t),null}}}function pj({onClose:i}){const{identity:e}=os(),{addContact:t}=mi(),[n,s]=jt.useState("invite"),[a,l]=jt.useState("new"),[u,c]=jt.useState("link"),[f,d]=jt.useState(""),[p,m]=jt.useState(null),[v,b]=jt.useState(!1),[y,w]=jt.useState("Contact added successfully!"),[C,S]=jt.useState("idle"),[x,k]=jt.useState(""),[A,R]=jt.useState(1),[I,U]=jt.useState(!0),[te,G]=jt.useState("days"),[Y,O]=jt.useState(10),[N,Q]=jt.useState(()=>{const de=new Date;return de.setDate(de.getDate()+10),de.toISOString().split("T")[0]}),[q,ee]=jt.useState(null),[ne,B]=jt.useState(!1),[z,$]=jt.useState(!1),[V,Z]=jt.useState([]),[ae,Ae]=jt.useState(null),[be,Ge]=jt.useState(null);jt.useEffect(()=>{(async()=>{try{const Be=await Sl.getInvites(),Je=Date.now(),rt=Be.filter(at=>at.valid&&(!at.expiry||at.expiry>Je)&&(at.useLimit===void 0||at.useCount<at.useLimit));Z(rt)}catch(Be){console.error("Failed to load invites:",Be)}})()},[q]);const Te=de=>{Ae(de);try{const Be=Sl.getInviteLink(de);Ge(Be)}catch(Be){console.error("Failed to generate invite link:",Be),m("Failed to generate invite link")}};if(!e)return null;const ve={version:1,publicKey:e.publicKey},ke=`adun-app://add?data=${Vy(JSON.stringify(ve))}`,Me=async()=>{if(!x.trim()){m("Please enter a name for the invite");return}B(!0),m(null);try{let de;if(I)if(te==="days")de=Date.now()+Y*24*60*60*1e3;else{const Je=new Date(N);Je.setHours(23,59,59,999),de=Je.getTime()}const Be=await Sl.createInvite(x.trim(),A,de);ee({link:Be.link,invite:Be.invite})}catch(de){console.error("Failed to create invite:",de),m("Failed to create invite")}finally{B(!1)}},Ie=async de=>{const Be=de.target.files?.[0];if(Be){m(null);try{const Je=await createImageBitmap(Be);if("BarcodeDetector"in window){const at=await new window.BarcodeDetector({formats:["qr_code"]}).detect(Je);if(at.length>0){await Ce(at[0].rawValue);return}}m("QR code not found. Try the camera scanner or paste the link manually.")}catch(Je){m("Could not scan image. Try pasting the link manually."),console.error("QR scan failed:",Je)}}},Ce=async de=>{console.log("[AddContactModal] Processing data:",de),m(null);try{const Be=Sl.parseInviteLink(de);if(!Be)throw new Error("Invalid link format");if(Be.type==="identity"){const Je=Be.data;if(!Je.publicKey)throw new Error("Incomplete contact data");const rt=hk(Je.publicKey);if(rt===e.userId){m("You cannot add yourself as a contact");return}t({userId:rt,publicKey:Je.publicKey,addedAt:Date.now(),status:"offline",localProfile:{}},!0),w("Contact added successfully!")}else if(Be.type==="invite"){const Je=Be.data;if(Je.invitingId===e.userId){m("You cannot use your own invite");return}if(!Ir.isReady()){let rt=0;for(;!Ir.isReady()&&rt<50;)await new Promise(at=>setTimeout(at,100)),rt++;if(!Ir.isReady())throw new Error("Transport not ready. Please try again.")}await Ir.initiateInviteHandshake(Je),w("Invite accepted! Connecting to peer...")}console.log("[AddContactModal] Success"),b(!0),setTimeout(()=>{i()},2e3)}catch(Be){m("Invalid data. Please check and try again."),console.error("[AddContactModal] Error:",Be)}},ot=()=>{if(console.log("[AddContactModal] Manual add clicked. Input:",f),!f.trim()){m("Please enter the link");return}Ce(f.trim())},et=async(de,Be)=>{try{if(navigator.clipboard&&window.isSecureContext)await navigator.clipboard.writeText(de),Be("copied"),setTimeout(()=>Be("idle"),2e3);else{const Je=document.createElement("textarea");Je.value=de,Je.style.position="fixed",Je.style.left="-999999px",Je.style.top="-999999px",document.body.appendChild(Je),Je.focus(),Je.select();const rt=document.execCommand("copy");if(document.body.removeChild(Je),rt)Be("copied"),setTimeout(()=>Be("idle"),2e3);else throw new Error("Copy command failed")}}catch(Je){console.error("Failed to copy:",Je),Be("error"),setTimeout(()=>Be("idle"),2e3)}},me=async(de,Be,Je)=>{if(navigator.share)try{await navigator.share({title:Be,text:Je,url:de})}catch{console.log("Share cancelled")}else et(de,S)};return P.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center p-4 z-50 animate-fade-in",onClick:i,children:P.jsxs("div",{className:"bg-[var(--color-bg-card)] border border-slate-700 text-slate-200 rounded-2xl max-w-md w-full max-h-[90vh] overflow-y-auto shadow-2xl",onClick:de=>de.stopPropagation(),role:"dialog","aria-modal":"true","aria-labelledby":"modal-title",children:[P.jsxs("div",{className:"sticky top-0 bg-[var(--color-bg-card)]/95 backdrop-blur border-b border-slate-700/50 px-6 py-4 flex items-center justify-between z-10",children:[P.jsx("h2",{id:"modal-title",className:"text-xl font-bold text-white",children:"Add Contact"}),P.jsx("button",{onClick:i,"aria-label":"Close",className:"p-2 hover:bg-slate-700 rounded-full transition-colors text-slate-400 hover:text-white",children:P.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:P.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),P.jsxs("div",{className:"flex border-b border-slate-700/50",children:[P.jsx("button",{onClick:()=>{s("invite"),m(null)},className:`flex-1 px-4 py-3 text-sm font-medium transition-colors ${n==="invite"?"border-b-2 border-indigo-500 text-indigo-400":"text-slate-400 hover:text-slate-200"}`,children:"Invite"}),P.jsx("button",{onClick:()=>{s("scan"),m(null)},className:`flex-1 px-4 py-3 text-sm font-medium transition-colors ${n==="scan"?"border-b-2 border-indigo-500 text-indigo-400":"text-slate-400 hover:text-slate-200"}`,children:"Scan"}),P.jsx("button",{onClick:()=>{s("manual"),m(null)},className:`flex-1 px-4 py-3 text-sm font-medium transition-colors ${n==="manual"?"border-b-2 border-indigo-500 text-indigo-400":"text-slate-400 hover:text-slate-200"}`,children:"Manual"})]}),P.jsxs("div",{className:"p-6",children:[v&&P.jsx("div",{className:"mb-4 p-4 bg-emerald-500/10 border border-emerald-500/20 rounded-xl",children:P.jsxs("p",{className:"text-sm text-emerald-400 font-medium flex items-center",children:[P.jsx("svg",{className:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:P.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),y]})}),p&&P.jsx("div",{className:"mb-4 p-4 bg-red-500/10 border border-red-500/20 rounded-xl",children:P.jsxs("p",{className:"text-sm text-red-400 flex items-center",children:[P.jsx("svg",{className:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:P.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),p]})}),n==="invite"&&P.jsxs("div",{className:"space-y-6",children:[P.jsxs("div",{className:"flex bg-slate-800/50 p-1 rounded-xl",children:[P.jsx("button",{onClick:()=>{l("new"),Ae(null)},className:`flex-1 py-2 text-sm font-medium rounded-lg transition-all ${a==="new"?"bg-indigo-600 text-white shadow-lg":"text-slate-400 hover:text-slate-200"}`,children:"New"}),P.jsxs("button",{onClick:()=>{l("active"),ee(null)},className:`flex-1 py-2 text-sm font-medium rounded-lg transition-all ${a==="active"?"bg-indigo-600 text-white shadow-lg":"text-slate-400 hover:text-slate-200"}`,children:["Active ",V.length>0&&`(${V.length})`]})]}),a==="new"&&!q&&P.jsxs("div",{className:"space-y-4 animate-fade-in",children:[P.jsxs("div",{children:[P.jsx("label",{className:"block text-xs font-medium text-slate-400 uppercase tracking-wider mb-2",children:"Name (for your reference)"}),P.jsx("input",{type:"text",value:x,onChange:de=>k(de.target.value),placeholder:"e.g. Bob, Work Colleagues",className:"w-full px-4 py-3 bg-slate-900/50 border border-slate-700 rounded-xl text-white placeholder-slate-500 focus:outline-none focus:ring-2 focus:ring-indigo-500/50"})]}),P.jsxs("div",{children:[P.jsx("label",{className:"block text-xs font-medium text-slate-400 uppercase tracking-wider mb-2",children:"Use Limit"}),P.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[P.jsx("button",{onClick:()=>R(1),className:`px-3 py-2 rounded-lg text-sm font-medium border transition-all ${A===1?"bg-indigo-500/20 border-indigo-500 text-indigo-300":"bg-slate-800 border-slate-700 text-slate-400 hover:border-slate-600"}`,children:"Single Use (1 Peer)"}),P.jsx("button",{onClick:()=>R(0),className:`px-3 py-2 rounded-lg text-sm font-medium border transition-all ${A===0?"bg-indigo-500/20 border-indigo-500 text-indigo-300":"bg-slate-800 border-slate-700 text-slate-400 hover:border-slate-600"}`,children:"Unlimited (Group)"})]}),P.jsx("p",{className:"mt-2 text-xs text-slate-500",children:A===1?"Single use. The name will be used as the contact name.":"Multiple uses. The name will be used as the group name."})]}),P.jsxs("div",{children:[P.jsxs("div",{className:"flex items-center justify-between mb-2",children:[P.jsx("label",{className:"text-xs font-medium text-slate-400 uppercase tracking-wider",children:"Expiry"}),P.jsx("div",{className:"flex items-center",children:P.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[P.jsx("input",{type:"checkbox",className:"sr-only peer",checked:I,onChange:de=>U(de.target.checked)}),P.jsx("div",{className:"w-9 h-5 bg-slate-700 peer-focus:outline-none peer-focus:ring-2 peer-focus:ring-indigo-500 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-4 after:w-4 after:transition-all peer-checked:bg-indigo-600"}),P.jsx("span",{className:"ml-2 text-xs font-medium text-slate-300",children:I?"Enabled":"Disabled"})]})})]}),I&&P.jsxs("div",{className:"bg-slate-800/50 rounded-xl p-3 space-y-3 animate-fade-in",children:[P.jsxs("div",{className:"flex space-x-2",children:[P.jsx("button",{onClick:()=>G("days"),className:`flex-1 py-1.5 text-xs font-medium rounded-lg transition-all ${te==="days"?"bg-slate-700 text-white shadow-sm":"text-slate-400 hover:text-slate-200"}`,children:"Days"}),P.jsx("button",{onClick:()=>G("date"),className:`flex-1 py-1.5 text-xs font-medium rounded-lg transition-all ${te==="date"?"bg-slate-700 text-white shadow-sm":"text-slate-400 hover:text-slate-200"}`,children:"Date"})]}),te==="days"?P.jsxs("div",{className:"flex items-center gap-2",children:[P.jsx("div",{className:"flex gap-1",children:[1,10,30].map(de=>P.jsx("button",{onClick:()=>O(de),className:`px-3 py-2 rounded-lg text-sm font-medium border transition-all ${Y===de?"bg-indigo-500/20 border-indigo-500 text-indigo-300":"bg-slate-800 border-slate-700 text-slate-400 hover:border-slate-600"}`,children:de},de))}),P.jsxs("div",{className:"flex-1 flex items-center gap-2",children:[P.jsx("input",{type:"number",min:"1",value:Y,onChange:de=>O(Math.max(1,parseInt(de.target.value)||0)),className:"w-full px-3 py-2 bg-slate-900/50 border border-slate-700 rounded-xl text-white placeholder-slate-500 focus:outline-none focus:ring-2 focus:ring-indigo-500/50 text-center"}),P.jsx("span",{className:"text-sm text-slate-400 whitespace-nowrap",children:"days"})]})]}):P.jsx("input",{type:"date",value:N,min:new Date().toISOString().split("T")[0],onChange:de=>Q(de.target.value),className:"w-full px-3 py-2.5 bg-slate-900/50 border border-slate-700 rounded-xl text-white text-sm focus:outline-none focus:ring-2 focus:ring-indigo-500/50"})]})]}),P.jsx("button",{onClick:Me,disabled:ne,className:"w-full px-4 py-3 bg-indigo-600 text-white rounded-xl hover:bg-indigo-500 transition-colors font-medium shadow-lg shadow-indigo-500/20 flex items-center justify-center",children:ne?"Generating...":"Generate Invite Link"})]}),a==="new"&&q&&P.jsxs("div",{className:"space-y-6 animate-fade-in",children:[P.jsx("div",{className:"flex justify-center",children:P.jsx("div",{className:"bg-white p-4 rounded-xl",children:P.jsx(Jh,{value:q.link,size:200,level:"H",includeMargin:!0})})}),P.jsx("p",{className:"text-center text-sm text-slate-400",children:"Share this invite QR code."}),P.jsxs("div",{className:"space-y-3",children:[P.jsx("button",{onClick:()=>et(q.link,S),className:`w-full px-4 py-3 rounded-xl transition-all font-medium flex items-center justify-center ${C==="copied"?"bg-emerald-600 text-white":C==="error"?"bg-red-600 text-white":"bg-slate-700 text-white hover:bg-slate-600"}`,children:C==="copied"?"Copied Link!":"Copy Link"}),"share"in navigator&&P.jsx("button",{onClick:()=>me(q.link,"Add Contact","Scan to add"),className:"w-full px-4 py-3 bg-indigo-600 text-white rounded-xl hover:bg-indigo-500 transition-colors font-medium shadow-lg shadow-indigo-500/20 flex items-center justify-center",children:"Share via..."}),P.jsx("button",{onClick:()=>{ee(null),k("")},className:"w-full px-4 py-3 bg-slate-800 text-slate-300 rounded-xl hover:bg-slate-700 transition-colors font-medium",children:"Create Another Invite"})]})]}),a==="active"&&!ae&&P.jsx("div",{className:"space-y-3 animate-fade-in",children:V.length===0?P.jsxs("div",{className:"text-center py-8",children:[P.jsx("p",{className:"text-slate-400 mb-4",children:"No active invites"}),P.jsx("button",{onClick:()=>l("new"),className:"text-indigo-400 hover:text-indigo-300 text-sm font-medium",children:"Create one now"})]}):V.map(de=>P.jsx("button",{onClick:()=>Te(de),className:"w-full p-4 bg-slate-800/50 hover:bg-slate-700/50 rounded-xl border border-slate-700/50 hover:border-slate-600/50 transition-all text-left",children:P.jsxs("div",{className:"flex items-center justify-between",children:[P.jsxs("div",{children:[P.jsx("h4",{className:"font-medium text-white",children:de.name||"Unnamed Invite"}),P.jsxs("div",{className:"flex items-center gap-3 mt-1 text-xs text-slate-400",children:[P.jsx("span",{children:de.useLimit===void 0?`${de.useCount} uses`:`${de.useCount}/${de.useLimit} uses`}),de.expiry&&P.jsxs("span",{children:["Expires ",new Date(de.expiry).toLocaleDateString()]})]})]}),P.jsx("svg",{className:"w-5 h-5 text-slate-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:P.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})]})},de.inviteId))}),a==="active"&&ae&&be&&P.jsxs("div",{className:"space-y-6 animate-fade-in",children:[P.jsxs("button",{onClick:()=>{Ae(null),Ge(null)},className:"flex items-center text-sm text-slate-400 hover:text-slate-200",children:[P.jsx("svg",{className:"w-4 h-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:P.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})}),"Back to list"]}),P.jsxs("div",{className:"text-center",children:[P.jsx("h4",{className:"font-medium text-white text-lg",children:ae.name||"Unnamed Invite"}),P.jsxs("p",{className:"text-xs text-slate-400 mt-1",children:[ae.useLimit===void 0?`${ae.useCount} uses`:`${ae.useCount}/${ae.useLimit} uses`,ae.expiry&&`  Expires ${new Date(ae.expiry).toLocaleDateString()}`]})]}),P.jsx("div",{className:"flex justify-center",children:P.jsx("div",{className:"bg-white p-4 rounded-xl",children:P.jsx(Jh,{value:be,size:200,level:"H",includeMargin:!0})})}),P.jsxs("div",{className:"space-y-3",children:[P.jsx("button",{onClick:()=>et(be,S),className:`w-full px-4 py-3 rounded-xl transition-all font-medium flex items-center justify-center ${C==="copied"?"bg-emerald-600 text-white":C==="error"?"bg-red-600 text-white":"bg-slate-700 text-white hover:bg-slate-600"}`,children:C==="copied"?"Copied Link!":"Copy Link"}),"share"in navigator&&P.jsx("button",{onClick:()=>me(be,"Add Contact","Scan to add"),className:"w-full px-4 py-3 bg-indigo-600 text-white rounded-xl hover:bg-indigo-500 transition-colors font-medium shadow-lg shadow-indigo-500/20 flex items-center justify-center",children:"Share via..."})]})]})]}),n==="scan"&&P.jsx("div",{className:"space-y-4",children:z?P.jsxs("div",{className:"space-y-6 animate-fade-in",children:[P.jsx("div",{className:"p-4 bg-amber-500/10 border border-amber-500/20 rounded-xl",children:P.jsxs("p",{className:"text-sm text-amber-400 flex items-center",children:[P.jsx("svg",{className:"w-5 h-5 mr-2 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:P.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),"Camera access denied or not available"]})}),P.jsx("input",{type:"file",accept:"image/*",onChange:Ie,className:"hidden",id:"qr-scan-input-fallback"}),P.jsxs("label",{htmlFor:"qr-scan-input-fallback",className:"flex items-center justify-center gap-3 w-full px-4 py-4 bg-indigo-600 text-white rounded-xl hover:bg-indigo-500 transition-colors font-medium shadow-lg shadow-indigo-500/20 cursor-pointer",children:[P.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:P.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})}),"Select QR Image from Gallery"]}),P.jsx("p",{className:"text-sm text-slate-500 text-center",children:"Select an image containing a QR code to scan it"})]}):P.jsxs(P.Fragment,{children:[P.jsx("div",{className:"rounded-xl overflow-hidden bg-black aspect-square",children:P.jsx(aj,{onScan:de=>{de?.[0]?.rawValue&&Ce(de[0].rawValue)},onError:de=>{console.error("Scanner error:",de),$(!0)},formats:["qr_code"]})}),P.jsx("p",{className:"text-sm text-slate-400 text-center",children:"Point camera at a QR code to scan"}),P.jsxs("div",{className:"border-t border-slate-700 pt-4",children:[P.jsx("input",{type:"file",accept:"image/*",onChange:Ie,className:"hidden",id:"qr-scan-input"}),P.jsxs("label",{htmlFor:"qr-scan-input",className:"flex items-center justify-center gap-2 text-sm text-slate-400 hover:text-slate-200 cursor-pointer",children:[P.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:P.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})}),"Or select image from gallery"]})]})]})}),n==="manual"&&P.jsxs("div",{className:"space-y-6",children:[P.jsxs("div",{className:"flex bg-slate-800/50 p-1 rounded-xl",children:[P.jsx("button",{onClick:()=>c("link"),className:`flex-1 py-2 text-sm font-medium rounded-lg transition-all ${u==="link"?"bg-indigo-600 text-white shadow-lg":"text-slate-400 hover:text-slate-200"}`,children:"Identity Link"}),P.jsx("button",{onClick:()=>c("identity"),className:`flex-1 py-2 text-sm font-medium rounded-lg transition-all ${u==="identity"?"bg-indigo-600 text-white shadow-lg":"text-slate-400 hover:text-slate-200"}`,children:"My Identity"})]}),u==="link"&&P.jsxs("div",{className:"space-y-6 animate-fade-in",children:[P.jsxs("div",{children:[P.jsx("label",{htmlFor:"manual-input",className:"block text-xs font-medium text-slate-400 uppercase tracking-wider mb-2",children:"Paste Link"}),P.jsx("textarea",{id:"manual-input",value:f,onChange:de=>d(de.target.value),placeholder:"adun-app://...",rows:4,className:"w-full px-4 py-3 bg-slate-900/50 border border-slate-700 rounded-xl focus:outline-none focus:ring-2 focus:ring-indigo-500/50 focus:border-indigo-500/50 font-mono text-xs text-slate-300 placeholder-slate-600 resize-none"}),P.jsxs("p",{className:"mt-2 text-xs text-amber-500/80 flex items-start",children:[P.jsx("svg",{className:"w-4 h-4 mr-1.5 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:P.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),"Paste the full link starting with adun-app://"]})]}),P.jsx("button",{onClick:ot,className:"w-full px-4 py-3 bg-indigo-600 text-white rounded-xl hover:bg-indigo-500 transition-colors font-medium shadow-lg shadow-indigo-500/20",children:"Add Contact"})]}),u==="identity"&&P.jsxs("div",{className:"space-y-6 animate-fade-in",children:[P.jsx("div",{className:"flex justify-center",children:P.jsx("div",{className:"bg-white p-4 rounded-xl",children:P.jsx(Jh,{value:ke,size:200,level:"H",includeMargin:!0})})}),P.jsx("p",{className:"text-center text-sm text-slate-400",children:"Share this QR code to let others add you directly."}),P.jsxs("div",{className:"space-y-3",children:[P.jsx("button",{onClick:()=>et(ke,S),className:`w-full px-4 py-3 rounded-xl transition-all font-medium flex items-center justify-center ${C==="copied"?"bg-emerald-600 text-white":C==="error"?"bg-red-600 text-white":"bg-slate-700 text-white hover:bg-slate-600"}`,children:C==="copied"?"Copied Link!":"Copy Link"}),"share"in navigator&&P.jsx("button",{onClick:()=>me(ke,"Add Contact","Scan to add"),className:"w-full px-4 py-3 bg-indigo-600 text-white rounded-xl hover:bg-indigo-500 transition-colors font-medium shadow-lg shadow-indigo-500/20 flex items-center justify-center",children:"Share via..."})]})]})]})]}),P.jsx("div",{className:"px-6 pb-6",children:P.jsx("button",{onClick:i,className:"w-full px-4 py-3 bg-slate-800 text-slate-300 rounded-xl hover:bg-slate-700 transition-colors font-medium",children:"Close"})})]})})}function gj(){try{const i=Ir.getActiveSignalingServices();return{status:i.length>0?"connected":"disconnected",services:i}}catch{return{status:"disconnected",services:[]}}}function mj(){const i=jt.useMemo(()=>gj(),[]),[e,t]=jt.useState(i.status),[n,s]=jt.useState(i.services);return jt.useEffect(()=>{const l=setInterval(()=>{try{const u=Ir.getActiveSignalingServices();s(u),u.length>0?t("connected"):t("disconnected")}catch{t("disconnected"),s([])}},3e3);return()=>clearInterval(l)},[]),{status:e,services:n}}function yj({status:i,onRetry:e}){return i==="offline"?null:i==="handshake"?P.jsxs("div",{className:"flex items-center space-x-1",title:"Connecting...",children:[P.jsx("div",{className:"w-2.5 h-2.5 bg-yellow-500 rounded-full animate-pulse"}),P.jsx("span",{className:"text-xs text-yellow-500",children:"Connecting"})]}):i==="online"?P.jsxs("div",{className:"flex items-center space-x-1",title:"Online",children:[P.jsx("div",{className:"w-2.5 h-2.5 bg-green-500 rounded-full shadow-[0_0_8px_rgba(34,197,94,0.6)]"}),P.jsx("span",{className:"text-xs text-green-500",children:"Online"})]}):i==="failed"?P.jsxs("div",{className:"flex items-center space-x-2",title:"Connection failed",children:[P.jsxs("div",{className:"flex items-center space-x-1",children:[P.jsx("div",{className:"w-2.5 h-2.5 bg-red-500 rounded-full"}),P.jsx("span",{className:"text-xs text-red-500",children:"Failed"})]}),e&&P.jsx("button",{onClick:t=>{t.stopPropagation(),e()},className:"px-2 py-0.5 bg-red-500/10 hover:bg-red-500/20 text-red-500 text-xs rounded transition-colors",children:"Retry"})]}):null}function bj({count:i}){if(i<=0)return null;const e=i>99?"99":i.toString(),t=i>=10;return P.jsx("div",{className:`absolute -top-1 -right-1 bg-red-500 text-white text-xs font-bold flex items-center justify-center border-2 border-[var(--color-bg-card)] shadow-sm ${t?"min-w-[1.25rem] h-5 px-1 rounded-full":"w-5 h-5 rounded-full"}`,children:e})}function vj(i){return i.status==="online"?P.jsx("div",{className:"absolute bottom-0 right-0 w-3.5 h-3.5 bg-emerald-500 border-2 border-[var(--color-bg-card)] rounded-full"}):i.status==="handshake"?P.jsx("div",{className:"absolute bottom-0 right-0 w-3.5 h-3.5 bg-yellow-500 border-2 border-[var(--color-bg-card)] rounded-full animate-pulse"}):i.status==="failed"?P.jsx("div",{className:"absolute bottom-0 right-0 w-3.5 h-3.5 border-2 border-[var(--color-bg-card)] rounded-full bg-red-500 flex items-center justify-center",children:P.jsx("svg",{className:"w-2 h-2 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:P.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3,d:"M6 18L18 6M6 6l12 12"})})}):null}function wj(){const{identity:i,activeView:e,activeContactId:t,setActiveView:n,setActiveContact:s,miniChatVisibility:a}=os(),{contacts:l,retryHandshake:u,removeContact:c}=mi(),{messages:f}=Ic(),[d,p]=jt.useState(!1),[m,v]=jt.useState(null),{status:b,services:y}=mj();console.log("[ContactsView] Rendering with",l.length,"contacts");const w=A=>{s(A),n("chat"),mi.getState().clearUnread(A)},C=A=>{u(A)},S=A=>{Ir.removePeer(A.userId),c(A.userId),t===A.userId&&(s(null),n("contacts")),v(null)},x=(A,R)=>{if(!i)return[];const I=[i.userId,A].sort().join("-");return(f[I]||[]).slice(-3)},k=A=>{const R=A.localProfile?.name,I=A.peerProfile?.name,U=!R&&!!I;return{displayName:R||I||`User ${A.userId.slice(0,8).toUpperCase()}`,isPeerProvided:U}};return P.jsxs("div",{className:"h-screen flex flex-col bg-[var(--color-bg-dark)] text-[var(--color-text-primary)] animate-fade-in",children:[P.jsx("div",{className:"bg-[var(--color-bg-card)]/80 backdrop-blur-md border-b border-slate-700/50 px-6 py-5 sticky top-0 z-10",children:P.jsxs("div",{className:"flex items-center justify-between max-w-3xl mx-auto w-full",children:[P.jsxs("div",{children:[P.jsxs("h1",{className:"text-2xl font-bold bg-gradient-to-r from-indigo-400 to-purple-400 bg-clip-text text-transparent",children:["Messages",P.jsxs("span",{className:"ml-2 text-xs font-mono text-slate-500 cursor-help",title:`Build: 8c5a8ac
Date: 2025-12-08T09:03:54.697Z`,children:["build ","8c5a8ac".slice(0,4)]})]}),P.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[P.jsxs("p",{className:"text-xs text-slate-400 font-mono opacity-70",children:["ID: ",i?.userId.slice(0,8).toUpperCase()]}),P.jsxs("div",{className:"flex items-center gap-1.5",title:`Signaling: ${y.join(", ")||"None"}`,children:[P.jsx("div",{className:`w-1.5 h-1.5 rounded-full ${b==="connected"?"bg-emerald-500":b==="connecting"?"bg-yellow-500 animate-pulse":"bg-red-500"}`}),P.jsx("span",{className:`text-[10px] font-medium uppercase tracking-wider ${b==="connected"?"text-emerald-400":b==="connecting"?"text-yellow-400":"text-red-400"}`,children:b==="connected"?y.join(", ")||"Connected":b==="connecting"?"Connecting":"Offline"})]})]})]}),P.jsxs("div",{className:"flex space-x-3",children:[P.jsx("button",{onClick:()=>p(!0),className:"p-2.5 bg-indigo-600 hover:bg-indigo-500 text-white rounded-full transition-all shadow-lg shadow-indigo-500/20 hover:shadow-indigo-500/40 active:scale-95",title:"Add contact",children:P.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:P.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2.5,d:"M12 4v16m8-8H4"})})}),P.jsx("button",{onClick:()=>n("settings"),className:"p-2.5 bg-slate-700/50 hover:bg-slate-700 text-slate-200 rounded-full transition-all hover:text-white active:scale-95",title:"Settings",children:P.jsxs("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[P.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"}),P.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})]})})]})]})}),P.jsx("div",{className:"flex-1 overflow-y-auto px-4 py-4",children:P.jsx("div",{className:"max-w-3xl mx-auto w-full space-y-2",children:l.length===0?P.jsxs("div",{className:"flex flex-col items-center justify-center h-[60vh] text-center",children:[P.jsx("div",{className:"w-20 h-20 bg-slate-800/50 rounded-2xl flex items-center justify-center mb-6 border border-slate-700/50",children:P.jsx("svg",{className:"w-10 h-10 text-slate-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:P.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})})}),P.jsx("h3",{className:"text-xl font-semibold text-slate-200 mb-2",children:"No contacts yet"}),P.jsx("p",{className:"text-slate-400 mb-8 max-w-xs mx-auto leading-relaxed",children:"Connect with friends by scanning their QR code or sharing your link."}),P.jsx("button",{onClick:()=>p(!0),className:"px-8 py-3 bg-indigo-600 text-white rounded-xl hover:bg-indigo-500 transition-all font-medium shadow-lg shadow-indigo-500/25 hover:shadow-indigo-500/40 active:scale-95",children:"Add New Contact"})]}):P.jsx("div",{className:"grid gap-2",children:l.map(A=>{const R=x(A.userId),I=A.unreadCount||0,{displayName:U,isPeerProvided:te}=k(A),G=A.localProfile?.group;return P.jsxs("div",{onClick:()=>w(A.userId),className:"w-full p-4 flex items-start space-x-4 bg-[var(--color-bg-card)] hover:bg-slate-700/50 rounded-2xl transition-all border border-transparent hover:border-slate-600/50 group cursor-pointer",children:[P.jsxs("div",{className:"relative flex-shrink-0",children:[P.jsx("div",{className:"w-14 h-14 bg-gradient-to-br from-indigo-500 to-purple-600 rounded-full flex items-center justify-center shadow-lg shadow-indigo-500/10 group-hover:scale-105 transition-transform duration-300",children:P.jsx("span",{className:"text-white font-bold text-lg",children:U?.[0]?.toUpperCase()||A.userId.slice(0,2).toUpperCase()})}),vj(A),P.jsx(bj,{count:I})]}),P.jsxs("div",{className:"flex-1 min-w-0 text-left",children:[P.jsxs("div",{className:"flex items-center justify-between mb-3",children:[P.jsx("h3",{className:`text-lg truncate pr-4 ${te?"text-slate-300 italic":"text-white font-semibold"}`,children:U}),P.jsx("div",{className:"flex items-center space-x-2",children:P.jsx("button",{onClick:Y=>{Y.stopPropagation(),v(A)},className:"p-1.5 text-slate-500 hover:text-red-400 hover:bg-red-500/10 rounded-lg transition-colors opacity-0 group-hover:opacity-100",title:"Delete contact",children:P.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:P.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})})]}),P.jsxs("div",{className:"flex items-start",children:[P.jsx("div",{className:"flex-shrink-0 w-[120px] mr-4 pt-0.5",children:G?P.jsx("p",{className:"text-sm text-indigo-400 font-medium truncate",children:G}):P.jsx(yj,{status:A.status,onRetry:()=>C(A.userId)})}),P.jsx("div",{className:`flex-1 min-w-0 space-y-1 p-2 bg-slate-800/40 rounded-lg border border-slate-700/30 ${a==="never"?"hidden":a==="always"?"md:hidden lg:block":t===A.userId&&e==="chat"?"hidden":"md:hidden lg:block"}`,children:R.length>0?R.map(Y=>{const O=Y.from===i?.userId;return P.jsxs("p",{className:"text-xs text-slate-400 truncate leading-tight flex items-center",children:[P.jsx("span",{className:`mr-1 font-bold flex-shrink-0 ${O?"text-indigo-300":"text-slate-500"}`,children:O?"You:":"Them:"}),P.jsx("span",{className:"truncate opacity-90",children:Y.content})]},Y.msg_uuid)}):P.jsx("p",{className:"text-xs text-slate-600 italic text-center py-1",children:"No messages yet"})})]})]})]},A.userId)})})})}),d&&P.jsx(pj,{onClose:()=>p(!1)}),m&&P.jsx("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm flex items-center justify-center p-4 z-50 animate-fade-in",children:P.jsxs("div",{className:"bg-[var(--color-bg-card)] border border-red-500/30 rounded-2xl max-w-md w-full p-6 shadow-2xl",children:[P.jsx("h2",{className:"text-xl font-bold text-red-500 mb-4",children:"Delete Contact?"}),P.jsxs("p",{className:"text-slate-400 mb-6",children:["Are you sure you want to delete ",P.jsx("span",{className:"text-white font-medium",children:k(m).displayName}),"? This will remove the contact and all messages with them. This action cannot be undone."]}),P.jsxs("div",{className:"flex space-x-3",children:[P.jsx("button",{onClick:()=>v(null),className:"flex-1 px-4 py-2.5 bg-slate-700 hover:bg-slate-600 text-white rounded-xl transition-colors font-medium",children:"Cancel"}),P.jsx("button",{onClick:()=>S(m),className:"flex-1 px-4 py-2.5 bg-red-600 hover:bg-red-500 text-white rounded-xl transition-colors font-medium",children:"Delete"})]})]})})]})}const xj=()=>Hk(),gd=i=>({id:i.msg_uuid,timestamp:i.timestamp,type:"text",content:i.content}),_j=(i,e)=>({id:i,timestamp:e,type:"ack"}),Sj=(i,e,t)=>{if(i.type==="ack")throw new Error("Cannot convert ACK to Message - ACKs are not stored");return{msg_uuid:i.id,conversationId:t,from:e,content:i.content||"",timestamp:i.timestamp,delivered:!0,firstAttemptTimestamp:i.timestamp,showAsFailedInUI:!1,type:"text"}};class Ej{userId;queues=new Map;lastActivity=new Map;minNextTime=0;timerId=null;unsubscribe=null;config;onTimeout=null;constructor(e,t){this.userId=e,this.config=t,this.unsubscribe=Ir.onPeerOnline((n,s)=>{console.log("[RetryService] onPeerOnline callback:",n.substring(0,8),"online:",s),s?this.loadUndeliveredForPeer(n):(this.clearQueue(n),this.lastActivity.delete(n))}),this.startTimer(),console.log("[RetryService] Initialized for user:",e.substring(0,8))}startTimer(){this.timerId||(this.timerId=setInterval(()=>this.timerTick(),this.config.timerInterval),console.log("[RetryService] Timer started"))}stopTimer(){this.timerId&&(clearInterval(this.timerId),this.timerId=null,console.log("[RetryService] Timer stopped"))}async timerTick(){const e=Date.now();for(const[t,n]of this.queues){for(;n.length>0&&e-n[0].firstAttemptTimestamp>=this.config.timeoutMs;){const a=n.shift();console.log("[RetryService] Message timed out:",a.msg_uuid.substring(0,8)),a.msg_id!==void 0&&this.onTimeout?.(a.msg_id)}if(n.length===0){this.queues.delete(t);continue}if(e<this.minNextTime)continue;const s=this.lastActivity.get(t)||0;if(e-s>=this.config.minPeerInterval){this.lastActivity.set(t,e),this.minNextTime=e+this.config.minPeerInterval;const a=n[0];try{console.log("[RetryService] Timer sending:",a.msg_uuid.substring(0,8),"to:",t.substring(0,8)),await Ir.sendMessage(t,gd(a)),console.log("[RetryService] Timer  sent:",a.msg_uuid.substring(0,8))}catch(l){console.error("[RetryService] Timer  failed:",a.msg_uuid.substring(0,8),l)}return}}}setOnTimeout(e){this.onTimeout=e}async loadUndeliveredForPeer(e){console.log("[RetryService] loadUndeliveredForPeer called for:",e.substring(0,8)),console.log("[RetryService] My userId:",this.userId.substring(0,8));const t=[this.userId,e].sort().join("-");console.log("[RetryService] Looking up conversationId:",t.substring(0,24));const n=await wr.getMessages(t);console.log("[RetryService] Found",n.length,"total messages in conversation");const s=n.filter(u=>!u.delivered&&u.from===this.userId);if(console.log("[RetryService] Loading",s.length,"undelivered messages for:",e.substring(0,8)),s.length===0)return;const a=Date.now(),l=s.map(u=>({...u,firstAttemptTimestamp:a}));this.queues.set(e,l),this.lastActivity.set(e,0)}addToQueue(e,t){const n=this.queues.get(e)||[];if(n.some(s=>s.msg_uuid===t.msg_uuid)){console.log(`[RetryService] Message ${t.msg_uuid.substring(0,8)} already in queue, skipping`);return}n.push(t),this.queues.set(e,n),console.log(`[RetryService] Added ${t.msg_uuid.substring(0,8)} to queue (size: ${n.length})`)}removeFromQueue(e,t){const n=this.queues.get(e);if(!n)return;const s=n.findIndex(a=>a.msg_uuid===t);s>-1&&(n.splice(s,1),console.log(`[RetryService] Removed ${t.substring(0,8)} from queue (size: ${n.length})`)),n.length===0&&this.queues.delete(e)}async sendNextForPeer(e){const t=this.queues.get(e);if(!t||t.length===0)return;const n=Date.now();this.lastActivity.set(e,n),this.minNextTime=n+this.config.minPeerInterval;const s=t[0];try{console.log("[RetryService] Sending next:",s.msg_uuid.substring(0,8)),await Ir.sendMessage(e,gd(s)),console.log("[RetryService]  Sent:",s.msg_uuid.substring(0,8))}catch(a){console.error("[RetryService]  Failed to send next:",s.msg_uuid.substring(0,8),a)}}getQueue(e){return this.queues.get(e)||[]}clearQueue(e){this.queues.has(e)&&(this.queues.delete(e),console.log(`[RetryService] Cleared queue for ${e.substring(0,8)}`))}destroy(){this.stopTimer(),this.unsubscribe&&(this.unsubscribe(),this.unsubscribe=null),this.queues.clear(),this.lastActivity.clear(),console.log("[RetryService] Destroyed")}}let xs=null;const Cj=(i,e)=>(xs&&xs.destroy(),xs=new Ej(i,e),xs),Aj=i=>{xs?.setOnTimeout(i)},zk=()=>{xs&&(xs.destroy(),xs=null)},$y=(i,e)=>{xs?.addToQueue(i,e)},Gk=(i,e)=>{xs?.removeFromQueue(i,e)},Kk=i=>{xs?.sendNextForPeer(i)},kj=Object.freeze(Object.defineProperty({__proto__:null,addToRetryQueue:$y,destroyRetryService:zk,initRetryService:Cj,removeFromRetryQueue:Gk,sendNextMessage:Kk,setRetryTimeoutCallback:Aj},Symbol.toStringTag,{value:"Module"})),Tj={indigo:{bg:"bg-indigo-500/20",text:"text-indigo-400"},orange:{bg:"bg-orange-500/20",text:"text-orange-400"},purple:{bg:"bg-purple-500/20",text:"text-purple-400"},emerald:{bg:"bg-emerald-500/20",text:"text-emerald-400"},cyan:{bg:"bg-cyan-500/20",text:"text-cyan-400"}};function Mj(i,e){if(!e)return i;let t=i;for(const n of e)t=t.replace(n,"");return t}function Ij(){const{identity:i,setActiveView:e,clearIdentity:t,updateProfile:n,miniChatVisibility:s,setMiniChatVisibility:a,signalingSettings:l,updateSignalingService:u}=os(),c=jt.useMemo(()=>Wu(l),[l]),{contacts:f}=mi(),[d,p]=jt.useState(!1),[m,v]=jt.useState(!1),[b,y]=jt.useState(!1),[w,C]=jt.useState(!1),[S,x]=jt.useState(""),[k,A]=jt.useState(null),[R,I]=jt.useState(!1),U=jt.useRef(null),[te,G]=jt.useState(i?.profile?.name||""),[Y,O]=jt.useState(i?.profile?.description||""),[N,Q]=jt.useState(!1),[q,ee]=jt.useState(!1),[ne,B]=jt.useState([]),[z,$]=jt.useState(!1),[V,Z]=jt.useState(null),[ae,Ae]=jt.useState(""),[be,Ge]=jt.useState(!1),[Te,ve]=jt.useState(!1);jt.useEffect(()=>{ke()},[]);const ke=async()=>{$(!0);try{const ye=await Sl.getInvites();B(ye.sort((it,Mt)=>Mt.createdAt-it.createdAt))}catch(ye){console.error("Failed to load invites",ye)}finally{$(!1)}},Me=async ye=>{try{await Sl.revokeInvite(ye),await ke()}catch(it){console.error("Failed to revoke invite",it)}},Ie=async ye=>{try{await Sl.deleteInvite(ye),await ke()}catch(it){console.error("Failed to delete invite",it)}},Ce=async()=>{if(i){Q(!0);try{const ye={...i.profile,name:te,description:Y};n(ye);const it={...i,profile:ye};El.save(it),ee(!0),setTimeout(()=>ee(!1),2e3)}catch(ye){console.error("Failed to save profile",ye)}finally{Q(!1)}}},ot=async()=>{if(i){if(!S){A("Password is required to encrypt your identity");return}try{const ye={version:1,encrypted:!0,data:El.exportToJSON(i),passwordHint:"Password protected"},it=JSON.stringify(ye,null,2),Mt=new Blob([it],{type:"application/json"}),nt=URL.createObjectURL(Mt),Zt=document.createElement("a");Zt.href=nt,Zt.download=`chat-identity-${i.userId.slice(0,8)}.json`,document.body.appendChild(Zt),Zt.click(),document.body.removeChild(Zt),URL.revokeObjectURL(nt),p(!1),x(""),A(null)}catch(ye){A("Failed to export identity"),console.error(ye)}}},et=()=>{const ye={version:1,type:"contacts",timestamp:Date.now(),contacts:f.map(j=>({userId:j.userId,publicKey:j.publicKey,displayName:j.displayName,addedAt:j.addedAt}))},it=JSON.stringify(ye,null,2),Mt=new Blob([it],{type:"application/json"}),nt=URL.createObjectURL(Mt),Zt=document.createElement("a");Zt.href=nt,Zt.download=`chat-contacts-${Date.now()}.json`,document.body.appendChild(Zt),Zt.click(),document.body.removeChild(Zt),URL.revokeObjectURL(nt)},me=()=>{i&&(navigator.clipboard.writeText(i.userId),y(!0),setTimeout(()=>y(!1),2e3))},de=()=>{zk(),Ir.destroyAll(),El.delete(),t(),e("setup")},Be=ye=>{const it=document.getElementById(ye);it&&it.scrollIntoView({behavior:"smooth"})},Je=()=>{if(U.current){const{scrollTop:ye}=U.current;I(ye>200)}},rt=()=>{U.current&&U.current.scrollTo({top:0,behavior:"smooth"})};if(!i)return null;const at=()=>P.jsxs("nav",{className:"space-y-1",children:[P.jsxs("button",{onClick:()=>Be("public-profile"),className:"w-full flex items-center px-3 py-2 text-sm font-medium text-slate-300 rounded-lg hover:bg-slate-800 hover:text-white transition-colors group",children:[P.jsx("svg",{className:"w-5 h-5 mr-3 text-indigo-400 group-hover:text-indigo-300",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:P.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})}),"Public Profile"]}),P.jsxs("button",{onClick:()=>Be("identity"),className:"w-full flex items-center px-3 py-2 text-sm font-medium text-slate-300 rounded-lg hover:bg-slate-800 hover:text-white transition-colors group",children:[P.jsx("svg",{className:"w-5 h-5 mr-3 text-indigo-400 group-hover:text-indigo-300",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:P.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 6H5a2 2 0 00-2 2v9a2 2 0 002 2h14a2 2 0 002-2V8a2 2 0 00-2-2h-5m-4 0V5a2 2 0 114 0v1m-4 0c0 .884-.956 1.676-2 2.5-1.044-.824-2-1.616-2-2.5s.956-1.676 2-2.5c1.044.824 2 1.616 2 2.5z"})}),"Identity"]}),P.jsxs("button",{onClick:()=>Be("invites"),className:"w-full flex items-center px-3 py-2 text-sm font-medium text-slate-300 rounded-lg hover:bg-slate-800 hover:text-white transition-colors group",children:[P.jsx("svg",{className:"w-5 h-5 mr-3 text-indigo-400 group-hover:text-indigo-300",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:P.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 5v2m0 4v2m0 4v2M5 5a2 2 0 00-2 2v3a2 2 0 110 4v3a2 2 0 002 2h14a2 2 0 002-2v-3a2 2 0 110-4V7a2 2 0 00-2-2H5z"})}),"Invites"]}),P.jsxs("button",{onClick:()=>Be("features"),className:"w-full flex items-center px-3 py-2 text-sm font-medium text-slate-300 rounded-lg hover:bg-slate-800 hover:text-white transition-colors group",children:[P.jsx("svg",{className:"w-5 h-5 mr-3 text-indigo-400 group-hover:text-indigo-300",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:P.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19.428 15.428a2 2 0 00-1.022-.547l-2.387-.477a6 6 0 00-3.86.517l-.318.158a6 6 0 01-3.86.517L6.05 15.21a2 2 0 00-1.806.547M8 4h8l-1 1v5.172a2 2 0 00.586 1.414l5 5c1.26 1.26.367 3.414-1.415 3.414H4.828c-1.782 0-2.674-2.154-1.414-3.414l5-5A2 2 0 009 10.172V5L8 4z"})}),"Features"]}),P.jsxs("button",{onClick:()=>Be("signals"),className:"w-full flex items-center px-3 py-2 text-sm font-medium text-slate-300 rounded-lg hover:bg-slate-800 hover:text-white transition-colors group",children:[P.jsx("svg",{className:"w-5 h-5 mr-3 text-indigo-400 group-hover:text-indigo-300",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:P.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8.111 16.404a5.5 5.5 0 017.778 0M12 20h.01m-7.08-7.071c3.904-3.905 10.236-3.905 14.14 0M1.394 9.393c5.857-5.857 15.355-5.857 21.213 0"})}),"Signals"]}),P.jsxs("button",{onClick:()=>Be("danger-zone"),className:"w-full flex items-center px-3 py-2 text-sm font-medium text-red-400 rounded-lg hover:bg-red-500/10 transition-colors group",children:[P.jsx("svg",{className:"w-5 h-5 mr-3 text-red-500 group-hover:text-red-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:P.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),"Danger Zone"]})]});return P.jsxs("div",{className:"h-screen flex flex-col bg-[var(--color-bg-dark)] text-slate-200",children:[P.jsx("div",{className:"bg-[var(--color-bg-card)] border-b border-slate-700/50 px-4 py-4 shadow-sm z-10 flex-shrink-0",children:P.jsxs("div",{className:"flex items-center space-x-3",children:[P.jsxs("button",{onClick:()=>e("contacts"),"aria-label":"Back to contacts",className:"flex items-center px-3 py-2 -ml-2 text-slate-400 hover:text-white hover:bg-slate-800 rounded-lg transition-colors",children:[P.jsx("svg",{className:"w-5 h-5 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:P.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})}),P.jsx("span",{className:"font-medium",children:"Back"})]}),P.jsx("h1",{className:"text-xl font-bold text-white",children:"Settings"})]})}),P.jsxs("div",{className:"flex-1 flex flex-col md:flex-row overflow-hidden",children:[P.jsx("div",{className:"hidden md:block w-64 bg-[var(--color-bg-card)] border-r border-slate-700/50 p-4 overflow-y-auto flex-shrink-0",children:P.jsx(at,{})}),P.jsxs("div",{ref:U,onScroll:Je,className:"flex-1 overflow-y-auto p-4 md:p-8 scroll-smooth relative",children:[P.jsxs("div",{className:"md:hidden mb-8 bg-[var(--color-bg-card)]/50 rounded-2xl border border-slate-700/50 p-4",children:[P.jsx("h3",{className:"text-xs font-bold text-slate-400 uppercase tracking-wider mb-3",children:"Table of Contents"}),P.jsx(at,{})]}),P.jsxs("div",{className:"max-w-2xl mx-auto space-y-8 pb-20",children:[P.jsxs("section",{id:"public-profile",className:"bg-[var(--color-bg-card)] rounded-2xl border border-slate-700/50 p-6 shadow-xl scroll-mt-6",children:[P.jsxs("h2",{className:"text-lg font-bold text-white mb-6 flex items-center",children:[P.jsx("svg",{className:"w-5 h-5 mr-2 text-indigo-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:P.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})}),"Public Profile"]}),P.jsxs("div",{className:"space-y-4",children:[P.jsxs("div",{children:[P.jsx("label",{className:"block text-xs font-medium text-slate-400 uppercase tracking-wider mb-2",children:"Display Name"}),P.jsx("input",{type:"text",value:te,onChange:ye=>G(ye.target.value),placeholder:"Your Name",className:"w-full px-4 py-3 bg-slate-900/50 border border-slate-700 rounded-xl text-white placeholder-slate-500 focus:outline-none focus:ring-2 focus:ring-indigo-500/50 transition-all"})]}),P.jsxs("div",{children:[P.jsx("label",{className:"block text-xs font-medium text-slate-400 uppercase tracking-wider mb-2",children:"Description"}),P.jsx("textarea",{value:Y,onChange:ye=>O(ye.target.value),placeholder:"Tell others about yourself...",rows:3,className:"w-full px-4 py-3 bg-slate-900/50 border border-slate-700 rounded-xl text-white placeholder-slate-500 focus:outline-none focus:ring-2 focus:ring-indigo-500/50 transition-all resize-none"})]}),P.jsx("div",{className:"pt-2 flex justify-end",children:P.jsx("button",{onClick:Ce,disabled:N,className:`px-6 py-2.5 rounded-xl font-medium transition-all flex items-center ${q?"bg-green-500/20 text-green-400 border border-green-500/50":"bg-indigo-600 text-white hover:bg-indigo-500 shadow-lg shadow-indigo-500/20"}`,children:N?P.jsxs(P.Fragment,{children:[P.jsx("svg",{className:"w-4 h-4 mr-2 animate-spin",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:P.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),"Saving..."]}):q?P.jsxs(P.Fragment,{children:[P.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:P.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),"Saved!"]}):"Save Profile"})})]})]}),P.jsxs("section",{id:"identity",className:"bg-[var(--color-bg-card)] rounded-2xl border border-slate-700/50 p-6 shadow-xl scroll-mt-6",children:[P.jsxs("div",{className:"flex items-center justify-between mb-6",children:[P.jsxs("h2",{className:"text-lg font-bold text-white flex items-center",children:[P.jsx("svg",{className:"w-5 h-5 mr-2 text-indigo-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:P.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 6H5a2 2 0 00-2 2v9a2 2 0 002 2h14a2 2 0 002-2V8a2 2 0 00-2-2h-5m-4 0V5a2 2 0 114 0v1m-4 0c0 .884-.956 1.676-2 2.5-1.044-.824-2-1.616-2-2.5s.956-1.676 2-2.5c1.044.824 2 1.616 2 2.5z"})}),"Identity"]}),P.jsx("button",{onClick:()=>C(!w),className:"text-xs font-medium text-indigo-400 hover:text-indigo-300 transition-colors",children:w?"Hide Keys":"Show Keys"})]}),P.jsxs("div",{className:"space-y-5",children:[P.jsxs("div",{children:[P.jsx("label",{className:"block text-xs font-medium text-slate-400 uppercase tracking-wider mb-2",children:"User ID"}),P.jsxs("div",{className:"flex items-center space-x-2",children:[P.jsx("input",{type:"text",value:i.userId,readOnly:!0,className:"flex-1 px-3 py-2.5 bg-slate-900/50 border border-slate-700 rounded-xl font-mono text-sm text-slate-300 focus:outline-none"}),P.jsx("button",{onClick:me,className:"px-4 py-2.5 bg-slate-700 hover:bg-slate-600 text-white rounded-xl transition-colors font-medium",children:b?"Copied!":"Copy"})]})]}),w&&P.jsx("div",{className:"space-y-4 pt-4 border-t border-slate-700/50 animate-fade-in",children:P.jsxs("div",{children:[P.jsx("label",{className:"block text-xs font-medium text-slate-400 uppercase tracking-wider mb-2",children:"Public Key (Signing)"}),P.jsx("input",{type:"text",value:i.publicKey,readOnly:!0,className:"w-full px-3 py-2 bg-slate-900/50 border border-slate-700 rounded-xl font-mono text-xs text-slate-400"})]})})]}),P.jsx("div",{className:"mt-6 pt-6 border-t border-slate-700/50",children:P.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[P.jsxs("button",{onClick:()=>p(!0),className:"px-2 py-3 bg-slate-800 text-slate-200 rounded-xl hover:bg-slate-700 transition-colors font-medium flex flex-col items-center justify-center text-center text-xs sm:text-sm",children:[P.jsx("svg",{className:"w-5 h-5 mb-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:P.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"})}),"Export Identity"]}),P.jsxs("button",{onClick:et,className:"px-2 py-3 bg-slate-800 text-slate-200 rounded-xl hover:bg-slate-700 transition-colors font-medium flex flex-col items-center justify-center text-center text-xs sm:text-sm",children:[P.jsx("svg",{className:"w-5 h-5 mb-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:P.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})}),"Export Contacts"]}),P.jsxs("button",{disabled:!0,className:"px-2 py-3 bg-slate-800/50 text-slate-500 rounded-xl cursor-not-allowed font-medium flex flex-col items-center justify-center border border-slate-700/30 text-center text-xs sm:text-sm",children:[P.jsx("svg",{className:"w-5 h-5 mb-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:P.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 10h.01M12 10h.01M16 10h.01M9 16H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-5l-5 5v-5z"})}),"Export Messages"]})]})})]}),P.jsxs("section",{id:"invites",className:"bg-[var(--color-bg-card)] rounded-2xl border border-slate-700/50 p-6 shadow-xl scroll-mt-6",children:[P.jsxs("h2",{className:"text-lg font-bold text-white mb-6 flex items-center",children:[P.jsx("svg",{className:"w-5 h-5 mr-2 text-indigo-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:P.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 5v2m0 4v2m0 4v2M5 5a2 2 0 00-2 2v3a2 2 0 110 4v3a2 2 0 002 2h14a2 2 0 002-2v-3a2 2 0 110-4V7a2 2 0 00-2-2H5z"})}),"Active Invites"]}),z?P.jsx("div",{className:"text-center py-4 text-slate-400",children:"Loading invites..."}):ne.length===0?P.jsxs("div",{className:"text-center py-8 bg-slate-800/30 rounded-xl border border-slate-700/30",children:[P.jsx("p",{className:"text-slate-400 text-sm",children:"No active invites found."}),P.jsx("p",{className:"text-slate-500 text-xs mt-1",children:'Create invites from the "Add Contact" screen.'})]}):P.jsx("div",{className:"space-y-3",children:ne.map(ye=>P.jsxs("div",{className:"bg-slate-800/50 border border-slate-700/50 rounded-xl p-4 flex items-center justify-between group hover:border-indigo-500/30 transition-colors",children:[P.jsxs("div",{className:"min-w-0 flex-1 mr-4",children:[P.jsxs("div",{className:"flex items-center space-x-2 mb-1",children:[P.jsx("h3",{className:"text-white font-medium truncate",children:ye.name||"Unnamed Invite"}),P.jsx("span",{className:`px-2 py-0.5 rounded text-[10px] font-bold uppercase ${ye.valid?"bg-emerald-500/20 text-emerald-400":"bg-red-500/20 text-red-400"}`,children:ye.valid?"Active":"Revoked"})]}),P.jsxs("div",{className:"text-xs text-slate-400 flex items-center space-x-3",children:[P.jsxs("span",{children:["Uses: ",ye.useCount," / ",ye.useLimit===void 0?"":ye.useLimit]}),P.jsxs("span",{children:["Created: ",new Date(ye.createdAt).toLocaleDateString()]}),ye.expiry&&P.jsxs("span",{className:Date.now()>ye.expiry?"text-red-400":"",children:["Expires: ",new Date(ye.expiry).toLocaleDateString()]})]})]}),P.jsx("div",{className:"flex items-center space-x-2",children:ye.valid?P.jsx("button",{onClick:()=>Me(ye.inviteId),className:"p-2 text-slate-400 hover:text-red-400 hover:bg-red-500/10 rounded-lg transition-colors",title:"Revoke Invite",children:P.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:P.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M18.364 18.364A9 9 0 005.636 5.636m12.728 12.728A9 9 0 015.636 5.636m12.728 12.728L5.636 5.636"})})}):P.jsx("button",{onClick:()=>Ie(ye.inviteId),className:"p-2 text-slate-400 hover:text-red-400 hover:bg-red-500/10 rounded-lg transition-colors",title:"Delete Invite",children:P.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:P.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})})]},ye.inviteId))})]}),P.jsxs("section",{id:"features",className:"bg-[var(--color-bg-card)] rounded-2xl border border-slate-700/50 p-6 shadow-xl scroll-mt-6",children:[P.jsxs("h2",{className:"text-lg font-bold text-white mb-6 flex items-center",children:[P.jsx("svg",{className:"w-5 h-5 mr-2 text-indigo-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:P.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19.428 15.428a2 2 0 00-1.022-.547l-2.387-.477a6 6 0 00-3.86.517l-.318.158a6 6 0 01-3.86.517L6.05 15.21a2 2 0 00-1.806.547M8 4h8l-1 1v5.172a2 2 0 00.586 1.414l5 5c1.26 1.26.367 3.414-1.415 3.414H4.828c-1.782 0-2.674-2.154-1.414-3.414l5-5A2 2 0 009 10.172V5L8 4z"})}),"Features"]}),P.jsx("div",{className:"space-y-6",children:P.jsxs("div",{children:[P.jsx("label",{className:"block text-sm font-medium text-white mb-3",children:"Mini-chats visible"}),P.jsxs("div",{className:"space-y-3",children:[P.jsxs("label",{className:"flex items-center space-x-3 cursor-pointer group",children:[P.jsx("div",{className:`w-5 h-5 rounded-full border flex items-center justify-center transition-colors ${s==="never"?"border-indigo-500 bg-indigo-500":"border-slate-600 bg-slate-800 group-hover:border-slate-500"}`,children:s==="never"&&P.jsx("div",{className:"w-2.5 h-2.5 bg-white rounded-full"})}),P.jsx("input",{type:"radio",name:"miniChatVisibility",value:"never",checked:s==="never",onChange:ye=>a(ye.target.value),className:"hidden"}),P.jsxs("span",{className:"text-slate-300 group-hover:text-white transition-colors",children:["Never ",P.jsx("span",{className:"text-slate-500 text-sm ml-1",children:"(minichats are never shown)"})]})]}),P.jsxs("label",{className:"flex items-center space-x-3 cursor-pointer group",children:[P.jsx("div",{className:`w-5 h-5 rounded-full border flex items-center justify-center transition-colors ${s==="contacts"?"border-indigo-500 bg-indigo-500":"border-slate-600 bg-slate-800 group-hover:border-slate-500"}`,children:s==="contacts"&&P.jsx("div",{className:"w-2.5 h-2.5 bg-white rounded-full"})}),P.jsx("input",{type:"radio",name:"miniChatVisibility",value:"contacts",checked:s==="contacts",onChange:ye=>a(ye.target.value),className:"hidden"}),P.jsxs("span",{className:"text-slate-300 group-hover:text-white transition-colors",children:["Contacts ",P.jsx("span",{className:"text-slate-500 text-sm ml-1",children:"(shown when space available and chat closed)"})]})]}),P.jsxs("label",{className:"flex items-center space-x-3 cursor-pointer group",children:[P.jsx("div",{className:`w-5 h-5 rounded-full border flex items-center justify-center transition-colors ${s==="always"?"border-indigo-500 bg-indigo-500":"border-slate-600 bg-slate-800 group-hover:border-slate-500"}`,children:s==="always"&&P.jsx("div",{className:"w-2.5 h-2.5 bg-white rounded-full"})}),P.jsx("input",{type:"radio",name:"miniChatVisibility",value:"always",checked:s==="always",onChange:ye=>a(ye.target.value),className:"hidden"}),P.jsxs("span",{className:"text-slate-300 group-hover:text-white transition-colors",children:["Always ",P.jsx("span",{className:"text-slate-500 text-sm ml-1",children:"(shown when space available)"})]})]})]})]})})]}),P.jsxs("section",{id:"signals",className:"bg-[var(--color-bg-card)] rounded-2xl border border-slate-700/50 p-6 shadow-xl scroll-mt-6",children:[P.jsxs("h2",{className:"text-lg font-bold text-white mb-6 flex items-center",children:[P.jsx("svg",{className:"w-5 h-5 mr-2 text-indigo-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:P.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8.111 16.404a5.5 5.5 0 017.778 0M12 20h.01m-7.08-7.071c3.904-3.905 10.236-3.905 14.14 0M1.394 9.393c5.857-5.857 15.355-5.857 21.213 0"})}),"Signaling Services"]}),P.jsx("p",{className:"text-sm text-slate-400 mb-6",children:"Configure which signaling services to use for peer discovery. Multiple services provide redundancy."}),P.jsx("div",{className:"space-y-4",children:I3().map(ye=>{const it=lh[ye],Mt=c[ye],nt=Tj[it.color],Zt=V===ye,j=Mt.servers,W=it.maxDisplayServers?j.slice(0,it.maxDisplayServers):j,se=it.maxDisplayServers?Math.max(0,j.length-it.maxDisplayServers):0;return P.jsxs("div",{className:"bg-slate-800/50 border border-slate-700/50 rounded-xl p-4",children:[P.jsxs("div",{className:"flex items-center justify-between mb-3",children:[P.jsxs("div",{className:"flex items-center space-x-3",children:[P.jsx("div",{className:`w-8 h-8 ${nt.bg} rounded-lg flex items-center justify-center`,children:P.jsx("span",{className:`${nt.text} font-bold text-xs`,children:it.name[0]})}),P.jsxs("div",{children:[P.jsx("h3",{className:"text-white font-medium",children:it.name}),P.jsx("p",{className:"text-xs text-slate-500",children:it.description})]})]}),P.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[P.jsx("input",{type:"checkbox",checked:Mt.enabled,onChange:Oe=>u(ye,{enabled:Oe.target.checked}),className:"sr-only peer"}),P.jsx("div",{className:"w-11 h-6 bg-slate-700 peer-focus:outline-none rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-indigo-600"})]})]}),it.warning&&P.jsxs("div",{className:"mb-3 px-2 py-1.5 bg-yellow-500/10 border border-yellow-500/30 rounded-lg flex items-start gap-2",children:[P.jsx("svg",{className:"w-4 h-4 text-yellow-500 flex-shrink-0 mt-0.5",fill:"currentColor",viewBox:"0 0 20 20",children:P.jsx("path",{fillRule:"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})}),P.jsx("span",{className:"text-xs text-yellow-500/90",children:it.warning})]}),P.jsxs("div",{className:"space-y-2",children:[P.jsxs("div",{className:"flex items-center justify-between",children:[P.jsxs("span",{className:"text-xs text-slate-400",children:[it.serverLabel," (",j.length,")"]}),P.jsx("button",{onClick:()=>{Z(Zt?null:ye),Ae(j.join(`
`))},className:"text-xs text-indigo-400 hover:text-indigo-300",children:Zt?"Cancel":"Edit"})]}),Zt?P.jsxs("div",{className:"space-y-2",children:[P.jsx("textarea",{value:ae,onChange:Oe=>Ae(Oe.target.value),rows:Math.min(5,Math.max(3,j.length)),className:"w-full px-3 py-2 bg-slate-900/50 border border-slate-600 rounded-lg text-sm text-slate-300 font-mono focus:outline-none focus:ring-2 focus:ring-indigo-500/50",placeholder:"One URL per line"}),P.jsx("button",{onClick:()=>{const Oe=ae.split(`
`).map(Ke=>Ke.trim()).filter(Boolean);Oe.length>0&&u(ye,{servers:Oe}),Z(null)},className:"px-3 py-1.5 bg-indigo-600 text-white text-xs rounded-lg hover:bg-indigo-500",children:"Save"})]}):P.jsxs("div",{className:"flex flex-wrap gap-1.5",children:[W.map((Oe,Ke)=>P.jsx("span",{className:"px-2 py-1 bg-slate-900/50 border border-slate-700 rounded text-xs text-slate-400 font-mono truncate max-w-[200px]",children:Mj(Oe,it.stripPrefix)},Ke)),se>0&&P.jsxs("span",{className:"px-2 py-1 bg-slate-900/50 border border-slate-700 rounded text-xs text-slate-500",children:["+",se," more"]})]})]})]},ye)})}),P.jsxs("div",{className:"mt-6 pt-4 border-t border-slate-700/50 flex items-center justify-between",children:[P.jsx("p",{className:"text-xs text-slate-500",children:"Click to apply changes without restarting."}),P.jsx("button",{onClick:async()=>{if(i){Ge(!0);try{await Ir.reloadSignaling(c),ve(!0),setTimeout(()=>ve(!1),2e3)}catch(ye){console.error("Failed to reload signals:",ye)}finally{Ge(!1)}}},disabled:be,className:`px-4 py-2 rounded-xl font-medium text-sm transition-all flex items-center ${Te?"bg-green-500/20 text-green-400 border border-green-500/50":"bg-indigo-600 text-white hover:bg-indigo-500"}`,children:be?P.jsxs(P.Fragment,{children:[P.jsx("svg",{className:"w-4 h-4 mr-2 animate-spin",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:P.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),"Reloading..."]}):Te?P.jsxs(P.Fragment,{children:[P.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:P.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),"Reloaded!"]}):P.jsxs(P.Fragment,{children:[P.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:P.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),"Reload Signals"]})})]})]}),P.jsxs("section",{id:"danger-zone",className:"bg-[var(--color-bg-card)] rounded-2xl border border-red-500/30 p-6 shadow-xl scroll-mt-6",children:[P.jsxs("h2",{className:"text-lg font-bold text-red-400 mb-6 flex items-center",children:[P.jsx("svg",{className:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:P.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),"Danger Zone"]}),P.jsxs("div",{className:"space-y-3",children:[P.jsx("button",{onClick:()=>v(!0),className:"w-full px-4 py-3 bg-red-500/10 text-red-400 border border-red-500/50 rounded-xl hover:bg-red-500 hover:text-white transition-all font-medium",children:"Delete Identity"}),P.jsx("p",{className:"text-xs text-slate-500 text-center",children:"This will permanently delete your identity and all local data"})]})]})]}),P.jsx("button",{onClick:rt,className:`fixed bottom-6 right-6 p-3 bg-indigo-600 text-white rounded-full shadow-lg shadow-indigo-500/30 hover:bg-indigo-500 transition-all duration-300 z-20 ${R?"opacity-100 translate-y-0":"opacity-0 translate-y-10 pointer-events-none"}`,"aria-label":"Back to top",children:P.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:P.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 10l7-7m0 0l7 7m-7-7v18"})})})]})]}),d&&P.jsx("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm flex items-center justify-center p-4 z-50 animate-fade-in",children:P.jsxs("div",{className:"bg-[var(--color-bg-card)] border border-slate-700 rounded-2xl max-w-md w-full p-6 shadow-2xl",children:[P.jsx("h2",{className:"text-xl font-bold text-white mb-4",children:"Export Identity"}),P.jsx("div",{className:"bg-yellow-500/10 border border-yellow-500/20 rounded-xl p-4 mb-6",children:P.jsxs("div",{className:"flex items-start",children:[P.jsx("svg",{className:"w-5 h-5 text-yellow-500 mr-2 mt-0.5 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:P.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),P.jsx("p",{className:"text-sm text-yellow-200",children:"Your identity file contains your private key. Anyone with this file and password can impersonate you."})]})}),P.jsxs("div",{className:"mb-6",children:[P.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Encryption Password"}),P.jsx("input",{type:"password",value:S,onChange:ye=>x(ye.target.value),placeholder:"Enter a strong password",className:"w-full px-4 py-3 bg-slate-900/50 border border-slate-700 rounded-xl text-white placeholder-slate-500 focus:outline-none focus:ring-2 focus:ring-indigo-500/50"}),k&&P.jsx("p",{className:"mt-2 text-sm text-red-400",children:k})]}),P.jsxs("div",{className:"flex space-x-3",children:[P.jsx("button",{onClick:()=>{p(!1),x(""),A(null)},className:"flex-1 px-4 py-3 bg-slate-800 text-slate-300 rounded-xl hover:bg-slate-700 transition-colors font-medium",children:"Cancel"}),P.jsx("button",{onClick:ot,className:"flex-1 px-4 py-3 bg-indigo-600 text-white rounded-xl hover:bg-indigo-500 transition-colors font-medium",children:"Export"})]})]})}),m&&P.jsx("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm flex items-center justify-center p-4 z-50 animate-fade-in",children:P.jsxs("div",{className:"bg-[var(--color-bg-card)] border border-red-500/30 rounded-2xl max-w-md w-full p-6 shadow-2xl",children:[P.jsx("h2",{className:"text-xl font-bold text-red-500 mb-4",children:"Delete Identity?"}),P.jsx("p",{className:"text-slate-400 mb-6",children:"This action cannot be undone. Your identity and all local messages will be permanently deleted."}),P.jsxs("div",{className:"flex space-x-3",children:[P.jsx("button",{onClick:()=>v(!1),className:"flex-1 px-4 py-3 bg-slate-800 text-slate-300 rounded-xl hover:bg-slate-700 transition-colors font-medium",children:"Cancel"}),P.jsx("button",{onClick:de,className:"flex-1 px-4 py-3 bg-red-600 text-white rounded-xl hover:bg-red-500 transition-colors font-medium",children:"Delete"})]})]})})]})}function Rj({contactId:i,onClose:e}){const{getContact:t,updateLocalProfile:n}=mi(),s=t(i),[a,l]=jt.useState(""),[u,c]=jt.useState(""),[f,d]=jt.useState(""),[p,m]=jt.useState(!1);if(jt.useEffect(()=>{s&&(l(s.localProfile?.name||s.displayName||""),c(s.localProfile?.description||""),d(s.localProfile?.group||""))},[s]),!s)return null;const v=async()=>{m(!0);try{await n(i,{name:a,description:u,group:f}),e()}catch(y){console.error("Failed to update profile:",y)}finally{m(!1)}},b=()=>{s.peerProfile&&(l(s.peerProfile.name||""),c(s.peerProfile.description||""),d(s.peerProfile.group||""))};return P.jsx("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm flex items-center justify-center p-4 z-50 animate-fade-in",children:P.jsxs("div",{className:"bg-[var(--color-bg-card)] border border-slate-700 rounded-2xl max-w-4xl w-full shadow-2xl flex flex-col max-h-[90vh] overflow-hidden",children:[P.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-slate-700/50",children:[P.jsx("h2",{className:"text-xl font-bold text-white",children:"Edit Contact Profile"}),P.jsx("button",{onClick:e,className:"text-slate-400 hover:text-white transition-colors",children:P.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:P.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),P.jsx("div",{className:"flex-1 overflow-y-auto min-h-0 p-6",children:P.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8",children:[P.jsxs("div",{className:"space-y-6",children:[P.jsxs("h3",{className:"text-lg font-semibold text-indigo-400 flex items-center",children:[P.jsx("svg",{className:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:P.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})}),"Local Profile"]}),P.jsxs("div",{className:"space-y-4",children:[P.jsxs("div",{children:[P.jsx("label",{className:"block text-xs font-medium text-slate-400 uppercase tracking-wider mb-2",children:"Display Name"}),P.jsx("input",{type:"text",value:a,onChange:y=>l(y.target.value),className:"w-full px-4 py-3 bg-slate-900/50 border border-slate-700 rounded-xl text-white placeholder-slate-500 focus:outline-none focus:ring-2 focus:ring-indigo-500/50 transition-all",placeholder:"Name for this contact"})]}),P.jsxs("div",{children:[P.jsx("label",{className:"block text-xs font-medium text-slate-400 uppercase tracking-wider mb-2",children:"Description"}),P.jsx("textarea",{value:u,onChange:y=>c(y.target.value),rows:4,className:"w-full px-4 py-3 bg-slate-900/50 border border-slate-700 rounded-xl text-white placeholder-slate-500 focus:outline-none focus:ring-2 focus:ring-indigo-500/50 transition-all resize-none",placeholder:"Add notes or description..."})]}),P.jsxs("div",{children:[P.jsx("label",{className:"block text-xs font-medium text-slate-400 uppercase tracking-wider mb-2",children:"Group"}),P.jsx("input",{type:"text",value:f,onChange:y=>d(y.target.value),className:"w-full px-4 py-3 bg-slate-900/50 border border-slate-700 rounded-xl text-white placeholder-slate-500 focus:outline-none focus:ring-2 focus:ring-indigo-500/50 transition-all",placeholder:"e.g. Friends, Work"})]})]})]}),P.jsxs("div",{className:"space-y-6 md:border-l md:border-slate-700/50 md:pl-8",children:[P.jsxs("div",{className:"flex items-center justify-between",children:[P.jsxs("h3",{className:"text-lg font-semibold text-emerald-400 flex items-center",children:[P.jsx("svg",{className:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:P.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})}),"Peer's Public Profile"]}),P.jsxs("button",{onClick:b,disabled:!s.peerProfile,className:"text-xs px-3 py-1.5 bg-slate-800 hover:bg-slate-700 text-indigo-400 rounded-lg transition-colors flex items-center disabled:opacity-50 disabled:cursor-not-allowed",title:"Copy details from peer's public profile",children:[P.jsx("svg",{className:"w-3.5 h-3.5 mr-1.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:P.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7h12m0 0l-4-4m4 4l-4 4m0 6H4m0 0l4 4m-4-4l4-4"})}),"Pull from Peer"]})]}),s.peerProfile?P.jsxs("div",{className:"space-y-6",children:[P.jsxs("div",{children:[P.jsx("label",{className:"block text-xs font-medium text-slate-500 uppercase tracking-wider mb-2",children:"Public Name"}),P.jsx("div",{className:"px-4 py-3 bg-slate-800/30 border border-slate-700/30 rounded-xl text-slate-300",children:s.peerProfile.name||P.jsx("span",{className:"text-slate-600 italic",children:"Not set"})})]}),P.jsxs("div",{children:[P.jsx("label",{className:"block text-xs font-medium text-slate-500 uppercase tracking-wider mb-2",children:"Public Description"}),P.jsx("div",{className:"px-4 py-3 bg-slate-800/30 border border-slate-700/30 rounded-xl text-slate-300 min-h-[100px] whitespace-pre-wrap",children:s.peerProfile.description||P.jsx("span",{className:"text-slate-600 italic",children:"Not set"})})]}),P.jsxs("div",{children:[P.jsx("label",{className:"block text-xs font-medium text-slate-500 uppercase tracking-wider mb-2",children:"Public Group"}),P.jsx("div",{className:"px-4 py-3 bg-slate-800/30 border border-slate-700/30 rounded-xl text-slate-300",children:s.peerProfile.group||P.jsx("span",{className:"text-slate-600 italic",children:"Not set"})})]})]}):P.jsxs("div",{className:"flex flex-col items-center justify-center h-64 text-center p-6 bg-slate-800/20 rounded-2xl border border-slate-700/30 border-dashed",children:[P.jsx("svg",{className:"w-12 h-12 text-slate-600 mb-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:P.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M13.828 10.172a4 4 0 00-5.656 0l-4 4a4 4 0 105.656 5.656l1.102-1.101m-.758-4.899a4 4 0 005.656 0l4-4a4 4 0 00-5.656-5.656l-1.1 1.1"})}),P.jsx("p",{className:"text-slate-400 font-medium",children:"No public profile available"}),P.jsx("p",{className:"text-slate-500 text-sm mt-1",children:"The peer hasn't shared their profile yet."})]})]})]})}),P.jsxs("div",{className:"flex justify-end space-x-3 p-6 border-t border-slate-700/50 bg-slate-800/20",children:[P.jsx("button",{onClick:e,className:"px-6 py-2.5 bg-slate-800 text-slate-300 rounded-xl hover:bg-slate-700 transition-colors font-medium",children:"Cancel"}),P.jsx("button",{onClick:v,disabled:p,className:"px-6 py-2.5 bg-indigo-600 text-white rounded-xl hover:bg-indigo-500 transition-colors font-medium shadow-lg shadow-indigo-500/20 flex items-center",children:p?P.jsxs(P.Fragment,{children:[P.jsx("svg",{className:"w-4 h-4 mr-2 animate-spin",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:P.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),"Saving..."]}):"Save Changes"})]})]})})}const ah=100;function Oj(){const{identity:i,activeContactId:e,setActiveView:t}=os(),{getContact:n}=mi(),{messages:s,addMessage:a,setMessages:l,prependMessages:u,updateMessageDelivery:c}=Ic(),[f,d]=jt.useState(""),[p,m]=jt.useState(!1),[v,b]=jt.useState(!0),[y,w]=jt.useState(!1),[C,S]=jt.useState(!1),x=jt.useRef(null),k=jt.useRef(null),A=e?n(e):null,R=i&&A?[i.userId,A.userId].sort().join("-"):"";jt.useEffect(()=>{if(!R)return;(async()=>{const $=await wr.getRecentMessages(R,ah);l(R,$),b($.length===ah)})()},[R,l]);const I=jt.useCallback(async()=>{if(!R||y||!v)return;const z=s[R]||[];if(z.length===0)return;const $=z[0].msg_id;if($!==void 0){w(!0);try{const V=await wr.getMessagesBefore(R,$,ah);if(V.length>0){const Z=k.current,ae=Z?.scrollHeight||0;u(R,V),requestAnimationFrame(()=>{if(Z){const Ae=Z.scrollHeight;Z.scrollTop=Ae-ae}})}b(V.length===ah)}finally{w(!1)}}},[R,s,y,v,u]),U=jt.useCallback(z=>{const{scrollTop:$}=z.currentTarget;$<100&&v&&!y&&I()},[v,y,I]);jt.useEffect(()=>{x.current?.scrollIntoView({behavior:"smooth"})},[s[R]]);const te=async()=>{if(!f.trim()||!i||!A||p)return;m(!0);const z=xj();try{const $={msg_uuid:z,conversationId:R,from:i.userId,content:f.trim(),timestamp:Date.now(),delivered:!1,firstAttemptTimestamp:Date.now(),showAsFailedInUI:!1,type:"text"};console.log("[ChatView] Saving message to db, conversationId:",R,"msgUuid:",z);const V=await wr.addMessage($);$.msg_id=V,a(R,$),d(""),$y(A.userId,$),console.log("[ChatView] Sending message to",A.userId,"status:",A.status);try{await Ir.sendMessage(A.userId,gd($)),console.log("[ChatView]  Message sent (waiting for ACK)")}catch(Z){const ae=Z instanceof Error?Z.message:"Unknown error";console.log("[ChatView] Send pending:",ae)}}catch($){console.error("Failed to create/send message:",$)}finally{m(!1)}},G=async z=>{if(!(!i||!A)){if(z.msg_id===void 0){console.error("Cannot retry message without msg_id");return}console.log("[ChatView] Manual retry for message:",z.msg_uuid);try{const $=Date.now();await wr.updateMessageDelivery(z.msg_id,!1,!1,$),c(z.msg_id,!1,!1);const V={...z,firstAttemptTimestamp:$,showAsFailedInUI:!1};$y(A.userId,V),await Ir.sendMessage(A.userId,gd(V)),console.log("[ChatView]  Retry sent (waiting for ACK)")}catch($){console.error("[ChatView]  Manual retry failed:",$)}}},Y=async z=>{if(confirm("Are you sure you want to delete this message?")){await wr.deleteMessage(z);const{deleteMessage:$}=Ic.getState();$(z)}},O=z=>{z.key==="Enter"&&!z.shiftKey&&(z.preventDefault(),te())},N=z=>{const $=z.localProfile?.name,V=z.peerProfile?.name,Z=!$&&!!V;return{displayName:$||V||`User ${z.userId.slice(0,8).toUpperCase()}`,isPeerProvided:Z}},Q=z=>z.status==="online"?P.jsx("div",{className:"absolute bottom-0 right-0 w-3 h-3 bg-emerald-500 border-2 border-[var(--color-bg-card)] rounded-full"}):z.status==="handshake"?P.jsx("div",{className:"absolute bottom-0 right-0 w-3 h-3 bg-yellow-500 border-2 border-[var(--color-bg-card)] rounded-full animate-pulse"}):z.status==="failed"?P.jsx("div",{className:"absolute bottom-0 right-0 w-3 h-3 border-2 border-[var(--color-bg-card)] rounded-full bg-red-500 flex items-center justify-center",children:P.jsx("svg",{className:"w-1.5 h-1.5 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:P.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3,d:"M6 18L18 6M6 6l12 12"})})}):null;if(!i||!A)return P.jsx("div",{className:"h-screen flex items-center justify-center bg-[var(--color-bg-dark)]",children:P.jsxs("div",{className:"text-center",children:[P.jsx("p",{className:"text-slate-400",children:"No contact selected"}),P.jsx("button",{onClick:()=>t("contacts"),className:"mt-4 px-6 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-500 transition-colors",children:"Back to Contacts"})]})});const q=s[R]||[],{displayName:ee,isPeerProvided:ne}=N(A),B=A.localProfile?.group;return P.jsxs("div",{className:"h-screen flex flex-col bg-[var(--color-bg-dark)] animate-fade-in",children:[P.jsxs("div",{className:"bg-[var(--color-bg-card)]/80 backdrop-blur-md border-b border-slate-700/50 px-4 py-3 flex items-center space-x-4 sticky top-0 z-10",children:[P.jsx("button",{onClick:()=>t("contacts"),"aria-label":"Back to Contacts",className:"p-2 hover:bg-slate-700/50 rounded-full transition-colors text-slate-300 hover:text-white",children:P.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:P.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})}),P.jsxs("div",{className:"relative",children:[P.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-indigo-500 to-purple-600 rounded-full flex items-center justify-center flex-shrink-0 shadow-lg shadow-indigo-500/20",children:P.jsx("span",{className:"text-white font-bold",children:ee?.[0]?.toUpperCase()||A.userId.slice(0,2).toUpperCase()})}),Q(A)]}),P.jsxs("div",{className:"flex-1 min-w-0",children:[P.jsx("h2",{className:`font-semibold truncate ${ne?"text-slate-300 italic":"text-slate-100"}`,children:ee}),P.jsx("div",{className:"flex items-center space-x-2",children:B?P.jsx("span",{className:"text-xs text-indigo-400 font-medium",children:B}):P.jsx(P.Fragment,{children:A.status==="online"?P.jsxs("div",{className:"flex items-center space-x-1.5",children:[P.jsx("span",{className:"w-2 h-2 bg-emerald-500 rounded-full animate-pulse"}),P.jsx("span",{className:"text-xs text-emerald-400 font-medium",children:"Online"})]}):A.status==="handshake"?P.jsxs("div",{className:"flex items-center space-x-1.5",children:[P.jsx("span",{className:"w-2 h-2 bg-yellow-500 rounded-full animate-pulse"}),P.jsx("span",{className:"text-xs text-yellow-400 font-medium",children:"Connecting"})]}):A.status==="failed"?P.jsxs("div",{className:"flex items-center space-x-1.5",children:[P.jsx("span",{className:"w-2 h-2 bg-red-500 rounded-full"}),P.jsx("span",{className:"text-xs text-red-400 font-medium",children:"Failed"})]}):P.jsx("span",{className:"text-xs text-slate-500 font-medium",children:"Offline"})})})]}),P.jsxs("div",{className:"flex space-x-1",children:[P.jsx("button",{onClick:()=>S(!0),className:"p-2 hover:bg-slate-700/50 rounded-full transition-colors text-slate-400 hover:text-white",title:"Edit Profile",children:P.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:P.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z"})})}),P.jsx("button",{className:"p-2 hover:bg-slate-700/50 rounded-full transition-colors text-slate-400 hover:text-white",title:"Voice call",children:P.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:P.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"})})}),P.jsx("button",{className:"p-2 hover:bg-slate-700/50 rounded-full transition-colors text-slate-400 hover:text-white",title:"Video call",children:P.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:P.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 10l4.553-2.276A1 1 0 0121 8.618v6.764a1 1 0 01-1.447.894L15 14M5 18h8a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z"})})})]})]}),P.jsxs("div",{ref:k,onScroll:U,className:"flex-1 overflow-y-auto p-4 space-y-6",children:[y&&P.jsx("div",{className:"flex justify-center py-2",children:P.jsxs("svg",{className:"w-5 h-5 animate-spin text-slate-400",fill:"none",viewBox:"0 0 24 24",children:[P.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),P.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"})]})}),q.length===0?P.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-center opacity-50",children:[P.jsx("div",{className:"w-20 h-20 bg-slate-800 rounded-full flex items-center justify-center mb-4 border border-slate-700",children:P.jsx("svg",{className:"w-10 h-10 text-indigo-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:P.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"})})}),P.jsx("h3",{className:"text-lg font-semibold text-slate-300 mb-2",children:"No messages yet"}),P.jsx("p",{className:"text-slate-500 text-sm",children:"Send a message to start the conversation"})]}):P.jsxs(P.Fragment,{children:[q.map(z=>{const $=z.from===i.userId;return P.jsx("div",{className:`flex ${$?"justify-end":"justify-start"} animate-fade-in group`,children:P.jsxs("div",{className:`max-w-xs lg:max-w-md xl:max-w-lg ${$?"order-2":"order-1"}`,children:[P.jsx("div",{className:`rounded-2xl px-5 py-3 shadow-sm ${$?"bg-indigo-600 text-white rounded-br-sm shadow-indigo-500/10":"bg-[var(--color-bg-card)] text-slate-200 rounded-bl-sm border border-slate-700/50"}`,children:P.jsx("p",{className:"text-sm whitespace-pre-wrap break-words leading-relaxed",children:z.content})}),P.jsxs("div",{className:`flex items-center space-x-2 mt-1.5 px-1 ${$?"justify-end":"justify-start"}`,children:[P.jsx("span",{className:"text-[11px] text-slate-500 font-medium",children:Nj(z.timestamp)}),$&&z.msg_id!==void 0&&P.jsx("button",{onClick:()=>Y(z.msg_id),className:"opacity-0 group-hover:opacity-100 p-1 text-slate-500 hover:text-red-400 transition-all",title:"Delete message",children:P.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:P.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})}),$&&P.jsxs(P.Fragment,{children:[z.delivered&&P.jsx("span",{className:"text-[11px] text-indigo-400",children:"Received"}),!z.delivered&&!z.showAsFailedInUI&&P.jsxs("span",{className:"text-[11px] text-slate-500 flex items-center",children:[P.jsx("svg",{className:"w-3 h-3 animate-spin mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:P.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),"Pending"]}),!z.delivered&&z.showAsFailedInUI&&P.jsxs("div",{className:"flex items-center space-x-2",children:[P.jsxs("span",{className:"text-[11px] text-red-400 flex items-center",title:z.error,children:[P.jsx("svg",{className:"w-3 h-3 mr-1",fill:"currentColor",viewBox:"0 0 20 20",children:P.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})}),"Failed"]}),P.jsx("button",{onClick:()=>G(z),className:"text-[11px] text-indigo-400 hover:text-indigo-300 underline",children:"Retry"})]})]})]})]})},z.msg_uuid)}),P.jsx("div",{ref:x})]})]}),P.jsxs("div",{className:"bg-[var(--color-bg-card)] border-t border-slate-700/50 p-4",children:[A.status!=="online"&&P.jsxs("div",{className:"flex items-center justify-center py-2 px-4 bg-yellow-900/20 border border-yellow-700/50 rounded-lg mb-3 max-w-4xl mx-auto",children:[P.jsx("svg",{className:"w-5 h-5 text-yellow-500 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:P.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),P.jsx("span",{className:"text-sm text-yellow-400",children:A.status==="handshake"?"Establishing secure connection...":A.status==="failed"?"Connection failed. Messages will be queued.":"Contact is disconnected. Messages might be delayed."})]}),P.jsxs("div",{className:"flex items-end space-x-3 max-w-4xl mx-auto",children:[P.jsx("div",{className:"flex-1 relative",children:P.jsx("textarea",{value:f,onChange:z=>d(z.target.value),onKeyPress:O,placeholder:"Type a message...",rows:1,className:"w-full px-5 py-3.5 bg-slate-900/50 border border-slate-700 rounded-2xl focus:outline-none focus:ring-2 focus:ring-indigo-500/50 focus:border-indigo-500/50 text-slate-200 placeholder-slate-500 resize-none transition-all",style:{minHeight:"50px",maxHeight:"120px"}})}),P.jsx("button",{onClick:te,disabled:!f.trim()||p,className:`p-3.5 rounded-xl transition-all shadow-lg ${f.trim()&&!p?"bg-indigo-600 hover:bg-indigo-500 text-white shadow-indigo-500/20 hover:shadow-indigo-500/40 active:scale-95":"bg-slate-800 text-slate-600 cursor-not-allowed"}`,children:p?P.jsx("svg",{className:"w-6 h-6 animate-spin",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:P.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}):P.jsx("svg",{className:"w-6 h-6 transform rotate-90",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:P.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 19l9 2-9-18-9 18 9-2zm0 0v-8"})})})]}),P.jsxs("p",{className:"text-[10px] text-slate-500 mt-3 text-center flex items-center justify-center gap-1.5 uppercase tracking-widest font-medium opacity-60",children:[P.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:P.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"})}),"End-to-End Encrypted"]})]}),C&&P.jsx(Rj,{contactId:A.userId,onClose:()=>S(!1)})]})}function Nj(i){const e=new Date(i),t=new Date,n=t.getTime()-e.getTime();return e.toDateString()===t.toDateString()?e.toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0}):n<10080*60*1e3?e.toLocaleDateString("en-US",{weekday:"short"})+" "+e.toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0}):e.toLocaleDateString("en-US",{month:"short",day:"numeric"})+" "+e.toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0})}const Bj=()=>typeof window<"u"&&window.__TEST_MODE__===!0;async function jj(){return"Notification"in window?Notification.permission==="granted"?!0:Notification.permission==="denied"?!1:await Notification.requestPermission()==="granted":!1}function Dj(i,e){"Notification"in window&&Notification.permission==="granted"&&document.visibilityState!=="visible"&&new Notification(i,{body:e,icon:"/icon-192.png",tag:"chat-message"})}function Pj(){const{identity:i,activeView:e,setIdentity:t,setActiveView:n,setInitialized:s,signalingSettings:a}=os(),[l,u]=jt.useState(!1);jt.useEffect(()=>{const d=os.persist.onFinishHydration(()=>u(!0));return os.persist.hasHydrated()&&u(!0),d},[]);const[,c]=jt.useState(null),f=jt.useRef(null);return jt.useEffect(()=>{const d=El.load();d?(t(d),window.history.replaceState({view:"contacts"},""),n("contacts")):s(!0)},[t,n,s]),jt.useEffect(()=>{const d=p=>{p.state?.view?n(p.state.view):i&&n("contacts")};return window.addEventListener("popstate",d),()=>window.removeEventListener("popstate",d)},[n,i]),jt.useEffect(()=>{if(!i)return;window.history.state?.view!==e&&window.history.pushState({view:e},"",`#${e}`)},[e,i]),jt.useEffect(()=>((async()=>{if(!(!i||!l)){if(f.current===i.userId){console.log("[App] Transport already initialized for this identity (React guard)");const{useContactStore:p}=await kg(async()=>{const{useContactStore:m}=await Promise.resolve().then(()=>P2);return{useContactStore:m}},void 0);p.getState().loaded||(console.log("[App] Reloading contacts after HMR"),await p.getState().loadContacts());return}console.log("[App] Initializing transport for identity:",i.userId.substring(0,8)),f.current=i.userId;try{const p=Wu(a);await Ir.initialize(i,p);const{initRetryService:m,setRetryTimeoutCallback:v}=await kg(async()=>{const{initRetryService:w,setRetryTimeoutCallback:C}=await Promise.resolve().then(()=>kj);return{initRetryService:w,setRetryTimeoutCallback:C}},void 0);m(i.userId,Bj()?{minPeerInterval:2e3,timerInterval:100,timeoutMs:5e3}:{minPeerInterval:5e3,timerInterval:300,timeoutMs:3e4}),v(async w=>{const{updateMessageDelivery:C}=Ic.getState();await wr.updateMessageDelivery(w,!1,!0),C(w,!1,!0)});const{useContactStore:b}=await kg(async()=>{const{useContactStore:w}=await Promise.resolve().then(()=>P2);return{useContactStore:w}},void 0);await b.getState().loadContacts(),console.log("[App]  Contacts loaded and registered with transport"),jj();const{addMessage:y}=Ic.getState();Ir.onMessage(async(w,C)=>{if(C.type==="ack"){console.log("[App] Received ACK for message:",C.id);const{getMessage:te,updateMessageDelivery:G}=Ic.getState();let Y=te(C.id);Y||(Y=await wr.getMessageByUuid(C.id)),Y?.msg_id!==void 0&&(await wr.updateMessageDelivery(Y.msg_id,!0),G(Y.msg_id,!0,!1)),Gk(w,C.id),Kk(w);return}const S=[i.userId,w].sort().join("-"),x=Sj(C,w,S);await wr.addMessage(x),y(S,x);const{activeContactId:k,activeView:A}=os.getState();A==="chat"&&k===w||b.getState().incrementUnread(w);const I=b.getState().getContact(w),U=I?.localProfile?.name||I?.peerProfile?.name||`User ${w.slice(0,8)}`;if(Dj(U,C.content||"New message"),i)try{await Ir.sendMessage(w,_j(C.id,C.timestamp)),console.log("[App] Sent ACK for:",C.id)}catch(te){console.error("[App] Failed to send ACK:",te)}})}catch(p){console.error("[App] Transport initialization failed:",p),f.current=null,c(p instanceof Error?p.message:"Failed to initialize network connection")}}})(),()=>{console.log("[App] Component unmount - preserving all state")}),[i,l]),!i||e==="setup"?P.jsx(XN,{}):P.jsxs("div",{className:"flex h-screen overflow-hidden bg-[var(--color-bg-dark)]",children:[P.jsx("div",{className:`
        ${e==="contacts"?"flex w-full":e==="settings"?"hidden":"hidden md:flex md:w-80 lg:w-96 border-r border-slate-700/50"}
        flex-col h-full z-20 bg-[var(--color-bg-dark)] transition-all duration-300
      `,children:P.jsx(wj,{})}),P.jsxs("div",{className:`
        ${e==="contacts"?"hidden":"flex"}
        flex-1 flex-col h-full relative z-10 bg-[var(--color-bg-dark)]
      `,children:[e==="settings"&&P.jsx(Ij,{}),e==="chat"&&P.jsx(Oj,{})]})]})}w3.createRoot(document.getElementById("root")).render(P.jsx(jt.StrictMode,{children:P.jsx(Pj,{})}));

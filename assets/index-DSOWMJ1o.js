function ay(u,r){for(var i=0;i<r.length;i++){const s=r[i];if(typeof s!="string"&&!Array.isArray(s)){for(const c in s)if(c!=="default"&&!(c in u)){const m=Object.getOwnPropertyDescriptor(s,c);m&&Object.defineProperty(u,c,m.get?m:{enumerable:!0,get:()=>s[c]})}}}return Object.freeze(Object.defineProperty(u,Symbol.toStringTag,{value:"Module"}))}(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const c of document.querySelectorAll('link[rel="modulepreload"]'))s(c);new MutationObserver(c=>{for(const m of c)if(m.type==="childList")for(const _ of m.addedNodes)_.tagName==="LINK"&&_.rel==="modulepreload"&&s(_)}).observe(document,{childList:!0,subtree:!0});function i(c){const m={};return c.integrity&&(m.integrity=c.integrity),c.referrerPolicy&&(m.referrerPolicy=c.referrerPolicy),c.crossOrigin==="use-credentials"?m.credentials="include":c.crossOrigin==="anonymous"?m.credentials="omit":m.credentials="same-origin",m}function s(c){if(c.ep)return;c.ep=!0;const m=i(c);fetch(c.href,m)}})();var iy=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Qo(u){return u&&u.__esModule&&Object.prototype.hasOwnProperty.call(u,"default")?u.default:u}function sy(u){if(Object.prototype.hasOwnProperty.call(u,"__esModule"))return u;var r=u.default;if(typeof r=="function"){var i=function s(){var c=!1;try{c=this instanceof s}catch{}return c?Reflect.construct(r,arguments,this.constructor):r.apply(this,arguments)};i.prototype=r.prototype}else i={};return Object.defineProperty(i,"__esModule",{value:!0}),Object.keys(u).forEach(function(s){var c=Object.getOwnPropertyDescriptor(u,s);Object.defineProperty(i,s,c.get?c:{enumerable:!0,get:function(){return u[s]}})}),i}var pf={exports:{}},Io={};var J0;function oy(){if(J0)return Io;J0=1;var u=Symbol.for("react.transitional.element"),r=Symbol.for("react.fragment");function i(s,c,m){var _=null;if(m!==void 0&&(_=""+m),c.key!==void 0&&(_=""+c.key),"key"in c){m={};for(var w in c)w!=="key"&&(m[w]=c[w])}else m=c;return c=m.ref,{$$typeof:u,type:s,key:_,ref:c!==void 0?c:null,props:m}}return Io.Fragment=r,Io.jsx=i,Io.jsxs=i,Io}var W0;function ly(){return W0||(W0=1,pf.exports=oy()),pf.exports}var y=ly(),mf={exports:{}},Lt={};var ep;function cy(){if(ep)return Lt;ep=1;var u=Symbol.for("react.transitional.element"),r=Symbol.for("react.portal"),i=Symbol.for("react.fragment"),s=Symbol.for("react.strict_mode"),c=Symbol.for("react.profiler"),m=Symbol.for("react.consumer"),_=Symbol.for("react.context"),w=Symbol.for("react.forward_ref"),x=Symbol.for("react.suspense"),S=Symbol.for("react.memo"),E=Symbol.for("react.lazy"),R=Symbol.for("react.activity"),N=Symbol.iterator;function q(L){return L===null||typeof L!="object"?null:(L=N&&L[N]||L["@@iterator"],typeof L=="function"?L:null)}var ie={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},se=Object.assign,Re={};function lt(L,de,Ce){this.props=L,this.context=de,this.refs=Re,this.updater=Ce||ie}lt.prototype.isReactComponent={},lt.prototype.setState=function(L,de){if(typeof L!="object"&&typeof L!="function"&&L!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,L,de,"setState")},lt.prototype.forceUpdate=function(L){this.updater.enqueueForceUpdate(this,L,"forceUpdate")};function ke(){}ke.prototype=lt.prototype;function we(L,de,Ce){this.props=L,this.context=de,this.refs=Re,this.updater=Ce||ie}var $e=we.prototype=new ke;$e.constructor=we,se($e,lt.prototype),$e.isPureReactComponent=!0;var Je=Array.isArray;function ft(){}var et={H:null,A:null,T:null,S:null},qt=Object.prototype.hasOwnProperty;function en(L,de,Ce){var Le=Ce.ref;return{$$typeof:u,type:L,key:de,ref:Le!==void 0?Le:null,props:Ce}}function Oe(L,de){return en(L.type,de,L.props)}function Te(L){return typeof L=="object"&&L!==null&&L.$$typeof===u}function pe(L){var de={"=":"=0",":":"=2"};return"$"+L.replace(/[=:]/g,function(Ce){return de[Ce]})}var ue=/\/+/g;function xt(L,de){return typeof L=="object"&&L!==null&&L.key!=null?pe(""+L.key):de.toString(36)}function qe(L){switch(L.status){case"fulfilled":return L.value;case"rejected":throw L.reason;default:switch(typeof L.status=="string"?L.then(ft,ft):(L.status="pending",L.then(function(de){L.status==="pending"&&(L.status="fulfilled",L.value=de)},function(de){L.status==="pending"&&(L.status="rejected",L.reason=de)})),L.status){case"fulfilled":return L.value;case"rejected":throw L.reason}}throw L}function J(L,de,Ce,Le,De){var Ee=typeof L;(Ee==="undefined"||Ee==="boolean")&&(L=null);var dt=!1;if(L===null)dt=!0;else switch(Ee){case"bigint":case"string":case"number":dt=!0;break;case"object":switch(L.$$typeof){case u:case r:dt=!0;break;case E:return dt=L._init,J(dt(L._payload),de,Ce,Le,De)}}if(dt)return De=De(L),dt=Le===""?"."+xt(L,0):Le,Je(De)?(Ce="",dt!=null&&(Ce=dt.replace(ue,"$&/")+"/"),J(De,de,Ce,"",function(ct){return ct})):De!=null&&(Te(De)&&(De=Oe(De,Ce+(De.key==null||L&&L.key===De.key?"":(""+De.key).replace(ue,"$&/")+"/")+dt)),de.push(De)),1;dt=0;var kt=Le===""?".":Le+":";if(Je(L))for(var ze=0;ze<L.length;ze++)Le=L[ze],Ee=kt+xt(Le,ze),dt+=J(Le,de,Ce,Ee,De);else if(ze=q(L),typeof ze=="function")for(L=ze.call(L),ze=0;!(Le=L.next()).done;)Le=Le.value,Ee=kt+xt(Le,ze++),dt+=J(Le,de,Ce,Ee,De);else if(Ee==="object"){if(typeof L.then=="function")return J(qe(L),de,Ce,Le,De);throw de=String(L),Error("Objects are not valid as a React child (found: "+(de==="[object Object]"?"object with keys {"+Object.keys(L).join(", ")+"}":de)+"). If you meant to render a collection of children, use an array instead.")}return dt}function Me(L,de,Ce){if(L==null)return L;var Le=[],De=0;return J(L,Le,"","",function(Ee){return de.call(Ce,Ee,De++)}),Le}function Ge(L){if(L._status===-1){var de=L._result;de=de(),de.then(function(Ce){(L._status===0||L._status===-1)&&(L._status=1,L._result=Ce)},function(Ce){(L._status===0||L._status===-1)&&(L._status=2,L._result=Ce)}),L._status===-1&&(L._status=0,L._result=de)}if(L._status===1)return L._result.default;throw L._result}var je=typeof reportError=="function"?reportError:function(L){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var de=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof L=="object"&&L!==null&&typeof L.message=="string"?String(L.message):String(L),error:L});if(!window.dispatchEvent(de))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",L);return}console.error(L)},Ye={map:Me,forEach:function(L,de,Ce){Me(L,function(){de.apply(this,arguments)},Ce)},count:function(L){var de=0;return Me(L,function(){de++}),de},toArray:function(L){return Me(L,function(de){return de})||[]},only:function(L){if(!Te(L))throw Error("React.Children.only expected to receive a single React element child.");return L}};return Lt.Activity=R,Lt.Children=Ye,Lt.Component=lt,Lt.Fragment=i,Lt.Profiler=c,Lt.PureComponent=we,Lt.StrictMode=s,Lt.Suspense=x,Lt.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=et,Lt.__COMPILER_RUNTIME={__proto__:null,c:function(L){return et.H.useMemoCache(L)}},Lt.cache=function(L){return function(){return L.apply(null,arguments)}},Lt.cacheSignal=function(){return null},Lt.cloneElement=function(L,de,Ce){if(L==null)throw Error("The argument must be a React element, but you passed "+L+".");var Le=se({},L.props),De=L.key;if(de!=null)for(Ee in de.key!==void 0&&(De=""+de.key),de)!qt.call(de,Ee)||Ee==="key"||Ee==="__self"||Ee==="__source"||Ee==="ref"&&de.ref===void 0||(Le[Ee]=de[Ee]);var Ee=arguments.length-2;if(Ee===1)Le.children=Ce;else if(1<Ee){for(var dt=Array(Ee),kt=0;kt<Ee;kt++)dt[kt]=arguments[kt+2];Le.children=dt}return en(L.type,De,Le)},Lt.createContext=function(L){return L={$$typeof:_,_currentValue:L,_currentValue2:L,_threadCount:0,Provider:null,Consumer:null},L.Provider=L,L.Consumer={$$typeof:m,_context:L},L},Lt.createElement=function(L,de,Ce){var Le,De={},Ee=null;if(de!=null)for(Le in de.key!==void 0&&(Ee=""+de.key),de)qt.call(de,Le)&&Le!=="key"&&Le!=="__self"&&Le!=="__source"&&(De[Le]=de[Le]);var dt=arguments.length-2;if(dt===1)De.children=Ce;else if(1<dt){for(var kt=Array(dt),ze=0;ze<dt;ze++)kt[ze]=arguments[ze+2];De.children=kt}if(L&&L.defaultProps)for(Le in dt=L.defaultProps,dt)De[Le]===void 0&&(De[Le]=dt[Le]);return en(L,Ee,De)},Lt.createRef=function(){return{current:null}},Lt.forwardRef=function(L){return{$$typeof:w,render:L}},Lt.isValidElement=Te,Lt.lazy=function(L){return{$$typeof:E,_payload:{_status:-1,_result:L},_init:Ge}},Lt.memo=function(L,de){return{$$typeof:S,type:L,compare:de===void 0?null:de}},Lt.startTransition=function(L){var de=et.T,Ce={};et.T=Ce;try{var Le=L(),De=et.S;De!==null&&De(Ce,Le),typeof Le=="object"&&Le!==null&&typeof Le.then=="function"&&Le.then(ft,je)}catch(Ee){je(Ee)}finally{de!==null&&Ce.types!==null&&(de.types=Ce.types),et.T=de}},Lt.unstable_useCacheRefresh=function(){return et.H.useCacheRefresh()},Lt.use=function(L){return et.H.use(L)},Lt.useActionState=function(L,de,Ce){return et.H.useActionState(L,de,Ce)},Lt.useCallback=function(L,de){return et.H.useCallback(L,de)},Lt.useContext=function(L){return et.H.useContext(L)},Lt.useDebugValue=function(){},Lt.useDeferredValue=function(L,de){return et.H.useDeferredValue(L,de)},Lt.useEffect=function(L,de){return et.H.useEffect(L,de)},Lt.useEffectEvent=function(L){return et.H.useEffectEvent(L)},Lt.useId=function(){return et.H.useId()},Lt.useImperativeHandle=function(L,de,Ce){return et.H.useImperativeHandle(L,de,Ce)},Lt.useInsertionEffect=function(L,de){return et.H.useInsertionEffect(L,de)},Lt.useLayoutEffect=function(L,de){return et.H.useLayoutEffect(L,de)},Lt.useMemo=function(L,de){return et.H.useMemo(L,de)},Lt.useOptimistic=function(L,de){return et.H.useOptimistic(L,de)},Lt.useReducer=function(L,de,Ce){return et.H.useReducer(L,de,Ce)},Lt.useRef=function(L){return et.H.useRef(L)},Lt.useState=function(L){return et.H.useState(L)},Lt.useSyncExternalStore=function(L,de,Ce){return et.H.useSyncExternalStore(L,de,Ce)},Lt.useTransition=function(){return et.H.useTransition()},Lt.version="19.2.0",Lt}var tp;function Yf(){return tp||(tp=1,mf.exports=cy()),mf.exports}var yt=Yf();const jn=Qo(yt);var gf={exports:{}},Ko={},yf={exports:{}},vf={};var np;function uy(){return np||(np=1,(function(u){function r(J,Me){var Ge=J.length;J.push(Me);e:for(;0<Ge;){var je=Ge-1>>>1,Ye=J[je];if(0<c(Ye,Me))J[je]=Me,J[Ge]=Ye,Ge=je;else break e}}function i(J){return J.length===0?null:J[0]}function s(J){if(J.length===0)return null;var Me=J[0],Ge=J.pop();if(Ge!==Me){J[0]=Ge;e:for(var je=0,Ye=J.length,L=Ye>>>1;je<L;){var de=2*(je+1)-1,Ce=J[de],Le=de+1,De=J[Le];if(0>c(Ce,Ge))Le<Ye&&0>c(De,Ce)?(J[je]=De,J[Le]=Ge,je=Le):(J[je]=Ce,J[de]=Ge,je=de);else if(Le<Ye&&0>c(De,Ge))J[je]=De,J[Le]=Ge,je=Le;else break e}}return Me}function c(J,Me){var Ge=J.sortIndex-Me.sortIndex;return Ge!==0?Ge:J.id-Me.id}if(u.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var m=performance;u.unstable_now=function(){return m.now()}}else{var _=Date,w=_.now();u.unstable_now=function(){return _.now()-w}}var x=[],S=[],E=1,R=null,N=3,q=!1,ie=!1,se=!1,Re=!1,lt=typeof setTimeout=="function"?setTimeout:null,ke=typeof clearTimeout=="function"?clearTimeout:null,we=typeof setImmediate<"u"?setImmediate:null;function $e(J){for(var Me=i(S);Me!==null;){if(Me.callback===null)s(S);else if(Me.startTime<=J)s(S),Me.sortIndex=Me.expirationTime,r(x,Me);else break;Me=i(S)}}function Je(J){if(se=!1,$e(J),!ie)if(i(x)!==null)ie=!0,ft||(ft=!0,pe());else{var Me=i(S);Me!==null&&qe(Je,Me.startTime-J)}}var ft=!1,et=-1,qt=5,en=-1;function Oe(){return Re?!0:!(u.unstable_now()-en<qt)}function Te(){if(Re=!1,ft){var J=u.unstable_now();en=J;var Me=!0;try{e:{ie=!1,se&&(se=!1,ke(et),et=-1),q=!0;var Ge=N;try{t:{for($e(J),R=i(x);R!==null&&!(R.expirationTime>J&&Oe());){var je=R.callback;if(typeof je=="function"){R.callback=null,N=R.priorityLevel;var Ye=je(R.expirationTime<=J);if(J=u.unstable_now(),typeof Ye=="function"){R.callback=Ye,$e(J),Me=!0;break t}R===i(x)&&s(x),$e(J)}else s(x);R=i(x)}if(R!==null)Me=!0;else{var L=i(S);L!==null&&qe(Je,L.startTime-J),Me=!1}}break e}finally{R=null,N=Ge,q=!1}Me=void 0}}finally{Me?pe():ft=!1}}}var pe;if(typeof we=="function")pe=function(){we(Te)};else if(typeof MessageChannel<"u"){var ue=new MessageChannel,xt=ue.port2;ue.port1.onmessage=Te,pe=function(){xt.postMessage(null)}}else pe=function(){lt(Te,0)};function qe(J,Me){et=lt(function(){J(u.unstable_now())},Me)}u.unstable_IdlePriority=5,u.unstable_ImmediatePriority=1,u.unstable_LowPriority=4,u.unstable_NormalPriority=3,u.unstable_Profiling=null,u.unstable_UserBlockingPriority=2,u.unstable_cancelCallback=function(J){J.callback=null},u.unstable_forceFrameRate=function(J){0>J||125<J?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):qt=0<J?Math.floor(1e3/J):5},u.unstable_getCurrentPriorityLevel=function(){return N},u.unstable_next=function(J){switch(N){case 1:case 2:case 3:var Me=3;break;default:Me=N}var Ge=N;N=Me;try{return J()}finally{N=Ge}},u.unstable_requestPaint=function(){Re=!0},u.unstable_runWithPriority=function(J,Me){switch(J){case 1:case 2:case 3:case 4:case 5:break;default:J=3}var Ge=N;N=J;try{return Me()}finally{N=Ge}},u.unstable_scheduleCallback=function(J,Me,Ge){var je=u.unstable_now();switch(typeof Ge=="object"&&Ge!==null?(Ge=Ge.delay,Ge=typeof Ge=="number"&&0<Ge?je+Ge:je):Ge=je,J){case 1:var Ye=-1;break;case 2:Ye=250;break;case 5:Ye=1073741823;break;case 4:Ye=1e4;break;default:Ye=5e3}return Ye=Ge+Ye,J={id:E++,callback:Me,priorityLevel:J,startTime:Ge,expirationTime:Ye,sortIndex:-1},Ge>je?(J.sortIndex=Ge,r(S,J),i(x)===null&&J===i(S)&&(se?(ke(et),et=-1):se=!0,qe(Je,Ge-je))):(J.sortIndex=Ye,r(x,J),ie||q||(ie=!0,ft||(ft=!0,pe()))),J},u.unstable_shouldYield=Oe,u.unstable_wrapCallback=function(J){var Me=N;return function(){var Ge=N;N=Me;try{return J.apply(this,arguments)}finally{N=Ge}}}})(vf)),vf}var rp;function fy(){return rp||(rp=1,yf.exports=uy()),yf.exports}var xf={exports:{}},fr={};var ap;function dy(){if(ap)return fr;ap=1;var u=Yf();function r(x){var S="https://react.dev/errors/"+x;if(1<arguments.length){S+="?args[]="+encodeURIComponent(arguments[1]);for(var E=2;E<arguments.length;E++)S+="&args[]="+encodeURIComponent(arguments[E])}return"Minified React error #"+x+"; visit "+S+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function i(){}var s={d:{f:i,r:function(){throw Error(r(522))},D:i,C:i,L:i,m:i,X:i,S:i,M:i},p:0,findDOMNode:null},c=Symbol.for("react.portal");function m(x,S,E){var R=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:c,key:R==null?null:""+R,children:x,containerInfo:S,implementation:E}}var _=u.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function w(x,S){if(x==="font")return"";if(typeof S=="string")return S==="use-credentials"?S:""}return fr.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=s,fr.createPortal=function(x,S){var E=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!S||S.nodeType!==1&&S.nodeType!==9&&S.nodeType!==11)throw Error(r(299));return m(x,S,null,E)},fr.flushSync=function(x){var S=_.T,E=s.p;try{if(_.T=null,s.p=2,x)return x()}finally{_.T=S,s.p=E,s.d.f()}},fr.preconnect=function(x,S){typeof x=="string"&&(S?(S=S.crossOrigin,S=typeof S=="string"?S==="use-credentials"?S:"":void 0):S=null,s.d.C(x,S))},fr.prefetchDNS=function(x){typeof x=="string"&&s.d.D(x)},fr.preinit=function(x,S){if(typeof x=="string"&&S&&typeof S.as=="string"){var E=S.as,R=w(E,S.crossOrigin),N=typeof S.integrity=="string"?S.integrity:void 0,q=typeof S.fetchPriority=="string"?S.fetchPriority:void 0;E==="style"?s.d.S(x,typeof S.precedence=="string"?S.precedence:void 0,{crossOrigin:R,integrity:N,fetchPriority:q}):E==="script"&&s.d.X(x,{crossOrigin:R,integrity:N,fetchPriority:q,nonce:typeof S.nonce=="string"?S.nonce:void 0})}},fr.preinitModule=function(x,S){if(typeof x=="string")if(typeof S=="object"&&S!==null){if(S.as==null||S.as==="script"){var E=w(S.as,S.crossOrigin);s.d.M(x,{crossOrigin:E,integrity:typeof S.integrity=="string"?S.integrity:void 0,nonce:typeof S.nonce=="string"?S.nonce:void 0})}}else S==null&&s.d.M(x)},fr.preload=function(x,S){if(typeof x=="string"&&typeof S=="object"&&S!==null&&typeof S.as=="string"){var E=S.as,R=w(E,S.crossOrigin);s.d.L(x,E,{crossOrigin:R,integrity:typeof S.integrity=="string"?S.integrity:void 0,nonce:typeof S.nonce=="string"?S.nonce:void 0,type:typeof S.type=="string"?S.type:void 0,fetchPriority:typeof S.fetchPriority=="string"?S.fetchPriority:void 0,referrerPolicy:typeof S.referrerPolicy=="string"?S.referrerPolicy:void 0,imageSrcSet:typeof S.imageSrcSet=="string"?S.imageSrcSet:void 0,imageSizes:typeof S.imageSizes=="string"?S.imageSizes:void 0,media:typeof S.media=="string"?S.media:void 0})}},fr.preloadModule=function(x,S){if(typeof x=="string")if(S){var E=w(S.as,S.crossOrigin);s.d.m(x,{as:typeof S.as=="string"&&S.as!=="script"?S.as:void 0,crossOrigin:E,integrity:typeof S.integrity=="string"?S.integrity:void 0})}else s.d.m(x)},fr.requestFormReset=function(x){s.d.r(x)},fr.unstable_batchedUpdates=function(x,S){return x(S)},fr.useFormState=function(x,S,E){return _.H.useFormState(x,S,E)},fr.useFormStatus=function(){return _.H.useHostTransitionStatus()},fr.version="19.2.0",fr}var ip;function hy(){if(ip)return xf.exports;ip=1;function u(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(u)}catch(r){console.error(r)}}return u(),xf.exports=dy(),xf.exports}var sp;function py(){if(sp)return Ko;sp=1;var u=fy(),r=Yf(),i=hy();function s(e){var t="https://react.dev/errors/"+e;if(1<arguments.length){t+="?args[]="+encodeURIComponent(arguments[1]);for(var n=2;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n])}return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function c(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function m(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,(t.flags&4098)!==0&&(n=t.return),e=t.return;while(e)}return t.tag===3?n:null}function _(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function w(e){if(e.tag===31){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function x(e){if(m(e)!==e)throw Error(s(188))}function S(e){var t=e.alternate;if(!t){if(t=m(e),t===null)throw Error(s(188));return t!==e?null:e}for(var n=e,a=t;;){var l=n.return;if(l===null)break;var d=l.alternate;if(d===null){if(a=l.return,a!==null){n=a;continue}break}if(l.child===d.child){for(d=l.child;d;){if(d===n)return x(l),e;if(d===a)return x(l),t;d=d.sibling}throw Error(s(188))}if(n.return!==a.return)n=l,a=d;else{for(var v=!1,j=l.child;j;){if(j===n){v=!0,n=l,a=d;break}if(j===a){v=!0,a=l,n=d;break}j=j.sibling}if(!v){for(j=d.child;j;){if(j===n){v=!0,n=d,a=l;break}if(j===a){v=!0,a=d,n=l;break}j=j.sibling}if(!v)throw Error(s(189))}}if(n.alternate!==a)throw Error(s(190))}if(n.tag!==3)throw Error(s(188));return n.stateNode.current===n?e:t}function E(e){var t=e.tag;if(t===5||t===26||t===27||t===6)return e;for(e=e.child;e!==null;){if(t=E(e),t!==null)return t;e=e.sibling}return null}var R=Object.assign,N=Symbol.for("react.element"),q=Symbol.for("react.transitional.element"),ie=Symbol.for("react.portal"),se=Symbol.for("react.fragment"),Re=Symbol.for("react.strict_mode"),lt=Symbol.for("react.profiler"),ke=Symbol.for("react.consumer"),we=Symbol.for("react.context"),$e=Symbol.for("react.forward_ref"),Je=Symbol.for("react.suspense"),ft=Symbol.for("react.suspense_list"),et=Symbol.for("react.memo"),qt=Symbol.for("react.lazy"),en=Symbol.for("react.activity"),Oe=Symbol.for("react.memo_cache_sentinel"),Te=Symbol.iterator;function pe(e){return e===null||typeof e!="object"?null:(e=Te&&e[Te]||e["@@iterator"],typeof e=="function"?e:null)}var ue=Symbol.for("react.client.reference");function xt(e){if(e==null)return null;if(typeof e=="function")return e.$$typeof===ue?null:e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case se:return"Fragment";case lt:return"Profiler";case Re:return"StrictMode";case Je:return"Suspense";case ft:return"SuspenseList";case en:return"Activity"}if(typeof e=="object")switch(e.$$typeof){case ie:return"Portal";case we:return e.displayName||"Context";case ke:return(e._context.displayName||"Context")+".Consumer";case $e:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case et:return t=e.displayName||null,t!==null?t:xt(e.type)||"Memo";case qt:t=e._payload,e=e._init;try{return xt(e(t))}catch{}}return null}var qe=Array.isArray,J=r.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Me=i.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Ge={pending:!1,data:null,method:null,action:null},je=[],Ye=-1;function L(e){return{current:e}}function de(e){0>Ye||(e.current=je[Ye],je[Ye]=null,Ye--)}function Ce(e,t){Ye++,je[Ye]=e.current,e.current=t}var Le=L(null),De=L(null),Ee=L(null),dt=L(null);function kt(e,t){switch(Ce(Ee,t),Ce(De,e),Ce(Le,null),t.nodeType){case 9:case 11:e=(e=t.documentElement)&&(e=e.namespaceURI)?S0(e):0;break;default:if(e=t.tagName,t=t.namespaceURI)t=S0(t),e=_0(t,e);else switch(e){case"svg":e=1;break;case"math":e=2;break;default:e=0}}de(Le),Ce(Le,e)}function ze(){de(Le),de(De),de(Ee)}function ct(e){e.memoizedState!==null&&Ce(dt,e);var t=Le.current,n=_0(t,e.type);t!==n&&(Ce(De,e),Ce(Le,n))}function pn(e){De.current===e&&(de(Le),de(De)),dt.current===e&&(de(dt),Bo._currentValue=Ge)}var Ht,er;function kn(e){if(Ht===void 0)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);Ht=t&&t[1]||"",er=-1<n.stack.indexOf(`
    at`)?" (<anonymous>)":-1<n.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Ht+e+er}var Xn=!1;function Ti(e,t){if(!e||Xn)return"";Xn=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var a={DetermineComponentFrameRoot:function(){try{if(t){var be=function(){throw Error()};if(Object.defineProperty(be.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(be,[])}catch(ce){var re=ce}Reflect.construct(e,[],be)}else{try{be.call()}catch(ce){re=ce}e.call(be.prototype)}}else{try{throw Error()}catch(ce){re=ce}(be=e())&&typeof be.catch=="function"&&be.catch(function(){})}}catch(ce){if(ce&&re&&typeof ce.stack=="string")return[ce.stack,re.stack]}return[null,null]}};a.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var l=Object.getOwnPropertyDescriptor(a.DetermineComponentFrameRoot,"name");l&&l.configurable&&Object.defineProperty(a.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var d=a.DetermineComponentFrameRoot(),v=d[0],j=d[1];if(v&&j){var B=v.split(`
`),te=j.split(`
`);for(l=a=0;a<B.length&&!B[a].includes("DetermineComponentFrameRoot");)a++;for(;l<te.length&&!te[l].includes("DetermineComponentFrameRoot");)l++;if(a===B.length||l===te.length)for(a=B.length-1,l=te.length-1;1<=a&&0<=l&&B[a]!==te[l];)l--;for(;1<=a&&0<=l;a--,l--)if(B[a]!==te[l]){if(a!==1||l!==1)do if(a--,l--,0>l||B[a]!==te[l]){var me=`
`+B[a].replace(" at new "," at ");return e.displayName&&me.includes("<anonymous>")&&(me=me.replace("<anonymous>",e.displayName)),me}while(1<=a&&0<=l);break}}}finally{Xn=!1,Error.prepareStackTrace=n}return(n=e?e.displayName||e.name:"")?kn(n):""}function es(e,t){switch(e.tag){case 26:case 27:case 5:return kn(e.type);case 16:return kn("Lazy");case 13:return e.child!==t&&t!==null?kn("Suspense Fallback"):kn("Suspense");case 19:return kn("SuspenseList");case 0:case 15:return Ti(e.type,!1);case 11:return Ti(e.type.render,!1);case 1:return Ti(e.type,!0);case 31:return kn("Activity");default:return""}}function ki(e){try{var t="",n=null;do t+=es(e,n),n=e,e=e.return;while(e);return t}catch(a){return`
Error generating stack: `+a.message+`
`+a.stack}}var Nr=Object.prototype.hasOwnProperty,Pr=u.unstable_scheduleCallback,tr=u.unstable_cancelCallback,qa=u.unstable_shouldYield,na=u.unstable_requestPaint,Dn=u.unstable_now,ra=u.unstable_getCurrentPriorityLevel,pr=u.unstable_ImmediatePriority,_r=u.unstable_UserBlockingPriority,qr=u.unstable_NormalPriority,ca=u.unstable_LowPriority,Ya=u.unstable_IdlePriority,ua=u.log,Or=u.unstable_setDisableYieldValue,mr=null,Mn=null;function Cn(e){if(typeof ua=="function"&&Or(e),Mn&&typeof Mn.setStrictMode=="function")try{Mn.setStrictMode(mr,e)}catch{}}var Qe=Math.clz32?Math.clz32:Vr,Yr=Math.log,gr=Math.LN2;function Vr(e){return e>>>=0,e===0?32:31-(Yr(e)/gr|0)|0}var He=256,aa=262144,xa=4194304;function Dr(e){var t=e&42;if(t!==0)return t;switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return e&261888;case 262144:case 524288:case 1048576:case 2097152:return e&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return e&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return e}}function nr(e,t,n){var a=e.pendingLanes;if(a===0)return 0;var l=0,d=e.suspendedLanes,v=e.pingedLanes;e=e.warmLanes;var j=a&134217727;return j!==0?(a=j&~d,a!==0?l=Dr(a):(v&=j,v!==0?l=Dr(v):n||(n=j&~e,n!==0&&(l=Dr(n))))):(j=a&~d,j!==0?l=Dr(j):v!==0?l=Dr(v):n||(n=a&~e,n!==0&&(l=Dr(n)))),l===0?0:t!==0&&t!==l&&(t&d)===0&&(d=l&-l,n=t&-t,d>=n||d===32&&(n&4194048)!==0)?t:l}function rr(e,t){return(e.pendingLanes&~(e.suspendedLanes&~e.pingedLanes)&t)===0}function fa(e,t){switch(e){case 1:case 2:case 4:case 8:case 64:return t+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Va(){var e=xa;return xa<<=1,(xa&62914560)===0&&(xa=4194304),e}function Cr(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function yr(e,t){e.pendingLanes|=t,t!==268435456&&(e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0)}function Mi(e,t,n,a,l,d){var v=e.pendingLanes;e.pendingLanes=n,e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0,e.expiredLanes&=n,e.entangledLanes&=n,e.errorRecoveryDisabledLanes&=n,e.shellSuspendCounter=0;var j=e.entanglements,B=e.expirationTimes,te=e.hiddenUpdates;for(n=v&~n;0<n;){var me=31-Qe(n),be=1<<me;j[me]=0,B[me]=-1;var re=te[me];if(re!==null)for(te[me]=null,me=0;me<re.length;me++){var ce=re[me];ce!==null&&(ce.lane&=-536870913)}n&=~be}a!==0&&zn(e,a,0),d!==0&&l===0&&e.tag!==0&&(e.suspendedLanes|=d&~(v&~t))}function zn(e,t,n){e.pendingLanes|=t,e.suspendedLanes&=~t;var a=31-Qe(t);e.entangledLanes|=t,e.entanglements[a]=e.entanglements[a]|1073741824|n&261930}function on(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var a=31-Qe(n),l=1<<a;l&t|e[a]&t&&(e[a]|=t),n&=~l}}function b(e,t){var n=t&-t;return n=(n&42)!==0?1:M(n),(n&(e.suspendedLanes|t))!==0?0:n}function M(e){switch(e){case 2:e=1;break;case 8:e=4;break;case 32:e=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:e=128;break;case 268435456:e=134217728;break;default:e=0}return e}function k(e){return e&=-e,2<e?8<e?(e&134217727)!==0?32:268435456:8:2}function h(){var e=Me.p;return e!==0?e:(e=window.event,e===void 0?32:V0(e.type))}function A(e,t){var n=Me.p;try{return Me.p=e,t()}finally{Me.p=n}}var Q=Math.random().toString(36).slice(2),G="__reactFiber$"+Q,fe="__reactProps$"+Q,_e="__reactContainer$"+Q,at="__reactEvents$"+Q,Xe="__reactListeners$"+Q,Bt="__reactHandles$"+Q,We="__reactResources$"+Q,pt="__reactMarker$"+Q;function Ct(e){delete e[G],delete e[fe],delete e[at],delete e[Xe],delete e[Bt]}function Et(e){var t=e[G];if(t)return t;for(var n=e.parentNode;n;){if(t=n[_e]||n[G]){if(n=t.alternate,t.child!==null||n!==null&&n.child!==null)for(e=j0(e);e!==null;){if(n=e[G])return n;e=j0(e)}return t}e=n,n=e.parentNode}return null}function tt(e){if(e=e[G]||e[_e]){var t=e.tag;if(t===5||t===6||t===13||t===31||t===26||t===27||t===3)return e}return null}function vt(e){var t=e.tag;if(t===5||t===26||t===27||t===6)return e.stateNode;throw Error(s(33))}function ht(e){var t=e[We];return t||(t=e[We]={hoistableStyles:new Map,hoistableScripts:new Map}),t}function it(e){e[pt]=!0}var Fe=new Set,st={};function Ie(e,t){Ze(e,t),Ze(e+"Capture",t)}function Ze(e,t){for(st[e]=t,e=0;e<t.length;e++)Fe.add(t[e])}var nt=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Ve={},ae={};function oe(e){return Nr.call(ae,e)?!0:Nr.call(Ve,e)?!1:nt.test(e)?ae[e]=!0:(Ve[e]=!0,!1)}function le(e,t,n){if(oe(t))if(n===null)e.removeAttribute(t);else{switch(typeof n){case"undefined":case"function":case"symbol":e.removeAttribute(t);return;case"boolean":var a=t.toLowerCase().slice(0,5);if(a!=="data-"&&a!=="aria-"){e.removeAttribute(t);return}}e.setAttribute(t,""+n)}}function ye(e,t,n){if(n===null)e.removeAttribute(t);else{switch(typeof n){case"undefined":case"function":case"symbol":case"boolean":e.removeAttribute(t);return}e.setAttribute(t,""+n)}}function ge(e,t,n,a){if(a===null)e.removeAttribute(n);else{switch(typeof a){case"undefined":case"function":case"symbol":case"boolean":e.removeAttribute(n);return}e.setAttributeNS(t,n,""+a)}}function Se(e){switch(typeof e){case"bigint":case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function mt(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function At(e,t,n){var a=Object.getOwnPropertyDescriptor(e.constructor.prototype,t);if(!e.hasOwnProperty(t)&&typeof a<"u"&&typeof a.get=="function"&&typeof a.set=="function"){var l=a.get,d=a.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return l.call(this)},set:function(v){n=""+v,d.call(this,v)}}),Object.defineProperty(e,t,{enumerable:a.enumerable}),{getValue:function(){return n},setValue:function(v){n=""+v},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function Mt(e){if(!e._valueTracker){var t=mt(e)?"checked":"value";e._valueTracker=At(e,t,""+e[t])}}function jt(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),a="";return e&&(a=mt(e)?e.checked?"true":"false":e.value),e=a,e!==n?(t.setValue(e),!0):!1}function D(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}var Nt=/[\n"\\]/g;function wt(e){return e.replace(Nt,function(t){return"\\"+t.charCodeAt(0).toString(16)+" "})}function Ut(e,t,n,a,l,d,v,j){e.name="",v!=null&&typeof v!="function"&&typeof v!="symbol"&&typeof v!="boolean"?e.type=v:e.removeAttribute("type"),t!=null?v==="number"?(t===0&&e.value===""||e.value!=t)&&(e.value=""+Se(t)):e.value!==""+Se(t)&&(e.value=""+Se(t)):v!=="submit"&&v!=="reset"||e.removeAttribute("value"),t!=null?It(e,v,Se(t)):n!=null?It(e,v,Se(n)):a!=null&&e.removeAttribute("value"),l==null&&d!=null&&(e.defaultChecked=!!d),l!=null&&(e.checked=l&&typeof l!="function"&&typeof l!="symbol"),j!=null&&typeof j!="function"&&typeof j!="symbol"&&typeof j!="boolean"?e.name=""+Se(j):e.removeAttribute("name")}function Ot(e,t,n,a,l,d,v,j){if(d!=null&&typeof d!="function"&&typeof d!="symbol"&&typeof d!="boolean"&&(e.type=d),t!=null||n!=null){if(!(d!=="submit"&&d!=="reset"||t!=null)){Mt(e);return}n=n!=null?""+Se(n):"",t=t!=null?""+Se(t):n,j||t===e.value||(e.value=t),e.defaultValue=t}a=a??l,a=typeof a!="function"&&typeof a!="symbol"&&!!a,e.checked=j?e.checked:!!a,e.defaultChecked=!!a,v!=null&&typeof v!="function"&&typeof v!="symbol"&&typeof v!="boolean"&&(e.name=v),Mt(e)}function It(e,t,n){t==="number"&&D(e.ownerDocument)===e||e.defaultValue===""+n||(e.defaultValue=""+n)}function zt(e,t,n,a){if(e=e.options,t){t={};for(var l=0;l<n.length;l++)t["$"+n[l]]=!0;for(n=0;n<e.length;n++)l=t.hasOwnProperty("$"+e[n].value),e[n].selected!==l&&(e[n].selected=l),l&&a&&(e[n].defaultSelected=!0)}else{for(n=""+Se(n),t=null,l=0;l<e.length;l++){if(e[l].value===n){e[l].selected=!0,a&&(e[l].defaultSelected=!0);return}t!==null||e[l].disabled||(t=e[l])}t!==null&&(t.selected=!0)}}function mn(e,t,n){if(t!=null&&(t=""+Se(t),t!==e.value&&(e.value=t),n==null)){e.defaultValue!==t&&(e.defaultValue=t);return}e.defaultValue=n!=null?""+Se(n):""}function Qt(e,t,n,a){if(t==null){if(a!=null){if(n!=null)throw Error(s(92));if(qe(a)){if(1<a.length)throw Error(s(93));a=a[0]}n=a}n==null&&(n=""),t=n}n=Se(t),e.defaultValue=n,a=e.textContent,a===n&&a!==""&&a!==null&&(e.value=a),Mt(e)}function tn(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&n.nodeType===3){n.nodeValue=t;return}}e.textContent=t}var yn=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function bt(e,t,n){var a=t.indexOf("--")===0;n==null||typeof n=="boolean"||n===""?a?e.setProperty(t,""):t==="float"?e.cssFloat="":e[t]="":a?e.setProperty(t,n):typeof n!="number"||n===0||yn.has(t)?t==="float"?e.cssFloat=n:e[t]=(""+n).trim():e[t]=n+"px"}function vn(e,t,n){if(t!=null&&typeof t!="object")throw Error(s(62));if(e=e.style,n!=null){for(var a in n)!n.hasOwnProperty(a)||t!=null&&t.hasOwnProperty(a)||(a.indexOf("--")===0?e.setProperty(a,""):a==="float"?e.cssFloat="":e[a]="");for(var l in t)a=t[l],t.hasOwnProperty(l)&&n[l]!==a&&bt(e,l,a)}else for(var d in t)t.hasOwnProperty(d)&&bt(e,d,t[d])}function Rn(e){if(e.indexOf("-")===-1)return!1;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Ln=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),nn=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function ia(e){return nn.test(""+e)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":e}function Er(){}var Gr=null;function ts(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var ba=null,xn=null;function zr(e){var t=tt(e);if(t&&(e=t.stateNode)){var n=e[fe]||null;e:switch(e=t.stateNode,t.type){case"input":if(Ut(e,n.value,n.defaultValue,n.defaultValue,n.checked,n.defaultChecked,n.type,n.name),t=n.name,n.type==="radio"&&t!=null){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll('input[name="'+wt(""+t)+'"][type="radio"]'),t=0;t<n.length;t++){var a=n[t];if(a!==e&&a.form===e.form){var l=a[fe]||null;if(!l)throw Error(s(90));Ut(a,l.value,l.defaultValue,l.defaultValue,l.checked,l.defaultChecked,l.type,l.name)}}for(t=0;t<n.length;t++)a=n[t],a.form===e.form&&jt(a)}break e;case"textarea":mn(e,n.value,n.defaultValue);break e;case"select":t=n.value,t!=null&&zt(e,!!n.multiple,t,!1)}}}var Sa=!1;function Ga(e,t,n){if(Sa)return e(t,n);Sa=!0;try{var a=e(t);return a}finally{if(Sa=!1,(ba!==null||xn!==null)&&(Bl(),ba&&(t=ba,e=xn,xn=ba=null,zr(t),e)))for(t=0;t<e.length;t++)zr(e[t])}}function _a(e,t){var n=e.stateNode;if(n===null)return null;var a=n[fe]||null;if(a===null)return null;n=a[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(a=!a.disabled)||(e=e.type,a=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!a;break e;default:e=!1}if(e)return null;if(n&&typeof n!="function")throw Error(s(231,t,typeof n));return n}var Fn=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Gs=!1;if(Fn)try{var cr={};Object.defineProperty(cr,"passive",{get:function(){Gs=!0}}),window.addEventListener("test",cr,cr),window.removeEventListener("test",cr,cr)}catch{Gs=!1}var Qr=null,ns=null,Qa=null;function $a(){if(Qa)return Qa;var e,t=ns,n=t.length,a,l="value"in Qr?Qr.value:Qr.textContent,d=l.length;for(e=0;e<n&&t[e]===l[e];e++);var v=n-e;for(a=1;a<=v&&t[n-a]===l[d-a];a++);return Qa=l.slice(e,1<a?1-a:void 0)}function Xa(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function ji(){return!0}function $o(){return!1}function Hn(e){function t(n,a,l,d,v){this._reactName=n,this._targetInst=l,this.type=a,this.nativeEvent=d,this.target=v,this.currentTarget=null;for(var j in e)e.hasOwnProperty(j)&&(n=e[j],this[j]=n?n(d):d[j]);return this.isDefaultPrevented=(d.defaultPrevented!=null?d.defaultPrevented:d.returnValue===!1)?ji:$o,this.isPropagationStopped=$o,this}return R(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=ji)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=ji)},persist:function(){},isPersistent:ji}),t}var Ca={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},rs=Hn(Ca),da=R({},Ca,{view:0,detail:0}),as=Hn(da),Ri,Qs,Ai,is=R({},da,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Ea,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Ai&&(Ai&&e.type==="mousemove"?(Ri=e.screenX-Ai.screenX,Qs=e.screenY-Ai.screenY):Qs=Ri=0,Ai=e),Ri)},movementY:function(e){return"movementY"in e?e.movementY:Qs}}),ss=Hn(is),$s=R({},is,{dataTransfer:0}),Xo=Hn($s),os=R({},da,{relatedTarget:0}),Fa=Hn(os),ls=R({},Ca,{animationName:0,elapsedTime:0,pseudoElement:0}),Fo=Hn(ls),Ec=R({},Ca,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),Za=Hn(Ec),Xs=R({},Ca,{data:0}),cs=Hn(Xs),Fs={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Zs={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Zn={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Ni(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=Zn[e])?!!t[e]:!1}function Ea(){return Ni}var Zo=R({},da,{key:function(e){if(e.key){var t=Fs[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=Xa(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?Zs[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Ea,charCode:function(e){return e.type==="keypress"?Xa(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?Xa(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),us=Hn(Zo),Jo=R({},is,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Js=Hn(Jo),fs=R({},da,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Ea}),Ws=Hn(fs),wa=R({},Ca,{propertyName:0,elapsedTime:0,pseudoElement:0}),eo=Hn(wa),to=R({},is,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),ds=Hn(to),no=R({},Ca,{newState:0,oldState:0}),Wo=Hn(no),wc=[9,13,27,32],Oi=Fn&&"CompositionEvent"in window,ha=null;Fn&&"documentMode"in document&&(ha=document.documentMode);var Tc=Fn&&"TextEvent"in window&&!ha,hs=Fn&&(!Oi||ha&&8<ha&&11>=ha),ps=" ",el=!1;function ro(e,t){switch(e){case"keyup":return wc.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function tl(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var Ta=!1;function nl(e,t){switch(e){case"compositionend":return tl(t);case"keypress":return t.which!==32?null:(el=!0,ps);case"textInput":return e=t.data,e===ps&&el?null:e;default:return null}}function kc(e,t){if(Ta)return e==="compositionend"||!Oi&&ro(e,t)?(e=$a(),Qa=ns=Qr=null,Ta=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return hs&&t.locale!=="ko"?null:t.data;default:return null}}var rl={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function ms(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!rl[e.type]:t==="textarea"}function ao(e,t,n,a){ba?xn?xn.push(a):xn=[a]:ba=a,t=ql(t,"onChange"),0<t.length&&(n=new rs("onChange","change",null,n,a),e.push({event:n,listeners:t}))}var Ja=null,Di=null;function Mc(e){m0(e,0)}function gs(e){var t=vt(e);if(jt(t))return e}function zi(e,t){if(e==="change")return t}var $r=!1;if(Fn){var bn;if(Fn){var Wa="oninput"in document;if(!Wa){var vr=document.createElement("div");vr.setAttribute("oninput","return;"),Wa=typeof vr.oninput=="function"}bn=Wa}else bn=!1;$r=bn&&(!document.documentMode||9<document.documentMode)}function al(){Ja&&(Ja.detachEvent("onpropertychange",ys),Di=Ja=null)}function ys(e){if(e.propertyName==="value"&&gs(Di)){var t=[];ao(t,Di,e,ts(e)),Ga(Mc,t)}}function il(e,t,n){e==="focusin"?(al(),Ja=t,Di=n,Ja.attachEvent("onpropertychange",ys)):e==="focusout"&&al()}function ka(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return gs(Di)}function io(e,t){if(e==="click")return gs(t)}function ei(e,t){if(e==="input"||e==="change")return gs(t)}function pa(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var ur=typeof Object.is=="function"?Object.is:pa;function o(e,t){if(ur(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var n=Object.keys(e),a=Object.keys(t);if(n.length!==a.length)return!1;for(a=0;a<n.length;a++){var l=n[a];if(!Nr.call(t,l)||!ur(e[l],t[l]))return!1}return!0}function f(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function p(e,t){var n=f(e);e=0;for(var a;n;){if(n.nodeType===3){if(a=e+n.textContent.length,e<=t&&a>=t)return{node:n,offset:t-e};e=a}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=f(n)}}function g(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?g(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function C(e){e=e!=null&&e.ownerDocument!=null&&e.ownerDocument.defaultView!=null?e.ownerDocument.defaultView:window;for(var t=D(e.document);t instanceof e.HTMLIFrameElement;){try{var n=typeof t.contentWindow.location.href=="string"}catch{n=!1}if(n)e=t.contentWindow;else break;t=D(e.document)}return t}function T(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}var O=Fn&&"documentMode"in document&&11>=document.documentMode,z=null,H=null,I=null,$=!1;function U(e,t,n){var a=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;$||z==null||z!==D(a)||(a=z,"selectionStart"in a&&T(a)?a={start:a.selectionStart,end:a.selectionEnd}:(a=(a.ownerDocument&&a.ownerDocument.defaultView||window).getSelection(),a={anchorNode:a.anchorNode,anchorOffset:a.anchorOffset,focusNode:a.focusNode,focusOffset:a.focusOffset}),I&&o(I,a)||(I=a,a=ql(H,"onSelect"),0<a.length&&(t=new rs("onSelect","select",null,t,n),e.push({event:t,listeners:a}),t.target=z)))}function F(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var K={animationend:F("Animation","AnimationEnd"),animationiteration:F("Animation","AnimationIteration"),animationstart:F("Animation","AnimationStart"),transitionrun:F("Transition","TransitionRun"),transitionstart:F("Transition","TransitionStart"),transitioncancel:F("Transition","TransitionCancel"),transitionend:F("Transition","TransitionEnd")},Y={},V={};Fn&&(V=document.createElement("div").style,"AnimationEvent"in window||(delete K.animationend.animation,delete K.animationiteration.animation,delete K.animationstart.animation),"TransitionEvent"in window||delete K.transitionend.transition);function X(e){if(Y[e])return Y[e];if(!K[e])return e;var t=K[e],n;for(n in t)if(t.hasOwnProperty(n)&&n in V)return Y[e]=t[n];return e}var W=X("animationend"),ne=X("animationiteration"),he=X("animationstart"),xe=X("transitionrun"),Be=X("transitionstart"),Pe=X("transitioncancel"),Ae=X("transitionend"),Ue=new Map,Ke="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Ke.push("scrollEnd");function Ne(e,t){Ue.set(e,t),Ie(t,[e])}var rt=typeof reportError=="function"?reportError:function(e){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var t=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof e=="object"&&e!==null&&typeof e.message=="string"?String(e.message):String(e),error:e});if(!window.dispatchEvent(t))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",e);return}console.error(e)},St=[],Dt=0,Kt=0;function Jn(){for(var e=Dt,t=Kt=Dt=0;t<e;){var n=St[t];St[t++]=null;var a=St[t];St[t++]=null;var l=St[t];St[t++]=null;var d=St[t];if(St[t++]=null,a!==null&&l!==null){var v=a.pending;v===null?l.next=l:(l.next=v.next,v.next=l),a.pending=l}d!==0&&Bi(n,l,d)}}function Rt(e,t,n,a){St[Dt++]=e,St[Dt++]=t,St[Dt++]=n,St[Dt++]=a,Kt|=a,e.lanes|=a,e=e.alternate,e!==null&&(e.lanes|=a)}function In(e,t,n,a){return Rt(e,t,n,a),Kn(e)}function En(e,t){return Rt(e,null,null,t),Kn(e)}function Bi(e,t,n){e.lanes|=n;var a=e.alternate;a!==null&&(a.lanes|=n);for(var l=!1,d=e.return;d!==null;)d.childLanes|=n,a=d.alternate,a!==null&&(a.childLanes|=n),d.tag===22&&(e=d.stateNode,e===null||e._visibility&1||(l=!0)),e=d,d=d.return;return e.tag===3?(d=e.stateNode,l&&t!==null&&(l=31-Qe(n),e=d.hiddenUpdates,a=e[l],a===null?e[l]=[t]:a.push(t),t.lane=n|536870912),d):null}function Kn(e){if(50<jo)throw jo=0,Uu=null,Error(s(185));for(var t=e.return;t!==null;)e=t,t=e.return;return e.tag===3?e.stateNode:null}var wr={};function so(e,t,n,a){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=a,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Br(e,t,n,a){return new so(e,t,n,a)}function jc(e){return e=e.prototype,!(!e||!e.isReactComponent)}function Ma(e,t){var n=e.alternate;return n===null?(n=Br(e.tag,t,e.key,e.mode),n.elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=e.flags&65011712,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n.refCleanup=e.refCleanup,n}function Zf(e,t){e.flags&=65011714;var n=e.alternate;return n===null?(e.childLanes=0,e.lanes=t,e.child=null,e.subtreeFlags=0,e.memoizedProps=null,e.memoizedState=null,e.updateQueue=null,e.dependencies=null,e.stateNode=null):(e.childLanes=n.childLanes,e.lanes=n.lanes,e.child=n.child,e.subtreeFlags=0,e.deletions=null,e.memoizedProps=n.memoizedProps,e.memoizedState=n.memoizedState,e.updateQueue=n.updateQueue,e.type=n.type,t=n.dependencies,e.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),e}function sl(e,t,n,a,l,d){var v=0;if(a=e,typeof e=="function")jc(e)&&(v=1);else if(typeof e=="string")v=Gg(e,n,Le.current)?26:e==="html"||e==="head"||e==="body"?27:5;else e:switch(e){case en:return e=Br(31,n,t,l),e.elementType=en,e.lanes=d,e;case se:return Ui(n.children,l,d,t);case Re:v=8,l|=24;break;case lt:return e=Br(12,n,t,l|2),e.elementType=lt,e.lanes=d,e;case Je:return e=Br(13,n,t,l),e.elementType=Je,e.lanes=d,e;case ft:return e=Br(19,n,t,l),e.elementType=ft,e.lanes=d,e;default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case we:v=10;break e;case ke:v=9;break e;case $e:v=11;break e;case et:v=14;break e;case qt:v=16,a=null;break e}v=29,n=Error(s(130,e===null?"null":typeof e,"")),a=null}return t=Br(v,n,t,l),t.elementType=e,t.type=a,t.lanes=d,t}function Ui(e,t,n,a){return e=Br(7,e,a,t),e.lanes=n,e}function Rc(e,t,n){return e=Br(6,e,null,t),e.lanes=n,e}function Jf(e){var t=Br(18,null,null,0);return t.stateNode=e,t}function Ac(e,t,n){return t=Br(4,e.children!==null?e.children:[],e.key,t),t.lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}var Wf=new WeakMap;function Xr(e,t){if(typeof e=="object"&&e!==null){var n=Wf.get(e);return n!==void 0?n:(t={value:e,source:t,stack:ki(t)},Wf.set(e,t),t)}return{value:e,source:t,stack:ki(t)}}var vs=[],xs=0,ol=null,oo=0,Fr=[],Zr=0,ti=null,ma=1,ga="";function ja(e,t){vs[xs++]=oo,vs[xs++]=ol,ol=e,oo=t}function ed(e,t,n){Fr[Zr++]=ma,Fr[Zr++]=ga,Fr[Zr++]=ti,ti=e;var a=ma;e=ga;var l=32-Qe(a)-1;a&=~(1<<l),n+=1;var d=32-Qe(t)+l;if(30<d){var v=l-l%5;d=(a&(1<<v)-1).toString(32),a>>=v,l-=v,ma=1<<32-Qe(t)+l|n<<l|a,ga=d+e}else ma=1<<d|n<<l|a,ga=e}function Nc(e){e.return!==null&&(ja(e,1),ed(e,1,0))}function Oc(e){for(;e===ol;)ol=vs[--xs],vs[xs]=null,oo=vs[--xs],vs[xs]=null;for(;e===ti;)ti=Fr[--Zr],Fr[Zr]=null,ga=Fr[--Zr],Fr[Zr]=null,ma=Fr[--Zr],Fr[Zr]=null}function td(e,t){Fr[Zr++]=ma,Fr[Zr++]=ga,Fr[Zr++]=ti,ma=t.id,ga=t.overflow,ti=e}var ar=null,Sn=null,Wt=!1,ni=null,Jr=!1,Dc=Error(s(519));function ri(e){var t=Error(s(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw lo(Xr(t,e)),Dc}function nd(e){var t=e.stateNode,n=e.type,a=e.memoizedProps;switch(t[G]=e,t[fe]=a,n){case"dialog":Xt("cancel",t),Xt("close",t);break;case"iframe":case"object":case"embed":Xt("load",t);break;case"video":case"audio":for(n=0;n<Ao.length;n++)Xt(Ao[n],t);break;case"source":Xt("error",t);break;case"img":case"image":case"link":Xt("error",t),Xt("load",t);break;case"details":Xt("toggle",t);break;case"input":Xt("invalid",t),Ot(t,a.value,a.defaultValue,a.checked,a.defaultChecked,a.type,a.name,!0);break;case"select":Xt("invalid",t);break;case"textarea":Xt("invalid",t),Qt(t,a.value,a.defaultValue,a.children)}n=a.children,typeof n!="string"&&typeof n!="number"&&typeof n!="bigint"||t.textContent===""+n||a.suppressHydrationWarning===!0||x0(t.textContent,n)?(a.popover!=null&&(Xt("beforetoggle",t),Xt("toggle",t)),a.onScroll!=null&&Xt("scroll",t),a.onScrollEnd!=null&&Xt("scrollend",t),a.onClick!=null&&(t.onclick=Er),t=!0):t=!1,t||ri(e,!0)}function rd(e){for(ar=e.return;ar;)switch(ar.tag){case 5:case 31:case 13:Jr=!1;return;case 27:case 3:Jr=!0;return;default:ar=ar.return}}function bs(e){if(e!==ar)return!1;if(!Wt)return rd(e),Wt=!0,!1;var t=e.tag,n;if((n=t!==3&&t!==27)&&((n=t===5)&&(n=e.type,n=!(n!=="form"&&n!=="button")||Ju(e.type,e.memoizedProps)),n=!n),n&&Sn&&ri(e),rd(e),t===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(s(317));Sn=M0(e)}else if(t===31){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(s(317));Sn=M0(e)}else t===27?(t=Sn,yi(e.type)?(e=rf,rf=null,Sn=e):Sn=t):Sn=ar?ea(e.stateNode.nextSibling):null;return!0}function Li(){Sn=ar=null,Wt=!1}function zc(){var e=ni;return e!==null&&(jr===null?jr=e:jr.push.apply(jr,e),ni=null),e}function lo(e){ni===null?ni=[e]:ni.push(e)}var Bc=L(null),Hi=null,Ra=null;function ai(e,t,n){Ce(Bc,t._currentValue),t._currentValue=n}function Aa(e){e._currentValue=Bc.current,de(Bc)}function Uc(e,t,n){for(;e!==null;){var a=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,a!==null&&(a.childLanes|=t)):a!==null&&(a.childLanes&t)!==t&&(a.childLanes|=t),e===n)break;e=e.return}}function Lc(e,t,n,a){var l=e.child;for(l!==null&&(l.return=e);l!==null;){var d=l.dependencies;if(d!==null){var v=l.child;d=d.firstContext;e:for(;d!==null;){var j=d;d=l;for(var B=0;B<t.length;B++)if(j.context===t[B]){d.lanes|=n,j=d.alternate,j!==null&&(j.lanes|=n),Uc(d.return,n,e),a||(v=null);break e}d=j.next}}else if(l.tag===18){if(v=l.return,v===null)throw Error(s(341));v.lanes|=n,d=v.alternate,d!==null&&(d.lanes|=n),Uc(v,n,e),v=null}else v=l.child;if(v!==null)v.return=l;else for(v=l;v!==null;){if(v===e){v=null;break}if(l=v.sibling,l!==null){l.return=v.return,v=l;break}v=v.return}l=v}}function Ss(e,t,n,a){e=null;for(var l=t,d=!1;l!==null;){if(!d){if((l.flags&524288)!==0)d=!0;else if((l.flags&262144)!==0)break}if(l.tag===10){var v=l.alternate;if(v===null)throw Error(s(387));if(v=v.memoizedProps,v!==null){var j=l.type;ur(l.pendingProps.value,v.value)||(e!==null?e.push(j):e=[j])}}else if(l===dt.current){if(v=l.alternate,v===null)throw Error(s(387));v.memoizedState.memoizedState!==l.memoizedState.memoizedState&&(e!==null?e.push(Bo):e=[Bo])}l=l.return}e!==null&&Lc(t,e,n,a),t.flags|=262144}function ll(e){for(e=e.firstContext;e!==null;){if(!ur(e.context._currentValue,e.memoizedValue))return!0;e=e.next}return!1}function Ii(e){Hi=e,Ra=null,e=e.dependencies,e!==null&&(e.firstContext=null)}function ir(e){return ad(Hi,e)}function cl(e,t){return Hi===null&&Ii(e),ad(e,t)}function ad(e,t){var n=t._currentValue;if(t={context:t,memoizedValue:n,next:null},Ra===null){if(e===null)throw Error(s(308));Ra=t,e.dependencies={lanes:0,firstContext:t},e.flags|=524288}else Ra=Ra.next=t;return n}var Pm=typeof AbortController<"u"?AbortController:function(){var e=[],t=this.signal={aborted:!1,addEventListener:function(n,a){e.push(a)}};this.abort=function(){t.aborted=!0,e.forEach(function(n){return n()})}},qm=u.unstable_scheduleCallback,Ym=u.unstable_NormalPriority,Pn={$$typeof:we,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Hc(){return{controller:new Pm,data:new Map,refCount:0}}function co(e){e.refCount--,e.refCount===0&&qm(Ym,function(){e.controller.abort()})}var uo=null,Ic=0,_s=0,Cs=null;function Vm(e,t){if(uo===null){var n=uo=[];Ic=0,_s=qu(),Cs={status:"pending",value:void 0,then:function(a){n.push(a)}}}return Ic++,t.then(id,id),t}function id(){if(--Ic===0&&uo!==null){Cs!==null&&(Cs.status="fulfilled");var e=uo;uo=null,_s=0,Cs=null;for(var t=0;t<e.length;t++)(0,e[t])()}}function Gm(e,t){var n=[],a={status:"pending",value:null,reason:null,then:function(l){n.push(l)}};return e.then(function(){a.status="fulfilled",a.value=t;for(var l=0;l<n.length;l++)(0,n[l])(t)},function(l){for(a.status="rejected",a.reason=l,l=0;l<n.length;l++)(0,n[l])(void 0)}),a}var sd=J.S;J.S=function(e,t){qh=Dn(),typeof t=="object"&&t!==null&&typeof t.then=="function"&&Vm(e,t),sd!==null&&sd(e,t)};var Ki=L(null);function Kc(){var e=Ki.current;return e!==null?e:gn.pooledCache}function ul(e,t){t===null?Ce(Ki,Ki.current):Ce(Ki,t.pool)}function od(){var e=Kc();return e===null?null:{parent:Pn._currentValue,pool:e}}var Es=Error(s(460)),Pc=Error(s(474)),fl=Error(s(542)),dl={then:function(){}};function ld(e){return e=e.status,e==="fulfilled"||e==="rejected"}function cd(e,t,n){switch(n=e[n],n===void 0?e.push(t):n!==t&&(t.then(Er,Er),t=n),t.status){case"fulfilled":return t.value;case"rejected":throw e=t.reason,fd(e),e;default:if(typeof t.status=="string")t.then(Er,Er);else{if(e=gn,e!==null&&100<e.shellSuspendCounter)throw Error(s(482));e=t,e.status="pending",e.then(function(a){if(t.status==="pending"){var l=t;l.status="fulfilled",l.value=a}},function(a){if(t.status==="pending"){var l=t;l.status="rejected",l.reason=a}})}switch(t.status){case"fulfilled":return t.value;case"rejected":throw e=t.reason,fd(e),e}throw qi=t,Es}}function Pi(e){try{var t=e._init;return t(e._payload)}catch(n){throw n!==null&&typeof n=="object"&&typeof n.then=="function"?(qi=n,Es):n}}var qi=null;function ud(){if(qi===null)throw Error(s(459));var e=qi;return qi=null,e}function fd(e){if(e===Es||e===fl)throw Error(s(483))}var ws=null,fo=0;function hl(e){var t=fo;return fo+=1,ws===null&&(ws=[]),cd(ws,e,t)}function ho(e,t){t=t.props.ref,e.ref=t!==void 0?t:null}function pl(e,t){throw t.$$typeof===N?Error(s(525)):(e=Object.prototype.toString.call(t),Error(s(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)))}function dd(e){function t(Z,P){if(e){var ee=Z.deletions;ee===null?(Z.deletions=[P],Z.flags|=16):ee.push(P)}}function n(Z,P){if(!e)return null;for(;P!==null;)t(Z,P),P=P.sibling;return null}function a(Z){for(var P=new Map;Z!==null;)Z.key!==null?P.set(Z.key,Z):P.set(Z.index,Z),Z=Z.sibling;return P}function l(Z,P){return Z=Ma(Z,P),Z.index=0,Z.sibling=null,Z}function d(Z,P,ee){return Z.index=ee,e?(ee=Z.alternate,ee!==null?(ee=ee.index,ee<P?(Z.flags|=67108866,P):ee):(Z.flags|=67108866,P)):(Z.flags|=1048576,P)}function v(Z){return e&&Z.alternate===null&&(Z.flags|=67108866),Z}function j(Z,P,ee,ve){return P===null||P.tag!==6?(P=Rc(ee,Z.mode,ve),P.return=Z,P):(P=l(P,ee),P.return=Z,P)}function B(Z,P,ee,ve){var _t=ee.type;return _t===se?me(Z,P,ee.props.children,ve,ee.key):P!==null&&(P.elementType===_t||typeof _t=="object"&&_t!==null&&_t.$$typeof===qt&&Pi(_t)===P.type)?(P=l(P,ee.props),ho(P,ee),P.return=Z,P):(P=sl(ee.type,ee.key,ee.props,null,Z.mode,ve),ho(P,ee),P.return=Z,P)}function te(Z,P,ee,ve){return P===null||P.tag!==4||P.stateNode.containerInfo!==ee.containerInfo||P.stateNode.implementation!==ee.implementation?(P=Ac(ee,Z.mode,ve),P.return=Z,P):(P=l(P,ee.children||[]),P.return=Z,P)}function me(Z,P,ee,ve,_t){return P===null||P.tag!==7?(P=Ui(ee,Z.mode,ve,_t),P.return=Z,P):(P=l(P,ee),P.return=Z,P)}function be(Z,P,ee){if(typeof P=="string"&&P!==""||typeof P=="number"||typeof P=="bigint")return P=Rc(""+P,Z.mode,ee),P.return=Z,P;if(typeof P=="object"&&P!==null){switch(P.$$typeof){case q:return ee=sl(P.type,P.key,P.props,null,Z.mode,ee),ho(ee,P),ee.return=Z,ee;case ie:return P=Ac(P,Z.mode,ee),P.return=Z,P;case qt:return P=Pi(P),be(Z,P,ee)}if(qe(P)||pe(P))return P=Ui(P,Z.mode,ee,null),P.return=Z,P;if(typeof P.then=="function")return be(Z,hl(P),ee);if(P.$$typeof===we)return be(Z,cl(Z,P),ee);pl(Z,P)}return null}function re(Z,P,ee,ve){var _t=P!==null?P.key:null;if(typeof ee=="string"&&ee!==""||typeof ee=="number"||typeof ee=="bigint")return _t!==null?null:j(Z,P,""+ee,ve);if(typeof ee=="object"&&ee!==null){switch(ee.$$typeof){case q:return ee.key===_t?B(Z,P,ee,ve):null;case ie:return ee.key===_t?te(Z,P,ee,ve):null;case qt:return ee=Pi(ee),re(Z,P,ee,ve)}if(qe(ee)||pe(ee))return _t!==null?null:me(Z,P,ee,ve,null);if(typeof ee.then=="function")return re(Z,P,hl(ee),ve);if(ee.$$typeof===we)return re(Z,P,cl(Z,ee),ve);pl(Z,ee)}return null}function ce(Z,P,ee,ve,_t){if(typeof ve=="string"&&ve!==""||typeof ve=="number"||typeof ve=="bigint")return Z=Z.get(ee)||null,j(P,Z,""+ve,_t);if(typeof ve=="object"&&ve!==null){switch(ve.$$typeof){case q:return Z=Z.get(ve.key===null?ee:ve.key)||null,B(P,Z,ve,_t);case ie:return Z=Z.get(ve.key===null?ee:ve.key)||null,te(P,Z,ve,_t);case qt:return ve=Pi(ve),ce(Z,P,ee,ve,_t)}if(qe(ve)||pe(ve))return Z=Z.get(ee)||null,me(P,Z,ve,_t,null);if(typeof ve.then=="function")return ce(Z,P,ee,hl(ve),_t);if(ve.$$typeof===we)return ce(Z,P,ee,cl(P,ve),_t);pl(P,ve)}return null}function ot(Z,P,ee,ve){for(var _t=null,rn=null,gt=P,Yt=P=0,Jt=null;gt!==null&&Yt<ee.length;Yt++){gt.index>Yt?(Jt=gt,gt=null):Jt=gt.sibling;var an=re(Z,gt,ee[Yt],ve);if(an===null){gt===null&&(gt=Jt);break}e&&gt&&an.alternate===null&&t(Z,gt),P=d(an,P,Yt),rn===null?_t=an:rn.sibling=an,rn=an,gt=Jt}if(Yt===ee.length)return n(Z,gt),Wt&&ja(Z,Yt),_t;if(gt===null){for(;Yt<ee.length;Yt++)gt=be(Z,ee[Yt],ve),gt!==null&&(P=d(gt,P,Yt),rn===null?_t=gt:rn.sibling=gt,rn=gt);return Wt&&ja(Z,Yt),_t}for(gt=a(gt);Yt<ee.length;Yt++)Jt=ce(gt,Z,Yt,ee[Yt],ve),Jt!==null&&(e&&Jt.alternate!==null&&gt.delete(Jt.key===null?Yt:Jt.key),P=d(Jt,P,Yt),rn===null?_t=Jt:rn.sibling=Jt,rn=Jt);return e&&gt.forEach(function(_i){return t(Z,_i)}),Wt&&ja(Z,Yt),_t}function Tt(Z,P,ee,ve){if(ee==null)throw Error(s(151));for(var _t=null,rn=null,gt=P,Yt=P=0,Jt=null,an=ee.next();gt!==null&&!an.done;Yt++,an=ee.next()){gt.index>Yt?(Jt=gt,gt=null):Jt=gt.sibling;var _i=re(Z,gt,an.value,ve);if(_i===null){gt===null&&(gt=Jt);break}e&&gt&&_i.alternate===null&&t(Z,gt),P=d(_i,P,Yt),rn===null?_t=_i:rn.sibling=_i,rn=_i,gt=Jt}if(an.done)return n(Z,gt),Wt&&ja(Z,Yt),_t;if(gt===null){for(;!an.done;Yt++,an=ee.next())an=be(Z,an.value,ve),an!==null&&(P=d(an,P,Yt),rn===null?_t=an:rn.sibling=an,rn=an);return Wt&&ja(Z,Yt),_t}for(gt=a(gt);!an.done;Yt++,an=ee.next())an=ce(gt,Z,Yt,an.value,ve),an!==null&&(e&&an.alternate!==null&&gt.delete(an.key===null?Yt:an.key),P=d(an,P,Yt),rn===null?_t=an:rn.sibling=an,rn=an);return e&&gt.forEach(function(ry){return t(Z,ry)}),Wt&&ja(Z,Yt),_t}function hn(Z,P,ee,ve){if(typeof ee=="object"&&ee!==null&&ee.type===se&&ee.key===null&&(ee=ee.props.children),typeof ee=="object"&&ee!==null){switch(ee.$$typeof){case q:e:{for(var _t=ee.key;P!==null;){if(P.key===_t){if(_t=ee.type,_t===se){if(P.tag===7){n(Z,P.sibling),ve=l(P,ee.props.children),ve.return=Z,Z=ve;break e}}else if(P.elementType===_t||typeof _t=="object"&&_t!==null&&_t.$$typeof===qt&&Pi(_t)===P.type){n(Z,P.sibling),ve=l(P,ee.props),ho(ve,ee),ve.return=Z,Z=ve;break e}n(Z,P);break}else t(Z,P);P=P.sibling}ee.type===se?(ve=Ui(ee.props.children,Z.mode,ve,ee.key),ve.return=Z,Z=ve):(ve=sl(ee.type,ee.key,ee.props,null,Z.mode,ve),ho(ve,ee),ve.return=Z,Z=ve)}return v(Z);case ie:e:{for(_t=ee.key;P!==null;){if(P.key===_t)if(P.tag===4&&P.stateNode.containerInfo===ee.containerInfo&&P.stateNode.implementation===ee.implementation){n(Z,P.sibling),ve=l(P,ee.children||[]),ve.return=Z,Z=ve;break e}else{n(Z,P);break}else t(Z,P);P=P.sibling}ve=Ac(ee,Z.mode,ve),ve.return=Z,Z=ve}return v(Z);case qt:return ee=Pi(ee),hn(Z,P,ee,ve)}if(qe(ee))return ot(Z,P,ee,ve);if(pe(ee)){if(_t=pe(ee),typeof _t!="function")throw Error(s(150));return ee=_t.call(ee),Tt(Z,P,ee,ve)}if(typeof ee.then=="function")return hn(Z,P,hl(ee),ve);if(ee.$$typeof===we)return hn(Z,P,cl(Z,ee),ve);pl(Z,ee)}return typeof ee=="string"&&ee!==""||typeof ee=="number"||typeof ee=="bigint"?(ee=""+ee,P!==null&&P.tag===6?(n(Z,P.sibling),ve=l(P,ee),ve.return=Z,Z=ve):(n(Z,P),ve=Rc(ee,Z.mode,ve),ve.return=Z,Z=ve),v(Z)):n(Z,P)}return function(Z,P,ee,ve){try{fo=0;var _t=hn(Z,P,ee,ve);return ws=null,_t}catch(gt){if(gt===Es||gt===fl)throw gt;var rn=Br(29,gt,null,Z.mode);return rn.lanes=ve,rn.return=Z,rn}finally{}}}var Yi=dd(!0),hd=dd(!1),ii=!1;function qc(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Yc(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,callbacks:null})}function si(e){return{lane:e,tag:0,payload:null,callback:null,next:null}}function oi(e,t,n){var a=e.updateQueue;if(a===null)return null;if(a=a.shared,(sn&2)!==0){var l=a.pending;return l===null?t.next=t:(t.next=l.next,l.next=t),a.pending=t,t=Kn(e),Bi(e,null,n),t}return Rt(e,a,t,n),Kn(e)}function po(e,t,n){if(t=t.updateQueue,t!==null&&(t=t.shared,(n&4194048)!==0)){var a=t.lanes;a&=e.pendingLanes,n|=a,t.lanes=n,on(e,n)}}function Vc(e,t){var n=e.updateQueue,a=e.alternate;if(a!==null&&(a=a.updateQueue,n===a)){var l=null,d=null;if(n=n.firstBaseUpdate,n!==null){do{var v={lane:n.lane,tag:n.tag,payload:n.payload,callback:null,next:null};d===null?l=d=v:d=d.next=v,n=n.next}while(n!==null);d===null?l=d=t:d=d.next=t}else l=d=t;n={baseState:a.baseState,firstBaseUpdate:l,lastBaseUpdate:d,shared:a.shared,callbacks:a.callbacks},e.updateQueue=n;return}e=n.lastBaseUpdate,e===null?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}var Gc=!1;function mo(){if(Gc){var e=Cs;if(e!==null)throw e}}function go(e,t,n,a){Gc=!1;var l=e.updateQueue;ii=!1;var d=l.firstBaseUpdate,v=l.lastBaseUpdate,j=l.shared.pending;if(j!==null){l.shared.pending=null;var B=j,te=B.next;B.next=null,v===null?d=te:v.next=te,v=B;var me=e.alternate;me!==null&&(me=me.updateQueue,j=me.lastBaseUpdate,j!==v&&(j===null?me.firstBaseUpdate=te:j.next=te,me.lastBaseUpdate=B))}if(d!==null){var be=l.baseState;v=0,me=te=B=null,j=d;do{var re=j.lane&-536870913,ce=re!==j.lane;if(ce?(Zt&re)===re:(a&re)===re){re!==0&&re===_s&&(Gc=!0),me!==null&&(me=me.next={lane:0,tag:j.tag,payload:j.payload,callback:null,next:null});e:{var ot=e,Tt=j;re=t;var hn=n;switch(Tt.tag){case 1:if(ot=Tt.payload,typeof ot=="function"){be=ot.call(hn,be,re);break e}be=ot;break e;case 3:ot.flags=ot.flags&-65537|128;case 0:if(ot=Tt.payload,re=typeof ot=="function"?ot.call(hn,be,re):ot,re==null)break e;be=R({},be,re);break e;case 2:ii=!0}}re=j.callback,re!==null&&(e.flags|=64,ce&&(e.flags|=8192),ce=l.callbacks,ce===null?l.callbacks=[re]:ce.push(re))}else ce={lane:re,tag:j.tag,payload:j.payload,callback:j.callback,next:null},me===null?(te=me=ce,B=be):me=me.next=ce,v|=re;if(j=j.next,j===null){if(j=l.shared.pending,j===null)break;ce=j,j=ce.next,ce.next=null,l.lastBaseUpdate=ce,l.shared.pending=null}}while(!0);me===null&&(B=be),l.baseState=B,l.firstBaseUpdate=te,l.lastBaseUpdate=me,d===null&&(l.shared.lanes=0),di|=v,e.lanes=v,e.memoizedState=be}}function pd(e,t){if(typeof e!="function")throw Error(s(191,e));e.call(t)}function md(e,t){var n=e.callbacks;if(n!==null)for(e.callbacks=null,e=0;e<n.length;e++)pd(n[e],t)}var Ts=L(null),ml=L(0);function gd(e,t){e=Ia,Ce(ml,e),Ce(Ts,t),Ia=e|t.baseLanes}function Qc(){Ce(ml,Ia),Ce(Ts,Ts.current)}function $c(){Ia=ml.current,de(Ts),de(ml)}var Ur=L(null),Wr=null;function li(e){var t=e.alternate;Ce(Bn,Bn.current&1),Ce(Ur,e),Wr===null&&(t===null||Ts.current!==null||t.memoizedState!==null)&&(Wr=e)}function Xc(e){Ce(Bn,Bn.current),Ce(Ur,e),Wr===null&&(Wr=e)}function yd(e){e.tag===22?(Ce(Bn,Bn.current),Ce(Ur,e),Wr===null&&(Wr=e)):ci()}function ci(){Ce(Bn,Bn.current),Ce(Ur,Ur.current)}function Lr(e){de(Ur),Wr===e&&(Wr=null),de(Bn)}var Bn=L(0);function gl(e){for(var t=e;t!==null;){if(t.tag===13){var n=t.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||tf(n)||nf(n)))return t}else if(t.tag===19&&(t.memoizedProps.revealOrder==="forwards"||t.memoizedProps.revealOrder==="backwards"||t.memoizedProps.revealOrder==="unstable_legacy-backwards"||t.memoizedProps.revealOrder==="together")){if((t.flags&128)!==0)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var Na=0,Pt=null,fn=null,qn=null,yl=!1,ks=!1,Vi=!1,vl=0,yo=0,Ms=null,Qm=0;function An(){throw Error(s(321))}function Fc(e,t){if(t===null)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!ur(e[n],t[n]))return!1;return!0}function Zc(e,t,n,a,l,d){return Na=d,Pt=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,J.H=e===null||e.memoizedState===null?eh:du,Vi=!1,d=n(a,l),Vi=!1,ks&&(d=xd(t,n,a,l)),vd(e),d}function vd(e){J.H=bo;var t=fn!==null&&fn.next!==null;if(Na=0,qn=fn=Pt=null,yl=!1,yo=0,Ms=null,t)throw Error(s(300));e===null||Yn||(e=e.dependencies,e!==null&&ll(e)&&(Yn=!0))}function xd(e,t,n,a){Pt=e;var l=0;do{if(ks&&(Ms=null),yo=0,ks=!1,25<=l)throw Error(s(301));if(l+=1,qn=fn=null,e.updateQueue!=null){var d=e.updateQueue;d.lastEffect=null,d.events=null,d.stores=null,d.memoCache!=null&&(d.memoCache.index=0)}J.H=th,d=t(n,a)}while(ks);return d}function $m(){var e=J.H,t=e.useState()[0];return t=typeof t.then=="function"?vo(t):t,e=e.useState()[0],(fn!==null?fn.memoizedState:null)!==e&&(Pt.flags|=1024),t}function Jc(){var e=vl!==0;return vl=0,e}function Wc(e,t,n){t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~n}function eu(e){if(yl){for(e=e.memoizedState;e!==null;){var t=e.queue;t!==null&&(t.pending=null),e=e.next}yl=!1}Na=0,qn=fn=Pt=null,ks=!1,yo=vl=0,Ms=null}function xr(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return qn===null?Pt.memoizedState=qn=e:qn=qn.next=e,qn}function Un(){if(fn===null){var e=Pt.alternate;e=e!==null?e.memoizedState:null}else e=fn.next;var t=qn===null?Pt.memoizedState:qn.next;if(t!==null)qn=t,fn=e;else{if(e===null)throw Pt.alternate===null?Error(s(467)):Error(s(310));fn=e,e={memoizedState:fn.memoizedState,baseState:fn.baseState,baseQueue:fn.baseQueue,queue:fn.queue,next:null},qn===null?Pt.memoizedState=qn=e:qn=qn.next=e}return qn}function xl(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function vo(e){var t=yo;return yo+=1,Ms===null&&(Ms=[]),e=cd(Ms,e,t),t=Pt,(qn===null?t.memoizedState:qn.next)===null&&(t=t.alternate,J.H=t===null||t.memoizedState===null?eh:du),e}function bl(e){if(e!==null&&typeof e=="object"){if(typeof e.then=="function")return vo(e);if(e.$$typeof===we)return ir(e)}throw Error(s(438,String(e)))}function tu(e){var t=null,n=Pt.updateQueue;if(n!==null&&(t=n.memoCache),t==null){var a=Pt.alternate;a!==null&&(a=a.updateQueue,a!==null&&(a=a.memoCache,a!=null&&(t={data:a.data.map(function(l){return l.slice()}),index:0})))}if(t==null&&(t={data:[],index:0}),n===null&&(n=xl(),Pt.updateQueue=n),n.memoCache=t,n=t.data[t.index],n===void 0)for(n=t.data[t.index]=Array(e),a=0;a<e;a++)n[a]=Oe;return t.index++,n}function Oa(e,t){return typeof t=="function"?t(e):t}function Sl(e){var t=Un();return nu(t,fn,e)}function nu(e,t,n){var a=e.queue;if(a===null)throw Error(s(311));a.lastRenderedReducer=n;var l=e.baseQueue,d=a.pending;if(d!==null){if(l!==null){var v=l.next;l.next=d.next,d.next=v}t.baseQueue=l=d,a.pending=null}if(d=e.baseState,l===null)e.memoizedState=d;else{t=l.next;var j=v=null,B=null,te=t,me=!1;do{var be=te.lane&-536870913;if(be!==te.lane?(Zt&be)===be:(Na&be)===be){var re=te.revertLane;if(re===0)B!==null&&(B=B.next={lane:0,revertLane:0,gesture:null,action:te.action,hasEagerState:te.hasEagerState,eagerState:te.eagerState,next:null}),be===_s&&(me=!0);else if((Na&re)===re){te=te.next,re===_s&&(me=!0);continue}else be={lane:0,revertLane:te.revertLane,gesture:null,action:te.action,hasEagerState:te.hasEagerState,eagerState:te.eagerState,next:null},B===null?(j=B=be,v=d):B=B.next=be,Pt.lanes|=re,di|=re;be=te.action,Vi&&n(d,be),d=te.hasEagerState?te.eagerState:n(d,be)}else re={lane:be,revertLane:te.revertLane,gesture:te.gesture,action:te.action,hasEagerState:te.hasEagerState,eagerState:te.eagerState,next:null},B===null?(j=B=re,v=d):B=B.next=re,Pt.lanes|=be,di|=be;te=te.next}while(te!==null&&te!==t);if(B===null?v=d:B.next=j,!ur(d,e.memoizedState)&&(Yn=!0,me&&(n=Cs,n!==null)))throw n;e.memoizedState=d,e.baseState=v,e.baseQueue=B,a.lastRenderedState=d}return l===null&&(a.lanes=0),[e.memoizedState,a.dispatch]}function ru(e){var t=Un(),n=t.queue;if(n===null)throw Error(s(311));n.lastRenderedReducer=e;var a=n.dispatch,l=n.pending,d=t.memoizedState;if(l!==null){n.pending=null;var v=l=l.next;do d=e(d,v.action),v=v.next;while(v!==l);ur(d,t.memoizedState)||(Yn=!0),t.memoizedState=d,t.baseQueue===null&&(t.baseState=d),n.lastRenderedState=d}return[d,a]}function bd(e,t,n){var a=Pt,l=Un(),d=Wt;if(d){if(n===void 0)throw Error(s(407));n=n()}else n=t();var v=!ur((fn||l).memoizedState,n);if(v&&(l.memoizedState=n,Yn=!0),l=l.queue,su(Cd.bind(null,a,l,e),[e]),l.getSnapshot!==t||v||qn!==null&&qn.memoizedState.tag&1){if(a.flags|=2048,js(9,{destroy:void 0},_d.bind(null,a,l,n,t),null),gn===null)throw Error(s(349));d||(Na&127)!==0||Sd(a,t,n)}return n}function Sd(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},t=Pt.updateQueue,t===null?(t=xl(),Pt.updateQueue=t,t.stores=[e]):(n=t.stores,n===null?t.stores=[e]:n.push(e))}function _d(e,t,n,a){t.value=n,t.getSnapshot=a,Ed(t)&&wd(e)}function Cd(e,t,n){return n(function(){Ed(t)&&wd(e)})}function Ed(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!ur(e,n)}catch{return!0}}function wd(e){var t=En(e,2);t!==null&&Rr(t,e,2)}function au(e){var t=xr();if(typeof e=="function"){var n=e;if(e=n(),Vi){Cn(!0);try{n()}finally{Cn(!1)}}}return t.memoizedState=t.baseState=e,t.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Oa,lastRenderedState:e},t}function Td(e,t,n,a){return e.baseState=n,nu(e,fn,typeof a=="function"?a:Oa)}function Xm(e,t,n,a,l){if(El(e))throw Error(s(485));if(e=t.action,e!==null){var d={payload:l,action:e,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(v){d.listeners.push(v)}};J.T!==null?n(!0):d.isTransition=!1,a(d),n=t.pending,n===null?(d.next=t.pending=d,kd(t,d)):(d.next=n.next,t.pending=n.next=d)}}function kd(e,t){var n=t.action,a=t.payload,l=e.state;if(t.isTransition){var d=J.T,v={};J.T=v;try{var j=n(l,a),B=J.S;B!==null&&B(v,j),Md(e,t,j)}catch(te){iu(e,t,te)}finally{d!==null&&v.types!==null&&(d.types=v.types),J.T=d}}else try{d=n(l,a),Md(e,t,d)}catch(te){iu(e,t,te)}}function Md(e,t,n){n!==null&&typeof n=="object"&&typeof n.then=="function"?n.then(function(a){jd(e,t,a)},function(a){return iu(e,t,a)}):jd(e,t,n)}function jd(e,t,n){t.status="fulfilled",t.value=n,Rd(t),e.state=n,t=e.pending,t!==null&&(n=t.next,n===t?e.pending=null:(n=n.next,t.next=n,kd(e,n)))}function iu(e,t,n){var a=e.pending;if(e.pending=null,a!==null){a=a.next;do t.status="rejected",t.reason=n,Rd(t),t=t.next;while(t!==a)}e.action=null}function Rd(e){e=e.listeners;for(var t=0;t<e.length;t++)(0,e[t])()}function Ad(e,t){return t}function Nd(e,t){if(Wt){var n=gn.formState;if(n!==null){e:{var a=Pt;if(Wt){if(Sn){t:{for(var l=Sn,d=Jr;l.nodeType!==8;){if(!d){l=null;break t}if(l=ea(l.nextSibling),l===null){l=null;break t}}d=l.data,l=d==="F!"||d==="F"?l:null}if(l){Sn=ea(l.nextSibling),a=l.data==="F!";break e}}ri(a)}a=!1}a&&(t=n[0])}}return n=xr(),n.memoizedState=n.baseState=t,a={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ad,lastRenderedState:t},n.queue=a,n=Zd.bind(null,Pt,a),a.dispatch=n,a=au(!1),d=fu.bind(null,Pt,!1,a.queue),a=xr(),l={state:t,dispatch:null,action:e,pending:null},a.queue=l,n=Xm.bind(null,Pt,l,d,n),l.dispatch=n,a.memoizedState=e,[t,n,!1]}function Od(e){var t=Un();return Dd(t,fn,e)}function Dd(e,t,n){if(t=nu(e,t,Ad)[0],e=Sl(Oa)[0],typeof t=="object"&&t!==null&&typeof t.then=="function")try{var a=vo(t)}catch(v){throw v===Es?fl:v}else a=t;t=Un();var l=t.queue,d=l.dispatch;return n!==t.memoizedState&&(Pt.flags|=2048,js(9,{destroy:void 0},Fm.bind(null,l,n),null)),[a,d,e]}function Fm(e,t){e.action=t}function zd(e){var t=Un(),n=fn;if(n!==null)return Dd(t,n,e);Un(),t=t.memoizedState,n=Un();var a=n.queue.dispatch;return n.memoizedState=e,[t,a,!1]}function js(e,t,n,a){return e={tag:e,create:n,deps:a,inst:t,next:null},t=Pt.updateQueue,t===null&&(t=xl(),Pt.updateQueue=t),n=t.lastEffect,n===null?t.lastEffect=e.next=e:(a=n.next,n.next=e,e.next=a,t.lastEffect=e),e}function Bd(){return Un().memoizedState}function _l(e,t,n,a){var l=xr();Pt.flags|=e,l.memoizedState=js(1|t,{destroy:void 0},n,a===void 0?null:a)}function Cl(e,t,n,a){var l=Un();a=a===void 0?null:a;var d=l.memoizedState.inst;fn!==null&&a!==null&&Fc(a,fn.memoizedState.deps)?l.memoizedState=js(t,d,n,a):(Pt.flags|=e,l.memoizedState=js(1|t,d,n,a))}function Ud(e,t){_l(8390656,8,e,t)}function su(e,t){Cl(2048,8,e,t)}function Zm(e){Pt.flags|=4;var t=Pt.updateQueue;if(t===null)t=xl(),Pt.updateQueue=t,t.events=[e];else{var n=t.events;n===null?t.events=[e]:n.push(e)}}function Ld(e){var t=Un().memoizedState;return Zm({ref:t,nextImpl:e}),function(){if((sn&2)!==0)throw Error(s(440));return t.impl.apply(void 0,arguments)}}function Hd(e,t){return Cl(4,2,e,t)}function Id(e,t){return Cl(4,4,e,t)}function Kd(e,t){if(typeof t=="function"){e=e();var n=t(e);return function(){typeof n=="function"?n():t(null)}}if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function Pd(e,t,n){n=n!=null?n.concat([e]):null,Cl(4,4,Kd.bind(null,t,e),n)}function ou(){}function qd(e,t){var n=Un();t=t===void 0?null:t;var a=n.memoizedState;return t!==null&&Fc(t,a[1])?a[0]:(n.memoizedState=[e,t],e)}function Yd(e,t){var n=Un();t=t===void 0?null:t;var a=n.memoizedState;if(t!==null&&Fc(t,a[1]))return a[0];if(a=e(),Vi){Cn(!0);try{e()}finally{Cn(!1)}}return n.memoizedState=[a,t],a}function lu(e,t,n){return n===void 0||(Na&1073741824)!==0&&(Zt&261930)===0?e.memoizedState=t:(e.memoizedState=n,e=Vh(),Pt.lanes|=e,di|=e,n)}function Vd(e,t,n,a){return ur(n,t)?n:Ts.current!==null?(e=lu(e,n,a),ur(e,t)||(Yn=!0),e):(Na&42)===0||(Na&1073741824)!==0&&(Zt&261930)===0?(Yn=!0,e.memoizedState=n):(e=Vh(),Pt.lanes|=e,di|=e,t)}function Gd(e,t,n,a,l){var d=Me.p;Me.p=d!==0&&8>d?d:8;var v=J.T,j={};J.T=j,fu(e,!1,t,n);try{var B=l(),te=J.S;if(te!==null&&te(j,B),B!==null&&typeof B=="object"&&typeof B.then=="function"){var me=Gm(B,a);xo(e,t,me,Kr(e))}else xo(e,t,a,Kr(e))}catch(be){xo(e,t,{then:function(){},status:"rejected",reason:be},Kr())}finally{Me.p=d,v!==null&&j.types!==null&&(v.types=j.types),J.T=v}}function Jm(){}function cu(e,t,n,a){if(e.tag!==5)throw Error(s(476));var l=Qd(e).queue;Gd(e,l,t,Ge,n===null?Jm:function(){return $d(e),n(a)})}function Qd(e){var t=e.memoizedState;if(t!==null)return t;t={memoizedState:Ge,baseState:Ge,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Oa,lastRenderedState:Ge},next:null};var n={};return t.next={memoizedState:n,baseState:n,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Oa,lastRenderedState:n},next:null},e.memoizedState=t,e=e.alternate,e!==null&&(e.memoizedState=t),t}function $d(e){var t=Qd(e);t.next===null&&(t=e.alternate.memoizedState),xo(e,t.next.queue,{},Kr())}function uu(){return ir(Bo)}function Xd(){return Un().memoizedState}function Fd(){return Un().memoizedState}function Wm(e){for(var t=e.return;t!==null;){switch(t.tag){case 24:case 3:var n=Kr();e=si(n);var a=oi(t,e,n);a!==null&&(Rr(a,t,n),po(a,t,n)),t={cache:Hc()},e.payload=t;return}t=t.return}}function eg(e,t,n){var a=Kr();n={lane:a,revertLane:0,gesture:null,action:n,hasEagerState:!1,eagerState:null,next:null},El(e)?Jd(t,n):(n=In(e,t,n,a),n!==null&&(Rr(n,e,a),Wd(n,t,a)))}function Zd(e,t,n){var a=Kr();xo(e,t,n,a)}function xo(e,t,n,a){var l={lane:a,revertLane:0,gesture:null,action:n,hasEagerState:!1,eagerState:null,next:null};if(El(e))Jd(t,l);else{var d=e.alternate;if(e.lanes===0&&(d===null||d.lanes===0)&&(d=t.lastRenderedReducer,d!==null))try{var v=t.lastRenderedState,j=d(v,n);if(l.hasEagerState=!0,l.eagerState=j,ur(j,v))return Rt(e,t,l,0),gn===null&&Jn(),!1}catch{}finally{}if(n=In(e,t,l,a),n!==null)return Rr(n,e,a),Wd(n,t,a),!0}return!1}function fu(e,t,n,a){if(a={lane:2,revertLane:qu(),gesture:null,action:a,hasEagerState:!1,eagerState:null,next:null},El(e)){if(t)throw Error(s(479))}else t=In(e,n,a,2),t!==null&&Rr(t,e,2)}function El(e){var t=e.alternate;return e===Pt||t!==null&&t===Pt}function Jd(e,t){ks=yl=!0;var n=e.pending;n===null?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function Wd(e,t,n){if((n&4194048)!==0){var a=t.lanes;a&=e.pendingLanes,n|=a,t.lanes=n,on(e,n)}}var bo={readContext:ir,use:bl,useCallback:An,useContext:An,useEffect:An,useImperativeHandle:An,useLayoutEffect:An,useInsertionEffect:An,useMemo:An,useReducer:An,useRef:An,useState:An,useDebugValue:An,useDeferredValue:An,useTransition:An,useSyncExternalStore:An,useId:An,useHostTransitionStatus:An,useFormState:An,useActionState:An,useOptimistic:An,useMemoCache:An,useCacheRefresh:An};bo.useEffectEvent=An;var eh={readContext:ir,use:bl,useCallback:function(e,t){return xr().memoizedState=[e,t===void 0?null:t],e},useContext:ir,useEffect:Ud,useImperativeHandle:function(e,t,n){n=n!=null?n.concat([e]):null,_l(4194308,4,Kd.bind(null,t,e),n)},useLayoutEffect:function(e,t){return _l(4194308,4,e,t)},useInsertionEffect:function(e,t){_l(4,2,e,t)},useMemo:function(e,t){var n=xr();t=t===void 0?null:t;var a=e();if(Vi){Cn(!0);try{e()}finally{Cn(!1)}}return n.memoizedState=[a,t],a},useReducer:function(e,t,n){var a=xr();if(n!==void 0){var l=n(t);if(Vi){Cn(!0);try{n(t)}finally{Cn(!1)}}}else l=t;return a.memoizedState=a.baseState=l,e={pending:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:l},a.queue=e,e=e.dispatch=eg.bind(null,Pt,e),[a.memoizedState,e]},useRef:function(e){var t=xr();return e={current:e},t.memoizedState=e},useState:function(e){e=au(e);var t=e.queue,n=Zd.bind(null,Pt,t);return t.dispatch=n,[e.memoizedState,n]},useDebugValue:ou,useDeferredValue:function(e,t){var n=xr();return lu(n,e,t)},useTransition:function(){var e=au(!1);return e=Gd.bind(null,Pt,e.queue,!0,!1),xr().memoizedState=e,[!1,e]},useSyncExternalStore:function(e,t,n){var a=Pt,l=xr();if(Wt){if(n===void 0)throw Error(s(407));n=n()}else{if(n=t(),gn===null)throw Error(s(349));(Zt&127)!==0||Sd(a,t,n)}l.memoizedState=n;var d={value:n,getSnapshot:t};return l.queue=d,Ud(Cd.bind(null,a,d,e),[e]),a.flags|=2048,js(9,{destroy:void 0},_d.bind(null,a,d,n,t),null),n},useId:function(){var e=xr(),t=gn.identifierPrefix;if(Wt){var n=ga,a=ma;n=(a&~(1<<32-Qe(a)-1)).toString(32)+n,t="_"+t+"R_"+n,n=vl++,0<n&&(t+="H"+n.toString(32)),t+="_"}else n=Qm++,t="_"+t+"r_"+n.toString(32)+"_";return e.memoizedState=t},useHostTransitionStatus:uu,useFormState:Nd,useActionState:Nd,useOptimistic:function(e){var t=xr();t.memoizedState=t.baseState=e;var n={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return t.queue=n,t=fu.bind(null,Pt,!0,n),n.dispatch=t,[e,t]},useMemoCache:tu,useCacheRefresh:function(){return xr().memoizedState=Wm.bind(null,Pt)},useEffectEvent:function(e){var t=xr(),n={impl:e};return t.memoizedState=n,function(){if((sn&2)!==0)throw Error(s(440));return n.impl.apply(void 0,arguments)}}},du={readContext:ir,use:bl,useCallback:qd,useContext:ir,useEffect:su,useImperativeHandle:Pd,useInsertionEffect:Hd,useLayoutEffect:Id,useMemo:Yd,useReducer:Sl,useRef:Bd,useState:function(){return Sl(Oa)},useDebugValue:ou,useDeferredValue:function(e,t){var n=Un();return Vd(n,fn.memoizedState,e,t)},useTransition:function(){var e=Sl(Oa)[0],t=Un().memoizedState;return[typeof e=="boolean"?e:vo(e),t]},useSyncExternalStore:bd,useId:Xd,useHostTransitionStatus:uu,useFormState:Od,useActionState:Od,useOptimistic:function(e,t){var n=Un();return Td(n,fn,e,t)},useMemoCache:tu,useCacheRefresh:Fd};du.useEffectEvent=Ld;var th={readContext:ir,use:bl,useCallback:qd,useContext:ir,useEffect:su,useImperativeHandle:Pd,useInsertionEffect:Hd,useLayoutEffect:Id,useMemo:Yd,useReducer:ru,useRef:Bd,useState:function(){return ru(Oa)},useDebugValue:ou,useDeferredValue:function(e,t){var n=Un();return fn===null?lu(n,e,t):Vd(n,fn.memoizedState,e,t)},useTransition:function(){var e=ru(Oa)[0],t=Un().memoizedState;return[typeof e=="boolean"?e:vo(e),t]},useSyncExternalStore:bd,useId:Xd,useHostTransitionStatus:uu,useFormState:zd,useActionState:zd,useOptimistic:function(e,t){var n=Un();return fn!==null?Td(n,fn,e,t):(n.baseState=e,[e,n.queue.dispatch])},useMemoCache:tu,useCacheRefresh:Fd};th.useEffectEvent=Ld;function hu(e,t,n,a){t=e.memoizedState,n=n(a,t),n=n==null?t:R({},t,n),e.memoizedState=n,e.lanes===0&&(e.updateQueue.baseState=n)}var pu={enqueueSetState:function(e,t,n){e=e._reactInternals;var a=Kr(),l=si(a);l.payload=t,n!=null&&(l.callback=n),t=oi(e,l,a),t!==null&&(Rr(t,e,a),po(t,e,a))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var a=Kr(),l=si(a);l.tag=1,l.payload=t,n!=null&&(l.callback=n),t=oi(e,l,a),t!==null&&(Rr(t,e,a),po(t,e,a))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=Kr(),a=si(n);a.tag=2,t!=null&&(a.callback=t),t=oi(e,a,n),t!==null&&(Rr(t,e,n),po(t,e,n))}};function nh(e,t,n,a,l,d,v){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(a,d,v):t.prototype&&t.prototype.isPureReactComponent?!o(n,a)||!o(l,d):!0}function rh(e,t,n,a){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(n,a),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(n,a),t.state!==e&&pu.enqueueReplaceState(t,t.state,null)}function Gi(e,t){var n=t;if("ref"in t){n={};for(var a in t)a!=="ref"&&(n[a]=t[a])}if(e=e.defaultProps){n===t&&(n=R({},n));for(var l in e)n[l]===void 0&&(n[l]=e[l])}return n}function ah(e){rt(e)}function ih(e){console.error(e)}function sh(e){rt(e)}function wl(e,t){try{var n=e.onUncaughtError;n(t.value,{componentStack:t.stack})}catch(a){setTimeout(function(){throw a})}}function oh(e,t,n){try{var a=e.onCaughtError;a(n.value,{componentStack:n.stack,errorBoundary:t.tag===1?t.stateNode:null})}catch(l){setTimeout(function(){throw l})}}function mu(e,t,n){return n=si(n),n.tag=3,n.payload={element:null},n.callback=function(){wl(e,t)},n}function lh(e){return e=si(e),e.tag=3,e}function ch(e,t,n,a){var l=n.type.getDerivedStateFromError;if(typeof l=="function"){var d=a.value;e.payload=function(){return l(d)},e.callback=function(){oh(t,n,a)}}var v=n.stateNode;v!==null&&typeof v.componentDidCatch=="function"&&(e.callback=function(){oh(t,n,a),typeof l!="function"&&(hi===null?hi=new Set([this]):hi.add(this));var j=a.stack;this.componentDidCatch(a.value,{componentStack:j!==null?j:""})})}function tg(e,t,n,a,l){if(n.flags|=32768,a!==null&&typeof a=="object"&&typeof a.then=="function"){if(t=n.alternate,t!==null&&Ss(t,n,l,!0),n=Ur.current,n!==null){switch(n.tag){case 31:case 13:return Wr===null?Ul():n.alternate===null&&Nn===0&&(Nn=3),n.flags&=-257,n.flags|=65536,n.lanes=l,a===dl?n.flags|=16384:(t=n.updateQueue,t===null?n.updateQueue=new Set([a]):t.add(a),Iu(e,a,l)),!1;case 22:return n.flags|=65536,a===dl?n.flags|=16384:(t=n.updateQueue,t===null?(t={transitions:null,markerInstances:null,retryQueue:new Set([a])},n.updateQueue=t):(n=t.retryQueue,n===null?t.retryQueue=new Set([a]):n.add(a)),Iu(e,a,l)),!1}throw Error(s(435,n.tag))}return Iu(e,a,l),Ul(),!1}if(Wt)return t=Ur.current,t!==null?((t.flags&65536)===0&&(t.flags|=256),t.flags|=65536,t.lanes=l,a!==Dc&&(e=Error(s(422),{cause:a}),lo(Xr(e,n)))):(a!==Dc&&(t=Error(s(423),{cause:a}),lo(Xr(t,n))),e=e.current.alternate,e.flags|=65536,l&=-l,e.lanes|=l,a=Xr(a,n),l=mu(e.stateNode,a,l),Vc(e,l),Nn!==4&&(Nn=2)),!1;var d=Error(s(520),{cause:a});if(d=Xr(d,n),Mo===null?Mo=[d]:Mo.push(d),Nn!==4&&(Nn=2),t===null)return!0;a=Xr(a,n),n=t;do{switch(n.tag){case 3:return n.flags|=65536,e=l&-l,n.lanes|=e,e=mu(n.stateNode,a,e),Vc(n,e),!1;case 1:if(t=n.type,d=n.stateNode,(n.flags&128)===0&&(typeof t.getDerivedStateFromError=="function"||d!==null&&typeof d.componentDidCatch=="function"&&(hi===null||!hi.has(d))))return n.flags|=65536,l&=-l,n.lanes|=l,l=lh(l),ch(l,e,n,a),Vc(n,l),!1}n=n.return}while(n!==null);return!1}var gu=Error(s(461)),Yn=!1;function sr(e,t,n,a){t.child=e===null?hd(t,null,n,a):Yi(t,e.child,n,a)}function uh(e,t,n,a,l){n=n.render;var d=t.ref;if("ref"in a){var v={};for(var j in a)j!=="ref"&&(v[j]=a[j])}else v=a;return Ii(t),a=Zc(e,t,n,v,d,l),j=Jc(),e!==null&&!Yn?(Wc(e,t,l),Da(e,t,l)):(Wt&&j&&Nc(t),t.flags|=1,sr(e,t,a,l),t.child)}function fh(e,t,n,a,l){if(e===null){var d=n.type;return typeof d=="function"&&!jc(d)&&d.defaultProps===void 0&&n.compare===null?(t.tag=15,t.type=d,dh(e,t,d,a,l)):(e=sl(n.type,null,a,t,t.mode,l),e.ref=t.ref,e.return=t,t.child=e)}if(d=e.child,!Eu(e,l)){var v=d.memoizedProps;if(n=n.compare,n=n!==null?n:o,n(v,a)&&e.ref===t.ref)return Da(e,t,l)}return t.flags|=1,e=Ma(d,a),e.ref=t.ref,e.return=t,t.child=e}function dh(e,t,n,a,l){if(e!==null){var d=e.memoizedProps;if(o(d,a)&&e.ref===t.ref)if(Yn=!1,t.pendingProps=a=d,Eu(e,l))(e.flags&131072)!==0&&(Yn=!0);else return t.lanes=e.lanes,Da(e,t,l)}return yu(e,t,n,a,l)}function hh(e,t,n,a){var l=a.children,d=e!==null?e.memoizedState:null;if(e===null&&t.stateNode===null&&(t.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),a.mode==="hidden"){if((t.flags&128)!==0){if(d=d!==null?d.baseLanes|n:n,e!==null){for(a=t.child=e.child,l=0;a!==null;)l=l|a.lanes|a.childLanes,a=a.sibling;a=l&~d}else a=0,t.child=null;return ph(e,t,d,n,a)}if((n&536870912)!==0)t.memoizedState={baseLanes:0,cachePool:null},e!==null&&ul(t,d!==null?d.cachePool:null),d!==null?gd(t,d):Qc(),yd(t);else return a=t.lanes=536870912,ph(e,t,d!==null?d.baseLanes|n:n,n,a)}else d!==null?(ul(t,d.cachePool),gd(t,d),ci(),t.memoizedState=null):(e!==null&&ul(t,null),Qc(),ci());return sr(e,t,l,n),t.child}function So(e,t){return e!==null&&e.tag===22||t.stateNode!==null||(t.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),t.sibling}function ph(e,t,n,a,l){var d=Kc();return d=d===null?null:{parent:Pn._currentValue,pool:d},t.memoizedState={baseLanes:n,cachePool:d},e!==null&&ul(t,null),Qc(),yd(t),e!==null&&Ss(e,t,a,!0),t.childLanes=l,null}function Tl(e,t){return t=Ml({mode:t.mode,children:t.children},e.mode),t.ref=e.ref,e.child=t,t.return=e,t}function mh(e,t,n){return Yi(t,e.child,null,n),e=Tl(t,t.pendingProps),e.flags|=2,Lr(t),t.memoizedState=null,e}function ng(e,t,n){var a=t.pendingProps,l=(t.flags&128)!==0;if(t.flags&=-129,e===null){if(Wt){if(a.mode==="hidden")return e=Tl(t,a),t.lanes=536870912,So(null,e);if(Xc(t),(e=Sn)?(e=k0(e,Jr),e=e!==null&&e.data==="&"?e:null,e!==null&&(t.memoizedState={dehydrated:e,treeContext:ti!==null?{id:ma,overflow:ga}:null,retryLane:536870912,hydrationErrors:null},n=Jf(e),n.return=t,t.child=n,ar=t,Sn=null)):e=null,e===null)throw ri(t);return t.lanes=536870912,null}return Tl(t,a)}var d=e.memoizedState;if(d!==null){var v=d.dehydrated;if(Xc(t),l)if(t.flags&256)t.flags&=-257,t=mh(e,t,n);else if(t.memoizedState!==null)t.child=e.child,t.flags|=128,t=null;else throw Error(s(558));else if(Yn||Ss(e,t,n,!1),l=(n&e.childLanes)!==0,Yn||l){if(a=gn,a!==null&&(v=b(a,n),v!==0&&v!==d.retryLane))throw d.retryLane=v,En(e,v),Rr(a,e,v),gu;Ul(),t=mh(e,t,n)}else e=d.treeContext,Sn=ea(v.nextSibling),ar=t,Wt=!0,ni=null,Jr=!1,e!==null&&td(t,e),t=Tl(t,a),t.flags|=4096;return t}return e=Ma(e.child,{mode:a.mode,children:a.children}),e.ref=t.ref,t.child=e,e.return=t,e}function kl(e,t){var n=t.ref;if(n===null)e!==null&&e.ref!==null&&(t.flags|=4194816);else{if(typeof n!="function"&&typeof n!="object")throw Error(s(284));(e===null||e.ref!==n)&&(t.flags|=4194816)}}function yu(e,t,n,a,l){return Ii(t),n=Zc(e,t,n,a,void 0,l),a=Jc(),e!==null&&!Yn?(Wc(e,t,l),Da(e,t,l)):(Wt&&a&&Nc(t),t.flags|=1,sr(e,t,n,l),t.child)}function gh(e,t,n,a,l,d){return Ii(t),t.updateQueue=null,n=xd(t,a,n,l),vd(e),a=Jc(),e!==null&&!Yn?(Wc(e,t,d),Da(e,t,d)):(Wt&&a&&Nc(t),t.flags|=1,sr(e,t,n,d),t.child)}function yh(e,t,n,a,l){if(Ii(t),t.stateNode===null){var d=wr,v=n.contextType;typeof v=="object"&&v!==null&&(d=ir(v)),d=new n(a,d),t.memoizedState=d.state!==null&&d.state!==void 0?d.state:null,d.updater=pu,t.stateNode=d,d._reactInternals=t,d=t.stateNode,d.props=a,d.state=t.memoizedState,d.refs={},qc(t),v=n.contextType,d.context=typeof v=="object"&&v!==null?ir(v):wr,d.state=t.memoizedState,v=n.getDerivedStateFromProps,typeof v=="function"&&(hu(t,n,v,a),d.state=t.memoizedState),typeof n.getDerivedStateFromProps=="function"||typeof d.getSnapshotBeforeUpdate=="function"||typeof d.UNSAFE_componentWillMount!="function"&&typeof d.componentWillMount!="function"||(v=d.state,typeof d.componentWillMount=="function"&&d.componentWillMount(),typeof d.UNSAFE_componentWillMount=="function"&&d.UNSAFE_componentWillMount(),v!==d.state&&pu.enqueueReplaceState(d,d.state,null),go(t,a,d,l),mo(),d.state=t.memoizedState),typeof d.componentDidMount=="function"&&(t.flags|=4194308),a=!0}else if(e===null){d=t.stateNode;var j=t.memoizedProps,B=Gi(n,j);d.props=B;var te=d.context,me=n.contextType;v=wr,typeof me=="object"&&me!==null&&(v=ir(me));var be=n.getDerivedStateFromProps;me=typeof be=="function"||typeof d.getSnapshotBeforeUpdate=="function",j=t.pendingProps!==j,me||typeof d.UNSAFE_componentWillReceiveProps!="function"&&typeof d.componentWillReceiveProps!="function"||(j||te!==v)&&rh(t,d,a,v),ii=!1;var re=t.memoizedState;d.state=re,go(t,a,d,l),mo(),te=t.memoizedState,j||re!==te||ii?(typeof be=="function"&&(hu(t,n,be,a),te=t.memoizedState),(B=ii||nh(t,n,B,a,re,te,v))?(me||typeof d.UNSAFE_componentWillMount!="function"&&typeof d.componentWillMount!="function"||(typeof d.componentWillMount=="function"&&d.componentWillMount(),typeof d.UNSAFE_componentWillMount=="function"&&d.UNSAFE_componentWillMount()),typeof d.componentDidMount=="function"&&(t.flags|=4194308)):(typeof d.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=a,t.memoizedState=te),d.props=a,d.state=te,d.context=v,a=B):(typeof d.componentDidMount=="function"&&(t.flags|=4194308),a=!1)}else{d=t.stateNode,Yc(e,t),v=t.memoizedProps,me=Gi(n,v),d.props=me,be=t.pendingProps,re=d.context,te=n.contextType,B=wr,typeof te=="object"&&te!==null&&(B=ir(te)),j=n.getDerivedStateFromProps,(te=typeof j=="function"||typeof d.getSnapshotBeforeUpdate=="function")||typeof d.UNSAFE_componentWillReceiveProps!="function"&&typeof d.componentWillReceiveProps!="function"||(v!==be||re!==B)&&rh(t,d,a,B),ii=!1,re=t.memoizedState,d.state=re,go(t,a,d,l),mo();var ce=t.memoizedState;v!==be||re!==ce||ii||e!==null&&e.dependencies!==null&&ll(e.dependencies)?(typeof j=="function"&&(hu(t,n,j,a),ce=t.memoizedState),(me=ii||nh(t,n,me,a,re,ce,B)||e!==null&&e.dependencies!==null&&ll(e.dependencies))?(te||typeof d.UNSAFE_componentWillUpdate!="function"&&typeof d.componentWillUpdate!="function"||(typeof d.componentWillUpdate=="function"&&d.componentWillUpdate(a,ce,B),typeof d.UNSAFE_componentWillUpdate=="function"&&d.UNSAFE_componentWillUpdate(a,ce,B)),typeof d.componentDidUpdate=="function"&&(t.flags|=4),typeof d.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof d.componentDidUpdate!="function"||v===e.memoizedProps&&re===e.memoizedState||(t.flags|=4),typeof d.getSnapshotBeforeUpdate!="function"||v===e.memoizedProps&&re===e.memoizedState||(t.flags|=1024),t.memoizedProps=a,t.memoizedState=ce),d.props=a,d.state=ce,d.context=B,a=me):(typeof d.componentDidUpdate!="function"||v===e.memoizedProps&&re===e.memoizedState||(t.flags|=4),typeof d.getSnapshotBeforeUpdate!="function"||v===e.memoizedProps&&re===e.memoizedState||(t.flags|=1024),a=!1)}return d=a,kl(e,t),a=(t.flags&128)!==0,d||a?(d=t.stateNode,n=a&&typeof n.getDerivedStateFromError!="function"?null:d.render(),t.flags|=1,e!==null&&a?(t.child=Yi(t,e.child,null,l),t.child=Yi(t,null,n,l)):sr(e,t,n,l),t.memoizedState=d.state,e=t.child):e=Da(e,t,l),e}function vh(e,t,n,a){return Li(),t.flags|=256,sr(e,t,n,a),t.child}var vu={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function xu(e){return{baseLanes:e,cachePool:od()}}function bu(e,t,n){return e=e!==null?e.childLanes&~n:0,t&&(e|=Ir),e}function xh(e,t,n){var a=t.pendingProps,l=!1,d=(t.flags&128)!==0,v;if((v=d)||(v=e!==null&&e.memoizedState===null?!1:(Bn.current&2)!==0),v&&(l=!0,t.flags&=-129),v=(t.flags&32)!==0,t.flags&=-33,e===null){if(Wt){if(l?li(t):ci(),(e=Sn)?(e=k0(e,Jr),e=e!==null&&e.data!=="&"?e:null,e!==null&&(t.memoizedState={dehydrated:e,treeContext:ti!==null?{id:ma,overflow:ga}:null,retryLane:536870912,hydrationErrors:null},n=Jf(e),n.return=t,t.child=n,ar=t,Sn=null)):e=null,e===null)throw ri(t);return nf(e)?t.lanes=32:t.lanes=536870912,null}var j=a.children;return a=a.fallback,l?(ci(),l=t.mode,j=Ml({mode:"hidden",children:j},l),a=Ui(a,l,n,null),j.return=t,a.return=t,j.sibling=a,t.child=j,a=t.child,a.memoizedState=xu(n),a.childLanes=bu(e,v,n),t.memoizedState=vu,So(null,a)):(li(t),Su(t,j))}var B=e.memoizedState;if(B!==null&&(j=B.dehydrated,j!==null)){if(d)t.flags&256?(li(t),t.flags&=-257,t=_u(e,t,n)):t.memoizedState!==null?(ci(),t.child=e.child,t.flags|=128,t=null):(ci(),j=a.fallback,l=t.mode,a=Ml({mode:"visible",children:a.children},l),j=Ui(j,l,n,null),j.flags|=2,a.return=t,j.return=t,a.sibling=j,t.child=a,Yi(t,e.child,null,n),a=t.child,a.memoizedState=xu(n),a.childLanes=bu(e,v,n),t.memoizedState=vu,t=So(null,a));else if(li(t),nf(j)){if(v=j.nextSibling&&j.nextSibling.dataset,v)var te=v.dgst;v=te,a=Error(s(419)),a.stack="",a.digest=v,lo({value:a,source:null,stack:null}),t=_u(e,t,n)}else if(Yn||Ss(e,t,n,!1),v=(n&e.childLanes)!==0,Yn||v){if(v=gn,v!==null&&(a=b(v,n),a!==0&&a!==B.retryLane))throw B.retryLane=a,En(e,a),Rr(v,e,a),gu;tf(j)||Ul(),t=_u(e,t,n)}else tf(j)?(t.flags|=192,t.child=e.child,t=null):(e=B.treeContext,Sn=ea(j.nextSibling),ar=t,Wt=!0,ni=null,Jr=!1,e!==null&&td(t,e),t=Su(t,a.children),t.flags|=4096);return t}return l?(ci(),j=a.fallback,l=t.mode,B=e.child,te=B.sibling,a=Ma(B,{mode:"hidden",children:a.children}),a.subtreeFlags=B.subtreeFlags&65011712,te!==null?j=Ma(te,j):(j=Ui(j,l,n,null),j.flags|=2),j.return=t,a.return=t,a.sibling=j,t.child=a,So(null,a),a=t.child,j=e.child.memoizedState,j===null?j=xu(n):(l=j.cachePool,l!==null?(B=Pn._currentValue,l=l.parent!==B?{parent:B,pool:B}:l):l=od(),j={baseLanes:j.baseLanes|n,cachePool:l}),a.memoizedState=j,a.childLanes=bu(e,v,n),t.memoizedState=vu,So(e.child,a)):(li(t),n=e.child,e=n.sibling,n=Ma(n,{mode:"visible",children:a.children}),n.return=t,n.sibling=null,e!==null&&(v=t.deletions,v===null?(t.deletions=[e],t.flags|=16):v.push(e)),t.child=n,t.memoizedState=null,n)}function Su(e,t){return t=Ml({mode:"visible",children:t},e.mode),t.return=e,e.child=t}function Ml(e,t){return e=Br(22,e,null,t),e.lanes=0,e}function _u(e,t,n){return Yi(t,e.child,null,n),e=Su(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function bh(e,t,n){e.lanes|=t;var a=e.alternate;a!==null&&(a.lanes|=t),Uc(e.return,t,n)}function Cu(e,t,n,a,l,d){var v=e.memoizedState;v===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:a,tail:n,tailMode:l,treeForkCount:d}:(v.isBackwards=t,v.rendering=null,v.renderingStartTime=0,v.last=a,v.tail=n,v.tailMode=l,v.treeForkCount=d)}function Sh(e,t,n){var a=t.pendingProps,l=a.revealOrder,d=a.tail;a=a.children;var v=Bn.current,j=(v&2)!==0;if(j?(v=v&1|2,t.flags|=128):v&=1,Ce(Bn,v),sr(e,t,a,n),a=Wt?oo:0,!j&&e!==null&&(e.flags&128)!==0)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&bh(e,n,t);else if(e.tag===19)bh(e,n,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}switch(l){case"forwards":for(n=t.child,l=null;n!==null;)e=n.alternate,e!==null&&gl(e)===null&&(l=n),n=n.sibling;n=l,n===null?(l=t.child,t.child=null):(l=n.sibling,n.sibling=null),Cu(t,!1,l,n,d,a);break;case"backwards":case"unstable_legacy-backwards":for(n=null,l=t.child,t.child=null;l!==null;){if(e=l.alternate,e!==null&&gl(e)===null){t.child=l;break}e=l.sibling,l.sibling=n,n=l,l=e}Cu(t,!0,n,null,d,a);break;case"together":Cu(t,!1,null,null,void 0,a);break;default:t.memoizedState=null}return t.child}function Da(e,t,n){if(e!==null&&(t.dependencies=e.dependencies),di|=t.lanes,(n&t.childLanes)===0)if(e!==null){if(Ss(e,t,n,!1),(n&t.childLanes)===0)return null}else return null;if(e!==null&&t.child!==e.child)throw Error(s(153));if(t.child!==null){for(e=t.child,n=Ma(e,e.pendingProps),t.child=n,n.return=t;e.sibling!==null;)e=e.sibling,n=n.sibling=Ma(e,e.pendingProps),n.return=t;n.sibling=null}return t.child}function Eu(e,t){return(e.lanes&t)!==0?!0:(e=e.dependencies,!!(e!==null&&ll(e)))}function rg(e,t,n){switch(t.tag){case 3:kt(t,t.stateNode.containerInfo),ai(t,Pn,e.memoizedState.cache),Li();break;case 27:case 5:ct(t);break;case 4:kt(t,t.stateNode.containerInfo);break;case 10:ai(t,t.type,t.memoizedProps.value);break;case 31:if(t.memoizedState!==null)return t.flags|=128,Xc(t),null;break;case 13:var a=t.memoizedState;if(a!==null)return a.dehydrated!==null?(li(t),t.flags|=128,null):(n&t.child.childLanes)!==0?xh(e,t,n):(li(t),e=Da(e,t,n),e!==null?e.sibling:null);li(t);break;case 19:var l=(e.flags&128)!==0;if(a=(n&t.childLanes)!==0,a||(Ss(e,t,n,!1),a=(n&t.childLanes)!==0),l){if(a)return Sh(e,t,n);t.flags|=128}if(l=t.memoizedState,l!==null&&(l.rendering=null,l.tail=null,l.lastEffect=null),Ce(Bn,Bn.current),a)break;return null;case 22:return t.lanes=0,hh(e,t,n,t.pendingProps);case 24:ai(t,Pn,e.memoizedState.cache)}return Da(e,t,n)}function _h(e,t,n){if(e!==null)if(e.memoizedProps!==t.pendingProps)Yn=!0;else{if(!Eu(e,n)&&(t.flags&128)===0)return Yn=!1,rg(e,t,n);Yn=(e.flags&131072)!==0}else Yn=!1,Wt&&(t.flags&1048576)!==0&&ed(t,oo,t.index);switch(t.lanes=0,t.tag){case 16:e:{var a=t.pendingProps;if(e=Pi(t.elementType),t.type=e,typeof e=="function")jc(e)?(a=Gi(e,a),t.tag=1,t=yh(null,t,e,a,n)):(t.tag=0,t=yu(null,t,e,a,n));else{if(e!=null){var l=e.$$typeof;if(l===$e){t.tag=11,t=uh(null,t,e,a,n);break e}else if(l===et){t.tag=14,t=fh(null,t,e,a,n);break e}}throw t=xt(e)||e,Error(s(306,t,""))}}return t;case 0:return yu(e,t,t.type,t.pendingProps,n);case 1:return a=t.type,l=Gi(a,t.pendingProps),yh(e,t,a,l,n);case 3:e:{if(kt(t,t.stateNode.containerInfo),e===null)throw Error(s(387));a=t.pendingProps;var d=t.memoizedState;l=d.element,Yc(e,t),go(t,a,null,n);var v=t.memoizedState;if(a=v.cache,ai(t,Pn,a),a!==d.cache&&Lc(t,[Pn],n,!0),mo(),a=v.element,d.isDehydrated)if(d={element:a,isDehydrated:!1,cache:v.cache},t.updateQueue.baseState=d,t.memoizedState=d,t.flags&256){t=vh(e,t,a,n);break e}else if(a!==l){l=Xr(Error(s(424)),t),lo(l),t=vh(e,t,a,n);break e}else{switch(e=t.stateNode.containerInfo,e.nodeType){case 9:e=e.body;break;default:e=e.nodeName==="HTML"?e.ownerDocument.body:e}for(Sn=ea(e.firstChild),ar=t,Wt=!0,ni=null,Jr=!0,n=hd(t,null,a,n),t.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling}else{if(Li(),a===l){t=Da(e,t,n);break e}sr(e,t,a,n)}t=t.child}return t;case 26:return kl(e,t),e===null?(n=O0(t.type,null,t.pendingProps,null))?t.memoizedState=n:Wt||(n=t.type,e=t.pendingProps,a=Yl(Ee.current).createElement(n),a[G]=t,a[fe]=e,or(a,n,e),it(a),t.stateNode=a):t.memoizedState=O0(t.type,e.memoizedProps,t.pendingProps,e.memoizedState),null;case 27:return ct(t),e===null&&Wt&&(a=t.stateNode=R0(t.type,t.pendingProps,Ee.current),ar=t,Jr=!0,l=Sn,yi(t.type)?(rf=l,Sn=ea(a.firstChild)):Sn=l),sr(e,t,t.pendingProps.children,n),kl(e,t),e===null&&(t.flags|=4194304),t.child;case 5:return e===null&&Wt&&((l=a=Sn)&&(a=Og(a,t.type,t.pendingProps,Jr),a!==null?(t.stateNode=a,ar=t,Sn=ea(a.firstChild),Jr=!1,l=!0):l=!1),l||ri(t)),ct(t),l=t.type,d=t.pendingProps,v=e!==null?e.memoizedProps:null,a=d.children,Ju(l,d)?a=null:v!==null&&Ju(l,v)&&(t.flags|=32),t.memoizedState!==null&&(l=Zc(e,t,$m,null,null,n),Bo._currentValue=l),kl(e,t),sr(e,t,a,n),t.child;case 6:return e===null&&Wt&&((e=n=Sn)&&(n=Dg(n,t.pendingProps,Jr),n!==null?(t.stateNode=n,ar=t,Sn=null,e=!0):e=!1),e||ri(t)),null;case 13:return xh(e,t,n);case 4:return kt(t,t.stateNode.containerInfo),a=t.pendingProps,e===null?t.child=Yi(t,null,a,n):sr(e,t,a,n),t.child;case 11:return uh(e,t,t.type,t.pendingProps,n);case 7:return sr(e,t,t.pendingProps,n),t.child;case 8:return sr(e,t,t.pendingProps.children,n),t.child;case 12:return sr(e,t,t.pendingProps.children,n),t.child;case 10:return a=t.pendingProps,ai(t,t.type,a.value),sr(e,t,a.children,n),t.child;case 9:return l=t.type._context,a=t.pendingProps.children,Ii(t),l=ir(l),a=a(l),t.flags|=1,sr(e,t,a,n),t.child;case 14:return fh(e,t,t.type,t.pendingProps,n);case 15:return dh(e,t,t.type,t.pendingProps,n);case 19:return Sh(e,t,n);case 31:return ng(e,t,n);case 22:return hh(e,t,n,t.pendingProps);case 24:return Ii(t),a=ir(Pn),e===null?(l=Kc(),l===null&&(l=gn,d=Hc(),l.pooledCache=d,d.refCount++,d!==null&&(l.pooledCacheLanes|=n),l=d),t.memoizedState={parent:a,cache:l},qc(t),ai(t,Pn,l)):((e.lanes&n)!==0&&(Yc(e,t),go(t,null,null,n),mo()),l=e.memoizedState,d=t.memoizedState,l.parent!==a?(l={parent:a,cache:a},t.memoizedState=l,t.lanes===0&&(t.memoizedState=t.updateQueue.baseState=l),ai(t,Pn,a)):(a=d.cache,ai(t,Pn,a),a!==l.cache&&Lc(t,[Pn],n,!0))),sr(e,t,t.pendingProps.children,n),t.child;case 29:throw t.pendingProps}throw Error(s(156,t.tag))}function za(e){e.flags|=4}function wu(e,t,n,a,l){if((t=(e.mode&32)!==0)&&(t=!1),t){if(e.flags|=16777216,(l&335544128)===l)if(e.stateNode.complete)e.flags|=8192;else if(Xh())e.flags|=8192;else throw qi=dl,Pc}else e.flags&=-16777217}function Ch(e,t){if(t.type!=="stylesheet"||(t.state.loading&4)!==0)e.flags&=-16777217;else if(e.flags|=16777216,!L0(t))if(Xh())e.flags|=8192;else throw qi=dl,Pc}function jl(e,t){t!==null&&(e.flags|=4),e.flags&16384&&(t=e.tag!==22?Va():536870912,e.lanes|=t,Os|=t)}function _o(e,t){if(!Wt)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;t!==null;)t.alternate!==null&&(n=t),t=t.sibling;n===null?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var a=null;n!==null;)n.alternate!==null&&(a=n),n=n.sibling;a===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:a.sibling=null}}function _n(e){var t=e.alternate!==null&&e.alternate.child===e.child,n=0,a=0;if(t)for(var l=e.child;l!==null;)n|=l.lanes|l.childLanes,a|=l.subtreeFlags&65011712,a|=l.flags&65011712,l.return=e,l=l.sibling;else for(l=e.child;l!==null;)n|=l.lanes|l.childLanes,a|=l.subtreeFlags,a|=l.flags,l.return=e,l=l.sibling;return e.subtreeFlags|=a,e.childLanes=n,t}function ag(e,t,n){var a=t.pendingProps;switch(Oc(t),t.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return _n(t),null;case 1:return _n(t),null;case 3:return n=t.stateNode,a=null,e!==null&&(a=e.memoizedState.cache),t.memoizedState.cache!==a&&(t.flags|=2048),Aa(Pn),ze(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(e===null||e.child===null)&&(bs(t)?za(t):e===null||e.memoizedState.isDehydrated&&(t.flags&256)===0||(t.flags|=1024,zc())),_n(t),null;case 26:var l=t.type,d=t.memoizedState;return e===null?(za(t),d!==null?(_n(t),Ch(t,d)):(_n(t),wu(t,l,null,a,n))):d?d!==e.memoizedState?(za(t),_n(t),Ch(t,d)):(_n(t),t.flags&=-16777217):(e=e.memoizedProps,e!==a&&za(t),_n(t),wu(t,l,e,a,n)),null;case 27:if(pn(t),n=Ee.current,l=t.type,e!==null&&t.stateNode!=null)e.memoizedProps!==a&&za(t);else{if(!a){if(t.stateNode===null)throw Error(s(166));return _n(t),null}e=Le.current,bs(t)?nd(t):(e=R0(l,a,n),t.stateNode=e,za(t))}return _n(t),null;case 5:if(pn(t),l=t.type,e!==null&&t.stateNode!=null)e.memoizedProps!==a&&za(t);else{if(!a){if(t.stateNode===null)throw Error(s(166));return _n(t),null}if(d=Le.current,bs(t))nd(t);else{var v=Yl(Ee.current);switch(d){case 1:d=v.createElementNS("http://www.w3.org/2000/svg",l);break;case 2:d=v.createElementNS("http://www.w3.org/1998/Math/MathML",l);break;default:switch(l){case"svg":d=v.createElementNS("http://www.w3.org/2000/svg",l);break;case"math":d=v.createElementNS("http://www.w3.org/1998/Math/MathML",l);break;case"script":d=v.createElement("div"),d.innerHTML="<script><\/script>",d=d.removeChild(d.firstChild);break;case"select":d=typeof a.is=="string"?v.createElement("select",{is:a.is}):v.createElement("select"),a.multiple?d.multiple=!0:a.size&&(d.size=a.size);break;default:d=typeof a.is=="string"?v.createElement(l,{is:a.is}):v.createElement(l)}}d[G]=t,d[fe]=a;e:for(v=t.child;v!==null;){if(v.tag===5||v.tag===6)d.appendChild(v.stateNode);else if(v.tag!==4&&v.tag!==27&&v.child!==null){v.child.return=v,v=v.child;continue}if(v===t)break e;for(;v.sibling===null;){if(v.return===null||v.return===t)break e;v=v.return}v.sibling.return=v.return,v=v.sibling}t.stateNode=d;e:switch(or(d,l,a),l){case"button":case"input":case"select":case"textarea":a=!!a.autoFocus;break e;case"img":a=!0;break e;default:a=!1}a&&za(t)}}return _n(t),wu(t,t.type,e===null?null:e.memoizedProps,t.pendingProps,n),null;case 6:if(e&&t.stateNode!=null)e.memoizedProps!==a&&za(t);else{if(typeof a!="string"&&t.stateNode===null)throw Error(s(166));if(e=Ee.current,bs(t)){if(e=t.stateNode,n=t.memoizedProps,a=null,l=ar,l!==null)switch(l.tag){case 27:case 5:a=l.memoizedProps}e[G]=t,e=!!(e.nodeValue===n||a!==null&&a.suppressHydrationWarning===!0||x0(e.nodeValue,n)),e||ri(t,!0)}else e=Yl(e).createTextNode(a),e[G]=t,t.stateNode=e}return _n(t),null;case 31:if(n=t.memoizedState,e===null||e.memoizedState!==null){if(a=bs(t),n!==null){if(e===null){if(!a)throw Error(s(318));if(e=t.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(s(557));e[G]=t}else Li(),(t.flags&128)===0&&(t.memoizedState=null),t.flags|=4;_n(t),e=!1}else n=zc(),e!==null&&e.memoizedState!==null&&(e.memoizedState.hydrationErrors=n),e=!0;if(!e)return t.flags&256?(Lr(t),t):(Lr(t),null);if((t.flags&128)!==0)throw Error(s(558))}return _n(t),null;case 13:if(a=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(l=bs(t),a!==null&&a.dehydrated!==null){if(e===null){if(!l)throw Error(s(318));if(l=t.memoizedState,l=l!==null?l.dehydrated:null,!l)throw Error(s(317));l[G]=t}else Li(),(t.flags&128)===0&&(t.memoizedState=null),t.flags|=4;_n(t),l=!1}else l=zc(),e!==null&&e.memoizedState!==null&&(e.memoizedState.hydrationErrors=l),l=!0;if(!l)return t.flags&256?(Lr(t),t):(Lr(t),null)}return Lr(t),(t.flags&128)!==0?(t.lanes=n,t):(n=a!==null,e=e!==null&&e.memoizedState!==null,n&&(a=t.child,l=null,a.alternate!==null&&a.alternate.memoizedState!==null&&a.alternate.memoizedState.cachePool!==null&&(l=a.alternate.memoizedState.cachePool.pool),d=null,a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(d=a.memoizedState.cachePool.pool),d!==l&&(a.flags|=2048)),n!==e&&n&&(t.child.flags|=8192),jl(t,t.updateQueue),_n(t),null);case 4:return ze(),e===null&&Qu(t.stateNode.containerInfo),_n(t),null;case 10:return Aa(t.type),_n(t),null;case 19:if(de(Bn),a=t.memoizedState,a===null)return _n(t),null;if(l=(t.flags&128)!==0,d=a.rendering,d===null)if(l)_o(a,!1);else{if(Nn!==0||e!==null&&(e.flags&128)!==0)for(e=t.child;e!==null;){if(d=gl(e),d!==null){for(t.flags|=128,_o(a,!1),e=d.updateQueue,t.updateQueue=e,jl(t,e),t.subtreeFlags=0,e=n,n=t.child;n!==null;)Zf(n,e),n=n.sibling;return Ce(Bn,Bn.current&1|2),Wt&&ja(t,a.treeForkCount),t.child}e=e.sibling}a.tail!==null&&Dn()>Dl&&(t.flags|=128,l=!0,_o(a,!1),t.lanes=4194304)}else{if(!l)if(e=gl(d),e!==null){if(t.flags|=128,l=!0,e=e.updateQueue,t.updateQueue=e,jl(t,e),_o(a,!0),a.tail===null&&a.tailMode==="hidden"&&!d.alternate&&!Wt)return _n(t),null}else 2*Dn()-a.renderingStartTime>Dl&&n!==536870912&&(t.flags|=128,l=!0,_o(a,!1),t.lanes=4194304);a.isBackwards?(d.sibling=t.child,t.child=d):(e=a.last,e!==null?e.sibling=d:t.child=d,a.last=d)}return a.tail!==null?(e=a.tail,a.rendering=e,a.tail=e.sibling,a.renderingStartTime=Dn(),e.sibling=null,n=Bn.current,Ce(Bn,l?n&1|2:n&1),Wt&&ja(t,a.treeForkCount),e):(_n(t),null);case 22:case 23:return Lr(t),$c(),a=t.memoizedState!==null,e!==null?e.memoizedState!==null!==a&&(t.flags|=8192):a&&(t.flags|=8192),a?(n&536870912)!==0&&(t.flags&128)===0&&(_n(t),t.subtreeFlags&6&&(t.flags|=8192)):_n(t),n=t.updateQueue,n!==null&&jl(t,n.retryQueue),n=null,e!==null&&e.memoizedState!==null&&e.memoizedState.cachePool!==null&&(n=e.memoizedState.cachePool.pool),a=null,t.memoizedState!==null&&t.memoizedState.cachePool!==null&&(a=t.memoizedState.cachePool.pool),a!==n&&(t.flags|=2048),e!==null&&de(Ki),null;case 24:return n=null,e!==null&&(n=e.memoizedState.cache),t.memoizedState.cache!==n&&(t.flags|=2048),Aa(Pn),_n(t),null;case 25:return null;case 30:return null}throw Error(s(156,t.tag))}function ig(e,t){switch(Oc(t),t.tag){case 1:return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return Aa(Pn),ze(),e=t.flags,(e&65536)!==0&&(e&128)===0?(t.flags=e&-65537|128,t):null;case 26:case 27:case 5:return pn(t),null;case 31:if(t.memoizedState!==null){if(Lr(t),t.alternate===null)throw Error(s(340));Li()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 13:if(Lr(t),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(s(340));Li()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return de(Bn),null;case 4:return ze(),null;case 10:return Aa(t.type),null;case 22:case 23:return Lr(t),$c(),e!==null&&de(Ki),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 24:return Aa(Pn),null;case 25:return null;default:return null}}function Eh(e,t){switch(Oc(t),t.tag){case 3:Aa(Pn),ze();break;case 26:case 27:case 5:pn(t);break;case 4:ze();break;case 31:t.memoizedState!==null&&Lr(t);break;case 13:Lr(t);break;case 19:de(Bn);break;case 10:Aa(t.type);break;case 22:case 23:Lr(t),$c(),e!==null&&de(Ki);break;case 24:Aa(Pn)}}function Co(e,t){try{var n=t.updateQueue,a=n!==null?n.lastEffect:null;if(a!==null){var l=a.next;n=l;do{if((n.tag&e)===e){a=void 0;var d=n.create,v=n.inst;a=d(),v.destroy=a}n=n.next}while(n!==l)}}catch(j){un(t,t.return,j)}}function ui(e,t,n){try{var a=t.updateQueue,l=a!==null?a.lastEffect:null;if(l!==null){var d=l.next;a=d;do{if((a.tag&e)===e){var v=a.inst,j=v.destroy;if(j!==void 0){v.destroy=void 0,l=t;var B=n,te=j;try{te()}catch(me){un(l,B,me)}}}a=a.next}while(a!==d)}}catch(me){un(t,t.return,me)}}function wh(e){var t=e.updateQueue;if(t!==null){var n=e.stateNode;try{md(t,n)}catch(a){un(e,e.return,a)}}}function Th(e,t,n){n.props=Gi(e.type,e.memoizedProps),n.state=e.memoizedState;try{n.componentWillUnmount()}catch(a){un(e,t,a)}}function Eo(e,t){try{var n=e.ref;if(n!==null){switch(e.tag){case 26:case 27:case 5:var a=e.stateNode;break;case 30:a=e.stateNode;break;default:a=e.stateNode}typeof n=="function"?e.refCleanup=n(a):n.current=a}}catch(l){un(e,t,l)}}function ya(e,t){var n=e.ref,a=e.refCleanup;if(n!==null)if(typeof a=="function")try{a()}catch(l){un(e,t,l)}finally{e.refCleanup=null,e=e.alternate,e!=null&&(e.refCleanup=null)}else if(typeof n=="function")try{n(null)}catch(l){un(e,t,l)}else n.current=null}function kh(e){var t=e.type,n=e.memoizedProps,a=e.stateNode;try{e:switch(t){case"button":case"input":case"select":case"textarea":n.autoFocus&&a.focus();break e;case"img":n.src?a.src=n.src:n.srcSet&&(a.srcset=n.srcSet)}}catch(l){un(e,e.return,l)}}function Tu(e,t,n){try{var a=e.stateNode;kg(a,e.type,n,t),a[fe]=t}catch(l){un(e,e.return,l)}}function Mh(e){return e.tag===5||e.tag===3||e.tag===26||e.tag===27&&yi(e.type)||e.tag===4}function ku(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||Mh(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.tag===27&&yi(e.type)||e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function Mu(e,t,n){var a=e.tag;if(a===5||a===6)e=e.stateNode,t?(n.nodeType===9?n.body:n.nodeName==="HTML"?n.ownerDocument.body:n).insertBefore(e,t):(t=n.nodeType===9?n.body:n.nodeName==="HTML"?n.ownerDocument.body:n,t.appendChild(e),n=n._reactRootContainer,n!=null||t.onclick!==null||(t.onclick=Er));else if(a!==4&&(a===27&&yi(e.type)&&(n=e.stateNode,t=null),e=e.child,e!==null))for(Mu(e,t,n),e=e.sibling;e!==null;)Mu(e,t,n),e=e.sibling}function Rl(e,t,n){var a=e.tag;if(a===5||a===6)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(a!==4&&(a===27&&yi(e.type)&&(n=e.stateNode),e=e.child,e!==null))for(Rl(e,t,n),e=e.sibling;e!==null;)Rl(e,t,n),e=e.sibling}function jh(e){var t=e.stateNode,n=e.memoizedProps;try{for(var a=e.type,l=t.attributes;l.length;)t.removeAttributeNode(l[0]);or(t,a,n),t[G]=e,t[fe]=n}catch(d){un(e,e.return,d)}}var Ba=!1,Vn=!1,ju=!1,Rh=typeof WeakSet=="function"?WeakSet:Set,Wn=null;function sg(e,t){if(e=e.containerInfo,Fu=Zl,e=C(e),T(e)){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{n=(n=e.ownerDocument)&&n.defaultView||window;var a=n.getSelection&&n.getSelection();if(a&&a.rangeCount!==0){n=a.anchorNode;var l=a.anchorOffset,d=a.focusNode;a=a.focusOffset;try{n.nodeType,d.nodeType}catch{n=null;break e}var v=0,j=-1,B=-1,te=0,me=0,be=e,re=null;t:for(;;){for(var ce;be!==n||l!==0&&be.nodeType!==3||(j=v+l),be!==d||a!==0&&be.nodeType!==3||(B=v+a),be.nodeType===3&&(v+=be.nodeValue.length),(ce=be.firstChild)!==null;)re=be,be=ce;for(;;){if(be===e)break t;if(re===n&&++te===l&&(j=v),re===d&&++me===a&&(B=v),(ce=be.nextSibling)!==null)break;be=re,re=be.parentNode}be=ce}n=j===-1||B===-1?null:{start:j,end:B}}else n=null}n=n||{start:0,end:0}}else n=null;for(Zu={focusedElem:e,selectionRange:n},Zl=!1,Wn=t;Wn!==null;)if(t=Wn,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,Wn=e;else for(;Wn!==null;){switch(t=Wn,d=t.alternate,e=t.flags,t.tag){case 0:if((e&4)!==0&&(e=t.updateQueue,e=e!==null?e.events:null,e!==null))for(n=0;n<e.length;n++)l=e[n],l.ref.impl=l.nextImpl;break;case 11:case 15:break;case 1:if((e&1024)!==0&&d!==null){e=void 0,n=t,l=d.memoizedProps,d=d.memoizedState,a=n.stateNode;try{var ot=Gi(n.type,l);e=a.getSnapshotBeforeUpdate(ot,d),a.__reactInternalSnapshotBeforeUpdate=e}catch(Tt){un(n,n.return,Tt)}}break;case 3:if((e&1024)!==0){if(e=t.stateNode.containerInfo,n=e.nodeType,n===9)ef(e);else if(n===1)switch(e.nodeName){case"HEAD":case"HTML":case"BODY":ef(e);break;default:e.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((e&1024)!==0)throw Error(s(163))}if(e=t.sibling,e!==null){e.return=t.return,Wn=e;break}Wn=t.return}}function Ah(e,t,n){var a=n.flags;switch(n.tag){case 0:case 11:case 15:La(e,n),a&4&&Co(5,n);break;case 1:if(La(e,n),a&4)if(e=n.stateNode,t===null)try{e.componentDidMount()}catch(v){un(n,n.return,v)}else{var l=Gi(n.type,t.memoizedProps);t=t.memoizedState;try{e.componentDidUpdate(l,t,e.__reactInternalSnapshotBeforeUpdate)}catch(v){un(n,n.return,v)}}a&64&&wh(n),a&512&&Eo(n,n.return);break;case 3:if(La(e,n),a&64&&(e=n.updateQueue,e!==null)){if(t=null,n.child!==null)switch(n.child.tag){case 27:case 5:t=n.child.stateNode;break;case 1:t=n.child.stateNode}try{md(e,t)}catch(v){un(n,n.return,v)}}break;case 27:t===null&&a&4&&jh(n);case 26:case 5:La(e,n),t===null&&a&4&&kh(n),a&512&&Eo(n,n.return);break;case 12:La(e,n);break;case 31:La(e,n),a&4&&Dh(e,n);break;case 13:La(e,n),a&4&&zh(e,n),a&64&&(e=n.memoizedState,e!==null&&(e=e.dehydrated,e!==null&&(n=mg.bind(null,n),zg(e,n))));break;case 22:if(a=n.memoizedState!==null||Ba,!a){t=t!==null&&t.memoizedState!==null||Vn,l=Ba;var d=Vn;Ba=a,(Vn=t)&&!d?Ha(e,n,(n.subtreeFlags&8772)!==0):La(e,n),Ba=l,Vn=d}break;case 30:break;default:La(e,n)}}function Nh(e){var t=e.alternate;t!==null&&(e.alternate=null,Nh(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&Ct(t)),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}var wn=null,Tr=!1;function Ua(e,t,n){for(n=n.child;n!==null;)Oh(e,t,n),n=n.sibling}function Oh(e,t,n){if(Mn&&typeof Mn.onCommitFiberUnmount=="function")try{Mn.onCommitFiberUnmount(mr,n)}catch{}switch(n.tag){case 26:Vn||ya(n,t),Ua(e,t,n),n.memoizedState?n.memoizedState.count--:n.stateNode&&(n=n.stateNode,n.parentNode.removeChild(n));break;case 27:Vn||ya(n,t);var a=wn,l=Tr;yi(n.type)&&(wn=n.stateNode,Tr=!1),Ua(e,t,n),Oo(n.stateNode),wn=a,Tr=l;break;case 5:Vn||ya(n,t);case 6:if(a=wn,l=Tr,wn=null,Ua(e,t,n),wn=a,Tr=l,wn!==null)if(Tr)try{(wn.nodeType===9?wn.body:wn.nodeName==="HTML"?wn.ownerDocument.body:wn).removeChild(n.stateNode)}catch(d){un(n,t,d)}else try{wn.removeChild(n.stateNode)}catch(d){un(n,t,d)}break;case 18:wn!==null&&(Tr?(e=wn,w0(e.nodeType===9?e.body:e.nodeName==="HTML"?e.ownerDocument.body:e,n.stateNode),Ks(e)):w0(wn,n.stateNode));break;case 4:a=wn,l=Tr,wn=n.stateNode.containerInfo,Tr=!0,Ua(e,t,n),wn=a,Tr=l;break;case 0:case 11:case 14:case 15:ui(2,n,t),Vn||ui(4,n,t),Ua(e,t,n);break;case 1:Vn||(ya(n,t),a=n.stateNode,typeof a.componentWillUnmount=="function"&&Th(n,t,a)),Ua(e,t,n);break;case 21:Ua(e,t,n);break;case 22:Vn=(a=Vn)||n.memoizedState!==null,Ua(e,t,n),Vn=a;break;default:Ua(e,t,n)}}function Dh(e,t){if(t.memoizedState===null&&(e=t.alternate,e!==null&&(e=e.memoizedState,e!==null))){e=e.dehydrated;try{Ks(e)}catch(n){un(t,t.return,n)}}}function zh(e,t){if(t.memoizedState===null&&(e=t.alternate,e!==null&&(e=e.memoizedState,e!==null&&(e=e.dehydrated,e!==null))))try{Ks(e)}catch(n){un(t,t.return,n)}}function og(e){switch(e.tag){case 31:case 13:case 19:var t=e.stateNode;return t===null&&(t=e.stateNode=new Rh),t;case 22:return e=e.stateNode,t=e._retryCache,t===null&&(t=e._retryCache=new Rh),t;default:throw Error(s(435,e.tag))}}function Al(e,t){var n=og(e);t.forEach(function(a){if(!n.has(a)){n.add(a);var l=gg.bind(null,e,a);a.then(l,l)}})}function kr(e,t){var n=t.deletions;if(n!==null)for(var a=0;a<n.length;a++){var l=n[a],d=e,v=t,j=v;e:for(;j!==null;){switch(j.tag){case 27:if(yi(j.type)){wn=j.stateNode,Tr=!1;break e}break;case 5:wn=j.stateNode,Tr=!1;break e;case 3:case 4:wn=j.stateNode.containerInfo,Tr=!0;break e}j=j.return}if(wn===null)throw Error(s(160));Oh(d,v,l),wn=null,Tr=!1,d=l.alternate,d!==null&&(d.return=null),l.return=null}if(t.subtreeFlags&13886)for(t=t.child;t!==null;)Bh(t,e),t=t.sibling}var sa=null;function Bh(e,t){var n=e.alternate,a=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:kr(t,e),Mr(e),a&4&&(ui(3,e,e.return),Co(3,e),ui(5,e,e.return));break;case 1:kr(t,e),Mr(e),a&512&&(Vn||n===null||ya(n,n.return)),a&64&&Ba&&(e=e.updateQueue,e!==null&&(a=e.callbacks,a!==null&&(n=e.shared.hiddenCallbacks,e.shared.hiddenCallbacks=n===null?a:n.concat(a))));break;case 26:var l=sa;if(kr(t,e),Mr(e),a&512&&(Vn||n===null||ya(n,n.return)),a&4){var d=n!==null?n.memoizedState:null;if(a=e.memoizedState,n===null)if(a===null)if(e.stateNode===null){e:{a=e.type,n=e.memoizedProps,l=l.ownerDocument||l;t:switch(a){case"title":d=l.getElementsByTagName("title")[0],(!d||d[pt]||d[G]||d.namespaceURI==="http://www.w3.org/2000/svg"||d.hasAttribute("itemprop"))&&(d=l.createElement(a),l.head.insertBefore(d,l.querySelector("head > title"))),or(d,a,n),d[G]=e,it(d),a=d;break e;case"link":var v=B0("link","href",l).get(a+(n.href||""));if(v){for(var j=0;j<v.length;j++)if(d=v[j],d.getAttribute("href")===(n.href==null||n.href===""?null:n.href)&&d.getAttribute("rel")===(n.rel==null?null:n.rel)&&d.getAttribute("title")===(n.title==null?null:n.title)&&d.getAttribute("crossorigin")===(n.crossOrigin==null?null:n.crossOrigin)){v.splice(j,1);break t}}d=l.createElement(a),or(d,a,n),l.head.appendChild(d);break;case"meta":if(v=B0("meta","content",l).get(a+(n.content||""))){for(j=0;j<v.length;j++)if(d=v[j],d.getAttribute("content")===(n.content==null?null:""+n.content)&&d.getAttribute("name")===(n.name==null?null:n.name)&&d.getAttribute("property")===(n.property==null?null:n.property)&&d.getAttribute("http-equiv")===(n.httpEquiv==null?null:n.httpEquiv)&&d.getAttribute("charset")===(n.charSet==null?null:n.charSet)){v.splice(j,1);break t}}d=l.createElement(a),or(d,a,n),l.head.appendChild(d);break;default:throw Error(s(468,a))}d[G]=e,it(d),a=d}e.stateNode=a}else U0(l,e.type,e.stateNode);else e.stateNode=z0(l,a,e.memoizedProps);else d!==a?(d===null?n.stateNode!==null&&(n=n.stateNode,n.parentNode.removeChild(n)):d.count--,a===null?U0(l,e.type,e.stateNode):z0(l,a,e.memoizedProps)):a===null&&e.stateNode!==null&&Tu(e,e.memoizedProps,n.memoizedProps)}break;case 27:kr(t,e),Mr(e),a&512&&(Vn||n===null||ya(n,n.return)),n!==null&&a&4&&Tu(e,e.memoizedProps,n.memoizedProps);break;case 5:if(kr(t,e),Mr(e),a&512&&(Vn||n===null||ya(n,n.return)),e.flags&32){l=e.stateNode;try{tn(l,"")}catch(ot){un(e,e.return,ot)}}a&4&&e.stateNode!=null&&(l=e.memoizedProps,Tu(e,l,n!==null?n.memoizedProps:l)),a&1024&&(ju=!0);break;case 6:if(kr(t,e),Mr(e),a&4){if(e.stateNode===null)throw Error(s(162));a=e.memoizedProps,n=e.stateNode;try{n.nodeValue=a}catch(ot){un(e,e.return,ot)}}break;case 3:if(Ql=null,l=sa,sa=Vl(t.containerInfo),kr(t,e),sa=l,Mr(e),a&4&&n!==null&&n.memoizedState.isDehydrated)try{Ks(t.containerInfo)}catch(ot){un(e,e.return,ot)}ju&&(ju=!1,Uh(e));break;case 4:a=sa,sa=Vl(e.stateNode.containerInfo),kr(t,e),Mr(e),sa=a;break;case 12:kr(t,e),Mr(e);break;case 31:kr(t,e),Mr(e),a&4&&(a=e.updateQueue,a!==null&&(e.updateQueue=null,Al(e,a)));break;case 13:kr(t,e),Mr(e),e.child.flags&8192&&e.memoizedState!==null!=(n!==null&&n.memoizedState!==null)&&(Ol=Dn()),a&4&&(a=e.updateQueue,a!==null&&(e.updateQueue=null,Al(e,a)));break;case 22:l=e.memoizedState!==null;var B=n!==null&&n.memoizedState!==null,te=Ba,me=Vn;if(Ba=te||l,Vn=me||B,kr(t,e),Vn=me,Ba=te,Mr(e),a&8192)e:for(t=e.stateNode,t._visibility=l?t._visibility&-2:t._visibility|1,l&&(n===null||B||Ba||Vn||Qi(e)),n=null,t=e;;){if(t.tag===5||t.tag===26){if(n===null){B=n=t;try{if(d=B.stateNode,l)v=d.style,typeof v.setProperty=="function"?v.setProperty("display","none","important"):v.display="none";else{j=B.stateNode;var be=B.memoizedProps.style,re=be!=null&&be.hasOwnProperty("display")?be.display:null;j.style.display=re==null||typeof re=="boolean"?"":(""+re).trim()}}catch(ot){un(B,B.return,ot)}}}else if(t.tag===6){if(n===null){B=t;try{B.stateNode.nodeValue=l?"":B.memoizedProps}catch(ot){un(B,B.return,ot)}}}else if(t.tag===18){if(n===null){B=t;try{var ce=B.stateNode;l?T0(ce,!0):T0(B.stateNode,!1)}catch(ot){un(B,B.return,ot)}}}else if((t.tag!==22&&t.tag!==23||t.memoizedState===null||t===e)&&t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;n===t&&(n=null),t=t.return}n===t&&(n=null),t.sibling.return=t.return,t=t.sibling}a&4&&(a=e.updateQueue,a!==null&&(n=a.retryQueue,n!==null&&(a.retryQueue=null,Al(e,n))));break;case 19:kr(t,e),Mr(e),a&4&&(a=e.updateQueue,a!==null&&(e.updateQueue=null,Al(e,a)));break;case 30:break;case 21:break;default:kr(t,e),Mr(e)}}function Mr(e){var t=e.flags;if(t&2){try{for(var n,a=e.return;a!==null;){if(Mh(a)){n=a;break}a=a.return}if(n==null)throw Error(s(160));switch(n.tag){case 27:var l=n.stateNode,d=ku(e);Rl(e,d,l);break;case 5:var v=n.stateNode;n.flags&32&&(tn(v,""),n.flags&=-33);var j=ku(e);Rl(e,j,v);break;case 3:case 4:var B=n.stateNode.containerInfo,te=ku(e);Mu(e,te,B);break;default:throw Error(s(161))}}catch(me){un(e,e.return,me)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function Uh(e){if(e.subtreeFlags&1024)for(e=e.child;e!==null;){var t=e;Uh(t),t.tag===5&&t.flags&1024&&t.stateNode.reset(),e=e.sibling}}function La(e,t){if(t.subtreeFlags&8772)for(t=t.child;t!==null;)Ah(e,t.alternate,t),t=t.sibling}function Qi(e){for(e=e.child;e!==null;){var t=e;switch(t.tag){case 0:case 11:case 14:case 15:ui(4,t,t.return),Qi(t);break;case 1:ya(t,t.return);var n=t.stateNode;typeof n.componentWillUnmount=="function"&&Th(t,t.return,n),Qi(t);break;case 27:Oo(t.stateNode);case 26:case 5:ya(t,t.return),Qi(t);break;case 22:t.memoizedState===null&&Qi(t);break;case 30:Qi(t);break;default:Qi(t)}e=e.sibling}}function Ha(e,t,n){for(n=n&&(t.subtreeFlags&8772)!==0,t=t.child;t!==null;){var a=t.alternate,l=e,d=t,v=d.flags;switch(d.tag){case 0:case 11:case 15:Ha(l,d,n),Co(4,d);break;case 1:if(Ha(l,d,n),a=d,l=a.stateNode,typeof l.componentDidMount=="function")try{l.componentDidMount()}catch(te){un(a,a.return,te)}if(a=d,l=a.updateQueue,l!==null){var j=a.stateNode;try{var B=l.shared.hiddenCallbacks;if(B!==null)for(l.shared.hiddenCallbacks=null,l=0;l<B.length;l++)pd(B[l],j)}catch(te){un(a,a.return,te)}}n&&v&64&&wh(d),Eo(d,d.return);break;case 27:jh(d);case 26:case 5:Ha(l,d,n),n&&a===null&&v&4&&kh(d),Eo(d,d.return);break;case 12:Ha(l,d,n);break;case 31:Ha(l,d,n),n&&v&4&&Dh(l,d);break;case 13:Ha(l,d,n),n&&v&4&&zh(l,d);break;case 22:d.memoizedState===null&&Ha(l,d,n),Eo(d,d.return);break;case 30:break;default:Ha(l,d,n)}t=t.sibling}}function Ru(e,t){var n=null;e!==null&&e.memoizedState!==null&&e.memoizedState.cachePool!==null&&(n=e.memoizedState.cachePool.pool),e=null,t.memoizedState!==null&&t.memoizedState.cachePool!==null&&(e=t.memoizedState.cachePool.pool),e!==n&&(e!=null&&e.refCount++,n!=null&&co(n))}function Au(e,t){e=null,t.alternate!==null&&(e=t.alternate.memoizedState.cache),t=t.memoizedState.cache,t!==e&&(t.refCount++,e!=null&&co(e))}function oa(e,t,n,a){if(t.subtreeFlags&10256)for(t=t.child;t!==null;)Lh(e,t,n,a),t=t.sibling}function Lh(e,t,n,a){var l=t.flags;switch(t.tag){case 0:case 11:case 15:oa(e,t,n,a),l&2048&&Co(9,t);break;case 1:oa(e,t,n,a);break;case 3:oa(e,t,n,a),l&2048&&(e=null,t.alternate!==null&&(e=t.alternate.memoizedState.cache),t=t.memoizedState.cache,t!==e&&(t.refCount++,e!=null&&co(e)));break;case 12:if(l&2048){oa(e,t,n,a),e=t.stateNode;try{var d=t.memoizedProps,v=d.id,j=d.onPostCommit;typeof j=="function"&&j(v,t.alternate===null?"mount":"update",e.passiveEffectDuration,-0)}catch(B){un(t,t.return,B)}}else oa(e,t,n,a);break;case 31:oa(e,t,n,a);break;case 13:oa(e,t,n,a);break;case 23:break;case 22:d=t.stateNode,v=t.alternate,t.memoizedState!==null?d._visibility&2?oa(e,t,n,a):wo(e,t):d._visibility&2?oa(e,t,n,a):(d._visibility|=2,Rs(e,t,n,a,(t.subtreeFlags&10256)!==0||!1)),l&2048&&Ru(v,t);break;case 24:oa(e,t,n,a),l&2048&&Au(t.alternate,t);break;default:oa(e,t,n,a)}}function Rs(e,t,n,a,l){for(l=l&&((t.subtreeFlags&10256)!==0||!1),t=t.child;t!==null;){var d=e,v=t,j=n,B=a,te=v.flags;switch(v.tag){case 0:case 11:case 15:Rs(d,v,j,B,l),Co(8,v);break;case 23:break;case 22:var me=v.stateNode;v.memoizedState!==null?me._visibility&2?Rs(d,v,j,B,l):wo(d,v):(me._visibility|=2,Rs(d,v,j,B,l)),l&&te&2048&&Ru(v.alternate,v);break;case 24:Rs(d,v,j,B,l),l&&te&2048&&Au(v.alternate,v);break;default:Rs(d,v,j,B,l)}t=t.sibling}}function wo(e,t){if(t.subtreeFlags&10256)for(t=t.child;t!==null;){var n=e,a=t,l=a.flags;switch(a.tag){case 22:wo(n,a),l&2048&&Ru(a.alternate,a);break;case 24:wo(n,a),l&2048&&Au(a.alternate,a);break;default:wo(n,a)}t=t.sibling}}var To=8192;function As(e,t,n){if(e.subtreeFlags&To)for(e=e.child;e!==null;)Hh(e,t,n),e=e.sibling}function Hh(e,t,n){switch(e.tag){case 26:As(e,t,n),e.flags&To&&e.memoizedState!==null&&Qg(n,sa,e.memoizedState,e.memoizedProps);break;case 5:As(e,t,n);break;case 3:case 4:var a=sa;sa=Vl(e.stateNode.containerInfo),As(e,t,n),sa=a;break;case 22:e.memoizedState===null&&(a=e.alternate,a!==null&&a.memoizedState!==null?(a=To,To=16777216,As(e,t,n),To=a):As(e,t,n));break;default:As(e,t,n)}}function Ih(e){var t=e.alternate;if(t!==null&&(e=t.child,e!==null)){t.child=null;do t=e.sibling,e.sibling=null,e=t;while(e!==null)}}function ko(e){var t=e.deletions;if((e.flags&16)!==0){if(t!==null)for(var n=0;n<t.length;n++){var a=t[n];Wn=a,Ph(a,e)}Ih(e)}if(e.subtreeFlags&10256)for(e=e.child;e!==null;)Kh(e),e=e.sibling}function Kh(e){switch(e.tag){case 0:case 11:case 15:ko(e),e.flags&2048&&ui(9,e,e.return);break;case 3:ko(e);break;case 12:ko(e);break;case 22:var t=e.stateNode;e.memoizedState!==null&&t._visibility&2&&(e.return===null||e.return.tag!==13)?(t._visibility&=-3,Nl(e)):ko(e);break;default:ko(e)}}function Nl(e){var t=e.deletions;if((e.flags&16)!==0){if(t!==null)for(var n=0;n<t.length;n++){var a=t[n];Wn=a,Ph(a,e)}Ih(e)}for(e=e.child;e!==null;){switch(t=e,t.tag){case 0:case 11:case 15:ui(8,t,t.return),Nl(t);break;case 22:n=t.stateNode,n._visibility&2&&(n._visibility&=-3,Nl(t));break;default:Nl(t)}e=e.sibling}}function Ph(e,t){for(;Wn!==null;){var n=Wn;switch(n.tag){case 0:case 11:case 15:ui(8,n,t);break;case 23:case 22:if(n.memoizedState!==null&&n.memoizedState.cachePool!==null){var a=n.memoizedState.cachePool.pool;a!=null&&a.refCount++}break;case 24:co(n.memoizedState.cache)}if(a=n.child,a!==null)a.return=n,Wn=a;else e:for(n=e;Wn!==null;){a=Wn;var l=a.sibling,d=a.return;if(Nh(a),a===n){Wn=null;break e}if(l!==null){l.return=d,Wn=l;break e}Wn=d}}}var lg={getCacheForType:function(e){var t=ir(Pn),n=t.data.get(e);return n===void 0&&(n=e(),t.data.set(e,n)),n},cacheSignal:function(){return ir(Pn).controller.signal}},cg=typeof WeakMap=="function"?WeakMap:Map,sn=0,gn=null,$t=null,Zt=0,cn=0,Hr=null,fi=!1,Ns=!1,Nu=!1,Ia=0,Nn=0,di=0,$i=0,Ou=0,Ir=0,Os=0,Mo=null,jr=null,Du=!1,Ol=0,qh=0,Dl=1/0,zl=null,hi=null,Qn=0,pi=null,Ds=null,Ka=0,zu=0,Bu=null,Yh=null,jo=0,Uu=null;function Kr(){return(sn&2)!==0&&Zt!==0?Zt&-Zt:J.T!==null?qu():h()}function Vh(){if(Ir===0)if((Zt&536870912)===0||Wt){var e=aa;aa<<=1,(aa&3932160)===0&&(aa=262144),Ir=e}else Ir=536870912;return e=Ur.current,e!==null&&(e.flags|=32),Ir}function Rr(e,t,n){(e===gn&&(cn===2||cn===9)||e.cancelPendingCommit!==null)&&(zs(e,0),mi(e,Zt,Ir,!1)),yr(e,n),((sn&2)===0||e!==gn)&&(e===gn&&((sn&2)===0&&($i|=n),Nn===4&&mi(e,Zt,Ir,!1)),va(e))}function Gh(e,t,n){if((sn&6)!==0)throw Error(s(327));var a=!n&&(t&127)===0&&(t&e.expiredLanes)===0||rr(e,t),l=a?dg(e,t):Hu(e,t,!0),d=a;do{if(l===0){Ns&&!a&&mi(e,t,0,!1);break}else{if(n=e.current.alternate,d&&!ug(n)){l=Hu(e,t,!1),d=!1;continue}if(l===2){if(d=t,e.errorRecoveryDisabledLanes&d)var v=0;else v=e.pendingLanes&-536870913,v=v!==0?v:v&536870912?536870912:0;if(v!==0){t=v;e:{var j=e;l=Mo;var B=j.current.memoizedState.isDehydrated;if(B&&(zs(j,v).flags|=256),v=Hu(j,v,!1),v!==2){if(Nu&&!B){j.errorRecoveryDisabledLanes|=d,$i|=d,l=4;break e}d=jr,jr=l,d!==null&&(jr===null?jr=d:jr.push.apply(jr,d))}l=v}if(d=!1,l!==2)continue}}if(l===1){zs(e,0),mi(e,t,0,!0);break}e:{switch(a=e,d=l,d){case 0:case 1:throw Error(s(345));case 4:if((t&4194048)!==t)break;case 6:mi(a,t,Ir,!fi);break e;case 2:jr=null;break;case 3:case 5:break;default:throw Error(s(329))}if((t&62914560)===t&&(l=Ol+300-Dn(),10<l)){if(mi(a,t,Ir,!fi),nr(a,0,!0)!==0)break e;Ka=t,a.timeoutHandle=C0(Qh.bind(null,a,n,jr,zl,Du,t,Ir,$i,Os,fi,d,"Throttled",-0,0),l);break e}Qh(a,n,jr,zl,Du,t,Ir,$i,Os,fi,d,null,-0,0)}}break}while(!0);va(e)}function Qh(e,t,n,a,l,d,v,j,B,te,me,be,re,ce){if(e.timeoutHandle=-1,be=t.subtreeFlags,be&8192||(be&16785408)===16785408){be={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:Er},Hh(t,d,be);var ot=(d&62914560)===d?Ol-Dn():(d&4194048)===d?qh-Dn():0;if(ot=$g(be,ot),ot!==null){Ka=d,e.cancelPendingCommit=ot(t0.bind(null,e,t,d,n,a,l,v,j,B,me,be,null,re,ce)),mi(e,d,v,!te);return}}t0(e,t,d,n,a,l,v,j,B)}function ug(e){for(var t=e;;){var n=t.tag;if((n===0||n===11||n===15)&&t.flags&16384&&(n=t.updateQueue,n!==null&&(n=n.stores,n!==null)))for(var a=0;a<n.length;a++){var l=n[a],d=l.getSnapshot;l=l.value;try{if(!ur(d(),l))return!1}catch{return!1}}if(n=t.child,t.subtreeFlags&16384&&n!==null)n.return=t,t=n;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function mi(e,t,n,a){t&=~Ou,t&=~$i,e.suspendedLanes|=t,e.pingedLanes&=~t,a&&(e.warmLanes|=t),a=e.expirationTimes;for(var l=t;0<l;){var d=31-Qe(l),v=1<<d;a[d]=-1,l&=~v}n!==0&&zn(e,n,t)}function Bl(){return(sn&6)===0?(Ro(0),!1):!0}function Lu(){if($t!==null){if(cn===0)var e=$t.return;else e=$t,Ra=Hi=null,eu(e),ws=null,fo=0,e=$t;for(;e!==null;)Eh(e.alternate,e),e=e.return;$t=null}}function zs(e,t){var n=e.timeoutHandle;n!==-1&&(e.timeoutHandle=-1,Rg(n)),n=e.cancelPendingCommit,n!==null&&(e.cancelPendingCommit=null,n()),Ka=0,Lu(),gn=e,$t=n=Ma(e.current,null),Zt=t,cn=0,Hr=null,fi=!1,Ns=rr(e,t),Nu=!1,Os=Ir=Ou=$i=di=Nn=0,jr=Mo=null,Du=!1,(t&8)!==0&&(t|=t&32);var a=e.entangledLanes;if(a!==0)for(e=e.entanglements,a&=t;0<a;){var l=31-Qe(a),d=1<<l;t|=e[l],a&=~d}return Ia=t,Jn(),n}function $h(e,t){Pt=null,J.H=bo,t===Es||t===fl?(t=ud(),cn=3):t===Pc?(t=ud(),cn=4):cn=t===gu?8:t!==null&&typeof t=="object"&&typeof t.then=="function"?6:1,Hr=t,$t===null&&(Nn=1,wl(e,Xr(t,e.current)))}function Xh(){var e=Ur.current;return e===null?!0:(Zt&4194048)===Zt?Wr===null:(Zt&62914560)===Zt||(Zt&536870912)!==0?e===Wr:!1}function Fh(){var e=J.H;return J.H=bo,e===null?bo:e}function Zh(){var e=J.A;return J.A=lg,e}function Ul(){Nn=4,fi||(Zt&4194048)!==Zt&&Ur.current!==null||(Ns=!0),(di&134217727)===0&&($i&134217727)===0||gn===null||mi(gn,Zt,Ir,!1)}function Hu(e,t,n){var a=sn;sn|=2;var l=Fh(),d=Zh();(gn!==e||Zt!==t)&&(zl=null,zs(e,t)),t=!1;var v=Nn;e:do try{if(cn!==0&&$t!==null){var j=$t,B=Hr;switch(cn){case 8:Lu(),v=6;break e;case 3:case 2:case 9:case 6:Ur.current===null&&(t=!0);var te=cn;if(cn=0,Hr=null,Bs(e,j,B,te),n&&Ns){v=0;break e}break;default:te=cn,cn=0,Hr=null,Bs(e,j,B,te)}}fg(),v=Nn;break}catch(me){$h(e,me)}while(!0);return t&&e.shellSuspendCounter++,Ra=Hi=null,sn=a,J.H=l,J.A=d,$t===null&&(gn=null,Zt=0,Jn()),v}function fg(){for(;$t!==null;)Jh($t)}function dg(e,t){var n=sn;sn|=2;var a=Fh(),l=Zh();gn!==e||Zt!==t?(zl=null,Dl=Dn()+500,zs(e,t)):Ns=rr(e,t);e:do try{if(cn!==0&&$t!==null){t=$t;var d=Hr;t:switch(cn){case 1:cn=0,Hr=null,Bs(e,t,d,1);break;case 2:case 9:if(ld(d)){cn=0,Hr=null,Wh(t);break}t=function(){cn!==2&&cn!==9||gn!==e||(cn=7),va(e)},d.then(t,t);break e;case 3:cn=7;break e;case 4:cn=5;break e;case 7:ld(d)?(cn=0,Hr=null,Wh(t)):(cn=0,Hr=null,Bs(e,t,d,7));break;case 5:var v=null;switch($t.tag){case 26:v=$t.memoizedState;case 5:case 27:var j=$t;if(v?L0(v):j.stateNode.complete){cn=0,Hr=null;var B=j.sibling;if(B!==null)$t=B;else{var te=j.return;te!==null?($t=te,Ll(te)):$t=null}break t}}cn=0,Hr=null,Bs(e,t,d,5);break;case 6:cn=0,Hr=null,Bs(e,t,d,6);break;case 8:Lu(),Nn=6;break e;default:throw Error(s(462))}}hg();break}catch(me){$h(e,me)}while(!0);return Ra=Hi=null,J.H=a,J.A=l,sn=n,$t!==null?0:(gn=null,Zt=0,Jn(),Nn)}function hg(){for(;$t!==null&&!qa();)Jh($t)}function Jh(e){var t=_h(e.alternate,e,Ia);e.memoizedProps=e.pendingProps,t===null?Ll(e):$t=t}function Wh(e){var t=e,n=t.alternate;switch(t.tag){case 15:case 0:t=gh(n,t,t.pendingProps,t.type,void 0,Zt);break;case 11:t=gh(n,t,t.pendingProps,t.type.render,t.ref,Zt);break;case 5:eu(t);default:Eh(n,t),t=$t=Zf(t,Ia),t=_h(n,t,Ia)}e.memoizedProps=e.pendingProps,t===null?Ll(e):$t=t}function Bs(e,t,n,a){Ra=Hi=null,eu(t),ws=null,fo=0;var l=t.return;try{if(tg(e,l,t,n,Zt)){Nn=1,wl(e,Xr(n,e.current)),$t=null;return}}catch(d){if(l!==null)throw $t=l,d;Nn=1,wl(e,Xr(n,e.current)),$t=null;return}t.flags&32768?(Wt||a===1?e=!0:Ns||(Zt&536870912)!==0?e=!1:(fi=e=!0,(a===2||a===9||a===3||a===6)&&(a=Ur.current,a!==null&&a.tag===13&&(a.flags|=16384))),e0(t,e)):Ll(t)}function Ll(e){var t=e;do{if((t.flags&32768)!==0){e0(t,fi);return}e=t.return;var n=ag(t.alternate,t,Ia);if(n!==null){$t=n;return}if(t=t.sibling,t!==null){$t=t;return}$t=t=e}while(t!==null);Nn===0&&(Nn=5)}function e0(e,t){do{var n=ig(e.alternate,e);if(n!==null){n.flags&=32767,$t=n;return}if(n=e.return,n!==null&&(n.flags|=32768,n.subtreeFlags=0,n.deletions=null),!t&&(e=e.sibling,e!==null)){$t=e;return}$t=e=n}while(e!==null);Nn=6,$t=null}function t0(e,t,n,a,l,d,v,j,B){e.cancelPendingCommit=null;do Hl();while(Qn!==0);if((sn&6)!==0)throw Error(s(327));if(t!==null){if(t===e.current)throw Error(s(177));if(d=t.lanes|t.childLanes,d|=Kt,Mi(e,n,d,v,j,B),e===gn&&($t=gn=null,Zt=0),Ds=t,pi=e,Ka=n,zu=d,Bu=l,Yh=a,(t.subtreeFlags&10256)!==0||(t.flags&10256)!==0?(e.callbackNode=null,e.callbackPriority=0,yg(qr,function(){return s0(),null})):(e.callbackNode=null,e.callbackPriority=0),a=(t.flags&13878)!==0,(t.subtreeFlags&13878)!==0||a){a=J.T,J.T=null,l=Me.p,Me.p=2,v=sn,sn|=4;try{sg(e,t,n)}finally{sn=v,Me.p=l,J.T=a}}Qn=1,n0(),r0(),a0()}}function n0(){if(Qn===1){Qn=0;var e=pi,t=Ds,n=(t.flags&13878)!==0;if((t.subtreeFlags&13878)!==0||n){n=J.T,J.T=null;var a=Me.p;Me.p=2;var l=sn;sn|=4;try{Bh(t,e);var d=Zu,v=C(e.containerInfo),j=d.focusedElem,B=d.selectionRange;if(v!==j&&j&&j.ownerDocument&&g(j.ownerDocument.documentElement,j)){if(B!==null&&T(j)){var te=B.start,me=B.end;if(me===void 0&&(me=te),"selectionStart"in j)j.selectionStart=te,j.selectionEnd=Math.min(me,j.value.length);else{var be=j.ownerDocument||document,re=be&&be.defaultView||window;if(re.getSelection){var ce=re.getSelection(),ot=j.textContent.length,Tt=Math.min(B.start,ot),hn=B.end===void 0?Tt:Math.min(B.end,ot);!ce.extend&&Tt>hn&&(v=hn,hn=Tt,Tt=v);var Z=p(j,Tt),P=p(j,hn);if(Z&&P&&(ce.rangeCount!==1||ce.anchorNode!==Z.node||ce.anchorOffset!==Z.offset||ce.focusNode!==P.node||ce.focusOffset!==P.offset)){var ee=be.createRange();ee.setStart(Z.node,Z.offset),ce.removeAllRanges(),Tt>hn?(ce.addRange(ee),ce.extend(P.node,P.offset)):(ee.setEnd(P.node,P.offset),ce.addRange(ee))}}}}for(be=[],ce=j;ce=ce.parentNode;)ce.nodeType===1&&be.push({element:ce,left:ce.scrollLeft,top:ce.scrollTop});for(typeof j.focus=="function"&&j.focus(),j=0;j<be.length;j++){var ve=be[j];ve.element.scrollLeft=ve.left,ve.element.scrollTop=ve.top}}Zl=!!Fu,Zu=Fu=null}finally{sn=l,Me.p=a,J.T=n}}e.current=t,Qn=2}}function r0(){if(Qn===2){Qn=0;var e=pi,t=Ds,n=(t.flags&8772)!==0;if((t.subtreeFlags&8772)!==0||n){n=J.T,J.T=null;var a=Me.p;Me.p=2;var l=sn;sn|=4;try{Ah(e,t.alternate,t)}finally{sn=l,Me.p=a,J.T=n}}Qn=3}}function a0(){if(Qn===4||Qn===3){Qn=0,na();var e=pi,t=Ds,n=Ka,a=Yh;(t.subtreeFlags&10256)!==0||(t.flags&10256)!==0?Qn=5:(Qn=0,Ds=pi=null,i0(e,e.pendingLanes));var l=e.pendingLanes;if(l===0&&(hi=null),k(n),t=t.stateNode,Mn&&typeof Mn.onCommitFiberRoot=="function")try{Mn.onCommitFiberRoot(mr,t,void 0,(t.current.flags&128)===128)}catch{}if(a!==null){t=J.T,l=Me.p,Me.p=2,J.T=null;try{for(var d=e.onRecoverableError,v=0;v<a.length;v++){var j=a[v];d(j.value,{componentStack:j.stack})}}finally{J.T=t,Me.p=l}}(Ka&3)!==0&&Hl(),va(e),l=e.pendingLanes,(n&261930)!==0&&(l&42)!==0?e===Uu?jo++:(jo=0,Uu=e):jo=0,Ro(0)}}function i0(e,t){(e.pooledCacheLanes&=t)===0&&(t=e.pooledCache,t!=null&&(e.pooledCache=null,co(t)))}function Hl(){return n0(),r0(),a0(),s0()}function s0(){if(Qn!==5)return!1;var e=pi,t=zu;zu=0;var n=k(Ka),a=J.T,l=Me.p;try{Me.p=32>n?32:n,J.T=null,n=Bu,Bu=null;var d=pi,v=Ka;if(Qn=0,Ds=pi=null,Ka=0,(sn&6)!==0)throw Error(s(331));var j=sn;if(sn|=4,Kh(d.current),Lh(d,d.current,v,n),sn=j,Ro(0,!1),Mn&&typeof Mn.onPostCommitFiberRoot=="function")try{Mn.onPostCommitFiberRoot(mr,d)}catch{}return!0}finally{Me.p=l,J.T=a,i0(e,t)}}function o0(e,t,n){t=Xr(n,t),t=mu(e.stateNode,t,2),e=oi(e,t,2),e!==null&&(yr(e,2),va(e))}function un(e,t,n){if(e.tag===3)o0(e,e,n);else for(;t!==null;){if(t.tag===3){o0(t,e,n);break}else if(t.tag===1){var a=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof a.componentDidCatch=="function"&&(hi===null||!hi.has(a))){e=Xr(n,e),n=lh(2),a=oi(t,n,2),a!==null&&(ch(n,a,t,e),yr(a,2),va(a));break}}t=t.return}}function Iu(e,t,n){var a=e.pingCache;if(a===null){a=e.pingCache=new cg;var l=new Set;a.set(t,l)}else l=a.get(t),l===void 0&&(l=new Set,a.set(t,l));l.has(n)||(Nu=!0,l.add(n),e=pg.bind(null,e,t,n),t.then(e,e))}function pg(e,t,n){var a=e.pingCache;a!==null&&a.delete(t),e.pingedLanes|=e.suspendedLanes&n,e.warmLanes&=~n,gn===e&&(Zt&n)===n&&(Nn===4||Nn===3&&(Zt&62914560)===Zt&&300>Dn()-Ol?(sn&2)===0&&zs(e,0):Ou|=n,Os===Zt&&(Os=0)),va(e)}function l0(e,t){t===0&&(t=Va()),e=En(e,t),e!==null&&(yr(e,t),va(e))}function mg(e){var t=e.memoizedState,n=0;t!==null&&(n=t.retryLane),l0(e,n)}function gg(e,t){var n=0;switch(e.tag){case 31:case 13:var a=e.stateNode,l=e.memoizedState;l!==null&&(n=l.retryLane);break;case 19:a=e.stateNode;break;case 22:a=e.stateNode._retryCache;break;default:throw Error(s(314))}a!==null&&a.delete(t),l0(e,n)}function yg(e,t){return Pr(e,t)}var Il=null,Us=null,Ku=!1,Kl=!1,Pu=!1,gi=0;function va(e){e!==Us&&e.next===null&&(Us===null?Il=Us=e:Us=Us.next=e),Kl=!0,Ku||(Ku=!0,xg())}function Ro(e,t){if(!Pu&&Kl){Pu=!0;do for(var n=!1,a=Il;a!==null;){if(e!==0){var l=a.pendingLanes;if(l===0)var d=0;else{var v=a.suspendedLanes,j=a.pingedLanes;d=(1<<31-Qe(42|e)+1)-1,d&=l&~(v&~j),d=d&201326741?d&201326741|1:d?d|2:0}d!==0&&(n=!0,d0(a,d))}else d=Zt,d=nr(a,a===gn?d:0,a.cancelPendingCommit!==null||a.timeoutHandle!==-1),(d&3)===0||rr(a,d)||(n=!0,d0(a,d));a=a.next}while(n);Pu=!1}}function vg(){c0()}function c0(){Kl=Ku=!1;var e=0;gi!==0&&jg()&&(e=gi);for(var t=Dn(),n=null,a=Il;a!==null;){var l=a.next,d=u0(a,t);d===0?(a.next=null,n===null?Il=l:n.next=l,l===null&&(Us=n)):(n=a,(e!==0||(d&3)!==0)&&(Kl=!0)),a=l}Qn!==0&&Qn!==5||Ro(e),gi!==0&&(gi=0)}function u0(e,t){for(var n=e.suspendedLanes,a=e.pingedLanes,l=e.expirationTimes,d=e.pendingLanes&-62914561;0<d;){var v=31-Qe(d),j=1<<v,B=l[v];B===-1?((j&n)===0||(j&a)!==0)&&(l[v]=fa(j,t)):B<=t&&(e.expiredLanes|=j),d&=~j}if(t=gn,n=Zt,n=nr(e,e===t?n:0,e.cancelPendingCommit!==null||e.timeoutHandle!==-1),a=e.callbackNode,n===0||e===t&&(cn===2||cn===9)||e.cancelPendingCommit!==null)return a!==null&&a!==null&&tr(a),e.callbackNode=null,e.callbackPriority=0;if((n&3)===0||rr(e,n)){if(t=n&-n,t===e.callbackPriority)return t;switch(a!==null&&tr(a),k(n)){case 2:case 8:n=_r;break;case 32:n=qr;break;case 268435456:n=Ya;break;default:n=qr}return a=f0.bind(null,e),n=Pr(n,a),e.callbackPriority=t,e.callbackNode=n,t}return a!==null&&a!==null&&tr(a),e.callbackPriority=2,e.callbackNode=null,2}function f0(e,t){if(Qn!==0&&Qn!==5)return e.callbackNode=null,e.callbackPriority=0,null;var n=e.callbackNode;if(Hl()&&e.callbackNode!==n)return null;var a=Zt;return a=nr(e,e===gn?a:0,e.cancelPendingCommit!==null||e.timeoutHandle!==-1),a===0?null:(Gh(e,a,t),u0(e,Dn()),e.callbackNode!=null&&e.callbackNode===n?f0.bind(null,e):null)}function d0(e,t){if(Hl())return null;Gh(e,t,!0)}function xg(){Ag(function(){(sn&6)!==0?Pr(pr,vg):c0()})}function qu(){if(gi===0){var e=_s;e===0&&(e=He,He<<=1,(He&261888)===0&&(He=256)),gi=e}return gi}function h0(e){return e==null||typeof e=="symbol"||typeof e=="boolean"?null:typeof e=="function"?e:ia(""+e)}function p0(e,t){var n=t.ownerDocument.createElement("input");return n.name=t.name,n.value=t.value,e.id&&n.setAttribute("form",e.id),t.parentNode.insertBefore(n,t),e=new FormData(e),n.parentNode.removeChild(n),e}function bg(e,t,n,a,l){if(t==="submit"&&n&&n.stateNode===l){var d=h0((l[fe]||null).action),v=a.submitter;v&&(t=(t=v[fe]||null)?h0(t.formAction):v.getAttribute("formAction"),t!==null&&(d=t,v=null));var j=new rs("action","action",null,a,l);e.push({event:j,listeners:[{instance:null,listener:function(){if(a.defaultPrevented){if(gi!==0){var B=v?p0(l,v):new FormData(l);cu(n,{pending:!0,data:B,method:l.method,action:d},null,B)}}else typeof d=="function"&&(j.preventDefault(),B=v?p0(l,v):new FormData(l),cu(n,{pending:!0,data:B,method:l.method,action:d},d,B))},currentTarget:l}]})}}for(var Yu=0;Yu<Ke.length;Yu++){var Vu=Ke[Yu],Sg=Vu.toLowerCase(),_g=Vu[0].toUpperCase()+Vu.slice(1);Ne(Sg,"on"+_g)}Ne(W,"onAnimationEnd"),Ne(ne,"onAnimationIteration"),Ne(he,"onAnimationStart"),Ne("dblclick","onDoubleClick"),Ne("focusin","onFocus"),Ne("focusout","onBlur"),Ne(xe,"onTransitionRun"),Ne(Be,"onTransitionStart"),Ne(Pe,"onTransitionCancel"),Ne(Ae,"onTransitionEnd"),Ze("onMouseEnter",["mouseout","mouseover"]),Ze("onMouseLeave",["mouseout","mouseover"]),Ze("onPointerEnter",["pointerout","pointerover"]),Ze("onPointerLeave",["pointerout","pointerover"]),Ie("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Ie("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Ie("onBeforeInput",["compositionend","keypress","textInput","paste"]),Ie("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Ie("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Ie("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Ao="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Cg=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Ao));function m0(e,t){t=(t&4)!==0;for(var n=0;n<e.length;n++){var a=e[n],l=a.event;a=a.listeners;e:{var d=void 0;if(t)for(var v=a.length-1;0<=v;v--){var j=a[v],B=j.instance,te=j.currentTarget;if(j=j.listener,B!==d&&l.isPropagationStopped())break e;d=j,l.currentTarget=te;try{d(l)}catch(me){rt(me)}l.currentTarget=null,d=B}else for(v=0;v<a.length;v++){if(j=a[v],B=j.instance,te=j.currentTarget,j=j.listener,B!==d&&l.isPropagationStopped())break e;d=j,l.currentTarget=te;try{d(l)}catch(me){rt(me)}l.currentTarget=null,d=B}}}}function Xt(e,t){var n=t[at];n===void 0&&(n=t[at]=new Set);var a=e+"__bubble";n.has(a)||(g0(t,e,2,!1),n.add(a))}function Gu(e,t,n){var a=0;t&&(a|=4),g0(n,e,a,t)}var Pl="_reactListening"+Math.random().toString(36).slice(2);function Qu(e){if(!e[Pl]){e[Pl]=!0,Fe.forEach(function(n){n!=="selectionchange"&&(Cg.has(n)||Gu(n,!1,e),Gu(n,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[Pl]||(t[Pl]=!0,Gu("selectionchange",!1,t))}}function g0(e,t,n,a){switch(V0(t)){case 2:var l=Zg;break;case 8:l=Jg;break;default:l=cf}n=l.bind(null,t,n,e),l=void 0,!Gs||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(l=!0),a?l!==void 0?e.addEventListener(t,n,{capture:!0,passive:l}):e.addEventListener(t,n,!0):l!==void 0?e.addEventListener(t,n,{passive:l}):e.addEventListener(t,n,!1)}function $u(e,t,n,a,l){var d=a;if((t&1)===0&&(t&2)===0&&a!==null)e:for(;;){if(a===null)return;var v=a.tag;if(v===3||v===4){var j=a.stateNode.containerInfo;if(j===l)break;if(v===4)for(v=a.return;v!==null;){var B=v.tag;if((B===3||B===4)&&v.stateNode.containerInfo===l)return;v=v.return}for(;j!==null;){if(v=Et(j),v===null)return;if(B=v.tag,B===5||B===6||B===26||B===27){a=d=v;continue e}j=j.parentNode}}a=a.return}Ga(function(){var te=d,me=ts(n),be=[];e:{var re=Ue.get(e);if(re!==void 0){var ce=rs,ot=e;switch(e){case"keypress":if(Xa(n)===0)break e;case"keydown":case"keyup":ce=us;break;case"focusin":ot="focus",ce=Fa;break;case"focusout":ot="blur",ce=Fa;break;case"beforeblur":case"afterblur":ce=Fa;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":ce=ss;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":ce=Xo;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":ce=Ws;break;case W:case ne:case he:ce=Fo;break;case Ae:ce=eo;break;case"scroll":case"scrollend":ce=as;break;case"wheel":ce=ds;break;case"copy":case"cut":case"paste":ce=Za;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":ce=Js;break;case"toggle":case"beforetoggle":ce=Wo}var Tt=(t&4)!==0,hn=!Tt&&(e==="scroll"||e==="scrollend"),Z=Tt?re!==null?re+"Capture":null:re;Tt=[];for(var P=te,ee;P!==null;){var ve=P;if(ee=ve.stateNode,ve=ve.tag,ve!==5&&ve!==26&&ve!==27||ee===null||Z===null||(ve=_a(P,Z),ve!=null&&Tt.push(No(P,ve,ee))),hn)break;P=P.return}0<Tt.length&&(re=new ce(re,ot,null,n,me),be.push({event:re,listeners:Tt}))}}if((t&7)===0){e:{if(re=e==="mouseover"||e==="pointerover",ce=e==="mouseout"||e==="pointerout",re&&n!==Gr&&(ot=n.relatedTarget||n.fromElement)&&(Et(ot)||ot[_e]))break e;if((ce||re)&&(re=me.window===me?me:(re=me.ownerDocument)?re.defaultView||re.parentWindow:window,ce?(ot=n.relatedTarget||n.toElement,ce=te,ot=ot?Et(ot):null,ot!==null&&(hn=m(ot),Tt=ot.tag,ot!==hn||Tt!==5&&Tt!==27&&Tt!==6)&&(ot=null)):(ce=null,ot=te),ce!==ot)){if(Tt=ss,ve="onMouseLeave",Z="onMouseEnter",P="mouse",(e==="pointerout"||e==="pointerover")&&(Tt=Js,ve="onPointerLeave",Z="onPointerEnter",P="pointer"),hn=ce==null?re:vt(ce),ee=ot==null?re:vt(ot),re=new Tt(ve,P+"leave",ce,n,me),re.target=hn,re.relatedTarget=ee,ve=null,Et(me)===te&&(Tt=new Tt(Z,P+"enter",ot,n,me),Tt.target=ee,Tt.relatedTarget=hn,ve=Tt),hn=ve,ce&&ot)t:{for(Tt=Eg,Z=ce,P=ot,ee=0,ve=Z;ve;ve=Tt(ve))ee++;ve=0;for(var _t=P;_t;_t=Tt(_t))ve++;for(;0<ee-ve;)Z=Tt(Z),ee--;for(;0<ve-ee;)P=Tt(P),ve--;for(;ee--;){if(Z===P||P!==null&&Z===P.alternate){Tt=Z;break t}Z=Tt(Z),P=Tt(P)}Tt=null}else Tt=null;ce!==null&&y0(be,re,ce,Tt,!1),ot!==null&&hn!==null&&y0(be,hn,ot,Tt,!0)}}e:{if(re=te?vt(te):window,ce=re.nodeName&&re.nodeName.toLowerCase(),ce==="select"||ce==="input"&&re.type==="file")var rn=zi;else if(ms(re))if($r)rn=ei;else{rn=ka;var gt=il}else ce=re.nodeName,!ce||ce.toLowerCase()!=="input"||re.type!=="checkbox"&&re.type!=="radio"?te&&Rn(te.elementType)&&(rn=zi):rn=io;if(rn&&(rn=rn(e,te))){ao(be,rn,n,me);break e}gt&&gt(e,re,te),e==="focusout"&&te&&re.type==="number"&&te.memoizedProps.value!=null&&It(re,"number",re.value)}switch(gt=te?vt(te):window,e){case"focusin":(ms(gt)||gt.contentEditable==="true")&&(z=gt,H=te,I=null);break;case"focusout":I=H=z=null;break;case"mousedown":$=!0;break;case"contextmenu":case"mouseup":case"dragend":$=!1,U(be,n,me);break;case"selectionchange":if(O)break;case"keydown":case"keyup":U(be,n,me)}var Yt;if(Oi)e:{switch(e){case"compositionstart":var Jt="onCompositionStart";break e;case"compositionend":Jt="onCompositionEnd";break e;case"compositionupdate":Jt="onCompositionUpdate";break e}Jt=void 0}else Ta?ro(e,n)&&(Jt="onCompositionEnd"):e==="keydown"&&n.keyCode===229&&(Jt="onCompositionStart");Jt&&(hs&&n.locale!=="ko"&&(Ta||Jt!=="onCompositionStart"?Jt==="onCompositionEnd"&&Ta&&(Yt=$a()):(Qr=me,ns="value"in Qr?Qr.value:Qr.textContent,Ta=!0)),gt=ql(te,Jt),0<gt.length&&(Jt=new cs(Jt,e,null,n,me),be.push({event:Jt,listeners:gt}),Yt?Jt.data=Yt:(Yt=tl(n),Yt!==null&&(Jt.data=Yt)))),(Yt=Tc?nl(e,n):kc(e,n))&&(Jt=ql(te,"onBeforeInput"),0<Jt.length&&(gt=new cs("onBeforeInput","beforeinput",null,n,me),be.push({event:gt,listeners:Jt}),gt.data=Yt)),bg(be,e,te,n,me)}m0(be,t)})}function No(e,t,n){return{instance:e,listener:t,currentTarget:n}}function ql(e,t){for(var n=t+"Capture",a=[];e!==null;){var l=e,d=l.stateNode;if(l=l.tag,l!==5&&l!==26&&l!==27||d===null||(l=_a(e,n),l!=null&&a.unshift(No(e,l,d)),l=_a(e,t),l!=null&&a.push(No(e,l,d))),e.tag===3)return a;e=e.return}return[]}function Eg(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5&&e.tag!==27);return e||null}function y0(e,t,n,a,l){for(var d=t._reactName,v=[];n!==null&&n!==a;){var j=n,B=j.alternate,te=j.stateNode;if(j=j.tag,B!==null&&B===a)break;j!==5&&j!==26&&j!==27||te===null||(B=te,l?(te=_a(n,d),te!=null&&v.unshift(No(n,te,B))):l||(te=_a(n,d),te!=null&&v.push(No(n,te,B)))),n=n.return}v.length!==0&&e.push({event:t,listeners:v})}var wg=/\r\n?/g,Tg=/\u0000|\uFFFD/g;function v0(e){return(typeof e=="string"?e:""+e).replace(wg,`
`).replace(Tg,"")}function x0(e,t){return t=v0(t),v0(e)===t}function dn(e,t,n,a,l,d){switch(n){case"children":typeof a=="string"?t==="body"||t==="textarea"&&a===""||tn(e,a):(typeof a=="number"||typeof a=="bigint")&&t!=="body"&&tn(e,""+a);break;case"className":ye(e,"class",a);break;case"tabIndex":ye(e,"tabindex",a);break;case"dir":case"role":case"viewBox":case"width":case"height":ye(e,n,a);break;case"style":vn(e,a,d);break;case"data":if(t!=="object"){ye(e,"data",a);break}case"src":case"href":if(a===""&&(t!=="a"||n!=="href")){e.removeAttribute(n);break}if(a==null||typeof a=="function"||typeof a=="symbol"||typeof a=="boolean"){e.removeAttribute(n);break}a=ia(""+a),e.setAttribute(n,a);break;case"action":case"formAction":if(typeof a=="function"){e.setAttribute(n,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof d=="function"&&(n==="formAction"?(t!=="input"&&dn(e,t,"name",l.name,l,null),dn(e,t,"formEncType",l.formEncType,l,null),dn(e,t,"formMethod",l.formMethod,l,null),dn(e,t,"formTarget",l.formTarget,l,null)):(dn(e,t,"encType",l.encType,l,null),dn(e,t,"method",l.method,l,null),dn(e,t,"target",l.target,l,null)));if(a==null||typeof a=="symbol"||typeof a=="boolean"){e.removeAttribute(n);break}a=ia(""+a),e.setAttribute(n,a);break;case"onClick":a!=null&&(e.onclick=Er);break;case"onScroll":a!=null&&Xt("scroll",e);break;case"onScrollEnd":a!=null&&Xt("scrollend",e);break;case"dangerouslySetInnerHTML":if(a!=null){if(typeof a!="object"||!("__html"in a))throw Error(s(61));if(n=a.__html,n!=null){if(l.children!=null)throw Error(s(60));e.innerHTML=n}}break;case"multiple":e.multiple=a&&typeof a!="function"&&typeof a!="symbol";break;case"muted":e.muted=a&&typeof a!="function"&&typeof a!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(a==null||typeof a=="function"||typeof a=="boolean"||typeof a=="symbol"){e.removeAttribute("xlink:href");break}n=ia(""+a),e.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",n);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":a!=null&&typeof a!="function"&&typeof a!="symbol"?e.setAttribute(n,""+a):e.removeAttribute(n);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":a&&typeof a!="function"&&typeof a!="symbol"?e.setAttribute(n,""):e.removeAttribute(n);break;case"capture":case"download":a===!0?e.setAttribute(n,""):a!==!1&&a!=null&&typeof a!="function"&&typeof a!="symbol"?e.setAttribute(n,a):e.removeAttribute(n);break;case"cols":case"rows":case"size":case"span":a!=null&&typeof a!="function"&&typeof a!="symbol"&&!isNaN(a)&&1<=a?e.setAttribute(n,a):e.removeAttribute(n);break;case"rowSpan":case"start":a==null||typeof a=="function"||typeof a=="symbol"||isNaN(a)?e.removeAttribute(n):e.setAttribute(n,a);break;case"popover":Xt("beforetoggle",e),Xt("toggle",e),le(e,"popover",a);break;case"xlinkActuate":ge(e,"http://www.w3.org/1999/xlink","xlink:actuate",a);break;case"xlinkArcrole":ge(e,"http://www.w3.org/1999/xlink","xlink:arcrole",a);break;case"xlinkRole":ge(e,"http://www.w3.org/1999/xlink","xlink:role",a);break;case"xlinkShow":ge(e,"http://www.w3.org/1999/xlink","xlink:show",a);break;case"xlinkTitle":ge(e,"http://www.w3.org/1999/xlink","xlink:title",a);break;case"xlinkType":ge(e,"http://www.w3.org/1999/xlink","xlink:type",a);break;case"xmlBase":ge(e,"http://www.w3.org/XML/1998/namespace","xml:base",a);break;case"xmlLang":ge(e,"http://www.w3.org/XML/1998/namespace","xml:lang",a);break;case"xmlSpace":ge(e,"http://www.w3.org/XML/1998/namespace","xml:space",a);break;case"is":le(e,"is",a);break;case"innerText":case"textContent":break;default:(!(2<n.length)||n[0]!=="o"&&n[0]!=="O"||n[1]!=="n"&&n[1]!=="N")&&(n=Ln.get(n)||n,le(e,n,a))}}function Xu(e,t,n,a,l,d){switch(n){case"style":vn(e,a,d);break;case"dangerouslySetInnerHTML":if(a!=null){if(typeof a!="object"||!("__html"in a))throw Error(s(61));if(n=a.__html,n!=null){if(l.children!=null)throw Error(s(60));e.innerHTML=n}}break;case"children":typeof a=="string"?tn(e,a):(typeof a=="number"||typeof a=="bigint")&&tn(e,""+a);break;case"onScroll":a!=null&&Xt("scroll",e);break;case"onScrollEnd":a!=null&&Xt("scrollend",e);break;case"onClick":a!=null&&(e.onclick=Er);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!st.hasOwnProperty(n))e:{if(n[0]==="o"&&n[1]==="n"&&(l=n.endsWith("Capture"),t=n.slice(2,l?n.length-7:void 0),d=e[fe]||null,d=d!=null?d[n]:null,typeof d=="function"&&e.removeEventListener(t,d,l),typeof a=="function")){typeof d!="function"&&d!==null&&(n in e?e[n]=null:e.hasAttribute(n)&&e.removeAttribute(n)),e.addEventListener(t,a,l);break e}n in e?e[n]=a:a===!0?e.setAttribute(n,""):le(e,n,a)}}}function or(e,t,n){switch(t){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Xt("error",e),Xt("load",e);var a=!1,l=!1,d;for(d in n)if(n.hasOwnProperty(d)){var v=n[d];if(v!=null)switch(d){case"src":a=!0;break;case"srcSet":l=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(s(137,t));default:dn(e,t,d,v,n,null)}}l&&dn(e,t,"srcSet",n.srcSet,n,null),a&&dn(e,t,"src",n.src,n,null);return;case"input":Xt("invalid",e);var j=d=v=l=null,B=null,te=null;for(a in n)if(n.hasOwnProperty(a)){var me=n[a];if(me!=null)switch(a){case"name":l=me;break;case"type":v=me;break;case"checked":B=me;break;case"defaultChecked":te=me;break;case"value":d=me;break;case"defaultValue":j=me;break;case"children":case"dangerouslySetInnerHTML":if(me!=null)throw Error(s(137,t));break;default:dn(e,t,a,me,n,null)}}Ot(e,d,j,B,te,v,l,!1);return;case"select":Xt("invalid",e),a=v=d=null;for(l in n)if(n.hasOwnProperty(l)&&(j=n[l],j!=null))switch(l){case"value":d=j;break;case"defaultValue":v=j;break;case"multiple":a=j;default:dn(e,t,l,j,n,null)}t=d,n=v,e.multiple=!!a,t!=null?zt(e,!!a,t,!1):n!=null&&zt(e,!!a,n,!0);return;case"textarea":Xt("invalid",e),d=l=a=null;for(v in n)if(n.hasOwnProperty(v)&&(j=n[v],j!=null))switch(v){case"value":a=j;break;case"defaultValue":l=j;break;case"children":d=j;break;case"dangerouslySetInnerHTML":if(j!=null)throw Error(s(91));break;default:dn(e,t,v,j,n,null)}Qt(e,a,l,d);return;case"option":for(B in n)if(n.hasOwnProperty(B)&&(a=n[B],a!=null))switch(B){case"selected":e.selected=a&&typeof a!="function"&&typeof a!="symbol";break;default:dn(e,t,B,a,n,null)}return;case"dialog":Xt("beforetoggle",e),Xt("toggle",e),Xt("cancel",e),Xt("close",e);break;case"iframe":case"object":Xt("load",e);break;case"video":case"audio":for(a=0;a<Ao.length;a++)Xt(Ao[a],e);break;case"image":Xt("error",e),Xt("load",e);break;case"details":Xt("toggle",e);break;case"embed":case"source":case"link":Xt("error",e),Xt("load",e);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(te in n)if(n.hasOwnProperty(te)&&(a=n[te],a!=null))switch(te){case"children":case"dangerouslySetInnerHTML":throw Error(s(137,t));default:dn(e,t,te,a,n,null)}return;default:if(Rn(t)){for(me in n)n.hasOwnProperty(me)&&(a=n[me],a!==void 0&&Xu(e,t,me,a,n,void 0));return}}for(j in n)n.hasOwnProperty(j)&&(a=n[j],a!=null&&dn(e,t,j,a,n,null))}function kg(e,t,n,a){switch(t){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var l=null,d=null,v=null,j=null,B=null,te=null,me=null;for(ce in n){var be=n[ce];if(n.hasOwnProperty(ce)&&be!=null)switch(ce){case"checked":break;case"value":break;case"defaultValue":B=be;default:a.hasOwnProperty(ce)||dn(e,t,ce,null,a,be)}}for(var re in a){var ce=a[re];if(be=n[re],a.hasOwnProperty(re)&&(ce!=null||be!=null))switch(re){case"type":d=ce;break;case"name":l=ce;break;case"checked":te=ce;break;case"defaultChecked":me=ce;break;case"value":v=ce;break;case"defaultValue":j=ce;break;case"children":case"dangerouslySetInnerHTML":if(ce!=null)throw Error(s(137,t));break;default:ce!==be&&dn(e,t,re,ce,a,be)}}Ut(e,v,j,B,te,me,d,l);return;case"select":ce=v=j=re=null;for(d in n)if(B=n[d],n.hasOwnProperty(d)&&B!=null)switch(d){case"value":break;case"multiple":ce=B;default:a.hasOwnProperty(d)||dn(e,t,d,null,a,B)}for(l in a)if(d=a[l],B=n[l],a.hasOwnProperty(l)&&(d!=null||B!=null))switch(l){case"value":re=d;break;case"defaultValue":j=d;break;case"multiple":v=d;default:d!==B&&dn(e,t,l,d,a,B)}t=j,n=v,a=ce,re!=null?zt(e,!!n,re,!1):!!a!=!!n&&(t!=null?zt(e,!!n,t,!0):zt(e,!!n,n?[]:"",!1));return;case"textarea":ce=re=null;for(j in n)if(l=n[j],n.hasOwnProperty(j)&&l!=null&&!a.hasOwnProperty(j))switch(j){case"value":break;case"children":break;default:dn(e,t,j,null,a,l)}for(v in a)if(l=a[v],d=n[v],a.hasOwnProperty(v)&&(l!=null||d!=null))switch(v){case"value":re=l;break;case"defaultValue":ce=l;break;case"children":break;case"dangerouslySetInnerHTML":if(l!=null)throw Error(s(91));break;default:l!==d&&dn(e,t,v,l,a,d)}mn(e,re,ce);return;case"option":for(var ot in n)if(re=n[ot],n.hasOwnProperty(ot)&&re!=null&&!a.hasOwnProperty(ot))switch(ot){case"selected":e.selected=!1;break;default:dn(e,t,ot,null,a,re)}for(B in a)if(re=a[B],ce=n[B],a.hasOwnProperty(B)&&re!==ce&&(re!=null||ce!=null))switch(B){case"selected":e.selected=re&&typeof re!="function"&&typeof re!="symbol";break;default:dn(e,t,B,re,a,ce)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Tt in n)re=n[Tt],n.hasOwnProperty(Tt)&&re!=null&&!a.hasOwnProperty(Tt)&&dn(e,t,Tt,null,a,re);for(te in a)if(re=a[te],ce=n[te],a.hasOwnProperty(te)&&re!==ce&&(re!=null||ce!=null))switch(te){case"children":case"dangerouslySetInnerHTML":if(re!=null)throw Error(s(137,t));break;default:dn(e,t,te,re,a,ce)}return;default:if(Rn(t)){for(var hn in n)re=n[hn],n.hasOwnProperty(hn)&&re!==void 0&&!a.hasOwnProperty(hn)&&Xu(e,t,hn,void 0,a,re);for(me in a)re=a[me],ce=n[me],!a.hasOwnProperty(me)||re===ce||re===void 0&&ce===void 0||Xu(e,t,me,re,a,ce);return}}for(var Z in n)re=n[Z],n.hasOwnProperty(Z)&&re!=null&&!a.hasOwnProperty(Z)&&dn(e,t,Z,null,a,re);for(be in a)re=a[be],ce=n[be],!a.hasOwnProperty(be)||re===ce||re==null&&ce==null||dn(e,t,be,re,a,ce)}function b0(e){switch(e){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function Mg(){if(typeof performance.getEntriesByType=="function"){for(var e=0,t=0,n=performance.getEntriesByType("resource"),a=0;a<n.length;a++){var l=n[a],d=l.transferSize,v=l.initiatorType,j=l.duration;if(d&&j&&b0(v)){for(v=0,j=l.responseEnd,a+=1;a<n.length;a++){var B=n[a],te=B.startTime;if(te>j)break;var me=B.transferSize,be=B.initiatorType;me&&b0(be)&&(B=B.responseEnd,v+=me*(B<j?1:(j-te)/(B-te)))}if(--a,t+=8*(d+v)/(l.duration/1e3),e++,10<e)break}}if(0<e)return t/e/1e6}return navigator.connection&&(e=navigator.connection.downlink,typeof e=="number")?e:5}var Fu=null,Zu=null;function Yl(e){return e.nodeType===9?e:e.ownerDocument}function S0(e){switch(e){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function _0(e,t){if(e===0)switch(t){case"svg":return 1;case"math":return 2;default:return 0}return e===1&&t==="foreignObject"?0:e}function Ju(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.children=="bigint"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var Wu=null;function jg(){var e=window.event;return e&&e.type==="popstate"?e===Wu?!1:(Wu=e,!0):(Wu=null,!1)}var C0=typeof setTimeout=="function"?setTimeout:void 0,Rg=typeof clearTimeout=="function"?clearTimeout:void 0,E0=typeof Promise=="function"?Promise:void 0,Ag=typeof queueMicrotask=="function"?queueMicrotask:typeof E0<"u"?function(e){return E0.resolve(null).then(e).catch(Ng)}:C0;function Ng(e){setTimeout(function(){throw e})}function yi(e){return e==="head"}function w0(e,t){var n=t,a=0;do{var l=n.nextSibling;if(e.removeChild(n),l&&l.nodeType===8)if(n=l.data,n==="/$"||n==="/&"){if(a===0){e.removeChild(l),Ks(t);return}a--}else if(n==="$"||n==="$?"||n==="$~"||n==="$!"||n==="&")a++;else if(n==="html")Oo(e.ownerDocument.documentElement);else if(n==="head"){n=e.ownerDocument.head,Oo(n);for(var d=n.firstChild;d;){var v=d.nextSibling,j=d.nodeName;d[pt]||j==="SCRIPT"||j==="STYLE"||j==="LINK"&&d.rel.toLowerCase()==="stylesheet"||n.removeChild(d),d=v}}else n==="body"&&Oo(e.ownerDocument.body);n=l}while(n);Ks(t)}function T0(e,t){var n=e;e=0;do{var a=n.nextSibling;if(n.nodeType===1?t?(n._stashedDisplay=n.style.display,n.style.display="none"):(n.style.display=n._stashedDisplay||"",n.getAttribute("style")===""&&n.removeAttribute("style")):n.nodeType===3&&(t?(n._stashedText=n.nodeValue,n.nodeValue=""):n.nodeValue=n._stashedText||""),a&&a.nodeType===8)if(n=a.data,n==="/$"){if(e===0)break;e--}else n!=="$"&&n!=="$?"&&n!=="$~"&&n!=="$!"||e++;n=a}while(n)}function ef(e){var t=e.firstChild;for(t&&t.nodeType===10&&(t=t.nextSibling);t;){var n=t;switch(t=t.nextSibling,n.nodeName){case"HTML":case"HEAD":case"BODY":ef(n),Ct(n);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(n.rel.toLowerCase()==="stylesheet")continue}e.removeChild(n)}}function Og(e,t,n,a){for(;e.nodeType===1;){var l=n;if(e.nodeName.toLowerCase()!==t.toLowerCase()){if(!a&&(e.nodeName!=="INPUT"||e.type!=="hidden"))break}else if(a){if(!e[pt])switch(t){case"meta":if(!e.hasAttribute("itemprop"))break;return e;case"link":if(d=e.getAttribute("rel"),d==="stylesheet"&&e.hasAttribute("data-precedence"))break;if(d!==l.rel||e.getAttribute("href")!==(l.href==null||l.href===""?null:l.href)||e.getAttribute("crossorigin")!==(l.crossOrigin==null?null:l.crossOrigin)||e.getAttribute("title")!==(l.title==null?null:l.title))break;return e;case"style":if(e.hasAttribute("data-precedence"))break;return e;case"script":if(d=e.getAttribute("src"),(d!==(l.src==null?null:l.src)||e.getAttribute("type")!==(l.type==null?null:l.type)||e.getAttribute("crossorigin")!==(l.crossOrigin==null?null:l.crossOrigin))&&d&&e.hasAttribute("async")&&!e.hasAttribute("itemprop"))break;return e;default:return e}}else if(t==="input"&&e.type==="hidden"){var d=l.name==null?null:""+l.name;if(l.type==="hidden"&&e.getAttribute("name")===d)return e}else return e;if(e=ea(e.nextSibling),e===null)break}return null}function Dg(e,t,n){if(t==="")return null;for(;e.nodeType!==3;)if((e.nodeType!==1||e.nodeName!=="INPUT"||e.type!=="hidden")&&!n||(e=ea(e.nextSibling),e===null))return null;return e}function k0(e,t){for(;e.nodeType!==8;)if((e.nodeType!==1||e.nodeName!=="INPUT"||e.type!=="hidden")&&!t||(e=ea(e.nextSibling),e===null))return null;return e}function tf(e){return e.data==="$?"||e.data==="$~"}function nf(e){return e.data==="$!"||e.data==="$?"&&e.ownerDocument.readyState!=="loading"}function zg(e,t){var n=e.ownerDocument;if(e.data==="$~")e._reactRetry=t;else if(e.data!=="$?"||n.readyState!=="loading")t();else{var a=function(){t(),n.removeEventListener("DOMContentLoaded",a)};n.addEventListener("DOMContentLoaded",a),e._reactRetry=a}}function ea(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?"||t==="$~"||t==="&"||t==="F!"||t==="F")break;if(t==="/$"||t==="/&")return null}}return e}var rf=null;function M0(e){e=e.nextSibling;for(var t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="/$"||n==="/&"){if(t===0)return ea(e.nextSibling);t--}else n!=="$"&&n!=="$!"&&n!=="$?"&&n!=="$~"&&n!=="&"||t++}e=e.nextSibling}return null}function j0(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="$"||n==="$!"||n==="$?"||n==="$~"||n==="&"){if(t===0)return e;t--}else n!=="/$"&&n!=="/&"||t++}e=e.previousSibling}return null}function R0(e,t,n){switch(t=Yl(n),e){case"html":if(e=t.documentElement,!e)throw Error(s(452));return e;case"head":if(e=t.head,!e)throw Error(s(453));return e;case"body":if(e=t.body,!e)throw Error(s(454));return e;default:throw Error(s(451))}}function Oo(e){for(var t=e.attributes;t.length;)e.removeAttributeNode(t[0]);Ct(e)}var ta=new Map,A0=new Set;function Vl(e){return typeof e.getRootNode=="function"?e.getRootNode():e.nodeType===9?e:e.ownerDocument}var Pa=Me.d;Me.d={f:Bg,r:Ug,D:Lg,C:Hg,L:Ig,m:Kg,X:qg,S:Pg,M:Yg};function Bg(){var e=Pa.f(),t=Bl();return e||t}function Ug(e){var t=tt(e);t!==null&&t.tag===5&&t.type==="form"?$d(t):Pa.r(e)}var Ls=typeof document>"u"?null:document;function N0(e,t,n){var a=Ls;if(a&&typeof t=="string"&&t){var l=wt(t);l='link[rel="'+e+'"][href="'+l+'"]',typeof n=="string"&&(l+='[crossorigin="'+n+'"]'),A0.has(l)||(A0.add(l),e={rel:e,crossOrigin:n,href:t},a.querySelector(l)===null&&(t=a.createElement("link"),or(t,"link",e),it(t),a.head.appendChild(t)))}}function Lg(e){Pa.D(e),N0("dns-prefetch",e,null)}function Hg(e,t){Pa.C(e,t),N0("preconnect",e,t)}function Ig(e,t,n){Pa.L(e,t,n);var a=Ls;if(a&&e&&t){var l='link[rel="preload"][as="'+wt(t)+'"]';t==="image"&&n&&n.imageSrcSet?(l+='[imagesrcset="'+wt(n.imageSrcSet)+'"]',typeof n.imageSizes=="string"&&(l+='[imagesizes="'+wt(n.imageSizes)+'"]')):l+='[href="'+wt(e)+'"]';var d=l;switch(t){case"style":d=Hs(e);break;case"script":d=Is(e)}ta.has(d)||(e=R({rel:"preload",href:t==="image"&&n&&n.imageSrcSet?void 0:e,as:t},n),ta.set(d,e),a.querySelector(l)!==null||t==="style"&&a.querySelector(Do(d))||t==="script"&&a.querySelector(zo(d))||(t=a.createElement("link"),or(t,"link",e),it(t),a.head.appendChild(t)))}}function Kg(e,t){Pa.m(e,t);var n=Ls;if(n&&e){var a=t&&typeof t.as=="string"?t.as:"script",l='link[rel="modulepreload"][as="'+wt(a)+'"][href="'+wt(e)+'"]',d=l;switch(a){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":d=Is(e)}if(!ta.has(d)&&(e=R({rel:"modulepreload",href:e},t),ta.set(d,e),n.querySelector(l)===null)){switch(a){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(n.querySelector(zo(d)))return}a=n.createElement("link"),or(a,"link",e),it(a),n.head.appendChild(a)}}}function Pg(e,t,n){Pa.S(e,t,n);var a=Ls;if(a&&e){var l=ht(a).hoistableStyles,d=Hs(e);t=t||"default";var v=l.get(d);if(!v){var j={loading:0,preload:null};if(v=a.querySelector(Do(d)))j.loading=5;else{e=R({rel:"stylesheet",href:e,"data-precedence":t},n),(n=ta.get(d))&&af(e,n);var B=v=a.createElement("link");it(B),or(B,"link",e),B._p=new Promise(function(te,me){B.onload=te,B.onerror=me}),B.addEventListener("load",function(){j.loading|=1}),B.addEventListener("error",function(){j.loading|=2}),j.loading|=4,Gl(v,t,a)}v={type:"stylesheet",instance:v,count:1,state:j},l.set(d,v)}}}function qg(e,t){Pa.X(e,t);var n=Ls;if(n&&e){var a=ht(n).hoistableScripts,l=Is(e),d=a.get(l);d||(d=n.querySelector(zo(l)),d||(e=R({src:e,async:!0},t),(t=ta.get(l))&&sf(e,t),d=n.createElement("script"),it(d),or(d,"link",e),n.head.appendChild(d)),d={type:"script",instance:d,count:1,state:null},a.set(l,d))}}function Yg(e,t){Pa.M(e,t);var n=Ls;if(n&&e){var a=ht(n).hoistableScripts,l=Is(e),d=a.get(l);d||(d=n.querySelector(zo(l)),d||(e=R({src:e,async:!0,type:"module"},t),(t=ta.get(l))&&sf(e,t),d=n.createElement("script"),it(d),or(d,"link",e),n.head.appendChild(d)),d={type:"script",instance:d,count:1,state:null},a.set(l,d))}}function O0(e,t,n,a){var l=(l=Ee.current)?Vl(l):null;if(!l)throw Error(s(446));switch(e){case"meta":case"title":return null;case"style":return typeof n.precedence=="string"&&typeof n.href=="string"?(t=Hs(n.href),n=ht(l).hoistableStyles,a=n.get(t),a||(a={type:"style",instance:null,count:0,state:null},n.set(t,a)),a):{type:"void",instance:null,count:0,state:null};case"link":if(n.rel==="stylesheet"&&typeof n.href=="string"&&typeof n.precedence=="string"){e=Hs(n.href);var d=ht(l).hoistableStyles,v=d.get(e);if(v||(l=l.ownerDocument||l,v={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},d.set(e,v),(d=l.querySelector(Do(e)))&&!d._p&&(v.instance=d,v.state.loading=5),ta.has(e)||(n={rel:"preload",as:"style",href:n.href,crossOrigin:n.crossOrigin,integrity:n.integrity,media:n.media,hrefLang:n.hrefLang,referrerPolicy:n.referrerPolicy},ta.set(e,n),d||Vg(l,e,n,v.state))),t&&a===null)throw Error(s(528,""));return v}if(t&&a!==null)throw Error(s(529,""));return null;case"script":return t=n.async,n=n.src,typeof n=="string"&&t&&typeof t!="function"&&typeof t!="symbol"?(t=Is(n),n=ht(l).hoistableScripts,a=n.get(t),a||(a={type:"script",instance:null,count:0,state:null},n.set(t,a)),a):{type:"void",instance:null,count:0,state:null};default:throw Error(s(444,e))}}function Hs(e){return'href="'+wt(e)+'"'}function Do(e){return'link[rel="stylesheet"]['+e+"]"}function D0(e){return R({},e,{"data-precedence":e.precedence,precedence:null})}function Vg(e,t,n,a){e.querySelector('link[rel="preload"][as="style"]['+t+"]")?a.loading=1:(t=e.createElement("link"),a.preload=t,t.addEventListener("load",function(){return a.loading|=1}),t.addEventListener("error",function(){return a.loading|=2}),or(t,"link",n),it(t),e.head.appendChild(t))}function Is(e){return'[src="'+wt(e)+'"]'}function zo(e){return"script[async]"+e}function z0(e,t,n){if(t.count++,t.instance===null)switch(t.type){case"style":var a=e.querySelector('style[data-href~="'+wt(n.href)+'"]');if(a)return t.instance=a,it(a),a;var l=R({},n,{"data-href":n.href,"data-precedence":n.precedence,href:null,precedence:null});return a=(e.ownerDocument||e).createElement("style"),it(a),or(a,"style",l),Gl(a,n.precedence,e),t.instance=a;case"stylesheet":l=Hs(n.href);var d=e.querySelector(Do(l));if(d)return t.state.loading|=4,t.instance=d,it(d),d;a=D0(n),(l=ta.get(l))&&af(a,l),d=(e.ownerDocument||e).createElement("link"),it(d);var v=d;return v._p=new Promise(function(j,B){v.onload=j,v.onerror=B}),or(d,"link",a),t.state.loading|=4,Gl(d,n.precedence,e),t.instance=d;case"script":return d=Is(n.src),(l=e.querySelector(zo(d)))?(t.instance=l,it(l),l):(a=n,(l=ta.get(d))&&(a=R({},n),sf(a,l)),e=e.ownerDocument||e,l=e.createElement("script"),it(l),or(l,"link",a),e.head.appendChild(l),t.instance=l);case"void":return null;default:throw Error(s(443,t.type))}else t.type==="stylesheet"&&(t.state.loading&4)===0&&(a=t.instance,t.state.loading|=4,Gl(a,n.precedence,e));return t.instance}function Gl(e,t,n){for(var a=n.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),l=a.length?a[a.length-1]:null,d=l,v=0;v<a.length;v++){var j=a[v];if(j.dataset.precedence===t)d=j;else if(d!==l)break}d?d.parentNode.insertBefore(e,d.nextSibling):(t=n.nodeType===9?n.head:n,t.insertBefore(e,t.firstChild))}function af(e,t){e.crossOrigin==null&&(e.crossOrigin=t.crossOrigin),e.referrerPolicy==null&&(e.referrerPolicy=t.referrerPolicy),e.title==null&&(e.title=t.title)}function sf(e,t){e.crossOrigin==null&&(e.crossOrigin=t.crossOrigin),e.referrerPolicy==null&&(e.referrerPolicy=t.referrerPolicy),e.integrity==null&&(e.integrity=t.integrity)}var Ql=null;function B0(e,t,n){if(Ql===null){var a=new Map,l=Ql=new Map;l.set(n,a)}else l=Ql,a=l.get(n),a||(a=new Map,l.set(n,a));if(a.has(e))return a;for(a.set(e,null),n=n.getElementsByTagName(e),l=0;l<n.length;l++){var d=n[l];if(!(d[pt]||d[G]||e==="link"&&d.getAttribute("rel")==="stylesheet")&&d.namespaceURI!=="http://www.w3.org/2000/svg"){var v=d.getAttribute(t)||"";v=e+v;var j=a.get(v);j?j.push(d):a.set(v,[d])}}return a}function U0(e,t,n){e=e.ownerDocument||e,e.head.insertBefore(n,t==="title"?e.querySelector("head > title"):null)}function Gg(e,t,n){if(n===1||t.itemProp!=null)return!1;switch(e){case"meta":case"title":return!0;case"style":if(typeof t.precedence!="string"||typeof t.href!="string"||t.href==="")break;return!0;case"link":if(typeof t.rel!="string"||typeof t.href!="string"||t.href===""||t.onLoad||t.onError)break;switch(t.rel){case"stylesheet":return e=t.disabled,typeof t.precedence=="string"&&e==null;default:return!0}case"script":if(t.async&&typeof t.async!="function"&&typeof t.async!="symbol"&&!t.onLoad&&!t.onError&&t.src&&typeof t.src=="string")return!0}return!1}function L0(e){return!(e.type==="stylesheet"&&(e.state.loading&3)===0)}function Qg(e,t,n,a){if(n.type==="stylesheet"&&(typeof a.media!="string"||matchMedia(a.media).matches!==!1)&&(n.state.loading&4)===0){if(n.instance===null){var l=Hs(a.href),d=t.querySelector(Do(l));if(d){t=d._p,t!==null&&typeof t=="object"&&typeof t.then=="function"&&(e.count++,e=$l.bind(e),t.then(e,e)),n.state.loading|=4,n.instance=d,it(d);return}d=t.ownerDocument||t,a=D0(a),(l=ta.get(l))&&af(a,l),d=d.createElement("link"),it(d);var v=d;v._p=new Promise(function(j,B){v.onload=j,v.onerror=B}),or(d,"link",a),n.instance=d}e.stylesheets===null&&(e.stylesheets=new Map),e.stylesheets.set(n,t),(t=n.state.preload)&&(n.state.loading&3)===0&&(e.count++,n=$l.bind(e),t.addEventListener("load",n),t.addEventListener("error",n))}}var of=0;function $g(e,t){return e.stylesheets&&e.count===0&&Fl(e,e.stylesheets),0<e.count||0<e.imgCount?function(n){var a=setTimeout(function(){if(e.stylesheets&&Fl(e,e.stylesheets),e.unsuspend){var d=e.unsuspend;e.unsuspend=null,d()}},6e4+t);0<e.imgBytes&&of===0&&(of=62500*Mg());var l=setTimeout(function(){if(e.waitingForImages=!1,e.count===0&&(e.stylesheets&&Fl(e,e.stylesheets),e.unsuspend)){var d=e.unsuspend;e.unsuspend=null,d()}},(e.imgBytes>of?50:800)+t);return e.unsuspend=n,function(){e.unsuspend=null,clearTimeout(a),clearTimeout(l)}}:null}function $l(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)Fl(this,this.stylesheets);else if(this.unsuspend){var e=this.unsuspend;this.unsuspend=null,e()}}}var Xl=null;function Fl(e,t){e.stylesheets=null,e.unsuspend!==null&&(e.count++,Xl=new Map,t.forEach(Xg,e),Xl=null,$l.call(e))}function Xg(e,t){if(!(t.state.loading&4)){var n=Xl.get(e);if(n)var a=n.get(null);else{n=new Map,Xl.set(e,n);for(var l=e.querySelectorAll("link[data-precedence],style[data-precedence]"),d=0;d<l.length;d++){var v=l[d];(v.nodeName==="LINK"||v.getAttribute("media")!=="not all")&&(n.set(v.dataset.precedence,v),a=v)}a&&n.set(null,a)}l=t.instance,v=l.getAttribute("data-precedence"),d=n.get(v)||a,d===a&&n.set(null,l),n.set(v,l),this.count++,a=$l.bind(this),l.addEventListener("load",a),l.addEventListener("error",a),d?d.parentNode.insertBefore(l,d.nextSibling):(e=e.nodeType===9?e.head:e,e.insertBefore(l,e.firstChild)),t.state.loading|=4}}var Bo={$$typeof:we,Provider:null,Consumer:null,_currentValue:Ge,_currentValue2:Ge,_threadCount:0};function Fg(e,t,n,a,l,d,v,j,B){this.tag=1,this.containerInfo=e,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Cr(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Cr(0),this.hiddenUpdates=Cr(null),this.identifierPrefix=a,this.onUncaughtError=l,this.onCaughtError=d,this.onRecoverableError=v,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=B,this.incompleteTransitions=new Map}function H0(e,t,n,a,l,d,v,j,B,te,me,be){return e=new Fg(e,t,n,v,B,te,me,be,j),t=1,d===!0&&(t|=24),d=Br(3,null,null,t),e.current=d,d.stateNode=e,t=Hc(),t.refCount++,e.pooledCache=t,t.refCount++,d.memoizedState={element:a,isDehydrated:n,cache:t},qc(d),e}function I0(e){return e?(e=wr,e):wr}function K0(e,t,n,a,l,d){l=I0(l),a.context===null?a.context=l:a.pendingContext=l,a=si(t),a.payload={element:n},d=d===void 0?null:d,d!==null&&(a.callback=d),n=oi(e,a,t),n!==null&&(Rr(n,e,t),po(n,e,t))}function P0(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var n=e.retryLane;e.retryLane=n!==0&&n<t?n:t}}function lf(e,t){P0(e,t),(e=e.alternate)&&P0(e,t)}function q0(e){if(e.tag===13||e.tag===31){var t=En(e,67108864);t!==null&&Rr(t,e,67108864),lf(e,67108864)}}function Y0(e){if(e.tag===13||e.tag===31){var t=Kr();t=M(t);var n=En(e,t);n!==null&&Rr(n,e,t),lf(e,t)}}var Zl=!0;function Zg(e,t,n,a){var l=J.T;J.T=null;var d=Me.p;try{Me.p=2,cf(e,t,n,a)}finally{Me.p=d,J.T=l}}function Jg(e,t,n,a){var l=J.T;J.T=null;var d=Me.p;try{Me.p=8,cf(e,t,n,a)}finally{Me.p=d,J.T=l}}function cf(e,t,n,a){if(Zl){var l=uf(a);if(l===null)$u(e,t,a,Jl,n),G0(e,a);else if(ey(l,e,t,n,a))a.stopPropagation();else if(G0(e,a),t&4&&-1<Wg.indexOf(e)){for(;l!==null;){var d=tt(l);if(d!==null)switch(d.tag){case 3:if(d=d.stateNode,d.current.memoizedState.isDehydrated){var v=Dr(d.pendingLanes);if(v!==0){var j=d;for(j.pendingLanes|=2,j.entangledLanes|=2;v;){var B=1<<31-Qe(v);j.entanglements[1]|=B,v&=~B}va(d),(sn&6)===0&&(Dl=Dn()+500,Ro(0))}}break;case 31:case 13:j=En(d,2),j!==null&&Rr(j,d,2),Bl(),lf(d,2)}if(d=uf(a),d===null&&$u(e,t,a,Jl,n),d===l)break;l=d}l!==null&&a.stopPropagation()}else $u(e,t,a,null,n)}}function uf(e){return e=ts(e),ff(e)}var Jl=null;function ff(e){if(Jl=null,e=Et(e),e!==null){var t=m(e);if(t===null)e=null;else{var n=t.tag;if(n===13){if(e=_(t),e!==null)return e;e=null}else if(n===31){if(e=w(t),e!==null)return e;e=null}else if(n===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null)}}return Jl=e,null}function V0(e){switch(e){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(ra()){case pr:return 2;case _r:return 8;case qr:case ca:return 32;case Ya:return 268435456;default:return 32}default:return 32}}var df=!1,vi=null,xi=null,bi=null,Uo=new Map,Lo=new Map,Si=[],Wg="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function G0(e,t){switch(e){case"focusin":case"focusout":vi=null;break;case"dragenter":case"dragleave":xi=null;break;case"mouseover":case"mouseout":bi=null;break;case"pointerover":case"pointerout":Uo.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Lo.delete(t.pointerId)}}function Ho(e,t,n,a,l,d){return e===null||e.nativeEvent!==d?(e={blockedOn:t,domEventName:n,eventSystemFlags:a,nativeEvent:d,targetContainers:[l]},t!==null&&(t=tt(t),t!==null&&q0(t)),e):(e.eventSystemFlags|=a,t=e.targetContainers,l!==null&&t.indexOf(l)===-1&&t.push(l),e)}function ey(e,t,n,a,l){switch(t){case"focusin":return vi=Ho(vi,e,t,n,a,l),!0;case"dragenter":return xi=Ho(xi,e,t,n,a,l),!0;case"mouseover":return bi=Ho(bi,e,t,n,a,l),!0;case"pointerover":var d=l.pointerId;return Uo.set(d,Ho(Uo.get(d)||null,e,t,n,a,l)),!0;case"gotpointercapture":return d=l.pointerId,Lo.set(d,Ho(Lo.get(d)||null,e,t,n,a,l)),!0}return!1}function Q0(e){var t=Et(e.target);if(t!==null){var n=m(t);if(n!==null){if(t=n.tag,t===13){if(t=_(n),t!==null){e.blockedOn=t,A(e.priority,function(){Y0(n)});return}}else if(t===31){if(t=w(n),t!==null){e.blockedOn=t,A(e.priority,function(){Y0(n)});return}}else if(t===3&&n.stateNode.current.memoizedState.isDehydrated){e.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}e.blockedOn=null}function Wl(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var n=uf(e.nativeEvent);if(n===null){n=e.nativeEvent;var a=new n.constructor(n.type,n);Gr=a,n.target.dispatchEvent(a),Gr=null}else return t=tt(n),t!==null&&q0(t),e.blockedOn=n,!1;t.shift()}return!0}function $0(e,t,n){Wl(e)&&n.delete(t)}function ty(){df=!1,vi!==null&&Wl(vi)&&(vi=null),xi!==null&&Wl(xi)&&(xi=null),bi!==null&&Wl(bi)&&(bi=null),Uo.forEach($0),Lo.forEach($0)}function ec(e,t){e.blockedOn===t&&(e.blockedOn=null,df||(df=!0,u.unstable_scheduleCallback(u.unstable_NormalPriority,ty)))}var tc=null;function X0(e){tc!==e&&(tc=e,u.unstable_scheduleCallback(u.unstable_NormalPriority,function(){tc===e&&(tc=null);for(var t=0;t<e.length;t+=3){var n=e[t],a=e[t+1],l=e[t+2];if(typeof a!="function"){if(ff(a||n)===null)continue;break}var d=tt(n);d!==null&&(e.splice(t,3),t-=3,cu(d,{pending:!0,data:l,method:n.method,action:a},a,l))}}))}function Ks(e){function t(B){return ec(B,e)}vi!==null&&ec(vi,e),xi!==null&&ec(xi,e),bi!==null&&ec(bi,e),Uo.forEach(t),Lo.forEach(t);for(var n=0;n<Si.length;n++){var a=Si[n];a.blockedOn===e&&(a.blockedOn=null)}for(;0<Si.length&&(n=Si[0],n.blockedOn===null);)Q0(n),n.blockedOn===null&&Si.shift();if(n=(e.ownerDocument||e).$$reactFormReplay,n!=null)for(a=0;a<n.length;a+=3){var l=n[a],d=n[a+1],v=l[fe]||null;if(typeof d=="function")v||X0(n);else if(v){var j=null;if(d&&d.hasAttribute("formAction")){if(l=d,v=d[fe]||null)j=v.formAction;else if(ff(l)!==null)continue}else j=v.action;typeof j=="function"?n[a+1]=j:(n.splice(a,3),a-=3),X0(n)}}}function F0(){function e(d){d.canIntercept&&d.info==="react-transition"&&d.intercept({handler:function(){return new Promise(function(v){return l=v})},focusReset:"manual",scroll:"manual"})}function t(){l!==null&&(l(),l=null),a||setTimeout(n,20)}function n(){if(!a&&!navigation.transition){var d=navigation.currentEntry;d&&d.url!=null&&navigation.navigate(d.url,{state:d.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var a=!1,l=null;return navigation.addEventListener("navigate",e),navigation.addEventListener("navigatesuccess",t),navigation.addEventListener("navigateerror",t),setTimeout(n,100),function(){a=!0,navigation.removeEventListener("navigate",e),navigation.removeEventListener("navigatesuccess",t),navigation.removeEventListener("navigateerror",t),l!==null&&(l(),l=null)}}}function hf(e){this._internalRoot=e}nc.prototype.render=hf.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(s(409));var n=t.current,a=Kr();K0(n,a,e,t,null,null)},nc.prototype.unmount=hf.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;K0(e.current,2,null,e,null,null),Bl(),t[_e]=null}};function nc(e){this._internalRoot=e}nc.prototype.unstable_scheduleHydration=function(e){if(e){var t=h();e={blockedOn:null,target:e,priority:t};for(var n=0;n<Si.length&&t!==0&&t<Si[n].priority;n++);Si.splice(n,0,e),n===0&&Q0(e)}};var Z0=r.version;if(Z0!=="19.2.0")throw Error(s(527,Z0,"19.2.0"));Me.findDOMNode=function(e){var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(s(188)):(e=Object.keys(e).join(","),Error(s(268,e)));return e=S(t),e=e!==null?E(e):null,e=e===null?null:e.stateNode,e};var ny={bundleType:0,version:"19.2.0",rendererPackageName:"react-dom",currentDispatcherRef:J,reconcilerVersion:"19.2.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var rc=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!rc.isDisabled&&rc.supportsFiber)try{mr=rc.inject(ny),Mn=rc}catch{}}return Ko.createRoot=function(e,t){if(!c(e))throw Error(s(299));var n=!1,a="",l=ah,d=ih,v=sh;return t!=null&&(t.unstable_strictMode===!0&&(n=!0),t.identifierPrefix!==void 0&&(a=t.identifierPrefix),t.onUncaughtError!==void 0&&(l=t.onUncaughtError),t.onCaughtError!==void 0&&(d=t.onCaughtError),t.onRecoverableError!==void 0&&(v=t.onRecoverableError)),t=H0(e,1,!1,null,null,n,a,null,l,d,v,F0),e[_e]=t.current,Qu(e),new hf(t)},Ko.hydrateRoot=function(e,t,n){if(!c(e))throw Error(s(299));var a=!1,l="",d=ah,v=ih,j=sh,B=null;return n!=null&&(n.unstable_strictMode===!0&&(a=!0),n.identifierPrefix!==void 0&&(l=n.identifierPrefix),n.onUncaughtError!==void 0&&(d=n.onUncaughtError),n.onCaughtError!==void 0&&(v=n.onCaughtError),n.onRecoverableError!==void 0&&(j=n.onRecoverableError),n.formState!==void 0&&(B=n.formState)),t=H0(e,1,!0,t,n??null,a,l,B,d,v,j,F0),t.context=I0(null),n=t.current,a=Kr(),a=M(a),l=si(a),l.callback=null,oi(n,l,a),n=a,t.current.lanes=n,yr(t,n),va(t),e[_e]=t.current,Qu(e),new nc(t)},Ko.version="19.2.0",Ko}var op;function my(){if(op)return gf.exports;op=1;function u(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(u)}catch(r){console.error(r)}}return u(),gf.exports=py(),gf.exports}var gy=my();const yy="modulepreload",vy=function(u){return"/"+u},lp={},sc=function(r,i,s){let c=Promise.resolve();if(i&&i.length>0){let S=function(E){return Promise.all(E.map(R=>Promise.resolve(R).then(N=>({status:"fulfilled",value:N}),N=>({status:"rejected",reason:N}))))};var _=S;document.getElementsByTagName("link");const w=document.querySelector("meta[property=csp-nonce]"),x=w?.nonce||w?.getAttribute("nonce");c=S(i.map(E=>{if(E=vy(E),E in lp)return;lp[E]=!0;const R=E.endsWith(".css"),N=R?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${E}"]${N}`))return;const q=document.createElement("link");if(q.rel=R?"stylesheet":yy,R||(q.as="script"),q.crossOrigin="",q.href=E,x&&q.setAttribute("nonce",x),document.head.appendChild(q),R)return new Promise((ie,se)=>{q.addEventListener("load",ie),q.addEventListener("error",()=>se(new Error(`Unable to preload CSS for ${E}`)))})}))}function m(w){const x=new Event("vite:preloadError",{cancelable:!0});if(x.payload=w,window.dispatchEvent(x),!x.defaultPrevented)throw w}return c.then(w=>{for(const x of w||[])x.status==="rejected"&&m(x.reason);return r().catch(m)})},cp=u=>{let r;const i=new Set,s=(S,E)=>{const R=typeof S=="function"?S(r):S;if(!Object.is(R,r)){const N=r;r=E??(typeof R!="object"||R===null)?R:Object.assign({},r,R),i.forEach(q=>q(r,N))}},c=()=>r,w={setState:s,getState:c,getInitialState:()=>x,subscribe:S=>(i.add(S),()=>i.delete(S))},x=r=u(s,c,w);return w},xy=(u=>u?cp(u):cp),by=u=>u;function Sy(u,r=by){const i=jn.useSyncExternalStore(u.subscribe,jn.useCallback(()=>r(u.getState()),[u,r]),jn.useCallback(()=>r(u.getInitialState()),[u,r]));return jn.useDebugValue(i),i}const up=u=>{const r=xy(u),i=s=>Sy(r,s);return Object.assign(i,r),i},Vf=(u=>u?up(u):up);function _y(u,r){let i;try{i=u()}catch{return}return{getItem:c=>{var m;const _=x=>x===null?null:JSON.parse(x,void 0),w=(m=i.getItem(c))!=null?m:null;return w instanceof Promise?w.then(_):_(w)},setItem:(c,m)=>i.setItem(c,JSON.stringify(m,void 0)),removeItem:c=>i.removeItem(c)}}const Mf=u=>r=>{try{const i=u(r);return i instanceof Promise?i:{then(s){return Mf(s)(i)},catch(s){return this}}}catch(i){return{then(s){return this},catch(s){return Mf(s)(i)}}}},Cy=(u,r)=>(i,s,c)=>{let m={storage:_y(()=>localStorage),partialize:se=>se,version:0,merge:(se,Re)=>({...Re,...se}),...r},_=!1;const w=new Set,x=new Set;let S=m.storage;if(!S)return u((...se)=>{console.warn(`[zustand persist middleware] Unable to update item '${m.name}', the given storage is currently unavailable.`),i(...se)},s,c);const E=()=>{const se=m.partialize({...s()});return S.setItem(m.name,{state:se,version:m.version})},R=c.setState;c.setState=(se,Re)=>(R(se,Re),E());const N=u((...se)=>(i(...se),E()),s,c);c.getInitialState=()=>N;let q;const ie=()=>{var se,Re;if(!S)return;_=!1,w.forEach(ke=>{var we;return ke((we=s())!=null?we:N)});const lt=((Re=m.onRehydrateStorage)==null?void 0:Re.call(m,(se=s())!=null?se:N))||void 0;return Mf(S.getItem.bind(S))(m.name).then(ke=>{if(ke)if(typeof ke.version=="number"&&ke.version!==m.version){if(m.migrate){const we=m.migrate(ke.state,ke.version);return we instanceof Promise?we.then($e=>[!0,$e]):[!0,we]}console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return[!1,ke.state];return[!1,void 0]}).then(ke=>{var we;const[$e,Je]=ke;if(q=m.merge(Je,(we=s())!=null?we:N),i(q,!0),$e)return E()}).then(()=>{lt?.(q,void 0),q=s(),_=!0,x.forEach(ke=>ke(q))}).catch(ke=>{lt?.(void 0,ke)})};return c.persist={setOptions:se=>{m={...m,...se},se.storage&&(S=se.storage)},clearStorage:()=>{S?.removeItem(m.name)},getOptions:()=>m,rehydrate:()=>ie(),hasHydrated:()=>_,onHydrate:se=>(w.add(se),()=>{w.delete(se)}),onFinishHydration:se=>(x.add(se),()=>{x.delete(se)})},m.skipHydration||ie(),q||N},Ey=Cy,wi=Vf()(Ey(u=>({identity:null,isInitialized:!1,activeView:"setup",activeContactId:null,firebaseEnabled:!1,firebaseConfigured:!1,miniChatVisibility:"never",setIdentity:r=>u({identity:r,isInitialized:!0}),setInitialized:r=>u({isInitialized:r}),setActiveView:r=>u({activeView:r}),setActiveContact:r=>u({activeContactId:r}),setFirebaseEnabled:r=>u({firebaseEnabled:r}),setFirebaseConfigured:r=>u({firebaseConfigured:r}),setMiniChatVisibility:r=>u({miniChatVisibility:r}),clearIdentity:()=>u({identity:null,isInitialized:!1,activeView:"setup",activeContactId:null}),updateProfile:r=>u(i=>({identity:i.identity?{...i.identity,profile:r}:null}))}),{name:"chat-app-storage",partialize:u=>({identity:u.identity,isInitialized:u.isInitialized,firebaseEnabled:u.firebaseEnabled,firebaseConfigured:u.firebaseConfigured,miniChatVisibility:u.miniChatVisibility})})),ac="chat-identity";class Xi{static save(r){try{const i=JSON.stringify(r);localStorage.setItem(ac,i)}catch(i){throw console.error("Failed to save identity:",i),new Error("Failed to save identity to storage")}}static load(){try{const r=localStorage.getItem(ac);if(!r)return null;const i=JSON.parse(r),s=i.secretKey||i.privateKey;return!i.userId||!i.publicKey||!s?(console.error("Invalid identity in storage"),null):{userId:i.userId,publicKey:i.publicKey,secretKey:s,profile:i.profile??{}}}catch(r){return console.error("Failed to load identity:",r),null}}static exists(){return localStorage.getItem(ac)!==null}static delete(){localStorage.removeItem(ac)}static exportToJSON(r){return JSON.stringify(r,null,2)}static importFromJSON(r){try{const i=JSON.parse(r),s=i.secretKey||i.privateKey;if(!i.userId||!i.publicKey||!s)throw new Error("Invalid identity format");return{userId:i.userId,publicKey:i.publicKey,secretKey:s,profile:i.profile??{}}}catch(i){throw console.error("Failed to import identity:",i),new Error("Invalid identity JSON")}}}const wy={peerjs:{enabled:!0,host:"0.peerjs.com",port:443,secure:!0},gun:{enabled:!1,relays:["https://gun-manhattan.herokuapp.com/gun","https://gun-us.herokuapp.com/gun"]},webtorrent:{enabled:!1,trackers:["wss://tracker.openwebtorrent.com","wss://tracker.btorrent.xyz"]},firebase:{enabled:!1},custom:{enabled:!1,url:"",protocol:"websocket"}};class Ty{constructor(){this.encoder=new TextEncoder,this._pieces=[],this._parts=[]}append_buffer(r){this.flush(),this._parts.push(r)}append(r){this._pieces.push(r)}flush(){if(this._pieces.length>0){const r=new Uint8Array(this._pieces);this._parts.push(r),this._pieces=[]}}toArrayBuffer(){const r=[];for(const i of this._parts)r.push(i);return ky(r).buffer}}function ky(u){let r=0;for(const c of u)r+=c.byteLength;const i=new Uint8Array(r);let s=0;for(const c of u){const m=new Uint8Array(c.buffer,c.byteOffset,c.byteLength);i.set(m,s),s+=c.byteLength}return i}function Ap(u){return new My(u).unpack()}function Np(u){const r=new jy,i=r.pack(u);return i instanceof Promise?i.then(()=>r.getBuffer()):r.getBuffer()}class My{constructor(r){this.index=0,this.dataBuffer=r,this.dataView=new Uint8Array(this.dataBuffer),this.length=this.dataBuffer.byteLength}unpack(){const r=this.unpack_uint8();if(r<128)return r;if((r^224)<32)return(r^224)-32;let i;if((i=r^160)<=15)return this.unpack_raw(i);if((i=r^176)<=15)return this.unpack_string(i);if((i=r^144)<=15)return this.unpack_array(i);if((i=r^128)<=15)return this.unpack_map(i);switch(r){case 192:return null;case 193:return;case 194:return!1;case 195:return!0;case 202:return this.unpack_float();case 203:return this.unpack_double();case 204:return this.unpack_uint8();case 205:return this.unpack_uint16();case 206:return this.unpack_uint32();case 207:return this.unpack_uint64();case 208:return this.unpack_int8();case 209:return this.unpack_int16();case 210:return this.unpack_int32();case 211:return this.unpack_int64();case 212:return;case 213:return;case 214:return;case 215:return;case 216:return i=this.unpack_uint16(),this.unpack_string(i);case 217:return i=this.unpack_uint32(),this.unpack_string(i);case 218:return i=this.unpack_uint16(),this.unpack_raw(i);case 219:return i=this.unpack_uint32(),this.unpack_raw(i);case 220:return i=this.unpack_uint16(),this.unpack_array(i);case 221:return i=this.unpack_uint32(),this.unpack_array(i);case 222:return i=this.unpack_uint16(),this.unpack_map(i);case 223:return i=this.unpack_uint32(),this.unpack_map(i)}}unpack_uint8(){const r=this.dataView[this.index]&255;return this.index++,r}unpack_uint16(){const r=this.read(2),i=(r[0]&255)*256+(r[1]&255);return this.index+=2,i}unpack_uint32(){const r=this.read(4),i=((r[0]*256+r[1])*256+r[2])*256+r[3];return this.index+=4,i}unpack_uint64(){const r=this.read(8),i=((((((r[0]*256+r[1])*256+r[2])*256+r[3])*256+r[4])*256+r[5])*256+r[6])*256+r[7];return this.index+=8,i}unpack_int8(){const r=this.unpack_uint8();return r<128?r:r-256}unpack_int16(){const r=this.unpack_uint16();return r<32768?r:r-65536}unpack_int32(){const r=this.unpack_uint32();return r<2**31?r:r-2**32}unpack_int64(){const r=this.unpack_uint64();return r<2**63?r:r-2**64}unpack_raw(r){if(this.length<this.index+r)throw new Error(`BinaryPackFailure: index is out of range ${this.index} ${r} ${this.length}`);const i=this.dataBuffer.slice(this.index,this.index+r);return this.index+=r,i}unpack_string(r){const i=this.read(r);let s=0,c="",m,_;for(;s<r;)m=i[s],m<160?(_=m,s++):(m^192)<32?(_=(m&31)<<6|i[s+1]&63,s+=2):(m^224)<16?(_=(m&15)<<12|(i[s+1]&63)<<6|i[s+2]&63,s+=3):(_=(m&7)<<18|(i[s+1]&63)<<12|(i[s+2]&63)<<6|i[s+3]&63,s+=4),c+=String.fromCodePoint(_);return this.index+=r,c}unpack_array(r){const i=new Array(r);for(let s=0;s<r;s++)i[s]=this.unpack();return i}unpack_map(r){const i={};for(let s=0;s<r;s++){const c=this.unpack();i[c]=this.unpack()}return i}unpack_float(){const r=this.unpack_uint32(),i=r>>31,s=(r>>23&255)-127,c=r&8388607|8388608;return(i===0?1:-1)*c*2**(s-23)}unpack_double(){const r=this.unpack_uint32(),i=this.unpack_uint32(),s=r>>31,c=(r>>20&2047)-1023,_=(r&1048575|1048576)*2**(c-20)+i*2**(c-52);return(s===0?1:-1)*_}read(r){const i=this.index;if(i+r<=this.length)return this.dataView.subarray(i,i+r);throw new Error("BinaryPackFailure: read index out of range")}}class jy{getBuffer(){return this._bufferBuilder.toArrayBuffer()}pack(r){if(typeof r=="string")this.pack_string(r);else if(typeof r=="number")Math.floor(r)===r?this.pack_integer(r):this.pack_double(r);else if(typeof r=="boolean")r===!0?this._bufferBuilder.append(195):r===!1&&this._bufferBuilder.append(194);else if(r===void 0)this._bufferBuilder.append(192);else if(typeof r=="object")if(r===null)this._bufferBuilder.append(192);else{const i=r.constructor;if(r instanceof Array){const s=this.pack_array(r);if(s instanceof Promise)return s.then(()=>this._bufferBuilder.flush())}else if(r instanceof ArrayBuffer)this.pack_bin(new Uint8Array(r));else if("BYTES_PER_ELEMENT"in r){const s=r;this.pack_bin(new Uint8Array(s.buffer,s.byteOffset,s.byteLength))}else if(r instanceof Date)this.pack_string(r.toString());else{if(r instanceof Blob)return r.arrayBuffer().then(s=>{this.pack_bin(new Uint8Array(s)),this._bufferBuilder.flush()});if(i==Object||i.toString().startsWith("class")){const s=this.pack_object(r);if(s instanceof Promise)return s.then(()=>this._bufferBuilder.flush())}else throw new Error(`Type "${i.toString()}" not yet supported`)}}else throw new Error(`Type "${typeof r}" not yet supported`);this._bufferBuilder.flush()}pack_bin(r){const i=r.length;if(i<=15)this.pack_uint8(160+i);else if(i<=65535)this._bufferBuilder.append(218),this.pack_uint16(i);else if(i<=4294967295)this._bufferBuilder.append(219),this.pack_uint32(i);else throw new Error("Invalid length");this._bufferBuilder.append_buffer(r)}pack_string(r){const i=this._textEncoder.encode(r),s=i.length;if(s<=15)this.pack_uint8(176+s);else if(s<=65535)this._bufferBuilder.append(216),this.pack_uint16(s);else if(s<=4294967295)this._bufferBuilder.append(217),this.pack_uint32(s);else throw new Error("Invalid length");this._bufferBuilder.append_buffer(i)}pack_array(r){const i=r.length;if(i<=15)this.pack_uint8(144+i);else if(i<=65535)this._bufferBuilder.append(220),this.pack_uint16(i);else if(i<=4294967295)this._bufferBuilder.append(221),this.pack_uint32(i);else throw new Error("Invalid length");const s=c=>{if(c<i){const m=this.pack(r[c]);return m instanceof Promise?m.then(()=>s(c+1)):s(c+1)}};return s(0)}pack_integer(r){if(r>=-32&&r<=127)this._bufferBuilder.append(r&255);else if(r>=0&&r<=255)this._bufferBuilder.append(204),this.pack_uint8(r);else if(r>=-128&&r<=127)this._bufferBuilder.append(208),this.pack_int8(r);else if(r>=0&&r<=65535)this._bufferBuilder.append(205),this.pack_uint16(r);else if(r>=-32768&&r<=32767)this._bufferBuilder.append(209),this.pack_int16(r);else if(r>=0&&r<=4294967295)this._bufferBuilder.append(206),this.pack_uint32(r);else if(r>=-2147483648&&r<=2147483647)this._bufferBuilder.append(210),this.pack_int32(r);else if(r>=-9223372036854776e3&&r<=9223372036854776e3)this._bufferBuilder.append(211),this.pack_int64(r);else if(r>=0&&r<=18446744073709552e3)this._bufferBuilder.append(207),this.pack_uint64(r);else throw new Error("Invalid integer")}pack_double(r){let i=0;r<0&&(i=1,r=-r);const s=Math.floor(Math.log(r)/Math.LN2),c=r/2**s-1,m=Math.floor(c*2**52),_=2**32,w=i<<31|s+1023<<20|m/_&1048575,x=m%_;this._bufferBuilder.append(203),this.pack_int32(w),this.pack_int32(x)}pack_object(r){const i=Object.keys(r),s=i.length;if(s<=15)this.pack_uint8(128+s);else if(s<=65535)this._bufferBuilder.append(222),this.pack_uint16(s);else if(s<=4294967295)this._bufferBuilder.append(223),this.pack_uint32(s);else throw new Error("Invalid length");const c=m=>{if(m<i.length){const _=i[m];if(r.hasOwnProperty(_)){this.pack(_);const w=this.pack(r[_]);if(w instanceof Promise)return w.then(()=>c(m+1))}return c(m+1)}};return c(0)}pack_uint8(r){this._bufferBuilder.append(r)}pack_uint16(r){this._bufferBuilder.append(r>>8),this._bufferBuilder.append(r&255)}pack_uint32(r){const i=r&4294967295;this._bufferBuilder.append((i&4278190080)>>>24),this._bufferBuilder.append((i&16711680)>>>16),this._bufferBuilder.append((i&65280)>>>8),this._bufferBuilder.append(i&255)}pack_uint64(r){const i=r/4294967296,s=r%2**32;this._bufferBuilder.append((i&4278190080)>>>24),this._bufferBuilder.append((i&16711680)>>>16),this._bufferBuilder.append((i&65280)>>>8),this._bufferBuilder.append(i&255),this._bufferBuilder.append((s&4278190080)>>>24),this._bufferBuilder.append((s&16711680)>>>16),this._bufferBuilder.append((s&65280)>>>8),this._bufferBuilder.append(s&255)}pack_int8(r){this._bufferBuilder.append(r&255)}pack_int16(r){this._bufferBuilder.append((r&65280)>>8),this._bufferBuilder.append(r&255)}pack_int32(r){this._bufferBuilder.append(r>>>24&255),this._bufferBuilder.append((r&16711680)>>>16),this._bufferBuilder.append((r&65280)>>>8),this._bufferBuilder.append(r&255)}pack_int64(r){const i=Math.floor(r/4294967296),s=r%2**32;this._bufferBuilder.append((i&4278190080)>>>24),this._bufferBuilder.append((i&16711680)>>>16),this._bufferBuilder.append((i&65280)>>>8),this._bufferBuilder.append(i&255),this._bufferBuilder.append((s&4278190080)>>>24),this._bufferBuilder.append((s&16711680)>>>16),this._bufferBuilder.append((s&65280)>>>8),this._bufferBuilder.append(s&255)}constructor(){this._bufferBuilder=new Ty,this._textEncoder=new TextEncoder}}let Op=!0,Dp=!0;function qo(u,r,i){const s=u.match(r);return s&&s.length>=i&&parseFloat(s[i],10)}function Zi(u,r,i){if(!u.RTCPeerConnection)return;const s=u.RTCPeerConnection.prototype,c=s.addEventListener;s.addEventListener=function(_,w){if(_!==r)return c.apply(this,arguments);const x=S=>{const E=i(S);E&&(w.handleEvent?w.handleEvent(E):w(E))};return this._eventMap=this._eventMap||{},this._eventMap[r]||(this._eventMap[r]=new Map),this._eventMap[r].set(w,x),c.apply(this,[_,x])};const m=s.removeEventListener;s.removeEventListener=function(_,w){if(_!==r||!this._eventMap||!this._eventMap[r])return m.apply(this,arguments);if(!this._eventMap[r].has(w))return m.apply(this,arguments);const x=this._eventMap[r].get(w);return this._eventMap[r].delete(w),this._eventMap[r].size===0&&delete this._eventMap[r],Object.keys(this._eventMap).length===0&&delete this._eventMap,m.apply(this,[_,x])},Object.defineProperty(s,"on"+r,{get(){return this["_on"+r]},set(_){this["_on"+r]&&(this.removeEventListener(r,this["_on"+r]),delete this["_on"+r]),_&&this.addEventListener(r,this["_on"+r]=_)},enumerable:!0,configurable:!0})}function Ry(u){return typeof u!="boolean"?new Error("Argument type: "+typeof u+". Please use a boolean."):(Op=u,u?"adapter.js logging disabled":"adapter.js logging enabled")}function Ay(u){return typeof u!="boolean"?new Error("Argument type: "+typeof u+". Please use a boolean."):(Dp=!u,"adapter.js deprecation warnings "+(u?"disabled":"enabled"))}function zp(){if(typeof window=="object"){if(Op)return;typeof console<"u"&&typeof console.log=="function"&&console.log.apply(console,arguments)}}function Gf(u,r){Dp&&console.warn(u+" is deprecated, please use "+r+" instead.")}function Ny(u){const r={browser:null,version:null};if(typeof u>"u"||!u.navigator||!u.navigator.userAgent)return r.browser="Not a browser.",r;const{navigator:i}=u;if(i.userAgentData&&i.userAgentData.brands){const s=i.userAgentData.brands.find(c=>c.brand==="Chromium");if(s)return{browser:"chrome",version:parseInt(s.version,10)}}if(i.mozGetUserMedia)r.browser="firefox",r.version=parseInt(qo(i.userAgent,/Firefox\/(\d+)\./,1));else if(i.webkitGetUserMedia||u.isSecureContext===!1&&u.webkitRTCPeerConnection)r.browser="chrome",r.version=parseInt(qo(i.userAgent,/Chrom(e|ium)\/(\d+)\./,2));else if(u.RTCPeerConnection&&i.userAgent.match(/AppleWebKit\/(\d+)\./))r.browser="safari",r.version=parseInt(qo(i.userAgent,/AppleWebKit\/(\d+)\./,1)),r.supportsUnifiedPlan=u.RTCRtpTransceiver&&"currentDirection"in u.RTCRtpTransceiver.prototype,r._safariVersion=qo(i.userAgent,/Version\/(\d+(\.?\d+))/,1);else return r.browser="Not a supported browser.",r;return r}function fp(u){return Object.prototype.toString.call(u)==="[object Object]"}function Bp(u){return fp(u)?Object.keys(u).reduce(function(r,i){const s=fp(u[i]),c=s?Bp(u[i]):u[i],m=s&&!Object.keys(c).length;return c===void 0||m?r:Object.assign(r,{[i]:c})},{}):u}function jf(u,r,i){!r||i.has(r.id)||(i.set(r.id,r),Object.keys(r).forEach(s=>{s.endsWith("Id")?jf(u,u.get(r[s]),i):s.endsWith("Ids")&&r[s].forEach(c=>{jf(u,u.get(c),i)})}))}function dp(u,r,i){const s=i?"outbound-rtp":"inbound-rtp",c=new Map;if(r===null)return c;const m=[];return u.forEach(_=>{_.type==="track"&&_.trackIdentifier===r.id&&m.push(_)}),m.forEach(_=>{u.forEach(w=>{w.type===s&&w.trackId===_.id&&jf(u,w,c)})}),c}const hp=zp;function Up(u,r){const i=u&&u.navigator;if(!i.mediaDevices)return;const s=function(w){if(typeof w!="object"||w.mandatory||w.optional)return w;const x={};return Object.keys(w).forEach(S=>{if(S==="require"||S==="advanced"||S==="mediaSource")return;const E=typeof w[S]=="object"?w[S]:{ideal:w[S]};E.exact!==void 0&&typeof E.exact=="number"&&(E.min=E.max=E.exact);const R=function(N,q){return N?N+q.charAt(0).toUpperCase()+q.slice(1):q==="deviceId"?"sourceId":q};if(E.ideal!==void 0){x.optional=x.optional||[];let N={};typeof E.ideal=="number"?(N[R("min",S)]=E.ideal,x.optional.push(N),N={},N[R("max",S)]=E.ideal,x.optional.push(N)):(N[R("",S)]=E.ideal,x.optional.push(N))}E.exact!==void 0&&typeof E.exact!="number"?(x.mandatory=x.mandatory||{},x.mandatory[R("",S)]=E.exact):["min","max"].forEach(N=>{E[N]!==void 0&&(x.mandatory=x.mandatory||{},x.mandatory[R(N,S)]=E[N])})}),w.advanced&&(x.optional=(x.optional||[]).concat(w.advanced)),x},c=function(w,x){if(r.version>=61)return x(w);if(w=JSON.parse(JSON.stringify(w)),w&&typeof w.audio=="object"){const S=function(E,R,N){R in E&&!(N in E)&&(E[N]=E[R],delete E[R])};w=JSON.parse(JSON.stringify(w)),S(w.audio,"autoGainControl","googAutoGainControl"),S(w.audio,"noiseSuppression","googNoiseSuppression"),w.audio=s(w.audio)}if(w&&typeof w.video=="object"){let S=w.video.facingMode;S=S&&(typeof S=="object"?S:{ideal:S});const E=r.version<66;if(S&&(S.exact==="user"||S.exact==="environment"||S.ideal==="user"||S.ideal==="environment")&&!(i.mediaDevices.getSupportedConstraints&&i.mediaDevices.getSupportedConstraints().facingMode&&!E)){delete w.video.facingMode;let R;if(S.exact==="environment"||S.ideal==="environment"?R=["back","rear"]:(S.exact==="user"||S.ideal==="user")&&(R=["front"]),R)return i.mediaDevices.enumerateDevices().then(N=>{N=N.filter(ie=>ie.kind==="videoinput");let q=N.find(ie=>R.some(se=>ie.label.toLowerCase().includes(se)));return!q&&N.length&&R.includes("back")&&(q=N[N.length-1]),q&&(w.video.deviceId=S.exact?{exact:q.deviceId}:{ideal:q.deviceId}),w.video=s(w.video),hp("chrome: "+JSON.stringify(w)),x(w)})}w.video=s(w.video)}return hp("chrome: "+JSON.stringify(w)),x(w)},m=function(w){return r.version>=64?w:{name:{PermissionDeniedError:"NotAllowedError",PermissionDismissedError:"NotAllowedError",InvalidStateError:"NotAllowedError",DevicesNotFoundError:"NotFoundError",ConstraintNotSatisfiedError:"OverconstrainedError",TrackStartError:"NotReadableError",MediaDeviceFailedDueToShutdown:"NotAllowedError",MediaDeviceKillSwitchOn:"NotAllowedError",TabCaptureError:"AbortError",ScreenCaptureError:"AbortError",DeviceCaptureError:"AbortError"}[w.name]||w.name,message:w.message,constraint:w.constraint||w.constraintName,toString(){return this.name+(this.message&&": ")+this.message}}},_=function(w,x,S){c(w,E=>{i.webkitGetUserMedia(E,x,R=>{S&&S(m(R))})})};if(i.getUserMedia=_.bind(i),i.mediaDevices.getUserMedia){const w=i.mediaDevices.getUserMedia.bind(i.mediaDevices);i.mediaDevices.getUserMedia=function(x){return c(x,S=>w(S).then(E=>{if(S.audio&&!E.getAudioTracks().length||S.video&&!E.getVideoTracks().length)throw E.getTracks().forEach(R=>{R.stop()}),new DOMException("","NotFoundError");return E},E=>Promise.reject(m(E))))}}}function Lp(u){u.MediaStream=u.MediaStream||u.webkitMediaStream}function Hp(u){if(typeof u=="object"&&u.RTCPeerConnection&&!("ontrack"in u.RTCPeerConnection.prototype)){Object.defineProperty(u.RTCPeerConnection.prototype,"ontrack",{get(){return this._ontrack},set(i){this._ontrack&&this.removeEventListener("track",this._ontrack),this.addEventListener("track",this._ontrack=i)},enumerable:!0,configurable:!0});const r=u.RTCPeerConnection.prototype.setRemoteDescription;u.RTCPeerConnection.prototype.setRemoteDescription=function(){return this._ontrackpoly||(this._ontrackpoly=s=>{s.stream.addEventListener("addtrack",c=>{let m;u.RTCPeerConnection.prototype.getReceivers?m=this.getReceivers().find(w=>w.track&&w.track.id===c.track.id):m={track:c.track};const _=new Event("track");_.track=c.track,_.receiver=m,_.transceiver={receiver:m},_.streams=[s.stream],this.dispatchEvent(_)}),s.stream.getTracks().forEach(c=>{let m;u.RTCPeerConnection.prototype.getReceivers?m=this.getReceivers().find(w=>w.track&&w.track.id===c.id):m={track:c};const _=new Event("track");_.track=c,_.receiver=m,_.transceiver={receiver:m},_.streams=[s.stream],this.dispatchEvent(_)})},this.addEventListener("addstream",this._ontrackpoly)),r.apply(this,arguments)}}else Zi(u,"track",r=>(r.transceiver||Object.defineProperty(r,"transceiver",{value:{receiver:r.receiver}}),r))}function Ip(u){if(typeof u=="object"&&u.RTCPeerConnection&&!("getSenders"in u.RTCPeerConnection.prototype)&&"createDTMFSender"in u.RTCPeerConnection.prototype){const r=function(c,m){return{track:m,get dtmf(){return this._dtmf===void 0&&(m.kind==="audio"?this._dtmf=c.createDTMFSender(m):this._dtmf=null),this._dtmf},_pc:c}};if(!u.RTCPeerConnection.prototype.getSenders){u.RTCPeerConnection.prototype.getSenders=function(){return this._senders=this._senders||[],this._senders.slice()};const c=u.RTCPeerConnection.prototype.addTrack;u.RTCPeerConnection.prototype.addTrack=function(w,x){let S=c.apply(this,arguments);return S||(S=r(this,w),this._senders.push(S)),S};const m=u.RTCPeerConnection.prototype.removeTrack;u.RTCPeerConnection.prototype.removeTrack=function(w){m.apply(this,arguments);const x=this._senders.indexOf(w);x!==-1&&this._senders.splice(x,1)}}const i=u.RTCPeerConnection.prototype.addStream;u.RTCPeerConnection.prototype.addStream=function(m){this._senders=this._senders||[],i.apply(this,[m]),m.getTracks().forEach(_=>{this._senders.push(r(this,_))})};const s=u.RTCPeerConnection.prototype.removeStream;u.RTCPeerConnection.prototype.removeStream=function(m){this._senders=this._senders||[],s.apply(this,[m]),m.getTracks().forEach(_=>{const w=this._senders.find(x=>x.track===_);w&&this._senders.splice(this._senders.indexOf(w),1)})}}else if(typeof u=="object"&&u.RTCPeerConnection&&"getSenders"in u.RTCPeerConnection.prototype&&"createDTMFSender"in u.RTCPeerConnection.prototype&&u.RTCRtpSender&&!("dtmf"in u.RTCRtpSender.prototype)){const r=u.RTCPeerConnection.prototype.getSenders;u.RTCPeerConnection.prototype.getSenders=function(){const s=r.apply(this,[]);return s.forEach(c=>c._pc=this),s},Object.defineProperty(u.RTCRtpSender.prototype,"dtmf",{get(){return this._dtmf===void 0&&(this.track.kind==="audio"?this._dtmf=this._pc.createDTMFSender(this.track):this._dtmf=null),this._dtmf}})}}function Kp(u){if(!(typeof u=="object"&&u.RTCPeerConnection&&u.RTCRtpSender&&u.RTCRtpReceiver))return;if(!("getStats"in u.RTCRtpSender.prototype)){const i=u.RTCPeerConnection.prototype.getSenders;i&&(u.RTCPeerConnection.prototype.getSenders=function(){const m=i.apply(this,[]);return m.forEach(_=>_._pc=this),m});const s=u.RTCPeerConnection.prototype.addTrack;s&&(u.RTCPeerConnection.prototype.addTrack=function(){const m=s.apply(this,arguments);return m._pc=this,m}),u.RTCRtpSender.prototype.getStats=function(){const m=this;return this._pc.getStats().then(_=>dp(_,m.track,!0))}}if(!("getStats"in u.RTCRtpReceiver.prototype)){const i=u.RTCPeerConnection.prototype.getReceivers;i&&(u.RTCPeerConnection.prototype.getReceivers=function(){const c=i.apply(this,[]);return c.forEach(m=>m._pc=this),c}),Zi(u,"track",s=>(s.receiver._pc=s.srcElement,s)),u.RTCRtpReceiver.prototype.getStats=function(){const c=this;return this._pc.getStats().then(m=>dp(m,c.track,!1))}}if(!("getStats"in u.RTCRtpSender.prototype&&"getStats"in u.RTCRtpReceiver.prototype))return;const r=u.RTCPeerConnection.prototype.getStats;u.RTCPeerConnection.prototype.getStats=function(){if(arguments.length>0&&arguments[0]instanceof u.MediaStreamTrack){const s=arguments[0];let c,m,_;return this.getSenders().forEach(w=>{w.track===s&&(c?_=!0:c=w)}),this.getReceivers().forEach(w=>(w.track===s&&(m?_=!0:m=w),w.track===s)),_||c&&m?Promise.reject(new DOMException("There are more than one sender or receiver for the track.","InvalidAccessError")):c?c.getStats():m?m.getStats():Promise.reject(new DOMException("There is no sender or receiver for the track.","InvalidAccessError"))}return r.apply(this,arguments)}}function Pp(u){u.RTCPeerConnection.prototype.getLocalStreams=function(){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},Object.keys(this._shimmedLocalStreams).map(_=>this._shimmedLocalStreams[_][0])};const r=u.RTCPeerConnection.prototype.addTrack;u.RTCPeerConnection.prototype.addTrack=function(_,w){if(!w)return r.apply(this,arguments);this._shimmedLocalStreams=this._shimmedLocalStreams||{};const x=r.apply(this,arguments);return this._shimmedLocalStreams[w.id]?this._shimmedLocalStreams[w.id].indexOf(x)===-1&&this._shimmedLocalStreams[w.id].push(x):this._shimmedLocalStreams[w.id]=[w,x],x};const i=u.RTCPeerConnection.prototype.addStream;u.RTCPeerConnection.prototype.addStream=function(_){this._shimmedLocalStreams=this._shimmedLocalStreams||{},_.getTracks().forEach(S=>{if(this.getSenders().find(R=>R.track===S))throw new DOMException("Track already exists.","InvalidAccessError")});const w=this.getSenders();i.apply(this,arguments);const x=this.getSenders().filter(S=>w.indexOf(S)===-1);this._shimmedLocalStreams[_.id]=[_].concat(x)};const s=u.RTCPeerConnection.prototype.removeStream;u.RTCPeerConnection.prototype.removeStream=function(_){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},delete this._shimmedLocalStreams[_.id],s.apply(this,arguments)};const c=u.RTCPeerConnection.prototype.removeTrack;u.RTCPeerConnection.prototype.removeTrack=function(_){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},_&&Object.keys(this._shimmedLocalStreams).forEach(w=>{const x=this._shimmedLocalStreams[w].indexOf(_);x!==-1&&this._shimmedLocalStreams[w].splice(x,1),this._shimmedLocalStreams[w].length===1&&delete this._shimmedLocalStreams[w]}),c.apply(this,arguments)}}function qp(u,r){if(!u.RTCPeerConnection)return;if(u.RTCPeerConnection.prototype.addTrack&&r.version>=65)return Pp(u);const i=u.RTCPeerConnection.prototype.getLocalStreams;u.RTCPeerConnection.prototype.getLocalStreams=function(){const E=i.apply(this);return this._reverseStreams=this._reverseStreams||{},E.map(R=>this._reverseStreams[R.id])};const s=u.RTCPeerConnection.prototype.addStream;u.RTCPeerConnection.prototype.addStream=function(E){if(this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},E.getTracks().forEach(R=>{if(this.getSenders().find(q=>q.track===R))throw new DOMException("Track already exists.","InvalidAccessError")}),!this._reverseStreams[E.id]){const R=new u.MediaStream(E.getTracks());this._streams[E.id]=R,this._reverseStreams[R.id]=E,E=R}s.apply(this,[E])};const c=u.RTCPeerConnection.prototype.removeStream;u.RTCPeerConnection.prototype.removeStream=function(E){this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},c.apply(this,[this._streams[E.id]||E]),delete this._reverseStreams[this._streams[E.id]?this._streams[E.id].id:E.id],delete this._streams[E.id]},u.RTCPeerConnection.prototype.addTrack=function(E,R){if(this.signalingState==="closed")throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");const N=[].slice.call(arguments,1);if(N.length!==1||!N[0].getTracks().find(se=>se===E))throw new DOMException("The adapter.js addTrack polyfill only supports a single  stream which is associated with the specified track.","NotSupportedError");if(this.getSenders().find(se=>se.track===E))throw new DOMException("Track already exists.","InvalidAccessError");this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{};const ie=this._streams[R.id];if(ie)ie.addTrack(E),Promise.resolve().then(()=>{this.dispatchEvent(new Event("negotiationneeded"))});else{const se=new u.MediaStream([E]);this._streams[R.id]=se,this._reverseStreams[se.id]=R,this.addStream(se)}return this.getSenders().find(se=>se.track===E)};function m(S,E){let R=E.sdp;return Object.keys(S._reverseStreams||[]).forEach(N=>{const q=S._reverseStreams[N],ie=S._streams[q.id];R=R.replace(new RegExp(ie.id,"g"),q.id)}),new RTCSessionDescription({type:E.type,sdp:R})}function _(S,E){let R=E.sdp;return Object.keys(S._reverseStreams||[]).forEach(N=>{const q=S._reverseStreams[N],ie=S._streams[q.id];R=R.replace(new RegExp(q.id,"g"),ie.id)}),new RTCSessionDescription({type:E.type,sdp:R})}["createOffer","createAnswer"].forEach(function(S){const E=u.RTCPeerConnection.prototype[S],R={[S](){const N=arguments;return arguments.length&&typeof arguments[0]=="function"?E.apply(this,[ie=>{const se=m(this,ie);N[0].apply(null,[se])},ie=>{N[1]&&N[1].apply(null,ie)},arguments[2]]):E.apply(this,arguments).then(ie=>m(this,ie))}};u.RTCPeerConnection.prototype[S]=R[S]});const w=u.RTCPeerConnection.prototype.setLocalDescription;u.RTCPeerConnection.prototype.setLocalDescription=function(){return!arguments.length||!arguments[0].type?w.apply(this,arguments):(arguments[0]=_(this,arguments[0]),w.apply(this,arguments))};const x=Object.getOwnPropertyDescriptor(u.RTCPeerConnection.prototype,"localDescription");Object.defineProperty(u.RTCPeerConnection.prototype,"localDescription",{get(){const S=x.get.apply(this);return S.type===""?S:m(this,S)}}),u.RTCPeerConnection.prototype.removeTrack=function(E){if(this.signalingState==="closed")throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");if(!E._pc)throw new DOMException("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.","TypeError");if(!(E._pc===this))throw new DOMException("Sender was not created by this connection.","InvalidAccessError");this._streams=this._streams||{};let N;Object.keys(this._streams).forEach(q=>{this._streams[q].getTracks().find(se=>E.track===se)&&(N=this._streams[q])}),N&&(N.getTracks().length===1?this.removeStream(this._reverseStreams[N.id]):N.removeTrack(E.track),this.dispatchEvent(new Event("negotiationneeded")))}}function Rf(u,r){!u.RTCPeerConnection&&u.webkitRTCPeerConnection&&(u.RTCPeerConnection=u.webkitRTCPeerConnection),u.RTCPeerConnection&&r.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(i){const s=u.RTCPeerConnection.prototype[i],c={[i](){return arguments[0]=new(i==="addIceCandidate"?u.RTCIceCandidate:u.RTCSessionDescription)(arguments[0]),s.apply(this,arguments)}};u.RTCPeerConnection.prototype[i]=c[i]})}function Yp(u,r){Zi(u,"negotiationneeded",i=>{const s=i.target;if(!((r.version<72||s.getConfiguration&&s.getConfiguration().sdpSemantics==="plan-b")&&s.signalingState!=="stable"))return i})}const pp=Object.freeze(Object.defineProperty({__proto__:null,fixNegotiationNeeded:Yp,shimAddTrackRemoveTrack:qp,shimAddTrackRemoveTrackWithNative:Pp,shimGetSendersWithDtmf:Ip,shimGetUserMedia:Up,shimMediaStream:Lp,shimOnTrack:Hp,shimPeerConnection:Rf,shimSenderReceiverGetStats:Kp},Symbol.toStringTag,{value:"Module"}));function Vp(u,r){const i=u&&u.navigator,s=u&&u.MediaStreamTrack;if(i.getUserMedia=function(c,m,_){Gf("navigator.getUserMedia","navigator.mediaDevices.getUserMedia"),i.mediaDevices.getUserMedia(c).then(m,_)},!(r.version>55&&"autoGainControl"in i.mediaDevices.getSupportedConstraints())){const c=function(_,w,x){w in _&&!(x in _)&&(_[x]=_[w],delete _[w])},m=i.mediaDevices.getUserMedia.bind(i.mediaDevices);if(i.mediaDevices.getUserMedia=function(_){return typeof _=="object"&&typeof _.audio=="object"&&(_=JSON.parse(JSON.stringify(_)),c(_.audio,"autoGainControl","mozAutoGainControl"),c(_.audio,"noiseSuppression","mozNoiseSuppression")),m(_)},s&&s.prototype.getSettings){const _=s.prototype.getSettings;s.prototype.getSettings=function(){const w=_.apply(this,arguments);return c(w,"mozAutoGainControl","autoGainControl"),c(w,"mozNoiseSuppression","noiseSuppression"),w}}if(s&&s.prototype.applyConstraints){const _=s.prototype.applyConstraints;s.prototype.applyConstraints=function(w){return this.kind==="audio"&&typeof w=="object"&&(w=JSON.parse(JSON.stringify(w)),c(w,"autoGainControl","mozAutoGainControl"),c(w,"noiseSuppression","mozNoiseSuppression")),_.apply(this,[w])}}}}function Oy(u,r){u.navigator.mediaDevices&&"getDisplayMedia"in u.navigator.mediaDevices||u.navigator.mediaDevices&&(u.navigator.mediaDevices.getDisplayMedia=function(s){if(!(s&&s.video)){const c=new DOMException("getDisplayMedia without video constraints is undefined");return c.name="NotFoundError",c.code=8,Promise.reject(c)}return s.video===!0?s.video={mediaSource:r}:s.video.mediaSource=r,u.navigator.mediaDevices.getUserMedia(s)})}function Gp(u){typeof u=="object"&&u.RTCTrackEvent&&"receiver"in u.RTCTrackEvent.prototype&&!("transceiver"in u.RTCTrackEvent.prototype)&&Object.defineProperty(u.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function Af(u,r){if(typeof u!="object"||!(u.RTCPeerConnection||u.mozRTCPeerConnection))return;!u.RTCPeerConnection&&u.mozRTCPeerConnection&&(u.RTCPeerConnection=u.mozRTCPeerConnection),r.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(c){const m=u.RTCPeerConnection.prototype[c],_={[c](){return arguments[0]=new(c==="addIceCandidate"?u.RTCIceCandidate:u.RTCSessionDescription)(arguments[0]),m.apply(this,arguments)}};u.RTCPeerConnection.prototype[c]=_[c]});const i={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"},s=u.RTCPeerConnection.prototype.getStats;u.RTCPeerConnection.prototype.getStats=function(){const[m,_,w]=arguments;return s.apply(this,[m||null]).then(x=>{if(r.version<53&&!_)try{x.forEach(S=>{S.type=i[S.type]||S.type})}catch(S){if(S.name!=="TypeError")throw S;x.forEach((E,R)=>{x.set(R,Object.assign({},E,{type:i[E.type]||E.type}))})}return x}).then(_,w)}}function Qp(u){if(!(typeof u=="object"&&u.RTCPeerConnection&&u.RTCRtpSender)||u.RTCRtpSender&&"getStats"in u.RTCRtpSender.prototype)return;const r=u.RTCPeerConnection.prototype.getSenders;r&&(u.RTCPeerConnection.prototype.getSenders=function(){const c=r.apply(this,[]);return c.forEach(m=>m._pc=this),c});const i=u.RTCPeerConnection.prototype.addTrack;i&&(u.RTCPeerConnection.prototype.addTrack=function(){const c=i.apply(this,arguments);return c._pc=this,c}),u.RTCRtpSender.prototype.getStats=function(){return this.track?this._pc.getStats(this.track):Promise.resolve(new Map)}}function $p(u){if(!(typeof u=="object"&&u.RTCPeerConnection&&u.RTCRtpSender)||u.RTCRtpSender&&"getStats"in u.RTCRtpReceiver.prototype)return;const r=u.RTCPeerConnection.prototype.getReceivers;r&&(u.RTCPeerConnection.prototype.getReceivers=function(){const s=r.apply(this,[]);return s.forEach(c=>c._pc=this),s}),Zi(u,"track",i=>(i.receiver._pc=i.srcElement,i)),u.RTCRtpReceiver.prototype.getStats=function(){return this._pc.getStats(this.track)}}function Xp(u){!u.RTCPeerConnection||"removeStream"in u.RTCPeerConnection.prototype||(u.RTCPeerConnection.prototype.removeStream=function(i){Gf("removeStream","removeTrack"),this.getSenders().forEach(s=>{s.track&&i.getTracks().includes(s.track)&&this.removeTrack(s)})})}function Fp(u){u.DataChannel&&!u.RTCDataChannel&&(u.RTCDataChannel=u.DataChannel)}function Zp(u){if(!(typeof u=="object"&&u.RTCPeerConnection))return;const r=u.RTCPeerConnection.prototype.addTransceiver;r&&(u.RTCPeerConnection.prototype.addTransceiver=function(){this.setParametersPromises=[];let s=arguments[1]&&arguments[1].sendEncodings;s===void 0&&(s=[]),s=[...s];const c=s.length>0;c&&s.forEach(_=>{if("rid"in _&&!/^[a-z0-9]{0,16}$/i.test(_.rid))throw new TypeError("Invalid RID value provided.");if("scaleResolutionDownBy"in _&&!(parseFloat(_.scaleResolutionDownBy)>=1))throw new RangeError("scale_resolution_down_by must be >= 1.0");if("maxFramerate"in _&&!(parseFloat(_.maxFramerate)>=0))throw new RangeError("max_framerate must be >= 0.0")});const m=r.apply(this,arguments);if(c){const{sender:_}=m,w=_.getParameters();(!("encodings"in w)||w.encodings.length===1&&Object.keys(w.encodings[0]).length===0)&&(w.encodings=s,_.sendEncodings=s,this.setParametersPromises.push(_.setParameters(w).then(()=>{delete _.sendEncodings}).catch(()=>{delete _.sendEncodings})))}return m})}function Jp(u){if(!(typeof u=="object"&&u.RTCRtpSender))return;const r=u.RTCRtpSender.prototype.getParameters;r&&(u.RTCRtpSender.prototype.getParameters=function(){const s=r.apply(this,arguments);return"encodings"in s||(s.encodings=[].concat(this.sendEncodings||[{}])),s})}function Wp(u){if(!(typeof u=="object"&&u.RTCPeerConnection))return;const r=u.RTCPeerConnection.prototype.createOffer;u.RTCPeerConnection.prototype.createOffer=function(){return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then(()=>r.apply(this,arguments)).finally(()=>{this.setParametersPromises=[]}):r.apply(this,arguments)}}function em(u){if(!(typeof u=="object"&&u.RTCPeerConnection))return;const r=u.RTCPeerConnection.prototype.createAnswer;u.RTCPeerConnection.prototype.createAnswer=function(){return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then(()=>r.apply(this,arguments)).finally(()=>{this.setParametersPromises=[]}):r.apply(this,arguments)}}const mp=Object.freeze(Object.defineProperty({__proto__:null,shimAddTransceiver:Zp,shimCreateAnswer:em,shimCreateOffer:Wp,shimGetDisplayMedia:Oy,shimGetParameters:Jp,shimGetUserMedia:Vp,shimOnTrack:Gp,shimPeerConnection:Af,shimRTCDataChannel:Fp,shimReceiverGetStats:$p,shimRemoveStream:Xp,shimSenderGetStats:Qp},Symbol.toStringTag,{value:"Module"}));function tm(u){if(!(typeof u!="object"||!u.RTCPeerConnection)){if("getLocalStreams"in u.RTCPeerConnection.prototype||(u.RTCPeerConnection.prototype.getLocalStreams=function(){return this._localStreams||(this._localStreams=[]),this._localStreams}),!("addStream"in u.RTCPeerConnection.prototype)){const r=u.RTCPeerConnection.prototype.addTrack;u.RTCPeerConnection.prototype.addStream=function(s){this._localStreams||(this._localStreams=[]),this._localStreams.includes(s)||this._localStreams.push(s),s.getAudioTracks().forEach(c=>r.call(this,c,s)),s.getVideoTracks().forEach(c=>r.call(this,c,s))},u.RTCPeerConnection.prototype.addTrack=function(s,...c){return c&&c.forEach(m=>{this._localStreams?this._localStreams.includes(m)||this._localStreams.push(m):this._localStreams=[m]}),r.apply(this,arguments)}}"removeStream"in u.RTCPeerConnection.prototype||(u.RTCPeerConnection.prototype.removeStream=function(i){this._localStreams||(this._localStreams=[]);const s=this._localStreams.indexOf(i);if(s===-1)return;this._localStreams.splice(s,1);const c=i.getTracks();this.getSenders().forEach(m=>{c.includes(m.track)&&this.removeTrack(m)})})}}function nm(u){if(!(typeof u!="object"||!u.RTCPeerConnection)&&("getRemoteStreams"in u.RTCPeerConnection.prototype||(u.RTCPeerConnection.prototype.getRemoteStreams=function(){return this._remoteStreams?this._remoteStreams:[]}),!("onaddstream"in u.RTCPeerConnection.prototype))){Object.defineProperty(u.RTCPeerConnection.prototype,"onaddstream",{get(){return this._onaddstream},set(i){this._onaddstream&&(this.removeEventListener("addstream",this._onaddstream),this.removeEventListener("track",this._onaddstreampoly)),this.addEventListener("addstream",this._onaddstream=i),this.addEventListener("track",this._onaddstreampoly=s=>{s.streams.forEach(c=>{if(this._remoteStreams||(this._remoteStreams=[]),this._remoteStreams.includes(c))return;this._remoteStreams.push(c);const m=new Event("addstream");m.stream=c,this.dispatchEvent(m)})})}});const r=u.RTCPeerConnection.prototype.setRemoteDescription;u.RTCPeerConnection.prototype.setRemoteDescription=function(){const s=this;return this._onaddstreampoly||this.addEventListener("track",this._onaddstreampoly=function(c){c.streams.forEach(m=>{if(s._remoteStreams||(s._remoteStreams=[]),s._remoteStreams.indexOf(m)>=0)return;s._remoteStreams.push(m);const _=new Event("addstream");_.stream=m,s.dispatchEvent(_)})}),r.apply(s,arguments)}}}function rm(u){if(typeof u!="object"||!u.RTCPeerConnection)return;const r=u.RTCPeerConnection.prototype,i=r.createOffer,s=r.createAnswer,c=r.setLocalDescription,m=r.setRemoteDescription,_=r.addIceCandidate;r.createOffer=function(S,E){const R=arguments.length>=2?arguments[2]:arguments[0],N=i.apply(this,[R]);return E?(N.then(S,E),Promise.resolve()):N},r.createAnswer=function(S,E){const R=arguments.length>=2?arguments[2]:arguments[0],N=s.apply(this,[R]);return E?(N.then(S,E),Promise.resolve()):N};let w=function(x,S,E){const R=c.apply(this,[x]);return E?(R.then(S,E),Promise.resolve()):R};r.setLocalDescription=w,w=function(x,S,E){const R=m.apply(this,[x]);return E?(R.then(S,E),Promise.resolve()):R},r.setRemoteDescription=w,w=function(x,S,E){const R=_.apply(this,[x]);return E?(R.then(S,E),Promise.resolve()):R},r.addIceCandidate=w}function am(u){const r=u&&u.navigator;if(r.mediaDevices&&r.mediaDevices.getUserMedia){const i=r.mediaDevices,s=i.getUserMedia.bind(i);r.mediaDevices.getUserMedia=c=>s(im(c))}!r.getUserMedia&&r.mediaDevices&&r.mediaDevices.getUserMedia&&(r.getUserMedia=(function(s,c,m){r.mediaDevices.getUserMedia(s).then(c,m)}).bind(r))}function im(u){return u&&u.video!==void 0?Object.assign({},u,{video:Bp(u.video)}):u}function sm(u){if(!u.RTCPeerConnection)return;const r=u.RTCPeerConnection;u.RTCPeerConnection=function(s,c){if(s&&s.iceServers){const m=[];for(let _=0;_<s.iceServers.length;_++){let w=s.iceServers[_];w.urls===void 0&&w.url?(Gf("RTCIceServer.url","RTCIceServer.urls"),w=JSON.parse(JSON.stringify(w)),w.urls=w.url,delete w.url,m.push(w)):m.push(s.iceServers[_])}s.iceServers=m}return new r(s,c)},u.RTCPeerConnection.prototype=r.prototype,"generateCertificate"in r&&Object.defineProperty(u.RTCPeerConnection,"generateCertificate",{get(){return r.generateCertificate}})}function om(u){typeof u=="object"&&u.RTCTrackEvent&&"receiver"in u.RTCTrackEvent.prototype&&!("transceiver"in u.RTCTrackEvent.prototype)&&Object.defineProperty(u.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function lm(u){const r=u.RTCPeerConnection.prototype.createOffer;u.RTCPeerConnection.prototype.createOffer=function(s){if(s){typeof s.offerToReceiveAudio<"u"&&(s.offerToReceiveAudio=!!s.offerToReceiveAudio);const c=this.getTransceivers().find(_=>_.receiver.track.kind==="audio");s.offerToReceiveAudio===!1&&c?c.direction==="sendrecv"?c.setDirection?c.setDirection("sendonly"):c.direction="sendonly":c.direction==="recvonly"&&(c.setDirection?c.setDirection("inactive"):c.direction="inactive"):s.offerToReceiveAudio===!0&&!c&&this.addTransceiver("audio",{direction:"recvonly"}),typeof s.offerToReceiveVideo<"u"&&(s.offerToReceiveVideo=!!s.offerToReceiveVideo);const m=this.getTransceivers().find(_=>_.receiver.track.kind==="video");s.offerToReceiveVideo===!1&&m?m.direction==="sendrecv"?m.setDirection?m.setDirection("sendonly"):m.direction="sendonly":m.direction==="recvonly"&&(m.setDirection?m.setDirection("inactive"):m.direction="inactive"):s.offerToReceiveVideo===!0&&!m&&this.addTransceiver("video",{direction:"recvonly"})}return r.apply(this,arguments)}}function cm(u){typeof u!="object"||u.AudioContext||(u.AudioContext=u.webkitAudioContext)}const gp=Object.freeze(Object.defineProperty({__proto__:null,shimAudioContext:cm,shimCallbacksAPI:rm,shimConstraints:im,shimCreateOfferLegacy:lm,shimGetUserMedia:am,shimLocalStreamsAPI:tm,shimRTCIceServerUrls:sm,shimRemoteStreamsAPI:nm,shimTrackEventTransceiver:om},Symbol.toStringTag,{value:"Module"}));var bf={exports:{}},yp;function Dy(){return yp||(yp=1,(function(u){const r={};r.generateIdentifier=function(){return Math.random().toString(36).substring(2,12)},r.localCName=r.generateIdentifier(),r.splitLines=function(i){return i.trim().split(`
`).map(s=>s.trim())},r.splitSections=function(i){return i.split(`
m=`).map((c,m)=>(m>0?"m="+c:c).trim()+`\r
`)},r.getDescription=function(i){const s=r.splitSections(i);return s&&s[0]},r.getMediaSections=function(i){const s=r.splitSections(i);return s.shift(),s},r.matchPrefix=function(i,s){return r.splitLines(i).filter(c=>c.indexOf(s)===0)},r.parseCandidate=function(i){let s;i.indexOf("a=candidate:")===0?s=i.substring(12).split(" "):s=i.substring(10).split(" ");const c={foundation:s[0],component:{1:"rtp",2:"rtcp"}[s[1]]||s[1],protocol:s[2].toLowerCase(),priority:parseInt(s[3],10),ip:s[4],address:s[4],port:parseInt(s[5],10),type:s[7]};for(let m=8;m<s.length;m+=2)switch(s[m]){case"raddr":c.relatedAddress=s[m+1];break;case"rport":c.relatedPort=parseInt(s[m+1],10);break;case"tcptype":c.tcpType=s[m+1];break;case"ufrag":c.ufrag=s[m+1],c.usernameFragment=s[m+1];break;default:c[s[m]]===void 0&&(c[s[m]]=s[m+1]);break}return c},r.writeCandidate=function(i){const s=[];s.push(i.foundation);const c=i.component;c==="rtp"?s.push(1):c==="rtcp"?s.push(2):s.push(c),s.push(i.protocol.toUpperCase()),s.push(i.priority),s.push(i.address||i.ip),s.push(i.port);const m=i.type;return s.push("typ"),s.push(m),m!=="host"&&i.relatedAddress&&i.relatedPort&&(s.push("raddr"),s.push(i.relatedAddress),s.push("rport"),s.push(i.relatedPort)),i.tcpType&&i.protocol.toLowerCase()==="tcp"&&(s.push("tcptype"),s.push(i.tcpType)),(i.usernameFragment||i.ufrag)&&(s.push("ufrag"),s.push(i.usernameFragment||i.ufrag)),"candidate:"+s.join(" ")},r.parseIceOptions=function(i){return i.substring(14).split(" ")},r.parseRtpMap=function(i){let s=i.substring(9).split(" ");const c={payloadType:parseInt(s.shift(),10)};return s=s[0].split("/"),c.name=s[0],c.clockRate=parseInt(s[1],10),c.channels=s.length===3?parseInt(s[2],10):1,c.numChannels=c.channels,c},r.writeRtpMap=function(i){let s=i.payloadType;i.preferredPayloadType!==void 0&&(s=i.preferredPayloadType);const c=i.channels||i.numChannels||1;return"a=rtpmap:"+s+" "+i.name+"/"+i.clockRate+(c!==1?"/"+c:"")+`\r
`},r.parseExtmap=function(i){const s=i.substring(9).split(" ");return{id:parseInt(s[0],10),direction:s[0].indexOf("/")>0?s[0].split("/")[1]:"sendrecv",uri:s[1],attributes:s.slice(2).join(" ")}},r.writeExtmap=function(i){return"a=extmap:"+(i.id||i.preferredId)+(i.direction&&i.direction!=="sendrecv"?"/"+i.direction:"")+" "+i.uri+(i.attributes?" "+i.attributes:"")+`\r
`},r.parseFmtp=function(i){const s={};let c;const m=i.substring(i.indexOf(" ")+1).split(";");for(let _=0;_<m.length;_++)c=m[_].trim().split("="),s[c[0].trim()]=c[1];return s},r.writeFmtp=function(i){let s="",c=i.payloadType;if(i.preferredPayloadType!==void 0&&(c=i.preferredPayloadType),i.parameters&&Object.keys(i.parameters).length){const m=[];Object.keys(i.parameters).forEach(_=>{i.parameters[_]!==void 0?m.push(_+"="+i.parameters[_]):m.push(_)}),s+="a=fmtp:"+c+" "+m.join(";")+`\r
`}return s},r.parseRtcpFb=function(i){const s=i.substring(i.indexOf(" ")+1).split(" ");return{type:s.shift(),parameter:s.join(" ")}},r.writeRtcpFb=function(i){let s="",c=i.payloadType;return i.preferredPayloadType!==void 0&&(c=i.preferredPayloadType),i.rtcpFeedback&&i.rtcpFeedback.length&&i.rtcpFeedback.forEach(m=>{s+="a=rtcp-fb:"+c+" "+m.type+(m.parameter&&m.parameter.length?" "+m.parameter:"")+`\r
`}),s},r.parseSsrcMedia=function(i){const s=i.indexOf(" "),c={ssrc:parseInt(i.substring(7,s),10)},m=i.indexOf(":",s);return m>-1?(c.attribute=i.substring(s+1,m),c.value=i.substring(m+1)):c.attribute=i.substring(s+1),c},r.parseSsrcGroup=function(i){const s=i.substring(13).split(" ");return{semantics:s.shift(),ssrcs:s.map(c=>parseInt(c,10))}},r.getMid=function(i){const s=r.matchPrefix(i,"a=mid:")[0];if(s)return s.substring(6)},r.parseFingerprint=function(i){const s=i.substring(14).split(" ");return{algorithm:s[0].toLowerCase(),value:s[1].toUpperCase()}},r.getDtlsParameters=function(i,s){return{role:"auto",fingerprints:r.matchPrefix(i+s,"a=fingerprint:").map(r.parseFingerprint)}},r.writeDtlsParameters=function(i,s){let c="a=setup:"+s+`\r
`;return i.fingerprints.forEach(m=>{c+="a=fingerprint:"+m.algorithm+" "+m.value+`\r
`}),c},r.parseCryptoLine=function(i){const s=i.substring(9).split(" ");return{tag:parseInt(s[0],10),cryptoSuite:s[1],keyParams:s[2],sessionParams:s.slice(3)}},r.writeCryptoLine=function(i){return"a=crypto:"+i.tag+" "+i.cryptoSuite+" "+(typeof i.keyParams=="object"?r.writeCryptoKeyParams(i.keyParams):i.keyParams)+(i.sessionParams?" "+i.sessionParams.join(" "):"")+`\r
`},r.parseCryptoKeyParams=function(i){if(i.indexOf("inline:")!==0)return null;const s=i.substring(7).split("|");return{keyMethod:"inline",keySalt:s[0],lifeTime:s[1],mkiValue:s[2]?s[2].split(":")[0]:void 0,mkiLength:s[2]?s[2].split(":")[1]:void 0}},r.writeCryptoKeyParams=function(i){return i.keyMethod+":"+i.keySalt+(i.lifeTime?"|"+i.lifeTime:"")+(i.mkiValue&&i.mkiLength?"|"+i.mkiValue+":"+i.mkiLength:"")},r.getCryptoParameters=function(i,s){return r.matchPrefix(i+s,"a=crypto:").map(r.parseCryptoLine)},r.getIceParameters=function(i,s){const c=r.matchPrefix(i+s,"a=ice-ufrag:")[0],m=r.matchPrefix(i+s,"a=ice-pwd:")[0];return c&&m?{usernameFragment:c.substring(12),password:m.substring(10)}:null},r.writeIceParameters=function(i){let s="a=ice-ufrag:"+i.usernameFragment+`\r
a=ice-pwd:`+i.password+`\r
`;return i.iceLite&&(s+=`a=ice-lite\r
`),s},r.parseRtpParameters=function(i){const s={codecs:[],headerExtensions:[],fecMechanisms:[],rtcp:[]},m=r.splitLines(i)[0].split(" ");s.profile=m[2];for(let w=3;w<m.length;w++){const x=m[w],S=r.matchPrefix(i,"a=rtpmap:"+x+" ")[0];if(S){const E=r.parseRtpMap(S),R=r.matchPrefix(i,"a=fmtp:"+x+" ");switch(E.parameters=R.length?r.parseFmtp(R[0]):{},E.rtcpFeedback=r.matchPrefix(i,"a=rtcp-fb:"+x+" ").map(r.parseRtcpFb),s.codecs.push(E),E.name.toUpperCase()){case"RED":case"ULPFEC":s.fecMechanisms.push(E.name.toUpperCase());break}}}r.matchPrefix(i,"a=extmap:").forEach(w=>{s.headerExtensions.push(r.parseExtmap(w))});const _=r.matchPrefix(i,"a=rtcp-fb:* ").map(r.parseRtcpFb);return s.codecs.forEach(w=>{_.forEach(x=>{w.rtcpFeedback.find(E=>E.type===x.type&&E.parameter===x.parameter)||w.rtcpFeedback.push(x)})}),s},r.writeRtpDescription=function(i,s){let c="";c+="m="+i+" ",c+=s.codecs.length>0?"9":"0",c+=" "+(s.profile||"UDP/TLS/RTP/SAVPF")+" ",c+=s.codecs.map(_=>_.preferredPayloadType!==void 0?_.preferredPayloadType:_.payloadType).join(" ")+`\r
`,c+=`c=IN IP4 0.0.0.0\r
`,c+=`a=rtcp:9 IN IP4 0.0.0.0\r
`,s.codecs.forEach(_=>{c+=r.writeRtpMap(_),c+=r.writeFmtp(_),c+=r.writeRtcpFb(_)});let m=0;return s.codecs.forEach(_=>{_.maxptime>m&&(m=_.maxptime)}),m>0&&(c+="a=maxptime:"+m+`\r
`),s.headerExtensions&&s.headerExtensions.forEach(_=>{c+=r.writeExtmap(_)}),c},r.parseRtpEncodingParameters=function(i){const s=[],c=r.parseRtpParameters(i),m=c.fecMechanisms.indexOf("RED")!==-1,_=c.fecMechanisms.indexOf("ULPFEC")!==-1,w=r.matchPrefix(i,"a=ssrc:").map(N=>r.parseSsrcMedia(N)).filter(N=>N.attribute==="cname"),x=w.length>0&&w[0].ssrc;let S;const E=r.matchPrefix(i,"a=ssrc-group:FID").map(N=>N.substring(17).split(" ").map(ie=>parseInt(ie,10)));E.length>0&&E[0].length>1&&E[0][0]===x&&(S=E[0][1]),c.codecs.forEach(N=>{if(N.name.toUpperCase()==="RTX"&&N.parameters.apt){let q={ssrc:x,codecPayloadType:parseInt(N.parameters.apt,10)};x&&S&&(q.rtx={ssrc:S}),s.push(q),m&&(q=JSON.parse(JSON.stringify(q)),q.fec={ssrc:x,mechanism:_?"red+ulpfec":"red"},s.push(q))}}),s.length===0&&x&&s.push({ssrc:x});let R=r.matchPrefix(i,"b=");return R.length&&(R[0].indexOf("b=TIAS:")===0?R=parseInt(R[0].substring(7),10):R[0].indexOf("b=AS:")===0?R=parseInt(R[0].substring(5),10)*1e3*.95-2e3*8:R=void 0,s.forEach(N=>{N.maxBitrate=R})),s},r.parseRtcpParameters=function(i){const s={},c=r.matchPrefix(i,"a=ssrc:").map(w=>r.parseSsrcMedia(w)).filter(w=>w.attribute==="cname")[0];c&&(s.cname=c.value,s.ssrc=c.ssrc);const m=r.matchPrefix(i,"a=rtcp-rsize");s.reducedSize=m.length>0,s.compound=m.length===0;const _=r.matchPrefix(i,"a=rtcp-mux");return s.mux=_.length>0,s},r.writeRtcpParameters=function(i){let s="";return i.reducedSize&&(s+=`a=rtcp-rsize\r
`),i.mux&&(s+=`a=rtcp-mux\r
`),i.ssrc!==void 0&&i.cname&&(s+="a=ssrc:"+i.ssrc+" cname:"+i.cname+`\r
`),s},r.parseMsid=function(i){let s;const c=r.matchPrefix(i,"a=msid:");if(c.length===1)return s=c[0].substring(7).split(" "),{stream:s[0],track:s[1]};const m=r.matchPrefix(i,"a=ssrc:").map(_=>r.parseSsrcMedia(_)).filter(_=>_.attribute==="msid");if(m.length>0)return s=m[0].value.split(" "),{stream:s[0],track:s[1]}},r.parseSctpDescription=function(i){const s=r.parseMLine(i),c=r.matchPrefix(i,"a=max-message-size:");let m;c.length>0&&(m=parseInt(c[0].substring(19),10)),isNaN(m)&&(m=65536);const _=r.matchPrefix(i,"a=sctp-port:");if(_.length>0)return{port:parseInt(_[0].substring(12),10),protocol:s.fmt,maxMessageSize:m};const w=r.matchPrefix(i,"a=sctpmap:");if(w.length>0){const x=w[0].substring(10).split(" ");return{port:parseInt(x[0],10),protocol:x[1],maxMessageSize:m}}},r.writeSctpDescription=function(i,s){let c=[];return i.protocol!=="DTLS/SCTP"?c=["m="+i.kind+" 9 "+i.protocol+" "+s.protocol+`\r
`,`c=IN IP4 0.0.0.0\r
`,"a=sctp-port:"+s.port+`\r
`]:c=["m="+i.kind+" 9 "+i.protocol+" "+s.port+`\r
`,`c=IN IP4 0.0.0.0\r
`,"a=sctpmap:"+s.port+" "+s.protocol+` 65535\r
`],s.maxMessageSize!==void 0&&c.push("a=max-message-size:"+s.maxMessageSize+`\r
`),c.join("")},r.generateSessionId=function(){return Math.random().toString().substr(2,22)},r.writeSessionBoilerplate=function(i,s,c){let m;const _=s!==void 0?s:2;return i?m=i:m=r.generateSessionId(),`v=0\r
o=`+(c||"thisisadapterortc")+" "+m+" "+_+` IN IP4 127.0.0.1\r
s=-\r
t=0 0\r
`},r.getDirection=function(i,s){const c=r.splitLines(i);for(let m=0;m<c.length;m++)switch(c[m]){case"a=sendrecv":case"a=sendonly":case"a=recvonly":case"a=inactive":return c[m].substring(2)}return s?r.getDirection(s):"sendrecv"},r.getKind=function(i){return r.splitLines(i)[0].split(" ")[0].substring(2)},r.isRejected=function(i){return i.split(" ",2)[1]==="0"},r.parseMLine=function(i){const c=r.splitLines(i)[0].substring(2).split(" ");return{kind:c[0],port:parseInt(c[1],10),protocol:c[2],fmt:c.slice(3).join(" ")}},r.parseOLine=function(i){const c=r.matchPrefix(i,"o=")[0].substring(2).split(" ");return{username:c[0],sessionId:c[1],sessionVersion:parseInt(c[2],10),netType:c[3],addressType:c[4],address:c[5]}},r.isValidSDP=function(i){if(typeof i!="string"||i.length===0)return!1;const s=r.splitLines(i);for(let c=0;c<s.length;c++)if(s[c].length<2||s[c].charAt(1)!=="=")return!1;return!0},u.exports=r})(bf)),bf.exports}var um=Dy();const qs=Qo(um),zy=ay({__proto__:null,default:qs},[um]);function oc(u){if(!u.RTCIceCandidate||u.RTCIceCandidate&&"foundation"in u.RTCIceCandidate.prototype)return;const r=u.RTCIceCandidate;u.RTCIceCandidate=function(s){if(typeof s=="object"&&s.candidate&&s.candidate.indexOf("a=")===0&&(s=JSON.parse(JSON.stringify(s)),s.candidate=s.candidate.substring(2)),s.candidate&&s.candidate.length){const c=new r(s),m=qs.parseCandidate(s.candidate);for(const _ in m)_ in c||Object.defineProperty(c,_,{value:m[_]});return c.toJSON=function(){return{candidate:c.candidate,sdpMid:c.sdpMid,sdpMLineIndex:c.sdpMLineIndex,usernameFragment:c.usernameFragment}},c}return new r(s)},u.RTCIceCandidate.prototype=r.prototype,Zi(u,"icecandidate",i=>(i.candidate&&Object.defineProperty(i,"candidate",{value:new u.RTCIceCandidate(i.candidate),writable:"false"}),i))}function Nf(u){!u.RTCIceCandidate||u.RTCIceCandidate&&"relayProtocol"in u.RTCIceCandidate.prototype||Zi(u,"icecandidate",r=>{if(r.candidate){const i=qs.parseCandidate(r.candidate.candidate);i.type==="relay"&&(r.candidate.relayProtocol={0:"tls",1:"tcp",2:"udp"}[i.priority>>24])}return r})}function lc(u,r){if(!u.RTCPeerConnection)return;"sctp"in u.RTCPeerConnection.prototype||Object.defineProperty(u.RTCPeerConnection.prototype,"sctp",{get(){return typeof this._sctp>"u"?null:this._sctp}});const i=function(w){if(!w||!w.sdp)return!1;const x=qs.splitSections(w.sdp);return x.shift(),x.some(S=>{const E=qs.parseMLine(S);return E&&E.kind==="application"&&E.protocol.indexOf("SCTP")!==-1})},s=function(w){const x=w.sdp.match(/mozilla...THIS_IS_SDPARTA-(\d+)/);if(x===null||x.length<2)return-1;const S=parseInt(x[1],10);return S!==S?-1:S},c=function(w){let x=65536;return r.browser==="firefox"&&(r.version<57?w===-1?x=16384:x=2147483637:r.version<60?x=r.version===57?65535:65536:x=2147483637),x},m=function(w,x){let S=65536;r.browser==="firefox"&&r.version===57&&(S=65535);const E=qs.matchPrefix(w.sdp,"a=max-message-size:");return E.length>0?S=parseInt(E[0].substring(19),10):r.browser==="firefox"&&x!==-1&&(S=2147483637),S},_=u.RTCPeerConnection.prototype.setRemoteDescription;u.RTCPeerConnection.prototype.setRemoteDescription=function(){if(this._sctp=null,r.browser==="chrome"&&r.version>=76){const{sdpSemantics:x}=this.getConfiguration();x==="plan-b"&&Object.defineProperty(this,"sctp",{get(){return typeof this._sctp>"u"?null:this._sctp},enumerable:!0,configurable:!0})}if(i(arguments[0])){const x=s(arguments[0]),S=c(x),E=m(arguments[0],x);let R;S===0&&E===0?R=Number.POSITIVE_INFINITY:S===0||E===0?R=Math.max(S,E):R=Math.min(S,E);const N={};Object.defineProperty(N,"maxMessageSize",{get(){return R}}),this._sctp=N}return _.apply(this,arguments)}}function cc(u){if(!(u.RTCPeerConnection&&"createDataChannel"in u.RTCPeerConnection.prototype))return;function r(s,c){const m=s.send;s.send=function(){const w=arguments[0],x=w.length||w.size||w.byteLength;if(s.readyState==="open"&&c.sctp&&x>c.sctp.maxMessageSize)throw new TypeError("Message too large (can send a maximum of "+c.sctp.maxMessageSize+" bytes)");return m.apply(s,arguments)}}const i=u.RTCPeerConnection.prototype.createDataChannel;u.RTCPeerConnection.prototype.createDataChannel=function(){const c=i.apply(this,arguments);return r(c,this),c},Zi(u,"datachannel",s=>(r(s.channel,s.target),s))}function Of(u){if(!u.RTCPeerConnection||"connectionState"in u.RTCPeerConnection.prototype)return;const r=u.RTCPeerConnection.prototype;Object.defineProperty(r,"connectionState",{get(){return{completed:"connected",checking:"connecting"}[this.iceConnectionState]||this.iceConnectionState},enumerable:!0,configurable:!0}),Object.defineProperty(r,"onconnectionstatechange",{get(){return this._onconnectionstatechange||null},set(i){this._onconnectionstatechange&&(this.removeEventListener("connectionstatechange",this._onconnectionstatechange),delete this._onconnectionstatechange),i&&this.addEventListener("connectionstatechange",this._onconnectionstatechange=i)},enumerable:!0,configurable:!0}),["setLocalDescription","setRemoteDescription"].forEach(i=>{const s=r[i];r[i]=function(){return this._connectionstatechangepoly||(this._connectionstatechangepoly=c=>{const m=c.target;if(m._lastConnectionState!==m.connectionState){m._lastConnectionState=m.connectionState;const _=new Event("connectionstatechange",c);m.dispatchEvent(_)}return c},this.addEventListener("iceconnectionstatechange",this._connectionstatechangepoly)),s.apply(this,arguments)}})}function Df(u,r){if(!u.RTCPeerConnection||r.browser==="chrome"&&r.version>=71||r.browser==="safari"&&r._safariVersion>=13.1)return;const i=u.RTCPeerConnection.prototype.setRemoteDescription;u.RTCPeerConnection.prototype.setRemoteDescription=function(c){if(c&&c.sdp&&c.sdp.indexOf(`
a=extmap-allow-mixed`)!==-1){const m=c.sdp.split(`
`).filter(_=>_.trim()!=="a=extmap-allow-mixed").join(`
`);u.RTCSessionDescription&&c instanceof u.RTCSessionDescription?arguments[0]=new u.RTCSessionDescription({type:c.type,sdp:m}):c.sdp=m}return i.apply(this,arguments)}}function uc(u,r){if(!(u.RTCPeerConnection&&u.RTCPeerConnection.prototype))return;const i=u.RTCPeerConnection.prototype.addIceCandidate;!i||i.length===0||(u.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?(r.browser==="chrome"&&r.version<78||r.browser==="firefox"&&r.version<68||r.browser==="safari")&&arguments[0]&&arguments[0].candidate===""?Promise.resolve():i.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())})}function fc(u,r){if(!(u.RTCPeerConnection&&u.RTCPeerConnection.prototype))return;const i=u.RTCPeerConnection.prototype.setLocalDescription;!i||i.length===0||(u.RTCPeerConnection.prototype.setLocalDescription=function(){let c=arguments[0]||{};if(typeof c!="object"||c.type&&c.sdp)return i.apply(this,arguments);if(c={type:c.type,sdp:c.sdp},!c.type)switch(this.signalingState){case"stable":case"have-local-offer":case"have-remote-pranswer":c.type="offer";break;default:c.type="answer";break}return c.sdp||c.type!=="offer"&&c.type!=="answer"?i.apply(this,[c]):(c.type==="offer"?this.createOffer:this.createAnswer).apply(this).then(_=>i.apply(this,[_]))})}const By=Object.freeze(Object.defineProperty({__proto__:null,removeExtmapAllowMixed:Df,shimAddIceCandidateNullOrEmpty:uc,shimConnectionState:Of,shimMaxMessageSize:lc,shimParameterlessSetLocalDescription:fc,shimRTCIceCandidate:oc,shimRTCIceCandidateRelayProtocol:Nf,shimSendThrowTypeError:cc},Symbol.toStringTag,{value:"Module"}));function Uy({window:u}={},r={shimChrome:!0,shimFirefox:!0,shimSafari:!0}){const i=zp,s=Ny(u),c={browserDetails:s,commonShim:By,extractVersion:qo,disableLog:Ry,disableWarnings:Ay,sdp:zy};switch(s.browser){case"chrome":if(!pp||!Rf||!r.shimChrome)return i("Chrome shim is not included in this adapter release."),c;if(s.version===null)return i("Chrome shim can not determine version, not shimming."),c;i("adapter.js shimming chrome."),c.browserShim=pp,uc(u,s),fc(u),Up(u,s),Lp(u),Rf(u,s),Hp(u),qp(u,s),Ip(u),Kp(u),Yp(u,s),oc(u),Nf(u),Of(u),lc(u,s),cc(u),Df(u,s);break;case"firefox":if(!mp||!Af||!r.shimFirefox)return i("Firefox shim is not included in this adapter release."),c;i("adapter.js shimming firefox."),c.browserShim=mp,uc(u,s),fc(u),Vp(u,s),Af(u,s),Gp(u),Xp(u),Qp(u),$p(u),Fp(u),Zp(u),Jp(u),Wp(u),em(u),oc(u),Of(u),lc(u,s),cc(u);break;case"safari":if(!gp||!r.shimSafari)return i("Safari shim is not included in this adapter release."),c;i("adapter.js shimming safari."),c.browserShim=gp,uc(u,s),fc(u),sm(u),lm(u),rm(u),tm(u),nm(u),om(u),am(u),cm(u),oc(u),Nf(u),lc(u,s),cc(u),Df(u,s);break;default:i("Unsupported browser!");break}return c}const vp=Uy({window:typeof window>"u"?void 0:window});function Ji(u,r,i,s){Object.defineProperty(u,r,{get:i,set:s,enumerable:!0,configurable:!0})}class fm{constructor(){this.chunkedMTU=16300,this._dataCount=1,this.chunk=r=>{const i=[],s=r.byteLength,c=Math.ceil(s/this.chunkedMTU);let m=0,_=0;for(;_<s;){const w=Math.min(s,_+this.chunkedMTU),x=r.slice(_,w),S={__peerData:this._dataCount,n:m,data:x,total:c};i.push(S),_=w,m++}return this._dataCount++,i}}}function Ly(u){let r=0;for(const c of u)r+=c.byteLength;const i=new Uint8Array(r);let s=0;for(const c of u)i.set(c,s),s+=c.byteLength;return i}const Sf=vp.default||vp,Po=new class{isWebRTCSupported(){return typeof RTCPeerConnection<"u"}isBrowserSupported(){const u=this.getBrowser(),r=this.getVersion();return this.supportedBrowsers.includes(u)?u==="chrome"?r>=this.minChromeVersion:u==="firefox"?r>=this.minFirefoxVersion:u==="safari"?!this.isIOS&&r>=this.minSafariVersion:!1:!1}getBrowser(){return Sf.browserDetails.browser}getVersion(){return Sf.browserDetails.version||0}isUnifiedPlanSupported(){const u=this.getBrowser(),r=Sf.browserDetails.version||0;if(u==="chrome"&&r<this.minChromeVersion)return!1;if(u==="firefox"&&r>=this.minFirefoxVersion)return!0;if(!window.RTCRtpTransceiver||!("currentDirection"in RTCRtpTransceiver.prototype))return!1;let i,s=!1;try{i=new RTCPeerConnection,i.addTransceiver("audio"),s=!0}catch{}finally{i&&i.close()}return s}toString(){return`Supports:
    browser:${this.getBrowser()}
    version:${this.getVersion()}
    isIOS:${this.isIOS}
    isWebRTCSupported:${this.isWebRTCSupported()}
    isBrowserSupported:${this.isBrowserSupported()}
    isUnifiedPlanSupported:${this.isUnifiedPlanSupported()}`}constructor(){this.isIOS=typeof navigator<"u"?["iPad","iPhone","iPod"].includes(navigator.platform):!1,this.supportedBrowsers=["firefox","chrome","safari"],this.minFirefoxVersion=59,this.minChromeVersion=72,this.minSafariVersion=605}},Hy=u=>!u||/^[A-Za-z0-9]+(?:[ _-][A-Za-z0-9]+)*$/.test(u),dm=()=>Math.random().toString(36).slice(2),xp={iceServers:[{urls:"stun:stun.l.google.com:19302"},{urls:["turn:eu-0.turn.peerjs.com:3478","turn:us-0.turn.peerjs.com:3478"],username:"peerjs",credential:"peerjsp"}],sdpSemantics:"unified-plan"};class Iy extends fm{noop(){}blobToArrayBuffer(r,i){const s=new FileReader;return s.onload=function(c){c.target&&i(c.target.result)},s.readAsArrayBuffer(r),s}binaryStringToArrayBuffer(r){const i=new Uint8Array(r.length);for(let s=0;s<r.length;s++)i[s]=r.charCodeAt(s)&255;return i.buffer}isSecure(){return location.protocol==="https:"}constructor(...r){super(...r),this.CLOUD_HOST="0.peerjs.com",this.CLOUD_PORT=443,this.chunkedBrowsers={Chrome:1,chrome:1},this.defaultConfig=xp,this.browser=Po.getBrowser(),this.browserVersion=Po.getVersion(),this.pack=Np,this.unpack=Ap,this.supports=(function(){const i={browser:Po.isBrowserSupported(),webRTC:Po.isWebRTCSupported(),audioVideo:!1,data:!1,binaryBlob:!1,reliable:!1};if(!i.webRTC)return i;let s;try{s=new RTCPeerConnection(xp),i.audioVideo=!0;let c;try{c=s.createDataChannel("_PEERJSTEST",{ordered:!0}),i.data=!0,i.reliable=!!c.ordered;try{c.binaryType="blob",i.binaryBlob=!Po.isIOS}catch{}}catch{}finally{c&&c.close()}}catch{}finally{s&&s.close()}return i})(),this.validateId=Hy,this.randomToken=dm}}const Ar=new Iy,Ky="PeerJS: ";class Py{get logLevel(){return this._logLevel}set logLevel(r){this._logLevel=r}log(...r){this._logLevel>=3&&this._print(3,...r)}warn(...r){this._logLevel>=2&&this._print(2,...r)}error(...r){this._logLevel>=1&&this._print(1,...r)}setLogFunction(r){this._print=r}_print(r,...i){const s=[Ky,...i];for(const c in s)s[c]instanceof Error&&(s[c]="("+s[c].name+") "+s[c].message);r>=3?console.log(...s):r>=2?console.warn("WARNING",...s):r>=1&&console.error("ERROR",...s)}constructor(){this._logLevel=0}}var ut=new Py,Qf={},qy=Object.prototype.hasOwnProperty,Sr="~";function Go(){}Object.create&&(Go.prototype=Object.create(null),new Go().__proto__||(Sr=!1));function Yy(u,r,i){this.fn=u,this.context=r,this.once=i||!1}function hm(u,r,i,s,c){if(typeof i!="function")throw new TypeError("The listener must be a function");var m=new Yy(i,s||u,c),_=Sr?Sr+r:r;return u._events[_]?u._events[_].fn?u._events[_]=[u._events[_],m]:u._events[_].push(m):(u._events[_]=m,u._eventsCount++),u}function dc(u,r){--u._eventsCount===0?u._events=new Go:delete u._events[r]}function hr(){this._events=new Go,this._eventsCount=0}hr.prototype.eventNames=function(){var r=[],i,s;if(this._eventsCount===0)return r;for(s in i=this._events)qy.call(i,s)&&r.push(Sr?s.slice(1):s);return Object.getOwnPropertySymbols?r.concat(Object.getOwnPropertySymbols(i)):r};hr.prototype.listeners=function(r){var i=Sr?Sr+r:r,s=this._events[i];if(!s)return[];if(s.fn)return[s.fn];for(var c=0,m=s.length,_=new Array(m);c<m;c++)_[c]=s[c].fn;return _};hr.prototype.listenerCount=function(r){var i=Sr?Sr+r:r,s=this._events[i];return s?s.fn?1:s.length:0};hr.prototype.emit=function(r,i,s,c,m,_){var w=Sr?Sr+r:r;if(!this._events[w])return!1;var x=this._events[w],S=arguments.length,E,R;if(x.fn){switch(x.once&&this.removeListener(r,x.fn,void 0,!0),S){case 1:return x.fn.call(x.context),!0;case 2:return x.fn.call(x.context,i),!0;case 3:return x.fn.call(x.context,i,s),!0;case 4:return x.fn.call(x.context,i,s,c),!0;case 5:return x.fn.call(x.context,i,s,c,m),!0;case 6:return x.fn.call(x.context,i,s,c,m,_),!0}for(R=1,E=new Array(S-1);R<S;R++)E[R-1]=arguments[R];x.fn.apply(x.context,E)}else{var N=x.length,q;for(R=0;R<N;R++)switch(x[R].once&&this.removeListener(r,x[R].fn,void 0,!0),S){case 1:x[R].fn.call(x[R].context);break;case 2:x[R].fn.call(x[R].context,i);break;case 3:x[R].fn.call(x[R].context,i,s);break;case 4:x[R].fn.call(x[R].context,i,s,c);break;default:if(!E)for(q=1,E=new Array(S-1);q<S;q++)E[q-1]=arguments[q];x[R].fn.apply(x[R].context,E)}}return!0};hr.prototype.on=function(r,i,s){return hm(this,r,i,s,!1)};hr.prototype.once=function(r,i,s){return hm(this,r,i,s,!0)};hr.prototype.removeListener=function(r,i,s,c){var m=Sr?Sr+r:r;if(!this._events[m])return this;if(!i)return dc(this,m),this;var _=this._events[m];if(_.fn)_.fn===i&&(!c||_.once)&&(!s||_.context===s)&&dc(this,m);else{for(var w=0,x=[],S=_.length;w<S;w++)(_[w].fn!==i||c&&!_[w].once||s&&_[w].context!==s)&&x.push(_[w]);x.length?this._events[m]=x.length===1?x[0]:x:dc(this,m)}return this};hr.prototype.removeAllListeners=function(r){var i;return r?(i=Sr?Sr+r:r,this._events[i]&&dc(this,i)):(this._events=new Go,this._eventsCount=0),this};hr.prototype.off=hr.prototype.removeListener;hr.prototype.addListener=hr.prototype.on;hr.prefixed=Sr;hr.EventEmitter=hr;Qf=hr;var Wi={};Ji(Wi,"ConnectionType",()=>Ei);Ji(Wi,"PeerErrorType",()=>Gn);Ji(Wi,"BaseConnectionErrorType",()=>zf);Ji(Wi,"DataConnectionErrorType",()=>$f);Ji(Wi,"SerializationType",()=>Cc);Ji(Wi,"SocketEventType",()=>Ci);Ji(Wi,"ServerMessageType",()=>dr);var Ei=(function(u){return u.Data="data",u.Media="media",u})({}),Gn=(function(u){return u.BrowserIncompatible="browser-incompatible",u.Disconnected="disconnected",u.InvalidID="invalid-id",u.InvalidKey="invalid-key",u.Network="network",u.PeerUnavailable="peer-unavailable",u.SslUnavailable="ssl-unavailable",u.ServerError="server-error",u.SocketError="socket-error",u.SocketClosed="socket-closed",u.UnavailableID="unavailable-id",u.WebRTC="webrtc",u})({}),zf=(function(u){return u.NegotiationFailed="negotiation-failed",u.ConnectionClosed="connection-closed",u})({}),$f=(function(u){return u.NotOpenYet="not-open-yet",u.MessageToBig="message-too-big",u})({}),Cc=(function(u){return u.Binary="binary",u.BinaryUTF8="binary-utf8",u.JSON="json",u.None="raw",u})({}),Ci=(function(u){return u.Message="message",u.Disconnected="disconnected",u.Error="error",u.Close="close",u})({}),dr=(function(u){return u.Heartbeat="HEARTBEAT",u.Candidate="CANDIDATE",u.Offer="OFFER",u.Answer="ANSWER",u.Open="OPEN",u.Error="ERROR",u.IdTaken="ID-TAKEN",u.InvalidKey="INVALID-KEY",u.Leave="LEAVE",u.Expire="EXPIRE",u})({});const pm="1.5.5";class Vy extends Qf.EventEmitter{constructor(r,i,s,c,m,_=5e3){super(),this.pingInterval=_,this._disconnected=!0,this._messagesQueue=[];const w=r?"wss://":"ws://";this._baseUrl=w+i+":"+s+c+"peerjs?key="+m}start(r,i){this._id=r;const s=`${this._baseUrl}&id=${r}&token=${i}`;this._socket||!this._disconnected||(this._socket=new WebSocket(s+"&version="+pm),this._disconnected=!1,this._socket.onmessage=c=>{let m;try{m=JSON.parse(c.data),ut.log("Server message received:",m)}catch{ut.log("Invalid server message",c.data);return}this.emit(Ci.Message,m)},this._socket.onclose=c=>{this._disconnected||(ut.log("Socket closed.",c),this._cleanup(),this._disconnected=!0,this.emit(Ci.Disconnected))},this._socket.onopen=()=>{this._disconnected||(this._sendQueuedMessages(),ut.log("Socket open"),this._scheduleHeartbeat())})}_scheduleHeartbeat(){this._wsPingTimer=setTimeout(()=>{this._sendHeartbeat()},this.pingInterval)}_sendHeartbeat(){if(!this._wsOpen()){ut.log("Cannot send heartbeat, because socket closed");return}const r=JSON.stringify({type:dr.Heartbeat});this._socket.send(r),this._scheduleHeartbeat()}_wsOpen(){return!!this._socket&&this._socket.readyState===1}_sendQueuedMessages(){const r=[...this._messagesQueue];this._messagesQueue=[];for(const i of r)this.send(i)}send(r){if(this._disconnected)return;if(!this._id){this._messagesQueue.push(r);return}if(!r.type){this.emit(Ci.Error,"Invalid message");return}if(!this._wsOpen())return;const i=JSON.stringify(r);this._socket.send(i)}close(){this._disconnected||(this._cleanup(),this._disconnected=!0)}_cleanup(){this._socket&&(this._socket.onopen=this._socket.onmessage=this._socket.onclose=null,this._socket.close(),this._socket=void 0),clearTimeout(this._wsPingTimer)}}class mm{constructor(r){this.connection=r}startConnection(r){const i=this._startPeerConnection();if(this.connection.peerConnection=i,this.connection.type===Ei.Media&&r._stream&&this._addTracksToConnection(r._stream,i),r.originator){const s=this.connection,c={ordered:!!r.reliable},m=i.createDataChannel(s.label,c);s._initializeDataChannel(m),this._makeOffer()}else this.handleSDP("OFFER",r.sdp)}_startPeerConnection(){ut.log("Creating RTCPeerConnection.");const r=new RTCPeerConnection(this.connection.provider.options.config);return this._setupListeners(r),r}_setupListeners(r){const i=this.connection.peer,s=this.connection.connectionId,c=this.connection.type,m=this.connection.provider;ut.log("Listening for ICE candidates."),r.onicecandidate=_=>{!_.candidate||!_.candidate.candidate||(ut.log(`Received ICE candidates for ${i}:`,_.candidate),m.socket.send({type:dr.Candidate,payload:{candidate:_.candidate,type:c,connectionId:s},dst:i}))},r.oniceconnectionstatechange=()=>{switch(r.iceConnectionState){case"failed":ut.log("iceConnectionState is failed, closing connections to "+i),this.connection.emitError(zf.NegotiationFailed,"Negotiation of connection to "+i+" failed."),this.connection.close();break;case"closed":ut.log("iceConnectionState is closed, closing connections to "+i),this.connection.emitError(zf.ConnectionClosed,"Connection to "+i+" closed."),this.connection.close();break;case"disconnected":ut.log("iceConnectionState changed to disconnected on the connection with "+i);break;case"completed":r.onicecandidate=()=>{};break}this.connection.emit("iceStateChanged",r.iceConnectionState)},ut.log("Listening for data channel"),r.ondatachannel=_=>{ut.log("Received data channel");const w=_.channel;m.getConnection(i,s)._initializeDataChannel(w)},ut.log("Listening for remote stream"),r.ontrack=_=>{ut.log("Received remote stream");const w=_.streams[0],x=m.getConnection(i,s);if(x.type===Ei.Media){const S=x;this._addStreamToMediaConnection(w,S)}}}cleanup(){ut.log("Cleaning up PeerConnection to "+this.connection.peer);const r=this.connection.peerConnection;if(!r)return;this.connection.peerConnection=null,r.onicecandidate=r.oniceconnectionstatechange=r.ondatachannel=r.ontrack=()=>{};const i=r.signalingState!=="closed";let s=!1;const c=this.connection.dataChannel;c&&(s=!!c.readyState&&c.readyState!=="closed"),(i||s)&&r.close()}async _makeOffer(){const r=this.connection.peerConnection,i=this.connection.provider;try{const s=await r.createOffer(this.connection.options.constraints);ut.log("Created offer."),this.connection.options.sdpTransform&&typeof this.connection.options.sdpTransform=="function"&&(s.sdp=this.connection.options.sdpTransform(s.sdp)||s.sdp);try{await r.setLocalDescription(s),ut.log("Set localDescription:",s,`for:${this.connection.peer}`);let c={sdp:s,type:this.connection.type,connectionId:this.connection.connectionId,metadata:this.connection.metadata};if(this.connection.type===Ei.Data){const m=this.connection;c={...c,label:m.label,reliable:m.reliable,serialization:m.serialization}}i.socket.send({type:dr.Offer,payload:c,dst:this.connection.peer})}catch(c){c!="OperationError: Failed to set local offer sdp: Called in wrong state: kHaveRemoteOffer"&&(i.emitError(Gn.WebRTC,c),ut.log("Failed to setLocalDescription, ",c))}}catch(s){i.emitError(Gn.WebRTC,s),ut.log("Failed to createOffer, ",s)}}async _makeAnswer(){const r=this.connection.peerConnection,i=this.connection.provider;try{const s=await r.createAnswer();ut.log("Created answer."),this.connection.options.sdpTransform&&typeof this.connection.options.sdpTransform=="function"&&(s.sdp=this.connection.options.sdpTransform(s.sdp)||s.sdp);try{await r.setLocalDescription(s),ut.log("Set localDescription:",s,`for:${this.connection.peer}`),i.socket.send({type:dr.Answer,payload:{sdp:s,type:this.connection.type,connectionId:this.connection.connectionId},dst:this.connection.peer})}catch(c){i.emitError(Gn.WebRTC,c),ut.log("Failed to setLocalDescription, ",c)}}catch(s){i.emitError(Gn.WebRTC,s),ut.log("Failed to create answer, ",s)}}async handleSDP(r,i){i=new RTCSessionDescription(i);const s=this.connection.peerConnection,c=this.connection.provider;ut.log("Setting remote description",i);const m=this;try{await s.setRemoteDescription(i),ut.log(`Set remoteDescription:${r} for:${this.connection.peer}`),r==="OFFER"&&await m._makeAnswer()}catch(_){c.emitError(Gn.WebRTC,_),ut.log("Failed to setRemoteDescription, ",_)}}async handleCandidate(r){ut.log("handleCandidate:",r);try{await this.connection.peerConnection.addIceCandidate(r),ut.log(`Added ICE candidate for:${this.connection.peer}`)}catch(i){this.connection.provider.emitError(Gn.WebRTC,i),ut.log("Failed to handleCandidate, ",i)}}_addTracksToConnection(r,i){if(ut.log(`add tracks from stream ${r.id} to peer connection`),!i.addTrack)return ut.error("Your browser does't support RTCPeerConnection#addTrack. Ignored.");r.getTracks().forEach(s=>{i.addTrack(s,r)})}_addStreamToMediaConnection(r,i){ut.log(`add stream ${r.id} to media connection ${i.connectionId}`),i.addStream(r)}}class gm extends Qf.EventEmitter{emitError(r,i){ut.error("Error:",i),this.emit("error",new Gy(`${r}`,i))}}class Gy extends Error{constructor(r,i){typeof i=="string"?super(i):(super(),Object.assign(this,i)),this.type=r}}class ym extends gm{get open(){return this._open}constructor(r,i,s){super(),this.peer=r,this.provider=i,this.options=s,this._open=!1,this.metadata=s.metadata}}class vc extends ym{static#e=this.ID_PREFIX="mc_";get type(){return Ei.Media}get localStream(){return this._localStream}get remoteStream(){return this._remoteStream}constructor(r,i,s){super(r,i,s),this._localStream=this.options._stream,this.connectionId=this.options.connectionId||vc.ID_PREFIX+Ar.randomToken(),this._negotiator=new mm(this),this._localStream&&this._negotiator.startConnection({_stream:this._localStream,originator:!0})}_initializeDataChannel(r){this.dataChannel=r,this.dataChannel.onopen=()=>{ut.log(`DC#${this.connectionId} dc connection success`),this.emit("willCloseOnRemote")},this.dataChannel.onclose=()=>{ut.log(`DC#${this.connectionId} dc closed for:`,this.peer),this.close()}}addStream(r){ut.log("Receiving stream",r),this._remoteStream=r,super.emit("stream",r)}handleMessage(r){const i=r.type,s=r.payload;switch(r.type){case dr.Answer:this._negotiator.handleSDP(i,s.sdp),this._open=!0;break;case dr.Candidate:this._negotiator.handleCandidate(s.candidate);break;default:ut.warn(`Unrecognized message type:${i} from peer:${this.peer}`);break}}answer(r,i={}){if(this._localStream){ut.warn("Local stream already exists on this MediaConnection. Are you answering a call twice?");return}this._localStream=r,i&&i.sdpTransform&&(this.options.sdpTransform=i.sdpTransform),this._negotiator.startConnection({...this.options._payload,_stream:r});const s=this.provider._getMessages(this.connectionId);for(const c of s)this.handleMessage(c);this._open=!0}close(){this._negotiator&&(this._negotiator.cleanup(),this._negotiator=null),this._localStream=null,this._remoteStream=null,this.provider&&(this.provider._removeConnection(this),this.provider=null),this.options&&this.options._stream&&(this.options._stream=null),this.open&&(this._open=!1,super.emit("close"))}}class Qy{constructor(r){this._options=r}_buildRequest(r){const i=this._options.secure?"https":"http",{host:s,port:c,path:m,key:_}=this._options,w=new URL(`${i}://${s}:${c}${m}${_}/${r}`);return w.searchParams.set("ts",`${Date.now()}${Math.random()}`),w.searchParams.set("version",pm),fetch(w.href,{referrerPolicy:this._options.referrerPolicy})}async retrieveId(){try{const r=await this._buildRequest("id");if(r.status!==200)throw new Error(`Error. Status:${r.status}`);return r.text()}catch(r){ut.error("Error retrieving ID",r);let i="";throw this._options.path==="/"&&this._options.host!==Ar.CLOUD_HOST&&(i=" If you passed in a `path` to your self-hosted PeerServer, you'll also need to pass in that same path when creating a new Peer."),new Error("Could not get an ID from the server."+i)}}async listAllPeers(){try{const r=await this._buildRequest("peers");if(r.status!==200){if(r.status===401){let i="";throw this._options.host===Ar.CLOUD_HOST?i="It looks like you're using the cloud server. You can email team@peerjs.com to enable peer listing for your API key.":i="You need to enable `allow_discovery` on your self-hosted PeerServer to use this feature.",new Error("It doesn't look like you have permission to list peers IDs. "+i)}throw new Error(`Error. Status:${r.status}`)}return r.json()}catch(r){throw ut.error("Error retrieving list peers",r),new Error("Could not get list peers from the server."+r)}}}class xc extends ym{static#e=this.ID_PREFIX="dc_";static#t=this.MAX_BUFFERED_AMOUNT=8388608;get type(){return Ei.Data}constructor(r,i,s){super(r,i,s),this.connectionId=this.options.connectionId||xc.ID_PREFIX+dm(),this.label=this.options.label||this.connectionId,this.reliable=!!this.options.reliable,this._negotiator=new mm(this),this._negotiator.startConnection(this.options._payload||{originator:!0,reliable:this.reliable})}_initializeDataChannel(r){this.dataChannel=r,this.dataChannel.onopen=()=>{ut.log(`DC#${this.connectionId} dc connection success`),this._open=!0,this.emit("open")},this.dataChannel.onmessage=i=>{ut.log(`DC#${this.connectionId} dc onmessage:`,i.data)},this.dataChannel.onclose=()=>{ut.log(`DC#${this.connectionId} dc closed for:`,this.peer),this.close()}}close(r){if(r?.flush){this.send({__peerData:{type:"close"}});return}this._negotiator&&(this._negotiator.cleanup(),this._negotiator=null),this.provider&&(this.provider._removeConnection(this),this.provider=null),this.dataChannel&&(this.dataChannel.onopen=null,this.dataChannel.onmessage=null,this.dataChannel.onclose=null,this.dataChannel=null),this.open&&(this._open=!1,super.emit("close"))}send(r,i=!1){if(!this.open){this.emitError($f.NotOpenYet,"Connection is not open. You should listen for the `open` event before sending messages.");return}return this._send(r,i)}async handleMessage(r){const i=r.payload;switch(r.type){case dr.Answer:await this._negotiator.handleSDP(r.type,i.sdp);break;case dr.Candidate:await this._negotiator.handleCandidate(i.candidate);break;default:ut.warn("Unrecognized message type:",r.type,"from peer:",this.peer);break}}}class Xf extends xc{get bufferSize(){return this._bufferSize}_initializeDataChannel(r){super._initializeDataChannel(r),this.dataChannel.binaryType="arraybuffer",this.dataChannel.addEventListener("message",i=>this._handleDataMessage(i))}_bufferedSend(r){(this._buffering||!this._trySend(r))&&(this._buffer.push(r),this._bufferSize=this._buffer.length)}_trySend(r){if(!this.open)return!1;if(this.dataChannel.bufferedAmount>xc.MAX_BUFFERED_AMOUNT)return this._buffering=!0,setTimeout(()=>{this._buffering=!1,this._tryBuffer()},50),!1;try{this.dataChannel.send(r)}catch(i){return ut.error(`DC#:${this.connectionId} Error when sending:`,i),this._buffering=!0,this.close(),!1}return!0}_tryBuffer(){if(!this.open||this._buffer.length===0)return;const r=this._buffer[0];this._trySend(r)&&(this._buffer.shift(),this._bufferSize=this._buffer.length,this._tryBuffer())}close(r){if(r?.flush){this.send({__peerData:{type:"close"}});return}this._buffer=[],this._bufferSize=0,super.close()}constructor(...r){super(...r),this._buffer=[],this._bufferSize=0,this._buffering=!1}}class _f extends Xf{close(r){super.close(r),this._chunkedData={}}constructor(r,i,s){super(r,i,s),this.chunker=new fm,this.serialization=Cc.Binary,this._chunkedData={}}_handleDataMessage({data:r}){const i=Ap(r),s=i.__peerData;if(s){if(s.type==="close"){this.close();return}this._handleChunk(i);return}this.emit("data",i)}_handleChunk(r){const i=r.__peerData,s=this._chunkedData[i]||{data:[],count:0,total:r.total};if(s.data[r.n]=new Uint8Array(r.data),s.count++,this._chunkedData[i]=s,s.total===s.count){delete this._chunkedData[i];const c=Ly(s.data);this._handleDataMessage({data:c})}}_send(r,i){const s=Np(r);if(s instanceof Promise)return this._send_blob(s);if(!i&&s.byteLength>this.chunker.chunkedMTU){this._sendChunks(s);return}this._bufferedSend(s)}async _send_blob(r){const i=await r;if(i.byteLength>this.chunker.chunkedMTU){this._sendChunks(i);return}this._bufferedSend(i)}_sendChunks(r){const i=this.chunker.chunk(r);ut.log(`DC#${this.connectionId} Try to send ${i.length} chunks...`);for(const s of i)this.send(s,!0)}}class $y extends Xf{_handleDataMessage({data:r}){super.emit("data",r)}_send(r,i){this._bufferedSend(r)}constructor(...r){super(...r),this.serialization=Cc.None}}class Xy extends Xf{_handleDataMessage({data:r}){const i=this.parse(this.decoder.decode(r)),s=i.__peerData;if(s&&s.type==="close"){this.close();return}this.emit("data",i)}_send(r,i){const s=this.encoder.encode(this.stringify(r));if(s.byteLength>=Ar.chunkedMTU){this.emitError($f.MessageToBig,"Message too big for JSON channel");return}this._bufferedSend(s)}constructor(...r){super(...r),this.serialization=Cc.JSON,this.encoder=new TextEncoder,this.decoder=new TextDecoder,this.stringify=JSON.stringify,this.parse=JSON.parse}}class Ff extends gm{static#e=this.DEFAULT_KEY="peerjs";get id(){return this._id}get options(){return this._options}get open(){return this._open}get socket(){return this._socket}get connections(){const r=Object.create(null);for(const[i,s]of this._connections)r[i]=s;return r}get destroyed(){return this._destroyed}get disconnected(){return this._disconnected}constructor(r,i){super(),this._serializers={raw:$y,json:Xy,binary:_f,"binary-utf8":_f,default:_f},this._id=null,this._lastServerId=null,this._destroyed=!1,this._disconnected=!1,this._open=!1,this._connections=new Map,this._lostMessages=new Map;let s;if(r&&r.constructor==Object?i=r:r&&(s=r.toString()),i={debug:0,host:Ar.CLOUD_HOST,port:Ar.CLOUD_PORT,path:"/",key:Ff.DEFAULT_KEY,token:Ar.randomToken(),config:Ar.defaultConfig,referrerPolicy:"strict-origin-when-cross-origin",serializers:{},...i},this._options=i,this._serializers={...this._serializers,...this.options.serializers},this._options.host==="/"&&(this._options.host=window.location.hostname),this._options.path&&(this._options.path[0]!=="/"&&(this._options.path="/"+this._options.path),this._options.path[this._options.path.length-1]!=="/"&&(this._options.path+="/")),this._options.secure===void 0&&this._options.host!==Ar.CLOUD_HOST?this._options.secure=Ar.isSecure():this._options.host==Ar.CLOUD_HOST&&(this._options.secure=!0),this._options.logFunction&&ut.setLogFunction(this._options.logFunction),ut.logLevel=this._options.debug||0,this._api=new Qy(i),this._socket=this._createServerConnection(),!Ar.supports.audioVideo&&!Ar.supports.data){this._delayedAbort(Gn.BrowserIncompatible,"The current browser does not support WebRTC");return}if(s&&!Ar.validateId(s)){this._delayedAbort(Gn.InvalidID,`ID "${s}" is invalid`);return}s?this._initialize(s):this._api.retrieveId().then(c=>this._initialize(c)).catch(c=>this._abort(Gn.ServerError,c))}_createServerConnection(){const r=new Vy(this._options.secure,this._options.host,this._options.port,this._options.path,this._options.key,this._options.pingInterval);return r.on(Ci.Message,i=>{this._handleMessage(i)}),r.on(Ci.Error,i=>{this._abort(Gn.SocketError,i)}),r.on(Ci.Disconnected,()=>{this.disconnected||(this.emitError(Gn.Network,"Lost connection to server."),this.disconnect())}),r.on(Ci.Close,()=>{this.disconnected||this._abort(Gn.SocketClosed,"Underlying socket is already closed.")}),r}_initialize(r){this._id=r,this.socket.start(r,this._options.token)}_handleMessage(r){const i=r.type,s=r.payload,c=r.src;switch(i){case dr.Open:this._lastServerId=this.id,this._open=!0,this.emit("open",this.id);break;case dr.Error:this._abort(Gn.ServerError,s.msg);break;case dr.IdTaken:this._abort(Gn.UnavailableID,`ID "${this.id}" is taken`);break;case dr.InvalidKey:this._abort(Gn.InvalidKey,`API KEY "${this._options.key}" is invalid`);break;case dr.Leave:ut.log(`Received leave message from ${c}`),this._cleanupPeer(c),this._connections.delete(c);break;case dr.Expire:this.emitError(Gn.PeerUnavailable,`Could not connect to peer ${c}`);break;case dr.Offer:{const m=s.connectionId;let _=this.getConnection(c,m);if(_&&(_.close(),ut.warn(`Offer received for existing Connection ID:${m}`)),s.type===Ei.Media){const x=new vc(c,this,{connectionId:m,_payload:s,metadata:s.metadata});_=x,this._addConnection(c,_),this.emit("call",x)}else if(s.type===Ei.Data){const x=new this._serializers[s.serialization](c,this,{connectionId:m,_payload:s,metadata:s.metadata,label:s.label,serialization:s.serialization,reliable:s.reliable});_=x,this._addConnection(c,_),this.emit("connection",x)}else{ut.warn(`Received malformed connection type:${s.type}`);return}const w=this._getMessages(m);for(const x of w)_.handleMessage(x);break}default:{if(!s){ut.warn(`You received a malformed message from ${c} of type ${i}`);return}const m=s.connectionId,_=this.getConnection(c,m);_&&_.peerConnection?_.handleMessage(r):m?this._storeMessage(m,r):ut.warn("You received an unrecognized message:",r);break}}}_storeMessage(r,i){this._lostMessages.has(r)||this._lostMessages.set(r,[]),this._lostMessages.get(r).push(i)}_getMessages(r){const i=this._lostMessages.get(r);return i?(this._lostMessages.delete(r),i):[]}connect(r,i={}){if(i={serialization:"default",...i},this.disconnected){ut.warn("You cannot connect to a new Peer because you called .disconnect() on this Peer and ended your connection with the server. You can create a new Peer to reconnect, or call reconnect on this peer if you believe its ID to still be available."),this.emitError(Gn.Disconnected,"Cannot connect to new Peer after disconnecting from server.");return}const s=new this._serializers[i.serialization](r,this,i);return this._addConnection(r,s),s}call(r,i,s={}){if(this.disconnected){ut.warn("You cannot connect to a new Peer because you called .disconnect() on this Peer and ended your connection with the server. You can create a new Peer to reconnect."),this.emitError(Gn.Disconnected,"Cannot connect to new Peer after disconnecting from server.");return}if(!i){ut.error("To call a peer, you must provide a stream from your browser's `getUserMedia`.");return}const c=new vc(r,this,{...s,_stream:i});return this._addConnection(r,c),c}_addConnection(r,i){ut.log(`add connection ${i.type}:${i.connectionId} to peerId:${r}`),this._connections.has(r)||this._connections.set(r,[]),this._connections.get(r).push(i)}_removeConnection(r){const i=this._connections.get(r.peer);if(i){const s=i.indexOf(r);s!==-1&&i.splice(s,1)}this._lostMessages.delete(r.connectionId)}getConnection(r,i){const s=this._connections.get(r);if(!s)return null;for(const c of s)if(c.connectionId===i)return c;return null}_delayedAbort(r,i){setTimeout(()=>{this._abort(r,i)},0)}_abort(r,i){ut.error("Aborting!"),this.emitError(r,i),this._lastServerId?this.disconnect():this.destroy()}destroy(){this.destroyed||(ut.log(`Destroy peer with ID:${this.id}`),this.disconnect(),this._cleanup(),this._destroyed=!0,this.emit("close"))}_cleanup(){for(const r of this._connections.keys())this._cleanupPeer(r),this._connections.delete(r);this.socket.removeAllListeners()}_cleanupPeer(r){const i=this._connections.get(r);if(i)for(const s of i)s.close()}disconnect(){if(this.disconnected)return;const r=this.id;ut.log(`Disconnect peer with ID:${r}`),this._disconnected=!0,this._open=!1,this.socket.close(),this._lastServerId=r,this._id=null,this.emit("disconnected",r)}reconnect(){if(this.disconnected&&!this.destroyed)ut.log(`Attempting reconnection to server with ID ${this._lastServerId}`),this._disconnected=!1,this._initialize(this._lastServerId);else{if(this.destroyed)throw new Error("This peer cannot reconnect to the server. It has already been destroyed.");if(!this.disconnected&&!this.open)ut.error("In a hurry? We're still trying to make the initial connection!");else throw new Error(`Peer ${this.id} cannot reconnect because it is not disconnected from the server!`)}}listAllPeers(r=i=>{}){this._api.listAllPeers().then(i=>r(i)).catch(i=>this._abort(Gn.ServerError,i))}}var Fy=Ff;class Zy{name="PeerJS";peer=null;userIdHash=null;handshakeCallbacks=new Set;customSignalCallbacks=new Set;connections=new Map;connected=!1;async initialize(r){this.userIdHash=r;for(let i=1;i<=3;i++)try{await this.attemptConnection(r);return}catch(s){if(s.type==="unavailable-id"&&i<3){console.warn(`[${this.name}] ID taken (stale connection), retrying in 1s... (${i}/3)`),await new Promise(c=>setTimeout(c,1e3));continue}throw s}}attemptConnection(r){return new Promise((i,s)=>{this.peer&&(this.peer.destroy(),this.peer=null),this.peer=new Fy(r,{host:"0.peerjs.com",port:443,path:"/",secure:!0,debug:0});let c=!1;const m=_=>{console.error(`[${this.name}] Initialization error:`,_),(_.type==="network"||_.type==="server-error"||_.type==="socket-error"||_.type==="socket-closed")&&(this.connected=!1),c||(c=!0,this.peer?.off("error",m),s(_))};this.peer.on("error",m),this.peer.on("open",_=>{this.connected=!0,console.log(`[${this.name}]  Connected with ID:`,_.substring(0,8)+"..."),c||(c=!0,this.peer?.off("error",m),this.setupRuntimeErrorHandler(),i())}),this.peer.on("connection",_=>{this.setupConnection(_)}),this.peer.on("disconnected",()=>{console.warn(`[${this.name}]  Disconnected from server`),this.connected=!1,setTimeout(()=>{this.peer&&!this.peer.destroyed&&(console.log(`[${this.name}] Reconnecting...`),this.peer.reconnect())},1e3)}),setTimeout(()=>{!this.connected&&!c&&(c=!0,s(new Error("PeerJS connection timeout")))},1e4)})}setupRuntimeErrorHandler(){this.peer&&this.peer.on("error",r=>{console.error(`[${this.name}] Runtime error:`,r),(r.type==="network"||r.type==="server-error"||r.type==="socket-error"||r.type==="socket-closed")&&(console.warn(`[${this.name}] Server connection error, marking disconnected`),this.connected=!1)})}async sendHandshakeMessage(r,i){await this.sendMessage(r,{type:"handshake",message:i})}async sendCustomSignal(r,i){await this.sendMessage(r,{type:"custom",signal:i})}async sendMessage(r,i){if(!this.peer||!this.userIdHash)throw new Error("Not initialized");if(!this.connected)throw new Error("Not connected to PeerJS server");try{let s=this.connections.get(r);(!s||s.open===!1)&&(s=this.peer.connect(r,{reliable:!0,serialization:"json"}),this.setupConnection(s),await new Promise((c,m)=>{const _=setTimeout(()=>{m(new Error("Connection timeout"))},5e3);s.on("open",()=>{clearTimeout(_),c()}),s.on("error",w=>{clearTimeout(_),m(w)})})),s.send(i),console.log(`[${this.name}] Sent ${i.type} to:`,r.substring(0,8))}catch(s){throw console.error(`[${this.name}] Failed to send message:`,s),s}}onHandshakeMessage(r){return this.handshakeCallbacks.add(r),()=>{this.handshakeCallbacks.delete(r)}}onCustomSignal(r){return this.customSignalCallbacks.add(r),()=>{this.customSignalCallbacks.delete(r)}}isConnected(){return this.connected&&this.peer!==null}setupConnection(r){const i=r.peer;r.on("open",()=>{this.connections.set(i,r),console.log(`[${this.name}] Connection opened with:`,i.substring(0,8))}),r.on("data",s=>{s&&s.type==="handshake"&&s.message?(console.log(`[${this.name}] Received handshake from:`,i.substring(0,8)),this.handshakeCallbacks.forEach(c=>{c(i,s.message)})):s&&s.type==="custom"&&s.signal&&(console.log(`[${this.name}] Received custom signal from:`,i.substring(0,8)),this.customSignalCallbacks.forEach(c=>{c(i,s.signal)}))}),r.on("close",()=>{this.connections.delete(i),console.log(`[${this.name}] Connection closed with:`,i.substring(0,8))}),r.on("error",s=>{console.error(`[${this.name}] Connection error with ${i}:`,s),this.connections.delete(i)})}destroy(){this.connections.forEach(r=>{r.close()}),this.connections.clear(),this.peer&&(this.peer.destroy(),this.peer=null),this.handshakeCallbacks.clear(),this.customSignalCallbacks.clear(),this.connected=!1,this.userIdHash=null,console.log(`[${this.name}] Destroyed`)}}class Jy{services=[];handshakeMessageCallbacks=new Set;customSignalCallbacks=new Set;initializedUserId=null;initializationPromise=null;async initialize(r,i=wy){if(this.initializedUserId===r&&this.services.length>0){console.log("[SignalingManager] Already initialized for this user, skipping");return}if(this.initializationPromise)return console.log("[SignalingManager] Initialization already in progress, waiting..."),this.initializationPromise;this.initializedUserId&&this.initializedUserId!==r&&(console.log("[SignalingManager] Switching users, cleaning up old signaling"),this.destroyInternal()),this.initializedUserId=r;const s=[];if(i.peerjs?.enabled!==!1){const c=new Zy;s.push(c.initialize(r).then(()=>{this.services.push(c),this.setupServiceListeners(c),console.log("[SignalingManager]  PeerJS enabled")}).catch(m=>{console.warn("[SignalingManager] PeerJS failed:",m)}))}this.initializationPromise=Promise.allSettled(s).then(()=>{if(this.services.length===0)throw this.initializedUserId=null,this.initializationPromise=null,new Error("No signaling services available");console.log(`[SignalingManager]  Initialized with ${this.services.length} service(s) for user:`,r.substring(0,8)),this.initializationPromise=null}),await this.initializationPromise}async sendHandshakeMessage(r,i){if(this.services.length===0)throw new Error("No signaling services available");const s=this.services.map(_=>_.sendHandshakeMessage(r,i).then(()=>{console.log(`[SignalingManager]  Sent handshake via ${_.name}`)}).catch(w=>{console.warn(`[SignalingManager] Failed to send handshake via ${_.name}:`,w)})),m=(await Promise.allSettled(s)).filter(_=>_.status==="fulfilled").length;if(m===0)throw new Error("Failed to send handshake through any service");console.log(`[SignalingManager] Handshake sent via ${m}/${this.services.length} service(s)`)}async sendCustomSignal(r,i){if(this.services.length===0)throw new Error("No signaling services available");const s=this.services.map(_=>_.sendCustomSignal(r,i).then(()=>{console.log(`[SignalingManager]  Sent custom signal via ${_.name}`)}).catch(w=>{console.warn(`[SignalingManager] Failed to send custom signal via ${_.name}:`,w)})),m=(await Promise.allSettled(s)).filter(_=>_.status==="fulfilled").length;if(m===0)throw new Error("Failed to send custom signal through any service");console.log(`[SignalingManager] Custom signal sent via ${m}/${this.services.length} service(s)`)}onCustomSignal(r){return this.customSignalCallbacks.add(r),()=>{this.customSignalCallbacks.delete(r)}}onHandshakeMessage(r){return this.handshakeMessageCallbacks.add(r),()=>{this.handshakeMessageCallbacks.delete(r)}}getActiveServices(){return this.services.filter(r=>r.isConnected()).map(r=>r.name)}isConnected(){return this.services.some(r=>r.isConnected())}isInitializedForUser(r){return this.initializedUserId===r&&this.services.length>0}destroy(){console.log("[SignalingManager] Destroy called - cleaning up signaling"),this.destroyInternal()}setupServiceListeners(r){r.onHandshakeMessage((i,s)=>{console.log(`[SignalingManager] Handshake received from ${i.substring(0,8)} via ${r.name}`),this.handshakeMessageCallbacks.forEach(c=>{c(i,s)})}),r.onCustomSignal((i,s)=>{console.log(`[SignalingManager] Custom signal received from ${i.substring(0,8)} via ${r.name}`),this.customSignalCallbacks.forEach(c=>{c(i,s)})})}destroyInternal(){this.services.forEach(r=>{r.destroy()}),this.services=[],this.handshakeMessageCallbacks.clear(),this.customSignalCallbacks.clear(),this.initializedUserId=null,this.initializationPromise=null}}function Wy(u){throw new Error('Could not dynamically require "'+u+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var Cf={exports:{}};const ev={},tv=Object.freeze(Object.defineProperty({__proto__:null,default:ev},Symbol.toStringTag,{value:"Module"})),nv=sy(tv);var bp;function vm(){return bp||(bp=1,(function(u){(function(r){var i=function(b){var M,k=new Float64Array(16);if(b)for(M=0;M<b.length;M++)k[M]=b[M];return k},s=function(){throw new Error("no PRNG")},c=new Uint8Array(16),m=new Uint8Array(32);m[0]=9;var _=i(),w=i([1]),x=i([56129,1]),S=i([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),E=i([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),R=i([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),N=i([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),q=i([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function ie(b,M,k,h){b[M]=k>>24&255,b[M+1]=k>>16&255,b[M+2]=k>>8&255,b[M+3]=k&255,b[M+4]=h>>24&255,b[M+5]=h>>16&255,b[M+6]=h>>8&255,b[M+7]=h&255}function se(b,M,k,h,A){var Q,G=0;for(Q=0;Q<A;Q++)G|=b[M+Q]^k[h+Q];return(1&G-1>>>8)-1}function Re(b,M,k,h){return se(b,M,k,h,16)}function lt(b,M,k,h){return se(b,M,k,h,32)}function ke(b,M,k,h){for(var A=h[0]&255|(h[1]&255)<<8|(h[2]&255)<<16|(h[3]&255)<<24,Q=k[0]&255|(k[1]&255)<<8|(k[2]&255)<<16|(k[3]&255)<<24,G=k[4]&255|(k[5]&255)<<8|(k[6]&255)<<16|(k[7]&255)<<24,fe=k[8]&255|(k[9]&255)<<8|(k[10]&255)<<16|(k[11]&255)<<24,_e=k[12]&255|(k[13]&255)<<8|(k[14]&255)<<16|(k[15]&255)<<24,at=h[4]&255|(h[5]&255)<<8|(h[6]&255)<<16|(h[7]&255)<<24,Xe=M[0]&255|(M[1]&255)<<8|(M[2]&255)<<16|(M[3]&255)<<24,Bt=M[4]&255|(M[5]&255)<<8|(M[6]&255)<<16|(M[7]&255)<<24,We=M[8]&255|(M[9]&255)<<8|(M[10]&255)<<16|(M[11]&255)<<24,pt=M[12]&255|(M[13]&255)<<8|(M[14]&255)<<16|(M[15]&255)<<24,Ct=h[8]&255|(h[9]&255)<<8|(h[10]&255)<<16|(h[11]&255)<<24,Et=k[16]&255|(k[17]&255)<<8|(k[18]&255)<<16|(k[19]&255)<<24,tt=k[20]&255|(k[21]&255)<<8|(k[22]&255)<<16|(k[23]&255)<<24,vt=k[24]&255|(k[25]&255)<<8|(k[26]&255)<<16|(k[27]&255)<<24,ht=k[28]&255|(k[29]&255)<<8|(k[30]&255)<<16|(k[31]&255)<<24,it=h[12]&255|(h[13]&255)<<8|(h[14]&255)<<16|(h[15]&255)<<24,Fe=A,st=Q,Ie=G,Ze=fe,nt=_e,Ve=at,ae=Xe,oe=Bt,le=We,ye=pt,ge=Ct,Se=Et,mt=tt,At=vt,Mt=ht,jt=it,D,Nt=0;Nt<20;Nt+=2)D=Fe+mt|0,nt^=D<<7|D>>>25,D=nt+Fe|0,le^=D<<9|D>>>23,D=le+nt|0,mt^=D<<13|D>>>19,D=mt+le|0,Fe^=D<<18|D>>>14,D=Ve+st|0,ye^=D<<7|D>>>25,D=ye+Ve|0,At^=D<<9|D>>>23,D=At+ye|0,st^=D<<13|D>>>19,D=st+At|0,Ve^=D<<18|D>>>14,D=ge+ae|0,Mt^=D<<7|D>>>25,D=Mt+ge|0,Ie^=D<<9|D>>>23,D=Ie+Mt|0,ae^=D<<13|D>>>19,D=ae+Ie|0,ge^=D<<18|D>>>14,D=jt+Se|0,Ze^=D<<7|D>>>25,D=Ze+jt|0,oe^=D<<9|D>>>23,D=oe+Ze|0,Se^=D<<13|D>>>19,D=Se+oe|0,jt^=D<<18|D>>>14,D=Fe+Ze|0,st^=D<<7|D>>>25,D=st+Fe|0,Ie^=D<<9|D>>>23,D=Ie+st|0,Ze^=D<<13|D>>>19,D=Ze+Ie|0,Fe^=D<<18|D>>>14,D=Ve+nt|0,ae^=D<<7|D>>>25,D=ae+Ve|0,oe^=D<<9|D>>>23,D=oe+ae|0,nt^=D<<13|D>>>19,D=nt+oe|0,Ve^=D<<18|D>>>14,D=ge+ye|0,Se^=D<<7|D>>>25,D=Se+ge|0,le^=D<<9|D>>>23,D=le+Se|0,ye^=D<<13|D>>>19,D=ye+le|0,ge^=D<<18|D>>>14,D=jt+Mt|0,mt^=D<<7|D>>>25,D=mt+jt|0,At^=D<<9|D>>>23,D=At+mt|0,Mt^=D<<13|D>>>19,D=Mt+At|0,jt^=D<<18|D>>>14;Fe=Fe+A|0,st=st+Q|0,Ie=Ie+G|0,Ze=Ze+fe|0,nt=nt+_e|0,Ve=Ve+at|0,ae=ae+Xe|0,oe=oe+Bt|0,le=le+We|0,ye=ye+pt|0,ge=ge+Ct|0,Se=Se+Et|0,mt=mt+tt|0,At=At+vt|0,Mt=Mt+ht|0,jt=jt+it|0,b[0]=Fe>>>0&255,b[1]=Fe>>>8&255,b[2]=Fe>>>16&255,b[3]=Fe>>>24&255,b[4]=st>>>0&255,b[5]=st>>>8&255,b[6]=st>>>16&255,b[7]=st>>>24&255,b[8]=Ie>>>0&255,b[9]=Ie>>>8&255,b[10]=Ie>>>16&255,b[11]=Ie>>>24&255,b[12]=Ze>>>0&255,b[13]=Ze>>>8&255,b[14]=Ze>>>16&255,b[15]=Ze>>>24&255,b[16]=nt>>>0&255,b[17]=nt>>>8&255,b[18]=nt>>>16&255,b[19]=nt>>>24&255,b[20]=Ve>>>0&255,b[21]=Ve>>>8&255,b[22]=Ve>>>16&255,b[23]=Ve>>>24&255,b[24]=ae>>>0&255,b[25]=ae>>>8&255,b[26]=ae>>>16&255,b[27]=ae>>>24&255,b[28]=oe>>>0&255,b[29]=oe>>>8&255,b[30]=oe>>>16&255,b[31]=oe>>>24&255,b[32]=le>>>0&255,b[33]=le>>>8&255,b[34]=le>>>16&255,b[35]=le>>>24&255,b[36]=ye>>>0&255,b[37]=ye>>>8&255,b[38]=ye>>>16&255,b[39]=ye>>>24&255,b[40]=ge>>>0&255,b[41]=ge>>>8&255,b[42]=ge>>>16&255,b[43]=ge>>>24&255,b[44]=Se>>>0&255,b[45]=Se>>>8&255,b[46]=Se>>>16&255,b[47]=Se>>>24&255,b[48]=mt>>>0&255,b[49]=mt>>>8&255,b[50]=mt>>>16&255,b[51]=mt>>>24&255,b[52]=At>>>0&255,b[53]=At>>>8&255,b[54]=At>>>16&255,b[55]=At>>>24&255,b[56]=Mt>>>0&255,b[57]=Mt>>>8&255,b[58]=Mt>>>16&255,b[59]=Mt>>>24&255,b[60]=jt>>>0&255,b[61]=jt>>>8&255,b[62]=jt>>>16&255,b[63]=jt>>>24&255}function we(b,M,k,h){for(var A=h[0]&255|(h[1]&255)<<8|(h[2]&255)<<16|(h[3]&255)<<24,Q=k[0]&255|(k[1]&255)<<8|(k[2]&255)<<16|(k[3]&255)<<24,G=k[4]&255|(k[5]&255)<<8|(k[6]&255)<<16|(k[7]&255)<<24,fe=k[8]&255|(k[9]&255)<<8|(k[10]&255)<<16|(k[11]&255)<<24,_e=k[12]&255|(k[13]&255)<<8|(k[14]&255)<<16|(k[15]&255)<<24,at=h[4]&255|(h[5]&255)<<8|(h[6]&255)<<16|(h[7]&255)<<24,Xe=M[0]&255|(M[1]&255)<<8|(M[2]&255)<<16|(M[3]&255)<<24,Bt=M[4]&255|(M[5]&255)<<8|(M[6]&255)<<16|(M[7]&255)<<24,We=M[8]&255|(M[9]&255)<<8|(M[10]&255)<<16|(M[11]&255)<<24,pt=M[12]&255|(M[13]&255)<<8|(M[14]&255)<<16|(M[15]&255)<<24,Ct=h[8]&255|(h[9]&255)<<8|(h[10]&255)<<16|(h[11]&255)<<24,Et=k[16]&255|(k[17]&255)<<8|(k[18]&255)<<16|(k[19]&255)<<24,tt=k[20]&255|(k[21]&255)<<8|(k[22]&255)<<16|(k[23]&255)<<24,vt=k[24]&255|(k[25]&255)<<8|(k[26]&255)<<16|(k[27]&255)<<24,ht=k[28]&255|(k[29]&255)<<8|(k[30]&255)<<16|(k[31]&255)<<24,it=h[12]&255|(h[13]&255)<<8|(h[14]&255)<<16|(h[15]&255)<<24,Fe=A,st=Q,Ie=G,Ze=fe,nt=_e,Ve=at,ae=Xe,oe=Bt,le=We,ye=pt,ge=Ct,Se=Et,mt=tt,At=vt,Mt=ht,jt=it,D,Nt=0;Nt<20;Nt+=2)D=Fe+mt|0,nt^=D<<7|D>>>25,D=nt+Fe|0,le^=D<<9|D>>>23,D=le+nt|0,mt^=D<<13|D>>>19,D=mt+le|0,Fe^=D<<18|D>>>14,D=Ve+st|0,ye^=D<<7|D>>>25,D=ye+Ve|0,At^=D<<9|D>>>23,D=At+ye|0,st^=D<<13|D>>>19,D=st+At|0,Ve^=D<<18|D>>>14,D=ge+ae|0,Mt^=D<<7|D>>>25,D=Mt+ge|0,Ie^=D<<9|D>>>23,D=Ie+Mt|0,ae^=D<<13|D>>>19,D=ae+Ie|0,ge^=D<<18|D>>>14,D=jt+Se|0,Ze^=D<<7|D>>>25,D=Ze+jt|0,oe^=D<<9|D>>>23,D=oe+Ze|0,Se^=D<<13|D>>>19,D=Se+oe|0,jt^=D<<18|D>>>14,D=Fe+Ze|0,st^=D<<7|D>>>25,D=st+Fe|0,Ie^=D<<9|D>>>23,D=Ie+st|0,Ze^=D<<13|D>>>19,D=Ze+Ie|0,Fe^=D<<18|D>>>14,D=Ve+nt|0,ae^=D<<7|D>>>25,D=ae+Ve|0,oe^=D<<9|D>>>23,D=oe+ae|0,nt^=D<<13|D>>>19,D=nt+oe|0,Ve^=D<<18|D>>>14,D=ge+ye|0,Se^=D<<7|D>>>25,D=Se+ge|0,le^=D<<9|D>>>23,D=le+Se|0,ye^=D<<13|D>>>19,D=ye+le|0,ge^=D<<18|D>>>14,D=jt+Mt|0,mt^=D<<7|D>>>25,D=mt+jt|0,At^=D<<9|D>>>23,D=At+mt|0,Mt^=D<<13|D>>>19,D=Mt+At|0,jt^=D<<18|D>>>14;b[0]=Fe>>>0&255,b[1]=Fe>>>8&255,b[2]=Fe>>>16&255,b[3]=Fe>>>24&255,b[4]=Ve>>>0&255,b[5]=Ve>>>8&255,b[6]=Ve>>>16&255,b[7]=Ve>>>24&255,b[8]=ge>>>0&255,b[9]=ge>>>8&255,b[10]=ge>>>16&255,b[11]=ge>>>24&255,b[12]=jt>>>0&255,b[13]=jt>>>8&255,b[14]=jt>>>16&255,b[15]=jt>>>24&255,b[16]=ae>>>0&255,b[17]=ae>>>8&255,b[18]=ae>>>16&255,b[19]=ae>>>24&255,b[20]=oe>>>0&255,b[21]=oe>>>8&255,b[22]=oe>>>16&255,b[23]=oe>>>24&255,b[24]=le>>>0&255,b[25]=le>>>8&255,b[26]=le>>>16&255,b[27]=le>>>24&255,b[28]=ye>>>0&255,b[29]=ye>>>8&255,b[30]=ye>>>16&255,b[31]=ye>>>24&255}function $e(b,M,k,h){ke(b,M,k,h)}function Je(b,M,k,h){we(b,M,k,h)}var ft=new Uint8Array([101,120,112,97,110,100,32,51,50,45,98,121,116,101,32,107]);function et(b,M,k,h,A,Q,G){var fe=new Uint8Array(16),_e=new Uint8Array(64),at,Xe;for(Xe=0;Xe<16;Xe++)fe[Xe]=0;for(Xe=0;Xe<8;Xe++)fe[Xe]=Q[Xe];for(;A>=64;){for($e(_e,fe,G,ft),Xe=0;Xe<64;Xe++)b[M+Xe]=k[h+Xe]^_e[Xe];for(at=1,Xe=8;Xe<16;Xe++)at=at+(fe[Xe]&255)|0,fe[Xe]=at&255,at>>>=8;A-=64,M+=64,h+=64}if(A>0)for($e(_e,fe,G,ft),Xe=0;Xe<A;Xe++)b[M+Xe]=k[h+Xe]^_e[Xe];return 0}function qt(b,M,k,h,A){var Q=new Uint8Array(16),G=new Uint8Array(64),fe,_e;for(_e=0;_e<16;_e++)Q[_e]=0;for(_e=0;_e<8;_e++)Q[_e]=h[_e];for(;k>=64;){for($e(G,Q,A,ft),_e=0;_e<64;_e++)b[M+_e]=G[_e];for(fe=1,_e=8;_e<16;_e++)fe=fe+(Q[_e]&255)|0,Q[_e]=fe&255,fe>>>=8;k-=64,M+=64}if(k>0)for($e(G,Q,A,ft),_e=0;_e<k;_e++)b[M+_e]=G[_e];return 0}function en(b,M,k,h,A){var Q=new Uint8Array(32);Je(Q,h,A,ft);for(var G=new Uint8Array(8),fe=0;fe<8;fe++)G[fe]=h[fe+16];return qt(b,M,k,G,Q)}function Oe(b,M,k,h,A,Q,G){var fe=new Uint8Array(32);Je(fe,Q,G,ft);for(var _e=new Uint8Array(8),at=0;at<8;at++)_e[at]=Q[at+16];return et(b,M,k,h,A,_e,fe)}var Te=function(b){this.buffer=new Uint8Array(16),this.r=new Uint16Array(10),this.h=new Uint16Array(10),this.pad=new Uint16Array(8),this.leftover=0,this.fin=0;var M,k,h,A,Q,G,fe,_e;M=b[0]&255|(b[1]&255)<<8,this.r[0]=M&8191,k=b[2]&255|(b[3]&255)<<8,this.r[1]=(M>>>13|k<<3)&8191,h=b[4]&255|(b[5]&255)<<8,this.r[2]=(k>>>10|h<<6)&7939,A=b[6]&255|(b[7]&255)<<8,this.r[3]=(h>>>7|A<<9)&8191,Q=b[8]&255|(b[9]&255)<<8,this.r[4]=(A>>>4|Q<<12)&255,this.r[5]=Q>>>1&8190,G=b[10]&255|(b[11]&255)<<8,this.r[6]=(Q>>>14|G<<2)&8191,fe=b[12]&255|(b[13]&255)<<8,this.r[7]=(G>>>11|fe<<5)&8065,_e=b[14]&255|(b[15]&255)<<8,this.r[8]=(fe>>>8|_e<<8)&8191,this.r[9]=_e>>>5&127,this.pad[0]=b[16]&255|(b[17]&255)<<8,this.pad[1]=b[18]&255|(b[19]&255)<<8,this.pad[2]=b[20]&255|(b[21]&255)<<8,this.pad[3]=b[22]&255|(b[23]&255)<<8,this.pad[4]=b[24]&255|(b[25]&255)<<8,this.pad[5]=b[26]&255|(b[27]&255)<<8,this.pad[6]=b[28]&255|(b[29]&255)<<8,this.pad[7]=b[30]&255|(b[31]&255)<<8};Te.prototype.blocks=function(b,M,k){for(var h=this.fin?0:2048,A,Q,G,fe,_e,at,Xe,Bt,We,pt,Ct,Et,tt,vt,ht,it,Fe,st,Ie,Ze=this.h[0],nt=this.h[1],Ve=this.h[2],ae=this.h[3],oe=this.h[4],le=this.h[5],ye=this.h[6],ge=this.h[7],Se=this.h[8],mt=this.h[9],At=this.r[0],Mt=this.r[1],jt=this.r[2],D=this.r[3],Nt=this.r[4],wt=this.r[5],Ut=this.r[6],Ot=this.r[7],It=this.r[8],zt=this.r[9];k>=16;)A=b[M+0]&255|(b[M+1]&255)<<8,Ze+=A&8191,Q=b[M+2]&255|(b[M+3]&255)<<8,nt+=(A>>>13|Q<<3)&8191,G=b[M+4]&255|(b[M+5]&255)<<8,Ve+=(Q>>>10|G<<6)&8191,fe=b[M+6]&255|(b[M+7]&255)<<8,ae+=(G>>>7|fe<<9)&8191,_e=b[M+8]&255|(b[M+9]&255)<<8,oe+=(fe>>>4|_e<<12)&8191,le+=_e>>>1&8191,at=b[M+10]&255|(b[M+11]&255)<<8,ye+=(_e>>>14|at<<2)&8191,Xe=b[M+12]&255|(b[M+13]&255)<<8,ge+=(at>>>11|Xe<<5)&8191,Bt=b[M+14]&255|(b[M+15]&255)<<8,Se+=(Xe>>>8|Bt<<8)&8191,mt+=Bt>>>5|h,We=0,pt=We,pt+=Ze*At,pt+=nt*(5*zt),pt+=Ve*(5*It),pt+=ae*(5*Ot),pt+=oe*(5*Ut),We=pt>>>13,pt&=8191,pt+=le*(5*wt),pt+=ye*(5*Nt),pt+=ge*(5*D),pt+=Se*(5*jt),pt+=mt*(5*Mt),We+=pt>>>13,pt&=8191,Ct=We,Ct+=Ze*Mt,Ct+=nt*At,Ct+=Ve*(5*zt),Ct+=ae*(5*It),Ct+=oe*(5*Ot),We=Ct>>>13,Ct&=8191,Ct+=le*(5*Ut),Ct+=ye*(5*wt),Ct+=ge*(5*Nt),Ct+=Se*(5*D),Ct+=mt*(5*jt),We+=Ct>>>13,Ct&=8191,Et=We,Et+=Ze*jt,Et+=nt*Mt,Et+=Ve*At,Et+=ae*(5*zt),Et+=oe*(5*It),We=Et>>>13,Et&=8191,Et+=le*(5*Ot),Et+=ye*(5*Ut),Et+=ge*(5*wt),Et+=Se*(5*Nt),Et+=mt*(5*D),We+=Et>>>13,Et&=8191,tt=We,tt+=Ze*D,tt+=nt*jt,tt+=Ve*Mt,tt+=ae*At,tt+=oe*(5*zt),We=tt>>>13,tt&=8191,tt+=le*(5*It),tt+=ye*(5*Ot),tt+=ge*(5*Ut),tt+=Se*(5*wt),tt+=mt*(5*Nt),We+=tt>>>13,tt&=8191,vt=We,vt+=Ze*Nt,vt+=nt*D,vt+=Ve*jt,vt+=ae*Mt,vt+=oe*At,We=vt>>>13,vt&=8191,vt+=le*(5*zt),vt+=ye*(5*It),vt+=ge*(5*Ot),vt+=Se*(5*Ut),vt+=mt*(5*wt),We+=vt>>>13,vt&=8191,ht=We,ht+=Ze*wt,ht+=nt*Nt,ht+=Ve*D,ht+=ae*jt,ht+=oe*Mt,We=ht>>>13,ht&=8191,ht+=le*At,ht+=ye*(5*zt),ht+=ge*(5*It),ht+=Se*(5*Ot),ht+=mt*(5*Ut),We+=ht>>>13,ht&=8191,it=We,it+=Ze*Ut,it+=nt*wt,it+=Ve*Nt,it+=ae*D,it+=oe*jt,We=it>>>13,it&=8191,it+=le*Mt,it+=ye*At,it+=ge*(5*zt),it+=Se*(5*It),it+=mt*(5*Ot),We+=it>>>13,it&=8191,Fe=We,Fe+=Ze*Ot,Fe+=nt*Ut,Fe+=Ve*wt,Fe+=ae*Nt,Fe+=oe*D,We=Fe>>>13,Fe&=8191,Fe+=le*jt,Fe+=ye*Mt,Fe+=ge*At,Fe+=Se*(5*zt),Fe+=mt*(5*It),We+=Fe>>>13,Fe&=8191,st=We,st+=Ze*It,st+=nt*Ot,st+=Ve*Ut,st+=ae*wt,st+=oe*Nt,We=st>>>13,st&=8191,st+=le*D,st+=ye*jt,st+=ge*Mt,st+=Se*At,st+=mt*(5*zt),We+=st>>>13,st&=8191,Ie=We,Ie+=Ze*zt,Ie+=nt*It,Ie+=Ve*Ot,Ie+=ae*Ut,Ie+=oe*wt,We=Ie>>>13,Ie&=8191,Ie+=le*Nt,Ie+=ye*D,Ie+=ge*jt,Ie+=Se*Mt,Ie+=mt*At,We+=Ie>>>13,Ie&=8191,We=(We<<2)+We|0,We=We+pt|0,pt=We&8191,We=We>>>13,Ct+=We,Ze=pt,nt=Ct,Ve=Et,ae=tt,oe=vt,le=ht,ye=it,ge=Fe,Se=st,mt=Ie,M+=16,k-=16;this.h[0]=Ze,this.h[1]=nt,this.h[2]=Ve,this.h[3]=ae,this.h[4]=oe,this.h[5]=le,this.h[6]=ye,this.h[7]=ge,this.h[8]=Se,this.h[9]=mt},Te.prototype.finish=function(b,M){var k=new Uint16Array(10),h,A,Q,G;if(this.leftover){for(G=this.leftover,this.buffer[G++]=1;G<16;G++)this.buffer[G]=0;this.fin=1,this.blocks(this.buffer,0,16)}for(h=this.h[1]>>>13,this.h[1]&=8191,G=2;G<10;G++)this.h[G]+=h,h=this.h[G]>>>13,this.h[G]&=8191;for(this.h[0]+=h*5,h=this.h[0]>>>13,this.h[0]&=8191,this.h[1]+=h,h=this.h[1]>>>13,this.h[1]&=8191,this.h[2]+=h,k[0]=this.h[0]+5,h=k[0]>>>13,k[0]&=8191,G=1;G<10;G++)k[G]=this.h[G]+h,h=k[G]>>>13,k[G]&=8191;for(k[9]-=8192,A=(h^1)-1,G=0;G<10;G++)k[G]&=A;for(A=~A,G=0;G<10;G++)this.h[G]=this.h[G]&A|k[G];for(this.h[0]=(this.h[0]|this.h[1]<<13)&65535,this.h[1]=(this.h[1]>>>3|this.h[2]<<10)&65535,this.h[2]=(this.h[2]>>>6|this.h[3]<<7)&65535,this.h[3]=(this.h[3]>>>9|this.h[4]<<4)&65535,this.h[4]=(this.h[4]>>>12|this.h[5]<<1|this.h[6]<<14)&65535,this.h[5]=(this.h[6]>>>2|this.h[7]<<11)&65535,this.h[6]=(this.h[7]>>>5|this.h[8]<<8)&65535,this.h[7]=(this.h[8]>>>8|this.h[9]<<5)&65535,Q=this.h[0]+this.pad[0],this.h[0]=Q&65535,G=1;G<8;G++)Q=(this.h[G]+this.pad[G]|0)+(Q>>>16)|0,this.h[G]=Q&65535;b[M+0]=this.h[0]>>>0&255,b[M+1]=this.h[0]>>>8&255,b[M+2]=this.h[1]>>>0&255,b[M+3]=this.h[1]>>>8&255,b[M+4]=this.h[2]>>>0&255,b[M+5]=this.h[2]>>>8&255,b[M+6]=this.h[3]>>>0&255,b[M+7]=this.h[3]>>>8&255,b[M+8]=this.h[4]>>>0&255,b[M+9]=this.h[4]>>>8&255,b[M+10]=this.h[5]>>>0&255,b[M+11]=this.h[5]>>>8&255,b[M+12]=this.h[6]>>>0&255,b[M+13]=this.h[6]>>>8&255,b[M+14]=this.h[7]>>>0&255,b[M+15]=this.h[7]>>>8&255},Te.prototype.update=function(b,M,k){var h,A;if(this.leftover){for(A=16-this.leftover,A>k&&(A=k),h=0;h<A;h++)this.buffer[this.leftover+h]=b[M+h];if(k-=A,M+=A,this.leftover+=A,this.leftover<16)return;this.blocks(this.buffer,0,16),this.leftover=0}if(k>=16&&(A=k-k%16,this.blocks(b,M,A),M+=A,k-=A),k){for(h=0;h<k;h++)this.buffer[this.leftover+h]=b[M+h];this.leftover+=k}};function pe(b,M,k,h,A,Q){var G=new Te(Q);return G.update(k,h,A),G.finish(b,M),0}function ue(b,M,k,h,A,Q){var G=new Uint8Array(16);return pe(G,0,k,h,A,Q),Re(b,M,G,0)}function xt(b,M,k,h,A){var Q;if(k<32)return-1;for(Oe(b,0,M,0,k,h,A),pe(b,16,b,32,k-32,b),Q=0;Q<16;Q++)b[Q]=0;return 0}function qe(b,M,k,h,A){var Q,G=new Uint8Array(32);if(k<32||(en(G,0,32,h,A),ue(M,16,M,32,k-32,G)!==0))return-1;for(Oe(b,0,M,0,k,h,A),Q=0;Q<32;Q++)b[Q]=0;return 0}function J(b,M){var k;for(k=0;k<16;k++)b[k]=M[k]|0}function Me(b){var M,k,h=1;for(M=0;M<16;M++)k=b[M]+h+65535,h=Math.floor(k/65536),b[M]=k-h*65536;b[0]+=h-1+37*(h-1)}function Ge(b,M,k){for(var h,A=~(k-1),Q=0;Q<16;Q++)h=A&(b[Q]^M[Q]),b[Q]^=h,M[Q]^=h}function je(b,M){var k,h,A,Q=i(),G=i();for(k=0;k<16;k++)G[k]=M[k];for(Me(G),Me(G),Me(G),h=0;h<2;h++){for(Q[0]=G[0]-65517,k=1;k<15;k++)Q[k]=G[k]-65535-(Q[k-1]>>16&1),Q[k-1]&=65535;Q[15]=G[15]-32767-(Q[14]>>16&1),A=Q[15]>>16&1,Q[14]&=65535,Ge(G,Q,1-A)}for(k=0;k<16;k++)b[2*k]=G[k]&255,b[2*k+1]=G[k]>>8}function Ye(b,M){var k=new Uint8Array(32),h=new Uint8Array(32);return je(k,b),je(h,M),lt(k,0,h,0)}function L(b){var M=new Uint8Array(32);return je(M,b),M[0]&1}function de(b,M){var k;for(k=0;k<16;k++)b[k]=M[2*k]+(M[2*k+1]<<8);b[15]&=32767}function Ce(b,M,k){for(var h=0;h<16;h++)b[h]=M[h]+k[h]}function Le(b,M,k){for(var h=0;h<16;h++)b[h]=M[h]-k[h]}function De(b,M,k){var h,A,Q=0,G=0,fe=0,_e=0,at=0,Xe=0,Bt=0,We=0,pt=0,Ct=0,Et=0,tt=0,vt=0,ht=0,it=0,Fe=0,st=0,Ie=0,Ze=0,nt=0,Ve=0,ae=0,oe=0,le=0,ye=0,ge=0,Se=0,mt=0,At=0,Mt=0,jt=0,D=k[0],Nt=k[1],wt=k[2],Ut=k[3],Ot=k[4],It=k[5],zt=k[6],mn=k[7],Qt=k[8],tn=k[9],yn=k[10],bt=k[11],vn=k[12],Rn=k[13],Ln=k[14],nn=k[15];h=M[0],Q+=h*D,G+=h*Nt,fe+=h*wt,_e+=h*Ut,at+=h*Ot,Xe+=h*It,Bt+=h*zt,We+=h*mn,pt+=h*Qt,Ct+=h*tn,Et+=h*yn,tt+=h*bt,vt+=h*vn,ht+=h*Rn,it+=h*Ln,Fe+=h*nn,h=M[1],G+=h*D,fe+=h*Nt,_e+=h*wt,at+=h*Ut,Xe+=h*Ot,Bt+=h*It,We+=h*zt,pt+=h*mn,Ct+=h*Qt,Et+=h*tn,tt+=h*yn,vt+=h*bt,ht+=h*vn,it+=h*Rn,Fe+=h*Ln,st+=h*nn,h=M[2],fe+=h*D,_e+=h*Nt,at+=h*wt,Xe+=h*Ut,Bt+=h*Ot,We+=h*It,pt+=h*zt,Ct+=h*mn,Et+=h*Qt,tt+=h*tn,vt+=h*yn,ht+=h*bt,it+=h*vn,Fe+=h*Rn,st+=h*Ln,Ie+=h*nn,h=M[3],_e+=h*D,at+=h*Nt,Xe+=h*wt,Bt+=h*Ut,We+=h*Ot,pt+=h*It,Ct+=h*zt,Et+=h*mn,tt+=h*Qt,vt+=h*tn,ht+=h*yn,it+=h*bt,Fe+=h*vn,st+=h*Rn,Ie+=h*Ln,Ze+=h*nn,h=M[4],at+=h*D,Xe+=h*Nt,Bt+=h*wt,We+=h*Ut,pt+=h*Ot,Ct+=h*It,Et+=h*zt,tt+=h*mn,vt+=h*Qt,ht+=h*tn,it+=h*yn,Fe+=h*bt,st+=h*vn,Ie+=h*Rn,Ze+=h*Ln,nt+=h*nn,h=M[5],Xe+=h*D,Bt+=h*Nt,We+=h*wt,pt+=h*Ut,Ct+=h*Ot,Et+=h*It,tt+=h*zt,vt+=h*mn,ht+=h*Qt,it+=h*tn,Fe+=h*yn,st+=h*bt,Ie+=h*vn,Ze+=h*Rn,nt+=h*Ln,Ve+=h*nn,h=M[6],Bt+=h*D,We+=h*Nt,pt+=h*wt,Ct+=h*Ut,Et+=h*Ot,tt+=h*It,vt+=h*zt,ht+=h*mn,it+=h*Qt,Fe+=h*tn,st+=h*yn,Ie+=h*bt,Ze+=h*vn,nt+=h*Rn,Ve+=h*Ln,ae+=h*nn,h=M[7],We+=h*D,pt+=h*Nt,Ct+=h*wt,Et+=h*Ut,tt+=h*Ot,vt+=h*It,ht+=h*zt,it+=h*mn,Fe+=h*Qt,st+=h*tn,Ie+=h*yn,Ze+=h*bt,nt+=h*vn,Ve+=h*Rn,ae+=h*Ln,oe+=h*nn,h=M[8],pt+=h*D,Ct+=h*Nt,Et+=h*wt,tt+=h*Ut,vt+=h*Ot,ht+=h*It,it+=h*zt,Fe+=h*mn,st+=h*Qt,Ie+=h*tn,Ze+=h*yn,nt+=h*bt,Ve+=h*vn,ae+=h*Rn,oe+=h*Ln,le+=h*nn,h=M[9],Ct+=h*D,Et+=h*Nt,tt+=h*wt,vt+=h*Ut,ht+=h*Ot,it+=h*It,Fe+=h*zt,st+=h*mn,Ie+=h*Qt,Ze+=h*tn,nt+=h*yn,Ve+=h*bt,ae+=h*vn,oe+=h*Rn,le+=h*Ln,ye+=h*nn,h=M[10],Et+=h*D,tt+=h*Nt,vt+=h*wt,ht+=h*Ut,it+=h*Ot,Fe+=h*It,st+=h*zt,Ie+=h*mn,Ze+=h*Qt,nt+=h*tn,Ve+=h*yn,ae+=h*bt,oe+=h*vn,le+=h*Rn,ye+=h*Ln,ge+=h*nn,h=M[11],tt+=h*D,vt+=h*Nt,ht+=h*wt,it+=h*Ut,Fe+=h*Ot,st+=h*It,Ie+=h*zt,Ze+=h*mn,nt+=h*Qt,Ve+=h*tn,ae+=h*yn,oe+=h*bt,le+=h*vn,ye+=h*Rn,ge+=h*Ln,Se+=h*nn,h=M[12],vt+=h*D,ht+=h*Nt,it+=h*wt,Fe+=h*Ut,st+=h*Ot,Ie+=h*It,Ze+=h*zt,nt+=h*mn,Ve+=h*Qt,ae+=h*tn,oe+=h*yn,le+=h*bt,ye+=h*vn,ge+=h*Rn,Se+=h*Ln,mt+=h*nn,h=M[13],ht+=h*D,it+=h*Nt,Fe+=h*wt,st+=h*Ut,Ie+=h*Ot,Ze+=h*It,nt+=h*zt,Ve+=h*mn,ae+=h*Qt,oe+=h*tn,le+=h*yn,ye+=h*bt,ge+=h*vn,Se+=h*Rn,mt+=h*Ln,At+=h*nn,h=M[14],it+=h*D,Fe+=h*Nt,st+=h*wt,Ie+=h*Ut,Ze+=h*Ot,nt+=h*It,Ve+=h*zt,ae+=h*mn,oe+=h*Qt,le+=h*tn,ye+=h*yn,ge+=h*bt,Se+=h*vn,mt+=h*Rn,At+=h*Ln,Mt+=h*nn,h=M[15],Fe+=h*D,st+=h*Nt,Ie+=h*wt,Ze+=h*Ut,nt+=h*Ot,Ve+=h*It,ae+=h*zt,oe+=h*mn,le+=h*Qt,ye+=h*tn,ge+=h*yn,Se+=h*bt,mt+=h*vn,At+=h*Rn,Mt+=h*Ln,jt+=h*nn,Q+=38*st,G+=38*Ie,fe+=38*Ze,_e+=38*nt,at+=38*Ve,Xe+=38*ae,Bt+=38*oe,We+=38*le,pt+=38*ye,Ct+=38*ge,Et+=38*Se,tt+=38*mt,vt+=38*At,ht+=38*Mt,it+=38*jt,A=1,h=Q+A+65535,A=Math.floor(h/65536),Q=h-A*65536,h=G+A+65535,A=Math.floor(h/65536),G=h-A*65536,h=fe+A+65535,A=Math.floor(h/65536),fe=h-A*65536,h=_e+A+65535,A=Math.floor(h/65536),_e=h-A*65536,h=at+A+65535,A=Math.floor(h/65536),at=h-A*65536,h=Xe+A+65535,A=Math.floor(h/65536),Xe=h-A*65536,h=Bt+A+65535,A=Math.floor(h/65536),Bt=h-A*65536,h=We+A+65535,A=Math.floor(h/65536),We=h-A*65536,h=pt+A+65535,A=Math.floor(h/65536),pt=h-A*65536,h=Ct+A+65535,A=Math.floor(h/65536),Ct=h-A*65536,h=Et+A+65535,A=Math.floor(h/65536),Et=h-A*65536,h=tt+A+65535,A=Math.floor(h/65536),tt=h-A*65536,h=vt+A+65535,A=Math.floor(h/65536),vt=h-A*65536,h=ht+A+65535,A=Math.floor(h/65536),ht=h-A*65536,h=it+A+65535,A=Math.floor(h/65536),it=h-A*65536,h=Fe+A+65535,A=Math.floor(h/65536),Fe=h-A*65536,Q+=A-1+37*(A-1),A=1,h=Q+A+65535,A=Math.floor(h/65536),Q=h-A*65536,h=G+A+65535,A=Math.floor(h/65536),G=h-A*65536,h=fe+A+65535,A=Math.floor(h/65536),fe=h-A*65536,h=_e+A+65535,A=Math.floor(h/65536),_e=h-A*65536,h=at+A+65535,A=Math.floor(h/65536),at=h-A*65536,h=Xe+A+65535,A=Math.floor(h/65536),Xe=h-A*65536,h=Bt+A+65535,A=Math.floor(h/65536),Bt=h-A*65536,h=We+A+65535,A=Math.floor(h/65536),We=h-A*65536,h=pt+A+65535,A=Math.floor(h/65536),pt=h-A*65536,h=Ct+A+65535,A=Math.floor(h/65536),Ct=h-A*65536,h=Et+A+65535,A=Math.floor(h/65536),Et=h-A*65536,h=tt+A+65535,A=Math.floor(h/65536),tt=h-A*65536,h=vt+A+65535,A=Math.floor(h/65536),vt=h-A*65536,h=ht+A+65535,A=Math.floor(h/65536),ht=h-A*65536,h=it+A+65535,A=Math.floor(h/65536),it=h-A*65536,h=Fe+A+65535,A=Math.floor(h/65536),Fe=h-A*65536,Q+=A-1+37*(A-1),b[0]=Q,b[1]=G,b[2]=fe,b[3]=_e,b[4]=at,b[5]=Xe,b[6]=Bt,b[7]=We,b[8]=pt,b[9]=Ct,b[10]=Et,b[11]=tt,b[12]=vt,b[13]=ht,b[14]=it,b[15]=Fe}function Ee(b,M){De(b,M,M)}function dt(b,M){var k=i(),h;for(h=0;h<16;h++)k[h]=M[h];for(h=253;h>=0;h--)Ee(k,k),h!==2&&h!==4&&De(k,k,M);for(h=0;h<16;h++)b[h]=k[h]}function kt(b,M){var k=i(),h;for(h=0;h<16;h++)k[h]=M[h];for(h=250;h>=0;h--)Ee(k,k),h!==1&&De(k,k,M);for(h=0;h<16;h++)b[h]=k[h]}function ze(b,M,k){var h=new Uint8Array(32),A=new Float64Array(80),Q,G,fe=i(),_e=i(),at=i(),Xe=i(),Bt=i(),We=i();for(G=0;G<31;G++)h[G]=M[G];for(h[31]=M[31]&127|64,h[0]&=248,de(A,k),G=0;G<16;G++)_e[G]=A[G],Xe[G]=fe[G]=at[G]=0;for(fe[0]=Xe[0]=1,G=254;G>=0;--G)Q=h[G>>>3]>>>(G&7)&1,Ge(fe,_e,Q),Ge(at,Xe,Q),Ce(Bt,fe,at),Le(fe,fe,at),Ce(at,_e,Xe),Le(_e,_e,Xe),Ee(Xe,Bt),Ee(We,fe),De(fe,at,fe),De(at,_e,Bt),Ce(Bt,fe,at),Le(fe,fe,at),Ee(_e,fe),Le(at,Xe,We),De(fe,at,x),Ce(fe,fe,Xe),De(at,at,fe),De(fe,Xe,We),De(Xe,_e,A),Ee(_e,Bt),Ge(fe,_e,Q),Ge(at,Xe,Q);for(G=0;G<16;G++)A[G+16]=fe[G],A[G+32]=at[G],A[G+48]=_e[G],A[G+64]=Xe[G];var pt=A.subarray(32),Ct=A.subarray(16);return dt(pt,pt),De(Ct,Ct,pt),je(b,Ct),0}function ct(b,M){return ze(b,M,m)}function pn(b,M){return s(M,32),ct(b,M)}function Ht(b,M,k){var h=new Uint8Array(32);return ze(h,k,M),Je(b,c,h,ft)}var er=xt,kn=qe;function Xn(b,M,k,h,A,Q){var G=new Uint8Array(32);return Ht(G,A,Q),er(b,M,k,h,G)}function Ti(b,M,k,h,A,Q){var G=new Uint8Array(32);return Ht(G,A,Q),kn(b,M,k,h,G)}var es=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591];function ki(b,M,k,h){for(var A=new Int32Array(16),Q=new Int32Array(16),G,fe,_e,at,Xe,Bt,We,pt,Ct,Et,tt,vt,ht,it,Fe,st,Ie,Ze,nt,Ve,ae,oe,le,ye,ge,Se,mt=b[0],At=b[1],Mt=b[2],jt=b[3],D=b[4],Nt=b[5],wt=b[6],Ut=b[7],Ot=M[0],It=M[1],zt=M[2],mn=M[3],Qt=M[4],tn=M[5],yn=M[6],bt=M[7],vn=0;h>=128;){for(nt=0;nt<16;nt++)Ve=8*nt+vn,A[nt]=k[Ve+0]<<24|k[Ve+1]<<16|k[Ve+2]<<8|k[Ve+3],Q[nt]=k[Ve+4]<<24|k[Ve+5]<<16|k[Ve+6]<<8|k[Ve+7];for(nt=0;nt<80;nt++)if(G=mt,fe=At,_e=Mt,at=jt,Xe=D,Bt=Nt,We=wt,pt=Ut,Ct=Ot,Et=It,tt=zt,vt=mn,ht=Qt,it=tn,Fe=yn,st=bt,ae=Ut,oe=bt,le=oe&65535,ye=oe>>>16,ge=ae&65535,Se=ae>>>16,ae=(D>>>14|Qt<<18)^(D>>>18|Qt<<14)^(Qt>>>9|D<<23),oe=(Qt>>>14|D<<18)^(Qt>>>18|D<<14)^(D>>>9|Qt<<23),le+=oe&65535,ye+=oe>>>16,ge+=ae&65535,Se+=ae>>>16,ae=D&Nt^~D&wt,oe=Qt&tn^~Qt&yn,le+=oe&65535,ye+=oe>>>16,ge+=ae&65535,Se+=ae>>>16,ae=es[nt*2],oe=es[nt*2+1],le+=oe&65535,ye+=oe>>>16,ge+=ae&65535,Se+=ae>>>16,ae=A[nt%16],oe=Q[nt%16],le+=oe&65535,ye+=oe>>>16,ge+=ae&65535,Se+=ae>>>16,ye+=le>>>16,ge+=ye>>>16,Se+=ge>>>16,Ie=ge&65535|Se<<16,Ze=le&65535|ye<<16,ae=Ie,oe=Ze,le=oe&65535,ye=oe>>>16,ge=ae&65535,Se=ae>>>16,ae=(mt>>>28|Ot<<4)^(Ot>>>2|mt<<30)^(Ot>>>7|mt<<25),oe=(Ot>>>28|mt<<4)^(mt>>>2|Ot<<30)^(mt>>>7|Ot<<25),le+=oe&65535,ye+=oe>>>16,ge+=ae&65535,Se+=ae>>>16,ae=mt&At^mt&Mt^At&Mt,oe=Ot&It^Ot&zt^It&zt,le+=oe&65535,ye+=oe>>>16,ge+=ae&65535,Se+=ae>>>16,ye+=le>>>16,ge+=ye>>>16,Se+=ge>>>16,pt=ge&65535|Se<<16,st=le&65535|ye<<16,ae=at,oe=vt,le=oe&65535,ye=oe>>>16,ge=ae&65535,Se=ae>>>16,ae=Ie,oe=Ze,le+=oe&65535,ye+=oe>>>16,ge+=ae&65535,Se+=ae>>>16,ye+=le>>>16,ge+=ye>>>16,Se+=ge>>>16,at=ge&65535|Se<<16,vt=le&65535|ye<<16,At=G,Mt=fe,jt=_e,D=at,Nt=Xe,wt=Bt,Ut=We,mt=pt,It=Ct,zt=Et,mn=tt,Qt=vt,tn=ht,yn=it,bt=Fe,Ot=st,nt%16===15)for(Ve=0;Ve<16;Ve++)ae=A[Ve],oe=Q[Ve],le=oe&65535,ye=oe>>>16,ge=ae&65535,Se=ae>>>16,ae=A[(Ve+9)%16],oe=Q[(Ve+9)%16],le+=oe&65535,ye+=oe>>>16,ge+=ae&65535,Se+=ae>>>16,Ie=A[(Ve+1)%16],Ze=Q[(Ve+1)%16],ae=(Ie>>>1|Ze<<31)^(Ie>>>8|Ze<<24)^Ie>>>7,oe=(Ze>>>1|Ie<<31)^(Ze>>>8|Ie<<24)^(Ze>>>7|Ie<<25),le+=oe&65535,ye+=oe>>>16,ge+=ae&65535,Se+=ae>>>16,Ie=A[(Ve+14)%16],Ze=Q[(Ve+14)%16],ae=(Ie>>>19|Ze<<13)^(Ze>>>29|Ie<<3)^Ie>>>6,oe=(Ze>>>19|Ie<<13)^(Ie>>>29|Ze<<3)^(Ze>>>6|Ie<<26),le+=oe&65535,ye+=oe>>>16,ge+=ae&65535,Se+=ae>>>16,ye+=le>>>16,ge+=ye>>>16,Se+=ge>>>16,A[Ve]=ge&65535|Se<<16,Q[Ve]=le&65535|ye<<16;ae=mt,oe=Ot,le=oe&65535,ye=oe>>>16,ge=ae&65535,Se=ae>>>16,ae=b[0],oe=M[0],le+=oe&65535,ye+=oe>>>16,ge+=ae&65535,Se+=ae>>>16,ye+=le>>>16,ge+=ye>>>16,Se+=ge>>>16,b[0]=mt=ge&65535|Se<<16,M[0]=Ot=le&65535|ye<<16,ae=At,oe=It,le=oe&65535,ye=oe>>>16,ge=ae&65535,Se=ae>>>16,ae=b[1],oe=M[1],le+=oe&65535,ye+=oe>>>16,ge+=ae&65535,Se+=ae>>>16,ye+=le>>>16,ge+=ye>>>16,Se+=ge>>>16,b[1]=At=ge&65535|Se<<16,M[1]=It=le&65535|ye<<16,ae=Mt,oe=zt,le=oe&65535,ye=oe>>>16,ge=ae&65535,Se=ae>>>16,ae=b[2],oe=M[2],le+=oe&65535,ye+=oe>>>16,ge+=ae&65535,Se+=ae>>>16,ye+=le>>>16,ge+=ye>>>16,Se+=ge>>>16,b[2]=Mt=ge&65535|Se<<16,M[2]=zt=le&65535|ye<<16,ae=jt,oe=mn,le=oe&65535,ye=oe>>>16,ge=ae&65535,Se=ae>>>16,ae=b[3],oe=M[3],le+=oe&65535,ye+=oe>>>16,ge+=ae&65535,Se+=ae>>>16,ye+=le>>>16,ge+=ye>>>16,Se+=ge>>>16,b[3]=jt=ge&65535|Se<<16,M[3]=mn=le&65535|ye<<16,ae=D,oe=Qt,le=oe&65535,ye=oe>>>16,ge=ae&65535,Se=ae>>>16,ae=b[4],oe=M[4],le+=oe&65535,ye+=oe>>>16,ge+=ae&65535,Se+=ae>>>16,ye+=le>>>16,ge+=ye>>>16,Se+=ge>>>16,b[4]=D=ge&65535|Se<<16,M[4]=Qt=le&65535|ye<<16,ae=Nt,oe=tn,le=oe&65535,ye=oe>>>16,ge=ae&65535,Se=ae>>>16,ae=b[5],oe=M[5],le+=oe&65535,ye+=oe>>>16,ge+=ae&65535,Se+=ae>>>16,ye+=le>>>16,ge+=ye>>>16,Se+=ge>>>16,b[5]=Nt=ge&65535|Se<<16,M[5]=tn=le&65535|ye<<16,ae=wt,oe=yn,le=oe&65535,ye=oe>>>16,ge=ae&65535,Se=ae>>>16,ae=b[6],oe=M[6],le+=oe&65535,ye+=oe>>>16,ge+=ae&65535,Se+=ae>>>16,ye+=le>>>16,ge+=ye>>>16,Se+=ge>>>16,b[6]=wt=ge&65535|Se<<16,M[6]=yn=le&65535|ye<<16,ae=Ut,oe=bt,le=oe&65535,ye=oe>>>16,ge=ae&65535,Se=ae>>>16,ae=b[7],oe=M[7],le+=oe&65535,ye+=oe>>>16,ge+=ae&65535,Se+=ae>>>16,ye+=le>>>16,ge+=ye>>>16,Se+=ge>>>16,b[7]=Ut=ge&65535|Se<<16,M[7]=bt=le&65535|ye<<16,vn+=128,h-=128}return h}function Nr(b,M,k){var h=new Int32Array(8),A=new Int32Array(8),Q=new Uint8Array(256),G,fe=k;for(h[0]=1779033703,h[1]=3144134277,h[2]=1013904242,h[3]=2773480762,h[4]=1359893119,h[5]=2600822924,h[6]=528734635,h[7]=1541459225,A[0]=4089235720,A[1]=2227873595,A[2]=4271175723,A[3]=1595750129,A[4]=2917565137,A[5]=725511199,A[6]=4215389547,A[7]=327033209,ki(h,A,M,k),k%=128,G=0;G<k;G++)Q[G]=M[fe-k+G];for(Q[k]=128,k=256-128*(k<112?1:0),Q[k-9]=0,ie(Q,k-8,fe/536870912|0,fe<<3),ki(h,A,Q,k),G=0;G<8;G++)ie(b,8*G,h[G],A[G]);return 0}function Pr(b,M){var k=i(),h=i(),A=i(),Q=i(),G=i(),fe=i(),_e=i(),at=i(),Xe=i();Le(k,b[1],b[0]),Le(Xe,M[1],M[0]),De(k,k,Xe),Ce(h,b[0],b[1]),Ce(Xe,M[0],M[1]),De(h,h,Xe),De(A,b[3],M[3]),De(A,A,E),De(Q,b[2],M[2]),Ce(Q,Q,Q),Le(G,h,k),Le(fe,Q,A),Ce(_e,Q,A),Ce(at,h,k),De(b[0],G,fe),De(b[1],at,_e),De(b[2],_e,fe),De(b[3],G,at)}function tr(b,M,k){var h;for(h=0;h<4;h++)Ge(b[h],M[h],k)}function qa(b,M){var k=i(),h=i(),A=i();dt(A,M[2]),De(k,M[0],A),De(h,M[1],A),je(b,h),b[31]^=L(k)<<7}function na(b,M,k){var h,A;for(J(b[0],_),J(b[1],w),J(b[2],w),J(b[3],_),A=255;A>=0;--A)h=k[A/8|0]>>(A&7)&1,tr(b,M,h),Pr(M,b),Pr(b,b),tr(b,M,h)}function Dn(b,M){var k=[i(),i(),i(),i()];J(k[0],R),J(k[1],N),J(k[2],w),De(k[3],R,N),na(b,k,M)}function ra(b,M,k){var h=new Uint8Array(64),A=[i(),i(),i(),i()],Q;for(k||s(M,32),Nr(h,M,32),h[0]&=248,h[31]&=127,h[31]|=64,Dn(A,h),qa(b,A),Q=0;Q<32;Q++)M[Q+32]=b[Q];return 0}var pr=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]);function _r(b,M){var k,h,A,Q;for(h=63;h>=32;--h){for(k=0,A=h-32,Q=h-12;A<Q;++A)M[A]+=k-16*M[h]*pr[A-(h-32)],k=Math.floor((M[A]+128)/256),M[A]-=k*256;M[A]+=k,M[h]=0}for(k=0,A=0;A<32;A++)M[A]+=k-(M[31]>>4)*pr[A],k=M[A]>>8,M[A]&=255;for(A=0;A<32;A++)M[A]-=k*pr[A];for(h=0;h<32;h++)M[h+1]+=M[h]>>8,b[h]=M[h]&255}function qr(b){var M=new Float64Array(64),k;for(k=0;k<64;k++)M[k]=b[k];for(k=0;k<64;k++)b[k]=0;_r(b,M)}function ca(b,M,k,h){var A=new Uint8Array(64),Q=new Uint8Array(64),G=new Uint8Array(64),fe,_e,at=new Float64Array(64),Xe=[i(),i(),i(),i()];Nr(A,h,32),A[0]&=248,A[31]&=127,A[31]|=64;var Bt=k+64;for(fe=0;fe<k;fe++)b[64+fe]=M[fe];for(fe=0;fe<32;fe++)b[32+fe]=A[32+fe];for(Nr(G,b.subarray(32),k+32),qr(G),Dn(Xe,G),qa(b,Xe),fe=32;fe<64;fe++)b[fe]=h[fe];for(Nr(Q,b,k+64),qr(Q),fe=0;fe<64;fe++)at[fe]=0;for(fe=0;fe<32;fe++)at[fe]=G[fe];for(fe=0;fe<32;fe++)for(_e=0;_e<32;_e++)at[fe+_e]+=Q[fe]*A[_e];return _r(b.subarray(32),at),Bt}function Ya(b,M){var k=i(),h=i(),A=i(),Q=i(),G=i(),fe=i(),_e=i();return J(b[2],w),de(b[1],M),Ee(A,b[1]),De(Q,A,S),Le(A,A,b[2]),Ce(Q,b[2],Q),Ee(G,Q),Ee(fe,G),De(_e,fe,G),De(k,_e,A),De(k,k,Q),kt(k,k),De(k,k,A),De(k,k,Q),De(k,k,Q),De(b[0],k,Q),Ee(h,b[0]),De(h,h,Q),Ye(h,A)&&De(b[0],b[0],q),Ee(h,b[0]),De(h,h,Q),Ye(h,A)?-1:(L(b[0])===M[31]>>7&&Le(b[0],_,b[0]),De(b[3],b[0],b[1]),0)}function ua(b,M,k,h){var A,Q=new Uint8Array(32),G=new Uint8Array(64),fe=[i(),i(),i(),i()],_e=[i(),i(),i(),i()];if(k<64||Ya(_e,h))return-1;for(A=0;A<k;A++)b[A]=M[A];for(A=0;A<32;A++)b[A+32]=h[A];if(Nr(G,b,k),qr(G),na(fe,_e,G),Dn(_e,M.subarray(32)),Pr(fe,_e),qa(Q,fe),k-=64,lt(M,0,Q,0)){for(A=0;A<k;A++)b[A]=0;return-1}for(A=0;A<k;A++)b[A]=M[A+64];return k}var Or=32,mr=24,Mn=32,Cn=16,Qe=32,Yr=32,gr=32,Vr=32,He=32,aa=mr,xa=Mn,Dr=Cn,nr=64,rr=32,fa=64,Va=32,Cr=64;r.lowlevel={crypto_core_hsalsa20:Je,crypto_stream_xor:Oe,crypto_stream:en,crypto_stream_salsa20_xor:et,crypto_stream_salsa20:qt,crypto_onetimeauth:pe,crypto_onetimeauth_verify:ue,crypto_verify_16:Re,crypto_verify_32:lt,crypto_secretbox:xt,crypto_secretbox_open:qe,crypto_scalarmult:ze,crypto_scalarmult_base:ct,crypto_box_beforenm:Ht,crypto_box_afternm:er,crypto_box:Xn,crypto_box_open:Ti,crypto_box_keypair:pn,crypto_hash:Nr,crypto_sign:ca,crypto_sign_keypair:ra,crypto_sign_open:ua,crypto_secretbox_KEYBYTES:Or,crypto_secretbox_NONCEBYTES:mr,crypto_secretbox_ZEROBYTES:Mn,crypto_secretbox_BOXZEROBYTES:Cn,crypto_scalarmult_BYTES:Qe,crypto_scalarmult_SCALARBYTES:Yr,crypto_box_PUBLICKEYBYTES:gr,crypto_box_SECRETKEYBYTES:Vr,crypto_box_BEFORENMBYTES:He,crypto_box_NONCEBYTES:aa,crypto_box_ZEROBYTES:xa,crypto_box_BOXZEROBYTES:Dr,crypto_sign_BYTES:nr,crypto_sign_PUBLICKEYBYTES:rr,crypto_sign_SECRETKEYBYTES:fa,crypto_sign_SEEDBYTES:Va,crypto_hash_BYTES:Cr,gf:i,D:S,L:pr,pack25519:je,unpack25519:de,M:De,A:Ce,S:Ee,Z:Le,pow2523:kt,add:Pr,set25519:J,modL:_r,scalarmult:na,scalarbase:Dn};function yr(b,M){if(b.length!==Or)throw new Error("bad key size");if(M.length!==mr)throw new Error("bad nonce size")}function Mi(b,M){if(b.length!==gr)throw new Error("bad public key size");if(M.length!==Vr)throw new Error("bad secret key size")}function zn(){for(var b=0;b<arguments.length;b++)if(!(arguments[b]instanceof Uint8Array))throw new TypeError("unexpected type, use Uint8Array")}function on(b){for(var M=0;M<b.length;M++)b[M]=0}r.randomBytes=function(b){var M=new Uint8Array(b);return s(M,b),M},r.secretbox=function(b,M,k){zn(b,M,k),yr(k,M);for(var h=new Uint8Array(Mn+b.length),A=new Uint8Array(h.length),Q=0;Q<b.length;Q++)h[Q+Mn]=b[Q];return xt(A,h,h.length,M,k),A.subarray(Cn)},r.secretbox.open=function(b,M,k){zn(b,M,k),yr(k,M);for(var h=new Uint8Array(Cn+b.length),A=new Uint8Array(h.length),Q=0;Q<b.length;Q++)h[Q+Cn]=b[Q];return h.length<32||qe(A,h,h.length,M,k)!==0?null:A.subarray(Mn)},r.secretbox.keyLength=Or,r.secretbox.nonceLength=mr,r.secretbox.overheadLength=Cn,r.scalarMult=function(b,M){if(zn(b,M),b.length!==Yr)throw new Error("bad n size");if(M.length!==Qe)throw new Error("bad p size");var k=new Uint8Array(Qe);return ze(k,b,M),k},r.scalarMult.base=function(b){if(zn(b),b.length!==Yr)throw new Error("bad n size");var M=new Uint8Array(Qe);return ct(M,b),M},r.scalarMult.scalarLength=Yr,r.scalarMult.groupElementLength=Qe,r.box=function(b,M,k,h){var A=r.box.before(k,h);return r.secretbox(b,M,A)},r.box.before=function(b,M){zn(b,M),Mi(b,M);var k=new Uint8Array(He);return Ht(k,b,M),k},r.box.after=r.secretbox,r.box.open=function(b,M,k,h){var A=r.box.before(k,h);return r.secretbox.open(b,M,A)},r.box.open.after=r.secretbox.open,r.box.keyPair=function(){var b=new Uint8Array(gr),M=new Uint8Array(Vr);return pn(b,M),{publicKey:b,secretKey:M}},r.box.keyPair.fromSecretKey=function(b){if(zn(b),b.length!==Vr)throw new Error("bad secret key size");var M=new Uint8Array(gr);return ct(M,b),{publicKey:M,secretKey:new Uint8Array(b)}},r.box.publicKeyLength=gr,r.box.secretKeyLength=Vr,r.box.sharedKeyLength=He,r.box.nonceLength=aa,r.box.overheadLength=r.secretbox.overheadLength,r.sign=function(b,M){if(zn(b,M),M.length!==fa)throw new Error("bad secret key size");var k=new Uint8Array(nr+b.length);return ca(k,b,b.length,M),k},r.sign.open=function(b,M){if(zn(b,M),M.length!==rr)throw new Error("bad public key size");var k=new Uint8Array(b.length),h=ua(k,b,b.length,M);if(h<0)return null;for(var A=new Uint8Array(h),Q=0;Q<A.length;Q++)A[Q]=k[Q];return A},r.sign.detached=function(b,M){for(var k=r.sign(b,M),h=new Uint8Array(nr),A=0;A<h.length;A++)h[A]=k[A];return h},r.sign.detached.verify=function(b,M,k){if(zn(b,M,k),M.length!==nr)throw new Error("bad signature size");if(k.length!==rr)throw new Error("bad public key size");var h=new Uint8Array(nr+b.length),A=new Uint8Array(nr+b.length),Q;for(Q=0;Q<nr;Q++)h[Q]=M[Q];for(Q=0;Q<b.length;Q++)h[Q+nr]=b[Q];return ua(A,h,h.length,k)>=0},r.sign.keyPair=function(){var b=new Uint8Array(rr),M=new Uint8Array(fa);return ra(b,M),{publicKey:b,secretKey:M}},r.sign.keyPair.fromSecretKey=function(b){if(zn(b),b.length!==fa)throw new Error("bad secret key size");for(var M=new Uint8Array(rr),k=0;k<M.length;k++)M[k]=b[32+k];return{publicKey:M,secretKey:new Uint8Array(b)}},r.sign.keyPair.fromSeed=function(b){if(zn(b),b.length!==Va)throw new Error("bad seed size");for(var M=new Uint8Array(rr),k=new Uint8Array(fa),h=0;h<32;h++)k[h]=b[h];return ra(M,k,!0),{publicKey:M,secretKey:k}},r.sign.publicKeyLength=rr,r.sign.secretKeyLength=fa,r.sign.seedLength=Va,r.sign.signatureLength=nr,r.hash=function(b){zn(b);var M=new Uint8Array(Cr);return Nr(M,b,b.length),M},r.hash.hashLength=Cr,r.verify=function(b,M){return zn(b,M),b.length===0||M.length===0||b.length!==M.length?!1:se(b,0,M,0,b.length)===0},r.setPRNG=function(b){s=b},(function(){var b=typeof self<"u"?self.crypto||self.msCrypto:null;if(b&&b.getRandomValues){var M=65536;r.setPRNG(function(k,h){var A,Q=new Uint8Array(h);for(A=0;A<h;A+=M)b.getRandomValues(Q.subarray(A,A+Math.min(h-A,M)));for(A=0;A<h;A++)k[A]=Q[A];on(Q)})}else typeof Wy<"u"&&(b=nv,b&&b.randomBytes&&r.setPRNG(function(k,h){var A,Q=b.randomBytes(h);for(A=0;A<h;A++)k[A]=Q[A];on(Q)}))})()})(u.exports?u.exports:self.nacl=self.nacl||{})})(Cf)),Cf.exports}var rv=vm();const ln=Qo(rv);var hc={exports:{}},av=hc.exports,Sp;function iv(){return Sp||(Sp=1,(function(u){(function(r,i){u.exports?u.exports=i():(r.nacl||(r.nacl={}),r.nacl.util=i())})(av,function(){var r={};function i(s){if(!/^(?:[A-Za-z0-9+\/]{2}[A-Za-z0-9+\/]{2})*(?:[A-Za-z0-9+\/]{2}==|[A-Za-z0-9+\/]{3}=)?$/.test(s))throw new TypeError("invalid encoding")}return r.decodeUTF8=function(s){if(typeof s!="string")throw new TypeError("expected string");var c,m=unescape(encodeURIComponent(s)),_=new Uint8Array(m.length);for(c=0;c<m.length;c++)_[c]=m.charCodeAt(c);return _},r.encodeUTF8=function(s){var c,m=[];for(c=0;c<s.length;c++)m.push(String.fromCharCode(s[c]));return decodeURIComponent(escape(m.join("")))},typeof atob>"u"?typeof Buffer.from<"u"?(r.encodeBase64=function(s){return Buffer.from(s).toString("base64")},r.decodeBase64=function(s){return i(s),new Uint8Array(Array.prototype.slice.call(Buffer.from(s,"base64"),0))}):(r.encodeBase64=function(s){return new Buffer(s).toString("base64")},r.decodeBase64=function(s){return i(s),new Uint8Array(Array.prototype.slice.call(new Buffer(s,"base64"),0))}):(r.encodeBase64=function(s){var c,m=[],_=s.length;for(c=0;c<_;c++)m.push(String.fromCharCode(s[c]));return btoa(m.join(""))},r.decodeBase64=function(s){i(s);var c,m=atob(s),_=new Uint8Array(m.length);for(c=0;c<m.length;c++)_[c]=m.charCodeAt(c);return _}),r})})(hc)),hc.exports}var Vt=iv();function Bf(){return ln.randomBytes(24)}function _p(u,r,i,s,c){const m=new Uint8Array(s.length+u.length);m.set(s,0),m.set(u,s.length);const _=ln.box(m,s,i,r),w={type:"handshake-intro",nonce:Vt.encodeBase64(s),payload:Vt.encodeBase64(_)};return c&&(w.pk=Vt.encodeBase64(c)),w}function Cp(u,r,i){try{const s=Vt.decodeBase64(u.nonce),c=Vt.decodeBase64(u.payload),m=ln.box.open(c,s,i,r);if(!m)return console.error("[Handshake] Failed to decrypt intro payload"),null;const _=m.slice(0,24),w=m.slice(24);return lv(_,s)?w.length!==32?(console.error("[Handshake] Invalid ephemeral public key length"),null):{nonce:_,ephemeralPublicKey:w}:(console.error("[Handshake] Nonce mismatch in intro"),null)}catch(s){return console.error("[Handshake] Error validating intro:",s),null}}function sv(u,r){const i=Bf(),s={type:"connected",timestamp:Date.now()},c=new TextEncoder().encode(JSON.stringify(s)),m=ln.secretbox(c,i,u),_=new Uint8Array(i.length+m.length);return _.set(i,0),_.set(m,i.length),{type:"handshake-connected",nonce:r,payload:Vt.encodeBase64(_)}}function ov(u,r){try{const i=Vt.decodeBase64(u.payload),s=i.slice(0,24),c=i.slice(24),m=ln.secretbox.open(c,s,r);if(!m)return console.error("[Handshake] Failed to decrypt connected payload"),null;const _=new TextDecoder().decode(m),w=JSON.parse(_);if(w.type!=="connected"||typeof w.timestamp!="number")return console.error("[Handshake] Invalid connected message structure"),null;const x=Date.now();return Math.abs(x-w.timestamp)>60*1e3?(console.error("[Handshake] Connected message timestamp too old or in future"),null):w}catch(i){return console.error("[Handshake] Error validating connected:",i),null}}function lv(u,r){if(u.length!==r.length)return!1;for(let i=0;i<u.length;i++)if(u[i]!==r[i])return!1;return!0}function cv(u,r,i,s){const c=ln.randomBytes(24),m=ln.randomBytes(24),_={invite_id:r},w=new TextEncoder().encode(JSON.stringify(_)),x=ln.box(w,m,i,s),S=new Uint8Array(24+x.length);return S.set(m,0),S.set(x,24),{invitingId:u,nonce:Vt.encodeBase64(c),payload:Vt.encodeBase64(S)}}function uv(u,r,i){try{const s=Vt.decodeBase64(u);if(s.length<=36)return console.error("[Handshake] PSI payload too short"),null;const c=s.slice(0,24),m=s.slice(24),_=ln.box.open(m,c,r,i);if(!_)return console.error("[Handshake] Failed to decrypt PSI payload"),null;const w=new TextDecoder().decode(_),x=JSON.parse(w);return typeof x.invite_id!="string"?(console.error("[Handshake] Invalid PSI payload structure"),null):{inviteId:x.invite_id}}catch(s){return console.error("[Handshake] Error decrypting PSI payload:",s),null}}function xm(u){return ln.hash(u).slice(0,32)}const bm=ln.hash(new TextEncoder().encode("chat-invite-pk-encryption")).slice(0,24);function Sm(u,r){return ln.secretbox(u,bm,r)}function Ep(u,r){try{const i=ln.secretbox.open(u,bm,r);return i?i.length!==32?(console.error("[Handshake] Invalid decrypted identity PK length:",i.length),null):i:(console.error("[Handshake] Failed to decrypt identity PK"),null)}catch(i){return console.error("[Handshake] Error decrypting identity PK:",i),null}}function fv(u,r){const i=new Uint8Array(u.length+r.length);return i.set(u,0),i.set(r,u.length),ln.hash(i).slice(0,24)}function dv(u,r,i,s){const c=Sm(i,s);return{type:"handshake-invite",nonce:Vt.encodeBase64(u),payload:r,pk:Vt.encodeBase64(c)}}function hv(u){return{type:"handshake-invite",nonce:"",payload:u}}var pc={exports:{}},pv=pc.exports,wp;function mv(){return wp||(wp=1,(function(u){(function(r,i){u.exports?u.exports=i(vm()):r.ed2curve=i(r.nacl)})(pv,function(r){if(!r)throw new Error("tweetnacl not loaded");var i=function(Oe){var Te,pe=new Float64Array(16);if(Oe)for(Te=0;Te<Oe.length;Te++)pe[Te]=Oe[Te];return pe},s=i(),c=i([1]),m=i([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),_=i([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function w(Oe){var Te,pe;for(pe=0;pe<16;pe++)Oe[pe]+=65536,Te=Math.floor(Oe[pe]/65536),Oe[(pe+1)*(pe<15?1:0)]+=Te-1+37*(Te-1)*(pe===15?1:0),Oe[pe]-=Te*65536}function x(Oe,Te,pe){for(var ue,xt=~(pe-1),qe=0;qe<16;qe++)ue=xt&(Oe[qe]^Te[qe]),Oe[qe]^=ue,Te[qe]^=ue}function S(Oe,Te){var pe;for(pe=0;pe<16;pe++)Oe[pe]=Te[2*pe]+(Te[2*pe+1]<<8);Oe[15]&=32767}function E(Oe,Te,pe){var ue;for(ue=0;ue<16;ue++)Oe[ue]=Te[ue]+pe[ue]|0}function R(Oe,Te,pe){var ue;for(ue=0;ue<16;ue++)Oe[ue]=Te[ue]-pe[ue]|0}function N(Oe,Te,pe){var ue,xt,qe=new Float64Array(31);for(ue=0;ue<31;ue++)qe[ue]=0;for(ue=0;ue<16;ue++)for(xt=0;xt<16;xt++)qe[ue+xt]+=Te[ue]*pe[xt];for(ue=0;ue<15;ue++)qe[ue]+=38*qe[ue+16];for(ue=0;ue<16;ue++)Oe[ue]=qe[ue];w(Oe),w(Oe)}function q(Oe,Te){N(Oe,Te,Te)}function ie(Oe,Te){var pe=i(),ue;for(ue=0;ue<16;ue++)pe[ue]=Te[ue];for(ue=253;ue>=0;ue--)q(pe,pe),ue!==2&&ue!==4&&N(pe,pe,Te);for(ue=0;ue<16;ue++)Oe[ue]=pe[ue]}function se(Oe,Te){var pe,ue,xt,qe=i(),J=i();for(pe=0;pe<16;pe++)J[pe]=Te[pe];for(w(J),w(J),w(J),ue=0;ue<2;ue++){for(qe[0]=J[0]-65517,pe=1;pe<15;pe++)qe[pe]=J[pe]-65535-(qe[pe-1]>>16&1),qe[pe-1]&=65535;qe[15]=J[15]-32767-(qe[14]>>16&1),xt=qe[15]>>16&1,qe[14]&=65535,x(J,qe,1-xt)}for(pe=0;pe<16;pe++)Oe[2*pe]=J[pe]&255,Oe[2*pe+1]=J[pe]>>8}function Re(Oe){var Te=new Uint8Array(32);return se(Te,Oe),Te[0]&1}function lt(Oe,Te,pe,ue,xt){var qe,J=0;for(qe=0;qe<xt;qe++)J|=Oe[Te+qe]^pe[ue+qe];return(1&J-1>>>8)-1}function ke(Oe,Te,pe,ue){return lt(Oe,Te,pe,ue,32)}function we(Oe,Te){var pe=new Uint8Array(32),ue=new Uint8Array(32);return se(pe,Oe),se(ue,Te),ke(pe,0,ue,0)}function $e(Oe,Te){var pe=i(),ue;for(ue=0;ue<16;ue++)pe[ue]=Te[ue];for(ue=250;ue>=0;ue--)q(pe,pe),ue!==1&&N(pe,pe,Te);for(ue=0;ue<16;ue++)Oe[ue]=pe[ue]}function Je(Oe,Te){var pe;for(pe=0;pe<16;pe++)Oe[pe]=Te[pe]|0}function ft(Oe,Te){var pe=i(),ue=i(),xt=i(),qe=i(),J=i(),Me=i(),Ge=i();return Je(Oe[2],c),S(Oe[1],Te),q(xt,Oe[1]),N(qe,xt,m),R(xt,xt,Oe[2]),E(qe,Oe[2],qe),q(J,qe),q(Me,J),N(Ge,Me,J),N(pe,Ge,xt),N(pe,pe,qe),$e(pe,pe),N(pe,pe,xt),N(pe,pe,qe),N(pe,pe,qe),N(Oe[0],pe,qe),q(ue,Oe[0]),N(ue,ue,qe),we(ue,xt)&&N(Oe[0],Oe[0],_),q(ue,Oe[0]),N(ue,ue,qe),we(ue,xt)?-1:(Re(Oe[0])===Te[31]>>7&&R(Oe[0],s,Oe[0]),N(Oe[3],Oe[0],Oe[1]),0)}function et(Oe){var Te=new Uint8Array(32),pe=[i(),i(),i(),i()],ue=i(),xt=i();if(ft(pe,Oe))return null;var qe=pe[1];return E(ue,c,qe),R(xt,c,qe),ie(xt,xt),N(ue,ue,xt),se(Te,ue),Te}function qt(Oe){var Te=new Uint8Array(64),pe=new Uint8Array(32),ue;for(r.lowlevel.crypto_hash(Te,Oe,32),Te[0]&=248,Te[31]&=127,Te[31]|=64,ue=0;ue<32;ue++)pe[ue]=Te[ue];for(ue=0;ue<64;ue++)Te[ue]=0;return pe}function en(Oe){var Te=et(Oe.publicKey);return Te?{publicKey:Te,secretKey:qt(Oe.secretKey)}:null}return{convertPublicKey:et,convertSecretKey:qt,convertKeyPair:en}})})(pc)),pc.exports}var gv=mv();const _m=Qo(gv);class bc{identityKeypair;constructor(r){this.identityKeypair=r}static generate(){const r=ln.sign.keyPair();return new bc(r)}static fromPrivateKey(r){const i=Vt.decodeBase64(r);if(i.length!==64)throw new Error("Invalid identity private key length");const s=ln.sign.keyPair.fromSecretKey(i);return new bc(s)}get publicKey(){return Vt.encodeBase64(this.identityKeypair.publicKey)}get secretKey(){return Vt.encodeBase64(this.identityKeypair.secretKey)}get userId(){const r=ln.hash(this.identityKeypair.publicKey);return Array.from(r.slice(0,8)).map(i=>i.toString(16).padStart(2,"0")).join("")}export(){return{userId:this.userId,publicKey:this.publicKey,secretKey:this.secretKey,profile:{}}}sign(r){return ln.sign.detached(r,this.identityKeypair.secretKey)}static verify(r,i,s){return ln.sign.detached.verify(r,i,s)}exportForSharing(){return JSON.stringify({version:1,publicKey:this.publicKey})}}function Cm(u){const r=Vt.decodeBase64(u),i=ln.hash(r);return Array.from(i.slice(0,8)).map(s=>s.toString(16).padStart(2,"0")).join("")}function Uf(u,r){return Cm(r)===u}function Yo(u){const r=_m.convertPublicKey(u);if(!r)throw new Error("Failed to derive encryption public key");return r}function Em(u){const r=_m.convertSecretKey(u);if(!r)throw new Error("Failed to derive encryption secret key");return r}class Ef{inviteId;introNonce;inviteeNonceStr;symmetricKey;isInvitedParty;isExistingContact;peerIdentityPK;constructor(r,i,s,c,m=!1){this.inviteId=r,this.symmetricKey=xm(i),this.introNonce=fv(s,i),this.inviteeNonceStr=Vt.encodeBase64(s),this.isInvitedParty=c,this.isExistingContact=m}deriveIntroNonce(){return this.introNonce}deriveSymmetricKey(){return this.symmetricKey}destroy(){this.symmetricKey.fill(0),this.introNonce.fill(0),this.peerIdentityPK&&this.peerIdentityPK.fill(0)}}class yv{handshakeStates=new Map;completedSessionNonce=new Map;myIdentity=null;thisEncryptionSK=null;signalSender=null;onHandshakeComplete=null;onHandshakeStatus=null;getPeerPublicKey=null;getInviteCallback=null;markInviteUsedCallback=null;createContactFromInviteCallback=null;onInviteRejectedCallback=null;thisIdentityPK=null;thisEncryptionPK=null;timeoutMs;sessionExpiryMs;constructor(r,i){this.timeoutMs=r,this.sessionExpiryMs=i}createState(r,i,s){const c=Vt.decodeBase64(i),m=Yo(c);return{peerId:r,peerIdentityPK:i,sentIntro:!1,receivedIntro:!1,sentConnected:!1,receivedConnected:!1,nonce:s,startedAt:Date.now(),session:{thisEphemeral:ln.box.keyPair(),peerEphemeral:null,sessionKey:new Uint8Array(32),expiresAt:0,thisEncryptionSK:this.thisEncryptionSK,peerEncryptionPK:m}}}checkAndHandleTimeout(r){const i=this.handshakeStates.get(r);return i&&Date.now()>i.startedAt+this.timeoutMs?(this.handleHandshakeTimeout(r),!0):!1}initialize(r){this.myIdentity=r;const i=Vt.decodeBase64(r.secretKey),s=Vt.decodeBase64(r.publicKey);this.thisEncryptionSK=Em(i),this.thisEncryptionPK=Yo(s),this.thisIdentityPK=s,console.log("[HandshakeCoordinator] Initialized for user:",r.userId.substring(0,8))}setSignalSender(r){this.signalSender=r}setOnHandshakeComplete(r){this.onHandshakeComplete=r}setOnHandshakeStatus(r){this.onHandshakeStatus=r}setGetPeerPublicKey(r){this.getPeerPublicKey=r}setGetInviteCallback(r){this.getInviteCallback=r}setMarkInviteUsedCallback(r){this.markInviteUsedCallback=r}setCreateContactFromInviteCallback(r){this.createContactFromInviteCallback=r}setOnInviteRejectedCallback(r){this.onInviteRejectedCallback=r}isHandshakeInProgress(r){return this.handshakeStates.has(r)}async initiateHandshakeIfNotRunning(r,i){this.isHandshakeInProgress(r)&&!this.checkAndHandleTimeout(r)||await this.initiateHandshake(r,i)}async initiateHandshake(r,i){if(!this.myIdentity){console.error("[HandshakeCoordinator] Not initialized");return}if(!this.signalSender){console.error("[HandshakeCoordinator] No signal sender configured");return}console.log("[HandshakeCoordinator] Initiating handshake with:",r.substring(0,8)),this.clearHandshakeState(r),this.completedSessionNonce.delete(r),this.onHandshakeStatus?.(r,"started");const s=this.createState(r,i);this.handshakeStates.set(r,s),await this.sendIntroMessage(r)}async sendIntroMessage(r){if(!this.myIdentity||!this.signalSender)return;const i=this.handshakeStates.get(r);if(i)try{i.nonce||(i.nonce=Vt.encodeBase64(Bf()));const s=_p(i.session.thisEphemeral.publicKey,i.session.thisEncryptionSK,i.session.peerEncryptionPK,Vt.decodeBase64(i.nonce));await this.signalSender(r,s),i.sentIntro=!0,console.log("[HandshakeCoordinator] Sent handshake-intro to:",r.substring(0,8),"with nonce:",i.nonce.substring(0,8))}catch(s){console.error("[HandshakeCoordinator] Failed to send intro:",s)}}async sendConnectedMessage(r){if(!this.myIdentity||!this.signalSender)return;const i=this.handshakeStates.get(r);if(i)try{const s=sv(i.session.sessionKey,i.nonce);await this.signalSender(r,s),i.sentConnected=!0,console.log("[HandshakeCoordinator] Sent handshake-connected to:",r.substring(0,8),"with nonce:",i.nonce?.substring(0,8))}catch(s){console.error("[HandshakeCoordinator] Failed to send connected:",s)}}async handleHandshakeMessage(r,i){if(!this.myIdentity){console.error("[HandshakeCoordinator] Not initialized");return}i.type==="handshake-invite"?i.nonce===""?this.handleInviteRejection(r,i.payload):await this.handleInviteMessage(r,i):i.type==="handshake-intro"?await this.handleIntroMessage(r,i):i.type==="handshake-connected"&&await this.handleConnectedMessage(r,i)}async initiateFromPSI(r){if(!this.myIdentity||!this.signalSender||!this.thisIdentityPK){console.error("[HandshakeCoordinator] Not initialized for invite");return}const i=r.invitingId;console.log("[HandshakeCoordinator] Initiating handshake from PSI to:",i.substring(0,8)),this.clearHandshakeState(i),this.completedSessionNonce.delete(i);const s=Vt.decodeBase64(r.nonce),c=Bf(),m=new Ef("",s,c,!0),_={peerId:i,peerIdentityPK:"",sentIntro:!1,receivedIntro:!1,sentConnected:!1,receivedConnected:!1,startedAt:Date.now(),session:{thisEphemeral:ln.box.keyPair(),peerEphemeral:null,sessionKey:new Uint8Array(32),expiresAt:0,thisEncryptionSK:this.thisEncryptionSK,peerEncryptionPK:new Uint8Array(32)},invite:m};this.handshakeStates.set(i,_),this.onHandshakeStatus?.(i,"started");const w=m.deriveSymmetricKey(),x=dv(c,r.payload,this.thisIdentityPK,w);try{await this.signalSender(i,x),console.log("[HandshakeCoordinator] Sent handshake-invite to:",i.substring(0,8))}catch(S){console.error("[HandshakeCoordinator] Failed to send handshake-invite:",S),this.handleHandshakeFailed(i)}}async handleInviteMessage(r,i){if(!this.myIdentity||!this.signalSender||!this.thisEncryptionSK||!this.thisEncryptionPK||!this.thisIdentityPK){console.error("[HandshakeCoordinator] Not initialized for invite handling");return}console.log("[HandshakeCoordinator] Received handshake-invite from:",r.substring(0,8));const s=this.handshakeStates.get(r);if(s?.invite){if(s.invite.inviteeNonceStr===i.nonce){s.invite.isInvitedParty?console.log("[HandshakeCoordinator] Invitee nonce collision, invited flow takes over (already processing)"):(console.log("[HandshakeCoordinator] Resending intro for existing invite session"),await this.sendInviteIntroMessage(r));return}console.log("[HandshakeCoordinator] New invite nonce, resetting session"),this.clearHandshakeState(r)}const c=Vt.decodeBase64(i.nonce),m=i.payload,_=i.pk?Vt.decodeBase64(i.pk):null;if(!_){console.error("[HandshakeCoordinator] Invite message missing pk field"),await this.sendInviteRejection(r,"Missing identity key");return}const w=uv(m,this.thisEncryptionPK,this.thisEncryptionSK);if(!w){console.error("[HandshakeCoordinator] Failed to decrypt invite payload"),await this.sendInviteRejection(r,"Invalid invite");return}const x=w.inviteId;if(console.log("[HandshakeCoordinator] Decrypted invite ID:",x),!this.getInviteCallback){console.error("[HandshakeCoordinator] No getInviteCallback configured"),await this.sendInviteRejection(r,"Server error");return}const S=await this.getInviteCallback(x,r);if(typeof S=="string"){console.log("[HandshakeCoordinator] Peer is existing contact, skipping invite validation");const ke=S,we=new Ef("",new Uint8Array(24),c,!1,!0),$e=this.createState(r,ke,Vt.encodeBase64(c));$e.invite=we,this.handshakeStates.set(r,$e),this.onHandshakeStatus?.(r,"started"),await this.sendIntroMessage(r);return}if(!S){console.error("[HandshakeCoordinator] Invite not found:",x),await this.sendInviteRejection(r,"Invalid invite");return}const E=S,R=Vt.decodeBase64(E.nonce);if(!E.valid){console.log("[HandshakeCoordinator] Invite is invalidated"),await this.sendInviteRejection(r,"Invite no longer valid");return}if(E.expiry&&Date.now()>E.expiry){console.log("[HandshakeCoordinator] Invite has expired"),await this.sendInviteRejection(r,"Invite expired");return}if(E.useLimit!==void 0&&E.useCount>=E.useLimit){console.log("[HandshakeCoordinator] Invite use limit exceeded"),await this.sendInviteRejection(r,"Invite use limit reached");return}const N=xm(R),q=Ep(_,N);if(!q){console.error("[HandshakeCoordinator] Failed to decrypt peer identity PK"),await this.sendInviteRejection(r,"Decryption error");return}const ie=Vt.encodeBase64(q);if(!Uf(r,ie)){console.error("[HandshakeCoordinator] Peer identity mismatch: userId does not match publicKey"),await this.sendInviteRejection(r,"Identity verification failed");return}const se=Yo(q);console.log("[HandshakeCoordinator] Invite validated, peer identity:",ie.substring(0,16));const Re=new Ef(E.inviteId,R,c,!1);Re.peerIdentityPK=q;const lt={peerId:r,peerIdentityPK:ie,sentIntro:!1,receivedIntro:!1,sentConnected:!1,receivedConnected:!1,startedAt:Date.now(),session:{thisEphemeral:ln.box.keyPair(),peerEphemeral:null,sessionKey:new Uint8Array(32),expiresAt:0,thisEncryptionSK:this.thisEncryptionSK,peerEncryptionPK:se},invite:Re};lt.nonce=Vt.encodeBase64(Re.deriveIntroNonce()),this.handshakeStates.set(r,lt),this.onHandshakeStatus?.(r,"started"),await this.sendInviteIntroMessage(r)}async sendInviteIntroMessage(r){if(!this.myIdentity||!this.signalSender||!this.thisIdentityPK)return;const i=this.handshakeStates.get(r);if(!(!i||!i.invite))try{const s=i.invite.deriveIntroNonce(),c=i.invite.deriveSymmetricKey(),m=Sm(this.thisIdentityPK,c),_=_p(i.session.thisEphemeral.publicKey,i.session.thisEncryptionSK,i.session.peerEncryptionPK,s,m);await this.signalSender(r,_),i.sentIntro=!0,i.nonce=Vt.encodeBase64(s),console.log("[HandshakeCoordinator] Sent invite handshake-intro to:",r.substring(0,8),"with derived nonce")}catch(s){console.error("[HandshakeCoordinator] Failed to send invite intro:",s)}}async sendInviteRejection(r,i){if(this.signalSender)try{const s=hv(i);await this.signalSender(r,s),console.log("[HandshakeCoordinator] Sent invite rejection to:",r.substring(0,8),"reason:",i)}catch(s){console.error("[HandshakeCoordinator] Failed to send rejection:",s)}}handleInviteRejection(r,i){console.log("[HandshakeCoordinator] Invite rejected by:",r.substring(0,8),"reason:",i),this.handshakeStates.get(r)?.invite?.isInvitedParty&&this.onInviteRejectedCallback?.(r,i),this.completedSessionNonce.delete(r),this.clearHandshakeState(r),this.onHandshakeStatus?.(r,"failed",i)}async handleIntroMessage(r,i){if(!this.myIdentity||!this.signalSender)return;console.log("[HandshakeCoordinator] Received handshake-intro from:",r.substring(0,8),"nonce:",i.nonce?.substring(0,8)),this.checkAndHandleTimeout(r);const s=this.handshakeStates.get(r),c=i.nonce,m=s?.nonce,_=this.completedSessionNonce.get(r);if(s?.invite?.isInvitedParty&&!s.peerIdentityPK){await this.handleInviteIntroAsInvitedParty(r,i,s);return}let x=this.getPeerPublicKey?.(r);if(!x&&s?.invite&&!s.invite.isInvitedParty&&(x=s.peerIdentityPK),!x){console.error("[HandshakeCoordinator] Peer public key not found for:",r.substring(0,8));return}if(!m&&_&&c===_){console.log("[HandshakeCoordinator] Ignoring stale intro from completed session. Nonce:",c.substring(0,8));return}const S=s?.invite!==void 0;if(!(!m||c===m||c>m||S)){console.log("[HandshakeCoordinator] Ignoring intro with lower nonce. My nonce:",m?.substring(0,8),"Peer nonce:",c.substring(0,8));return}m&&c!==m&&!S&&s&&(console.log("[HandshakeCoordinator] Adopting higher nonce. My nonce:",m?.substring(0,8),"-> Peer nonce:",c.substring(0,8)),s.nonce=c,s.sentIntro=!1,s.sentConnected=!1,s.receivedConnected=!1);let N=this.handshakeStates.get(r);N||(N=this.createState(r,x,c),this.handshakeStates.set(r,N),this.onHandshakeStatus?.(r,"started"));const q=Cp(i,N.session.thisEncryptionSK,N.session.peerEncryptionPK);if(!q){console.error("[HandshakeCoordinator] Failed to validate intro"),this.handleHandshakeFailed(r);return}if(N.receivedIntro=!0,!N.session.peerEphemeral)try{const ie=ln.box.before(q.ephemeralPublicKey,N.session.thisEphemeral.secretKey);N.session.sessionKey=ie,N.session.peerEphemeral=q.ephemeralPublicKey,N.session.expiresAt=Date.now()+this.sessionExpiryMs,console.log("[HandshakeCoordinator] Session key derived for:",r.substring(0,8))}catch(ie){console.error("[HandshakeCoordinator] Failed to derive session key:",ie),this.handleHandshakeFailed(r);return}N.sentIntro||(N.invite&&!N.invite.isInvitedParty&&!N.invite.isExistingContact?await this.sendInviteIntroMessage(r):await this.sendIntroMessage(r)),await this.sendConnectedMessage(r),this.checkHandshakeComplete(r)}async handleInviteIntroAsInvitedParty(r,i,s){if(!this.myIdentity||!this.signalSender||!s.invite)return;console.log("[HandshakeCoordinator] Processing invite intro as invited party from:",r.substring(0,8));const c=s.invite.deriveIntroNonce(),m=Vt.decodeBase64(i.nonce);let _=c.length===m.length;if(_){for(let q=0;q<c.length;q++)if(c[q]!==m[q]){_=!1;break}}if(!_){console.error("[HandshakeCoordinator] Derived nonce mismatch in invite flow"),this.handleHandshakeFailed(r);return}if(!i.pk){console.error("[HandshakeCoordinator] Invite intro missing pk field"),this.handleHandshakeFailed(r);return}const w=Vt.decodeBase64(i.pk),x=s.invite.deriveSymmetricKey(),S=Ep(w,x);if(!S){console.error("[HandshakeCoordinator] Failed to decrypt inviting party identity PK"),this.handleHandshakeFailed(r);return}const E=Vt.encodeBase64(S);if(!Uf(r,E)){console.error("[HandshakeCoordinator] Peer identity mismatch: userId does not match publicKey"),this.handleHandshakeFailed(r);return}const R=Yo(S);s.peerIdentityPK=E,s.session.peerEncryptionPK=R,s.invite.peerIdentityPK=S,s.nonce=i.nonce,console.log("[HandshakeCoordinator] Learned inviting party identity:",E.substring(0,16));const N=Cp(i,s.session.thisEncryptionSK,R);if(!N){console.error("[HandshakeCoordinator] Failed to validate invite intro payload"),this.handleHandshakeFailed(r);return}if(s.receivedIntro=!0,!s.session.peerEphemeral)try{const q=ln.box.before(N.ephemeralPublicKey,s.session.thisEphemeral.secretKey);s.session.sessionKey=q,s.session.peerEphemeral=N.ephemeralPublicKey,s.session.expiresAt=Date.now()+this.sessionExpiryMs,console.log("[HandshakeCoordinator] Session key derived (invite) for:",r.substring(0,8))}catch(q){console.error("[HandshakeCoordinator] Failed to derive session key:",q),this.handleHandshakeFailed(r);return}s.sentIntro||await this.sendInviteIntroMessage(r),await this.sendConnectedMessage(r),this.checkHandshakeComplete(r)}async handleConnectedMessage(r,i){if(!this.myIdentity||!this.signalSender)return;console.log("[HandshakeCoordinator] Received handshake-connected from:",r.substring(0,8),"with nonce:",i.nonce?.substring(0,8));const s=i.nonce,c=this.completedSessionNonce.get(r),m=this.handshakeStates.get(r);if(!m){c&&s===c?console.log("[HandshakeCoordinator] Ignoring stale connected from completed session. Nonce:",s?.substring(0,8)):console.log("[HandshakeCoordinator] No handshake state found - likely from old handshake, ignoring");return}if(!s||s!==m.nonce){console.log("[HandshakeCoordinator] Nonce mismatch - message from old handshake. Expected:",m.nonce?.substring(0,8),"Got:",s?.substring(0,8));return}if(!ov(i,m.session.sessionKey)){console.error("[HandshakeCoordinator] Failed to validate connected message"),this.handleHandshakeFailed(r);return}m.receivedConnected=!0,m.sentConnected||await this.sendConnectedMessage(r),this.checkHandshakeComplete(r)}async checkHandshakeComplete(r){const i=this.handshakeStates.get(r);!i?.receivedIntro||!i.receivedConnected||(i.nonce&&this.completedSessionNonce.set(r,i.nonce),console.log("[HandshakeCoordinator]  Handshake complete with:",r.substring(0,8)),i.invite&&!i.invite.isExistingContact&&await this.handleInviteCompletion(r,i),this.onHandshakeComplete?.(r,i.session.sessionKey,i.session.expiresAt),this.onHandshakeStatus?.(r,"complete"),this.clearHandshakeState(r))}async handleInviteCompletion(r,i){if(!i.invite)return;const s=i.invite,c=i.peerIdentityPK;if(console.log("[HandshakeCoordinator] Completing invite handshake, isInvitedParty:",s.isInvitedParty),this.createContactFromInviteCallback&&c)try{await this.createContactFromInviteCallback(r,c,s.inviteId,s.isInvitedParty),console.log("[HandshakeCoordinator] Contact created from invite for:",r.substring(0,8))}catch(m){console.error("[HandshakeCoordinator] Failed to create contact from invite:",m)}if(!s.isInvitedParty&&s.inviteId&&this.markInviteUsedCallback)try{await this.markInviteUsedCallback(s.inviteId),console.log("[HandshakeCoordinator] Invite use count incremented:",s.inviteId)}catch(m){console.error("[HandshakeCoordinator] Failed to increment invite use count:",m)}}clearHandshakeState(r){const i=this.handshakeStates.get(r);i&&(i.session.sessionKey.fill(0),i.session.thisEphemeral.secretKey.fill(0),i.invite&&i.invite.destroy()),this.handshakeStates.delete(r)}handleHandshakeTimeout(r){console.error("[HandshakeCoordinator] Handshake timeout for:",r.substring(0,8)),this.completedSessionNonce.delete(r),this.clearHandshakeState(r),this.onHandshakeStatus?.(r,"timeout")}handleHandshakeFailed(r){console.error("[HandshakeCoordinator] Handshake failed for:",r.substring(0,8)),this.completedSessionNonce.delete(r),this.clearHandshakeState(r),this.onHandshakeStatus?.(r,"failed")}cancelHandshake(r){this.handshakeStates.has(r)&&(console.log("[HandshakeCoordinator] Cancelling handshake for:",r.substring(0,8)),this.completedSessionNonce.delete(r),this.clearHandshakeState(r))}destroy(){this.handshakeStates.forEach((r,i)=>{this.clearHandshakeState(i)}),this.completedSessionNonce.clear(),this.thisEncryptionSK&&(this.thisEncryptionSK.fill(0),this.thisEncryptionSK=null),this.thisEncryptionPK&&(this.thisEncryptionPK.fill(0),this.thisEncryptionPK=null),this.thisIdentityPK&&(this.thisIdentityPK.fill(0),this.thisIdentityPK=null),this.onHandshakeComplete=null,this.onHandshakeStatus=null,this.getPeerPublicKey=null,this.getInviteCallback=null,this.markInviteUsedCallback=null,this.createContactFromInviteCallback=null,this.onInviteRejectedCallback=null}}class vv{sessionKey;sendCounter;receiveCounter;constructor(r){this.sessionKey=r,this.sendCounter=0,this.receiveCounter=0}encrypt(r){const i=new TextEncoder().encode(r),s=this.generateNonce(),c=ln.secretbox(i,s,this.sessionKey);return this.sendCounter++,{ciphertext:Vt.encodeBase64(c),nonce:Vt.encodeBase64(s),timestamp:Date.now()}}decrypt(r){const i=Vt.decodeBase64(r.ciphertext),s=Vt.decodeBase64(r.nonce),c=ln.secretbox.open(i,s,this.sessionKey);if(!c)throw new Error("Decryption failed - message may be tampered or session key invalid");return this.receiveCounter++,new TextDecoder().decode(c)}encryptBytes(r){const i=this.generateNonce(),s=ln.secretbox(r,i,this.sessionKey);this.sendCounter++;const c=new Uint8Array(i.length+s.length);return c.set(i,0),c.set(s,i.length),c}decryptBytes(r){if(r.length<24)throw new Error("Data too short - missing nonce");const i=r.slice(0,24),s=r.slice(24),c=ln.secretbox.open(s,i,this.sessionKey);if(!c)throw new Error("Decryption failed - message may be tampered or session key invalid");return this.receiveCounter++,c}generateNonce(){return ln.randomBytes(24)}getSendCounter(){return this.sendCounter}getReceiveCounter(){return this.receiveCounter}destroy(){this.sessionKey.fill(0)}}class mc extends Error{code="SESSION_EXPIRED";peerId;constructor(r){super(`Session expired for peer: ${r}`),this.name="SessionExpiredError",this.peerId=r}}class gc extends Error{code="NO_SESSION";peerId;constructor(r){super(`No session for peer: ${r}`),this.name="NoSessionError",this.peerId=r}}class Lf extends Error{code="CORRUPTED_PAYLOAD";peerId;cause;constructor(r,i){super(`Corrupted signal payload from peer: ${r}`),this.name="CorruptedPayloadError",this.peerId=r,this.cause=i}}class Hf extends Error{code="INCORRECT_SESSION_KEY";peerId;cause;constructor(r,i){super(`Cannot parse signal from peer ${r} - possible session key mismatch`),this.name="IncorrectSessionKeyError",this.peerId=r,this.cause=i}}const xv=[{urls:"stun:stun.l.google.com:19302"},{urls:"stun:stun1.l.google.com:19302"},{urls:"stun:global.stun.twilio.com:3478"},{urls:"stun:stun.cloudflare.com:3478"}];class bv{connection;msgChannel;pendingIceCandidates=[];callbacks;destroyed=!1;constructor(r){this.callbacks=r,this.connection=new RTCPeerConnection({iceServers:xv}),this.setupConnectionHandlers(),this.msgChannel=this.connection.createDataChannel("messages",{ordered:!0,negotiated:!0,id:1}),this.setupMessageChannel()}setState(r){this.callbacks.onStateChange(r)}setupConnectionHandlers(){this.connection.onconnectionstatechange=()=>{if(this.destroyed)return;const r=this.connection.connectionState;console.log("[WebRtcConnection] connectionState:",r)},this.connection.onsignalingstatechange=()=>{this.destroyed||console.log("[WebRtcConnection] signalingState:",this.connection.signalingState)},this.connection.oniceconnectionstatechange=()=>{this.destroyed||console.log("[WebRtcConnection] iceConnectionState:",this.connection.iceConnectionState)},this.connection.onicegatheringstatechange=()=>{this.destroyed||console.log("[WebRtcConnection] iceGatheringState:",this.connection.iceGatheringState)},this.connection.onicecandidate=r=>{this.destroyed||(r.candidate?(console.log("[WebRtcConnection]  ICE candidate:",r.candidate.candidate?.substring(0,50)),this.callbacks.onSignal({ice:r.candidate.toJSON()})):console.log("[WebRtcConnection] ICE gathering complete"))},this.connection.ondatachannel=r=>{this.destroyed||console.log("[WebRtcConnection] Received data channel:",r.channel.label)}}setupMessageChannel(){const r=this.msgChannel;r.binaryType="arraybuffer",r.onopen=()=>{this.destroyed||(console.log("[WebRtcConnection] Message channel opened"),this.setState("connected"))},r.onclose=()=>{this.destroyed||(console.log("[WebRtcConnection] Message channel closed"),this.setState("disconnected"))},r.onerror=i=>{this.destroyed||(console.error("[WebRtcConnection] Message channel error:",i),this.setState("failed"))},r.onmessage=i=>{if(this.destroyed)return;const s=new Uint8Array(i.data);this.callbacks.onData(s)}}async initiateConnection(){if(this.destroyed)throw new Error("Connection destroyed");console.log("[WebRtcConnection] Initiating connection (creating offer)");const r=await this.connection.createOffer();await this.connection.setLocalDescription(r),this.callbacks.onSignal({offer:r})}async handleSignal(r){if(this.destroyed){console.warn("[WebRtcConnection] Ignoring signal - connection destroyed");return}const i=this.connection.signalingState;try{if(r.offer){console.log("[WebRtcConnection]  Received offer, signalingState:",i),await this.connection.setRemoteDescription(r.offer),await this.processQueuedIceCandidates();const s=await this.connection.createAnswer();await this.connection.setLocalDescription(s),this.callbacks.onSignal({answer:s}),console.log("[WebRtcConnection]  Sent answer")}else if(r.answer){if(console.log("[WebRtcConnection]  Received answer, signalingState:",i),i!=="have-local-offer"){console.log("[WebRtcConnection] Ignoring answer - not in have-local-offer state");return}await this.connection.setRemoteDescription(r.answer),await this.processQueuedIceCandidates(),console.log("[WebRtcConnection]  Answer processed, signalingState:",this.connection.signalingState)}else if(r.ice){if(!this.connection.remoteDescription){console.log("[WebRtcConnection] Queuing ICE candidate (no remote description yet), pending:",this.pendingIceCandidates.length+1),this.pendingIceCandidates.push(r.ice);return}await this.connection.addIceCandidate(r.ice),console.log("[WebRtcConnection]  Added ICE candidate")}}catch(s){throw console.error("[WebRtcConnection] Failed to handle signal, signalingState was:",i,"error:",s),s}}async processQueuedIceCandidates(){this.pendingIceCandidates.length>0&&console.log("[WebRtcConnection] Processing",this.pendingIceCandidates.length,"queued ICE candidates");for(const r of this.pendingIceCandidates)try{await this.connection.addIceCandidate(r)}catch(i){console.warn("[WebRtcConnection] Failed to add queued ICE candidate:",i)}this.pendingIceCandidates=[]}sendMessage(r){if(this.destroyed)throw new Error("Connection destroyed");if(!this.msgChannel||this.msgChannel.readyState!=="open")throw new Error("Message channel not open");this.msgChannel.send(r)}destroy(){this.destroyed||(console.log("[WebRtcConnection] Destroying"),this.destroyed=!0,this.msgChannel.close(),this.connection.close(),this.pendingIceCandidates=[])}}class Sv{peerId;identityPK;sessionExpiry=0;encryption=null;webrtc=null;_state="offline";manager;constructor(r,i,s){this.peerId=r,this.identityPK=i,this.manager=s,console.log("[DataTransport] Created for peer:",r.substring(0,8))}get state(){return this._state}get isConnected(){return this.state=="online"}get hasSession(){return this.encryption!==null}get isSessionValid(){return this.hasSession&&Date.now()<this.sessionExpiry}get sessionExpiresAt(){return this.sessionExpiry}updateState(r){const i=this._state;if(this.webrtc)switch(r){case"offline":this.webrtc.destroy(),this.webrtc=null;break}else switch(r){case"offline":break;case"connecting":this.webrtc=new bv({onSignal:s=>this.handleOutgoingSignal("webrtc",s),onData:s=>this.handleIncomingMessage(s),onStateChange:s=>this.handleWebRtcStateChange(s)});break;case"online":throw new Error("Invalid state transition: no-WebRTC -> online")}this._state=r,i!=r&&(console.log(`[DataTransport] State: ${i} -> ${r} for:`,this.peerId.substring(0,8)),this.manager.updatePeerStatus(this.peerId,r))}setSession(r,i){this.encryption?.destroy(),this.encryption=new vv(r),this.sessionExpiry=i,console.log("[DataTransport]  Session set for:",this.peerId.substring(0,8),"expires:",new Date(i).toISOString())}async initiateConnection(){if(!this.isSessionValid){console.log("[DataTransport] Skipping connection initiation - session is invalid or no session exists");return}if(this.state!=="offline"){console.log("[DataTransport] Skipping connection initiation - already connected or connecting");return}this.updateState("connecting"),await this.webrtc.initiateConnection()}handleOutgoingSignal(r,i){if(!this.encryption){console.error("[DataTransport] Cannot encrypt signal - no session");return}const c=JSON.stringify({type:r,payload:i}),m=this.encryption.encrypt(c),_=JSON.stringify(m);console.log("[DataTransport]  Sending encrypted signal:",r),this.manager.sendCustomSignal(this.peerId,_)}handleEncryptedSignal(r){if(!this.hasSession)throw new gc(this.peerId);if(!this.isSessionValid)throw new mc(this.peerId);let i;try{const m=JSON.parse(r);i=this.encryption.decrypt(m)}catch(m){throw new Lf(this.peerId,m instanceof Error?m:void 0)}let s;try{s=JSON.parse(i)}catch(m){throw new Hf(this.peerId,m instanceof Error?m:void 0)}const c=s;if(!c||typeof c.type!="string"){console.warn("[DataTransport] Invalid signal envelope structure:",s);return}switch(console.log("[DataTransport]  Received encrypted signal:",c.type),c.type){case"webrtc":this.handleWebRtcSignal(c.payload);break;default:console.warn("[DataTransport] Unknown signal type:",c.type)}}handleWebRtcSignal(r){var i="unknown";if(r.answer?i="answer":r.offer?i="offer":r.ice&&(i="ice"),!this.webrtc){if(!r.offer){console.warn("[DataTransport] No WebRTC connection to handle signal:",i);return}console.log("[DataTransport] Creating WebRTC connection for incoming offer"),this.updateState("connecting")}console.log("[DataTransport]  Handling WebRTC signal:",i),this.webrtc.handleSignal(r).catch(s=>{console.error("[DataTransport] Failed to handle WebRTC signal:",i,", error:",s)})}handleWebRtcStateChange(r){switch(console.log("[DataTransport] WebRTC state:",r,"for:",this.peerId.substring(0,8)),r){case"connecting":this.updateState("connecting");break;case"connected":this.updateState("online");break;default:this.updateState("offline");break}}handleIncomingMessage(r){console.log("[DataTransport]  Encrypted message received from:",this.peerId.substring(0,8));let i;try{if(!this.hasSession)throw new gc(this.peerId);if(!this.isSessionValid)throw new mc(this.peerId);let s;try{s=this.encryption.decryptBytes(r)}catch(c){throw new Lf(this.peerId,c)}try{const c=new TextDecoder().decode(s);i=JSON.parse(c)}catch(c){throw new Hf(this.peerId,c)}}catch(s){console.error("[DataTransport] Failed to process message:",s),s instanceof Error&&this.manager.reportPeerError(this.peerId,s);return}this.manager.onWireMessage(this.peerId,i)}async sendMessage(r){if(!this.hasSession)throw new gc(this.peerId);if(!this.isSessionValid)throw new mc(this.peerId);if(!this.isConnected)throw new Error(`WebRTC not ready for ${this.peerId.substring(0,8)}`);const i=new TextEncoder().encode(JSON.stringify(r)),s=this.encryption.encryptBytes(i);this.webrtc.sendMessage(s),console.log("[DataTransport]  Message sent to:",this.peerId.substring(0,8))}clearSessionAndConnection(){this.updateState("offline"),this.clearSession()}clearSession(){console.log("[DataTransport] Clearing session for:",this.peerId.substring(0,8)),this.sessionExpiry=0,this.encryption?.destroy(),this.encryption=null}destroy(){this.updateState("offline"),this.clearSession(),console.log("[DataTransport] Destroyed for:",this.peerId.substring(0,8))}}var yc={exports:{}},_v=yc.exports,Tp;function Cv(){return Tp||(Tp=1,(function(u,r){(function(i,s){u.exports=s()})(_v,function(){var i=function(o,f){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(p,g){p.__proto__=g}||function(p,g){for(var C in g)Object.prototype.hasOwnProperty.call(g,C)&&(p[C]=g[C])})(o,f)},s=function(){return(s=Object.assign||function(o){for(var f,p=1,g=arguments.length;p<g;p++)for(var C in f=arguments[p])Object.prototype.hasOwnProperty.call(f,C)&&(o[C]=f[C]);return o}).apply(this,arguments)};function c(o,f,p){for(var g,C=0,T=f.length;C<T;C++)!g&&C in f||((g=g||Array.prototype.slice.call(f,0,C))[C]=f[C]);return o.concat(g||Array.prototype.slice.call(f))}var m=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:iy,_=Object.keys,w=Array.isArray;function x(o,f){return typeof f!="object"||_(f).forEach(function(p){o[p]=f[p]}),o}typeof Promise>"u"||m.Promise||(m.Promise=Promise);var S=Object.getPrototypeOf,E={}.hasOwnProperty;function R(o,f){return E.call(o,f)}function N(o,f){typeof f=="function"&&(f=f(S(o))),(typeof Reflect>"u"?_:Reflect.ownKeys)(f).forEach(function(p){ie(o,p,f[p])})}var q=Object.defineProperty;function ie(o,f,p,g){q(o,f,x(p&&R(p,"get")&&typeof p.get=="function"?{get:p.get,set:p.set,configurable:!0}:{value:p,configurable:!0,writable:!0},g))}function se(o){return{from:function(f){return o.prototype=Object.create(f.prototype),ie(o.prototype,"constructor",o),{extend:N.bind(null,o.prototype)}}}}var Re=Object.getOwnPropertyDescriptor,lt=[].slice;function ke(o,f,p){return lt.call(o,f,p)}function we(o,f){return f(o)}function $e(o){if(!o)throw new Error("Assertion Failed")}function Je(o){m.setImmediate?setImmediate(o):setTimeout(o,0)}function ft(o,f){if(typeof f=="string"&&R(o,f))return o[f];if(!f)return o;if(typeof f!="string"){for(var p=[],g=0,C=f.length;g<C;++g){var T=ft(o,f[g]);p.push(T)}return p}var O=f.indexOf(".");if(O!==-1){var z=o[f.substr(0,O)];return z==null?void 0:ft(z,f.substr(O+1))}}function et(o,f,p){if(o&&f!==void 0&&!("isFrozen"in Object&&Object.isFrozen(o)))if(typeof f!="string"&&"length"in f){$e(typeof p!="string"&&"length"in p);for(var g=0,C=f.length;g<C;++g)et(o,f[g],p[g])}else{var T,O,z=f.indexOf(".");z!==-1?(T=f.substr(0,z),(O=f.substr(z+1))===""?p===void 0?w(o)&&!isNaN(parseInt(T))?o.splice(T,1):delete o[T]:o[T]=p:et(z=!(z=o[T])||!R(o,T)?o[T]={}:z,O,p)):p===void 0?w(o)&&!isNaN(parseInt(f))?o.splice(f,1):delete o[f]:o[f]=p}}function qt(o){var f,p={};for(f in o)R(o,f)&&(p[f]=o[f]);return p}var en=[].concat;function Oe(o){return en.apply([],o)}var pr="BigUint64Array,BigInt64Array,Array,Boolean,String,Date,RegExp,Blob,File,FileList,FileSystemFileHandle,FileSystemDirectoryHandle,ArrayBuffer,DataView,Uint8ClampedArray,ImageBitmap,ImageData,Map,Set,CryptoKey".split(",").concat(Oe([8,16,32,64].map(function(o){return["Int","Uint","Float"].map(function(f){return f+o+"Array"})}))).filter(function(o){return m[o]}),Te=new Set(pr.map(function(o){return m[o]})),pe=null;function ue(o){return pe=new WeakMap,o=(function f(p){if(!p||typeof p!="object")return p;var g=pe.get(p);if(g)return g;if(w(p)){g=[],pe.set(p,g);for(var C=0,T=p.length;C<T;++C)g.push(f(p[C]))}else if(Te.has(p.constructor))g=p;else{var O,z=S(p);for(O in g=z===Object.prototype?{}:Object.create(z),pe.set(p,g),p)R(p,O)&&(g[O]=f(p[O]))}return g})(o),pe=null,o}var xt={}.toString;function qe(o){return xt.call(o).slice(8,-1)}var J=typeof Symbol<"u"?Symbol.iterator:"@@iterator",Me=typeof J=="symbol"?function(o){var f;return o!=null&&(f=o[J])&&f.apply(o)}:function(){return null};function Ge(o,f){return f=o.indexOf(f),0<=f&&o.splice(f,1),0<=f}var je={};function Ye(o){var f,p,g,C;if(arguments.length===1){if(w(o))return o.slice();if(this===je&&typeof o=="string")return[o];if(C=Me(o)){for(p=[];!(g=C.next()).done;)p.push(g.value);return p}if(o==null)return[o];if(typeof(f=o.length)!="number")return[o];for(p=new Array(f);f--;)p[f]=o[f];return p}for(f=arguments.length,p=new Array(f);f--;)p[f]=arguments[f];return p}var L=typeof Symbol<"u"?function(o){return o[Symbol.toStringTag]==="AsyncFunction"}:function(){return!1},ra=["Unknown","Constraint","Data","TransactionInactive","ReadOnly","Version","NotFound","InvalidState","InvalidAccess","Abort","Timeout","QuotaExceeded","Syntax","DataClone"],vr=["Modify","Bulk","OpenFailed","VersionChange","Schema","Upgrade","InvalidTable","MissingAPI","NoSuchDatabase","InvalidArgument","SubTransaction","Unsupported","Internal","DatabaseClosed","PrematureCommit","ForeignAwait"].concat(ra),de={VersionChanged:"Database version changed by other database connection",DatabaseClosed:"Database has been closed",Abort:"Transaction aborted",TransactionInactive:"Transaction has already completed or failed",MissingAPI:"IndexedDB API missing. Please visit https://tinyurl.com/y2uuvskb"};function Ce(o,f){this.name=o,this.message=f}function Le(o,f){return o+". Errors: "+Object.keys(f).map(function(p){return f[p].toString()}).filter(function(p,g,C){return C.indexOf(p)===g}).join(`
`)}function De(o,f,p,g){this.failures=f,this.failedKeys=g,this.successCount=p,this.message=Le(o,f)}function Ee(o,f){this.name="BulkError",this.failures=Object.keys(f).map(function(p){return f[p]}),this.failuresByPos=f,this.message=Le(o,this.failures)}se(Ce).from(Error).extend({toString:function(){return this.name+": "+this.message}}),se(De).from(Ce),se(Ee).from(Ce);var dt=vr.reduce(function(o,f){return o[f]=f+"Error",o},{}),kt=Ce,ze=vr.reduce(function(o,f){var p=f+"Error";function g(C,T){this.name=p,C?typeof C=="string"?(this.message="".concat(C).concat(T?`
 `+T:""),this.inner=T||null):typeof C=="object"&&(this.message="".concat(C.name," ").concat(C.message),this.inner=C):(this.message=de[f]||p,this.inner=null)}return se(g).from(kt),o[f]=g,o},{});ze.Syntax=SyntaxError,ze.Type=TypeError,ze.Range=RangeError;var ct=ra.reduce(function(o,f){return o[f+"Error"]=ze[f],o},{}),pn=vr.reduce(function(o,f){return["Syntax","Type","Range"].indexOf(f)===-1&&(o[f+"Error"]=ze[f]),o},{});function Ht(){}function er(o){return o}function kn(o,f){return o==null||o===er?f:function(p){return f(o(p))}}function Xn(o,f){return function(){o.apply(this,arguments),f.apply(this,arguments)}}function Ti(o,f){return o===Ht?f:function(){var p=o.apply(this,arguments);p!==void 0&&(arguments[0]=p);var g=this.onsuccess,C=this.onerror;this.onsuccess=null,this.onerror=null;var T=f.apply(this,arguments);return g&&(this.onsuccess=this.onsuccess?Xn(g,this.onsuccess):g),C&&(this.onerror=this.onerror?Xn(C,this.onerror):C),T!==void 0?T:p}}function es(o,f){return o===Ht?f:function(){o.apply(this,arguments);var p=this.onsuccess,g=this.onerror;this.onsuccess=this.onerror=null,f.apply(this,arguments),p&&(this.onsuccess=this.onsuccess?Xn(p,this.onsuccess):p),g&&(this.onerror=this.onerror?Xn(g,this.onerror):g)}}function ki(o,f){return o===Ht?f:function(p){var g=o.apply(this,arguments);x(p,g);var C=this.onsuccess,T=this.onerror;return this.onsuccess=null,this.onerror=null,p=f.apply(this,arguments),C&&(this.onsuccess=this.onsuccess?Xn(C,this.onsuccess):C),T&&(this.onerror=this.onerror?Xn(T,this.onerror):T),g===void 0?p===void 0?void 0:p:x(g,p)}}function Nr(o,f){return o===Ht?f:function(){return f.apply(this,arguments)!==!1&&o.apply(this,arguments)}}function Pr(o,f){return o===Ht?f:function(){var p=o.apply(this,arguments);if(p&&typeof p.then=="function"){for(var g=this,C=arguments.length,T=new Array(C);C--;)T[C]=arguments[C];return p.then(function(){return f.apply(g,T)})}return f.apply(this,arguments)}}pn.ModifyError=De,pn.DexieError=Ce,pn.BulkError=Ee;var tr=typeof location<"u"&&/^(http|https):\/\/(localhost|127\.0\.0\.1)/.test(location.href);function qa(o){tr=o}var na={},Dn=100,pr=typeof Promise>"u"?[]:(function(){var o=Promise.resolve();if(typeof crypto>"u"||!crypto.subtle)return[o,S(o),o];var f=crypto.subtle.digest("SHA-512",new Uint8Array([0]));return[f,S(f),o]})(),ra=pr[0],vr=pr[1],pr=pr[2],vr=vr&&vr.then,_r=ra&&ra.constructor,qr=!!pr,ca=function(o,f){Yr.push([o,f]),ua&&(queueMicrotask(Va),ua=!1)},Ya=!0,ua=!0,Or=[],mr=[],Mn=er,Cn={id:"global",global:!0,ref:0,unhandleds:[],onunhandled:Ht,pgp:!1,env:{},finalize:Ht},Qe=Cn,Yr=[],gr=0,Vr=[];function He(o){if(typeof this!="object")throw new TypeError("Promises must be constructed via new");this._listeners=[],this._lib=!1;var f=this._PSD=Qe;if(typeof o!="function"){if(o!==na)throw new TypeError("Not a function");return this._state=arguments[1],this._value=arguments[2],void(this._state===!1&&Dr(this,this._value))}this._state=null,this._value=null,++f.ref,(function p(g,C){try{C(function(T){if(g._state===null){if(T===g)throw new TypeError("A promise cannot be resolved with itself.");var O=g._lib&&Cr();T&&typeof T.then=="function"?p(g,function(z,H){T instanceof He?T._then(z,H):T.then(z,H)}):(g._state=!0,g._value=T,nr(g)),O&&yr()}},Dr.bind(null,g))}catch(T){Dr(g,T)}})(this,o)}var aa={get:function(){var o=Qe,f=A;function p(g,C){var T=this,O=!o.global&&(o!==Qe||f!==A),z=O&&!_e(),H=new He(function(I,$){rr(T,new xa(Ct(g,o,O,z),Ct(C,o,O,z),I,$,o))});return this._consoleTask&&(H._consoleTask=this._consoleTask),H}return p.prototype=na,p},set:function(o){ie(this,"then",o&&o.prototype===na?aa:{get:function(){return o},set:aa.set})}};function xa(o,f,p,g,C){this.onFulfilled=typeof o=="function"?o:null,this.onRejected=typeof f=="function"?f:null,this.resolve=p,this.reject=g,this.psd=C}function Dr(o,f){var p,g;mr.push(f),o._state===null&&(p=o._lib&&Cr(),f=Mn(f),o._state=!1,o._value=f,g=o,Or.some(function(C){return C._value===g._value})||Or.push(g),nr(o),p&&yr())}function nr(o){var f=o._listeners;o._listeners=[];for(var p=0,g=f.length;p<g;++p)rr(o,f[p]);var C=o._PSD;--C.ref||C.finalize(),gr===0&&(++gr,ca(function(){--gr==0&&Mi()},[]))}function rr(o,f){if(o._state!==null){var p=o._state?f.onFulfilled:f.onRejected;if(p===null)return(o._state?f.resolve:f.reject)(o._value);++f.psd.ref,++gr,ca(fa,[p,o,f])}else o._listeners.push(f)}function fa(o,f,p){try{var g,C=f._value;!f._state&&mr.length&&(mr=[]),g=tr&&f._consoleTask?f._consoleTask.run(function(){return o(C)}):o(C),f._state||mr.indexOf(C)!==-1||(function(T){for(var O=Or.length;O;)if(Or[--O]._value===T._value)return Or.splice(O,1)})(f),p.resolve(g)}catch(T){p.reject(T)}finally{--gr==0&&Mi(),--p.psd.ref||p.psd.finalize()}}function Va(){pt(Cn,function(){Cr()&&yr()})}function Cr(){var o=Ya;return ua=Ya=!1,o}function yr(){var o,f,p;do for(;0<Yr.length;)for(o=Yr,Yr=[],p=o.length,f=0;f<p;++f){var g=o[f];g[0].apply(null,g[1])}while(0<Yr.length);ua=Ya=!0}function Mi(){var o=Or;Or=[],o.forEach(function(g){g._PSD.onunhandled.call(null,g._value,g)});for(var f=Vr.slice(0),p=f.length;p;)f[--p]()}function zn(o){return new He(na,!1,o)}function on(o,f){var p=Qe;return function(){var g=Cr(),C=Qe;try{return Bt(p,!0),o.apply(this,arguments)}catch(T){f&&f(T)}finally{Bt(C,!1),g&&yr()}}}N(He.prototype,{then:aa,_then:function(o,f){rr(this,new xa(null,null,o,f,Qe))},catch:function(o){if(arguments.length===1)return this.then(null,o);var f=o,p=arguments[1];return typeof f=="function"?this.then(null,function(g){return(g instanceof f?p:zn)(g)}):this.then(null,function(g){return(g&&g.name===f?p:zn)(g)})},finally:function(o){return this.then(function(f){return He.resolve(o()).then(function(){return f})},function(f){return He.resolve(o()).then(function(){return zn(f)})})},timeout:function(o,f){var p=this;return o<1/0?new He(function(g,C){var T=setTimeout(function(){return C(new ze.Timeout(f))},o);p.then(g,C).finally(clearTimeout.bind(null,T))}):this}}),typeof Symbol<"u"&&Symbol.toStringTag&&ie(He.prototype,Symbol.toStringTag,"Dexie.Promise"),Cn.env=We(),N(He,{all:function(){var o=Ye.apply(null,arguments).map(at);return new He(function(f,p){o.length===0&&f([]);var g=o.length;o.forEach(function(C,T){return He.resolve(C).then(function(O){o[T]=O,--g||f(o)},p)})})},resolve:function(o){return o instanceof He?o:o&&typeof o.then=="function"?new He(function(f,p){o.then(f,p)}):new He(na,!0,o)},reject:zn,race:function(){var o=Ye.apply(null,arguments).map(at);return new He(function(f,p){o.map(function(g){return He.resolve(g).then(f,p)})})},PSD:{get:function(){return Qe},set:function(o){return Qe=o}},totalEchoes:{get:function(){return A}},newPSD:G,usePSD:pt,scheduler:{get:function(){return ca},set:function(o){ca=o}},rejectionMapper:{get:function(){return Mn},set:function(o){Mn=o}},follow:function(o,f){return new He(function(p,g){return G(function(C,T){var O=Qe;O.unhandleds=[],O.onunhandled=T,O.finalize=Xn(function(){var z,H=this;z=function(){H.unhandleds.length===0?C():T(H.unhandleds[0])},Vr.push(function I(){z(),Vr.splice(Vr.indexOf(I),1)}),++gr,ca(function(){--gr==0&&Mi()},[])},O.finalize),o()},f,p,g)})}}),_r&&(_r.allSettled&&ie(He,"allSettled",function(){var o=Ye.apply(null,arguments).map(at);return new He(function(f){o.length===0&&f([]);var p=o.length,g=new Array(p);o.forEach(function(C,T){return He.resolve(C).then(function(O){return g[T]={status:"fulfilled",value:O}},function(O){return g[T]={status:"rejected",reason:O}}).then(function(){return--p||f(g)})})})}),_r.any&&typeof AggregateError<"u"&&ie(He,"any",function(){var o=Ye.apply(null,arguments).map(at);return new He(function(f,p){o.length===0&&p(new AggregateError([]));var g=o.length,C=new Array(g);o.forEach(function(T,O){return He.resolve(T).then(function(z){return f(z)},function(z){C[O]=z,--g||p(new AggregateError(C))})})})}),_r.withResolvers&&(He.withResolvers=_r.withResolvers));var b={awaits:0,echoes:0,id:0},M=0,k=[],h=0,A=0,Q=0;function G(o,f,p,g){var C=Qe,T=Object.create(C);return T.parent=C,T.ref=0,T.global=!1,T.id=++Q,Cn.env,T.env=qr?{Promise:He,PromiseProp:{value:He,configurable:!0,writable:!0},all:He.all,race:He.race,allSettled:He.allSettled,any:He.any,resolve:He.resolve,reject:He.reject}:{},f&&x(T,f),++C.ref,T.finalize=function(){--this.parent.ref||this.parent.finalize()},g=pt(T,o,p,g),T.ref===0&&T.finalize(),g}function fe(){return b.id||(b.id=++M),++b.awaits,b.echoes+=Dn,b.id}function _e(){return!!b.awaits&&(--b.awaits==0&&(b.id=0),b.echoes=b.awaits*Dn,!0)}function at(o){return b.echoes&&o&&o.constructor===_r?(fe(),o.then(function(f){return _e(),f},function(f){return _e(),tt(f)})):o}function Xe(){var o=k[k.length-1];k.pop(),Bt(o,!1)}function Bt(o,f){var p,g=Qe;(f?!b.echoes||h++&&o===Qe:!h||--h&&o===Qe)||queueMicrotask(f?(function(C){++A,b.echoes&&--b.echoes!=0||(b.echoes=b.awaits=b.id=0),k.push(Qe),Bt(C,!0)}).bind(null,o):Xe),o!==Qe&&(Qe=o,g===Cn&&(Cn.env=We()),qr&&(p=Cn.env.Promise,f=o.env,(g.global||o.global)&&(Object.defineProperty(m,"Promise",f.PromiseProp),p.all=f.all,p.race=f.race,p.resolve=f.resolve,p.reject=f.reject,f.allSettled&&(p.allSettled=f.allSettled),f.any&&(p.any=f.any))))}function We(){var o=m.Promise;return qr?{Promise:o,PromiseProp:Object.getOwnPropertyDescriptor(m,"Promise"),all:o.all,race:o.race,allSettled:o.allSettled,any:o.any,resolve:o.resolve,reject:o.reject}:{}}function pt(o,f,p,g,C){var T=Qe;try{return Bt(o,!0),f(p,g,C)}finally{Bt(T,!1)}}function Ct(o,f,p,g){return typeof o!="function"?o:function(){var C=Qe;p&&fe(),Bt(f,!0);try{return o.apply(this,arguments)}finally{Bt(C,!1),g&&queueMicrotask(_e)}}}function Et(o){Promise===_r&&b.echoes===0?h===0?o():enqueueNativeMicroTask(o):setTimeout(o,0)}(""+vr).indexOf("[native code]")===-1&&(fe=_e=Ht);var tt=He.reject,vt="",ht="Invalid key provided. Keys must be of type string, number, Date or Array<string | number | Date>.",it="String expected.",Fe=[],st="__dbnames",Ie="readonly",Ze="readwrite";function nt(o,f){return o?f?function(){return o.apply(this,arguments)&&f.apply(this,arguments)}:o:f}var Ve={type:3,lower:-1/0,lowerOpen:!1,upper:[[]],upperOpen:!1};function ae(o){return typeof o!="string"||/\./.test(o)?function(f){return f}:function(f){return f[o]===void 0&&o in f&&delete(f=ue(f))[o],f}}function oe(){throw ze.Type("Entity instances must never be new:ed. Instances are generated by the framework bypassing the constructor.")}function le(o,f){try{var p=ye(o),g=ye(f);if(p!==g)return p==="Array"?1:g==="Array"?-1:p==="binary"?1:g==="binary"?-1:p==="string"?1:g==="string"?-1:p==="Date"?1:g!=="Date"?NaN:-1;switch(p){case"number":case"Date":case"string":return f<o?1:o<f?-1:0;case"binary":return(function(C,T){for(var O=C.length,z=T.length,H=O<z?O:z,I=0;I<H;++I)if(C[I]!==T[I])return C[I]<T[I]?-1:1;return O===z?0:O<z?-1:1})(ge(o),ge(f));case"Array":return(function(C,T){for(var O=C.length,z=T.length,H=O<z?O:z,I=0;I<H;++I){var $=le(C[I],T[I]);if($!==0)return $}return O===z?0:O<z?-1:1})(o,f)}}catch{}return NaN}function ye(o){var f=typeof o;return f!="object"?f:ArrayBuffer.isView(o)?"binary":(o=qe(o),o==="ArrayBuffer"?"binary":o)}function ge(o){return o instanceof Uint8Array?o:ArrayBuffer.isView(o)?new Uint8Array(o.buffer,o.byteOffset,o.byteLength):new Uint8Array(o)}function Se(o,f,p){var g=o.schema.yProps;return g?(f&&0<p.numFailures&&(f=f.filter(function(C,T){return!p.failures[T]})),Promise.all(g.map(function(C){return C=C.updatesTable,f?o.db.table(C).where("k").anyOf(f).delete():o.db.table(C).clear()})).then(function(){return p})):p}var mt=(At.prototype.execute=function(o){var f=this["@@propmod"];if(f.add!==void 0){var p=f.add;if(w(p))return c(c([],w(o)?o:[],!0),p).sort();if(typeof p=="number")return(Number(o)||0)+p;if(typeof p=="bigint")try{return BigInt(o)+p}catch{return BigInt(0)+p}throw new TypeError("Invalid term ".concat(p))}if(f.remove!==void 0){var g=f.remove;if(w(g))return w(o)?o.filter(function(C){return!g.includes(C)}).sort():[];if(typeof g=="number")return Number(o)-g;if(typeof g=="bigint")try{return BigInt(o)-g}catch{return BigInt(0)-g}throw new TypeError("Invalid subtrahend ".concat(g))}return p=(p=f.replacePrefix)===null||p===void 0?void 0:p[0],p&&typeof o=="string"&&o.startsWith(p)?f.replacePrefix[1]+o.substring(p.length):o},At);function At(o){this["@@propmod"]=o}function Mt(o,f){for(var p=_(f),g=p.length,C=!1,T=0;T<g;++T){var O=p[T],z=f[O],H=ft(o,O);z instanceof mt?(et(o,O,z.execute(H)),C=!0):H!==z&&(et(o,O,z),C=!0)}return C}var jt=(D.prototype._trans=function(o,f,p){var g=this._tx||Qe.trans,C=this.name,T=tr&&typeof console<"u"&&console.createTask&&console.createTask("Dexie: ".concat(o==="readonly"?"read":"write"," ").concat(this.name));function O(I,$,U){if(!U.schema[C])throw new ze.NotFound("Table "+C+" not part of transaction");return f(U.idbtrans,U)}var z=Cr();try{var H=g&&g.db._novip===this.db._novip?g===Qe.trans?g._promise(o,O,p):G(function(){return g._promise(o,O,p)},{trans:g,transless:Qe.transless||Qe}):(function I($,U,F,K){if($.idbdb&&($._state.openComplete||Qe.letThrough||$._vip)){var Y=$._createTransaction(U,F,$._dbSchema);try{Y.create(),$._state.PR1398_maxLoop=3}catch(V){return V.name===dt.InvalidState&&$.isOpen()&&0<--$._state.PR1398_maxLoop?(console.warn("Dexie: Need to reopen db"),$.close({disableAutoOpen:!1}),$.open().then(function(){return I($,U,F,K)})):tt(V)}return Y._promise(U,function(V,X){return G(function(){return Qe.trans=Y,K(V,X,Y)})}).then(function(V){if(U==="readwrite")try{Y.idbtrans.commit()}catch{}return U==="readonly"?V:Y._completion.then(function(){return V})})}if($._state.openComplete)return tt(new ze.DatabaseClosed($._state.dbOpenError));if(!$._state.isBeingOpened){if(!$._state.autoOpen)return tt(new ze.DatabaseClosed);$.open().catch(Ht)}return $._state.dbReadyPromise.then(function(){return I($,U,F,K)})})(this.db,o,[this.name],O);return T&&(H._consoleTask=T,H=H.catch(function(I){return console.trace(I),tt(I)})),H}finally{z&&yr()}},D.prototype.get=function(o,f){var p=this;return o&&o.constructor===Object?this.where(o).first(f):o==null?tt(new ze.Type("Invalid argument to Table.get()")):this._trans("readonly",function(g){return p.core.get({trans:g,key:o}).then(function(C){return p.hook.reading.fire(C)})}).then(f)},D.prototype.where=function(o){if(typeof o=="string")return new this.db.WhereClause(this,o);if(w(o))return new this.db.WhereClause(this,"[".concat(o.join("+"),"]"));var f=_(o);if(f.length===1)return this.where(f[0]).equals(o[f[0]]);var p=this.schema.indexes.concat(this.schema.primKey).filter(function(z){if(z.compound&&f.every(function(I){return 0<=z.keyPath.indexOf(I)})){for(var H=0;H<f.length;++H)if(f.indexOf(z.keyPath[H])===-1)return!1;return!0}return!1}).sort(function(z,H){return z.keyPath.length-H.keyPath.length})[0];if(p&&this.db._maxKey!==vt){var T=p.keyPath.slice(0,f.length);return this.where(T).equals(T.map(function(H){return o[H]}))}!p&&tr&&console.warn("The query ".concat(JSON.stringify(o)," on ").concat(this.name," would benefit from a ")+"compound index [".concat(f.join("+"),"]"));var g=this.schema.idxByName;function C(z,H){return le(z,H)===0}var O=f.reduce(function(U,H){var I=U[0],$=U[1],U=g[H],F=o[H];return[I||U,I||!U?nt($,U&&U.multi?function(K){return K=ft(K,H),w(K)&&K.some(function(Y){return C(F,Y)})}:function(K){return C(F,ft(K,H))}):$]},[null,null]),T=O[0],O=O[1];return T?this.where(T.name).equals(o[T.keyPath]).filter(O):p?this.filter(O):this.where(f).equals("")},D.prototype.filter=function(o){return this.toCollection().and(o)},D.prototype.count=function(o){return this.toCollection().count(o)},D.prototype.offset=function(o){return this.toCollection().offset(o)},D.prototype.limit=function(o){return this.toCollection().limit(o)},D.prototype.each=function(o){return this.toCollection().each(o)},D.prototype.toArray=function(o){return this.toCollection().toArray(o)},D.prototype.toCollection=function(){return new this.db.Collection(new this.db.WhereClause(this))},D.prototype.orderBy=function(o){return new this.db.Collection(new this.db.WhereClause(this,w(o)?"[".concat(o.join("+"),"]"):o))},D.prototype.reverse=function(){return this.toCollection().reverse()},D.prototype.mapToClass=function(o){var f,p=this.db,g=this.name;function C(){return f!==null&&f.apply(this,arguments)||this}(this.schema.mappedClass=o).prototype instanceof oe&&((function(H,I){if(typeof I!="function"&&I!==null)throw new TypeError("Class extends value "+String(I)+" is not a constructor or null");function $(){this.constructor=H}i(H,I),H.prototype=I===null?Object.create(I):($.prototype=I.prototype,new $)})(C,f=o),Object.defineProperty(C.prototype,"db",{get:function(){return p},enumerable:!1,configurable:!0}),C.prototype.table=function(){return g},o=C);for(var T=new Set,O=o.prototype;O;O=S(O))Object.getOwnPropertyNames(O).forEach(function(H){return T.add(H)});function z(H){if(!H)return H;var I,$=Object.create(o.prototype);for(I in H)if(!T.has(I))try{$[I]=H[I]}catch{}return $}return this.schema.readHook&&this.hook.reading.unsubscribe(this.schema.readHook),this.schema.readHook=z,this.hook("reading",z),o},D.prototype.defineClass=function(){return this.mapToClass(function(o){x(this,o)})},D.prototype.add=function(o,f){var p=this,g=this.schema.primKey,C=g.auto,T=g.keyPath,O=o;return T&&C&&(O=ae(T)(o)),this._trans("readwrite",function(z){return p.core.mutate({trans:z,type:"add",keys:f!=null?[f]:null,values:[O]})}).then(function(z){return z.numFailures?He.reject(z.failures[0]):z.lastResult}).then(function(z){if(T)try{et(o,T,z)}catch{}return z})},D.prototype.upsert=function(o,f){var p=this,g=this.schema.primKey.keyPath;return this._trans("readwrite",function(C){return p.core.get({trans:C,key:o}).then(function(T){var O=T??{};return Mt(O,f),g&&et(O,g,o),p.core.mutate({trans:C,type:"put",values:[O],keys:[o],upsert:!0,updates:{keys:[o],changeSpecs:[f]}}).then(function(z){return z.numFailures?He.reject(z.failures[0]):!!T})})})},D.prototype.update=function(o,f){return typeof o!="object"||w(o)?this.where(":id").equals(o).modify(f):(o=ft(o,this.schema.primKey.keyPath),o===void 0?tt(new ze.InvalidArgument("Given object does not contain its primary key")):this.where(":id").equals(o).modify(f))},D.prototype.put=function(o,f){var p=this,g=this.schema.primKey,C=g.auto,T=g.keyPath,O=o;return T&&C&&(O=ae(T)(o)),this._trans("readwrite",function(z){return p.core.mutate({trans:z,type:"put",values:[O],keys:f!=null?[f]:null})}).then(function(z){return z.numFailures?He.reject(z.failures[0]):z.lastResult}).then(function(z){if(T)try{et(o,T,z)}catch{}return z})},D.prototype.delete=function(o){var f=this;return this._trans("readwrite",function(p){return f.core.mutate({trans:p,type:"delete",keys:[o]}).then(function(g){return Se(f,[o],g)}).then(function(g){return g.numFailures?He.reject(g.failures[0]):void 0})})},D.prototype.clear=function(){var o=this;return this._trans("readwrite",function(f){return o.core.mutate({trans:f,type:"deleteRange",range:Ve}).then(function(p){return Se(o,null,p)})}).then(function(f){return f.numFailures?He.reject(f.failures[0]):void 0})},D.prototype.bulkGet=function(o){var f=this;return this._trans("readonly",function(p){return f.core.getMany({keys:o,trans:p}).then(function(g){return g.map(function(C){return f.hook.reading.fire(C)})})})},D.prototype.bulkAdd=function(o,f,p){var g=this,C=Array.isArray(f)?f:void 0,T=(p=p||(C?void 0:f))?p.allKeys:void 0;return this._trans("readwrite",function(O){var I=g.schema.primKey,z=I.auto,I=I.keyPath;if(I&&C)throw new ze.InvalidArgument("bulkAdd(): keys argument invalid on tables with inbound keys");if(C&&C.length!==o.length)throw new ze.InvalidArgument("Arguments objects and keys must have the same length");var H=o.length,I=I&&z?o.map(ae(I)):o;return g.core.mutate({trans:O,type:"add",keys:C,values:I,wantResults:T}).then(function(Y){var U=Y.numFailures,F=Y.results,K=Y.lastResult,Y=Y.failures;if(U===0)return T?F:K;throw new Ee("".concat(g.name,".bulkAdd(): ").concat(U," of ").concat(H," operations failed"),Y)})})},D.prototype.bulkPut=function(o,f,p){var g=this,C=Array.isArray(f)?f:void 0,T=(p=p||(C?void 0:f))?p.allKeys:void 0;return this._trans("readwrite",function(O){var I=g.schema.primKey,z=I.auto,I=I.keyPath;if(I&&C)throw new ze.InvalidArgument("bulkPut(): keys argument invalid on tables with inbound keys");if(C&&C.length!==o.length)throw new ze.InvalidArgument("Arguments objects and keys must have the same length");var H=o.length,I=I&&z?o.map(ae(I)):o;return g.core.mutate({trans:O,type:"put",keys:C,values:I,wantResults:T}).then(function(Y){var U=Y.numFailures,F=Y.results,K=Y.lastResult,Y=Y.failures;if(U===0)return T?F:K;throw new Ee("".concat(g.name,".bulkPut(): ").concat(U," of ").concat(H," operations failed"),Y)})})},D.prototype.bulkUpdate=function(o){var f=this,p=this.core,g=o.map(function(O){return O.key}),C=o.map(function(O){return O.changes}),T=[];return this._trans("readwrite",function(O){return p.getMany({trans:O,keys:g,cache:"clone"}).then(function(z){var H=[],I=[];o.forEach(function(U,F){var K=U.key,Y=U.changes,V=z[F];if(V){for(var X=0,W=Object.keys(Y);X<W.length;X++){var ne=W[X],he=Y[ne];if(ne===f.schema.primKey.keyPath){if(le(he,K)!==0)throw new ze.Constraint("Cannot update primary key in bulkUpdate()")}else et(V,ne,he)}T.push(F),H.push(K),I.push(V)}});var $=H.length;return p.mutate({trans:O,type:"put",keys:H,values:I,updates:{keys:g,changeSpecs:C}}).then(function(U){var F=U.numFailures,K=U.failures;if(F===0)return $;for(var Y=0,V=Object.keys(K);Y<V.length;Y++){var X,W=V[Y],ne=T[Number(W)];ne!=null&&(X=K[W],delete K[W],K[ne]=X)}throw new Ee("".concat(f.name,".bulkUpdate(): ").concat(F," of ").concat($," operations failed"),K)})})})},D.prototype.bulkDelete=function(o){var f=this,p=o.length;return this._trans("readwrite",function(g){return f.core.mutate({trans:g,type:"delete",keys:o}).then(function(C){return Se(f,o,C)})}).then(function(O){var C=O.numFailures,T=O.lastResult,O=O.failures;if(C===0)return T;throw new Ee("".concat(f.name,".bulkDelete(): ").concat(C," of ").concat(p," operations failed"),O)})},D);function D(){}function Nt(o){function f(O,z){if(z){for(var H=arguments.length,I=new Array(H-1);--H;)I[H-1]=arguments[H];return p[O].subscribe.apply(null,I),o}if(typeof O=="string")return p[O]}var p={};f.addEventType=T;for(var g=1,C=arguments.length;g<C;++g)T(arguments[g]);return f;function T(O,z,H){if(typeof O!="object"){var I;z=z||Nr;var $={subscribers:[],fire:H=H||Ht,subscribe:function(U){$.subscribers.indexOf(U)===-1&&($.subscribers.push(U),$.fire=z($.fire,U))},unsubscribe:function(U){$.subscribers=$.subscribers.filter(function(F){return F!==U}),$.fire=$.subscribers.reduce(z,H)}};return p[O]=f[O]=$}_(I=O).forEach(function(U){var F=I[U];if(w(F))T(U,I[U][0],I[U][1]);else{if(F!=="asap")throw new ze.InvalidArgument("Invalid event config");var K=T(U,er,function(){for(var Y=arguments.length,V=new Array(Y);Y--;)V[Y]=arguments[Y];K.subscribers.forEach(function(X){Je(function(){X.apply(null,V)})})})}})}}function wt(o,f){return se(f).from({prototype:o}),f}function Ut(o,f){return!(o.filter||o.algorithm||o.or)&&(f?o.justLimit:!o.replayFilter)}function Ot(o,f){o.filter=nt(o.filter,f)}function It(o,f,p){var g=o.replayFilter;o.replayFilter=g?function(){return nt(g(),f())}:f,o.justLimit=p&&!g}function zt(o,f){if(o.isPrimKey)return f.primaryKey;var p=f.getIndexByKeyPath(o.index);if(!p)throw new ze.Schema("KeyPath "+o.index+" on object store "+f.name+" is not indexed");return p}function mn(o,f,p){var g=zt(o,f.schema);return f.openCursor({trans:p,values:!o.keysOnly,reverse:o.dir==="prev",unique:!!o.unique,query:{index:g,range:o.range}})}function Qt(o,f,p,g){var C=o.replayFilter?nt(o.filter,o.replayFilter()):o.filter;if(o.or){var T={},O=function(z,H,I){var $,U;C&&!C(H,I,function(F){return H.stop(F)},function(F){return H.fail(F)})||((U=""+($=H.primaryKey))=="[object ArrayBuffer]"&&(U=""+new Uint8Array($)),R(T,U)||(T[U]=!0,f(z,H,I)))};return Promise.all([o.or._iterate(O,p),tn(mn(o,g,p),o.algorithm,O,!o.keysOnly&&o.valueMapper)])}return tn(mn(o,g,p),nt(o.algorithm,C),f,!o.keysOnly&&o.valueMapper)}function tn(o,f,p,g){var C=on(g?function(T,O,z){return p(g(T),O,z)}:p);return o.then(function(T){if(T)return T.start(function(){var O=function(){return T.continue()};f&&!f(T,function(z){return O=z},function(z){T.stop(z),O=Ht},function(z){T.fail(z),O=Ht})||C(T.value,T,function(z){return O=z}),O()})})}var yn=(bt.prototype._read=function(o,f){var p=this._ctx;return p.error?p.table._trans(null,tt.bind(null,p.error)):p.table._trans("readonly",o).then(f)},bt.prototype._write=function(o){var f=this._ctx;return f.error?f.table._trans(null,tt.bind(null,f.error)):f.table._trans("readwrite",o,"locked")},bt.prototype._addAlgorithm=function(o){var f=this._ctx;f.algorithm=nt(f.algorithm,o)},bt.prototype._iterate=function(o,f){return Qt(this._ctx,o,f,this._ctx.table.core)},bt.prototype.clone=function(o){var f=Object.create(this.constructor.prototype),p=Object.create(this._ctx);return o&&x(p,o),f._ctx=p,f},bt.prototype.raw=function(){return this._ctx.valueMapper=null,this},bt.prototype.each=function(o){var f=this._ctx;return this._read(function(p){return Qt(f,o,p,f.table.core)})},bt.prototype.count=function(o){var f=this;return this._read(function(p){var g=f._ctx,C=g.table.core;if(Ut(g,!0))return C.count({trans:p,query:{index:zt(g,C.schema),range:g.range}}).then(function(O){return Math.min(O,g.limit)});var T=0;return Qt(g,function(){return++T,!1},p,C).then(function(){return T})}).then(o)},bt.prototype.sortBy=function(o,f){var p=o.split(".").reverse(),g=p[0],C=p.length-1;function T(H,I){return I?T(H[p[I]],I-1):H[g]}var O=this._ctx.dir==="next"?1:-1;function z(H,I){return le(T(H,C),T(I,C))*O}return this.toArray(function(H){return H.sort(z)}).then(f)},bt.prototype.toArray=function(o){var f=this;return this._read(function(p){var g=f._ctx;if(g.dir==="next"&&Ut(g,!0)&&0<g.limit){var C=g.valueMapper,T=zt(g,g.table.core.schema);return g.table.core.query({trans:p,limit:g.limit,values:!0,query:{index:T,range:g.range}}).then(function(z){return z=z.result,C?z.map(C):z})}var O=[];return Qt(g,function(z){return O.push(z)},p,g.table.core).then(function(){return O})},o)},bt.prototype.offset=function(o){var f=this._ctx;return o<=0||(f.offset+=o,Ut(f)?It(f,function(){var p=o;return function(g,C){return p===0||(p===1?--p:C(function(){g.advance(p),p=0}),!1)}}):It(f,function(){var p=o;return function(){return--p<0}})),this},bt.prototype.limit=function(o){return this._ctx.limit=Math.min(this._ctx.limit,o),It(this._ctx,function(){var f=o;return function(p,g,C){return--f<=0&&g(C),0<=f}},!0),this},bt.prototype.until=function(o,f){return Ot(this._ctx,function(p,g,C){return!o(p.value)||(g(C),f)}),this},bt.prototype.first=function(o){return this.limit(1).toArray(function(f){return f[0]}).then(o)},bt.prototype.last=function(o){return this.reverse().first(o)},bt.prototype.filter=function(o){var f;return Ot(this._ctx,function(p){return o(p.value)}),(f=this._ctx).isMatch=nt(f.isMatch,o),this},bt.prototype.and=function(o){return this.filter(o)},bt.prototype.or=function(o){return new this.db.WhereClause(this._ctx.table,o,this)},bt.prototype.reverse=function(){return this._ctx.dir=this._ctx.dir==="prev"?"next":"prev",this._ondirectionchange&&this._ondirectionchange(this._ctx.dir),this},bt.prototype.desc=function(){return this.reverse()},bt.prototype.eachKey=function(o){var f=this._ctx;return f.keysOnly=!f.isMatch,this.each(function(p,g){o(g.key,g)})},bt.prototype.eachUniqueKey=function(o){return this._ctx.unique="unique",this.eachKey(o)},bt.prototype.eachPrimaryKey=function(o){var f=this._ctx;return f.keysOnly=!f.isMatch,this.each(function(p,g){o(g.primaryKey,g)})},bt.prototype.keys=function(o){var f=this._ctx;f.keysOnly=!f.isMatch;var p=[];return this.each(function(g,C){p.push(C.key)}).then(function(){return p}).then(o)},bt.prototype.primaryKeys=function(o){var f=this._ctx;if(f.dir==="next"&&Ut(f,!0)&&0<f.limit)return this._read(function(g){var C=zt(f,f.table.core.schema);return f.table.core.query({trans:g,values:!1,limit:f.limit,query:{index:C,range:f.range}})}).then(function(g){return g.result}).then(o);f.keysOnly=!f.isMatch;var p=[];return this.each(function(g,C){p.push(C.primaryKey)}).then(function(){return p}).then(o)},bt.prototype.uniqueKeys=function(o){return this._ctx.unique="unique",this.keys(o)},bt.prototype.firstKey=function(o){return this.limit(1).keys(function(f){return f[0]}).then(o)},bt.prototype.lastKey=function(o){return this.reverse().firstKey(o)},bt.prototype.distinct=function(){var o=this._ctx,o=o.index&&o.table.schema.idxByName[o.index];if(!o||!o.multi)return this;var f={};return Ot(this._ctx,function(C){var g=C.primaryKey.toString(),C=R(f,g);return f[g]=!0,!C}),this},bt.prototype.modify=function(o){var f=this,p=this._ctx;return this._write(function(g){var C=typeof o=="function"?o:function(V){return Mt(V,o)},T=p.table.core,I=T.schema.primaryKey,O=I.outbound,z=I.extractKey,H=200,I=f.db._options.modifyChunkSize;I&&(H=typeof I=="object"?I[T.name]||I["*"]||200:I);function $(V,ne){var W=ne.failures,ne=ne.numFailures;F+=V-ne;for(var he=0,xe=_(W);he<xe.length;he++){var Be=xe[he];U.push(W[Be])}}var U=[],F=0,K=[],Y=o===vn;return f.clone().primaryKeys().then(function(V){function X(ne){var he=Math.min(H,V.length-ne),xe=V.slice(ne,ne+he);return(Y?Promise.resolve([]):T.getMany({trans:g,keys:xe,cache:"immutable"})).then(function(Be){var Pe=[],Ae=[],Ue=O?[]:null,Ke=Y?xe:[];if(!Y)for(var Ne=0;Ne<he;++Ne){var rt=Be[Ne],St={value:ue(rt),primKey:V[ne+Ne]};C.call(St,St.value,St)!==!1&&(St.value==null?Ke.push(V[ne+Ne]):O||le(z(rt),z(St.value))===0?(Ae.push(St.value),O&&Ue.push(V[ne+Ne])):(Ke.push(V[ne+Ne]),Pe.push(St.value)))}return Promise.resolve(0<Pe.length&&T.mutate({trans:g,type:"add",values:Pe}).then(function(Dt){for(var Kt in Dt.failures)Ke.splice(parseInt(Kt),1);$(Pe.length,Dt)})).then(function(){return(0<Ae.length||W&&typeof o=="object")&&T.mutate({trans:g,type:"put",keys:Ue,values:Ae,criteria:W,changeSpec:typeof o!="function"&&o,isAdditionalChunk:0<ne}).then(function(Dt){return $(Ae.length,Dt)})}).then(function(){return(0<Ke.length||W&&Y)&&T.mutate({trans:g,type:"delete",keys:Ke,criteria:W,isAdditionalChunk:0<ne}).then(function(Dt){return Se(p.table,Ke,Dt)}).then(function(Dt){return $(Ke.length,Dt)})}).then(function(){return V.length>ne+he&&X(ne+H)})})}var W=Ut(p)&&p.limit===1/0&&(typeof o!="function"||Y)&&{index:p.index,range:p.range};return X(0).then(function(){if(0<U.length)throw new De("Error modifying one or more objects",U,F,K);return V.length})})})},bt.prototype.delete=function(){var o=this._ctx,f=o.range;return!Ut(o)||o.table.schema.yProps||!o.isPrimKey&&f.type!==3?this.modify(vn):this._write(function(p){var g=o.table.core.schema.primaryKey,C=f;return o.table.core.count({trans:p,query:{index:g,range:C}}).then(function(T){return o.table.core.mutate({trans:p,type:"deleteRange",range:C}).then(function(H){var z=H.failures,H=H.numFailures;if(H)throw new De("Could not delete some values",Object.keys(z).map(function(I){return z[I]}),T-H);return T-H})})})},bt);function bt(){}var vn=function(o,f){return f.value=null};function Rn(o,f){return o<f?-1:o===f?0:1}function Ln(o,f){return f<o?-1:o===f?0:1}function nn(o,f,p){return o=o instanceof ba?new o.Collection(o):o,o._ctx.error=new(p||TypeError)(f),o}function ia(o){return new o.Collection(o,function(){return ts("")}).limit(0)}function Er(o,f,p,g){var C,T,O,z,H,I,$,U=p.length;if(!p.every(function(Y){return typeof Y=="string"}))return nn(o,it);function F(Y){C=Y==="next"?function(X){return X.toUpperCase()}:function(X){return X.toLowerCase()},T=Y==="next"?function(X){return X.toLowerCase()}:function(X){return X.toUpperCase()},O=Y==="next"?Rn:Ln;var V=p.map(function(X){return{lower:T(X),upper:C(X)}}).sort(function(X,W){return O(X.lower,W.lower)});z=V.map(function(X){return X.upper}),H=V.map(function(X){return X.lower}),$=(I=Y)==="next"?"":g}F("next"),o=new o.Collection(o,function(){return Gr(z[0],H[U-1]+g)}),o._ondirectionchange=function(Y){F(Y)};var K=0;return o._addAlgorithm(function(Y,V,X){var W=Y.key;if(typeof W!="string")return!1;var ne=T(W);if(f(ne,H,K))return!0;for(var he=null,xe=K;xe<U;++xe){var Be=(function(Pe,Ae,Ue,Ke,Ne,rt){for(var St=Math.min(Pe.length,Ke.length),Dt=-1,Kt=0;Kt<St;++Kt){var Jn=Ae[Kt];if(Jn!==Ke[Kt])return Ne(Pe[Kt],Ue[Kt])<0?Pe.substr(0,Kt)+Ue[Kt]+Ue.substr(Kt+1):Ne(Pe[Kt],Ke[Kt])<0?Pe.substr(0,Kt)+Ke[Kt]+Ue.substr(Kt+1):0<=Dt?Pe.substr(0,Dt)+Ae[Dt]+Ue.substr(Dt+1):null;Ne(Pe[Kt],Jn)<0&&(Dt=Kt)}return St<Ke.length&&rt==="next"?Pe+Ue.substr(Pe.length):St<Pe.length&&rt==="prev"?Pe.substr(0,Ue.length):Dt<0?null:Pe.substr(0,Dt)+Ke[Dt]+Ue.substr(Dt+1)})(W,ne,z[xe],H[xe],O,I);Be===null&&he===null?K=xe+1:(he===null||0<O(he,Be))&&(he=Be)}return V(he!==null?function(){Y.continue(he+$)}:X),!1}),o}function Gr(o,f,p,g){return{type:2,lower:o,upper:f,lowerOpen:p,upperOpen:g}}function ts(o){return{type:1,lower:o,upper:o}}var ba=(Object.defineProperty(xn.prototype,"Collection",{get:function(){return this._ctx.table.db.Collection},enumerable:!1,configurable:!0}),xn.prototype.between=function(o,f,p,g){p=p!==!1,g=g===!0;try{return 0<this._cmp(o,f)||this._cmp(o,f)===0&&(p||g)&&(!p||!g)?ia(this):new this.Collection(this,function(){return Gr(o,f,!p,!g)})}catch{return nn(this,ht)}},xn.prototype.equals=function(o){return o==null?nn(this,ht):new this.Collection(this,function(){return ts(o)})},xn.prototype.above=function(o){return o==null?nn(this,ht):new this.Collection(this,function(){return Gr(o,void 0,!0)})},xn.prototype.aboveOrEqual=function(o){return o==null?nn(this,ht):new this.Collection(this,function(){return Gr(o,void 0,!1)})},xn.prototype.below=function(o){return o==null?nn(this,ht):new this.Collection(this,function(){return Gr(void 0,o,!1,!0)})},xn.prototype.belowOrEqual=function(o){return o==null?nn(this,ht):new this.Collection(this,function(){return Gr(void 0,o)})},xn.prototype.startsWith=function(o){return typeof o!="string"?nn(this,it):this.between(o,o+vt,!0,!0)},xn.prototype.startsWithIgnoreCase=function(o){return o===""?this.startsWith(o):Er(this,function(f,p){return f.indexOf(p[0])===0},[o],vt)},xn.prototype.equalsIgnoreCase=function(o){return Er(this,function(f,p){return f===p[0]},[o],"")},xn.prototype.anyOfIgnoreCase=function(){var o=Ye.apply(je,arguments);return o.length===0?ia(this):Er(this,function(f,p){return p.indexOf(f)!==-1},o,"")},xn.prototype.startsWithAnyOfIgnoreCase=function(){var o=Ye.apply(je,arguments);return o.length===0?ia(this):Er(this,function(f,p){return p.some(function(g){return f.indexOf(g)===0})},o,vt)},xn.prototype.anyOf=function(){var o=this,f=Ye.apply(je,arguments),p=this._cmp;try{f.sort(p)}catch{return nn(this,ht)}if(f.length===0)return ia(this);var g=new this.Collection(this,function(){return Gr(f[0],f[f.length-1])});g._ondirectionchange=function(T){p=T==="next"?o._ascending:o._descending,f.sort(p)};var C=0;return g._addAlgorithm(function(T,O,z){for(var H=T.key;0<p(H,f[C]);)if(++C===f.length)return O(z),!1;return p(H,f[C])===0||(O(function(){T.continue(f[C])}),!1)}),g},xn.prototype.notEqual=function(o){return this.inAnyRange([[-1/0,o],[o,this.db._maxKey]],{includeLowers:!1,includeUppers:!1})},xn.prototype.noneOf=function(){var o=Ye.apply(je,arguments);if(o.length===0)return new this.Collection(this);try{o.sort(this._ascending)}catch{return nn(this,ht)}var f=o.reduce(function(p,g){return p?p.concat([[p[p.length-1][1],g]]):[[-1/0,g]]},null);return f.push([o[o.length-1],this.db._maxKey]),this.inAnyRange(f,{includeLowers:!1,includeUppers:!1})},xn.prototype.inAnyRange=function(W,f){var p=this,g=this._cmp,C=this._ascending,T=this._descending,O=this._min,z=this._max;if(W.length===0)return ia(this);if(!W.every(function(ne){return ne[0]!==void 0&&ne[1]!==void 0&&C(ne[0],ne[1])<=0}))return nn(this,"First argument to inAnyRange() must be an Array of two-value Arrays [lower,upper] where upper must not be lower than lower",ze.InvalidArgument);var H=!f||f.includeLowers!==!1,I=f&&f.includeUppers===!0,$,U=C;function F(ne,he){return U(ne[0],he[0])}try{($=W.reduce(function(ne,he){for(var xe=0,Be=ne.length;xe<Be;++xe){var Pe=ne[xe];if(g(he[0],Pe[1])<0&&0<g(he[1],Pe[0])){Pe[0]=O(Pe[0],he[0]),Pe[1]=z(Pe[1],he[1]);break}}return xe===Be&&ne.push(he),ne},[])).sort(F)}catch{return nn(this,ht)}var K=0,Y=I?function(ne){return 0<C(ne,$[K][1])}:function(ne){return 0<=C(ne,$[K][1])},V=H?function(ne){return 0<T(ne,$[K][0])}:function(ne){return 0<=T(ne,$[K][0])},X=Y,W=new this.Collection(this,function(){return Gr($[0][0],$[$.length-1][1],!H,!I)});return W._ondirectionchange=function(ne){U=ne==="next"?(X=Y,C):(X=V,T),$.sort(F)},W._addAlgorithm(function(ne,he,xe){for(var Be,Pe=ne.key;X(Pe);)if(++K===$.length)return he(xe),!1;return!Y(Be=Pe)&&!V(Be)||(p._cmp(Pe,$[K][1])===0||p._cmp(Pe,$[K][0])===0||he(function(){U===C?ne.continue($[K][0]):ne.continue($[K][1])}),!1)}),W},xn.prototype.startsWithAnyOf=function(){var o=Ye.apply(je,arguments);return o.every(function(f){return typeof f=="string"})?o.length===0?ia(this):this.inAnyRange(o.map(function(f){return[f,f+vt]})):nn(this,"startsWithAnyOf() only works with strings")},xn);function xn(){}function zr(o){return on(function(f){return Sa(f),o(f.target.error),!1})}function Sa(o){o.stopPropagation&&o.stopPropagation(),o.preventDefault&&o.preventDefault()}var Ga="storagemutated",_a="x-storagemutated-1",Fn=Nt(null,Ga),Gs=(cr.prototype._lock=function(){return $e(!Qe.global),++this._reculock,this._reculock!==1||Qe.global||(Qe.lockOwnerFor=this),this},cr.prototype._unlock=function(){if($e(!Qe.global),--this._reculock==0)for(Qe.global||(Qe.lockOwnerFor=null);0<this._blockedFuncs.length&&!this._locked();){var o=this._blockedFuncs.shift();try{pt(o[1],o[0])}catch{}}return this},cr.prototype._locked=function(){return this._reculock&&Qe.lockOwnerFor!==this},cr.prototype.create=function(o){var f=this;if(!this.mode)return this;var p=this.db.idbdb,g=this.db._state.dbOpenError;if($e(!this.idbtrans),!o&&!p)switch(g&&g.name){case"DatabaseClosedError":throw new ze.DatabaseClosed(g);case"MissingAPIError":throw new ze.MissingAPI(g.message,g);default:throw new ze.OpenFailed(g)}if(!this.active)throw new ze.TransactionInactive;return $e(this._completion._state===null),(o=this.idbtrans=o||(this.db.core||p).transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability})).onerror=on(function(C){Sa(C),f._reject(o.error)}),o.onabort=on(function(C){Sa(C),f.active&&f._reject(new ze.Abort(o.error)),f.active=!1,f.on("abort").fire(C)}),o.oncomplete=on(function(){f.active=!1,f._resolve(),"mutatedParts"in o&&Fn.storagemutated.fire(o.mutatedParts)}),this},cr.prototype._promise=function(o,f,p){var g=this;if(o==="readwrite"&&this.mode!=="readwrite")return tt(new ze.ReadOnly("Transaction is readonly"));if(!this.active)return tt(new ze.TransactionInactive);if(this._locked())return new He(function(T,O){g._blockedFuncs.push([function(){g._promise(o,f,p).then(T,O)},Qe])});if(p)return G(function(){var T=new He(function(O,z){g._lock();var H=f(O,z,g);H&&H.then&&H.then(O,z)});return T.finally(function(){return g._unlock()}),T._lib=!0,T});var C=new He(function(T,O){var z=f(T,O,g);z&&z.then&&z.then(T,O)});return C._lib=!0,C},cr.prototype._root=function(){return this.parent?this.parent._root():this},cr.prototype.waitFor=function(o){var f,p=this._root(),g=He.resolve(o);p._waitingFor?p._waitingFor=p._waitingFor.then(function(){return g}):(p._waitingFor=g,p._waitingQueue=[],f=p.idbtrans.objectStore(p.storeNames[0]),(function T(){for(++p._spinCount;p._waitingQueue.length;)p._waitingQueue.shift()();p._waitingFor&&(f.get(-1/0).onsuccess=T)})());var C=p._waitingFor;return new He(function(T,O){g.then(function(z){return p._waitingQueue.push(on(T.bind(null,z)))},function(z){return p._waitingQueue.push(on(O.bind(null,z)))}).finally(function(){p._waitingFor===C&&(p._waitingFor=null)})})},cr.prototype.abort=function(){this.active&&(this.active=!1,this.idbtrans&&this.idbtrans.abort(),this._reject(new ze.Abort))},cr.prototype.table=function(o){var f=this._memoizedTables||(this._memoizedTables={});if(R(f,o))return f[o];var p=this.schema[o];if(!p)throw new ze.NotFound("Table "+o+" not part of transaction");return p=new this.db.Table(o,p,this),p.core=this.db.core.table(o),f[o]=p},cr);function cr(){}function Qr(o,f,p,g,C,T,O,z){return{name:o,keyPath:f,unique:p,multi:g,auto:C,compound:T,src:(p&&!O?"&":"")+(g?"*":"")+(C?"++":"")+ns(f),type:z}}function ns(o){return typeof o=="string"?o:o?"["+[].join.call(o,"+")+"]":""}function Qa(o,f,p){return{name:o,primKey:f,indexes:p,mappedClass:null,idxByName:(g=function(C){return[C.name,C]},p.reduce(function(C,T,O){return O=g(T,O),O&&(C[O[0]]=O[1]),C},{}))};var g}var $a=function(o){try{return o.only([[]]),$a=function(){return[[]]},[[]]}catch{return $a=function(){return vt},vt}};function Xa(o){return o==null?function(){}:typeof o=="string"?(f=o).split(".").length===1?function(p){return p[f]}:function(p){return ft(p,f)}:function(p){return ft(p,o)};var f}function ji(o){return[].slice.call(o)}var $o=0;function Hn(o){return o==null?":id":typeof o=="string"?o:"[".concat(o.join("+"),"]")}function Ca(o,f,H){function g(X){if(X.type===3)return null;if(X.type===4)throw new Error("Cannot convert never type to IDBKeyRange");var K=X.lower,Y=X.upper,V=X.lowerOpen,X=X.upperOpen;return K===void 0?Y===void 0?null:f.upperBound(Y,!!X):Y===void 0?f.lowerBound(K,!!V):f.bound(K,Y,!!V,!!X)}function C(F){var K,Y=F.name;return{name:Y,schema:F,mutate:function(V){var X=V.trans,W=V.type,ne=V.keys,he=V.values,xe=V.range;return new Promise(function(Be,Pe){Be=on(Be);var Ae=X.objectStore(Y),Ue=Ae.keyPath==null,Ke=W==="put"||W==="add";if(!Ke&&W!=="delete"&&W!=="deleteRange")throw new Error("Invalid operation type: "+W);var Ne,rt=(ne||he||{length:1}).length;if(ne&&he&&ne.length!==he.length)throw new Error("Given keys array must have same length as given values array.");if(rt===0)return Be({numFailures:0,failures:{},results:[],lastResult:void 0});function St(Kn){++Jn,Sa(Kn)}var Dt=[],Kt=[],Jn=0;if(W==="deleteRange"){if(xe.type===4)return Be({numFailures:Jn,failures:Kt,results:[],lastResult:void 0});xe.type===3?Dt.push(Ne=Ae.clear()):Dt.push(Ne=Ae.delete(g(xe)))}else{var Ue=Ke?Ue?[he,ne]:[he,null]:[ne,null],Rt=Ue[0],In=Ue[1];if(Ke)for(var En=0;En<rt;++En)Dt.push(Ne=In&&In[En]!==void 0?Ae[W](Rt[En],In[En]):Ae[W](Rt[En])),Ne.onerror=St;else for(En=0;En<rt;++En)Dt.push(Ne=Ae[W](Rt[En])),Ne.onerror=St}function Bi(Kn){Kn=Kn.target.result,Dt.forEach(function(wr,so){return wr.error!=null&&(Kt[so]=wr.error)}),Be({numFailures:Jn,failures:Kt,results:W==="delete"?ne:Dt.map(function(wr){return wr.result}),lastResult:Kn})}Ne.onerror=function(Kn){St(Kn),Bi(Kn)},Ne.onsuccess=Bi})},getMany:function(V){var X=V.trans,W=V.keys;return new Promise(function(ne,he){ne=on(ne);for(var xe,Be=X.objectStore(Y),Pe=W.length,Ae=new Array(Pe),Ue=0,Ke=0,Ne=function(Dt){Dt=Dt.target,Ae[Dt._pos]=Dt.result,++Ke===Ue&&ne(Ae)},rt=zr(he),St=0;St<Pe;++St)W[St]!=null&&((xe=Be.get(W[St]))._pos=St,xe.onsuccess=Ne,xe.onerror=rt,++Ue);Ue===0&&ne(Ae)})},get:function(V){var X=V.trans,W=V.key;return new Promise(function(ne,he){ne=on(ne);var xe=X.objectStore(Y).get(W);xe.onsuccess=function(Be){return ne(Be.target.result)},xe.onerror=zr(he)})},query:(K=I,function(V){return new Promise(function(X,W){X=on(X);var ne,he,xe,Ue=V.trans,Be=V.values,Pe=V.limit,Ne=V.query,Ae=Pe===1/0?void 0:Pe,Ke=Ne.index,Ne=Ne.range,Ue=Ue.objectStore(Y),Ke=Ke.isPrimaryKey?Ue:Ue.index(Ke.name),Ne=g(Ne);if(Pe===0)return X({result:[]});K?((Ae=Be?Ke.getAll(Ne,Ae):Ke.getAllKeys(Ne,Ae)).onsuccess=function(rt){return X({result:rt.target.result})},Ae.onerror=zr(W)):(ne=0,he=!Be&&"openKeyCursor"in Ke?Ke.openKeyCursor(Ne):Ke.openCursor(Ne),xe=[],he.onsuccess=function(rt){var St=he.result;return St?(xe.push(Be?St.value:St.primaryKey),++ne===Pe?X({result:xe}):void St.continue()):X({result:xe})},he.onerror=zr(W))})}),openCursor:function(V){var X=V.trans,W=V.values,ne=V.query,he=V.reverse,xe=V.unique;return new Promise(function(Be,Pe){Be=on(Be);var Ke=ne.index,Ae=ne.range,Ue=X.objectStore(Y),Ue=Ke.isPrimaryKey?Ue:Ue.index(Ke.name),Ke=he?xe?"prevunique":"prev":xe?"nextunique":"next",Ne=!W&&"openKeyCursor"in Ue?Ue.openKeyCursor(g(Ae),Ke):Ue.openCursor(g(Ae),Ke);Ne.onerror=zr(Pe),Ne.onsuccess=on(function(rt){var St,Dt,Kt,Jn,Rt=Ne.result;Rt?(Rt.___id=++$o,Rt.done=!1,St=Rt.continue.bind(Rt),Dt=(Dt=Rt.continuePrimaryKey)&&Dt.bind(Rt),Kt=Rt.advance.bind(Rt),Jn=function(){throw new Error("Cursor not stopped")},Rt.trans=X,Rt.stop=Rt.continue=Rt.continuePrimaryKey=Rt.advance=function(){throw new Error("Cursor not started")},Rt.fail=on(Pe),Rt.next=function(){var In=this,En=1;return this.start(function(){return En--?In.continue():In.stop()}).then(function(){return In})},Rt.start=function(In){function En(){if(Ne.result)try{In()}catch(Kn){Rt.fail(Kn)}else Rt.done=!0,Rt.start=function(){throw new Error("Cursor behind last entry")},Rt.stop()}var Bi=new Promise(function(Kn,wr){Kn=on(Kn),Ne.onerror=zr(wr),Rt.fail=wr,Rt.stop=function(so){Rt.stop=Rt.continue=Rt.continuePrimaryKey=Rt.advance=Jn,Kn(so)}});return Ne.onsuccess=on(function(Kn){Ne.onsuccess=En,En()}),Rt.continue=St,Rt.continuePrimaryKey=Dt,Rt.advance=Kt,En(),Bi},Be(Rt)):Be(null)},Pe)})},count:function(V){var X=V.query,W=V.trans,ne=X.index,he=X.range;return new Promise(function(xe,Be){var Pe=W.objectStore(Y),Ae=ne.isPrimaryKey?Pe:Pe.index(ne.name),Pe=g(he),Ae=Pe?Ae.count(Pe):Ae.count();Ae.onsuccess=on(function(Ue){return xe(Ue.target.result)}),Ae.onerror=zr(Be)})}}}var T,O,z,$=(O=H,z=ji((T=o).objectStoreNames),{schema:{name:T.name,tables:z.map(function(F){return O.objectStore(F)}).map(function(F){var K=F.keyPath,X=F.autoIncrement,Y=w(K),V={},X={name:F.name,primaryKey:{name:null,isPrimaryKey:!0,outbound:K==null,compound:Y,keyPath:K,autoIncrement:X,unique:!0,extractKey:Xa(K)},indexes:ji(F.indexNames).map(function(W){return F.index(W)}).map(function(xe){var ne=xe.name,he=xe.unique,Be=xe.multiEntry,xe=xe.keyPath,Be={name:ne,compound:w(xe),keyPath:xe,unique:he,multiEntry:Be,extractKey:Xa(xe)};return V[Hn(xe)]=Be}),getIndexByKeyPath:function(W){return V[Hn(W)]}};return V[":id"]=X.primaryKey,K!=null&&(V[Hn(K)]=X.primaryKey),X})},hasGetAll:0<z.length&&"getAll"in O.objectStore(z[0])&&!(typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604)}),H=$.schema,I=$.hasGetAll,$=H.tables.map(C),U={};return $.forEach(function(F){return U[F.name]=F}),{stack:"dbcore",transaction:o.transaction.bind(o),table:function(F){if(!U[F])throw new Error("Table '".concat(F,"' not found"));return U[F]},MIN_KEY:-1/0,MAX_KEY:$a(f),schema:H}}function rs(o,f,p,g){var C=p.IDBKeyRange;return p.indexedDB,{dbcore:(g=Ca(f,C,g),o.dbcore.reduce(function(T,O){return O=O.create,s(s({},T),O(T))},g))}}function da(o,g){var p=g.db,g=rs(o._middlewares,p,o._deps,g);o.core=g.dbcore,o.tables.forEach(function(C){var T=C.name;o.core.schema.tables.some(function(O){return O.name===T})&&(C.core=o.core.table(T),o[T]instanceof o.Table&&(o[T].core=C.core))})}function as(o,f,p,g){p.forEach(function(C){var T=g[C];f.forEach(function(O){var z=(function H(I,$){return Re(I,$)||(I=S(I))&&H(I,$)})(O,C);(!z||"value"in z&&z.value===void 0)&&(O===o.Transaction.prototype||O instanceof o.Transaction?ie(O,C,{get:function(){return this.table(C)},set:function(H){q(this,C,{value:H,writable:!0,configurable:!0,enumerable:!0})}}):O[C]=new o.Table(C,T))})})}function Ri(o,f){f.forEach(function(p){for(var g in p)p[g]instanceof o.Table&&delete p[g]})}function Qs(o,f){return o._cfg.version-f._cfg.version}function Ai(o,f,p,g){var C=o._dbSchema;p.objectStoreNames.contains("$meta")&&!C.$meta&&(C.$meta=Qa("$meta",Fo("")[0],[]),o._storeNames.push("$meta"));var T=o._createTransaction("readwrite",o._storeNames,C);T.create(p),T._completion.catch(g);var O=T._reject.bind(T),z=Qe.transless||Qe;G(function(){return Qe.trans=T,Qe.transless=z,f!==0?(da(o,p),I=f,((H=T).storeNames.includes("$meta")?H.table("$meta").get("version").then(function($){return $??I}):He.resolve(I)).then(function($){return F=$,K=T,Y=p,V=[],$=(U=o)._versions,X=U._dbSchema=Fa(0,U.idbdb,Y),($=$.filter(function(W){return W._cfg.version>=F})).length!==0?($.forEach(function(W){V.push(function(){var ne=X,he=W._cfg.dbschema;ls(U,ne,Y),ls(U,he,Y),X=U._dbSchema=he;var xe=ss(ne,he);xe.add.forEach(function(Ke){$s(Y,Ke[0],Ke[1].primKey,Ke[1].indexes)}),xe.change.forEach(function(Ke){if(Ke.recreate)throw new ze.Upgrade("Not yet support for changing primary key");var Ne=Y.objectStore(Ke.name);Ke.add.forEach(function(rt){return os(Ne,rt)}),Ke.change.forEach(function(rt){Ne.deleteIndex(rt.name),os(Ne,rt)}),Ke.del.forEach(function(rt){return Ne.deleteIndex(rt)})});var Be=W._cfg.contentUpgrade;if(Be&&W._cfg.version>F){da(U,Y),K._memoizedTables={};var Pe=qt(he);xe.del.forEach(function(Ke){Pe[Ke]=ne[Ke]}),Ri(U,[U.Transaction.prototype]),as(U,[U.Transaction.prototype],_(Pe),Pe),K.schema=Pe;var Ae,Ue=L(Be);return Ue&&fe(),xe=He.follow(function(){var Ke;(Ae=Be(K))&&Ue&&(Ke=_e.bind(null,null),Ae.then(Ke,Ke))}),Ae&&typeof Ae.then=="function"?He.resolve(Ae):xe.then(function(){return Ae})}}),V.push(function(ne){var he,xe,Be=W._cfg.dbschema;he=Be,xe=ne,[].slice.call(xe.db.objectStoreNames).forEach(function(Pe){return he[Pe]==null&&xe.db.deleteObjectStore(Pe)}),Ri(U,[U.Transaction.prototype]),as(U,[U.Transaction.prototype],U._storeNames,U._dbSchema),K.schema=U._dbSchema}),V.push(function(ne){U.idbdb.objectStoreNames.contains("$meta")&&(Math.ceil(U.idbdb.version/10)===W._cfg.version?(U.idbdb.deleteObjectStore("$meta"),delete U._dbSchema.$meta,U._storeNames=U._storeNames.filter(function(he){return he!=="$meta"})):ne.objectStore("$meta").put(W._cfg.version,"version"))})}),(function W(){return V.length?He.resolve(V.shift()(K.idbtrans)).then(W):He.resolve()})().then(function(){Xo(X,Y)})):He.resolve();var U,F,K,Y,V,X}).catch(O)):(_(C).forEach(function($){$s(p,$,C[$].primKey,C[$].indexes)}),da(o,p),void He.follow(function(){return o.on.populate.fire(T)}).catch(O));var H,I})}function is(o,f){Xo(o._dbSchema,f),f.db.version%10!=0||f.objectStoreNames.contains("$meta")||f.db.createObjectStore("$meta").add(Math.ceil(f.db.version/10-1),"version");var p=Fa(0,o.idbdb,f);ls(o,o._dbSchema,f);for(var g=0,C=ss(p,o._dbSchema).change;g<C.length;g++){var T=(function(O){if(O.change.length||O.recreate)return console.warn("Unable to patch indexes of table ".concat(O.name," because it has changes on the type of index or primary key.")),{value:void 0};var z=f.objectStore(O.name);O.add.forEach(function(H){tr&&console.debug("Dexie upgrade patch: Creating missing index ".concat(O.name,".").concat(H.src)),os(z,H)})})(C[g]);if(typeof T=="object")return T.value}}function ss(o,f){var p,g={del:[],add:[],change:[]};for(p in o)f[p]||g.del.push(p);for(p in f){var C=o[p],T=f[p];if(C){var O={name:p,def:T,recreate:!1,del:[],add:[],change:[]};if(""+(C.primKey.keyPath||"")!=""+(T.primKey.keyPath||"")||C.primKey.auto!==T.primKey.auto)O.recreate=!0,g.change.push(O);else{var z=C.idxByName,H=T.idxByName,I=void 0;for(I in z)H[I]||O.del.push(I);for(I in H){var $=z[I],U=H[I];$?$.src!==U.src&&O.change.push(U):O.add.push(U)}(0<O.del.length||0<O.add.length||0<O.change.length)&&g.change.push(O)}}else g.add.push([p,T])}return g}function $s(o,f,p,g){var C=o.db.createObjectStore(f,p.keyPath?{keyPath:p.keyPath,autoIncrement:p.auto}:{autoIncrement:p.auto});return g.forEach(function(T){return os(C,T)}),C}function Xo(o,f){_(o).forEach(function(p){f.db.objectStoreNames.contains(p)||(tr&&console.debug("Dexie: Creating missing table",p),$s(f,p,o[p].primKey,o[p].indexes))})}function os(o,f){o.createIndex(f.name,f.keyPath,{unique:f.unique,multiEntry:f.multi})}function Fa(o,f,p){var g={};return ke(f.objectStoreNames,0).forEach(function(C){for(var T=p.objectStore(C),O=Qr(ns(I=T.keyPath),I||"",!0,!1,!!T.autoIncrement,I&&typeof I!="string",!0),z=[],H=0;H<T.indexNames.length;++H){var $=T.index(T.indexNames[H]),I=$.keyPath,$=Qr($.name,I,!!$.unique,!!$.multiEntry,!1,I&&typeof I!="string",!1);z.push($)}g[C]=Qa(C,O,z)}),g}function ls(o,f,p){for(var g=p.db.objectStoreNames,C=0;C<g.length;++C){var T=g[C],O=p.objectStore(T);o._hasGetAll="getAll"in O;for(var z=0;z<O.indexNames.length;++z){var H=O.indexNames[z],I=O.index(H).keyPath,$=typeof I=="string"?I:"["+ke(I).join("+")+"]";!f[T]||(I=f[T].idxByName[$])&&(I.name=H,delete f[T].idxByName[$],f[T].idxByName[H]=I)}}typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&m.WorkerGlobalScope&&m instanceof m.WorkerGlobalScope&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604&&(o._hasGetAll=!1)}function Fo(o){return o.split(",").map(function(f,p){var T=f.split(":"),g=(C=T[1])===null||C===void 0?void 0:C.trim(),C=(f=T[0].trim()).replace(/([&*]|\+\+)/g,""),T=/^\[/.test(C)?C.match(/^\[(.*)\]$/)[1].split("+"):C;return Qr(C,T||null,/\&/.test(f),/\*/.test(f),/\+\+/.test(f),w(T),p===0,g)})}var Ec=(Za.prototype._createTableSchema=Qa,Za.prototype._parseIndexSyntax=Fo,Za.prototype._parseStoresSpec=function(o,f){var p=this;_(o).forEach(function(g){if(o[g]!==null){var C=p._parseIndexSyntax(o[g]),T=C.shift();if(!T)throw new ze.Schema("Invalid schema for table "+g+": "+o[g]);if(T.unique=!0,T.multi)throw new ze.Schema("Primary key cannot be multiEntry*");C.forEach(function(O){if(O.auto)throw new ze.Schema("Only primary key can be marked as autoIncrement (++)");if(!O.keyPath)throw new ze.Schema("Index must have a name and cannot be an empty string")}),C=p._createTableSchema(g,T,C),f[g]=C}})},Za.prototype.stores=function(p){var f=this.db;this._cfg.storesSource=this._cfg.storesSource?x(this._cfg.storesSource,p):p;var p=f._versions,g={},C={};return p.forEach(function(T){x(g,T._cfg.storesSource),C=T._cfg.dbschema={},T._parseStoresSpec(g,C)}),f._dbSchema=C,Ri(f,[f._allTables,f,f.Transaction.prototype]),as(f,[f._allTables,f,f.Transaction.prototype,this._cfg.tables],_(C),C),f._storeNames=_(C),this},Za.prototype.upgrade=function(o){return this._cfg.contentUpgrade=Pr(this._cfg.contentUpgrade||Ht,o),this},Za);function Za(){}function Xs(o,f){var p=o._dbNamesDB;return p||(p=o._dbNamesDB=new $r(st,{addons:[],indexedDB:o,IDBKeyRange:f})).version(1).stores({dbnames:"name"}),p.table("dbnames")}function cs(o){return o&&typeof o.databases=="function"}function Fs(o){return G(function(){return Qe.letThrough=!0,o()})}function Zs(o){return!("from"in o)}var Zn=function(o,f){if(!this){var p=new Zn;return o&&"d"in o&&x(p,o),p}x(this,arguments.length?{d:1,from:o,to:1<arguments.length?f:o}:{d:0})};function Ni(o,f,p){var g=le(f,p);if(!isNaN(g)){if(0<g)throw RangeError();if(Zs(o))return x(o,{from:f,to:p,d:1});var C=o.l,g=o.r;if(le(p,o.from)<0)return C?Ni(C,f,p):o.l={from:f,to:p,d:1,l:null,r:null},Jo(o);if(0<le(f,o.to))return g?Ni(g,f,p):o.r={from:f,to:p,d:1,l:null,r:null},Jo(o);le(f,o.from)<0&&(o.from=f,o.l=null,o.d=g?g.d+1:1),0<le(p,o.to)&&(o.to=p,o.r=null,o.d=o.l?o.l.d+1:1),p=!o.r,C&&!o.l&&Ea(o,C),g&&p&&Ea(o,g)}}function Ea(o,f){Zs(f)||(function p(g,H){var T=H.from,O=H.to,z=H.l,H=H.r;Ni(g,T,O),z&&p(g,z),H&&p(g,H)})(o,f)}function Zo(o,f){var p=us(f),g=p.next();if(g.done)return!1;for(var C=g.value,T=us(o),O=T.next(C.from),z=O.value;!g.done&&!O.done;){if(le(z.from,C.to)<=0&&0<=le(z.to,C.from))return!0;le(C.from,z.from)<0?C=(g=p.next(z.from)).value:z=(O=T.next(C.from)).value}return!1}function us(o){var f=Zs(o)?null:{s:0,n:o};return{next:function(p){for(var g=0<arguments.length;f;)switch(f.s){case 0:if(f.s=1,g)for(;f.n.l&&le(p,f.n.from)<0;)f={up:f,n:f.n.l,s:1};else for(;f.n.l;)f={up:f,n:f.n.l,s:1};case 1:if(f.s=2,!g||le(p,f.n.to)<=0)return{value:f.n,done:!1};case 2:if(f.n.r){f.s=3,f={up:f,n:f.n.r,s:0};continue}case 3:f=f.up}return{done:!0}}}}function Jo(o){var f,p,g=(((f=o.r)===null||f===void 0?void 0:f.d)||0)-(((p=o.l)===null||p===void 0?void 0:p.d)||0),C=1<g?"r":g<-1?"l":"";C&&(f=C=="r"?"l":"r",p=s({},o),g=o[C],o.from=g.from,o.to=g.to,o[C]=g[C],p[C]=g[f],(o[f]=p).d=Js(p)),o.d=Js(o)}function Js(p){var f=p.r,p=p.l;return(f?p?Math.max(f.d,p.d):f.d:p?p.d:0)+1}function fs(o,f){return _(f).forEach(function(p){o[p]?Ea(o[p],f[p]):o[p]=(function g(C){var T,O,z={};for(T in C)R(C,T)&&(O=C[T],z[T]=!O||typeof O!="object"||Te.has(O.constructor)?O:g(O));return z})(f[p])}),o}function Ws(o,f){return o.all||f.all||Object.keys(o).some(function(p){return f[p]&&Zo(f[p],o[p])})}N(Zn.prototype,((vr={add:function(o){return Ea(this,o),this},addKey:function(o){return Ni(this,o,o),this},addKeys:function(o){var f=this;return o.forEach(function(p){return Ni(f,p,p)}),this},hasKey:function(o){var f=us(this).next(o).value;return f&&le(f.from,o)<=0&&0<=le(f.to,o)}})[J]=function(){return us(this)},vr));var wa={},eo={},to=!1;function ds(o){fs(eo,o),to||(to=!0,setTimeout(function(){to=!1,no(eo,!(eo={}))},0))}function no(o,f){f===void 0&&(f=!1);var p=new Set;if(o.all)for(var g=0,C=Object.values(wa);g<C.length;g++)Wo(O=C[g],o,p,f);else for(var T in o){var O,z=/^idb\:\/\/(.*)\/(.*)\//.exec(T);z&&(T=z[1],z=z[2],(O=wa["idb://".concat(T,"/").concat(z)])&&Wo(O,o,p,f))}p.forEach(function(H){return H()})}function Wo(o,f,p,g){for(var C=[],T=0,O=Object.entries(o.queries.query);T<O.length;T++){for(var z=O[T],H=z[0],I=[],$=0,U=z[1];$<U.length;$++){var F=U[$];Ws(f,F.obsSet)?F.subscribers.forEach(function(X){return p.add(X)}):g&&I.push(F)}g&&C.push([H,I])}if(g)for(var K=0,Y=C;K<Y.length;K++){var V=Y[K],H=V[0],I=V[1];o.queries.query[H]=I}}function wc(o){var f=o._state,p=o._deps.indexedDB;if(f.isBeingOpened||o.idbdb)return f.dbReadyPromise.then(function(){return f.dbOpenError?tt(f.dbOpenError):o});f.isBeingOpened=!0,f.dbOpenError=null,f.openComplete=!1;var g=f.openCanceller,C=Math.round(10*o.verno),T=!1;function O(){if(f.openCanceller!==g)throw new ze.DatabaseClosed("db.open() was cancelled")}function z(){return new He(function(F,K){if(O(),!p)throw new ze.MissingAPI;var Y=o.name,V=f.autoSchema||!C?p.open(Y):p.open(Y,C);if(!V)throw new ze.MissingAPI;V.onerror=zr(K),V.onblocked=on(o._fireOnBlocked),V.onupgradeneeded=on(function(X){var W;$=V.transaction,f.autoSchema&&!o._options.allowEmptyDB?(V.onerror=Sa,$.abort(),V.result.close(),(W=p.deleteDatabase(Y)).onsuccess=W.onerror=on(function(){K(new ze.NoSuchDatabase("Database ".concat(Y," doesnt exist")))})):($.onerror=zr(K),X=X.oldVersion>Math.pow(2,62)?0:X.oldVersion,U=X<1,o.idbdb=V.result,T&&is(o,$),Ai(o,X/10,$,K))},K),V.onsuccess=on(function(){$=null;var X,W,ne,he,xe,Be=o.idbdb=V.result,Pe=ke(Be.objectStoreNames);if(0<Pe.length)try{var Ae=Be.transaction((he=Pe).length===1?he[0]:he,"readonly");if(f.autoSchema)W=Be,ne=Ae,(X=o).verno=W.version/10,ne=X._dbSchema=Fa(0,W,ne),X._storeNames=ke(W.objectStoreNames,0),as(X,[X._allTables],_(ne),ne);else if(ls(o,o._dbSchema,Ae),((xe=ss(Fa(0,(xe=o).idbdb,Ae),xe._dbSchema)).add.length||xe.change.some(function(Ue){return Ue.add.length||Ue.change.length}))&&!T)return console.warn("Dexie SchemaDiff: Schema was extended without increasing the number passed to db.version(). Dexie will add missing parts and increment native version number to workaround this."),Be.close(),C=Be.version+1,T=!0,F(z());da(o,Ae)}catch{}Fe.push(o),Be.onversionchange=on(function(Ue){f.vcFired=!0,o.on("versionchange").fire(Ue)}),Be.onclose=on(function(){o.close({disableAutoOpen:!1})}),U&&(xe=o._deps,Ae=Y,Be=xe.indexedDB,xe=xe.IDBKeyRange,cs(Be)||Ae===st||Xs(Be,xe).put({name:Ae}).catch(Ht)),F()},K)}).catch(function(F){switch(F?.name){case"UnknownError":if(0<f.PR1398_maxLoop)return f.PR1398_maxLoop--,console.warn("Dexie: Workaround for Chrome UnknownError on open()"),z();break;case"VersionError":if(0<C)return C=0,z()}return He.reject(F)})}var H,I=f.dbReadyResolve,$=null,U=!1;return He.race([g,(typeof navigator>"u"?He.resolve():!navigator.userAgentData&&/Safari\//.test(navigator.userAgent)&&!/Chrom(e|ium)\//.test(navigator.userAgent)&&indexedDB.databases?new Promise(function(F){function K(){return indexedDB.databases().finally(F)}H=setInterval(K,100),K()}).finally(function(){return clearInterval(H)}):Promise.resolve()).then(z)]).then(function(){return O(),f.onReadyBeingFired=[],He.resolve(Fs(function(){return o.on.ready.fire(o.vip)})).then(function F(){if(0<f.onReadyBeingFired.length){var K=f.onReadyBeingFired.reduce(Pr,Ht);return f.onReadyBeingFired=[],He.resolve(Fs(function(){return K(o.vip)})).then(F)}})}).finally(function(){f.openCanceller===g&&(f.onReadyBeingFired=null,f.isBeingOpened=!1)}).catch(function(F){f.dbOpenError=F;try{$&&$.abort()}catch{}return g===f.openCanceller&&o._close(),tt(F)}).finally(function(){f.openComplete=!0,I()}).then(function(){var F;return U&&(F={},o.tables.forEach(function(K){K.schema.indexes.forEach(function(Y){Y.name&&(F["idb://".concat(o.name,"/").concat(K.name,"/").concat(Y.name)]=new Zn(-1/0,[[[]]]))}),F["idb://".concat(o.name,"/").concat(K.name,"/")]=F["idb://".concat(o.name,"/").concat(K.name,"/:dels")]=new Zn(-1/0,[[[]]])}),Fn(Ga).fire(F),no(F,!0)),o})}function Oi(o){function f(T){return o.next(T)}var p=C(f),g=C(function(T){return o.throw(T)});function C(T){return function(H){var z=T(H),H=z.value;return z.done?H:H&&typeof H.then=="function"?H.then(p,g):w(H)?Promise.all(H).then(p,g):p(H)}}return C(f)()}function ha(o,f,p){for(var g=w(o)?o.slice():[o],C=0;C<p;++C)g.push(f);return g}var Tc={stack:"dbcore",name:"VirtualIndexMiddleware",level:1,create:function(o){return s(s({},o),{table:function(f){var p=o.table(f),g=p.schema,C={},T=[];function O(U,F,K){var Y=Hn(U),V=C[Y]=C[Y]||[],X=U==null?0:typeof U=="string"?1:U.length,W=0<F,W=s(s({},K),{name:W?"".concat(Y,"(virtual-from:").concat(K.name,")"):K.name,lowLevelIndex:K,isVirtual:W,keyTail:F,keyLength:X,extractKey:Xa(U),unique:!W&&K.unique});return V.push(W),W.isPrimaryKey||T.push(W),1<X&&O(X===2?U[0]:U.slice(0,X-1),F+1,K),V.sort(function(ne,he){return ne.keyTail-he.keyTail}),W}f=O(g.primaryKey.keyPath,0,g.primaryKey),C[":id"]=[f];for(var z=0,H=g.indexes;z<H.length;z++){var I=H[z];O(I.keyPath,0,I)}function $(U){var F,K=U.query.index;return K.isVirtual?s(s({},U),{query:{index:K.lowLevelIndex,range:(F=U.query.range,K=K.keyTail,{type:F.type===1?2:F.type,lower:ha(F.lower,F.lowerOpen?o.MAX_KEY:o.MIN_KEY,K),lowerOpen:!0,upper:ha(F.upper,F.upperOpen?o.MIN_KEY:o.MAX_KEY,K),upperOpen:!0})}}):U}return s(s({},p),{schema:s(s({},g),{primaryKey:f,indexes:T,getIndexByKeyPath:function(U){return(U=C[Hn(U)])&&U[0]}}),count:function(U){return p.count($(U))},query:function(U){return p.query($(U))},openCursor:function(U){var F=U.query.index,K=F.keyTail,Y=F.isVirtual,V=F.keyLength;return Y?p.openCursor($(U)).then(function(W){return W&&X(W)}):p.openCursor(U);function X(W){return Object.create(W,{continue:{value:function(ne){ne!=null?W.continue(ha(ne,U.reverse?o.MAX_KEY:o.MIN_KEY,K)):U.unique?W.continue(W.key.slice(0,V).concat(U.reverse?o.MIN_KEY:o.MAX_KEY,K)):W.continue()}},continuePrimaryKey:{value:function(ne,he){W.continuePrimaryKey(ha(ne,o.MAX_KEY,K),he)}},primaryKey:{get:function(){return W.primaryKey}},key:{get:function(){var ne=W.key;return V===1?ne[0]:ne.slice(0,V)}},value:{get:function(){return W.value}}})}}})}})}};function hs(o,f,p,g){return p=p||{},g=g||"",_(o).forEach(function(C){var T,O,z;R(f,C)?(T=o[C],O=f[C],typeof T=="object"&&typeof O=="object"&&T&&O?(z=qe(T))!==qe(O)?p[g+C]=f[C]:z==="Object"?hs(T,O,p,g+C+"."):T!==O&&(p[g+C]=f[C]):T!==O&&(p[g+C]=f[C])):p[g+C]=void 0}),_(f).forEach(function(C){R(o,C)||(p[g+C]=f[C])}),p}function ps(o,f){return f.type==="delete"?f.keys:f.keys||f.values.map(o.extractKey)}var el={stack:"dbcore",name:"HooksMiddleware",level:2,create:function(o){return s(s({},o),{table:function(f){var p=o.table(f),g=p.schema.primaryKey;return s(s({},p),{mutate:function(C){var T=Qe.trans,O=T.table(f).hook,z=O.deleting,H=O.creating,I=O.updating;switch(C.type){case"add":if(H.fire===Ht)break;return T._promise("readwrite",function(){return $(C)},!0);case"put":if(H.fire===Ht&&I.fire===Ht)break;return T._promise("readwrite",function(){return $(C)},!0);case"delete":if(z.fire===Ht)break;return T._promise("readwrite",function(){return $(C)},!0);case"deleteRange":if(z.fire===Ht)break;return T._promise("readwrite",function(){return(function U(F,K,Y){return p.query({trans:F,values:!1,query:{index:g,range:K},limit:Y}).then(function(V){var X=V.result;return $({type:"delete",keys:X,trans:F}).then(function(W){return 0<W.numFailures?Promise.reject(W.failures[0]):X.length<Y?{failures:[],numFailures:0,lastResult:void 0}:U(F,s(s({},K),{lower:X[X.length-1],lowerOpen:!0}),Y)})})})(C.trans,C.range,1e4)},!0)}return p.mutate(C);function $(U){var F,K,Y,V=Qe.trans,X=U.keys||ps(g,U);if(!X)throw new Error("Keys missing");return(U=U.type==="add"||U.type==="put"?s(s({},U),{keys:X}):s({},U)).type!=="delete"&&(U.values=c([],U.values)),U.keys&&(U.keys=c([],U.keys)),F=p,Y=X,((K=U).type==="add"?Promise.resolve([]):F.getMany({trans:K.trans,keys:Y,cache:"immutable"})).then(function(W){var ne=X.map(function(he,xe){var Be,Pe,Ae,Ue=W[xe],Ke={onerror:null,onsuccess:null};return U.type==="delete"?z.fire.call(Ke,he,Ue,V):U.type==="add"||Ue===void 0?(Be=H.fire.call(Ke,he,U.values[xe],V),he==null&&Be!=null&&(U.keys[xe]=he=Be,g.outbound||et(U.values[xe],g.keyPath,he))):(Be=hs(Ue,U.values[xe]),(Pe=I.fire.call(Ke,Be,he,Ue,V))&&(Ae=U.values[xe],Object.keys(Pe).forEach(function(Ne){R(Ae,Ne)?Ae[Ne]=Pe[Ne]:et(Ae,Ne,Pe[Ne])}))),Ke});return p.mutate(U).then(function(he){for(var xe=he.failures,Be=he.results,Pe=he.numFailures,he=he.lastResult,Ae=0;Ae<X.length;++Ae){var Ue=(Be||X)[Ae],Ke=ne[Ae];Ue==null?Ke.onerror&&Ke.onerror(xe[Ae]):Ke.onsuccess&&Ke.onsuccess(U.type==="put"&&W[Ae]?U.values[Ae]:Ue)}return{failures:xe,results:Be,numFailures:Pe,lastResult:he}}).catch(function(he){return ne.forEach(function(xe){return xe.onerror&&xe.onerror(he)}),Promise.reject(he)})})}}})}})}};function ro(o,f,p){try{if(!f||f.keys.length<o.length)return null;for(var g=[],C=0,T=0;C<f.keys.length&&T<o.length;++C)le(f.keys[C],o[T])===0&&(g.push(p?ue(f.values[C]):f.values[C]),++T);return g.length===o.length?g:null}catch{return null}}var tl={stack:"dbcore",level:-1,create:function(o){return{table:function(f){var p=o.table(f);return s(s({},p),{getMany:function(g){if(!g.cache)return p.getMany(g);var C=ro(g.keys,g.trans._cache,g.cache==="clone");return C?He.resolve(C):p.getMany(g).then(function(T){return g.trans._cache={keys:g.keys,values:g.cache==="clone"?ue(T):T},T})},mutate:function(g){return g.type!=="add"&&(g.trans._cache=null),p.mutate(g)}})}}}};function Ta(o,f){return o.trans.mode==="readonly"&&!!o.subscr&&!o.trans.explicit&&o.trans.db._options.cache!=="disabled"&&!f.schema.primaryKey.outbound}function nl(o,f){switch(o){case"query":return f.values&&!f.unique;case"get":case"getMany":case"count":case"openCursor":return!1}}var kc={stack:"dbcore",level:0,name:"Observability",create:function(o){var f=o.schema.name,p=new Zn(o.MIN_KEY,o.MAX_KEY);return s(s({},o),{transaction:function(g,C,T){if(Qe.subscr&&C!=="readonly")throw new ze.ReadOnly("Readwrite transaction in liveQuery context. Querier source: ".concat(Qe.querier));return o.transaction(g,C,T)},table:function(g){var C=o.table(g),T=C.schema,O=T.primaryKey,U=T.indexes,z=O.extractKey,H=O.outbound,I=O.autoIncrement&&U.filter(function(K){return K.compound&&K.keyPath.includes(O.keyPath)}),$=s(s({},C),{mutate:function(K){function Y(Ne){return Ne="idb://".concat(f,"/").concat(g,"/").concat(Ne),he[Ne]||(he[Ne]=new Zn)}var V,X,W,ne=K.trans,he=K.mutatedParts||(K.mutatedParts={}),xe=Y(""),Be=Y(":dels"),Pe=K.type,Ke=K.type==="deleteRange"?[K.range]:K.type==="delete"?[K.keys]:K.values.length<50?[ps(O,K).filter(function(Ne){return Ne}),K.values]:[],Ae=Ke[0],Ue=Ke[1],Ke=K.trans._cache;return w(Ae)?(xe.addKeys(Ae),(Ke=Pe==="delete"||Ae.length===Ue.length?ro(Ae,Ke):null)||Be.addKeys(Ae),(Ke||Ue)&&(V=Y,X=Ke,W=Ue,T.indexes.forEach(function(Ne){var rt=V(Ne.name||"");function St(Kt){return Kt!=null?Ne.extractKey(Kt):null}function Dt(Kt){return Ne.multiEntry&&w(Kt)?Kt.forEach(function(Jn){return rt.addKey(Jn)}):rt.addKey(Kt)}(X||W).forEach(function(Kt,In){var Rt=X&&St(X[In]),In=W&&St(W[In]);le(Rt,In)!==0&&(Rt!=null&&Dt(Rt),In!=null&&Dt(In))})}))):Ae?(Ue={from:(Ue=Ae.lower)!==null&&Ue!==void 0?Ue:o.MIN_KEY,to:(Ue=Ae.upper)!==null&&Ue!==void 0?Ue:o.MAX_KEY},Be.add(Ue),xe.add(Ue)):(xe.add(p),Be.add(p),T.indexes.forEach(function(Ne){return Y(Ne.name).add(p)})),C.mutate(K).then(function(Ne){return!Ae||K.type!=="add"&&K.type!=="put"||(xe.addKeys(Ne.results),I&&I.forEach(function(rt){for(var St=K.values.map(function(Rt){return rt.extractKey(Rt)}),Dt=rt.keyPath.findIndex(function(Rt){return Rt===O.keyPath}),Kt=0,Jn=Ne.results.length;Kt<Jn;++Kt)St[Kt][Dt]=Ne.results[Kt];Y(rt.name).addKeys(St)})),ne.mutatedParts=fs(ne.mutatedParts||{},he),Ne})}}),U=function(Y){var V=Y.query,Y=V.index,V=V.range;return[Y,new Zn((Y=V.lower)!==null&&Y!==void 0?Y:o.MIN_KEY,(V=V.upper)!==null&&V!==void 0?V:o.MAX_KEY)]},F={get:function(K){return[O,new Zn(K.key)]},getMany:function(K){return[O,new Zn().addKeys(K.keys)]},count:U,query:U,openCursor:U};return _(F).forEach(function(K){$[K]=function(Y){var V=Qe.subscr,X=!!V,W=Ta(Qe,C)&&nl(K,Y)?Y.obsSet={}:V;if(X){var ne=function(Ue){return Ue="idb://".concat(f,"/").concat(g,"/").concat(Ue),W[Ue]||(W[Ue]=new Zn)},he=ne(""),xe=ne(":dels"),V=F[K](Y),X=V[0],V=V[1];if((K==="query"&&X.isPrimaryKey&&!Y.values?xe:ne(X.name||"")).add(V),!X.isPrimaryKey){if(K!=="count"){var Be=K==="query"&&H&&Y.values&&C.query(s(s({},Y),{values:!1}));return C[K].apply(this,arguments).then(function(Ue){if(K==="query"){if(H&&Y.values)return Be.then(function(St){return St=St.result,he.addKeys(St),Ue});var Ke=Y.values?Ue.result.map(z):Ue.result;(Y.values?he:xe).addKeys(Ke)}else if(K==="openCursor"){var Ne=Ue,rt=Y.values;return Ne&&Object.create(Ne,{key:{get:function(){return xe.addKey(Ne.primaryKey),Ne.key}},primaryKey:{get:function(){var St=Ne.primaryKey;return xe.addKey(St),St}},value:{get:function(){return rt&&he.addKey(Ne.primaryKey),Ne.value}}})}return Ue})}xe.add(p)}}return C[K].apply(this,arguments)}}),$}})}};function rl(o,f,p){if(p.numFailures===0)return f;if(f.type==="deleteRange")return null;var g=f.keys?f.keys.length:"values"in f&&f.values?f.values.length:1;return p.numFailures===g?null:(f=s({},f),w(f.keys)&&(f.keys=f.keys.filter(function(C,T){return!(T in p.failures)})),"values"in f&&w(f.values)&&(f.values=f.values.filter(function(C,T){return!(T in p.failures)})),f)}function ms(o,f){return p=o,((g=f).lower===void 0||(g.lowerOpen?0<le(p,g.lower):0<=le(p,g.lower)))&&(o=o,(f=f).upper===void 0||(f.upperOpen?le(o,f.upper)<0:le(o,f.upper)<=0));var p,g}function ao(o,f,F,g,C,T){if(!F||F.length===0)return o;var O=f.query.index,z=O.multiEntry,H=f.query.range,I=g.schema.primaryKey.extractKey,$=O.extractKey,U=(O.lowLevelIndex||O).extractKey,F=F.reduce(function(K,Y){var V=K,X=[];if(Y.type==="add"||Y.type==="put")for(var W=new Zn,ne=Y.values.length-1;0<=ne;--ne){var he,xe=Y.values[ne],Be=I(xe);W.hasKey(Be)||(he=$(xe),(z&&w(he)?he.some(function(Ne){return ms(Ne,H)}):ms(he,H))&&(W.addKey(Be),X.push(xe)))}switch(Y.type){case"add":var Pe=new Zn().addKeys(f.values?K.map(function(rt){return I(rt)}):K),V=K.concat(f.values?X.filter(function(rt){return rt=I(rt),!Pe.hasKey(rt)&&(Pe.addKey(rt),!0)}):X.map(function(rt){return I(rt)}).filter(function(rt){return!Pe.hasKey(rt)&&(Pe.addKey(rt),!0)}));break;case"put":var Ae=new Zn().addKeys(Y.values.map(function(rt){return I(rt)}));V=K.filter(function(rt){return!Ae.hasKey(f.values?I(rt):rt)}).concat(f.values?X:X.map(function(rt){return I(rt)}));break;case"delete":var Ue=new Zn().addKeys(Y.keys);V=K.filter(function(rt){return!Ue.hasKey(f.values?I(rt):rt)});break;case"deleteRange":var Ke=Y.range;V=K.filter(function(rt){return!ms(I(rt),Ke)})}return V},o);return F===o?o:(F.sort(function(K,Y){return le(U(K),U(Y))||le(I(K),I(Y))}),f.limit&&f.limit<1/0&&(F.length>f.limit?F.length=f.limit:o.length===f.limit&&F.length<f.limit&&(C.dirty=!0)),T?Object.freeze(F):F)}function Ja(o,f){return le(o.lower,f.lower)===0&&le(o.upper,f.upper)===0&&!!o.lowerOpen==!!f.lowerOpen&&!!o.upperOpen==!!f.upperOpen}function Di(o,f){return(function(p,g,C,T){if(p===void 0)return g!==void 0?-1:0;if(g===void 0)return 1;if((g=le(p,g))===0){if(C&&T)return 0;if(C)return 1;if(T)return-1}return g})(o.lower,f.lower,o.lowerOpen,f.lowerOpen)<=0&&0<=(function(p,g,C,T){if(p===void 0)return g!==void 0?1:0;if(g===void 0)return-1;if((g=le(p,g))===0){if(C&&T)return 0;if(C)return-1;if(T)return 1}return g})(o.upper,f.upper,o.upperOpen,f.upperOpen)}function Mc(o,f,p,g){o.subscribers.add(p),g.addEventListener("abort",function(){var C,T;o.subscribers.delete(p),o.subscribers.size===0&&(C=o,T=f,setTimeout(function(){C.subscribers.size===0&&Ge(T,C)},3e3))})}var gs={stack:"dbcore",level:0,name:"Cache",create:function(o){var f=o.schema.name;return s(s({},o),{transaction:function(p,g,C){var T,O,z=o.transaction(p,g,C);return g==="readwrite"&&(O=(T=new AbortController).signal,C=function(H){return function(){if(T.abort(),g==="readwrite"){for(var I=new Set,$=0,U=p;$<U.length;$++){var F=U[$],K=wa["idb://".concat(f,"/").concat(F)];if(K){var Y=o.table(F),V=K.optimisticOps.filter(function(rt){return rt.trans===z});if(z._explicit&&H&&z.mutatedParts)for(var X=0,W=Object.values(K.queries.query);X<W.length;X++)for(var ne=0,he=(Pe=W[X]).slice();ne<he.length;ne++)Ws((Ae=he[ne]).obsSet,z.mutatedParts)&&(Ge(Pe,Ae),Ae.subscribers.forEach(function(rt){return I.add(rt)}));else if(0<V.length){K.optimisticOps=K.optimisticOps.filter(function(rt){return rt.trans!==z});for(var xe=0,Be=Object.values(K.queries.query);xe<Be.length;xe++)for(var Pe,Ae,Ue,Ke=0,Ne=(Pe=Be[xe]).slice();Ke<Ne.length;Ke++)(Ae=Ne[Ke]).res!=null&&z.mutatedParts&&(H&&!Ae.dirty?(Ue=Object.isFrozen(Ae.res),Ue=ao(Ae.res,Ae.req,V,Y,Ae,Ue),Ae.dirty?(Ge(Pe,Ae),Ae.subscribers.forEach(function(rt){return I.add(rt)})):Ue!==Ae.res&&(Ae.res=Ue,Ae.promise=He.resolve({result:Ue}))):(Ae.dirty&&Ge(Pe,Ae),Ae.subscribers.forEach(function(rt){return I.add(rt)})))}}}I.forEach(function(rt){return rt()})}}},z.addEventListener("abort",C(!1),{signal:O}),z.addEventListener("error",C(!1),{signal:O}),z.addEventListener("complete",C(!0),{signal:O})),z},table:function(p){var g=o.table(p),C=g.schema.primaryKey;return s(s({},g),{mutate:function(T){var O=Qe.trans;if(C.outbound||O.db._options.cache==="disabled"||O.explicit||O.idbtrans.mode!=="readwrite")return g.mutate(T);var z=wa["idb://".concat(f,"/").concat(p)];return z?(O=g.mutate(T),T.type!=="add"&&T.type!=="put"||!(50<=T.values.length||ps(C,T).some(function(H){return H==null}))?(z.optimisticOps.push(T),T.mutatedParts&&ds(T.mutatedParts),O.then(function(H){0<H.numFailures&&(Ge(z.optimisticOps,T),(H=rl(0,T,H))&&z.optimisticOps.push(H),T.mutatedParts&&ds(T.mutatedParts))}),O.catch(function(){Ge(z.optimisticOps,T),T.mutatedParts&&ds(T.mutatedParts)})):O.then(function(H){var I=rl(0,s(s({},T),{values:T.values.map(function($,U){var F;return H.failures[U]?$:($=(F=C.keyPath)!==null&&F!==void 0&&F.includes(".")?ue($):s({},$),et($,C.keyPath,H.results[U]),$)})}),H);z.optimisticOps.push(I),queueMicrotask(function(){return T.mutatedParts&&ds(T.mutatedParts)})}),O):g.mutate(T)},query:function(T){if(!Ta(Qe,g)||!nl("query",T))return g.query(T);var O=((I=Qe.trans)===null||I===void 0?void 0:I.db._options.cache)==="immutable",U=Qe,z=U.requery,H=U.signal,I=(function(Y,V,X,W){var ne=wa["idb://".concat(Y,"/").concat(V)];if(!ne)return[];if(!(V=ne.queries[X]))return[null,!1,ne,null];var he=V[(W.query?W.query.index.name:null)||""];if(!he)return[null,!1,ne,null];switch(X){case"query":var xe=he.find(function(Be){return Be.req.limit===W.limit&&Be.req.values===W.values&&Ja(Be.req.query.range,W.query.range)});return xe?[xe,!0,ne,he]:[he.find(function(Be){return("limit"in Be.req?Be.req.limit:1/0)>=W.limit&&(!W.values||Be.req.values)&&Di(Be.req.query.range,W.query.range)}),!1,ne,he];case"count":return xe=he.find(function(Be){return Ja(Be.req.query.range,W.query.range)}),[xe,!!xe,ne,he]}})(f,p,"query",T),$=I[0],U=I[1],F=I[2],K=I[3];return $&&U?$.obsSet=T.obsSet:(U=g.query(T).then(function(Y){var V=Y.result;if($&&($.res=V),O){for(var X=0,W=V.length;X<W;++X)Object.freeze(V[X]);Object.freeze(V)}else Y.result=ue(V);return Y}).catch(function(Y){return K&&$&&Ge(K,$),Promise.reject(Y)}),$={obsSet:T.obsSet,promise:U,subscribers:new Set,type:"query",req:T,dirty:!1},K?K.push($):(K=[$],(F=F||(wa["idb://".concat(f,"/").concat(p)]={queries:{query:{},count:{}},objs:new Map,optimisticOps:[],unsignaledParts:{}})).queries.query[T.query.index.name||""]=K)),Mc($,K,z,H),$.promise.then(function(Y){return{result:ao(Y.result,T,F?.optimisticOps,g,$,O)}})}})}})}};function zi(o,f){return new Proxy(o,{get:function(p,g,C){return g==="db"?f:Reflect.get(p,g,C)}})}var $r=(bn.prototype.version=function(o){if(isNaN(o)||o<.1)throw new ze.Type("Given version is not a positive number");if(o=Math.round(10*o)/10,this.idbdb||this._state.isBeingOpened)throw new ze.Schema("Cannot add version when database is open");this.verno=Math.max(this.verno,o);var f=this._versions,p=f.filter(function(g){return g._cfg.version===o})[0];return p||(p=new this.Version(o),f.push(p),f.sort(Qs),p.stores({}),this._state.autoSchema=!1,p)},bn.prototype._whenReady=function(o){var f=this;return this.idbdb&&(this._state.openComplete||Qe.letThrough||this._vip)?o():new He(function(p,g){if(f._state.openComplete)return g(new ze.DatabaseClosed(f._state.dbOpenError));if(!f._state.isBeingOpened){if(!f._state.autoOpen)return void g(new ze.DatabaseClosed);f.open().catch(Ht)}f._state.dbReadyPromise.then(p,g)}).then(o)},bn.prototype.use=function(o){var f=o.stack,p=o.create,g=o.level,C=o.name;return C&&this.unuse({stack:f,name:C}),o=this._middlewares[f]||(this._middlewares[f]=[]),o.push({stack:f,create:p,level:g??10,name:C}),o.sort(function(T,O){return T.level-O.level}),this},bn.prototype.unuse=function(o){var f=o.stack,p=o.name,g=o.create;return f&&this._middlewares[f]&&(this._middlewares[f]=this._middlewares[f].filter(function(C){return g?C.create!==g:!!p&&C.name!==p})),this},bn.prototype.open=function(){var o=this;return pt(Cn,function(){return wc(o)})},bn.prototype._close=function(){this.on.close.fire(new CustomEvent("close"));var o=this._state,f=Fe.indexOf(this);if(0<=f&&Fe.splice(f,1),this.idbdb){try{this.idbdb.close()}catch{}this.idbdb=null}o.isBeingOpened||(o.dbReadyPromise=new He(function(p){o.dbReadyResolve=p}),o.openCanceller=new He(function(p,g){o.cancelOpen=g}))},bn.prototype.close=function(p){var f=(p===void 0?{disableAutoOpen:!0}:p).disableAutoOpen,p=this._state;f?(p.isBeingOpened&&p.cancelOpen(new ze.DatabaseClosed),this._close(),p.autoOpen=!1,p.dbOpenError=new ze.DatabaseClosed):(this._close(),p.autoOpen=this._options.autoOpen||p.isBeingOpened,p.openComplete=!1,p.dbOpenError=null)},bn.prototype.delete=function(o){var f=this;o===void 0&&(o={disableAutoOpen:!0});var p=0<arguments.length&&typeof arguments[0]!="object",g=this._state;return new He(function(C,T){function O(){f.close(o);var z=f._deps.indexedDB.deleteDatabase(f.name);z.onsuccess=on(function(){var H,I,$;H=f._deps,I=f.name,$=H.indexedDB,H=H.IDBKeyRange,cs($)||I===st||Xs($,H).delete(I).catch(Ht),C()}),z.onerror=zr(T),z.onblocked=f._fireOnBlocked}if(p)throw new ze.InvalidArgument("Invalid closeOptions argument to db.delete()");g.isBeingOpened?g.dbReadyPromise.then(O):O()})},bn.prototype.backendDB=function(){return this.idbdb},bn.prototype.isOpen=function(){return this.idbdb!==null},bn.prototype.hasBeenClosed=function(){var o=this._state.dbOpenError;return o&&o.name==="DatabaseClosed"},bn.prototype.hasFailed=function(){return this._state.dbOpenError!==null},bn.prototype.dynamicallyOpened=function(){return this._state.autoSchema},Object.defineProperty(bn.prototype,"tables",{get:function(){var o=this;return _(this._allTables).map(function(f){return o._allTables[f]})},enumerable:!1,configurable:!0}),bn.prototype.transaction=function(){var o=(function(f,p,g){var C=arguments.length;if(C<2)throw new ze.InvalidArgument("Too few arguments");for(var T=new Array(C-1);--C;)T[C-1]=arguments[C];return g=T.pop(),[f,Oe(T),g]}).apply(this,arguments);return this._transaction.apply(this,o)},bn.prototype._transaction=function(o,f,p){var g=this,C=Qe.trans;C&&C.db===this&&o.indexOf("!")===-1||(C=null);var T,O,z=o.indexOf("?")!==-1;o=o.replace("!","").replace("?","");try{if(O=f.map(function(I){if(I=I instanceof g.Table?I.name:I,typeof I!="string")throw new TypeError("Invalid table argument to Dexie.transaction(). Only Table or String are allowed");return I}),o=="r"||o===Ie)T=Ie;else{if(o!="rw"&&o!=Ze)throw new ze.InvalidArgument("Invalid transaction mode: "+o);T=Ze}if(C){if(C.mode===Ie&&T===Ze){if(!z)throw new ze.SubTransaction("Cannot enter a sub-transaction with READWRITE mode when parent transaction is READONLY");C=null}C&&O.forEach(function(I){if(C&&C.storeNames.indexOf(I)===-1){if(!z)throw new ze.SubTransaction("Table "+I+" not included in parent transaction.");C=null}}),z&&C&&!C.active&&(C=null)}}catch(I){return C?C._promise(null,function($,U){U(I)}):tt(I)}var H=(function I($,U,F,K,Y){return He.resolve().then(function(){var V=Qe.transless||Qe,X=$._createTransaction(U,F,$._dbSchema,K);if(X.explicit=!0,V={trans:X,transless:V},K)X.idbtrans=K.idbtrans;else try{X.create(),X.idbtrans._explicit=!0,$._state.PR1398_maxLoop=3}catch(he){return he.name===dt.InvalidState&&$.isOpen()&&0<--$._state.PR1398_maxLoop?(console.warn("Dexie: Need to reopen db"),$.close({disableAutoOpen:!1}),$.open().then(function(){return I($,U,F,null,Y)})):tt(he)}var W,ne=L(Y);return ne&&fe(),V=He.follow(function(){var he;(W=Y.call(X,X))&&(ne?(he=_e.bind(null,null),W.then(he,he)):typeof W.next=="function"&&typeof W.throw=="function"&&(W=Oi(W)))},V),(W&&typeof W.then=="function"?He.resolve(W).then(function(he){return X.active?he:tt(new ze.PrematureCommit("Transaction committed too early. See http://bit.ly/2kdckMn"))}):V.then(function(){return W})).then(function(he){return K&&X._resolve(),X._completion.then(function(){return he})}).catch(function(he){return X._reject(he),tt(he)})})}).bind(null,this,T,O,C,p);return C?C._promise(T,H,"lock"):Qe.trans?pt(Qe.transless,function(){return g._whenReady(H)}):this._whenReady(H)},bn.prototype.table=function(o){if(!R(this._allTables,o))throw new ze.InvalidTable("Table ".concat(o," does not exist"));return this._allTables[o]},bn);function bn(o,f){var p=this;this._middlewares={},this.verno=0;var g=bn.dependencies;this._options=f=s({addons:bn.addons,autoOpen:!0,indexedDB:g.indexedDB,IDBKeyRange:g.IDBKeyRange,cache:"cloned"},f),this._deps={indexedDB:f.indexedDB,IDBKeyRange:f.IDBKeyRange},g=f.addons,this._dbSchema={},this._versions=[],this._storeNames=[],this._allTables={},this.idbdb=null,this._novip=this;var C,T,O,z,H,I={dbOpenError:null,isBeingOpened:!1,onReadyBeingFired:null,openComplete:!1,dbReadyResolve:Ht,dbReadyPromise:null,cancelOpen:Ht,openCanceller:null,autoSchema:!0,PR1398_maxLoop:3,autoOpen:f.autoOpen};I.dbReadyPromise=new He(function(U){I.dbReadyResolve=U}),I.openCanceller=new He(function(U,F){I.cancelOpen=F}),this._state=I,this.name=o,this.on=Nt(this,"populate","blocked","versionchange","close",{ready:[Pr,Ht]}),this.once=function(U,F){var K=function(){for(var Y=[],V=0;V<arguments.length;V++)Y[V]=arguments[V];p.on(U).unsubscribe(K),F.apply(p,Y)};return p.on(U,K)},this.on.ready.subscribe=we(this.on.ready.subscribe,function(U){return function(F,K){bn.vip(function(){var Y,V=p._state;V.openComplete?(V.dbOpenError||He.resolve().then(F),K&&U(F)):V.onReadyBeingFired?(V.onReadyBeingFired.push(F),K&&U(F)):(U(F),Y=p,K||U(function X(){Y.on.ready.unsubscribe(F),Y.on.ready.unsubscribe(X)}))})}}),this.Collection=(C=this,wt(yn.prototype,function(W,X){this.db=C;var K=Ve,Y=null;if(X)try{K=X()}catch(ne){Y=ne}var V=W._ctx,X=V.table,W=X.hook.reading.fire;this._ctx={table:X,index:V.index,isPrimKey:!V.index||X.schema.primKey.keyPath&&V.index===X.schema.primKey.name,range:K,keysOnly:!1,dir:"next",unique:"",algorithm:null,filter:null,replayFilter:null,justLimit:!0,isMatch:null,offset:0,limit:1/0,error:Y,or:V.or,valueMapper:W!==er?W:null}})),this.Table=(T=this,wt(jt.prototype,function(U,F,K){this.db=T,this._tx=K,this.name=U,this.schema=F,this.hook=T._allTables[U]?T._allTables[U].hook:Nt(null,{creating:[Ti,Ht],reading:[kn,er],updating:[ki,Ht],deleting:[es,Ht]})})),this.Transaction=(O=this,wt(Gs.prototype,function(U,F,K,Y,V){var X=this;U!=="readonly"&&F.forEach(function(W){W=(W=K[W])===null||W===void 0?void 0:W.yProps,W&&(F=F.concat(W.map(function(ne){return ne.updatesTable})))}),this.db=O,this.mode=U,this.storeNames=F,this.schema=K,this.chromeTransactionDurability=Y,this.idbtrans=null,this.on=Nt(this,"complete","error","abort"),this.parent=V||null,this.active=!0,this._reculock=0,this._blockedFuncs=[],this._resolve=null,this._reject=null,this._waitingFor=null,this._waitingQueue=null,this._spinCount=0,this._completion=new He(function(W,ne){X._resolve=W,X._reject=ne}),this._completion.then(function(){X.active=!1,X.on.complete.fire()},function(W){var ne=X.active;return X.active=!1,X.on.error.fire(W),X.parent?X.parent._reject(W):ne&&X.idbtrans&&X.idbtrans.abort(),tt(W)})})),this.Version=(z=this,wt(Ec.prototype,function(U){this.db=z,this._cfg={version:U,storesSource:null,dbschema:{},tables:{},contentUpgrade:null}})),this.WhereClause=(H=this,wt(ba.prototype,function(U,F,K){if(this.db=H,this._ctx={table:U,index:F===":id"?null:F,or:K},this._cmp=this._ascending=le,this._descending=function(Y,V){return le(V,Y)},this._max=function(Y,V){return 0<le(Y,V)?Y:V},this._min=function(Y,V){return le(Y,V)<0?Y:V},this._IDBKeyRange=H._deps.IDBKeyRange,!this._IDBKeyRange)throw new ze.MissingAPI})),this.on("versionchange",function(U){0<U.newVersion?console.warn("Another connection wants to upgrade database '".concat(p.name,"'. Closing db now to resume the upgrade.")):console.warn("Another connection wants to delete database '".concat(p.name,"'. Closing db now to resume the delete request.")),p.close({disableAutoOpen:!1})}),this.on("blocked",function(U){!U.newVersion||U.newVersion<U.oldVersion?console.warn("Dexie.delete('".concat(p.name,"') was blocked")):console.warn("Upgrade '".concat(p.name,"' blocked by other connection holding version ").concat(U.oldVersion/10))}),this._maxKey=$a(f.IDBKeyRange),this._createTransaction=function(U,F,K,Y){return new p.Transaction(U,F,K,p._options.chromeTransactionDurability,Y)},this._fireOnBlocked=function(U){p.on("blocked").fire(U),Fe.filter(function(F){return F.name===p.name&&F!==p&&!F._state.vcFired}).map(function(F){return F.on("versionchange").fire(U)})},this.use(tl),this.use(gs),this.use(kc),this.use(Tc),this.use(el);var $=new Proxy(this,{get:function(U,F,K){if(F==="_vip")return!0;if(F==="table")return function(V){return zi(p.table(V),$)};var Y=Reflect.get(U,F,K);return Y instanceof jt?zi(Y,$):F==="tables"?Y.map(function(V){return zi(V,$)}):F==="_createTransaction"?function(){return zi(Y.apply(this,arguments),$)}:Y}});this.vip=$,g.forEach(function(U){return U(p)})}var Wa,vr=typeof Symbol<"u"&&"observable"in Symbol?Symbol.observable:"@@observable",al=(ys.prototype.subscribe=function(o,f,p){return this._subscribe(o&&typeof o!="function"?o:{next:o,error:f,complete:p})},ys.prototype[vr]=function(){return this},ys);function ys(o){this._subscribe=o}try{Wa={indexedDB:m.indexedDB||m.mozIndexedDB||m.webkitIndexedDB||m.msIndexedDB,IDBKeyRange:m.IDBKeyRange||m.webkitIDBKeyRange}}catch{Wa={indexedDB:null,IDBKeyRange:null}}function il(o){var f,p=!1,g=new al(function(C){var T=L(o),O,z=!1,H={},I={},$={get closed(){return z},unsubscribe:function(){z||(z=!0,O&&O.abort(),U&&Fn.storagemutated.unsubscribe(K))}};C.start&&C.start($);var U=!1,F=function(){return Et(Y)},K=function(V){fs(H,V),Ws(I,H)&&F()},Y=function(){var V,X,W;!z&&Wa.indexedDB&&(H={},V={},O&&O.abort(),O=new AbortController,W=(function(ne){var he=Cr();try{T&&fe();var xe=G(o,ne);return xe=T?xe.finally(_e):xe}finally{he&&yr()}})(X={subscr:V,signal:O.signal,requery:F,querier:o,trans:null}),Promise.resolve(W).then(function(ne){p=!0,f=ne,z||X.signal.aborted||(H={},(function(he){for(var xe in he)if(R(he,xe))return;return 1})(I=V)||U||(Fn(Ga,K),U=!0),Et(function(){return!z&&C.next&&C.next(ne)}))},function(ne){p=!1,["DatabaseClosedError","AbortError"].includes(ne?.name)||z||Et(function(){z||C.error&&C.error(ne)})}))};return setTimeout(F,0),$});return g.hasValue=function(){return p},g.getValue=function(){return f},g}var ka=$r;function io(o){var f=pa;try{pa=!0,Fn.storagemutated.fire(o),no(o,!0)}finally{pa=f}}N(ka,s(s({},pn),{delete:function(o){return new ka(o,{addons:[]}).delete()},exists:function(o){return new ka(o,{addons:[]}).open().then(function(f){return f.close(),!0}).catch("NoSuchDatabaseError",function(){return!1})},getDatabaseNames:function(o){try{return f=ka.dependencies,p=f.indexedDB,f=f.IDBKeyRange,(cs(p)?Promise.resolve(p.databases()).then(function(g){return g.map(function(C){return C.name}).filter(function(C){return C!==st})}):Xs(p,f).toCollection().primaryKeys()).then(o)}catch{return tt(new ze.MissingAPI)}var f,p},defineClass:function(){return function(o){x(this,o)}},ignoreTransaction:function(o){return Qe.trans?pt(Qe.transless,o):o()},vip:Fs,async:function(o){return function(){try{var f=Oi(o.apply(this,arguments));return f&&typeof f.then=="function"?f:He.resolve(f)}catch(p){return tt(p)}}},spawn:function(o,f,p){try{var g=Oi(o.apply(p,f||[]));return g&&typeof g.then=="function"?g:He.resolve(g)}catch(C){return tt(C)}},currentTransaction:{get:function(){return Qe.trans||null}},waitFor:function(o,f){return f=He.resolve(typeof o=="function"?ka.ignoreTransaction(o):o).timeout(f||6e4),Qe.trans?Qe.trans.waitFor(f):f},Promise:He,debug:{get:function(){return tr},set:function(o){qa(o)}},derive:se,extend:x,props:N,override:we,Events:Nt,on:Fn,liveQuery:il,extendObservabilitySet:fs,getByKeyPath:ft,setByKeyPath:et,delByKeyPath:function(o,f){typeof f=="string"?et(o,f,void 0):"length"in f&&[].map.call(f,function(p){et(o,p,void 0)})},shallowClone:qt,deepClone:ue,getObjectDiff:hs,cmp:le,asap:Je,minKey:-1/0,addons:[],connections:Fe,errnames:dt,dependencies:Wa,cache:wa,semVer:"4.2.1",version:"4.2.1".split(".").map(function(o){return parseInt(o)}).reduce(function(o,f,p){return o+f/Math.pow(10,2*p)})})),ka.maxKey=$a(ka.dependencies.IDBKeyRange),typeof dispatchEvent<"u"&&typeof addEventListener<"u"&&(Fn(Ga,function(o){pa||(o=new CustomEvent(_a,{detail:o}),pa=!0,dispatchEvent(o),pa=!1)}),addEventListener(_a,function(o){o=o.detail,pa||io(o)}));var ei,pa=!1,ur=function(){};return typeof BroadcastChannel<"u"&&((ur=function(){(ei=new BroadcastChannel(_a)).onmessage=function(o){return o.data&&io(o.data)}})(),typeof ei.unref=="function"&&ei.unref(),Fn(Ga,function(o){pa||ei.postMessage(o)})),typeof addEventListener<"u"&&(addEventListener("pagehide",function(o){if(!$r.disableBfCache&&o.persisted){tr&&console.debug("Dexie: handling persisted pagehide"),ei?.close();for(var f=0,p=Fe;f<p.length;f++)p[f].close({disableAutoOpen:!1})}}),addEventListener("pageshow",function(o){!$r.disableBfCache&&o.persisted&&(tr&&console.debug("Dexie: handling persisted pageshow"),ur(),io({all:new Zn(-1/0,[[]])}))})),He.rejectionMapper=function(o,f){return!o||o instanceof Ce||o instanceof TypeError||o instanceof SyntaxError||!o.name||!ct[o.name]?o:(f=new ct[o.name](f||o.message,o),"stack"in o&&ie(f,"stack",{get:function(){return this.inner.stack}}),f)},qa(tr),s($r,Object.freeze({__proto__:null,Dexie:$r,liveQuery:il,Entity:oe,cmp:le,PropModification:mt,replacePrefix:function(o,f){return new mt({replacePrefix:[o,f]})},add:function(o){return new mt({add:o})},remove:function(o){return new mt({remove:o})},default:$r,RangeSet:Zn,mergeRanges:Ea,rangesOverlap:Zo}),{default:$r}),$r})})(yc)),yc.exports}var Ev=Cv();const If=Qo(Ev),kp=Symbol.for("Dexie"),Ys=globalThis[kp]||(globalThis[kp]=If);if(If.semVer!==Ys.semVer)throw new Error(`Two different versions of Dexie loaded in the same app: ${If.semVer} and ${Ys.semVer}`);const{liveQuery:d1,mergeRanges:h1,rangesOverlap:p1,RangeSet:m1,cmp:g1,Entity:y1,PropModification:v1,replacePrefix:x1,add:b1,remove:S1,DexieYProvider:_1}=Ys;class wv extends Ys{messages;contacts;invites;constructor(){super("AdunChatDB_v2"),this.version(1).stores({messages:"++msg_id, &msg_uuid, conversationId, from, timestamp, delivered, [conversationId+msg_id]",contacts:"userId, addedAt"}),this.version(2).stores({messages:"++msg_id, &msg_uuid, conversationId, from, [conversationId+msg_id]",invites:"inviteId"})}async addMessage(r){return await this.messages.put(r)}async getMessageByUuid(r){return await this.messages.where("msg_uuid").equals(r).first()}async getMessages(r){return await this.messages.where("conversationId").equals(r).sortBy("msg_id")}async getRecentMessages(r,i){return await this.messages.where("[conversationId+msg_id]").between([r,Ys.minKey],[r,Ys.maxKey]).reverse().limit(i).toArray().then(s=>s.reverse())}async getMessagesBefore(r,i,s){return await this.messages.where("[conversationId+msg_id]").between([r,0],[r,i],!0,!1).reverse().limit(s).toArray().then(c=>c.reverse())}async updateMessageDelivery(r,i,s=!1,c){const m={delivered:i,showAsFailedInUI:s};return c!==void 0&&(m.firstAttemptTimestamp=c),await this.messages.update(r,m)}async deleteConversation(r){return await this.messages.where("conversationId").equals(r).delete()}async deleteMessage(r){await this.messages.delete(r)}async clearAllMessages(){await this.messages.clear()}async getMessageCount(r){return await this.messages.where("conversationId").equals(r).count()}async searchMessages(r,i){const s=await this.getMessages(r),c=i.toLowerCase();return s.filter(m=>m.content.toLowerCase().includes(c))}async addContact(r){const i={userId:r.userId,publicKey:r.publicKey,addedAt:r.addedAt,status:"offline",byInviteId:r.byInviteId,peerProfile:r.peerProfile,localProfile:r.localProfile??{}};return await this.contacts.put(i)}async updateLocalProfile(r,i){return await this.contacts.update(r,{localProfile:i})}async updatePeerProfile(r,i){return await this.contacts.update(r,{peerProfile:i})}async getContacts(){return await this.contacts.toArray()}async getContact(r){return await this.contacts.get(r)}async removeContact(r){await this.contacts.delete(r)}async clearAllContacts(){await this.contacts.clear()}async addInvite(r){return await this.invites.put(r)}async getInvite(r){return await this.invites.get(r)}async getInvites(){return await this.invites.toArray()}async getValidInvites(){return await this.invites.where("valid").equals(1).toArray()}async updateInvite(r,i){return await this.invites.update(r,i)}async incrementInviteUseCount(r){await this.invites.where("inviteId").equals(r).modify(i=>{i.useCount=(i.useCount||0)+1})}async invalidateInvite(r){return await this.invites.update(r,{valid:!1})}async deleteInvite(r){await this.invites.delete(r)}async clearAllInvites(){await this.invites.clear()}}const Tn=new wv,Tv=new Set;function kv(u,r){Tv.forEach(i=>{try{i(u,r)}catch(s){console.error("[ContactStore] Error in status change callback:",s)}})}let wf=!1;const br=Vf()((u,r)=>({contacts:[],loaded:!1,loadContacts:async()=>{if(wf){console.log("[ContactStore] Load already in progress, skipping");return}if(r().loaded){console.log("[ContactStore] Contacts already loaded, skipping");return}wf=!0,console.log("[ContactStore] ========== LOADING CONTACTS FROM INDEXEDDB ==========");try{const i=await Tn.getContacts();console.log("[ContactStore]  Loaded",i.length,"contacts from IndexedDB"),i.length>0&&i.forEach(m=>{console.log("[ContactStore]   - Contact:",m.userId.substring(0,8),"key:",m.publicKey.substring(0,16))}),u({contacts:i,loaded:!0}),console.log("[ContactStore]  Contacts loaded into store");let s=0;for(;!$n.isReady()&&s<50;)await new Promise(m=>setTimeout(m,100)),s++;if(!$n.isReady()){console.error("[ContactStore]  Transport not ready after 5 seconds");return}console.log("[ContactStore] Registering",i.length,"contacts with transport...");const c=wi.getState().identity?.userId;for(const m of i)try{console.log("[ContactStore]  Adding peer to transport:",m.userId.substring(0,8));let _=!1;if(c){const w=[c,m.userId].sort().join("-"),x=await Tn.getMessages(w),S=x.filter(E=>!E.delivered&&E.from===c);_=S.length>0,console.log("[ContactStore] Checking undelivered for:",m.userId.substring(0,8),"conversationId:",w.substring(0,16),"total:",x.length,"undelivered:",S.length)}else console.log("[ContactStore] No myUserId available for undelivered check");$n.addPeer(m.userId,m.publicKey,_),console.log("[ContactStore]  Contact registered:",m.userId.substring(0,8),"hasUndelivered:",_)}catch(_){console.error("[ContactStore]  Failed to register contact:",m.userId.substring(0,8),_)}console.log("[ContactStore] ========== ALL CONTACTS REGISTERED ==========")}catch(i){console.error("[ContactStore]  Failed to load contacts from IndexedDB:",i),u({loaded:!0})}finally{wf=!1}},addContact:(i,s=!1)=>{const c=r();if(c.contacts.some(_=>_.userId===i.userId)){console.warn("Contact already exists:",i.userId);return}u({contacts:[...c.contacts,i]}),(async()=>{try{await Tn.addContact(i),console.log("[ContactStore]  Contact saved to IndexedDB:",i.userId.substring(0,8));let _=0;for(;!$n.isReady()&&_<50;)await new Promise(w=>setTimeout(w,100)),_++;if(!$n.isReady()){console.error("[ContactStore] Transport not ready after 5 seconds for:",i.userId);return}console.log("[ContactStore] Registering contact with transport:",i.userId.substring(0,8)),$n.addPeer(i.userId,i.publicKey,s),console.log("[ContactStore]  Contact registered:",i.userId.substring(0,8))}catch(_){console.error("[ContactStore] Failed to save/register contact:",_)}})()},updateContact:(i,s)=>u(c=>({contacts:c.contacts.map(m=>m.userId===i?{...m,...s}:m)})),updateLocalProfile:async(i,s)=>{u(c=>({contacts:c.contacts.map(m=>m.userId===i?{...m,localProfile:s}:m)}));try{await Tn.updateLocalProfile(i,s),console.log("[ContactStore]  Local profile updated:",i.substring(0,8),s)}catch(c){throw console.error("[ContactStore] Failed to update local profile:",c),c}},updatePeerProfile:async(i,s)=>{u(c=>({contacts:c.contacts.map(m=>m.userId===i?{...m,peerProfile:s}:m)}));try{await Tn.updatePeerProfile(i,s),console.log("[ContactStore]  Peer profile updated:",i.substring(0,8),s)}catch(c){throw console.error("[ContactStore] Failed to update peer profile:",c),c}},removeContact:i=>{u(s=>({contacts:s.contacts.filter(c=>c.userId!==i)})),Tn.removeContact(i).catch(s=>{console.error("[ContactStore] Failed to remove contact from IndexedDB:",s)})},getContact:i=>r().contacts.find(s=>s.userId===i),getAllContacts:()=>r().contacts,setPeerStatus:(i,s,c)=>{r().contacts.some(_=>_.userId===i)?console.log(`[ContactStore] Setting peer status: ${i.substring(0,16)} -> ${s}`):(console.error("[ContactStore] setPeerStatus: Contact not found:",i),console.error("[ContactStore] Available contacts:",r().contacts.map(_=>_.userId.substring(0,16)))),kv(i,s),u(_=>({contacts:_.contacts.map(w=>w.userId===i?{...w,status:s,sessionExpiry:c,handshakeStartedAt:s==="handshake"?w.handshakeStartedAt:void 0,lastSeen:s==="online"?Date.now():w.lastSeen,online:s==="online"}:w)}))},setHandshakeStarted:i=>u(s=>({contacts:s.contacts.map(c=>c.userId===i?{...c,status:"handshake",handshakeStartedAt:Date.now()}:c)})),clearHandshakeTimeout:i=>u(s=>({contacts:s.contacts.map(c=>c.userId===i?{...c,handshakeStartedAt:void 0}:c)})),retryHandshake:i=>{if(!r().getContact(i)){console.warn("[ContactStore] Cannot retry handshake: contact not found");return}u(c=>({contacts:c.contacts.map(m=>m.userId===i?{...m,status:"offline",handshakeStartedAt:void 0,sessionExpiry:void 0}:m)})),console.log("[ContactStore] Retry handshake requested for:",i),$n.retryHandshake(i)}})),Mp=Object.freeze(Object.defineProperty({__proto__:null,useContactStore:br},Symbol.toStringTag,{value:"Module"})),wm=()=>typeof window<"u"&&window.__TEST_MODE__===!0,Mv=()=>wm()?3e3:15e3,jv=()=>wm()?5e3:3e4,Rv=1440*60*1e3;class Av{messageHandlers=new Set;peerOnlineHandlers=new Set;initializedUserId=null;currentIdentity=null;transports=new Map;pendingOutboundPeers=new Map;handshakeRetryTimer=null;signalingManager=new Jy;handshakeCoordinator=new yv(jv(),Rv);updatePeerStatus(r,i){console.log(`[TransportManager] DataTransport status update: ${r.substring(0,8)} -> ${i}`);const s=i==="online"?"online":i==="connecting"?"connecting":"offline";br.getState().setPeerStatus(r,s),i==="online"?(this.pendingOutboundPeers.delete(r)&&console.log("[TransportManager] Removed from pendingOutboundPeers (now online):",r.substring(0,8)),console.log("[TransportManager] Notifying",this.peerOnlineHandlers.size,"onPeerOnline handlers (online)"),this.peerOnlineHandlers.forEach(c=>c(r,!0))):i==="offline"&&(console.log("[TransportManager] Notifying",this.peerOnlineHandlers.size,"onPeerOnline handlers (offline)"),this.peerOnlineHandlers.forEach(c=>c(r,!1)))}reportPeerError(r,i){const s=this.transports.get(r);if(i instanceof mc||i instanceof gc){const c=s.isConnected;console.log("[TransportManager] Initiating handshake due to error:",i.name,"handshakeOnly:",c),this.addPendingConnection(s,c)}else i instanceof Lf||(i instanceof Hf?(s.clearSessionAndConnection(),console.log("[TransportManager] Initiating handshake due to error:",i.name),this.addPendingConnection(s,!1)):console.log(`[TransportManager] Other error from ${r}:`,i))}onWireMessage(r,i){console.log("[TransportManager]  Message via P2P from:",r.substring(0,8)),this.messageHandlers.forEach(s=>s(r,i))}sendCustomSignal(r,i){this.signalingManager.sendCustomSignal(r,{type:"encrypted-signal",data:i}).catch(s=>{console.error("[TransportManager] Failed to send custom signal:",s)})}async initialize(r){const i=r.userId;if(this.initializedUserId===i&&this.signalingManager.isInitializedForUser(i)){console.log("[TransportManager] Already initialized for this user, skipping");return}this.initializedUserId&&this.initializedUserId!==i&&(console.log("[TransportManager] Switching users, cleaning up old transports"),this.cleanupTransports());try{await this.signalingManager.initialize(i),this.signalingManager.onCustomSignal((s,c)=>{this.handleIncomingSignal(s,c)}),this.signalingManager.onHandshakeMessage((s,c)=>{this.handshakeCoordinator.handleHandshakeMessage(s,c)}),this.handshakeCoordinator.initialize({userId:r.userId,publicKey:r.publicKey,secretKey:r.secretKey}),this.handshakeCoordinator.setSignalSender((s,c)=>this.signalingManager.sendHandshakeMessage(s,c)),this.handshakeCoordinator.setOnHandshakeComplete((s,c,m)=>{this.handleHandshakeComplete(s,c,m)}),this.handshakeCoordinator.setOnHandshakeStatus((s,c)=>{this.handleHandshakeStatus(s,c)}),this.handshakeCoordinator.setGetPeerPublicKey(s=>this.transports.get(s)?.identityPK||null),this.handshakeCoordinator.setGetInviteCallback((s,c)=>this.getInviteForHandshake(s,c)),this.handshakeCoordinator.setMarkInviteUsedCallback(s=>this.markInviteUsed(s)),this.handshakeCoordinator.setCreateContactFromInviteCallback((s,c,m,_)=>this.createContactFromInvite(s,c,m,_)),this.handshakeCoordinator.setOnInviteRejectedCallback((s,c)=>{console.log("[TransportManager] Invite rejected by:",s.substring(0,8),"reason:",c)}),this.initializedUserId=i,this.currentIdentity=r,console.log("[TransportManager]  Initialized for user:",i.substring(0,8))}catch(s){throw console.error("[TransportManager] Initialization failed:",s),this.initializedUserId=null,this.currentIdentity=null,new Error("Failed to initialize transport.")}}addPeer(r,i,s=!1){let c=this.transports.get(r);c||(c=this.createTransport(r,i)),console.log("[TransportManager]  Peer added:",r.substring(0,8),"hasUndelivered:",s),s&&this.addPendingConnection(c)}addPendingConnection(r,i=!1){const s=r.peerId;this.startHandshakeRetryTimer(),i&&this.pendingOutboundPeers.get(s)!=="connection"?this.pendingOutboundPeers.set(s,"handshake"):(this.pendingOutboundPeers.set(s,"connection"),i=!1),this.retryPendingConnection(r,i)}retryPendingConnection(r,i){if(!i&&r.isSessionValid){this.initiatePoliteConnection(r);return}this._startPendingHandshake(r)}_startPendingHandshake(r){const i=r.peerId;console.log("[TransportManager] Retry handshake for pending peer:",i.substring(0,8)),this.handshakeCoordinator.initiateHandshakeIfNotRunning(i,r.identityPK)}async sendMessage(r,i){console.log("[TransportManager] ========== SEND MESSAGE =========="),console.log("[TransportManager] To:",r.substring(0,8)),console.log("[TransportManager] Message ID:",i.id);const s=this.transports.get(r);if(!s)throw console.error("[TransportManager]  No DataTransport for peer"),new Error("No transport available");try{console.log("[TransportManager]  Sending via P2P..."),await s.sendMessage(i),console.log("[TransportManager]  Sent via P2P");return}catch(c){throw console.warn("[TransportManager]  P2P send failed:",c),this.reportPeerError(r,c),c}}getTransport(r){return this.transports.get(r)}onMessage(r){return this.messageHandlers.add(r),()=>this.messageHandlers.delete(r)}onPeerOnline(r){return this.peerOnlineHandlers.add(r),()=>this.peerOnlineHandlers.delete(r)}isReady(){return this.initializedUserId!==null}getConnectionStatus(r){return this.transports.get(r)?.isConnected?"connected":"disconnected"}getActiveSignalingServices(){return this.signalingManager.getActiveServices()}retryHandshake(r){const i=this.transports.get(r);if(!i){console.error("[TransportManager] Cannot retry handshake - no transport for:",r.substring(0,8));return}this.addPendingConnection(i)}destroy(){console.log("[TransportManager] Component unmount - nothing destroyed (persistence)")}destroyAll(){console.log("[TransportManager] Destroying all (identity deleted)"),this.cleanupTransports(),this.signalingManager.destroy(),this.initializedUserId=null}createTransport(r,i){const s=new Sv(r,i,this);return this.transports.set(r,s),console.log("[TransportManager] Created DataTransport for:",r.substring(0,8)),s}handleIncomingSignal(r,i){const s=this.transports.get(r);if(s)console.log("[TransportManager] Received signal:",i.type,"from:",r.substring(0,8));else{console.warn("[TransportManager] Received signal:",i.type,"from unknown peer:",r.substring(0,8));return}if(i.type==="pull-connection"){console.log("[TransportManager] Initiating connection after pull-connection:",r.substring(0,8)),this.addPendingConnection(s);return}if(i.type==="encrypted-signal"){try{s.handleEncryptedSignal(i.data)}catch(c){console.error("[TransportManager] Failed to handle signal:",c),this.reportPeerError(r,c)}return}console.log("[TransportManager] Unknown signal type:",i.type)}handleHandshakeComplete(r,i,s){const c=this.transports.get(r);if(!c){console.error("[TransportManager] Peer not found for handshake:",r);return}c.setSession(i,s)}initiatePoliteConnection(r){if(this.initializedUserId>r.peerId){if(console.log("[TransportManager] We are impolite, initiating connection"),r.isSessionValid)return r.initiateConnection().catch(s=>{console.error("[TransportManager] Failed to initiate connection:",s)}),!0;console.log("[TransportManager] No valid session available, skipping connection initiation")}else console.log("[TransportManager] We are polite, sending pull-connection"),this.signalingManager.sendCustomSignal(r.peerId,{type:"pull-connection",data:""}).catch(s=>{console.error("[TransportManager] Failed to send pull-connection:",s)});return!1}handleHandshakeStatus(r,i){const s=this.pendingOutboundPeers.has(r);switch(console.log("[TransportManager] ========== HANDSHAKE STATUS =========="),console.log("[TransportManager] Peer:",r.substring(0,8),"initiatedByUs:",s),i){case"started":const c=br.getState().getContact(r);(!c||c.status==="offline")&&br.getState().setPeerStatus(r,"handshake");break;case"complete":if(this.pendingOutboundPeers.get(r)==="connection"){const _=this.transports.get(r);if(_){this.initiatePoliteConnection(_);return}}this.pendingOutboundPeers.delete(r),br.getState().setPeerStatus(r,"offline");break;case"failed":case"timeout":br.getState().getContact(r)?.status==="handshake"&&br.getState().setPeerStatus(r,"offline");break}}startHandshakeRetryTimer(){if(this.handshakeRetryTimer)return;const r=Mv();console.log("[TransportManager] Starting handshake retry timer, interval:",r,"ms"),this.handshakeRetryTimer=setInterval(()=>{this.retryPendingHandshakes()},r)}retryPendingHandshakes(){for(const[r,i]of this.pendingOutboundPeers){const s=this.transports.get(r);s?this.retryPendingConnection(s,i==="handshake"):this.pendingOutboundPeers.delete(r)}this.pendingOutboundPeers.size===0&&this.handshakeRetryTimer&&(console.log("[TransportManager] No pending peers, stopping retry timer"),clearInterval(this.handshakeRetryTimer),this.handshakeRetryTimer=null)}async initiateInviteHandshake(r){if(!this.currentIdentity)throw new Error("Transport not initialized");console.log("[TransportManager] Initiating invite handshake to:",r.invitingId.substring(0,8)),await this.handshakeCoordinator.initiateFromPSI(r)}async getInviteForHandshake(r,i){const s=br.getState().getContact(i);return s?(console.log("[TransportManager] Peer is existing contact:",i.substring(0,8)),s.publicKey):await Tn.getInvite(r)}async markInviteUsed(r){console.log("[TransportManager] Incrementing invite use count:",r),await Tn.incrementInviteUseCount(r)}async createContactFromInvite(r,i,s,c){if(!Uf(r,i)){console.error("[TransportManager] Invalid peer: userId does not match publicKey:",r.substring(0,8));return}if(br.getState().getContact(r)){console.log("[TransportManager] Contact already exists:",r.substring(0,8));return}let _;if(s){const x=await Tn.getInvite(s);x?.name&&(_=x.name)}const w={userId:r,publicKey:i,addedAt:Date.now(),status:"offline",byInviteId:s||void 0,displayName:_,localProfile:{}};if(s){const x=await Tn.getInvite(s);x?.name&&(x.useLimit===1?w.localProfile.name=x.name:w.localProfile.group=x.name)}console.log("[TransportManager] Creating contact from invite:",r.substring(0,8),"isInvitedParty:",c),br.getState().addContact(w)}cleanupTransports(){this.handshakeRetryTimer&&(clearInterval(this.handshakeRetryTimer),this.handshakeRetryTimer=null),this.pendingOutboundPeers.clear(),this.transports.forEach(r=>r.destroy()),this.transports.clear(),this.handshakeCoordinator.destroy(),this.messageHandlers.clear(),this.peerOnlineHandlers.clear(),this.initializedUserId=null,this.currentIdentity=null}}const $n=new Av;function Nv(){const{setIdentity:u,setActiveView:r}=wi(),[i,s]=yt.useState(!1),[c,m]=yt.useState(null),_=()=>{try{const x=bc.generate().export();Xi.save(x),u(x),r("contacts")}catch(x){m("Failed to generate identity. Please try again."),console.error(x)}},w=async x=>{const S=x.target.files?.[0];if(S)try{const E=await S.text(),R=Xi.importFromJSON(E);Xi.save(R),u(R),r("contacts")}catch(E){m("Invalid identity file. Please check and try again."),console.error(E)}};return y.jsxs("div",{className:"min-h-screen bg-[var(--color-bg-dark)] flex items-center justify-center p-4 animate-fade-in relative overflow-hidden",children:[y.jsxs("div",{className:"absolute top-0 left-0 w-full h-full overflow-hidden z-0 pointer-events-none",children:[y.jsx("div",{className:"absolute -top-[20%] -left-[10%] w-[50%] h-[50%] bg-indigo-500/10 rounded-full blur-[100px]"}),y.jsx("div",{className:"absolute top-[20%] -right-[10%] w-[40%] h-[40%] bg-purple-500/10 rounded-full blur-[100px]"}),y.jsx("div",{className:"absolute -bottom-[10%] left-[20%] w-[60%] h-[60%] bg-blue-500/10 rounded-full blur-[100px]"})]}),y.jsxs("div",{className:"max-w-md w-full relative z-10",children:[y.jsxs("div",{className:"bg-[var(--color-bg-card)] backdrop-blur-xl border border-slate-700/50 rounded-3xl shadow-2xl p-8 md:p-10",children:[y.jsxs("div",{className:"text-center mb-10",children:[y.jsx("div",{className:"w-20 h-20 bg-gradient-to-br from-indigo-500 to-purple-600 rounded-2xl flex items-center justify-center mx-auto mb-6 shadow-lg shadow-indigo-500/30 transform rotate-3 hover:rotate-0 transition-transform duration-300",children:y.jsx("svg",{className:"w-10 h-10 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"})})}),y.jsx("h1",{className:"text-4xl font-bold text-white mb-3 tracking-tight",children:"Private Chat"}),y.jsx("p",{className:"text-slate-400 text-lg",children:"Secure, encrypted peer-to-peer messaging"})]}),c&&y.jsxs("div",{className:"mb-8 p-4 bg-red-500/10 border border-red-500/20 rounded-xl flex items-start space-x-3",children:[y.jsx("svg",{className:"w-5 h-5 text-red-400 mt-0.5 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),y.jsx("p",{className:"text-sm text-red-200",children:c})]}),y.jsx("div",{className:"space-y-5",children:i?y.jsxs("div",{className:"animate-fade-in",children:[y.jsxs("div",{className:"border-2 border-dashed border-slate-700 hover:border-indigo-500/50 rounded-2xl p-8 text-center transition-colors group cursor-pointer bg-slate-900/30",children:[y.jsx("input",{type:"file",accept:".json",onChange:w,className:"hidden",id:"identity-import"}),y.jsxs("label",{htmlFor:"identity-import",className:"cursor-pointer flex flex-col items-center w-full h-full",children:[y.jsx("div",{className:"w-16 h-16 bg-slate-800 rounded-full flex items-center justify-center mb-4 group-hover:scale-110 transition-transform duration-300",children:y.jsx("svg",{className:"w-8 h-8 text-slate-400 group-hover:text-indigo-400 transition-colors",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"})})}),y.jsx("span",{className:"text-base font-medium text-slate-200 group-hover:text-white transition-colors",children:"Click to select identity file"}),y.jsx("span",{className:"text-sm text-slate-500 mt-2",children:"JSON file only"})]})]}),y.jsx("button",{onClick:()=>{s(!1),m(null)},className:"w-full mt-4 bg-transparent text-slate-400 font-medium py-3 px-4 rounded-xl hover:text-white hover:bg-slate-800/50 transition-all duration-200",children:"Cancel"})]}):y.jsxs(y.Fragment,{children:[y.jsxs("button",{onClick:_,className:"w-full group relative overflow-hidden bg-indigo-600 hover:bg-indigo-500 text-white font-semibold py-4 px-6 rounded-xl transition-all duration-300 shadow-lg shadow-indigo-500/25 hover:shadow-indigo-500/40 hover:-translate-y-0.5",children:[y.jsx("div",{className:"absolute inset-0 w-full h-full bg-gradient-to-r from-transparent via-white/10 to-transparent -translate-x-full group-hover:animate-shimmer"}),y.jsxs("span",{className:"relative flex items-center justify-center gap-2",children:[y.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),"Generate New Identity"]})]}),y.jsx("button",{onClick:()=>s(!0),className:"w-full bg-slate-800/50 hover:bg-slate-800 text-slate-300 font-semibold py-4 px-6 rounded-xl border border-slate-700 hover:border-slate-600 transition-all duration-300 hover:-translate-y-0.5",children:"Import Existing Identity"})]})}),y.jsx("div",{className:"mt-10 pt-8 border-t border-slate-700/50",children:y.jsxs("div",{className:"space-y-4",children:[y.jsx(Tf,{icon:y.jsx("svg",{className:"w-5 h-5 text-emerald-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"})}),text:"End-to-end encrypted messages"}),y.jsx(Tf,{icon:y.jsx("svg",{className:"w-5 h-5 text-amber-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 7a2 2 0 012 2m4 0a6 6 0 01-7.743 5.743L11.536 19.464a3 3 0 01-.879.879l-4.243 1.061a1 1 0 01-1.213-1.213l1.061-4.243a3 3 0 01.879-.879l7.536-7.536A6 6 0 0120 8zm-4 7a2 2 0 00-2-2"})}),text:"Your keys never leave your device"}),y.jsx(Tf,{icon:y.jsx("svg",{className:"w-5 h-5 text-blue-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 12a9 9 0 01-9 9m9-9a9 9 0 00-9-9m9 9H3m9 9a9 9 0 01-9-9m9 9c1.657 0 3-4.03 3-9s-1.343-9-3-9m0 18c-1.657 0-3-4.03-3-9s1.343-9 3-9m-9 9a9 9 0 019-9"})}),text:"Works without central servers"})]})})]}),y.jsx("p",{className:"text-center text-xs text-slate-500 mt-8 font-medium tracking-wide uppercase opacity-60",children:"No account required  Fully open source"})]})]})}function Tf({icon:u,text:r}){return y.jsxs("div",{className:"flex items-center space-x-4 p-3 rounded-xl hover:bg-slate-800/30 transition-colors",children:[y.jsx("div",{className:"flex-shrink-0 bg-slate-800/50 p-2 rounded-lg",children:u}),y.jsx("span",{className:"text-sm text-slate-300 font-medium",children:r})]})}const Vs=Vf((u,r)=>({messages:{},addMessage:(i,s)=>u(c=>{const m=c.messages[i]||[];return m.some(_=>_.msg_uuid===s.msg_uuid)?c:{messages:{...c.messages,[i]:[...m,s]}}}),prependMessages:(i,s)=>u(c=>{const m=c.messages[i]||[],_=new Set(m.map(x=>x.msg_uuid)),w=s.filter(x=>!_.has(x.msg_uuid));return w.length===0?c:{messages:{...c.messages,[i]:[...w,...m]}}}),updateMessageDelivery:(i,s,c=!1,m)=>u(_=>{const w={..._.messages};for(const x in w){const S=w[x],E=S.findIndex(R=>R.msg_id===i);if(E!==-1){const R={...S[E],delivered:s,showAsFailedInUI:c};m!==void 0&&(R.firstAttemptTimestamp=m),w[x]=[...S.slice(0,E),R,...S.slice(E+1)];break}}return{messages:w}}),getMessage:i=>{const s=r();for(const c in s.messages){const m=s.messages[c].find(_=>_.msg_uuid===i);if(m)return m}},getMessages:i=>r().messages[i]||[],getUndeliveredMessages:i=>{const s=r(),c=[];for(const m in s.messages)if(m.includes(i)){const w=s.messages[m].filter(x=>!x.delivered&&x.from!==i);c.push(...w)}return c.sort((m,_)=>(m.msg_id??0)-(_.msg_id??0))},setMessages:(i,s)=>u(c=>({messages:{...c.messages,[i]:s}})),deleteMessage:i=>u(s=>{const c={...s.messages};for(const m in c)c[m]=c[m].filter(_=>_.msg_id!==i);return{messages:c}}),clearMessages:i=>u(s=>{const{[i]:c,...m}=s.messages;return{messages:m}}),clearAllMessages:()=>u({messages:{}})}));var Ov=Object.defineProperty,Sc=Object.getOwnPropertySymbols,Tm=Object.prototype.hasOwnProperty,km=Object.prototype.propertyIsEnumerable,jp=(u,r,i)=>r in u?Ov(u,r,{enumerable:!0,configurable:!0,writable:!0,value:i}):u[r]=i,Kf=(u,r)=>{for(var i in r||(r={}))Tm.call(r,i)&&jp(u,i,r[i]);if(Sc)for(var i of Sc(r))km.call(r,i)&&jp(u,i,r[i]);return u},Pf=(u,r)=>{var i={};for(var s in u)Tm.call(u,s)&&r.indexOf(s)<0&&(i[s]=u[s]);if(u!=null&&Sc)for(var s of Sc(u))r.indexOf(s)<0&&km.call(u,s)&&(i[s]=u[s]);return i};var Fi;(u=>{const r=class Ft{constructor(x,S,E,R){if(this.version=x,this.errorCorrectionLevel=S,this.modules=[],this.isFunction=[],x<Ft.MIN_VERSION||x>Ft.MAX_VERSION)throw new RangeError("Version value out of range");if(R<-1||R>7)throw new RangeError("Mask value out of range");this.size=x*4+17;let N=[];for(let ie=0;ie<this.size;ie++)N.push(!1);for(let ie=0;ie<this.size;ie++)this.modules.push(N.slice()),this.isFunction.push(N.slice());this.drawFunctionPatterns();const q=this.addEccAndInterleave(E);if(this.drawCodewords(q),R==-1){let ie=1e9;for(let se=0;se<8;se++){this.applyMask(se),this.drawFormatBits(se);const Re=this.getPenaltyScore();Re<ie&&(R=se,ie=Re),this.applyMask(se)}}c(0<=R&&R<=7),this.mask=R,this.applyMask(R),this.drawFormatBits(R),this.isFunction=[]}static encodeText(x,S){const E=u.QrSegment.makeSegments(x);return Ft.encodeSegments(E,S)}static encodeBinary(x,S){const E=u.QrSegment.makeBytes(x);return Ft.encodeSegments([E],S)}static encodeSegments(x,S,E=1,R=40,N=-1,q=!0){if(!(Ft.MIN_VERSION<=E&&E<=R&&R<=Ft.MAX_VERSION)||N<-1||N>7)throw new RangeError("Invalid value");let ie,se;for(ie=E;;ie++){const we=Ft.getNumDataCodewords(ie,S)*8,$e=_.getTotalBits(x,ie);if($e<=we){se=$e;break}if(ie>=R)throw new RangeError("Data too long")}for(const we of[Ft.Ecc.MEDIUM,Ft.Ecc.QUARTILE,Ft.Ecc.HIGH])q&&se<=Ft.getNumDataCodewords(ie,we)*8&&(S=we);let Re=[];for(const we of x){i(we.mode.modeBits,4,Re),i(we.numChars,we.mode.numCharCountBits(ie),Re);for(const $e of we.getData())Re.push($e)}c(Re.length==se);const lt=Ft.getNumDataCodewords(ie,S)*8;c(Re.length<=lt),i(0,Math.min(4,lt-Re.length),Re),i(0,(8-Re.length%8)%8,Re),c(Re.length%8==0);for(let we=236;Re.length<lt;we^=253)i(we,8,Re);let ke=[];for(;ke.length*8<Re.length;)ke.push(0);return Re.forEach((we,$e)=>ke[$e>>>3]|=we<<7-($e&7)),new Ft(ie,S,ke,N)}getModule(x,S){return 0<=x&&x<this.size&&0<=S&&S<this.size&&this.modules[S][x]}getModules(){return this.modules}drawFunctionPatterns(){for(let E=0;E<this.size;E++)this.setFunctionModule(6,E,E%2==0),this.setFunctionModule(E,6,E%2==0);this.drawFinderPattern(3,3),this.drawFinderPattern(this.size-4,3),this.drawFinderPattern(3,this.size-4);const x=this.getAlignmentPatternPositions(),S=x.length;for(let E=0;E<S;E++)for(let R=0;R<S;R++)E==0&&R==0||E==0&&R==S-1||E==S-1&&R==0||this.drawAlignmentPattern(x[E],x[R]);this.drawFormatBits(0),this.drawVersion()}drawFormatBits(x){const S=this.errorCorrectionLevel.formatBits<<3|x;let E=S;for(let N=0;N<10;N++)E=E<<1^(E>>>9)*1335;const R=(S<<10|E)^21522;c(R>>>15==0);for(let N=0;N<=5;N++)this.setFunctionModule(8,N,s(R,N));this.setFunctionModule(8,7,s(R,6)),this.setFunctionModule(8,8,s(R,7)),this.setFunctionModule(7,8,s(R,8));for(let N=9;N<15;N++)this.setFunctionModule(14-N,8,s(R,N));for(let N=0;N<8;N++)this.setFunctionModule(this.size-1-N,8,s(R,N));for(let N=8;N<15;N++)this.setFunctionModule(8,this.size-15+N,s(R,N));this.setFunctionModule(8,this.size-8,!0)}drawVersion(){if(this.version<7)return;let x=this.version;for(let E=0;E<12;E++)x=x<<1^(x>>>11)*7973;const S=this.version<<12|x;c(S>>>18==0);for(let E=0;E<18;E++){const R=s(S,E),N=this.size-11+E%3,q=Math.floor(E/3);this.setFunctionModule(N,q,R),this.setFunctionModule(q,N,R)}}drawFinderPattern(x,S){for(let E=-4;E<=4;E++)for(let R=-4;R<=4;R++){const N=Math.max(Math.abs(R),Math.abs(E)),q=x+R,ie=S+E;0<=q&&q<this.size&&0<=ie&&ie<this.size&&this.setFunctionModule(q,ie,N!=2&&N!=4)}}drawAlignmentPattern(x,S){for(let E=-2;E<=2;E++)for(let R=-2;R<=2;R++)this.setFunctionModule(x+R,S+E,Math.max(Math.abs(R),Math.abs(E))!=1)}setFunctionModule(x,S,E){this.modules[S][x]=E,this.isFunction[S][x]=!0}addEccAndInterleave(x){const S=this.version,E=this.errorCorrectionLevel;if(x.length!=Ft.getNumDataCodewords(S,E))throw new RangeError("Invalid argument");const R=Ft.NUM_ERROR_CORRECTION_BLOCKS[E.ordinal][S],N=Ft.ECC_CODEWORDS_PER_BLOCK[E.ordinal][S],q=Math.floor(Ft.getNumRawDataModules(S)/8),ie=R-q%R,se=Math.floor(q/R);let Re=[];const lt=Ft.reedSolomonComputeDivisor(N);for(let we=0,$e=0;we<R;we++){let Je=x.slice($e,$e+se-N+(we<ie?0:1));$e+=Je.length;const ft=Ft.reedSolomonComputeRemainder(Je,lt);we<ie&&Je.push(0),Re.push(Je.concat(ft))}let ke=[];for(let we=0;we<Re[0].length;we++)Re.forEach(($e,Je)=>{(we!=se-N||Je>=ie)&&ke.push($e[we])});return c(ke.length==q),ke}drawCodewords(x){if(x.length!=Math.floor(Ft.getNumRawDataModules(this.version)/8))throw new RangeError("Invalid argument");let S=0;for(let E=this.size-1;E>=1;E-=2){E==6&&(E=5);for(let R=0;R<this.size;R++)for(let N=0;N<2;N++){const q=E-N,se=(E+1&2)==0?this.size-1-R:R;!this.isFunction[se][q]&&S<x.length*8&&(this.modules[se][q]=s(x[S>>>3],7-(S&7)),S++)}}c(S==x.length*8)}applyMask(x){if(x<0||x>7)throw new RangeError("Mask value out of range");for(let S=0;S<this.size;S++)for(let E=0;E<this.size;E++){let R;switch(x){case 0:R=(E+S)%2==0;break;case 1:R=S%2==0;break;case 2:R=E%3==0;break;case 3:R=(E+S)%3==0;break;case 4:R=(Math.floor(E/3)+Math.floor(S/2))%2==0;break;case 5:R=E*S%2+E*S%3==0;break;case 6:R=(E*S%2+E*S%3)%2==0;break;case 7:R=((E+S)%2+E*S%3)%2==0;break;default:throw new Error("Unreachable")}!this.isFunction[S][E]&&R&&(this.modules[S][E]=!this.modules[S][E])}}getPenaltyScore(){let x=0;for(let N=0;N<this.size;N++){let q=!1,ie=0,se=[0,0,0,0,0,0,0];for(let Re=0;Re<this.size;Re++)this.modules[N][Re]==q?(ie++,ie==5?x+=Ft.PENALTY_N1:ie>5&&x++):(this.finderPenaltyAddHistory(ie,se),q||(x+=this.finderPenaltyCountPatterns(se)*Ft.PENALTY_N3),q=this.modules[N][Re],ie=1);x+=this.finderPenaltyTerminateAndCount(q,ie,se)*Ft.PENALTY_N3}for(let N=0;N<this.size;N++){let q=!1,ie=0,se=[0,0,0,0,0,0,0];for(let Re=0;Re<this.size;Re++)this.modules[Re][N]==q?(ie++,ie==5?x+=Ft.PENALTY_N1:ie>5&&x++):(this.finderPenaltyAddHistory(ie,se),q||(x+=this.finderPenaltyCountPatterns(se)*Ft.PENALTY_N3),q=this.modules[Re][N],ie=1);x+=this.finderPenaltyTerminateAndCount(q,ie,se)*Ft.PENALTY_N3}for(let N=0;N<this.size-1;N++)for(let q=0;q<this.size-1;q++){const ie=this.modules[N][q];ie==this.modules[N][q+1]&&ie==this.modules[N+1][q]&&ie==this.modules[N+1][q+1]&&(x+=Ft.PENALTY_N2)}let S=0;for(const N of this.modules)S=N.reduce((q,ie)=>q+(ie?1:0),S);const E=this.size*this.size,R=Math.ceil(Math.abs(S*20-E*10)/E)-1;return c(0<=R&&R<=9),x+=R*Ft.PENALTY_N4,c(0<=x&&x<=2568888),x}getAlignmentPatternPositions(){if(this.version==1)return[];{const x=Math.floor(this.version/7)+2,S=this.version==32?26:Math.ceil((this.version*4+4)/(x*2-2))*2;let E=[6];for(let R=this.size-7;E.length<x;R-=S)E.splice(1,0,R);return E}}static getNumRawDataModules(x){if(x<Ft.MIN_VERSION||x>Ft.MAX_VERSION)throw new RangeError("Version number out of range");let S=(16*x+128)*x+64;if(x>=2){const E=Math.floor(x/7)+2;S-=(25*E-10)*E-55,x>=7&&(S-=36)}return c(208<=S&&S<=29648),S}static getNumDataCodewords(x,S){return Math.floor(Ft.getNumRawDataModules(x)/8)-Ft.ECC_CODEWORDS_PER_BLOCK[S.ordinal][x]*Ft.NUM_ERROR_CORRECTION_BLOCKS[S.ordinal][x]}static reedSolomonComputeDivisor(x){if(x<1||x>255)throw new RangeError("Degree out of range");let S=[];for(let R=0;R<x-1;R++)S.push(0);S.push(1);let E=1;for(let R=0;R<x;R++){for(let N=0;N<S.length;N++)S[N]=Ft.reedSolomonMultiply(S[N],E),N+1<S.length&&(S[N]^=S[N+1]);E=Ft.reedSolomonMultiply(E,2)}return S}static reedSolomonComputeRemainder(x,S){let E=S.map(R=>0);for(const R of x){const N=R^E.shift();E.push(0),S.forEach((q,ie)=>E[ie]^=Ft.reedSolomonMultiply(q,N))}return E}static reedSolomonMultiply(x,S){if(x>>>8||S>>>8)throw new RangeError("Byte out of range");let E=0;for(let R=7;R>=0;R--)E=E<<1^(E>>>7)*285,E^=(S>>>R&1)*x;return c(E>>>8==0),E}finderPenaltyCountPatterns(x){const S=x[1];c(S<=this.size*3);const E=S>0&&x[2]==S&&x[3]==S*3&&x[4]==S&&x[5]==S;return(E&&x[0]>=S*4&&x[6]>=S?1:0)+(E&&x[6]>=S*4&&x[0]>=S?1:0)}finderPenaltyTerminateAndCount(x,S,E){return x&&(this.finderPenaltyAddHistory(S,E),S=0),S+=this.size,this.finderPenaltyAddHistory(S,E),this.finderPenaltyCountPatterns(E)}finderPenaltyAddHistory(x,S){S[0]==0&&(x+=this.size),S.pop(),S.unshift(x)}};r.MIN_VERSION=1,r.MAX_VERSION=40,r.PENALTY_N1=3,r.PENALTY_N2=3,r.PENALTY_N3=40,r.PENALTY_N4=10,r.ECC_CODEWORDS_PER_BLOCK=[[-1,7,10,15,20,26,18,20,24,30,18,20,24,26,30,22,24,28,30,28,28,28,28,30,30,26,28,30,30,30,30,30,30,30,30,30,30,30,30,30,30],[-1,10,16,26,18,24,16,18,22,22,26,30,22,22,24,24,28,28,26,26,26,26,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28],[-1,13,22,18,26,18,24,18,22,20,24,28,26,24,20,30,24,28,28,26,30,28,30,30,30,30,28,30,30,30,30,30,30,30,30,30,30,30,30,30,30],[-1,17,28,22,16,22,28,26,26,24,28,24,28,22,24,24,30,28,28,26,28,30,24,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30]],r.NUM_ERROR_CORRECTION_BLOCKS=[[-1,1,1,1,1,1,2,2,2,2,4,4,4,4,4,6,6,6,6,7,8,8,9,9,10,12,12,12,13,14,15,16,17,18,19,19,20,21,22,24,25],[-1,1,1,1,2,2,4,4,4,5,5,5,8,9,9,10,10,11,13,14,16,17,17,18,20,21,23,25,26,28,29,31,33,35,37,38,40,43,45,47,49],[-1,1,1,2,2,4,4,6,6,8,8,8,10,12,16,12,17,16,18,21,20,23,23,25,27,29,34,34,35,38,40,43,45,48,51,53,56,59,62,65,68],[-1,1,1,2,4,4,4,5,6,8,8,11,11,16,16,18,16,19,21,25,25,25,34,30,32,35,37,40,42,45,48,51,54,57,60,63,66,70,74,77,81]],u.QrCode=r;function i(w,x,S){if(x<0||x>31||w>>>x)throw new RangeError("Value out of range");for(let E=x-1;E>=0;E--)S.push(w>>>E&1)}function s(w,x){return(w>>>x&1)!=0}function c(w){if(!w)throw new Error("Assertion error")}const m=class On{constructor(x,S,E){if(this.mode=x,this.numChars=S,this.bitData=E,S<0)throw new RangeError("Invalid argument");this.bitData=E.slice()}static makeBytes(x){let S=[];for(const E of x)i(E,8,S);return new On(On.Mode.BYTE,x.length,S)}static makeNumeric(x){if(!On.isNumeric(x))throw new RangeError("String contains non-numeric characters");let S=[];for(let E=0;E<x.length;){const R=Math.min(x.length-E,3);i(parseInt(x.substring(E,E+R),10),R*3+1,S),E+=R}return new On(On.Mode.NUMERIC,x.length,S)}static makeAlphanumeric(x){if(!On.isAlphanumeric(x))throw new RangeError("String contains unencodable characters in alphanumeric mode");let S=[],E;for(E=0;E+2<=x.length;E+=2){let R=On.ALPHANUMERIC_CHARSET.indexOf(x.charAt(E))*45;R+=On.ALPHANUMERIC_CHARSET.indexOf(x.charAt(E+1)),i(R,11,S)}return E<x.length&&i(On.ALPHANUMERIC_CHARSET.indexOf(x.charAt(E)),6,S),new On(On.Mode.ALPHANUMERIC,x.length,S)}static makeSegments(x){return x==""?[]:On.isNumeric(x)?[On.makeNumeric(x)]:On.isAlphanumeric(x)?[On.makeAlphanumeric(x)]:[On.makeBytes(On.toUtf8ByteArray(x))]}static makeEci(x){let S=[];if(x<0)throw new RangeError("ECI assignment value out of range");if(x<128)i(x,8,S);else if(x<16384)i(2,2,S),i(x,14,S);else if(x<1e6)i(6,3,S),i(x,21,S);else throw new RangeError("ECI assignment value out of range");return new On(On.Mode.ECI,0,S)}static isNumeric(x){return On.NUMERIC_REGEX.test(x)}static isAlphanumeric(x){return On.ALPHANUMERIC_REGEX.test(x)}getData(){return this.bitData.slice()}static getTotalBits(x,S){let E=0;for(const R of x){const N=R.mode.numCharCountBits(S);if(R.numChars>=1<<N)return 1/0;E+=4+N+R.bitData.length}return E}static toUtf8ByteArray(x){x=encodeURI(x);let S=[];for(let E=0;E<x.length;E++)x.charAt(E)!="%"?S.push(x.charCodeAt(E)):(S.push(parseInt(x.substring(E+1,E+3),16)),E+=2);return S}};m.NUMERIC_REGEX=/^[0-9]*$/,m.ALPHANUMERIC_REGEX=/^[A-Z0-9 $%*+.\/:-]*$/,m.ALPHANUMERIC_CHARSET="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ $%*+-./:";let _=m;u.QrSegment=m})(Fi||(Fi={}));(u=>{(r=>{const i=class{constructor(c,m){this.ordinal=c,this.formatBits=m}};i.LOW=new i(0,1),i.MEDIUM=new i(1,0),i.QUARTILE=new i(2,3),i.HIGH=new i(3,2),r.Ecc=i})(u.QrCode||(u.QrCode={}))})(Fi||(Fi={}));(u=>{(r=>{const i=class{constructor(c,m){this.modeBits=c,this.numBitsCharCount=m}numCharCountBits(c){return this.numBitsCharCount[Math.floor((c+7)/17)]}};i.NUMERIC=new i(1,[10,12,14]),i.ALPHANUMERIC=new i(2,[9,11,13]),i.BYTE=new i(4,[8,16,16]),i.KANJI=new i(8,[8,10,12]),i.ECI=new i(7,[0,0,0]),r.Mode=i})(u.QrSegment||(u.QrSegment={}))})(Fi||(Fi={}));var Ps=Fi;var Dv={L:Ps.QrCode.Ecc.LOW,M:Ps.QrCode.Ecc.MEDIUM,Q:Ps.QrCode.Ecc.QUARTILE,H:Ps.QrCode.Ecc.HIGH},Mm=128,jm="L",Rm="#FFFFFF",Am="#000000",Nm=!1,Om=1,zv=4,Bv=0,Uv=.1;function Dm(u,r=0){const i=[];return u.forEach(function(s,c){let m=null;s.forEach(function(_,w){if(!_&&m!==null){i.push(`M${m+r} ${c+r}h${w-m}v1H${m+r}z`),m=null;return}if(w===s.length-1){if(!_)return;m===null?i.push(`M${w+r},${c+r} h1v1H${w+r}z`):i.push(`M${m+r},${c+r} h${w+1-m}v1H${m+r}z`);return}_&&m===null&&(m=w)})}),i.join("")}function zm(u,r){return u.slice().map((i,s)=>s<r.y||s>=r.y+r.h?i:i.map((c,m)=>m<r.x||m>=r.x+r.w?c:!1))}function Lv(u,r,i,s){if(s==null)return null;const c=u.length+i*2,m=Math.floor(r*Uv),_=c/r,w=(s.width||m)*_,x=(s.height||m)*_,S=s.x==null?u.length/2-w/2:s.x*_,E=s.y==null?u.length/2-x/2:s.y*_,R=s.opacity==null?1:s.opacity;let N=null;if(s.excavate){let ie=Math.floor(S),se=Math.floor(E),Re=Math.ceil(w+S-ie),lt=Math.ceil(x+E-se);N={x:ie,y:se,w:Re,h:lt}}const q=s.crossOrigin;return{x:S,y:E,h:x,w,excavation:N,opacity:R,crossOrigin:q}}function Hv(u,r){return r!=null?Math.max(Math.floor(r),0):u?zv:Bv}function Bm({value:u,level:r,minVersion:i,includeMargin:s,marginSize:c,imageSettings:m,size:_,boostLevel:w}){let x=jn.useMemo(()=>{const ie=(Array.isArray(u)?u:[u]).reduce((se,Re)=>(se.push(...Ps.QrSegment.makeSegments(Re)),se),[]);return Ps.QrCode.encodeSegments(ie,Dv[r],i,void 0,void 0,w)},[u,r,i,w]);const{cells:S,margin:E,numCells:R,calculatedImageSettings:N}=jn.useMemo(()=>{let q=x.getModules();const ie=Hv(s,c),se=q.length+ie*2,Re=Lv(q,_,ie,m);return{cells:q,margin:ie,numCells:se,calculatedImageSettings:Re}},[x,_,m,s,c]);return{qrcode:x,margin:E,cells:S,numCells:R,calculatedImageSettings:N}}var Iv=(function(){try{new Path2D().addPath(new Path2D)}catch{return!1}return!0})(),Kv=jn.forwardRef(function(r,i){const s=r,{value:c,size:m=Mm,level:_=jm,bgColor:w=Rm,fgColor:x=Am,includeMargin:S=Nm,minVersion:E=Om,boostLevel:R,marginSize:N,imageSettings:q}=s,se=Pf(s,["value","size","level","bgColor","fgColor","includeMargin","minVersion","boostLevel","marginSize","imageSettings"]),{style:Re}=se,lt=Pf(se,["style"]),ke=q?.src,we=jn.useRef(null),$e=jn.useRef(null),Je=jn.useCallback(xt=>{we.current=xt,typeof i=="function"?i(xt):i&&(i.current=xt)},[i]),[ft,et]=jn.useState(!1),{margin:qt,cells:en,numCells:Oe,calculatedImageSettings:Te}=Bm({value:c,level:_,minVersion:E,boostLevel:R,includeMargin:S,marginSize:N,imageSettings:q,size:m});jn.useEffect(()=>{if(we.current!=null){const xt=we.current,qe=xt.getContext("2d");if(!qe)return;let J=en;const Me=$e.current,Ge=Te!=null&&Me!==null&&Me.complete&&Me.naturalHeight!==0&&Me.naturalWidth!==0;Ge&&Te.excavation!=null&&(J=zm(en,Te.excavation));const je=window.devicePixelRatio||1;xt.height=xt.width=m*je;const Ye=m/Oe*je;qe.scale(Ye,Ye),qe.fillStyle=w,qe.fillRect(0,0,Oe,Oe),qe.fillStyle=x,Iv?qe.fill(new Path2D(Dm(J,qt))):en.forEach(function(L,de){L.forEach(function(Ce,Le){Ce&&qe.fillRect(Le+qt,de+qt,1,1)})}),Te&&(qe.globalAlpha=Te.opacity),Ge&&qe.drawImage(Me,Te.x+qt,Te.y+qt,Te.w,Te.h)}}),jn.useEffect(()=>{et(!1)},[ke]);const pe=Kf({height:m,width:m},Re);let ue=null;return ke!=null&&(ue=jn.createElement("img",{src:ke,key:ke,style:{display:"none"},onLoad:()=>{et(!0)},ref:$e,crossOrigin:Te?.crossOrigin})),jn.createElement(jn.Fragment,null,jn.createElement("canvas",Kf({style:pe,height:m,width:m,ref:Je,role:"img"},lt)),ue)});Kv.displayName="QRCodeCanvas";var Um=jn.forwardRef(function(r,i){const s=r,{value:c,size:m=Mm,level:_=jm,bgColor:w=Rm,fgColor:x=Am,includeMargin:S=Nm,minVersion:E=Om,boostLevel:R,title:N,marginSize:q,imageSettings:ie}=s,se=Pf(s,["value","size","level","bgColor","fgColor","includeMargin","minVersion","boostLevel","title","marginSize","imageSettings"]),{margin:Re,cells:lt,numCells:ke,calculatedImageSettings:we}=Bm({value:c,level:_,minVersion:E,boostLevel:R,includeMargin:S,marginSize:q,imageSettings:ie,size:m});let $e=lt,Je=null;ie!=null&&we!=null&&(we.excavation!=null&&($e=zm(lt,we.excavation)),Je=jn.createElement("image",{href:ie.src,height:we.h,width:we.w,x:we.x+Re,y:we.y+Re,preserveAspectRatio:"none",opacity:we.opacity,crossOrigin:we.crossOrigin}));const ft=Dm($e,Re);return jn.createElement("svg",Kf({height:m,width:m,viewBox:`0 0 ${ke} ${ke}`,ref:i,role:"img"},se),!!N&&jn.createElement("title",null,N),jn.createElement("path",{fill:w,d:`M0,0 h${ke}v${ke}H0z`,shapeRendering:"crispEdges"}),jn.createElement("path",{fill:x,d:ft,shapeRendering:"crispEdges"}),Je)});Um.displayName="QRCodeSVG";class Gt{constructor(r,i,s,c,m){this._legacyCanvasSize=Gt.DEFAULT_CANVAS_SIZE,this._preferredCamera="environment",this._maxScansPerSecond=25,this._lastScanTimestamp=-1,this._destroyed=this._flashOn=this._paused=this._active=!1,this.$video=r,this.$canvas=document.createElement("canvas"),s&&typeof s=="object"?this._onDecode=i:(console.warn(s||c||m?"You're using a deprecated version of the QrScanner constructor which will be removed in the future":"Note that the type of the scan result passed to onDecode will change in the future. To already switch to the new api today, you can pass returnDetailedScanResult: true."),this._legacyOnDecode=i),i=typeof s=="object"?s:{},this._onDecodeError=i.onDecodeError||(typeof s=="function"?s:this._onDecodeError),this._calculateScanRegion=i.calculateScanRegion||(typeof c=="function"?c:this._calculateScanRegion),this._preferredCamera=i.preferredCamera||m||this._preferredCamera,this._legacyCanvasSize=typeof s=="number"?s:typeof c=="number"?c:this._legacyCanvasSize,this._maxScansPerSecond=i.maxScansPerSecond||this._maxScansPerSecond,this._onPlay=this._onPlay.bind(this),this._onLoadedMetaData=this._onLoadedMetaData.bind(this),this._onVisibilityChange=this._onVisibilityChange.bind(this),this._updateOverlay=this._updateOverlay.bind(this),r.disablePictureInPicture=!0,r.playsInline=!0,r.muted=!0;let _=!1;if(r.hidden&&(r.hidden=!1,_=!0),document.body.contains(r)||(document.body.appendChild(r),_=!0),s=r.parentElement,i.highlightScanRegion||i.highlightCodeOutline){if(c=!!i.overlay,this.$overlay=i.overlay||document.createElement("div"),m=this.$overlay.style,m.position="absolute",m.display="none",m.pointerEvents="none",this.$overlay.classList.add("scan-region-highlight"),!c&&i.highlightScanRegion){this.$overlay.innerHTML='<svg class="scan-region-highlight-svg" viewBox="0 0 238 238" preserveAspectRatio="none" style="position:absolute;width:100%;height:100%;left:0;top:0;fill:none;stroke:#e9b213;stroke-width:4;stroke-linecap:round;stroke-linejoin:round"><path d="M31 2H10a8 8 0 0 0-8 8v21M207 2h21a8 8 0 0 1 8 8v21m0 176v21a8 8 0 0 1-8 8h-21m-176 0H10a8 8 0 0 1-8-8v-21"/></svg>';try{this.$overlay.firstElementChild.animate({transform:["scale(.98)","scale(1.01)"]},{duration:400,iterations:1/0,direction:"alternate",easing:"ease-in-out"})}catch{}s.insertBefore(this.$overlay,this.$video.nextSibling)}i.highlightCodeOutline&&(this.$overlay.insertAdjacentHTML("beforeend",'<svg class="code-outline-highlight" preserveAspectRatio="none" style="display:none;width:100%;height:100%;fill:none;stroke:#e9b213;stroke-width:5;stroke-dasharray:25;stroke-linecap:round;stroke-linejoin:round"><polygon/></svg>'),this.$codeOutlineHighlight=this.$overlay.lastElementChild)}this._scanRegion=this._calculateScanRegion(r),requestAnimationFrame(()=>{let w=window.getComputedStyle(r);w.display==="none"&&(r.style.setProperty("display","block","important"),_=!0),w.visibility!=="visible"&&(r.style.setProperty("visibility","visible","important"),_=!0),_&&(console.warn("QrScanner has overwritten the video hiding style to avoid Safari stopping the playback."),r.style.opacity="0",r.style.width="0",r.style.height="0",this.$overlay&&this.$overlay.parentElement&&this.$overlay.parentElement.removeChild(this.$overlay),delete this.$overlay,delete this.$codeOutlineHighlight),this.$overlay&&this._updateOverlay()}),r.addEventListener("play",this._onPlay),r.addEventListener("loadedmetadata",this._onLoadedMetaData),document.addEventListener("visibilitychange",this._onVisibilityChange),window.addEventListener("resize",this._updateOverlay),this._qrEnginePromise=Gt.createQrEngine()}static set WORKER_PATH(r){console.warn("Setting QrScanner.WORKER_PATH is not required and not supported anymore. Have a look at the README for new setup instructions.")}static async hasCamera(){try{return!!(await Gt.listCameras(!1)).length}catch{return!1}}static async listCameras(r=!1){if(!navigator.mediaDevices)return[];let i=async()=>(await navigator.mediaDevices.enumerateDevices()).filter(c=>c.kind==="videoinput"),s;try{r&&(await i()).every(c=>!c.label)&&(s=await navigator.mediaDevices.getUserMedia({audio:!1,video:!0}))}catch{}try{return(await i()).map((c,m)=>({id:c.deviceId,label:c.label||(m===0?"Default Camera":`Camera ${m+1}`)}))}finally{s&&(console.warn("Call listCameras after successfully starting a QR scanner to avoid creating a temporary video stream"),Gt._stopVideoStream(s))}}async hasFlash(){let r;try{if(this.$video.srcObject){if(!(this.$video.srcObject instanceof MediaStream))return!1;r=this.$video.srcObject}else r=(await this._getCameraStream()).stream;return"torch"in r.getVideoTracks()[0].getSettings()}catch{return!1}finally{r&&r!==this.$video.srcObject&&(console.warn("Call hasFlash after successfully starting the scanner to avoid creating a temporary video stream"),Gt._stopVideoStream(r))}}isFlashOn(){return this._flashOn}async toggleFlash(){this._flashOn?await this.turnFlashOff():await this.turnFlashOn()}async turnFlashOn(){if(!this._flashOn&&!this._destroyed&&(this._flashOn=!0,this._active&&!this._paused))try{if(!await this.hasFlash())throw"No flash available";await this.$video.srcObject.getVideoTracks()[0].applyConstraints({advanced:[{torch:!0}]})}catch(r){throw this._flashOn=!1,r}}async turnFlashOff(){this._flashOn&&(this._flashOn=!1,await this._restartVideoStream())}destroy(){this.$video.removeEventListener("loadedmetadata",this._onLoadedMetaData),this.$video.removeEventListener("play",this._onPlay),document.removeEventListener("visibilitychange",this._onVisibilityChange),window.removeEventListener("resize",this._updateOverlay),this._destroyed=!0,this._flashOn=!1,this.stop(),Gt._postWorkerMessage(this._qrEnginePromise,"close")}async start(){if(this._destroyed)throw Error("The QR scanner can not be started as it had been destroyed.");if((!this._active||this._paused)&&(window.location.protocol!=="https:"&&console.warn("The camera stream is only accessible if the page is transferred via https."),this._active=!0,!document.hidden))if(this._paused=!1,this.$video.srcObject)await this.$video.play();else try{let{stream:r,facingMode:i}=await this._getCameraStream();!this._active||this._paused?Gt._stopVideoStream(r):(this._setVideoMirror(i),this.$video.srcObject=r,await this.$video.play(),this._flashOn&&(this._flashOn=!1,this.turnFlashOn().catch(()=>{})))}catch(r){if(!this._paused)throw this._active=!1,r}}stop(){this.pause(),this._active=!1}async pause(r=!1){if(this._paused=!0,!this._active)return!0;this.$video.pause(),this.$overlay&&(this.$overlay.style.display="none");let i=()=>{this.$video.srcObject instanceof MediaStream&&(Gt._stopVideoStream(this.$video.srcObject),this.$video.srcObject=null)};return r?(i(),!0):(await new Promise(s=>setTimeout(s,300)),this._paused?(i(),!0):!1)}async setCamera(r){r!==this._preferredCamera&&(this._preferredCamera=r,await this._restartVideoStream())}static async scanImage(r,i,s,c,m=!1,_=!1){let w,x=!1;i&&("scanRegion"in i||"qrEngine"in i||"canvas"in i||"disallowCanvasResizing"in i||"alsoTryWithoutScanRegion"in i||"returnDetailedScanResult"in i)?(w=i.scanRegion,s=i.qrEngine,c=i.canvas,m=i.disallowCanvasResizing||!1,_=i.alsoTryWithoutScanRegion||!1,x=!0):console.warn(i||s||c||m||_?"You're using a deprecated api for scanImage which will be removed in the future.":"Note that the return type of scanImage will change in the future. To already switch to the new api today, you can pass returnDetailedScanResult: true."),i=!!s;try{let S,E;[s,S]=await Promise.all([s||Gt.createQrEngine(),Gt._loadImage(r)]),[c,E]=Gt._drawToCanvas(S,w,c,m);let R;if(s instanceof Worker){let N=s;i||Gt._postWorkerMessageSync(N,"inversionMode","both"),R=await new Promise((q,ie)=>{let se,Re,lt,ke=-1;Re=$e=>{$e.data.id===ke&&(N.removeEventListener("message",Re),N.removeEventListener("error",lt),clearTimeout(se),$e.data.data!==null?q({data:$e.data.data,cornerPoints:Gt._convertPoints($e.data.cornerPoints,w)}):ie(Gt.NO_QR_CODE_FOUND))},lt=$e=>{N.removeEventListener("message",Re),N.removeEventListener("error",lt),clearTimeout(se),ie("Scanner error: "+($e?$e.message||$e:"Unknown Error"))},N.addEventListener("message",Re),N.addEventListener("error",lt),se=setTimeout(()=>lt("timeout"),1e4);let we=E.getImageData(0,0,c.width,c.height);ke=Gt._postWorkerMessageSync(N,"decode",we,[we.data.buffer])})}else R=await Promise.race([new Promise((N,q)=>window.setTimeout(()=>q("Scanner error: timeout"),1e4)),(async()=>{try{var[N]=await s.detect(c);if(!N)throw Gt.NO_QR_CODE_FOUND;return{data:N.rawValue,cornerPoints:Gt._convertPoints(N.cornerPoints,w)}}catch(q){if(N=q.message||q,/not implemented|service unavailable/.test(N))return Gt._disableBarcodeDetector=!0,Gt.scanImage(r,{scanRegion:w,canvas:c,disallowCanvasResizing:m,alsoTryWithoutScanRegion:_});throw`Scanner error: ${N}`}})()]);return x?R:R.data}catch(S){if(!w||!_)throw S;let E=await Gt.scanImage(r,{qrEngine:s,canvas:c,disallowCanvasResizing:m});return x?E:E.data}finally{i||Gt._postWorkerMessage(s,"close")}}setGrayscaleWeights(r,i,s,c=!0){Gt._postWorkerMessage(this._qrEnginePromise,"grayscaleWeights",{red:r,green:i,blue:s,useIntegerApproximation:c})}setInversionMode(r){Gt._postWorkerMessage(this._qrEnginePromise,"inversionMode",r)}static async createQrEngine(r){if(r&&console.warn("Specifying a worker path is not required and not supported anymore."),r=()=>sc(()=>import("./qr-scanner-worker.min-D85Z9gVD.js"),[]).then(s=>s.createWorker()),!(!Gt._disableBarcodeDetector&&"BarcodeDetector"in window&&BarcodeDetector.getSupportedFormats&&(await BarcodeDetector.getSupportedFormats()).includes("qr_code")))return r();let i=navigator.userAgentData;return i&&i.brands.some(({brand:s})=>/Chromium/i.test(s))&&/mac ?OS/i.test(i.platform)&&await i.getHighEntropyValues(["architecture","platformVersion"]).then(({architecture:s,platformVersion:c})=>/arm/i.test(s||"arm")&&13<=parseInt(c||"13")).catch(()=>!0)?r():new BarcodeDetector({formats:["qr_code"]})}_onPlay(){this._scanRegion=this._calculateScanRegion(this.$video),this._updateOverlay(),this.$overlay&&(this.$overlay.style.display=""),this._scanFrame()}_onLoadedMetaData(){this._scanRegion=this._calculateScanRegion(this.$video),this._updateOverlay()}_onVisibilityChange(){document.hidden?this.pause():this._active&&this.start()}_calculateScanRegion(r){let i=Math.round(.6666666666666666*Math.min(r.videoWidth,r.videoHeight));return{x:Math.round((r.videoWidth-i)/2),y:Math.round((r.videoHeight-i)/2),width:i,height:i,downScaledWidth:this._legacyCanvasSize,downScaledHeight:this._legacyCanvasSize}}_updateOverlay(){requestAnimationFrame(()=>{if(this.$overlay){var r=this.$video,i=r.videoWidth,s=r.videoHeight,c=r.offsetWidth,m=r.offsetHeight,_=r.offsetLeft,w=r.offsetTop,x=window.getComputedStyle(r),S=x.objectFit,E=i/s,R=c/m;switch(S){case"none":var N=i,q=s;break;case"fill":N=c,q=m;break;default:(S==="cover"?E>R:E<R)?(q=m,N=q*E):(N=c,q=N/E),S==="scale-down"&&(N=Math.min(N,i),q=Math.min(q,s))}var[ie,se]=x.objectPosition.split(" ").map((lt,ke)=>{const we=parseFloat(lt);return lt.endsWith("%")?(ke?m-q:c-N)*we/100:we});x=this._scanRegion.width||i,R=this._scanRegion.height||s,S=this._scanRegion.x||0;var Re=this._scanRegion.y||0;E=this.$overlay.style,E.width=`${x/i*N}px`,E.height=`${R/s*q}px`,E.top=`${w+se+Re/s*q}px`,s=/scaleX\(-1\)/.test(r.style.transform),E.left=`${_+(s?c-ie-N:ie)+(s?i-S-x:S)/i*N}px`,E.transform=r.style.transform}})}static _convertPoints(r,i){if(!i)return r;let s=i.x||0,c=i.y||0,m=i.width&&i.downScaledWidth?i.width/i.downScaledWidth:1;i=i.height&&i.downScaledHeight?i.height/i.downScaledHeight:1;for(let _ of r)_.x=_.x*m+s,_.y=_.y*i+c;return r}_scanFrame(){!this._active||this.$video.paused||this.$video.ended||("requestVideoFrameCallback"in this.$video?this.$video.requestVideoFrameCallback.bind(this.$video):requestAnimationFrame)(async()=>{if(!(1>=this.$video.readyState)){var r=Date.now()-this._lastScanTimestamp,i=1e3/this._maxScansPerSecond;r<i&&await new Promise(c=>setTimeout(c,i-r)),this._lastScanTimestamp=Date.now();try{var s=await Gt.scanImage(this.$video,{scanRegion:this._scanRegion,qrEngine:this._qrEnginePromise,canvas:this.$canvas})}catch(c){if(!this._active)return;this._onDecodeError(c)}!Gt._disableBarcodeDetector||await this._qrEnginePromise instanceof Worker||(this._qrEnginePromise=Gt.createQrEngine()),s?(this._onDecode?this._onDecode(s):this._legacyOnDecode&&this._legacyOnDecode(s.data),this.$codeOutlineHighlight&&(clearTimeout(this._codeOutlineHighlightRemovalTimeout),this._codeOutlineHighlightRemovalTimeout=void 0,this.$codeOutlineHighlight.setAttribute("viewBox",`${this._scanRegion.x||0} ${this._scanRegion.y||0} ${this._scanRegion.width||this.$video.videoWidth} ${this._scanRegion.height||this.$video.videoHeight}`),this.$codeOutlineHighlight.firstElementChild.setAttribute("points",s.cornerPoints.map(({x:c,y:m})=>`${c},${m}`).join(" ")),this.$codeOutlineHighlight.style.display="")):this.$codeOutlineHighlight&&!this._codeOutlineHighlightRemovalTimeout&&(this._codeOutlineHighlightRemovalTimeout=setTimeout(()=>this.$codeOutlineHighlight.style.display="none",100))}this._scanFrame()})}_onDecodeError(r){r!==Gt.NO_QR_CODE_FOUND&&console.log(r)}async _getCameraStream(){if(!navigator.mediaDevices)throw"Camera not found.";let r=/^(environment|user)$/.test(this._preferredCamera)?"facingMode":"deviceId",i=[{width:{min:1024}},{width:{min:768}},{}],s=i.map(c=>Object.assign({},c,{[r]:{exact:this._preferredCamera}}));for(let c of[...s,...i])try{let m=await navigator.mediaDevices.getUserMedia({video:c,audio:!1}),_=this._getFacingMode(m)||(c.facingMode?this._preferredCamera:this._preferredCamera==="environment"?"user":"environment");return{stream:m,facingMode:_}}catch{}throw"Camera not found."}async _restartVideoStream(){let r=this._paused;await this.pause(!0)&&!r&&this._active&&await this.start()}static _stopVideoStream(r){for(let i of r.getTracks())i.stop(),r.removeTrack(i)}_setVideoMirror(r){this.$video.style.transform="scaleX("+(r==="user"?-1:1)+")"}_getFacingMode(r){return(r=r.getVideoTracks()[0])?/rear|back|environment/i.test(r.label)?"environment":/front|user|face/i.test(r.label)?"user":null:null}static _drawToCanvas(r,i,s,c=!1){s=s||document.createElement("canvas");let m=i&&i.x?i.x:0,_=i&&i.y?i.y:0,w=i&&i.width?i.width:r.videoWidth||r.width,x=i&&i.height?i.height:r.videoHeight||r.height;return c||(c=i&&i.downScaledWidth?i.downScaledWidth:w,i=i&&i.downScaledHeight?i.downScaledHeight:x,s.width!==c&&(s.width=c),s.height!==i&&(s.height=i)),i=s.getContext("2d",{alpha:!1}),i.imageSmoothingEnabled=!1,i.drawImage(r,m,_,w,x,0,0,s.width,s.height),[s,i]}static async _loadImage(r){if(r instanceof Image)return await Gt._awaitImageLoad(r),r;if(r instanceof HTMLVideoElement||r instanceof HTMLCanvasElement||r instanceof SVGImageElement||"OffscreenCanvas"in window&&r instanceof OffscreenCanvas||"ImageBitmap"in window&&r instanceof ImageBitmap)return r;if(r instanceof File||r instanceof Blob||r instanceof URL||typeof r=="string"){let i=new Image;i.src=r instanceof File||r instanceof Blob?URL.createObjectURL(r):r.toString();try{return await Gt._awaitImageLoad(i),i}finally{(r instanceof File||r instanceof Blob)&&URL.revokeObjectURL(i.src)}}else throw"Unsupported image type."}static async _awaitImageLoad(r){r.complete&&r.naturalWidth!==0||await new Promise((i,s)=>{let c=m=>{r.removeEventListener("load",c),r.removeEventListener("error",c),m instanceof ErrorEvent?s("Image load error"):i()};r.addEventListener("load",c),r.addEventListener("error",c)})}static async _postWorkerMessage(r,i,s,c){return Gt._postWorkerMessageSync(await r,i,s,c)}static _postWorkerMessageSync(r,i,s,c){if(!(r instanceof Worker))return-1;let m=Gt._workerMessageId++;return r.postMessage({id:m,type:i,data:s},c),m}}Gt.DEFAULT_CANVAS_SIZE=400;Gt.NO_QR_CODE_FOUND="No QR code found";Gt._disableBarcodeDetector=!1;Gt._workerMessageId=0;const lr=[];for(let u=0;u<256;++u)lr.push((u+256).toString(16).slice(1));function Pv(u,r=0){return(lr[u[r+0]]+lr[u[r+1]]+lr[u[r+2]]+lr[u[r+3]]+"-"+lr[u[r+4]]+lr[u[r+5]]+"-"+lr[u[r+6]]+lr[u[r+7]]+"-"+lr[u[r+8]]+lr[u[r+9]]+"-"+lr[u[r+10]]+lr[u[r+11]]+lr[u[r+12]]+lr[u[r+13]]+lr[u[r+14]]+lr[u[r+15]]).toLowerCase()}let kf;const qv=new Uint8Array(16);function Yv(){if(!kf){if(typeof crypto>"u"||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");kf=crypto.getRandomValues.bind(crypto)}return kf(qv)}const Vv=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),Rp={randomUUID:Vv};function Gv(u,r,i){u=u||{};const s=u.random??u.rng?.()??Yv();if(s.length<16)throw new Error("Random bytes length must be >= 16");return s[6]=s[6]&15|64,s[8]=s[8]&63|128,Pv(s)}function Lm(u,r,i){return Rp.randomUUID&&!u?Rp.randomUUID():Gv(u)}class Vo{static async createInvite(r,i=1,s,c){const m=wi.getState().identity;if(!m)throw new Error("No identity found");const _=Lm(),w=Vt.decodeBase64(m.secretKey),x=Yo(Vt.decodeBase64(m.publicKey)),S=Em(w),E=cv(m.userId,_,x,S),R={inviteId:_,nonce:E.nonce,valid:!0,useCount:0,useLimit:i>0?i:void 0,name:r,note:c,expiry:s,createdAt:Date.now()};i<=0&&delete R.useLimit,await Tn.addInvite(R);const q=`adun-app://invite?data=${btoa(JSON.stringify(E))}`;return{invite:R,link:q,psi:E}}static async getInvites(){return await Tn.getInvites()}static async revokeInvite(r){await Tn.invalidateInvite(r)}static async deleteInvite(r){await Tn.deleteInvite(r)}static parseInviteLink(r){try{const i=new URL(r);if(i.protocol!=="p2pchat:"&&i.protocol!=="adun-app:")return null;const s=i.searchParams.get("data");if(!s)return null;const c=JSON.parse(atob(s));return i.host==="add"?{type:"identity",data:c}:i.host==="invite"?{type:"invite",data:c}:null}catch(i){return console.error("Failed to parse invite link",i),null}}}function Qv({onClose:u}){const{identity:r}=wi(),{addContact:i}=br(),[s,c]=yt.useState("share"),[m,_]=yt.useState("invite"),[w,x]=yt.useState(""),[S,E]=yt.useState(null),[R,N]=yt.useState(!1),[q,ie]=yt.useState("Contact added successfully!"),[se,Re]=yt.useState("idle"),[lt,ke]=yt.useState(""),[we,$e]=yt.useState(1),[Je,ft]=yt.useState(!0),[et,qt]=yt.useState("days"),[en,Oe]=yt.useState(10),[Te,pe]=yt.useState(()=>{const Ee=new Date;return Ee.setDate(Ee.getDate()+10),Ee.toISOString().split("T")[0]}),[ue,xt]=yt.useState(null),[qe,J]=yt.useState(!1);if(!r)return null;const Me={version:1,publicKey:r.publicKey},Ge=`adun-app://add?data=${btoa(JSON.stringify(Me))}`,je=async()=>{if(!lt.trim()){E("Please enter a name for the invite");return}J(!0),E(null);try{let Ee;if(Je)if(et==="days")Ee=Date.now()+en*24*60*60*1e3;else{const kt=new Date(Te);kt.setHours(23,59,59,999),Ee=kt.getTime()}const dt=await Vo.createInvite(lt.trim(),we,Ee);xt({link:dt.link,invite:dt.invite})}catch(Ee){console.error("Failed to create invite:",Ee),E("Failed to create invite")}finally{J(!1)}},Ye=async Ee=>{const dt=Ee.target.files?.[0];if(dt)try{const kt=await Gt.scanImage(dt,{returnDetailedScanResult:!0});await L(kt.data)}catch(kt){E("Failed to scan QR code. Please try again."),console.error(kt)}},L=async Ee=>{console.log("[AddContactModal] Processing data:",Ee),E(null);try{const dt=Vo.parseInviteLink(Ee);if(!dt)throw new Error("Invalid link format");if(dt.type==="identity"){const kt=dt.data;if(!kt.publicKey)throw new Error("Incomplete contact data");const ze=Cm(kt.publicKey);if(ze===r.userId){E("You cannot add yourself as a contact");return}i({userId:ze,publicKey:kt.publicKey,addedAt:Date.now(),status:"offline",localProfile:{}},!0),ie("Contact added successfully!")}else if(dt.type==="invite"){const kt=dt.data;if(kt.invitingId===r.userId){E("You cannot use your own invite");return}await $n.initiateInviteHandshake(kt),ie("Invite accepted! Connecting to peer...")}console.log("[AddContactModal] Success"),N(!0),setTimeout(()=>{u()},2e3)}catch(dt){E("Invalid data. Please check and try again."),console.error("[AddContactModal] Error:",dt)}},de=()=>{if(console.log("[AddContactModal] Manual add clicked. Input:",w),!w.trim()){E("Please enter the link");return}L(w.trim())},Ce=async(Ee,dt)=>{try{if(navigator.clipboard&&window.isSecureContext)await navigator.clipboard.writeText(Ee),dt("copied"),setTimeout(()=>dt("idle"),2e3);else{const kt=document.createElement("textarea");kt.value=Ee,kt.style.position="fixed",kt.style.left="-999999px",kt.style.top="-999999px",document.body.appendChild(kt),kt.focus(),kt.select();const ze=document.execCommand("copy");if(document.body.removeChild(kt),ze)dt("copied"),setTimeout(()=>dt("idle"),2e3);else throw new Error("Copy command failed")}}catch(kt){console.error("Failed to copy:",kt),dt("error"),setTimeout(()=>dt("idle"),2e3)}},Le=async(Ee,dt,kt)=>{if(navigator.share)try{await navigator.share({title:dt,text:kt,url:Ee})}catch{console.log("Share cancelled")}else Ce(Ee,Re)},De=m==="identity"?Ge:ue?.link;return y.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center p-4 z-50 animate-fade-in",onClick:u,children:y.jsxs("div",{className:"bg-[var(--color-bg-card)] border border-slate-700 text-slate-200 rounded-2xl max-w-md w-full max-h-[90vh] overflow-y-auto shadow-2xl",onClick:Ee=>Ee.stopPropagation(),role:"dialog","aria-modal":"true","aria-labelledby":"modal-title",children:[y.jsxs("div",{className:"sticky top-0 bg-[var(--color-bg-card)]/95 backdrop-blur border-b border-slate-700/50 px-6 py-4 flex items-center justify-between z-10",children:[y.jsx("h2",{id:"modal-title",className:"text-xl font-bold text-white",children:"Add Contact"}),y.jsx("button",{onClick:u,"aria-label":"Close",className:"p-2 hover:bg-slate-700 rounded-full transition-colors text-slate-400 hover:text-white",children:y.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),y.jsxs("div",{className:"flex border-b border-slate-700/50",children:[y.jsx("button",{onClick:()=>{c("share"),E(null)},className:`flex-1 px-4 py-3 text-sm font-medium transition-colors ${s==="share"?"border-b-2 border-indigo-500 text-indigo-400":"text-slate-400 hover:text-slate-200"}`,children:"Share"}),y.jsx("button",{onClick:()=>{c("scan"),E(null)},className:`flex-1 px-4 py-3 text-sm font-medium transition-colors ${s==="scan"?"border-b-2 border-indigo-500 text-indigo-400":"text-slate-400 hover:text-slate-200"}`,children:"Scan"}),y.jsx("button",{onClick:()=>{c("manual"),E(null)},className:`flex-1 px-4 py-3 text-sm font-medium transition-colors ${s==="manual"?"border-b-2 border-indigo-500 text-indigo-400":"text-slate-400 hover:text-slate-200"}`,children:"Manual"})]}),y.jsxs("div",{className:"p-6",children:[R&&y.jsx("div",{className:"mb-4 p-4 bg-emerald-500/10 border border-emerald-500/20 rounded-xl",children:y.jsxs("p",{className:"text-sm text-emerald-400 font-medium flex items-center",children:[y.jsx("svg",{className:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),q]})}),S&&y.jsx("div",{className:"mb-4 p-4 bg-red-500/10 border border-red-500/20 rounded-xl",children:y.jsxs("p",{className:"text-sm text-red-400 flex items-center",children:[y.jsx("svg",{className:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),S]})}),s==="share"&&y.jsxs("div",{className:"space-y-6",children:[y.jsxs("div",{className:"flex bg-slate-800/50 p-1 rounded-xl",children:[y.jsx("button",{onClick:()=>_("invite"),className:`flex-1 py-2 text-sm font-medium rounded-lg transition-all ${m==="invite"?"bg-indigo-600 text-white shadow-lg":"text-slate-400 hover:text-slate-200"}`,children:"Create Invite"}),y.jsx("button",{onClick:()=>_("identity"),className:`flex-1 py-2 text-sm font-medium rounded-lg transition-all ${m==="identity"?"bg-indigo-600 text-white shadow-lg":"text-slate-400 hover:text-slate-200"}`,children:"My Identity"})]}),m==="invite"&&!ue&&y.jsxs("div",{className:"space-y-4 animate-fade-in",children:[y.jsxs("div",{children:[y.jsx("label",{className:"block text-xs font-medium text-slate-400 uppercase tracking-wider mb-2",children:"Name (for your reference)"}),y.jsx("input",{type:"text",value:lt,onChange:Ee=>ke(Ee.target.value),placeholder:"e.g. Bob, Work Colleagues",className:"w-full px-4 py-3 bg-slate-900/50 border border-slate-700 rounded-xl text-white placeholder-slate-500 focus:outline-none focus:ring-2 focus:ring-indigo-500/50"})]}),y.jsxs("div",{children:[y.jsx("label",{className:"block text-xs font-medium text-slate-400 uppercase tracking-wider mb-2",children:"Use Limit"}),y.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[y.jsx("button",{onClick:()=>$e(1),className:`px-3 py-2 rounded-lg text-sm font-medium border transition-all ${we===1?"bg-indigo-500/20 border-indigo-500 text-indigo-300":"bg-slate-800 border-slate-700 text-slate-400 hover:border-slate-600"}`,children:"1 Use (Peer)"}),y.jsx("button",{onClick:()=>$e(10),className:`px-3 py-2 rounded-lg text-sm font-medium border transition-all ${we===10?"bg-indigo-500/20 border-indigo-500 text-indigo-300":"bg-slate-800 border-slate-700 text-slate-400 hover:border-slate-600"}`,children:"10 Uses (Group)"}),y.jsx("button",{onClick:()=>$e(0),className:`px-3 py-2 rounded-lg text-sm font-medium border transition-all ${we===0?"bg-indigo-500/20 border-indigo-500 text-indigo-300":"bg-slate-800 border-slate-700 text-slate-400 hover:border-slate-600"}`,children:"Unlimited"})]}),y.jsx("p",{className:"mt-2 text-xs text-slate-500",children:we===1?"Single use. The name will be used as the contact name.":"Multiple uses. The name will be used as the group name."})]}),y.jsxs("div",{children:[y.jsxs("div",{className:"flex items-center justify-between mb-2",children:[y.jsx("label",{className:"text-xs font-medium text-slate-400 uppercase tracking-wider",children:"Expiry"}),y.jsx("div",{className:"flex items-center",children:y.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[y.jsx("input",{type:"checkbox",className:"sr-only peer",checked:Je,onChange:Ee=>ft(Ee.target.checked)}),y.jsx("div",{className:"w-9 h-5 bg-slate-700 peer-focus:outline-none peer-focus:ring-2 peer-focus:ring-indigo-500 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-4 after:w-4 after:transition-all peer-checked:bg-indigo-600"}),y.jsx("span",{className:"ml-2 text-xs font-medium text-slate-300",children:Je?"Enabled":"Disabled"})]})})]}),Je&&y.jsxs("div",{className:"bg-slate-800/50 rounded-xl p-3 space-y-3 animate-fade-in",children:[y.jsxs("div",{className:"flex space-x-2",children:[y.jsx("button",{onClick:()=>qt("days"),className:`flex-1 py-1.5 text-xs font-medium rounded-lg transition-all ${et==="days"?"bg-slate-700 text-white shadow-sm":"text-slate-400 hover:text-slate-200"}`,children:"Days"}),y.jsx("button",{onClick:()=>qt("date"),className:`flex-1 py-1.5 text-xs font-medium rounded-lg transition-all ${et==="date"?"bg-slate-700 text-white shadow-sm":"text-slate-400 hover:text-slate-200"}`,children:"Date"})]}),et==="days"?y.jsxs("div",{className:"flex items-center gap-2",children:[y.jsx("div",{className:"flex gap-1",children:[1,10,30].map(Ee=>y.jsx("button",{onClick:()=>Oe(Ee),className:`px-3 py-2 rounded-lg text-sm font-medium border transition-all ${en===Ee?"bg-indigo-500/20 border-indigo-500 text-indigo-300":"bg-slate-800 border-slate-700 text-slate-400 hover:border-slate-600"}`,children:Ee},Ee))}),y.jsxs("div",{className:"flex-1 flex items-center gap-2",children:[y.jsx("input",{type:"number",min:"1",value:en,onChange:Ee=>Oe(Math.max(1,parseInt(Ee.target.value)||0)),className:"w-full px-3 py-2 bg-slate-900/50 border border-slate-700 rounded-xl text-white placeholder-slate-500 focus:outline-none focus:ring-2 focus:ring-indigo-500/50 text-center"}),y.jsx("span",{className:"text-sm text-slate-400 whitespace-nowrap",children:"days"})]})]}):y.jsx("input",{type:"date",value:Te,min:new Date().toISOString().split("T")[0],onChange:Ee=>pe(Ee.target.value),className:"w-full px-3 py-2.5 bg-slate-900/50 border border-slate-700 rounded-xl text-white text-sm focus:outline-none focus:ring-2 focus:ring-indigo-500/50"})]})]}),y.jsx("button",{onClick:je,disabled:qe,className:"w-full px-4 py-3 bg-indigo-600 text-white rounded-xl hover:bg-indigo-500 transition-colors font-medium shadow-lg shadow-indigo-500/20 flex items-center justify-center",children:qe?"Generating...":"Generate Invite Link"})]}),(m==="identity"||ue)&&De&&y.jsxs("div",{className:"space-y-6 animate-fade-in",children:[y.jsx("div",{className:"flex justify-center",children:y.jsx("div",{className:"bg-white p-4 rounded-xl",children:y.jsx(Um,{value:De,size:200,level:"H",includeMargin:!0})})}),y.jsx("p",{className:"text-center text-sm text-slate-400",children:m==="identity"?"Share this QR code to let others add you directly.":"Share this invite QR code."}),y.jsxs("div",{className:"space-y-3",children:[y.jsx("button",{onClick:()=>Ce(De,Re),className:`w-full px-4 py-3 rounded-xl transition-all font-medium flex items-center justify-center ${se==="copied"?"bg-emerald-600 text-white":se==="error"?"bg-red-600 text-white":"bg-slate-700 text-white hover:bg-slate-600"}`,children:se==="copied"?"Copied Link!":"Copy Link"}),"share"in navigator&&y.jsx("button",{onClick:()=>Le(De,"Add Contact","Scan to add"),className:"w-full px-4 py-3 bg-indigo-600 text-white rounded-xl hover:bg-indigo-500 transition-colors font-medium shadow-lg shadow-indigo-500/20 flex items-center justify-center",children:"Share via..."}),m==="invite"&&y.jsx("button",{onClick:()=>{xt(null),ke("")},className:"w-full px-4 py-3 bg-slate-800 text-slate-300 rounded-xl hover:bg-slate-700 transition-colors font-medium",children:"Create Another Invite"})]})]})]}),s==="scan"&&y.jsxs("div",{className:"space-y-6",children:[y.jsxs("div",{className:"border-2 border-dashed border-slate-700 rounded-xl p-8 hover:border-indigo-500/50 transition-colors group",children:[y.jsx("input",{type:"file",accept:"image/*",capture:"environment",onChange:Ye,className:"hidden",id:"qr-scan-input"}),y.jsxs("label",{htmlFor:"qr-scan-input",className:"flex flex-col items-center cursor-pointer",children:[y.jsx("div",{className:"w-16 h-16 bg-slate-800 rounded-full flex items-center justify-center mb-4 group-hover:bg-slate-700 transition-colors",children:y.jsxs("svg",{className:"w-8 h-8 text-indigo-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 9a2 2 0 012-2h.93a2 2 0 001.664-.89l.812-1.22A2 2 0 0110.07 4h3.86a2 2 0 011.664.89l.812 1.22A2 2 0 0018.07 7H19a2 2 0 012 2v9a2 2 0 01-2 2H5a2 2 0 01-2-2V9z"}),y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 13a3 3 0 11-6 0 3 3 0 016 0z"})]})}),y.jsx("span",{className:"text-base font-medium text-slate-200 mb-1",children:"Scan QR Code"}),y.jsx("span",{className:"text-sm text-slate-500",children:"Click to take a photo or select an image"})]})]}),y.jsx("p",{className:"text-sm text-slate-400 text-center",children:"Scan a contact's Identity QR or an Invite QR."})]}),s==="manual"&&y.jsxs("div",{className:"space-y-6",children:[y.jsxs("div",{children:[y.jsx("label",{htmlFor:"manual-input",className:"block text-xs font-medium text-slate-400 uppercase tracking-wider mb-2",children:"Paste Link"}),y.jsx("textarea",{id:"manual-input",value:w,onChange:Ee=>x(Ee.target.value),placeholder:"adun-app://...",rows:4,className:"w-full px-4 py-3 bg-slate-900/50 border border-slate-700 rounded-xl focus:outline-none focus:ring-2 focus:ring-indigo-500/50 focus:border-indigo-500/50 font-mono text-xs text-slate-300 placeholder-slate-600 resize-none"}),y.jsxs("p",{className:"mt-2 text-xs text-amber-500/80 flex items-start",children:[y.jsx("svg",{className:"w-4 h-4 mr-1.5 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),"Paste the full link starting with adun-app://"]})]}),y.jsx("button",{onClick:de,className:"w-full px-4 py-3 bg-indigo-600 text-white rounded-xl hover:bg-indigo-500 transition-colors font-medium shadow-lg shadow-indigo-500/20",children:"Add Contact"})]})]}),y.jsx("div",{className:"px-6 pb-6",children:y.jsx("button",{onClick:u,className:"w-full px-4 py-3 bg-slate-800 text-slate-300 rounded-xl hover:bg-slate-700 transition-colors font-medium",children:"Close"})})]})})}function $v(){try{const u=$n.getActiveSignalingServices();return{status:u.length>0?"connected":"disconnected",services:u}}catch{return{status:"disconnected",services:[]}}}function Xv(){const u=yt.useMemo(()=>$v(),[]),[r,i]=yt.useState(u.status),[s,c]=yt.useState(u.services);return yt.useEffect(()=>{const _=setInterval(()=>{try{const w=$n.getActiveSignalingServices();c(w),w.length>0?i("connected"):i("disconnected")}catch{i("disconnected"),c([])}},3e3);return()=>clearInterval(_)},[]),{status:r,services:s}}function Fv({status:u,onRetry:r}){return u==="offline"?null:u==="handshake"?y.jsxs("div",{className:"flex items-center space-x-1",title:"Connecting...",children:[y.jsx("div",{className:"w-2.5 h-2.5 bg-yellow-500 rounded-full animate-pulse"}),y.jsx("span",{className:"text-xs text-yellow-500",children:"Connecting"})]}):u==="online"?y.jsxs("div",{className:"flex items-center space-x-1",title:"Online",children:[y.jsx("div",{className:"w-2.5 h-2.5 bg-green-500 rounded-full shadow-[0_0_8px_rgba(34,197,94,0.6)]"}),y.jsx("span",{className:"text-xs text-green-500",children:"Online"})]}):u==="failed"?y.jsxs("div",{className:"flex items-center space-x-2",title:"Connection failed",children:[y.jsxs("div",{className:"flex items-center space-x-1",children:[y.jsx("div",{className:"w-2.5 h-2.5 bg-red-500 rounded-full"}),y.jsx("span",{className:"text-xs text-red-500",children:"Failed"})]}),r&&y.jsx("button",{onClick:i=>{i.stopPropagation(),r()},className:"px-2 py-0.5 bg-red-500/10 hover:bg-red-500/20 text-red-500 text-xs rounded transition-colors",children:"Retry"})]}):null}function Zv(u){return u.status==="online"?y.jsx("div",{className:"absolute bottom-0 right-0 w-3.5 h-3.5 bg-emerald-500 border-2 border-[var(--color-bg-card)] rounded-full"}):u.status==="handshake"?y.jsx("div",{className:"absolute bottom-0 right-0 w-3.5 h-3.5 bg-yellow-500 border-2 border-[var(--color-bg-card)] rounded-full animate-pulse"}):u.status==="failed"?y.jsx("div",{className:"absolute bottom-0 right-0 w-3.5 h-3.5 border-2 border-[var(--color-bg-card)] rounded-full bg-red-500 flex items-center justify-center",children:y.jsx("svg",{className:"w-2 h-2 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3,d:"M6 18L18 6M6 6l12 12"})})}):null}function Jv(){const{identity:u,activeView:r,activeContactId:i,setActiveView:s,setActiveContact:c,miniChatVisibility:m}=wi(),{contacts:_,retryHandshake:w}=br(),{messages:x}=Vs(),[S,E]=yt.useState(!1),{status:R,services:N}=Xv(),q=ke=>{c(ke),s("chat")},ie=ke=>{w(ke)},se=(ke,we)=>{if(!u)return[];const $e=[u.userId,ke].sort().join("-");return(x[$e]||[]).slice(-3)},Re=ke=>0,lt=ke=>{const we=ke.localProfile?.name,$e=ke.peerProfile?.name,Je=!we&&!!$e;return{displayName:we||$e||`User ${ke.userId.slice(0,8).toUpperCase()}`,isPeerProvided:Je}};return y.jsxs("div",{className:"h-screen flex flex-col bg-[var(--color-bg-dark)] text-[var(--color-text-primary)] animate-fade-in",children:[y.jsx("div",{className:"bg-[var(--color-bg-card)]/80 backdrop-blur-md border-b border-slate-700/50 px-6 py-5 sticky top-0 z-10",children:y.jsxs("div",{className:"flex items-center justify-between max-w-3xl mx-auto w-full",children:[y.jsxs("div",{children:[y.jsx("h1",{className:"text-2xl font-bold bg-gradient-to-r from-indigo-400 to-purple-400 bg-clip-text text-transparent",children:"Messages"}),y.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[y.jsxs("p",{className:"text-xs text-slate-400 font-mono opacity-70",children:["ID: ",u?.userId.slice(0,8).toUpperCase()]}),y.jsxs("div",{className:"flex items-center gap-1.5",title:`Signaling: ${N.join(", ")||"None"}`,children:[y.jsx("div",{className:`w-1.5 h-1.5 rounded-full ${R==="connected"?"bg-emerald-500":R==="connecting"?"bg-yellow-500 animate-pulse":"bg-red-500"}`}),y.jsx("span",{className:`text-[10px] font-medium uppercase tracking-wider ${R==="connected"?"text-emerald-400":R==="connecting"?"text-yellow-400":"text-red-400"}`,children:R==="connected"?N.join(", ")||"Connected":R==="connecting"?"Connecting":"Offline"})]})]})]}),y.jsxs("div",{className:"flex space-x-3",children:[y.jsx("button",{onClick:()=>E(!0),className:"p-2.5 bg-indigo-600 hover:bg-indigo-500 text-white rounded-full transition-all shadow-lg shadow-indigo-500/20 hover:shadow-indigo-500/40 active:scale-95",title:"Add contact",children:y.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2.5,d:"M12 4v16m8-8H4"})})}),y.jsx("button",{onClick:()=>s("settings"),className:"p-2.5 bg-slate-700/50 hover:bg-slate-700 text-slate-200 rounded-full transition-all hover:text-white active:scale-95",title:"Settings",children:y.jsxs("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"}),y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})]})})]})]})}),y.jsx("div",{className:"flex-1 overflow-y-auto px-4 py-4",children:y.jsx("div",{className:"max-w-3xl mx-auto w-full space-y-2",children:_.length===0?y.jsxs("div",{className:"flex flex-col items-center justify-center h-[60vh] text-center",children:[y.jsx("div",{className:"w-20 h-20 bg-slate-800/50 rounded-2xl flex items-center justify-center mb-6 border border-slate-700/50",children:y.jsx("svg",{className:"w-10 h-10 text-slate-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})})}),y.jsx("h3",{className:"text-xl font-semibold text-slate-200 mb-2",children:"No contacts yet"}),y.jsx("p",{className:"text-slate-400 mb-8 max-w-xs mx-auto leading-relaxed",children:"Connect with friends by scanning their QR code or sharing your link."}),y.jsx("button",{onClick:()=>E(!0),className:"px-8 py-3 bg-indigo-600 text-white rounded-xl hover:bg-indigo-500 transition-all font-medium shadow-lg shadow-indigo-500/25 hover:shadow-indigo-500/40 active:scale-95",children:"Add New Contact"})]}):y.jsx("div",{className:"grid gap-2",children:_.map(ke=>{const we=se(ke.userId),$e=Re(ke.userId),{displayName:Je,isPeerProvided:ft}=lt(ke),et=ke.localProfile?.group;return y.jsxs("div",{onClick:()=>q(ke.userId),className:"w-full p-4 flex items-start space-x-4 bg-[var(--color-bg-card)] hover:bg-slate-700/50 rounded-2xl transition-all border border-transparent hover:border-slate-600/50 group cursor-pointer",children:[y.jsxs("div",{className:"relative flex-shrink-0",children:[y.jsx("div",{className:"w-14 h-14 bg-gradient-to-br from-indigo-500 to-purple-600 rounded-full flex items-center justify-center shadow-lg shadow-indigo-500/10 group-hover:scale-105 transition-transform duration-300",children:y.jsx("span",{className:"text-white font-bold text-lg",children:Je?.[0]?.toUpperCase()||ke.userId.slice(0,2).toUpperCase()})}),Zv(ke)]}),y.jsxs("div",{className:"flex-1 min-w-0 text-left",children:[y.jsxs("div",{className:"flex items-center justify-between mb-3",children:[y.jsx("h3",{className:`text-lg truncate pr-4 ${ft?"text-slate-300 italic":"text-white font-semibold"}`,children:Je}),$e>0]}),y.jsxs("div",{className:"flex items-start",children:[y.jsx("div",{className:"flex-shrink-0 w-[120px] mr-4 pt-0.5",children:et?y.jsx("p",{className:"text-sm text-indigo-400 font-medium truncate",children:et}):y.jsx(Fv,{status:ke.status,onRetry:()=>ie(ke.userId)})}),y.jsx("div",{className:`flex-1 min-w-0 space-y-1 p-2 bg-slate-800/40 rounded-lg border border-slate-700/30 ${m==="never"?"hidden":m==="always"?"md:hidden lg:block":i===ke.userId&&r==="chat"?"hidden":"md:hidden lg:block"}`,children:we.length>0?we.map(qt=>{const en=qt.from===u?.userId;return y.jsxs("p",{className:"text-xs text-slate-400 truncate leading-tight flex items-center",children:[y.jsx("span",{className:`mr-1 font-bold flex-shrink-0 ${en?"text-indigo-300":"text-slate-500"}`,children:en?"You:":"Them:"}),y.jsx("span",{className:"truncate opacity-90",children:qt.content})]},qt.msg_uuid)}):y.jsx("p",{className:"text-xs text-slate-600 italic text-center py-1",children:"No messages yet"})})]})]})]},ke.userId)})})})}),S&&y.jsx(Qv,{onClose:()=>E(!1)})]})}const Wv=()=>Lm(),_c=u=>({id:u.msg_uuid,timestamp:u.timestamp,type:"text",content:u.content}),e1=(u,r)=>({id:u,timestamp:r,type:"ack"}),t1=(u,r,i)=>{if(u.type==="ack")throw new Error("Cannot convert ACK to Message - ACKs are not stored");return{msg_uuid:u.id,conversationId:i,from:r,content:u.content||"",timestamp:u.timestamp,delivered:!0,firstAttemptTimestamp:u.timestamp,showAsFailedInUI:!1,type:"text"}};class n1{userId;queues=new Map;lastActivity=new Map;minNextTime=0;timerId=null;unsubscribe=null;config;onTimeout=null;constructor(r,i){this.userId=r,this.config=i,this.unsubscribe=$n.onPeerOnline((s,c)=>{console.log("[RetryService] onPeerOnline callback:",s.substring(0,8),"online:",c),c?this.loadUndeliveredForPeer(s):(this.clearQueue(s),this.lastActivity.delete(s))}),this.startTimer(),console.log("[RetryService] Initialized for user:",r.substring(0,8))}startTimer(){this.timerId||(this.timerId=setInterval(()=>this.timerTick(),this.config.timerInterval),console.log("[RetryService] Timer started"))}stopTimer(){this.timerId&&(clearInterval(this.timerId),this.timerId=null,console.log("[RetryService] Timer stopped"))}async timerTick(){const r=Date.now();for(const[i,s]of this.queues){for(;s.length>0&&r-s[0].firstAttemptTimestamp>=this.config.timeoutMs;){const m=s.shift();console.log("[RetryService] Message timed out:",m.msg_uuid.substring(0,8)),m.msg_id!==void 0&&this.onTimeout?.(m.msg_id)}if(s.length===0){this.queues.delete(i);continue}if(r<this.minNextTime)continue;const c=this.lastActivity.get(i)||0;if(r-c>=this.config.minPeerInterval){this.lastActivity.set(i,r),this.minNextTime=r+this.config.minPeerInterval;const m=s[0];try{console.log("[RetryService] Timer sending:",m.msg_uuid.substring(0,8),"to:",i.substring(0,8)),await $n.sendMessage(i,_c(m)),console.log("[RetryService] Timer  sent:",m.msg_uuid.substring(0,8))}catch(_){console.error("[RetryService] Timer  failed:",m.msg_uuid.substring(0,8),_)}return}}}setOnTimeout(r){this.onTimeout=r}async loadUndeliveredForPeer(r){console.log("[RetryService] loadUndeliveredForPeer called for:",r.substring(0,8)),console.log("[RetryService] My userId:",this.userId.substring(0,8));const i=[this.userId,r].sort().join("-");console.log("[RetryService] Looking up conversationId:",i.substring(0,24));const s=await Tn.getMessages(i);console.log("[RetryService] Found",s.length,"total messages in conversation");const c=s.filter(w=>!w.delivered&&w.from===this.userId);if(console.log("[RetryService] Loading",c.length,"undelivered messages for:",r.substring(0,8)),c.length===0)return;const m=Date.now(),_=c.map(w=>({...w,firstAttemptTimestamp:m}));this.queues.set(r,_),this.lastActivity.set(r,0)}addToQueue(r,i){const s=this.queues.get(r)||[];if(s.some(c=>c.msg_uuid===i.msg_uuid)){console.log(`[RetryService] Message ${i.msg_uuid.substring(0,8)} already in queue, skipping`);return}s.push(i),this.queues.set(r,s),console.log(`[RetryService] Added ${i.msg_uuid.substring(0,8)} to queue (size: ${s.length})`)}removeFromQueue(r,i){const s=this.queues.get(r);if(!s)return;const c=s.findIndex(m=>m.msg_uuid===i);c>-1&&(s.splice(c,1),console.log(`[RetryService] Removed ${i.substring(0,8)} from queue (size: ${s.length})`)),s.length===0&&this.queues.delete(r)}async sendNextForPeer(r){const i=this.queues.get(r);if(!i||i.length===0)return;const s=Date.now();this.lastActivity.set(r,s),this.minNextTime=s+this.config.minPeerInterval;const c=i[0];try{console.log("[RetryService] Sending next:",c.msg_uuid.substring(0,8)),await $n.sendMessage(r,_c(c)),console.log("[RetryService]  Sent:",c.msg_uuid.substring(0,8))}catch(m){console.error("[RetryService]  Failed to send next:",c.msg_uuid.substring(0,8),m)}}getQueue(r){return this.queues.get(r)||[]}clearQueue(r){this.queues.has(r)&&(this.queues.delete(r),console.log(`[RetryService] Cleared queue for ${r.substring(0,8)}`))}destroy(){this.stopTimer(),this.unsubscribe&&(this.unsubscribe(),this.unsubscribe=null),this.queues.clear(),this.lastActivity.clear(),console.log("[RetryService] Destroyed")}}let la=null;const r1=(u,r)=>(la&&la.destroy(),la=new n1(u,r),la),a1=u=>{la?.setOnTimeout(u)},Hm=()=>{la&&(la.destroy(),la=null)},qf=(u,r)=>{la?.addToQueue(u,r)},Im=(u,r)=>{la?.removeFromQueue(u,r)},Km=u=>{la?.sendNextForPeer(u)},i1=Object.freeze(Object.defineProperty({__proto__:null,addToRetryQueue:qf,destroyRetryService:Hm,initRetryService:r1,removeFromRetryQueue:Im,sendNextMessage:Km,setRetryTimeoutCallback:a1},Symbol.toStringTag,{value:"Module"}));function s1(){const{identity:u,setActiveView:r,clearIdentity:i,updateProfile:s,miniChatVisibility:c,setMiniChatVisibility:m}=wi(),{contacts:_}=br(),[w,x]=yt.useState(!1),[S,E]=yt.useState(!1),[R,N]=yt.useState(!1),[q,ie]=yt.useState(!1),[se,Re]=yt.useState(""),[lt,ke]=yt.useState(null),[we,$e]=yt.useState(!1),Je=yt.useRef(null),[ft,et]=yt.useState(u?.profile?.name||""),[qt,en]=yt.useState(u?.profile?.description||""),[Oe,Te]=yt.useState(!1),[pe,ue]=yt.useState(!1),[xt,qe]=yt.useState([]),[J,Me]=yt.useState(!1);yt.useEffect(()=>{Ge()},[]);const Ge=async()=>{Me(!0);try{const ct=await Vo.getInvites();qe(ct.sort((pn,Ht)=>Ht.createdAt-pn.createdAt))}catch(ct){console.error("Failed to load invites",ct)}finally{Me(!1)}},je=async ct=>{try{await Vo.revokeInvite(ct),await Ge()}catch(pn){console.error("Failed to revoke invite",pn)}},Ye=async ct=>{try{await Vo.deleteInvite(ct),await Ge()}catch(pn){console.error("Failed to delete invite",pn)}},L=async()=>{if(u){Te(!0);try{const ct={...u.profile,name:ft,description:qt};s(ct);const pn={...u,profile:ct};Xi.save(pn),ue(!0),setTimeout(()=>ue(!1),2e3)}catch(ct){console.error("Failed to save profile",ct)}finally{Te(!1)}}},de=async()=>{if(u){if(!se){ke("Password is required to encrypt your identity");return}try{const ct={version:1,encrypted:!0,data:Xi.exportToJSON(u),passwordHint:"Password protected"},pn=JSON.stringify(ct,null,2),Ht=new Blob([pn],{type:"application/json"}),er=URL.createObjectURL(Ht),kn=document.createElement("a");kn.href=er,kn.download=`chat-identity-${u.userId.slice(0,8)}.json`,document.body.appendChild(kn),kn.click(),document.body.removeChild(kn),URL.revokeObjectURL(er),x(!1),Re(""),ke(null)}catch(ct){ke("Failed to export identity"),console.error(ct)}}},Ce=()=>{const ct={version:1,type:"contacts",timestamp:Date.now(),contacts:_.map(Xn=>({userId:Xn.userId,publicKey:Xn.publicKey,displayName:Xn.displayName,addedAt:Xn.addedAt}))},pn=JSON.stringify(ct,null,2),Ht=new Blob([pn],{type:"application/json"}),er=URL.createObjectURL(Ht),kn=document.createElement("a");kn.href=er,kn.download=`chat-contacts-${Date.now()}.json`,document.body.appendChild(kn),kn.click(),document.body.removeChild(kn),URL.revokeObjectURL(er)},Le=()=>{u&&(navigator.clipboard.writeText(u.userId),N(!0),setTimeout(()=>N(!1),2e3))},De=()=>{Hm(),$n.destroyAll(),Xi.delete(),i(),r("setup")},Ee=ct=>{const pn=document.getElementById(ct);pn&&pn.scrollIntoView({behavior:"smooth"})},dt=()=>{if(Je.current){const{scrollTop:ct}=Je.current;$e(ct>200)}},kt=()=>{Je.current&&Je.current.scrollTo({top:0,behavior:"smooth"})};if(!u)return null;const ze=()=>y.jsxs("nav",{className:"space-y-1",children:[y.jsxs("button",{onClick:()=>Ee("public-profile"),className:"w-full flex items-center px-3 py-2 text-sm font-medium text-slate-300 rounded-lg hover:bg-slate-800 hover:text-white transition-colors group",children:[y.jsx("svg",{className:"w-5 h-5 mr-3 text-indigo-400 group-hover:text-indigo-300",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})}),"Public Profile"]}),y.jsxs("button",{onClick:()=>Ee("identity"),className:"w-full flex items-center px-3 py-2 text-sm font-medium text-slate-300 rounded-lg hover:bg-slate-800 hover:text-white transition-colors group",children:[y.jsx("svg",{className:"w-5 h-5 mr-3 text-indigo-400 group-hover:text-indigo-300",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 6H5a2 2 0 00-2 2v9a2 2 0 002 2h14a2 2 0 002-2V8a2 2 0 00-2-2h-5m-4 0V5a2 2 0 114 0v1m-4 0c0 .884-.956 1.676-2 2.5-1.044-.824-2-1.616-2-2.5s.956-1.676 2-2.5c1.044.824 2 1.616 2 2.5z"})}),"Identity"]}),y.jsxs("button",{onClick:()=>Ee("invites"),className:"w-full flex items-center px-3 py-2 text-sm font-medium text-slate-300 rounded-lg hover:bg-slate-800 hover:text-white transition-colors group",children:[y.jsx("svg",{className:"w-5 h-5 mr-3 text-indigo-400 group-hover:text-indigo-300",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 5v2m0 4v2m0 4v2M5 5a2 2 0 00-2 2v3a2 2 0 110 4v3a2 2 0 002 2h14a2 2 0 002-2v-3a2 2 0 110-4V7a2 2 0 00-2-2H5z"})}),"Invites"]}),y.jsxs("button",{onClick:()=>Ee("features"),className:"w-full flex items-center px-3 py-2 text-sm font-medium text-slate-300 rounded-lg hover:bg-slate-800 hover:text-white transition-colors group",children:[y.jsx("svg",{className:"w-5 h-5 mr-3 text-indigo-400 group-hover:text-indigo-300",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19.428 15.428a2 2 0 00-1.022-.547l-2.387-.477a6 6 0 00-3.86.517l-.318.158a6 6 0 01-3.86.517L6.05 15.21a2 2 0 00-1.806.547M8 4h8l-1 1v5.172a2 2 0 00.586 1.414l5 5c1.26 1.26.367 3.414-1.415 3.414H4.828c-1.782 0-2.674-2.154-1.414-3.414l5-5A2 2 0 009 10.172V5L8 4z"})}),"Features"]}),y.jsxs("button",{onClick:()=>Ee("danger-zone"),className:"w-full flex items-center px-3 py-2 text-sm font-medium text-red-400 rounded-lg hover:bg-red-500/10 transition-colors group",children:[y.jsx("svg",{className:"w-5 h-5 mr-3 text-red-500 group-hover:text-red-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),"Danger Zone"]})]});return y.jsxs("div",{className:"h-screen flex flex-col bg-[var(--color-bg-dark)] text-slate-200",children:[y.jsx("div",{className:"bg-[var(--color-bg-card)] border-b border-slate-700/50 px-4 py-4 shadow-sm z-10 flex-shrink-0",children:y.jsxs("div",{className:"flex items-center space-x-3",children:[y.jsxs("button",{onClick:()=>r("contacts"),"aria-label":"Back to contacts",className:"flex items-center px-3 py-2 -ml-2 text-slate-400 hover:text-white hover:bg-slate-800 rounded-lg transition-colors",children:[y.jsx("svg",{className:"w-5 h-5 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})}),y.jsx("span",{className:"font-medium",children:"Back"})]}),y.jsx("h1",{className:"text-xl font-bold text-white",children:"Settings"})]})}),y.jsxs("div",{className:"flex-1 flex flex-col md:flex-row overflow-hidden",children:[y.jsx("div",{className:"hidden md:block w-64 bg-[var(--color-bg-card)] border-r border-slate-700/50 p-4 overflow-y-auto flex-shrink-0",children:y.jsx(ze,{})}),y.jsxs("div",{ref:Je,onScroll:dt,className:"flex-1 overflow-y-auto p-4 md:p-8 scroll-smooth relative",children:[y.jsxs("div",{className:"md:hidden mb-8 bg-[var(--color-bg-card)]/50 rounded-2xl border border-slate-700/50 p-4",children:[y.jsx("h3",{className:"text-xs font-bold text-slate-400 uppercase tracking-wider mb-3",children:"Table of Contents"}),y.jsx(ze,{})]}),y.jsxs("div",{className:"max-w-2xl mx-auto space-y-8 pb-20",children:[y.jsxs("section",{id:"public-profile",className:"bg-[var(--color-bg-card)] rounded-2xl border border-slate-700/50 p-6 shadow-xl scroll-mt-6",children:[y.jsxs("h2",{className:"text-lg font-bold text-white mb-6 flex items-center",children:[y.jsx("svg",{className:"w-5 h-5 mr-2 text-indigo-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})}),"Public Profile"]}),y.jsxs("div",{className:"space-y-4",children:[y.jsxs("div",{children:[y.jsx("label",{className:"block text-xs font-medium text-slate-400 uppercase tracking-wider mb-2",children:"Display Name"}),y.jsx("input",{type:"text",value:ft,onChange:ct=>et(ct.target.value),placeholder:"Your Name",className:"w-full px-4 py-3 bg-slate-900/50 border border-slate-700 rounded-xl text-white placeholder-slate-500 focus:outline-none focus:ring-2 focus:ring-indigo-500/50 transition-all"})]}),y.jsxs("div",{children:[y.jsx("label",{className:"block text-xs font-medium text-slate-400 uppercase tracking-wider mb-2",children:"Description"}),y.jsx("textarea",{value:qt,onChange:ct=>en(ct.target.value),placeholder:"Tell others about yourself...",rows:3,className:"w-full px-4 py-3 bg-slate-900/50 border border-slate-700 rounded-xl text-white placeholder-slate-500 focus:outline-none focus:ring-2 focus:ring-indigo-500/50 transition-all resize-none"})]}),y.jsx("div",{className:"pt-2 flex justify-end",children:y.jsx("button",{onClick:L,disabled:Oe,className:`px-6 py-2.5 rounded-xl font-medium transition-all flex items-center ${pe?"bg-green-500/20 text-green-400 border border-green-500/50":"bg-indigo-600 text-white hover:bg-indigo-500 shadow-lg shadow-indigo-500/20"}`,children:Oe?y.jsxs(y.Fragment,{children:[y.jsx("svg",{className:"w-4 h-4 mr-2 animate-spin",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),"Saving..."]}):pe?y.jsxs(y.Fragment,{children:[y.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),"Saved!"]}):"Save Profile"})})]})]}),y.jsxs("section",{id:"identity",className:"bg-[var(--color-bg-card)] rounded-2xl border border-slate-700/50 p-6 shadow-xl scroll-mt-6",children:[y.jsxs("div",{className:"flex items-center justify-between mb-6",children:[y.jsxs("h2",{className:"text-lg font-bold text-white flex items-center",children:[y.jsx("svg",{className:"w-5 h-5 mr-2 text-indigo-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 6H5a2 2 0 00-2 2v9a2 2 0 002 2h14a2 2 0 002-2V8a2 2 0 00-2-2h-5m-4 0V5a2 2 0 114 0v1m-4 0c0 .884-.956 1.676-2 2.5-1.044-.824-2-1.616-2-2.5s.956-1.676 2-2.5c1.044.824 2 1.616 2 2.5z"})}),"Identity"]}),y.jsx("button",{onClick:()=>ie(!q),className:"text-xs font-medium text-indigo-400 hover:text-indigo-300 transition-colors",children:q?"Hide Keys":"Show Keys"})]}),y.jsxs("div",{className:"space-y-5",children:[y.jsxs("div",{children:[y.jsx("label",{className:"block text-xs font-medium text-slate-400 uppercase tracking-wider mb-2",children:"User ID"}),y.jsxs("div",{className:"flex items-center space-x-2",children:[y.jsx("input",{type:"text",value:u.userId,readOnly:!0,className:"flex-1 px-3 py-2.5 bg-slate-900/50 border border-slate-700 rounded-xl font-mono text-sm text-slate-300 focus:outline-none"}),y.jsx("button",{onClick:Le,className:"px-4 py-2.5 bg-slate-700 hover:bg-slate-600 text-white rounded-xl transition-colors font-medium",children:R?"Copied!":"Copy"})]})]}),q&&y.jsx("div",{className:"space-y-4 pt-4 border-t border-slate-700/50 animate-fade-in",children:y.jsxs("div",{children:[y.jsx("label",{className:"block text-xs font-medium text-slate-400 uppercase tracking-wider mb-2",children:"Public Key (Signing)"}),y.jsx("input",{type:"text",value:u.publicKey,readOnly:!0,className:"w-full px-3 py-2 bg-slate-900/50 border border-slate-700 rounded-xl font-mono text-xs text-slate-400"})]})})]}),y.jsx("div",{className:"mt-6 pt-6 border-t border-slate-700/50",children:y.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[y.jsxs("button",{onClick:()=>x(!0),className:"px-2 py-3 bg-slate-800 text-slate-200 rounded-xl hover:bg-slate-700 transition-colors font-medium flex flex-col items-center justify-center text-center text-xs sm:text-sm",children:[y.jsx("svg",{className:"w-5 h-5 mb-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"})}),"Export Identity"]}),y.jsxs("button",{onClick:Ce,className:"px-2 py-3 bg-slate-800 text-slate-200 rounded-xl hover:bg-slate-700 transition-colors font-medium flex flex-col items-center justify-center text-center text-xs sm:text-sm",children:[y.jsx("svg",{className:"w-5 h-5 mb-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})}),"Export Contacts"]}),y.jsxs("button",{disabled:!0,className:"px-2 py-3 bg-slate-800/50 text-slate-500 rounded-xl cursor-not-allowed font-medium flex flex-col items-center justify-center border border-slate-700/30 text-center text-xs sm:text-sm",children:[y.jsx("svg",{className:"w-5 h-5 mb-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 10h.01M12 10h.01M16 10h.01M9 16H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-5l-5 5v-5z"})}),"Export Messages"]})]})})]}),y.jsxs("section",{id:"invites",className:"bg-[var(--color-bg-card)] rounded-2xl border border-slate-700/50 p-6 shadow-xl scroll-mt-6",children:[y.jsxs("h2",{className:"text-lg font-bold text-white mb-6 flex items-center",children:[y.jsx("svg",{className:"w-5 h-5 mr-2 text-indigo-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 5v2m0 4v2m0 4v2M5 5a2 2 0 00-2 2v3a2 2 0 110 4v3a2 2 0 002 2h14a2 2 0 002-2v-3a2 2 0 110-4V7a2 2 0 00-2-2H5z"})}),"Active Invites"]}),J?y.jsx("div",{className:"text-center py-4 text-slate-400",children:"Loading invites..."}):xt.length===0?y.jsxs("div",{className:"text-center py-8 bg-slate-800/30 rounded-xl border border-slate-700/30",children:[y.jsx("p",{className:"text-slate-400 text-sm",children:"No active invites found."}),y.jsx("p",{className:"text-slate-500 text-xs mt-1",children:'Create invites from the "Add Contact" screen.'})]}):y.jsx("div",{className:"space-y-3",children:xt.map(ct=>y.jsxs("div",{className:"bg-slate-800/50 border border-slate-700/50 rounded-xl p-4 flex items-center justify-between group hover:border-indigo-500/30 transition-colors",children:[y.jsxs("div",{className:"min-w-0 flex-1 mr-4",children:[y.jsxs("div",{className:"flex items-center space-x-2 mb-1",children:[y.jsx("h3",{className:"text-white font-medium truncate",children:ct.name||"Unnamed Invite"}),y.jsx("span",{className:`px-2 py-0.5 rounded text-[10px] font-bold uppercase ${ct.valid?"bg-emerald-500/20 text-emerald-400":"bg-red-500/20 text-red-400"}`,children:ct.valid?"Active":"Revoked"})]}),y.jsxs("div",{className:"text-xs text-slate-400 flex items-center space-x-3",children:[y.jsxs("span",{children:["Uses: ",ct.useCount," / ",ct.useLimit===void 0?"":ct.useLimit]}),y.jsxs("span",{children:["Created: ",new Date(ct.createdAt).toLocaleDateString()]}),ct.expiry&&y.jsxs("span",{className:Date.now()>ct.expiry?"text-red-400":"",children:["Expires: ",new Date(ct.expiry).toLocaleDateString()]})]})]}),y.jsx("div",{className:"flex items-center space-x-2",children:ct.valid?y.jsx("button",{onClick:()=>je(ct.inviteId),className:"p-2 text-slate-400 hover:text-red-400 hover:bg-red-500/10 rounded-lg transition-colors",title:"Revoke Invite",children:y.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M18.364 18.364A9 9 0 005.636 5.636m12.728 12.728A9 9 0 015.636 5.636m12.728 12.728L5.636 5.636"})})}):y.jsx("button",{onClick:()=>Ye(ct.inviteId),className:"p-2 text-slate-400 hover:text-red-400 hover:bg-red-500/10 rounded-lg transition-colors",title:"Delete Invite",children:y.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})})]},ct.inviteId))})]}),y.jsxs("section",{id:"features",className:"bg-[var(--color-bg-card)] rounded-2xl border border-slate-700/50 p-6 shadow-xl scroll-mt-6",children:[y.jsxs("h2",{className:"text-lg font-bold text-white mb-6 flex items-center",children:[y.jsx("svg",{className:"w-5 h-5 mr-2 text-indigo-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19.428 15.428a2 2 0 00-1.022-.547l-2.387-.477a6 6 0 00-3.86.517l-.318.158a6 6 0 01-3.86.517L6.05 15.21a2 2 0 00-1.806.547M8 4h8l-1 1v5.172a2 2 0 00.586 1.414l5 5c1.26 1.26.367 3.414-1.415 3.414H4.828c-1.782 0-2.674-2.154-1.414-3.414l5-5A2 2 0 009 10.172V5L8 4z"})}),"Features"]}),y.jsx("div",{className:"space-y-6",children:y.jsxs("div",{children:[y.jsx("label",{className:"block text-sm font-medium text-white mb-3",children:"Mini-chats visible"}),y.jsxs("div",{className:"space-y-3",children:[y.jsxs("label",{className:"flex items-center space-x-3 cursor-pointer group",children:[y.jsx("div",{className:`w-5 h-5 rounded-full border flex items-center justify-center transition-colors ${c==="never"?"border-indigo-500 bg-indigo-500":"border-slate-600 bg-slate-800 group-hover:border-slate-500"}`,children:c==="never"&&y.jsx("div",{className:"w-2.5 h-2.5 bg-white rounded-full"})}),y.jsx("input",{type:"radio",name:"miniChatVisibility",value:"never",checked:c==="never",onChange:ct=>m(ct.target.value),className:"hidden"}),y.jsxs("span",{className:"text-slate-300 group-hover:text-white transition-colors",children:["Never ",y.jsx("span",{className:"text-slate-500 text-sm ml-1",children:"(minichats are never shown)"})]})]}),y.jsxs("label",{className:"flex items-center space-x-3 cursor-pointer group",children:[y.jsx("div",{className:`w-5 h-5 rounded-full border flex items-center justify-center transition-colors ${c==="contacts"?"border-indigo-500 bg-indigo-500":"border-slate-600 bg-slate-800 group-hover:border-slate-500"}`,children:c==="contacts"&&y.jsx("div",{className:"w-2.5 h-2.5 bg-white rounded-full"})}),y.jsx("input",{type:"radio",name:"miniChatVisibility",value:"contacts",checked:c==="contacts",onChange:ct=>m(ct.target.value),className:"hidden"}),y.jsxs("span",{className:"text-slate-300 group-hover:text-white transition-colors",children:["Contacts ",y.jsx("span",{className:"text-slate-500 text-sm ml-1",children:"(shown when space available and chat closed)"})]})]}),y.jsxs("label",{className:"flex items-center space-x-3 cursor-pointer group",children:[y.jsx("div",{className:`w-5 h-5 rounded-full border flex items-center justify-center transition-colors ${c==="always"?"border-indigo-500 bg-indigo-500":"border-slate-600 bg-slate-800 group-hover:border-slate-500"}`,children:c==="always"&&y.jsx("div",{className:"w-2.5 h-2.5 bg-white rounded-full"})}),y.jsx("input",{type:"radio",name:"miniChatVisibility",value:"always",checked:c==="always",onChange:ct=>m(ct.target.value),className:"hidden"}),y.jsxs("span",{className:"text-slate-300 group-hover:text-white transition-colors",children:["Always ",y.jsx("span",{className:"text-slate-500 text-sm ml-1",children:"(shown when space available)"})]})]})]})]})})]}),y.jsxs("section",{id:"danger-zone",className:"bg-[var(--color-bg-card)] rounded-2xl border border-red-500/30 p-6 shadow-xl scroll-mt-6",children:[y.jsxs("h2",{className:"text-lg font-bold text-red-400 mb-6 flex items-center",children:[y.jsx("svg",{className:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),"Danger Zone"]}),y.jsxs("div",{className:"space-y-3",children:[y.jsx("button",{onClick:()=>E(!0),className:"w-full px-4 py-3 bg-red-500/10 text-red-400 border border-red-500/50 rounded-xl hover:bg-red-500 hover:text-white transition-all font-medium",children:"Delete Identity"}),y.jsx("p",{className:"text-xs text-slate-500 text-center",children:"This will permanently delete your identity and all local data"})]})]})]}),y.jsx("button",{onClick:kt,className:`fixed bottom-6 right-6 p-3 bg-indigo-600 text-white rounded-full shadow-lg shadow-indigo-500/30 hover:bg-indigo-500 transition-all duration-300 z-20 ${we?"opacity-100 translate-y-0":"opacity-0 translate-y-10 pointer-events-none"}`,"aria-label":"Back to top",children:y.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 10l7-7m0 0l7 7m-7-7v18"})})})]})]}),w&&y.jsx("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm flex items-center justify-center p-4 z-50 animate-fade-in",children:y.jsxs("div",{className:"bg-[var(--color-bg-card)] border border-slate-700 rounded-2xl max-w-md w-full p-6 shadow-2xl",children:[y.jsx("h2",{className:"text-xl font-bold text-white mb-4",children:"Export Identity"}),y.jsx("div",{className:"bg-yellow-500/10 border border-yellow-500/20 rounded-xl p-4 mb-6",children:y.jsxs("div",{className:"flex items-start",children:[y.jsx("svg",{className:"w-5 h-5 text-yellow-500 mr-2 mt-0.5 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),y.jsx("p",{className:"text-sm text-yellow-200",children:"Your identity file contains your private key. Anyone with this file and password can impersonate you."})]})}),y.jsxs("div",{className:"mb-6",children:[y.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Encryption Password"}),y.jsx("input",{type:"password",value:se,onChange:ct=>Re(ct.target.value),placeholder:"Enter a strong password",className:"w-full px-4 py-3 bg-slate-900/50 border border-slate-700 rounded-xl text-white placeholder-slate-500 focus:outline-none focus:ring-2 focus:ring-indigo-500/50"}),lt&&y.jsx("p",{className:"mt-2 text-sm text-red-400",children:lt})]}),y.jsxs("div",{className:"flex space-x-3",children:[y.jsx("button",{onClick:()=>{x(!1),Re(""),ke(null)},className:"flex-1 px-4 py-3 bg-slate-800 text-slate-300 rounded-xl hover:bg-slate-700 transition-colors font-medium",children:"Cancel"}),y.jsx("button",{onClick:de,className:"flex-1 px-4 py-3 bg-indigo-600 text-white rounded-xl hover:bg-indigo-500 transition-colors font-medium",children:"Export"})]})]})}),S&&y.jsx("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm flex items-center justify-center p-4 z-50 animate-fade-in",children:y.jsxs("div",{className:"bg-[var(--color-bg-card)] border border-red-500/30 rounded-2xl max-w-md w-full p-6 shadow-2xl",children:[y.jsx("h2",{className:"text-xl font-bold text-red-500 mb-4",children:"Delete Identity?"}),y.jsx("p",{className:"text-slate-400 mb-6",children:"This action cannot be undone. Your identity and all local messages will be permanently deleted."}),y.jsxs("div",{className:"flex space-x-3",children:[y.jsx("button",{onClick:()=>E(!1),className:"flex-1 px-4 py-3 bg-slate-800 text-slate-300 rounded-xl hover:bg-slate-700 transition-colors font-medium",children:"Cancel"}),y.jsx("button",{onClick:De,className:"flex-1 px-4 py-3 bg-red-600 text-white rounded-xl hover:bg-red-500 transition-colors font-medium",children:"Delete"})]})]})})]})}function o1({contactId:u,onClose:r}){const{getContact:i,updateLocalProfile:s}=br(),c=i(u),[m,_]=yt.useState(""),[w,x]=yt.useState(""),[S,E]=yt.useState(""),[R,N]=yt.useState(!1);if(yt.useEffect(()=>{c&&(_(c.localProfile?.name||c.displayName||""),x(c.localProfile?.description||""),E(c.localProfile?.group||""))},[c]),!c)return null;const q=async()=>{N(!0);try{await s(u,{name:m,description:w,group:S}),r()}catch(se){console.error("Failed to update profile:",se)}finally{N(!1)}},ie=()=>{c.peerProfile&&(_(c.peerProfile.name||""),x(c.peerProfile.description||""),E(c.peerProfile.group||""))};return y.jsx("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm flex items-center justify-center p-4 z-50 animate-fade-in",children:y.jsxs("div",{className:"bg-[var(--color-bg-card)] border border-slate-700 rounded-2xl max-w-4xl w-full shadow-2xl flex flex-col max-h-[90vh] overflow-hidden",children:[y.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-slate-700/50",children:[y.jsx("h2",{className:"text-xl font-bold text-white",children:"Edit Contact Profile"}),y.jsx("button",{onClick:r,className:"text-slate-400 hover:text-white transition-colors",children:y.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),y.jsx("div",{className:"flex-1 overflow-y-auto min-h-0 p-6",children:y.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8",children:[y.jsxs("div",{className:"space-y-6",children:[y.jsxs("h3",{className:"text-lg font-semibold text-indigo-400 flex items-center",children:[y.jsx("svg",{className:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})}),"Local Profile"]}),y.jsxs("div",{className:"space-y-4",children:[y.jsxs("div",{children:[y.jsx("label",{className:"block text-xs font-medium text-slate-400 uppercase tracking-wider mb-2",children:"Display Name"}),y.jsx("input",{type:"text",value:m,onChange:se=>_(se.target.value),className:"w-full px-4 py-3 bg-slate-900/50 border border-slate-700 rounded-xl text-white placeholder-slate-500 focus:outline-none focus:ring-2 focus:ring-indigo-500/50 transition-all",placeholder:"Name for this contact"})]}),y.jsxs("div",{children:[y.jsx("label",{className:"block text-xs font-medium text-slate-400 uppercase tracking-wider mb-2",children:"Description"}),y.jsx("textarea",{value:w,onChange:se=>x(se.target.value),rows:4,className:"w-full px-4 py-3 bg-slate-900/50 border border-slate-700 rounded-xl text-white placeholder-slate-500 focus:outline-none focus:ring-2 focus:ring-indigo-500/50 transition-all resize-none",placeholder:"Add notes or description..."})]}),y.jsxs("div",{children:[y.jsx("label",{className:"block text-xs font-medium text-slate-400 uppercase tracking-wider mb-2",children:"Group"}),y.jsx("input",{type:"text",value:S,onChange:se=>E(se.target.value),className:"w-full px-4 py-3 bg-slate-900/50 border border-slate-700 rounded-xl text-white placeholder-slate-500 focus:outline-none focus:ring-2 focus:ring-indigo-500/50 transition-all",placeholder:"e.g. Friends, Work"})]})]})]}),y.jsxs("div",{className:"space-y-6 md:border-l md:border-slate-700/50 md:pl-8",children:[y.jsxs("div",{className:"flex items-center justify-between",children:[y.jsxs("h3",{className:"text-lg font-semibold text-emerald-400 flex items-center",children:[y.jsx("svg",{className:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})}),"Peer's Public Profile"]}),y.jsxs("button",{onClick:ie,disabled:!c.peerProfile,className:"text-xs px-3 py-1.5 bg-slate-800 hover:bg-slate-700 text-indigo-400 rounded-lg transition-colors flex items-center disabled:opacity-50 disabled:cursor-not-allowed",title:"Copy details from peer's public profile",children:[y.jsx("svg",{className:"w-3.5 h-3.5 mr-1.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7h12m0 0l-4-4m4 4l-4 4m0 6H4m0 0l4 4m-4-4l4-4"})}),"Pull from Peer"]})]}),c.peerProfile?y.jsxs("div",{className:"space-y-6",children:[y.jsxs("div",{children:[y.jsx("label",{className:"block text-xs font-medium text-slate-500 uppercase tracking-wider mb-2",children:"Public Name"}),y.jsx("div",{className:"px-4 py-3 bg-slate-800/30 border border-slate-700/30 rounded-xl text-slate-300",children:c.peerProfile.name||y.jsx("span",{className:"text-slate-600 italic",children:"Not set"})})]}),y.jsxs("div",{children:[y.jsx("label",{className:"block text-xs font-medium text-slate-500 uppercase tracking-wider mb-2",children:"Public Description"}),y.jsx("div",{className:"px-4 py-3 bg-slate-800/30 border border-slate-700/30 rounded-xl text-slate-300 min-h-[100px] whitespace-pre-wrap",children:c.peerProfile.description||y.jsx("span",{className:"text-slate-600 italic",children:"Not set"})})]}),y.jsxs("div",{children:[y.jsx("label",{className:"block text-xs font-medium text-slate-500 uppercase tracking-wider mb-2",children:"Public Group"}),y.jsx("div",{className:"px-4 py-3 bg-slate-800/30 border border-slate-700/30 rounded-xl text-slate-300",children:c.peerProfile.group||y.jsx("span",{className:"text-slate-600 italic",children:"Not set"})})]})]}):y.jsxs("div",{className:"flex flex-col items-center justify-center h-64 text-center p-6 bg-slate-800/20 rounded-2xl border border-slate-700/30 border-dashed",children:[y.jsx("svg",{className:"w-12 h-12 text-slate-600 mb-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M13.828 10.172a4 4 0 00-5.656 0l-4 4a4 4 0 105.656 5.656l1.102-1.101m-.758-4.899a4 4 0 005.656 0l4-4a4 4 0 00-5.656-5.656l-1.1 1.1"})}),y.jsx("p",{className:"text-slate-400 font-medium",children:"No public profile available"}),y.jsx("p",{className:"text-slate-500 text-sm mt-1",children:"The peer hasn't shared their profile yet."})]})]})]})}),y.jsxs("div",{className:"flex justify-end space-x-3 p-6 border-t border-slate-700/50 bg-slate-800/20",children:[y.jsx("button",{onClick:r,className:"px-6 py-2.5 bg-slate-800 text-slate-300 rounded-xl hover:bg-slate-700 transition-colors font-medium",children:"Cancel"}),y.jsx("button",{onClick:q,disabled:R,className:"px-6 py-2.5 bg-indigo-600 text-white rounded-xl hover:bg-indigo-500 transition-colors font-medium shadow-lg shadow-indigo-500/20 flex items-center",children:R?y.jsxs(y.Fragment,{children:[y.jsx("svg",{className:"w-4 h-4 mr-2 animate-spin",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),"Saving..."]}):"Save Changes"})]})]})})}const ic=100;function l1(){const{identity:u,activeContactId:r,setActiveView:i}=wi(),{getContact:s}=br(),{messages:c,addMessage:m,setMessages:_,prependMessages:w,updateMessageDelivery:x}=Vs(),[S,E]=yt.useState(""),[R,N]=yt.useState(!1),[q,ie]=yt.useState(!0),[se,Re]=yt.useState(!1),[lt,ke]=yt.useState(!1),we=yt.useRef(null),$e=yt.useRef(null),Je=r?s(r):null,ft=u&&Je?[u.userId,Je.userId].sort().join("-"):"";yt.useEffect(()=>{if(!ft)return;(async()=>{const Ye=await Tn.getRecentMessages(ft,ic);_(ft,Ye),ie(Ye.length===ic)})()},[ft,_]);const et=yt.useCallback(async()=>{if(!ft||se||!q)return;const je=c[ft]||[];if(je.length===0)return;const Ye=je[0].msg_id;if(Ye!==void 0){Re(!0);try{const L=await Tn.getMessagesBefore(ft,Ye,ic);if(L.length>0){const de=$e.current,Ce=de?.scrollHeight||0;w(ft,L),requestAnimationFrame(()=>{if(de){const Le=de.scrollHeight;de.scrollTop=Le-Ce}})}ie(L.length===ic)}finally{Re(!1)}}},[ft,c,se,q,w]),qt=yt.useCallback(je=>{const{scrollTop:Ye}=je.currentTarget;Ye<100&&q&&!se&&et()},[q,se,et]);yt.useEffect(()=>{we.current?.scrollIntoView({behavior:"smooth"})},[c[ft]]);const en=async()=>{if(!S.trim()||!u||!Je||R)return;N(!0);const je=Wv();try{const Ye={msg_uuid:je,conversationId:ft,from:u.userId,content:S.trim(),timestamp:Date.now(),delivered:!1,firstAttemptTimestamp:Date.now(),showAsFailedInUI:!1,type:"text"};console.log("[ChatView] Saving message to db, conversationId:",ft,"msgUuid:",je);const L=await Tn.addMessage(Ye);Ye.msg_id=L,m(ft,Ye),E(""),qf(Je.userId,Ye),console.log("[ChatView] Sending message to",Je.userId,"status:",Je.status);try{await $n.sendMessage(Je.userId,_c(Ye)),console.log("[ChatView]  Message sent (waiting for ACK)")}catch(de){const Ce=de instanceof Error?de.message:"Unknown error";console.log("[ChatView] Send pending:",Ce)}}catch(Ye){console.error("Failed to create/send message:",Ye)}finally{N(!1)}},Oe=async je=>{if(!(!u||!Je)){if(je.msg_id===void 0){console.error("Cannot retry message without msg_id");return}console.log("[ChatView] Manual retry for message:",je.msg_uuid);try{const Ye=Date.now();await Tn.updateMessageDelivery(je.msg_id,!1,!1,Ye),x(je.msg_id,!1,!1);const L={...je,firstAttemptTimestamp:Ye,showAsFailedInUI:!1};qf(Je.userId,L),await $n.sendMessage(Je.userId,_c(L)),console.log("[ChatView]  Retry sent (waiting for ACK)")}catch(Ye){console.error("[ChatView]  Manual retry failed:",Ye)}}},Te=async je=>{if(confirm("Are you sure you want to delete this message?")){await Tn.deleteMessage(je);const{deleteMessage:Ye}=Vs.getState();Ye(je)}},pe=je=>{je.key==="Enter"&&!je.shiftKey&&(je.preventDefault(),en())},ue=je=>{const Ye=je.localProfile?.name,L=je.peerProfile?.name,de=!Ye&&!!L;return{displayName:Ye||L||`User ${je.userId.slice(0,8).toUpperCase()}`,isPeerProvided:de}},xt=je=>je.status==="online"?y.jsx("div",{className:"absolute bottom-0 right-0 w-3 h-3 bg-emerald-500 border-2 border-[var(--color-bg-card)] rounded-full"}):je.status==="handshake"?y.jsx("div",{className:"absolute bottom-0 right-0 w-3 h-3 bg-yellow-500 border-2 border-[var(--color-bg-card)] rounded-full animate-pulse"}):je.status==="failed"?y.jsx("div",{className:"absolute bottom-0 right-0 w-3 h-3 border-2 border-[var(--color-bg-card)] rounded-full bg-red-500 flex items-center justify-center",children:y.jsx("svg",{className:"w-1.5 h-1.5 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3,d:"M6 18L18 6M6 6l12 12"})})}):null;if(!u||!Je)return y.jsx("div",{className:"h-screen flex items-center justify-center bg-[var(--color-bg-dark)]",children:y.jsxs("div",{className:"text-center",children:[y.jsx("p",{className:"text-slate-400",children:"No contact selected"}),y.jsx("button",{onClick:()=>i("contacts"),className:"mt-4 px-6 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-500 transition-colors",children:"Back to Contacts"})]})});const qe=c[ft]||[],{displayName:J,isPeerProvided:Me}=ue(Je),Ge=Je.localProfile?.group;return y.jsxs("div",{className:"h-screen flex flex-col bg-[var(--color-bg-dark)] animate-fade-in",children:[y.jsxs("div",{className:"bg-[var(--color-bg-card)]/80 backdrop-blur-md border-b border-slate-700/50 px-4 py-3 flex items-center space-x-4 sticky top-0 z-10",children:[y.jsx("button",{onClick:()=>i("contacts"),"aria-label":"Back to Contacts",className:"p-2 hover:bg-slate-700/50 rounded-full transition-colors text-slate-300 hover:text-white",children:y.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})}),y.jsxs("div",{className:"relative",children:[y.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-indigo-500 to-purple-600 rounded-full flex items-center justify-center flex-shrink-0 shadow-lg shadow-indigo-500/20",children:y.jsx("span",{className:"text-white font-bold",children:J?.[0]?.toUpperCase()||Je.userId.slice(0,2).toUpperCase()})}),xt(Je)]}),y.jsxs("div",{className:"flex-1 min-w-0",children:[y.jsx("h2",{className:`font-semibold truncate ${Me?"text-slate-300 italic":"text-slate-100"}`,children:J}),y.jsx("div",{className:"flex items-center space-x-2",children:Ge?y.jsx("span",{className:"text-xs text-indigo-400 font-medium",children:Ge}):y.jsx(y.Fragment,{children:Je.status==="online"?y.jsxs("div",{className:"flex items-center space-x-1.5",children:[y.jsx("span",{className:"w-2 h-2 bg-emerald-500 rounded-full animate-pulse"}),y.jsx("span",{className:"text-xs text-emerald-400 font-medium",children:"Online"})]}):Je.status==="handshake"?y.jsxs("div",{className:"flex items-center space-x-1.5",children:[y.jsx("span",{className:"w-2 h-2 bg-yellow-500 rounded-full animate-pulse"}),y.jsx("span",{className:"text-xs text-yellow-400 font-medium",children:"Connecting"})]}):Je.status==="failed"?y.jsxs("div",{className:"flex items-center space-x-1.5",children:[y.jsx("span",{className:"w-2 h-2 bg-red-500 rounded-full"}),y.jsx("span",{className:"text-xs text-red-400 font-medium",children:"Failed"})]}):y.jsx("span",{className:"text-xs text-slate-500 font-medium",children:"Offline"})})})]}),y.jsxs("div",{className:"flex space-x-1",children:[y.jsx("button",{onClick:()=>ke(!0),className:"p-2 hover:bg-slate-700/50 rounded-full transition-colors text-slate-400 hover:text-white",title:"Edit Profile",children:y.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z"})})}),y.jsx("button",{className:"p-2 hover:bg-slate-700/50 rounded-full transition-colors text-slate-400 hover:text-white",title:"Voice call",children:y.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"})})}),y.jsx("button",{className:"p-2 hover:bg-slate-700/50 rounded-full transition-colors text-slate-400 hover:text-white",title:"Video call",children:y.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 10l4.553-2.276A1 1 0 0121 8.618v6.764a1 1 0 01-1.447.894L15 14M5 18h8a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z"})})})]})]}),y.jsxs("div",{ref:$e,onScroll:qt,className:"flex-1 overflow-y-auto p-4 space-y-6",children:[se&&y.jsx("div",{className:"flex justify-center py-2",children:y.jsxs("svg",{className:"w-5 h-5 animate-spin text-slate-400",fill:"none",viewBox:"0 0 24 24",children:[y.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),y.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"})]})}),qe.length===0?y.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-center opacity-50",children:[y.jsx("div",{className:"w-20 h-20 bg-slate-800 rounded-full flex items-center justify-center mb-4 border border-slate-700",children:y.jsx("svg",{className:"w-10 h-10 text-indigo-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"})})}),y.jsx("h3",{className:"text-lg font-semibold text-slate-300 mb-2",children:"No messages yet"}),y.jsx("p",{className:"text-slate-500 text-sm",children:"Send a message to start the conversation"})]}):y.jsxs(y.Fragment,{children:[qe.map(je=>{const Ye=je.from===u.userId;return y.jsx("div",{className:`flex ${Ye?"justify-end":"justify-start"} animate-fade-in group`,children:y.jsxs("div",{className:`max-w-xs lg:max-w-md xl:max-w-lg ${Ye?"order-2":"order-1"}`,children:[y.jsx("div",{className:`rounded-2xl px-5 py-3 shadow-sm ${Ye?"bg-indigo-600 text-white rounded-br-sm shadow-indigo-500/10":"bg-[var(--color-bg-card)] text-slate-200 rounded-bl-sm border border-slate-700/50"}`,children:y.jsx("p",{className:"text-sm whitespace-pre-wrap break-words leading-relaxed",children:je.content})}),y.jsxs("div",{className:`flex items-center space-x-2 mt-1.5 px-1 ${Ye?"justify-end":"justify-start"}`,children:[y.jsx("span",{className:"text-[11px] text-slate-500 font-medium",children:c1(je.timestamp)}),Ye&&je.msg_id!==void 0&&y.jsx("button",{onClick:()=>Te(je.msg_id),className:"opacity-0 group-hover:opacity-100 p-1 text-slate-500 hover:text-red-400 transition-all",title:"Delete message",children:y.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})}),Ye&&y.jsxs(y.Fragment,{children:[je.delivered&&y.jsx("span",{className:"text-[11px] text-indigo-400",children:"Received"}),!je.delivered&&!je.showAsFailedInUI&&y.jsxs("span",{className:"text-[11px] text-slate-500 flex items-center",children:[y.jsx("svg",{className:"w-3 h-3 animate-spin mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),"Pending"]}),!je.delivered&&je.showAsFailedInUI&&y.jsxs("div",{className:"flex items-center space-x-2",children:[y.jsxs("span",{className:"text-[11px] text-red-400 flex items-center",title:je.error,children:[y.jsx("svg",{className:"w-3 h-3 mr-1",fill:"currentColor",viewBox:"0 0 20 20",children:y.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})}),"Failed"]}),y.jsx("button",{onClick:()=>Oe(je),className:"text-[11px] text-indigo-400 hover:text-indigo-300 underline",children:"Retry"})]})]})]})]})},je.msg_uuid)}),y.jsx("div",{ref:we})]})]}),y.jsxs("div",{className:"bg-[var(--color-bg-card)] border-t border-slate-700/50 p-4",children:[Je.status!=="online"&&y.jsxs("div",{className:"flex items-center justify-center py-2 px-4 bg-yellow-900/20 border border-yellow-700/50 rounded-lg mb-3 max-w-4xl mx-auto",children:[y.jsx("svg",{className:"w-5 h-5 text-yellow-500 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),y.jsx("span",{className:"text-sm text-yellow-400",children:Je.status==="handshake"?"Establishing secure connection...":Je.status==="failed"?"Connection failed. Messages will be queued.":"Contact is disconnected. Messages might be delayed."})]}),y.jsxs("div",{className:"flex items-end space-x-3 max-w-4xl mx-auto",children:[y.jsx("div",{className:"flex-1 relative",children:y.jsx("textarea",{value:S,onChange:je=>E(je.target.value),onKeyPress:pe,placeholder:"Type a message...",rows:1,className:"w-full px-5 py-3.5 bg-slate-900/50 border border-slate-700 rounded-2xl focus:outline-none focus:ring-2 focus:ring-indigo-500/50 focus:border-indigo-500/50 text-slate-200 placeholder-slate-500 resize-none transition-all",style:{minHeight:"50px",maxHeight:"120px"}})}),y.jsx("button",{onClick:en,disabled:!S.trim()||R,className:`p-3.5 rounded-xl transition-all shadow-lg ${S.trim()&&!R?"bg-indigo-600 hover:bg-indigo-500 text-white shadow-indigo-500/20 hover:shadow-indigo-500/40 active:scale-95":"bg-slate-800 text-slate-600 cursor-not-allowed"}`,children:R?y.jsx("svg",{className:"w-6 h-6 animate-spin",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}):y.jsx("svg",{className:"w-6 h-6 transform rotate-90",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 19l9 2-9-18-9 18 9-2zm0 0v-8"})})})]}),y.jsxs("p",{className:"text-[10px] text-slate-500 mt-3 text-center flex items-center justify-center gap-1.5 uppercase tracking-widest font-medium opacity-60",children:[y.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"})}),"End-to-End Encrypted"]})]}),lt&&y.jsx(o1,{contactId:Je.userId,onClose:()=>ke(!1)})]})}function c1(u){const r=new Date(u),i=new Date,s=i.getTime()-r.getTime();return r.toDateString()===i.toDateString()?r.toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0}):s<10080*60*1e3?r.toLocaleDateString("en-US",{weekday:"short"})+" "+r.toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0}):r.toLocaleDateString("en-US",{month:"short",day:"numeric"})+" "+r.toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0})}const u1=()=>typeof window<"u"&&window.__TEST_MODE__===!0;function f1(){const{identity:u,activeView:r,setIdentity:i,setActiveView:s,setInitialized:c}=wi(),[,m]=yt.useState(null),_=yt.useRef(null);return yt.useEffect(()=>{const w=Xi.load();w?(i(w),window.history.replaceState({view:"contacts"},""),s("contacts")):c(!0)},[i,s,c]),yt.useEffect(()=>{const w=x=>{x.state?.view?s(x.state.view):u&&s("contacts")};return window.addEventListener("popstate",w),()=>window.removeEventListener("popstate",w)},[s,u]),yt.useEffect(()=>{if(!u)return;window.history.state?.view!==r&&window.history.pushState({view:r},"",`#${r}`)},[r,u]),yt.useEffect(()=>((async()=>{if(u){if(_.current===u.userId){console.log("[App] Transport already initialized for this identity (React guard)");const{useContactStore:x}=await sc(async()=>{const{useContactStore:S}=await Promise.resolve().then(()=>Mp);return{useContactStore:S}},void 0);x.getState().loaded||(console.log("[App] Reloading contacts after HMR"),await x.getState().loadContacts());return}console.log("[App] Initializing transport for identity:",u.userId.substring(0,8)),_.current=u.userId;try{await $n.initialize(u);const{initRetryService:x,setRetryTimeoutCallback:S}=await sc(async()=>{const{initRetryService:N,setRetryTimeoutCallback:q}=await Promise.resolve().then(()=>i1);return{initRetryService:N,setRetryTimeoutCallback:q}},void 0);x(u.userId,u1()?{minPeerInterval:2e3,timerInterval:100,timeoutMs:5e3}:{minPeerInterval:5e3,timerInterval:300,timeoutMs:3e4}),S(async N=>{const{updateMessageDelivery:q}=Vs.getState();await Tn.updateMessageDelivery(N,!1,!0),q(N,!1,!0)});const{useContactStore:E}=await sc(async()=>{const{useContactStore:N}=await Promise.resolve().then(()=>Mp);return{useContactStore:N}},void 0);await E.getState().loadContacts(),console.log("[App]  Contacts loaded and registered with transport");const{addMessage:R}=Vs.getState();$n.onMessage(async(N,q)=>{if(q.type==="ack"){console.log("[App] Received ACK for message:",q.id);const{getMessage:Re,updateMessageDelivery:lt}=Vs.getState();let ke=Re(q.id);ke||(ke=await Tn.getMessageByUuid(q.id)),ke?.msg_id!==void 0&&(await Tn.updateMessageDelivery(ke.msg_id,!0),lt(ke.msg_id,!0,!1)),Im(N,q.id),Km(N);return}const ie=[u.userId,N].sort().join("-"),se=t1(q,N,ie);if(await Tn.addMessage(se),R(ie,se),u)try{await $n.sendMessage(N,e1(q.id,q.timestamp)),console.log("[App] Sent ACK for:",q.id)}catch(Re){console.error("[App] Failed to send ACK:",Re)}})}catch(x){console.error("[App] Transport initialization failed:",x),_.current=null,m(x instanceof Error?x.message:"Failed to initialize network connection")}}})(),()=>{console.log("[App] Component unmount - preserving all state")}),[u]),!u||r==="setup"?y.jsx(Nv,{}):y.jsxs("div",{className:"flex h-screen overflow-hidden bg-[var(--color-bg-dark)]",children:[y.jsx("div",{className:`
        ${r==="contacts"?"flex w-full":r==="settings"?"hidden":"hidden md:flex md:w-80 lg:w-96 border-r border-slate-700/50"}
        flex-col h-full z-20 bg-[var(--color-bg-dark)] transition-all duration-300
      `,children:y.jsx(Jv,{})}),y.jsxs("div",{className:`
        ${r==="contacts"?"hidden":"flex"}
        flex-1 flex-col h-full relative z-10 bg-[var(--color-bg-dark)]
      `,children:[r==="settings"&&y.jsx(s1,{}),r==="chat"&&y.jsx(l1,{})]})]})}gy.createRoot(document.getElementById("root")).render(y.jsx(yt.StrictMode,{children:y.jsx(f1,{})}));
